import{j as e,H as X,a as V,am as se,e as z,ak as ae,aj as re,R as te,l as q,h as oe,D as ne,N as le,K as ce,T as H}from"./ui-vendor-DEBjJ4HS.js";import{r as n,R as K,d as ie,u as de}from"./react-vendor-Cy458wKG.js";import{g as G,N as x,c as I,A as B}from"./admin-chunk-bhOJ3jtA.js";const me=({widgetUrl:b,amount:i,customerName:t,onSuccess:a,onError:S,onCancel:C})=>{const{showToast:p}=G(),[f,y]=n.useState(!1),[l,d]=n.useState(!1),[k,N]=n.useState(null),v=n.useRef(!1),j=n.useRef(!1);n.useEffect(()=>(w(),()=>{const c=document.getElementById("datafast-external-script");c&&c.remove()}),[]);const w=()=>{try{console.log("üéØ Cargando widget externo de Datafast...");const c=document.getElementById("datafast-external-script");c&&c.remove(),window.wpwlOptions={onReady:function(){console.log("‚úÖ Widget externo Datafast listo!"),y(!0),p("Formulario de pago cargado",x.SUCCESS)},onBeforeSubmitCard:function(r){return console.log("üîÑ Procesando pago externo...",r),d(!0),p("Procesando pago...",x.INFO),!0},onAfterSubmitCard:function(r){console.log("üì§ Pago enviado, esperando respuesta...",r)},onBeforeRedirectToResult:function(r){if(console.log("üîÑ Redirigiendo al resultado...",r),r&&r.resourcePath){localStorage.setItem("external_datafast_resource_path",r.resourcePath);const h=r.sessionId||`external_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return localStorage.setItem("external_datafast_session_id",h),console.log("   ‚úÖ SessionId externo guardado para backend:",h),setTimeout(()=>{_(r.resourcePath)},1e3),!1}return!0},onError:function(r){console.error("‚ùå Error en widget externo:",r);const h=r.message||r.code||"Error desconocido";N(h),d(!1),p(`Error: ${h}`,x.ERROR),S?.(h)},style:"card",locale:"es",labels:{cvv:"CVV",cardHolder:"Nombre (igual que en la tarjeta)"}};const m=document.createElement("script");m.id="datafast-external-script",m.src=b,m.async=!0,m.onload=()=>{console.log("‚úÖ Script de widget externo cargado exitosamente")},m.onerror=r=>{console.error("‚ùå Error cargando script de widget externo:",r),N("Error cargando formulario de pago"),p("Error cargando formulario de pago",x.ERROR)},document.head.appendChild(m)}catch(c){console.error("Error configurando widget externo:",c),N("Error configurando formulario de pago")}},_=async c=>{if(v.current){console.log("‚ö†Ô∏è Verificaci√≥n ya en progreso, ignorando llamada duplicada");return}if(j.current){console.log("‚úÖ Verificaci√≥n ya completada previamente, ignorando llamada duplicada");return}v.current=!0;try{console.log("üîç Verificando resultado del pago externo..."),d(!0);const r=await(await fetch(`/api/pay/${R()}/verify/datafast`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({resource_path:c,transaction_id:`ext_${Date.now()}`})})).json();if(r.success)console.log("‚úÖ Pago externo verificado exitosamente"),j.current=!0,p("Pago procesado exitosamente",x.SUCCESS),a?.(r.data);else{if(r.validation_data?.result?.code==="200.300.404"){console.log("‚ö†Ô∏è Error 200.300.404 detectado - sesi√≥n ya consumida, verificando pagos previos...");const u=await g();if(u.wasSuccessful){console.log("‚úÖ Pago ya fue procesado exitosamente anteriormente"),j.current=!0,p("Pago procesado exitosamente",x.SUCCESS),a?.(u.data);return}}throw new Error(r.message||"Error verificando pago")}}catch(m){if(console.error("‚ùå Error verificando pago externo:",m),j.current)return;const r=m instanceof Error?m.message:"Error verificando pago";N(r),S?.(r)}finally{v.current=!1,d(!1)}},g=async()=>{try{console.log("üîç Verificando si existe pago exitoso previo...");const c=R();if(!c)return{wasSuccessful:!1};const m=await fetch(`/api/external/checkout/${c}/status`,{method:"GET",headers:{"Content-Type":"application/json"}});if(m.ok){const r=await m.json();if(r.success&&r.data?.status==="completed")return console.log("‚úÖ Encontrado pago exitoso previo en sistema externo"),{wasSuccessful:!0,data:r.data}}return console.log("‚ÑπÔ∏è No se encontr√≥ pago exitoso previo"),{wasSuccessful:!1}}catch(c){return console.error("‚ùå Error verificando pago previo:",c),{wasSuccessful:!1}}},R=()=>new URL(b).searchParams.get("checkoutId")||"";return k?e.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(X,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Error en el Pago"}),e.jsx("p",{className:"text-gray-600 mb-6",children:k}),e.jsxs("div",{className:"flex justify-center space-x-4",children:[e.jsx("button",{onClick:()=>{N(null),w()},className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Reintentar"}),e.jsx("button",{onClick:C,className:"bg-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancelar"})]})]})}):e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Pagar con Datafast"}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between text-sm text-blue-800",children:[e.jsxs("span",{children:["Cliente: ",t]}),e.jsxs("span",{children:["Monto: $",(typeof i=="string"?parseFloat(i):i).toFixed(2)," USD"]})]})})]}),e.jsx("div",{className:"min-h-[400px] border border-gray-200 rounded-lg p-4 mb-6",children:e.jsxs("form",{className:"paymentWidgets","data-brands":"VISA MASTER AMEX DINERS DISCOVER",children:[!f&&!l&&e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600",children:"Cargando formulario de pago..."})]})}),l&&e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600",children:"Procesando pago..."})]})})]})}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"Datos de prueba:"}),e.jsxs("div",{className:"text-sm text-yellow-700 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Tarjeta VISA:"})," 4200 0000 0000 0000"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Fecha:"})," 07/26 | ",e.jsx("strong",{children:"CVV:"})," 246"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Titular:"})," ",t]})]})]}),e.jsx("div",{className:"text-center",children:e.jsx("button",{onClick:C,disabled:l,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancelar Pago"})})]})};class Y{static async createExternalPayment(i,t){try{console.log("ExternalDeunaService: Creating external payment",{linkCode:i,customerData:t});const a=await I.post(`/pay/${i}/deuna`,t);return console.log("ExternalDeunaService: Payment created successfully",a),a}catch(a){throw console.error("ExternalDeunaService: Error creating payment",a),new Error(a.response?.data?.message||a.message||"Error creating external payment")}}static async simulateWebhook(i,t){try{console.log("ExternalDeunaService: Simulating webhook",{linkCode:i,paymentId:t});const a=await I.post(`/pay/${i}/deuna/webhook`,{status:"SUCCESS",idTransaction:t,transferNumber:`TXN_${Date.now()}`,internalTransactionReference:t,amount:0,timestamp:new Date().toISOString()});return console.log("ExternalDeunaService: Webhook simulated successfully",a),{success:!0}}catch(a){throw console.error("ExternalDeunaService: Error simulating webhook",a),new Error(a.response?.data?.message||a.message||"Error simulating webhook")}}static async checkPaymentStatus(i){try{console.log("ExternalDeunaService: Checking payment status",{linkCode:i});const t=await I.get(`/pay/${i}`);return console.log("ExternalDeunaService: Status checked successfully",t),{success:!0,status:t.data?.status||"pending",paid_at:t.data?.paid_at}}catch(t){return console.error("ExternalDeunaService: Error checking status",t),{success:!1,status:"error"}}}static pollExternalPaymentStatus(i,t={}){const{maxAttempts:a=40,interval:S=15e3,onStatusChange:C}=t;let p=0,f=!1;const y=async()=>{if(!(f||p>=a)){p++;try{const l=await this.checkPaymentStatus(i);if(l.success&&l.status==="paid"){C?.("completed");return}if(l.status==="cancelled"||l.status==="expired"){C?.(l.status);return}setTimeout(y,S)}catch(l){console.error("Error polling external payment status:",l),setTimeout(y,S)}}};return setTimeout(y,S),{cancel:()=>{f=!0},promise:new Promise(l=>{const d=()=>{f||p>=a?l():setTimeout(d,1e3)};d()})}}}const ue=({linkCode:b,amount:i,customerName:t,customerData:a,onSuccess:S,onError:C,onCancel:p})=>{const{showToast:f}=G(),[y,l]=n.useState(!1),[d,k]=n.useState(null),[N,v]=n.useState(null),[j,w]=n.useState(!1),[_,g]=n.useState("pending"),[R,c]=n.useState(600),[m,r]=n.useState(!1),h=K.useRef(null),u=K.useRef(null);n.useEffect(()=>(T(),()=>{h.current&&h.current.cancel(),u.current&&clearInterval(u.current)}),[]),n.useEffect(()=>{if(d&&j&&R>0){const o=setInterval(()=>{c(s=>s<=1?(w(!1),v("El tiempo de pago ha expirado. El pago ha sido cancelado autom√°ticamente."),0):s-1)},1e3);u.current=o}return()=>{u.current&&(clearInterval(u.current),u.current=null)}},[d,j,R]);const T=async()=>{l(!0),v(null);try{console.log("üîÑ Generando QR externo para Deuna...");const o=await Y.createExternalPayment(b,a);if(o.success&&o.data)console.log("‚úÖ QR externo generado exitosamente"),k(o.data),w(!0),M(),f("C√≥digo QR generado",x.SUCCESS);else throw new Error(o.message||"Error generando c√≥digo QR")}catch(o){console.error("‚ùå Error generando QR externo:",o);const s=o instanceof Error?o.message:"Error generando c√≥digo QR";v(s),C?.(s)}finally{l(!1)}},M=()=>{const o=Y.pollExternalPaymentStatus(b,{maxAttempts:40,interval:15e3,onStatusChange:Q});h.current=o,o.promise.catch(s=>{console.error("Error en polling:",s),j&&v("Error monitoreando el estado del pago")})},Q=o=>{switch(console.log("üìä Estado del pago cambi√≥:",o),g(o),o){case"completed":w(!1),f("¬°Pago completado exitosamente!",x.SUCCESS),S?.(d);break;case"failed":case"cancelled":w(!1);const s=`Pago ${o==="failed"?"fallido":"cancelado"}`;v(s),C?.(s);break}},F=async(o="Usuario cancel√≥")=>{try{console.log("üö´ Cancelando pago externo..."),w(!1),h.current&&h.current.cancel(),f("Pago cancelado",x.INFO),p?.()}catch(s){console.error("Error cancelando pago:",s)}},A=async o=>{try{await navigator.clipboard.writeText(o),r(!0),f("Enlace copiado",x.SUCCESS),setTimeout(()=>r(!1),2e3)}catch(s){console.error("Error copiando al portapapeles:",s),f("Error copiando enlace",x.ERROR)}},L=o=>{const s=Math.floor(o/60),P=o%60;return`${s.toString().padStart(2,"0")}:${P.toString().padStart(2,"0")}`};return N?e.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(X,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Error en el Pago"}),e.jsx("p",{className:"text-gray-600 mb-6",children:N}),e.jsxs("div",{className:"flex justify-center space-x-4",children:[e.jsx("button",{onClick:()=>{v(null),T()},className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors",children:"Reintentar"}),e.jsx("button",{onClick:p,className:"bg-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancelar"})]})]})}):y?e.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-green-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Generando C√≥digo QR"}),e.jsx("p",{className:"text-gray-600",children:"Preparando tu pago con Deuna..."})]})}):_==="completed"?e.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(V,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"¬°Pago Completado!"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Tu pago ha sido procesado exitosamente"}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsxs("p",{className:"text-green-800 font-semibold",children:["Monto: $",i.toFixed(2)," USD"]}),e.jsxs("p",{className:"text-green-700",children:["Cliente: ",t]})]})]})}):e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsxs("div",{className:"flex items-center justify-center mb-4",children:[e.jsx(se,{className:"h-8 w-8 text-green-600 mr-2"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Pagar con Deuna"})]}),e.jsx("div",{className:"bg-green-50 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex justify-between text-sm text-green-800",children:[e.jsxs("span",{children:["Cliente: ",t]}),e.jsxs("span",{children:["Monto: $",i.toFixed(2)," USD"]})]})}),e.jsxs("div",{className:"flex items-center justify-center text-orange-600 mb-4",children:[e.jsx(z,{className:"h-5 w-5 mr-2"}),e.jsx("span",{className:"font-mono text-lg font-bold",children:L(R)})]})]}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"bg-white border-2 border-gray-200 rounded-lg p-4 inline-block mb-4",children:d?.qr_code_base64?e.jsx("img",{src:d.qr_code_base64,alt:"C√≥digo QR de pago",className:"w-48 h-48"}):e.jsx("div",{className:"w-48 h-48 bg-gray-100 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500",children:"Generando QR..."})})}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Escanea el c√≥digo QR con tu aplicaci√≥n bancaria m√≥vil"})]}),d?.payment_url&&e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsx("button",{onClick:()=>A(d.payment_url),className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center",children:m?e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"h-5 w-5 mr-2"}),"¬°Copiado!"]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"h-5 w-5 mr-2"}),"Copiar Enlace de Pago"]})}),e.jsxs("button",{onClick:()=>window.open(d.payment_url,"_blank"),className:"w-full bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center",children:[e.jsx(re,{className:"h-5 w-5 mr-2"}),"Abrir en M√≥vil"]})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:e.jsx("div",{className:"flex items-center",children:j?e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"h-5 w-5 text-yellow-600 mr-3 animate-spin"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-yellow-800",children:"Esperando Pago"}),e.jsx("p",{className:"text-yellow-700 text-sm",children:"Verifica tu app m√≥vil para completar el pago"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"h-5 w-5 text-yellow-600 mr-3"}),e.jsx("p",{className:"font-semibold text-yellow-800",children:"Pago Inactivo"})]})})}),!1,e.jsx("div",{className:"text-center",children:e.jsx("button",{onClick:()=>F("Usuario cancel√≥"),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",children:"Cancelar Pago"})})]})},he=()=>{const{linkCode:b}=ie(),i=de(),{showToast:t}=G(),[a,S]=n.useState(null),[C,p]=n.useState(!0),[f,y]=n.useState(null),[l,d]=n.useState(!1),[k,N]=n.useState(!1),[v,j]=n.useState(!1),[w,_]=n.useState(null),[g,R]=n.useState({given_name:"",surname:"",identification:"",middle_name:"",email:"",phone:"",address:"",city:"",postal_code:""}),[c,m]=n.useState(!1);n.useEffect(()=>{if(!b){i("/");return}r()},[b]);const r=async()=>{try{p(!0);const s=await I.get(B.EXTERNAL_PAYMENT.PUBLIC.SHOW(b));s.success&&s.data?(S(s.data),y(null)):y(s.message||"Link de pago no encontrado")}catch(s){console.error("Error loading payment link:",s),s.response?.status===404?y("Link de pago no encontrado"):s.response?.data?.error_code==="LINK_EXPIRED"?y("Este link de pago ha expirado"):s.response?.data?.error_code==="LINK_NOT_AVAILABLE"?y("Este link de pago ya no est√° disponible"):y(s.response?.data?.message||"Error cargando informaci√≥n del pago")}finally{p(!1)}},h=()=>{const{given_name:s,surname:P,identification:E,email:D,phone:W,address:U,city:$}=g,O=s.trim()!==""&&P.trim()!==""&&E.trim()!==""&&/^\d{10}$/.test(E)&&D.trim()!==""&&W.trim()!==""&&U.trim()!==""&&$.trim()!==""&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(D);return m(O),O},u=(s,P)=>{const E={...g,[s]:P};R(E),setTimeout(()=>{const{given_name:D,surname:W,identification:U,email:$,phone:O,address:J,city:Z}=E,ee=D.trim()!==""&&W.trim()!==""&&U.trim()!==""&&/^\d{10}$/.test(U)&&$.trim()!==""&&O.trim()!==""&&J.trim()!==""&&Z.trim()!==""&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test($);m(ee)},100)},T=async s=>{if(!(!a||!b)){if(!h()){t("Por favor completa todos los campos obligatorios",x.ERROR);return}try{d(!0);const P=s==="datafast"?B.EXTERNAL_PAYMENT.PUBLIC.DATAFAST(b):B.EXTERNAL_PAYMENT.PUBLIC.DEUNA(b),E=await I.post(P,g);if(E.success&&E.data)if(s==="datafast"){const D=E.data.widget_url||E.data.redirect_url;D?(_(D),N(!0)):t("Error: No se recibi√≥ URL del widget",x.ERROR)}else j(!0);else t(E.message||"Error iniciando el pago",x.ERROR)}catch(P){console.error("Error initiating payment:",P),t(P.response?.data?.message||"Error procesando el pago",x.ERROR)}finally{d(!1)}}},M=s=>new Date(s).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),Q=s=>new Date(s)<new Date;if(C)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Cargando informaci√≥n del pago..."})]})});if(f)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8 text-center",children:[e.jsx(X,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Error"}),e.jsx("p",{className:"text-gray-600 mb-6",children:f}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:r,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:"Reintentar"}),e.jsx("button",{onClick:()=>i("/"),className:"w-full bg-gray-200 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-300 transition-colors",children:"Ir al inicio"})]})]})});const F=s=>{console.log("‚úÖ Pago completado:",s),t("¬°Pago procesado exitosamente!",x.SUCCESS)},A=s=>{console.error("‚ùå Error en pago:",s),t(`Error: ${s}`,x.ERROR),N(!1),j(!1)},L=()=>{N(!1),j(!1),t("Pago cancelado",x.INFO)};if(!a)return null;const o=Q(a.expires_at);return k&&w?e.jsx("div",{className:"min-h-screen bg-gray-50 py-8 px-4",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsx(me,{widgetUrl:w,amount:a.amount,customerName:a.customer_name,onSuccess:F,onError:A,onCancel:L})})}):v?e.jsx("div",{className:"min-h-screen bg-gray-50 py-8 px-4",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsx(ue,{linkCode:b,amount:a.amount,customerName:a.customer_name,customerData:g,onSuccess:F,onError:A,onCancel:L})})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8 px-4",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"bg-white rounded-full p-4 w-20 h-20 mx-auto mb-4 shadow-sm",children:e.jsx(q,{className:"h-12 w-12 text-blue-600 mx-auto"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Realizar Pago"}),e.jsx("p",{className:"text-gray-600",children:"Procesa tu pago de forma segura"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Detalles del Pago"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(oe,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsx("span",{className:"text-gray-600",children:"Para:"})]}),e.jsx("span",{className:"font-medium text-gray-900",children:a.customer_name})]}),e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ne,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsx("span",{className:"text-gray-600",children:"Monto:"})]}),e.jsxs("span",{className:"text-2xl font-bold text-green-600",children:["$",(typeof a.amount=="string"?parseFloat(a.amount):a.amount).toFixed(2)," USD"]})]}),a.description&&e.jsxs("div",{className:"flex items-start justify-between py-3 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(le,{className:"h-5 w-5 text-gray-400 mr-3 mt-0.5"}),e.jsx("span",{className:"text-gray-600",children:"Concepto:"})]}),e.jsx("span",{className:"font-medium text-gray-900 text-right max-w-xs",children:a.description})]}),e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsx("span",{className:"text-gray-600",children:"V√°lido hasta:"})]}),e.jsx("span",{className:`font-medium ${o?"text-red-600":"text-gray-900"}`,children:M(a.expires_at)})]})]})]}),o?e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 mb-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{className:"h-8 w-8 text-red-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-red-800",children:"Link Expirado"}),e.jsx("p",{className:"text-red-600",children:"Este link de pago ha expirado y ya no est√° disponible."})]})]})}):a.status!=="pending"?e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6 mb-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(V,{className:"h-8 w-8 text-gray-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Pago No Disponible"}),e.jsx("p",{className:"text-gray-600",children:"Este link de pago ya no est√° disponible para procesar."})]})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Tus Datos"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Por favor completa los siguientes datos para procesar tu pago de forma segura."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"given_name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre *"}),e.jsx("input",{type:"text",id:"given_name",required:!0,value:g.given_name,onChange:s=>u("given_name",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Juan"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"surname",className:"block text-sm font-medium text-gray-700 mb-2",children:"Apellido *"}),e.jsx("input",{type:"text",id:"surname",required:!0,value:g.surname,onChange:s=>u("surname",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"P√©rez"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"middle_name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Segundo Nombre (opcional)"}),e.jsx("input",{type:"text",id:"middle_name",value:g.middle_name||"",onChange:s=>u("middle_name",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Carlos"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"identification",className:"block text-sm font-medium text-gray-700 mb-2",children:"C√©dula * (10 d√≠gitos)"}),e.jsx("input",{type:"text",id:"identification",required:!0,pattern:"[0-9]{10}",maxLength:10,value:g.identification,onChange:s=>u("identification",s.target.value.replace(/\D/g,"")),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"1234567890"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ingresa tu n√∫mero de c√©dula de 10 d√≠gitos"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),e.jsx("input",{type:"email",id:"email",required:!0,value:g.email,onChange:s=>u("email",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"tu@email.com"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-2",children:"Tel√©fono *"}),e.jsx("input",{type:"tel",id:"phone",required:!0,pattern:"[0-9+\\s()-]+",value:g.phone,onChange:s=>u("phone",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0987654321"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-2",children:"Direcci√≥n *"}),e.jsx("input",{type:"text",id:"address",required:!0,value:g.address,onChange:s=>u("address",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Av. Principal 123, Sector Norte"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700 mb-2",children:"Ciudad *"}),e.jsx("input",{type:"text",id:"city",required:!0,value:g.city,onChange:s=>u("city",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Quito"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"postal_code",className:"block text-sm font-medium text-gray-700 mb-2",children:"C√≥digo Postal (opcional)"}),e.jsx("input",{type:"text",id:"postal_code",pattern:"[0-9A-Za-z\\-\\s]+",value:g.postal_code,onChange:s=>u("postal_code",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"170135"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Selecciona tu m√©todo de pago"}),!c&&e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{className:"h-5 w-5 text-amber-600 mr-3"}),e.jsx("p",{className:"text-amber-800 text-sm",children:"Por favor completa todos los campos de datos personales para habilitar los m√©todos de pago."})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("button",{onClick:()=>T("datafast"),disabled:l||!c,className:"w-full bg-blue-600 text-white p-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:[l?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-3"}):e.jsx(q,{className:"h-5 w-5 mr-3"}),e.jsx("span",{className:"font-medium",children:"Pagar con Datafast"})]}),e.jsxs("button",{onClick:()=>T("deuna"),disabled:l||!c,className:"w-full bg-green-600 text-white p-4 rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:[l?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-3"}):e.jsx(q,{className:"h-5 w-5 mr-3"}),e.jsx("span",{className:"font-medium",children:"Pagar con Deuna"})]})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(V,{className:"h-5 w-5 text-blue-600 mr-3 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"Pago Seguro"}),e.jsx("p",{className:"text-sm text-blue-600 mt-1",children:"Tus datos est√°n protegidos con encriptaci√≥n SSL. Nunca almacenamos informaci√≥n de tarjetas de cr√©dito."})]})]})})]}),e.jsx("div",{className:"text-center mt-8 text-sm text-gray-500",children:e.jsx("p",{children:"¬øTienes problemas con tu pago? Contacta al emisor de este link"})})]})})};export{he as default};
//# sourceMappingURL=PaymentPage-BXbRXZuE.js.map
