{"version":3,"file":"ProductItemPage-z-hckOVt.js","sources":["../../src/presentation/pages/ProductItemPage.tsx"],"sourcesContent":["import React, {useState, useEffect} from \"react\";\r\nimport {useParams, Link, useNavigate} from \"react-router-dom\";\r\nimport {\r\n\tShoppingCart,\r\n\tHeart,\r\n\tShare2,\r\n\tStar,\r\n\tTruck,\r\n\tShield,\r\n\tRotateCcw,\r\n\tMinus,\r\n\tPlus,\r\n\tLoader,\r\n\tMessageSquare,\r\n} from \"lucide-react\";\r\nimport {ProductService} from \"../../core/services/ProductService\";\r\nimport type {\r\n\tProductDetail,\r\n\tProductImage,\r\n} from \"../../core/domain/entities/Product\";\r\nimport {getImageUrl} from \"../../utils/imageUtils\";\r\nimport {useCart} from \"../hooks/useCart\";\r\nimport {useFavorites} from \"../hooks/useFavorites\";\r\nimport {useChat} from \"../hooks/useChat\";\r\nimport {NotificationType} from \"../contexts/CartContext\";\r\nimport ApiClient from \"../../infrastructure/api/apiClient\";\r\n\r\ninterface SellerApiResponse {\r\n\tstatus?: string;\r\n\tsuccess?: boolean;\r\n\tdata?: {\r\n\t\tid?: number;\r\n\t\tseller_id?: number;\r\n\t\tname?: string;\r\n\t\temail?: string;\r\n\t};\r\n\tmessage?: string;\r\n}\r\n\r\nconst ProductItemPage: React.FC = () => {\r\n\tconst {id} = useParams<{id: string}>();\r\n\tconst navigate = useNavigate();\r\n\tconst [product, setProduct] = useState<ProductDetail | null>(null);\r\n\tconst [loading, setLoading] = useState<boolean>(true);\r\n\tconst [error, setError] = useState<string | null>(null);\r\n\tconst [quantity, setQuantity] = useState(1);\r\n\tconst [activeImage, setActiveImage] = useState(0);\r\n\tconst [activeTab, setActiveTab] = useState<\r\n\t\t\"description\" | \"specifications\" | \"reviews\"\r\n\t>(\"description\");\r\n\tconst {addToCart, showNotification} = useCart();\r\n\tconst {toggleFavorite} = useFavorites();\r\n\tconst {createChat} = useChat();\r\n\r\n\t// Initialize service\r\n\tconst productService = new ProductService();\r\n\r\n\tuseEffect(() => {\r\n\t\tconst fetchProductData = async () => {\r\n\t\t\tif (!id) return;\r\n\r\n\t\t\ttry {\r\n\t\t\t\tsetLoading(true);\r\n\t\t\t\tsetError(null);\r\n\r\n\t\t\t\t// Call the service to get product details\r\n\t\t\t\tconst productId = parseInt(id);\r\n\t\t\t\tconst productData = await productService.getProductById(productId);\r\n\r\n\t\t\t\tconsole.log(\"Product data from API:\", productData);\r\n\r\n\t\t\t\t// Set the product state with the fetched data\r\n\t\t\t\tsetProduct(productData);\r\n\r\n\t\t\t\t// Track product view\r\n\t\t\t\tproductService\r\n\t\t\t\t\t.trackProductView(productId)\r\n\t\t\t\t\t.catch((e) => console.error(\"Error tracking product view:\", e));\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error(\"Error fetching product:\", err);\r\n\t\t\t\tsetError(\r\n\t\t\t\t\t\"No se pudo cargar el producto. Por favor, intente nuevamente.\"\r\n\t\t\t\t);\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tfetchProductData();\r\n\t}, [id]);\r\n\r\n\t// Funciones de utilidad\r\n\tconst handleQuantityChange = (newQuantity: number) => {\r\n\t\tif (newQuantity >= 1 && newQuantity <= 10) {\r\n\t\t\tsetQuantity(newQuantity);\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleAddToCart = async () => {\r\n\t\t// ✅ VERIFICACIÓN DE NULL AGREGADA\r\n\t\tif (!product) {\r\n\t\t\tshowNotification(\r\n\t\t\t\tNotificationType.ERROR,\r\n\t\t\t\t\"Error: No se pudo cargar la información del producto\"\r\n\t\t\t);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconsole.log(`Añadido al carrito: ${quantity} unidades de ${product.name}`);\r\n\r\n\t\tif (!product.is_in_stock) {\r\n\t\t\tshowNotification(\r\n\t\t\t\tNotificationType.ERROR,\r\n\t\t\t\t\"Lo sentimos, este producto está agotado\"\r\n\t\t\t);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tconst success = await addToCart({\r\n\t\t\t\tproductId: Number(id),\r\n\t\t\t\tquantity: quantity,\r\n\t\t\t});\r\n\r\n\t\t\tif (success) {\r\n\t\t\t\tshowNotification(\r\n\t\t\t\t\tNotificationType.SUCCESS,\r\n\t\t\t\t\t`${product.name} ha sido agregado al carrito`\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(\"No se pudo agregar el producto al carrito\");\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al agregar al carrito:\", error);\r\n\t\t\tshowNotification(\r\n\t\t\t\tNotificationType.ERROR,\r\n\t\t\t\t\"Error al agregar producto al carrito. Inténtalo de nuevo.\"\r\n\t\t\t);\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleAddToWishlist = async () => {\r\n\t\t// ✅ VERIFICACIÓN DE NULL AGREGADA\r\n\t\tif (!product) {\r\n\t\t\tshowNotification(\r\n\t\t\t\tNotificationType.ERROR,\r\n\t\t\t\t\"Error: No se pudo cargar la información del producto\"\r\n\t\t\t);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconsole.log(`Añadido a favoritos: ${product.name}`);\r\n\r\n\t\ttry {\r\n\t\t\tconst result = await toggleFavorite(Number(id));\r\n\r\n\t\t\tif (result) {\r\n\t\t\t\tshowNotification(\r\n\t\t\t\t\tNotificationType.SUCCESS,\r\n\t\t\t\t\t\"Producto añadido a favoritos\"\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\tshowNotification(\r\n\t\t\t\t\tNotificationType.INFO,\r\n\t\t\t\t\t\"Producto eliminado de favoritos\"\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al manejar favorito:\", error);\r\n\t\t\tshowNotification(\r\n\t\t\t\tNotificationType.ERROR,\r\n\t\t\t\t\"Error al gestionar favoritos. Inténtalo de nuevo.\"\r\n\t\t\t);\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleChatWithSeller = async () => {\r\n\t\t// Verificación de null\r\n\t\tif (!product) {\r\n\t\t\tshowNotification(\r\n\t\t\t\tNotificationType.ERROR,\r\n\t\t\t\t\"Error: No se pudo cargar la información del producto\"\r\n\t\t\t);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tlet sellerId;\r\n\r\n\t\t\t// Caso 1: El producto ya tiene seller_id directamente\r\n\t\t\tif (product.seller_id) {\r\n\t\t\t\tsellerId = product.seller_id;\r\n\t\t\t\tconsole.log(`Usando seller_id directo del producto: ${sellerId}`);\r\n\t\t\t}\r\n\t\t\t// Caso 2: El producto tiene objeto seller con id\r\n\t\t\telse if (product.seller?.id) {\r\n\t\t\t\tsellerId = product.seller.id;\r\n\t\t\t\tconsole.log(`Usando seller.id del producto: ${sellerId}`);\r\n\t\t\t}\r\n\t\t\t// Caso 3: Necesitamos convertir user_id a seller_id\r\n\t\t\telse if (product.user_id) {\r\n\t\t\t\tconsole.log(\r\n\t\t\t\t\t`Intentando obtener seller_id a partir de user_id: ${product.user_id}`\r\n\t\t\t\t);\r\n\r\n\t\t\t\ttry {\r\n\t\t\t\t\t// ✅ CORRECCIÓN - Tipar la respuesta de la API\r\n\t\t\t\t\tconst response = await ApiClient.get<SellerApiResponse>(\r\n\t\t\t\t\t\t`/sellers/by-user/${product.user_id}`\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\t// ✅ ACCESO SEGURO A LAS PROPIEDADES\r\n\t\t\t\t\tif (response && response.data) {\r\n\t\t\t\t\t\tif (response.data.id) {\r\n\t\t\t\t\t\t\tsellerId = response.data.id;\r\n\t\t\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t\t\t`Convertido user_id ${product.user_id} a seller_id ${sellerId}`\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t} else if (response.data.seller_id) {\r\n\t\t\t\t\t\t\tsellerId = response.data.seller_id;\r\n\t\t\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t\t\t`Convertido user_id ${product.user_id} a seller_id ${sellerId}`\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// Si no podemos obtener el seller_id, usamos el user_id como fallback\r\n\t\t\t\t\t\t\tconsole.warn(\r\n\t\t\t\t\t\t\t\t`No se pudo obtener seller_id, usando user_id como fallback`\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\tsellerId = product.user_id;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// Respuesta vacía o sin data\r\n\t\t\t\t\t\tconsole.warn(\r\n\t\t\t\t\t\t\t`Respuesta de API vacía o sin data, usando user_id como fallback`\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tsellerId = product.user_id;\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error(\"Error al obtener seller_id:\", error);\r\n\t\t\t\t\t// Como fallback, usamos el user_id directamente\r\n\t\t\t\t\tsellerId = product.user_id;\r\n\t\t\t\t\tconsole.warn(\r\n\t\t\t\t\t\t`Fallback: usando user_id ${sellerId} como seller_id debido a error`\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tconsole.error(\r\n\t\t\t\t\t\"No se encontró información de vendedor en datos del producto:\",\r\n\t\t\t\t\tproduct\r\n\t\t\t\t);\r\n\t\t\t\tthrow new Error(\"No se pudo determinar el vendedor del producto\");\r\n\t\t\t}\r\n\r\n\t\t\tconsole.log(\r\n\t\t\t\t`Iniciando chat con vendedor ID ${sellerId} para producto ${product.id}`\r\n\t\t\t);\r\n\r\n\t\t\tconst chatId = await createChat(sellerId, Number(id));\r\n\t\t\tif (chatId) {\r\n\t\t\t\t// Redirigir a la página de chat\r\n\t\t\t\tnavigate(`/chats/${chatId}`);\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(\"No se pudo crear el chat con el vendedor\");\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al iniciar chat con vendedor:\", error);\r\n\t\t\tshowNotification(\r\n\t\t\t\tNotificationType.ERROR,\r\n\t\t\t\t\"Error al iniciar chat con vendedor. Inténtalo de nuevo.\"\r\n\t\t\t);\r\n\t\t}\r\n\t};\r\n\r\n\t// Renderizar estrellas de valoración\r\n\tconst renderRatingStars = (rating: number) => {\r\n\t\treturn (\r\n\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t{[1, 2, 3, 4, 5].map((star) => (\r\n\t\t\t\t\t<Star\r\n\t\t\t\t\t\tkey={star}\r\n\t\t\t\t\t\tsize={18}\r\n\t\t\t\t\t\tclassName={`${\r\n\t\t\t\t\t\t\tstar <= Math.floor(rating)\r\n\t\t\t\t\t\t\t\t? \"text-yellow-400 fill-current\"\r\n\t\t\t\t\t\t\t\t: star <= rating\r\n\t\t\t\t\t\t\t\t\t? \"text-yellow-400 fill-current opacity-60\"\r\n\t\t\t\t\t\t\t\t\t: \"text-gray-300\"\r\n\t\t\t\t\t\t}`}\r\n\t\t\t\t\t/>\r\n\t\t\t\t))}\r\n\t\t\t</div>\r\n\t\t);\r\n\t};\r\n\r\n\t// Show loading state\r\n\tif (loading) {\r\n\t\treturn (\r\n\t\t\t<div className=\"container mx-auto flex items-center justify-center py-20\">\r\n\t\t\t\t<div className=\"text-center\">\r\n\t\t\t\t\t<Loader\r\n\t\t\t\t\t\tsize={40}\r\n\t\t\t\t\t\tclassName=\"animate-spin mx-auto mb-4 text-primary-600\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<p className=\"text-gray-600\">Cargando información del producto...</p>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\t// Show error state\r\n\tif (error || !product) {\r\n\t\treturn (\r\n\t\t\t<div className=\"container mx-auto py-20\">\r\n\t\t\t\t<div className=\"max-w-lg mx-auto bg-white p-8 rounded-xl shadow-md\">\r\n\t\t\t\t\t<h2 className=\"text-2xl font-bold text-red-600 mb-4\">Error</h2>\r\n\t\t\t\t\t<p className=\"text-gray-700 mb-6\">\r\n\t\t\t\t\t\t{error || \"No se encontró el producto solicitado.\"}\r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={() => navigate(-1)}\r\n\t\t\t\t\t\tclassName=\"bg-primary-600 text-white px-6 py-2 rounded-lg hover:bg-primary-700 transition-colors\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tVolver\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\t// Process product data for display\r\n\tconst categories = product.category ? [product.category.name] : [];\r\n\r\n\t// ✅ CORREGIDO - Función helper para obtener URL de imagen\r\n\tconst getImageUrlFromProduct = (image: string | ProductImage): string => {\r\n\t\tif (typeof image === \"string\") {\r\n\t\t\treturn getImageUrl(image);\r\n\t\t}\r\n\t\treturn getImageUrl(image.original || image.medium || image.thumbnail);\r\n\t};\r\n\r\n\t// ✅ CORREGIDO - Eliminar variable no utilizada mainImage\r\n\t// const mainImage = product.images && product.images.length > 0\r\n\t// \t? getImageUrlFromProduct(product.images[0])\r\n\t// \t: getImageUrl(null);\r\n\r\n\t// Parse colors, sizes, and tags\r\n\tconst parseStringArrays = (value: any): string[] => {\r\n\t\tif (!value) return [];\r\n\t\tif (Array.isArray(value)) {\r\n\t\t\t// If already an array of strings, return as is\r\n\t\t\tif (typeof value[0] === \"string\" && !value[0].startsWith(\"[\")) {\r\n\t\t\t\treturn value;\r\n\t\t\t}\r\n\t\t\t// If it's an array of JSON strings, parse them\r\n\t\t\ttry {\r\n\t\t\t\treturn value\r\n\t\t\t\t\t.join(\",\")\r\n\t\t\t\t\t.replace(/\\[|\\]|\"/g, \"\")\r\n\t\t\t\t\t.split(\",\");\r\n\t\t\t} catch (e) {\r\n\t\t\t\treturn [];\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn [];\r\n\t};\r\n\r\n\tconst colors = parseStringArrays(product.colors);\r\n\tconst sizes = parseStringArrays(product.sizes);\r\n\tconst tags = parseStringArrays(product.tags);\r\n\r\n\t// Create specification items from product data\r\n\tconst specifications = [\r\n\t\t{name: \"SKU\", value: product.sku || \"N/A\"},\r\n\t\t{name: \"Peso\", value: product.weight ? `${product.weight} kg` : \"N/A\"},\r\n\t\t{\r\n\t\t\tname: \"Dimensiones\",\r\n\t\t\tvalue:\r\n\t\t\t\tproduct.dimensions || (product.width && product.height && product.depth)\r\n\t\t\t\t\t? `${product.width} × ${product.height} × ${product.depth} cm`\r\n\t\t\t\t\t: \"N/A\",\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: \"Disponibilidad\",\r\n\t\t\tvalue: product.is_in_stock ? \"En stock\" : \"Agotado\",\r\n\t\t},\r\n\t\t{name: \"Categoría\", value: product.category?.name || \"N/A\"},\r\n\t];\r\n\r\n\treturn (\r\n\t\t<div className=\"container mx-auto px-4 py-10\">\r\n\t\t\t<div className=\"max-w-7xl mx-auto\">\r\n\t\t\t\t{/* Breadcrumbs */}\r\n\t\t\t\t<nav className=\"flex mb-6 text-sm text-gray-500\">\r\n\t\t\t\t\t<Link to=\"/\" className=\"hover:text-primary-600\">\r\n\t\t\t\t\t\tInicio\r\n\t\t\t\t\t</Link>\r\n\t\t\t\t\t<span className=\"mx-2\">/</span>\r\n\t\t\t\t\t{product.category && (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\tto={`/category/${product.category.slug}`}\r\n\t\t\t\t\t\t\t\tclassName=\"hover:text-primary-600\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{product.category.name}\r\n\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t<span className=\"mx-2\">/</span>\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t<span className=\"text-gray-700 font-medium\">{product.name}</span>\r\n\t\t\t\t</nav>\r\n\r\n\t\t\t\t<div className=\"bg-white rounded-xl shadow-lg overflow-hidden\">\r\n\t\t\t\t\t<div className=\"grid grid-cols-1 lg:grid-cols-2 gap-10 p-6 lg:p-10\">\r\n\t\t\t\t\t\t{/* Product Images */}\r\n\t\t\t\t\t\t<div className=\"space-y-6\">\r\n\t\t\t\t\t\t\t<div className=\"bg-gray-50 rounded-xl overflow-hidden h-96 lg:h-[500px]\">\r\n\t\t\t\t\t\t\t\t{product.images && product.images.length > 0 && (\r\n\t\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\t\tsrc={getImageUrlFromProduct(product.images[activeImage])}\r\n\t\t\t\t\t\t\t\t\t\talt={product.name}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"w-full h-full object-cover transition-all duration-300\"\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{product.images && product.images.length > 1 && (\r\n\t\t\t\t\t\t\t\t<div className=\"grid grid-cols-4 gap-3\">\r\n\t\t\t\t\t\t\t\t\t{product.images.map((image, index) => (\r\n\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName={`bg-gray-50 rounded-lg h-24 cursor-pointer border-2 transition-all overflow-hidden ${\r\n\t\t\t\t\t\t\t\t\t\t\t\tindex === activeImage\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? \"border-primary-500 shadow-md\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: \"border-transparent hover:border-gray-300\"\r\n\t\t\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => setActiveImage(index)}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\t\t\t\tsrc={getImageUrlFromProduct(image)}\r\n\t\t\t\t\t\t\t\t\t\t\t\talt={`${product.name} thumbnail ${index + 1}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full h-full object-cover\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{/* Product Info */}\r\n\t\t\t\t\t\t<div className=\"space-y-6\">\r\n\t\t\t\t\t\t\t{/* Product Header */}\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t{product.seller && (\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center mb-2\">\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm bg-primary-50 text-primary-700 px-2 py-0.5 rounded font-medium\">\r\n\t\t\t\t\t\t\t\t\t\t\t{product.seller.name || \"Vendedor\"}\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t{product.discount_percentage &&\r\n\t\t\t\t\t\t\t\t\tproduct.discount_percentage > 0 && (\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"ml-2 bg-red-100 text-red-700 px-2 py-0.5 rounded text-sm font-medium\">\r\n\t\t\t\t\t\t\t\t\t\t\t{product.discount_percentage}% DESCUENTO\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t<h1 className=\"text-3xl font-bold text-gray-900 mb-3\">\r\n\t\t\t\t\t\t\t\t\t{product.name}\r\n\t\t\t\t\t\t\t\t</h1>\r\n\r\n\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3 mb-4\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t\t\t\t\t{renderRatingStars(product.rating || 0)}\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-yellow-500 ml-1 font-medium\">\r\n\t\t\t\t\t\t\t\t\t\t\t{(product.rating || 0).toFixed(1)}\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"text-gray-500 text-sm\">\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium\">\r\n\t\t\t\t\t\t\t\t\t\t\t{product.rating_count || 0}\r\n\t\t\t\t\t\t\t\t\t\t</span>{\" \"}\r\n\t\t\t\t\t\t\t\t\t\tvaloraciones\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"text-gray-400\">|</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"text-sm text-gray-500\">\r\n\t\t\t\t\t\t\t\t\t\tSKU:{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-gray-700\">\r\n\t\t\t\t\t\t\t\t\t\t\t{product.sku || \"N/A\"}\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t{/* Price */}\r\n\t\t\t\t\t\t\t\t<div className=\"flex items-center mb-2\">\r\n\t\t\t\t\t\t\t\t\t<span className=\"text-3xl font-bold text-primary-700\">\r\n\t\t\t\t\t\t\t\t\t\t$\r\n\t\t\t\t\t\t\t\t\t\t{product.final_price\r\n\t\t\t\t\t\t\t\t\t\t\t? product.final_price.toFixed(2)\r\n\t\t\t\t\t\t\t\t\t\t\t: product.price.toFixed(2)}\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t{product.discount_percentage &&\r\n\t\t\t\t\t\t\t\t\t\tproduct.discount_percentage > 0 && (\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"ml-3 text-lg text-gray-500 line-through\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t${product.price.toFixed(2)}\r\n\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t{product.discount_percentage &&\r\n\t\t\t\t\t\t\t\t\tproduct.discount_percentage > 0 && (\r\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-green-600 font-medium mb-4\">\r\n\t\t\t\t\t\t\t\t\t\t\t¡Ahorra $\r\n\t\t\t\t\t\t\t\t\t\t\t{(product.price - (product.final_price || 0)).toFixed(2)}!\r\n\t\t\t\t\t\t\t\t\t\t\tOferta por tiempo limitado.\r\n\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t{/* Color Selection */}\r\n\t\t\t\t\t\t\t{colors.length > 0 && (\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<h3 className=\"font-medium text-gray-900 mb-3\">Color:</h3>\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex space-x-3\">\r\n\t\t\t\t\t\t\t\t\t\t{colors.map((color, index) => (\r\n\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"px-3 py-1 border border-gray-300 rounded-full cursor-pointer hover:border-primary-500\"\r\n\t\t\t\t\t\t\t\t\t\t\t\ttitle={color}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{color}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{/* Size Selection */}\r\n\t\t\t\t\t\t\t{sizes.length > 0 && (\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<h3 className=\"font-medium text-gray-900 mb-3\">Tamaño:</h3>\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex space-x-3\">\r\n\t\t\t\t\t\t\t\t\t\t{sizes.map((size, index) => (\r\n\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"px-3 py-1 border border-gray-300 rounded-full cursor-pointer hover:border-primary-500\"\r\n\t\t\t\t\t\t\t\t\t\t\t\ttitle={size}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{size}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{/* Quantity and Add to Cart */}\r\n\t\t\t\t\t\t\t<div className=\"flex flex-col sm:flex-row gap-4\">\r\n\t\t\t\t\t\t\t\t<div className=\"flex border border-gray-300 rounded-lg overflow-hidden h-12\">\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"px-4 bg-gray-50 text-gray-600 hover:bg-gray-100 flex items-center justify-center\"\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => handleQuantityChange(quantity - 1)}\r\n\t\t\t\t\t\t\t\t\t\tdisabled={quantity <= 1}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<Minus size={18} />\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"w-16 text-center border-x border-gray-300 text-gray-700 font-medium\"\r\n\t\t\t\t\t\t\t\t\t\tmin=\"1\"\r\n\t\t\t\t\t\t\t\t\t\tmax=\"10\"\r\n\t\t\t\t\t\t\t\t\t\tvalue={quantity}\r\n\t\t\t\t\t\t\t\t\t\tonChange={(e) =>\r\n\t\t\t\t\t\t\t\t\t\t\thandleQuantityChange(parseInt(e.target.value) || 1)\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"px-4 bg-gray-50 text-gray-600 hover:bg-gray-100 flex items-center justify-center\"\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => handleQuantityChange(quantity + 1)}\r\n\t\t\t\t\t\t\t\t\t\tdisabled={quantity >= 10}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<Plus size={18} />\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tclassName=\"flex-grow h-12 bg-primary-600 hover:bg-primary-700 text-white rounded-lg font-medium transition-colors duration-200 flex items-center justify-center\"\r\n\t\t\t\t\t\t\t\t\tonClick={handleAddToCart}\r\n\t\t\t\t\t\t\t\t\tdisabled={!product.is_in_stock}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<ShoppingCart size={20} className=\"mr-2\" />\r\n\t\t\t\t\t\t\t\t\t{product.is_in_stock\r\n\t\t\t\t\t\t\t\t\t\t? \"Añadir al Carrito\"\r\n\t\t\t\t\t\t\t\t\t\t: \"Producto Agotado\"}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tclassName=\"h-12 w-12 border border-gray-300 rounded-lg flex items-center justify-center text-gray-600 hover:text-primary-600 hover:border-primary-600 transition-colors duration-200\"\r\n\t\t\t\t\t\t\t\t\tonClick={handleAddToWishlist}\r\n\t\t\t\t\t\t\t\t\ttitle=\"Añadir a favoritos\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<Heart size={20} />\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tclassName=\"h-12 px-4 border border-gray-300 rounded-lg flex items-center justify-center text-gray-600 hover:text-primary-600 hover:border-primary-600 transition-colors duration-200\"\r\n\t\t\t\t\t\t\t\t\tonClick={handleChatWithSeller}\r\n\t\t\t\t\t\t\t\t\ttitle=\"Chatear con el vendedor\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<MessageSquare size={20} className=\"mr-2\" />\r\n\t\t\t\t\t\t\t\t\tContactar\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t{/* Delivery and Benefits */}\r\n\t\t\t\t\t\t\t<div className=\"bg-gray-50 rounded-xl p-5 space-y-4\">\r\n\t\t\t\t\t\t\t\t<div className=\"flex items-start\">\r\n\t\t\t\t\t\t\t\t\t<Truck\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"text-primary-600 mt-1 flex-shrink-0 mr-3\"\r\n\t\t\t\t\t\t\t\t\t\tsize={20}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t<h4 className=\"font-medium text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t\t\tEntrega rápida\r\n\t\t\t\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-gray-600\">\r\n\t\t\t\t\t\t\t\t\t\t\t{product.is_in_stock ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tDisponible para entrega en{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium\">1-3 días hábiles</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\"Producto agotado temporalmente\"\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"flex items-start\">\r\n\t\t\t\t\t\t\t\t\t<Shield\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"text-primary-600 mt-1 flex-shrink-0 mr-3\"\r\n\t\t\t\t\t\t\t\t\t\tsize={20}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t<h4 className=\"font-medium text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t\t\tGarantía de 1 año\r\n\t\t\t\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-gray-600\">\r\n\t\t\t\t\t\t\t\t\t\t\tGarantía del fabricante contra defectos\r\n\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<div className=\"flex items-start\">\r\n\t\t\t\t\t\t\t\t\t<RotateCcw\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"text-primary-600 mt-1 flex-shrink-0 mr-3\"\r\n\t\t\t\t\t\t\t\t\t\tsize={20}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t<h4 className=\"font-medium text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t\t\tDevolución gratuita\r\n\t\t\t\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-gray-600\">\r\n\t\t\t\t\t\t\t\t\t\t\tDevolución sin costo en los primeros 30 días\r\n\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t{/* Categories */}\r\n\t\t\t\t\t\t\t{(categories.length > 0 || tags.length > 0) && (\r\n\t\t\t\t\t\t\t\t<div className=\"pt-4 border-t border-gray-200\">\r\n\t\t\t\t\t\t\t\t\t{categories.length > 0 && (\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center mb-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-gray-600 mr-2\">Categorías:</span>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex flex-wrap gap-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{categories.map((category, index) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tto={`/category/${product.category?.slug || \"\"}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"bg-gray-100 hover:bg-gray-200 px-3 py-1 text-sm rounded-full text-gray-700 transition-colors\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{category}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t{tags.length > 0 && (\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-gray-600 mr-2\">Etiquetas:</span>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex flex-wrap gap-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{tags.map((tag, index) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tto={`/tags/${tag}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"bg-gray-100 hover:bg-gray-200 px-3 py-1 text-sm rounded-full text-gray-700 transition-colors\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{tag}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{/* Share */}\r\n\t\t\t\t\t\t\t<div className=\"flex items-center text-gray-500 text-sm\">\r\n\t\t\t\t\t\t\t\t<Share2 size={16} className=\"mr-2\" />\r\n\t\t\t\t\t\t\t\t<span>Compartir este producto</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Tabs */}\r\n\t\t\t\t\t<div className=\"border-t border-gray-200\">\r\n\t\t\t\t\t\t<div className=\"flex border-b border-gray-200\">\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclassName={`py-4 px-6 font-medium text-sm ${\r\n\t\t\t\t\t\t\t\t\tactiveTab === \"description\"\r\n\t\t\t\t\t\t\t\t\t\t? \"text-primary-600 border-b-2 border-primary-600\"\r\n\t\t\t\t\t\t\t\t\t\t: \"text-gray-500 hover:text-gray-700\"\r\n\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\tonClick={() => setActiveTab(\"description\")}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tDescripción\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclassName={`py-4 px-6 font-medium text-sm ${\r\n\t\t\t\t\t\t\t\t\tactiveTab === \"specifications\"\r\n\t\t\t\t\t\t\t\t\t\t? \"text-primary-600 border-b-2 border-primary-600\"\r\n\t\t\t\t\t\t\t\t\t\t: \"text-gray-500 hover:text-gray-700\"\r\n\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\tonClick={() => setActiveTab(\"specifications\")}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tEspecificaciones\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclassName={`py-4 px-6 font-medium text-sm ${\r\n\t\t\t\t\t\t\t\t\tactiveTab === \"reviews\"\r\n\t\t\t\t\t\t\t\t\t\t? \"text-primary-600 border-b-2 border-primary-600\"\r\n\t\t\t\t\t\t\t\t\t\t: \"text-gray-500 hover:text-gray-700\"\r\n\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\tonClick={() => setActiveTab(\"reviews\")}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tValoraciones\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className=\"p-6 lg:p-10\">\r\n\t\t\t\t\t\t\t{activeTab === \"description\" && (\r\n\t\t\t\t\t\t\t\t<div className=\"max-w-3xl space-y-6\">\r\n\t\t\t\t\t\t\t\t\t{product.short_description && (\r\n\t\t\t\t\t\t\t\t\t\t<p className=\"font-medium text-lg text-gray-800\">\r\n\t\t\t\t\t\t\t\t\t\t\t{product.short_description}\r\n\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t<p className=\"text-gray-700 leading-relaxed\">\r\n\t\t\t\t\t\t\t\t\t\t{product.description}\r\n\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{activeTab === \"specifications\" && (\r\n\t\t\t\t\t\t\t\t<div className=\"max-w-3xl\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"grid grid-cols-1 sm:grid-cols-2 gap-y-4 gap-x-8\">\r\n\t\t\t\t\t\t\t\t\t\t{specifications.map((spec, index) => (\r\n\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex border-b border-gray-100 pb-3\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"w-40 font-medium text-gray-700\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{spec.name}:\r\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-gray-600\">{spec.value}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{activeTab === \"reviews\" && (\r\n\t\t\t\t\t\t\t\t<div className=\"max-w-3xl\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center mb-6\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"mr-4\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-5xl font-bold text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{(product.rating || 0).toFixed(1)}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex mt-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{renderRatingStars(product.rating || 0)}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-sm text-gray-500 mt-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{product.rating_count || 0} valoraciones\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex-grow\">\r\n\t\t\t\t\t\t\t\t\t\t\t{/* Rating bars would go here */}\r\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-center text-gray-500\">\r\n\t\t\t\t\t\t\t\t\t\t\t\tNo hay valoraciones disponibles\r\n\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"ml-6\">\r\n\t\t\t\t\t\t\t\t\t\t\t<button className=\"px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-lg\">\r\n\t\t\t\t\t\t\t\t\t\t\t\tEscribir valoración\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{/* Related Products */}\r\n\t\t\t\t{product.related_products && product.related_products.length > 0 && (\r\n\t\t\t\t\t<div className=\"mt-16\">\r\n\t\t\t\t\t\t<h2 className=\"text-2xl font-bold mb-8\">Productos relacionados</h2>\r\n\t\t\t\t\t\t<div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n\t\t\t\t\t\t\t{product.related_products.map((relatedProduct) => (\r\n\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\tkey={relatedProduct.id}\r\n\t\t\t\t\t\t\t\t\tclassName=\"bg-white rounded-xl shadow-md overflow-hidden hover:shadow-lg transition-shadow\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<div className=\"h-52 bg-gray-50 flex items-center justify-center p-4\">\r\n\t\t\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\t\t\tsrc={getImageUrl(\r\n\t\t\t\t\t\t\t\t\t\t\t\trelatedProduct.images &&\r\n\t\t\t\t\t\t\t\t\t\t\t\t\trelatedProduct.images.length > 0\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? typeof relatedProduct.images[0] === \"string\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? relatedProduct.images[0]\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: (relatedProduct.images[0] as ProductImage)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.original ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(relatedProduct.images[0] as ProductImage).medium\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: null\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\talt={relatedProduct.name}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"max-h-full max-w-full object-contain\"\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"p-5\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center mb-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t{renderRatingStars(relatedProduct.rating || 0)}\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-gray-500 ml-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t({relatedProduct.rating || 0})\r\n\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<Link to={`/product/${relatedProduct.id}`}>\r\n\t\t\t\t\t\t\t\t\t\t\t<h3 className=\"font-medium text-gray-800 mb-2 hover:text-primary-600 transition-colors line-clamp-2 h-12\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{relatedProduct.name}\r\n\t\t\t\t\t\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-primary-600 font-bold\">\r\n\t\t\t\t\t\t\t\t\t\t\t$\r\n\t\t\t\t\t\t\t\t\t\t\t{relatedProduct.final_price\r\n\t\t\t\t\t\t\t\t\t\t\t\t? relatedProduct.final_price.toFixed(2)\r\n\t\t\t\t\t\t\t\t\t\t\t\t: relatedProduct.price.toFixed(2)}\r\n\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\t\t\t\tto={`/product/${relatedProduct.id}`}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"block w-full mt-3\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<button className=\"w-full bg-gray-100 hover:bg-gray-200 text-gray-800 py-2 rounded-lg font-medium text-sm transition-colors\">\r\n\t\t\t\t\t\t\t\t\t\t\t\tVer detalles\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default ProductItemPage;\r\n"],"names":["ProductItemPage","id","useParams","navigate","useNavigate","product","setProduct","useState","loading","setLoading","error","setError","quantity","setQuantity","activeImage","setActiveImage","activeTab","setActiveTab","addToCart","showNotification","useCart","toggleFavorite","useFavorites","createChat","useChat","productService","ProductService","useEffect","productId","productData","e","err","handleQuantityChange","newQuantity","handleAddToCart","NotificationType","handleAddToWishlist","handleChatWithSeller","sellerId","response","ApiClient","chatId","renderRatingStars","rating","jsx","star","Star","jsxs","Loader","categories","getImageUrlFromProduct","image","getImageUrl","parseStringArrays","value","colors","sizes","tags","specifications","Link","Fragment","index","color","size","Minus","Plus","ShoppingCart","Heart","MessageSquare","Truck","Shield","RotateCcw","category","tag","Share2","spec","relatedProduct"],"mappings":"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"}