import{d as A,e as L,u as F,r as t,j as e,L as T,s as R,t as I}from"./index-DmNDOrWy.js";const z=()=>{const c=A(),d=L(),{login:y}=F(),p=new URLSearchParams(d.search),b=p.get("token"),w=p.get("email"),v=d.state?.token,j=d.state?.email,[n,N]=t.useState(b||v||""),[o,k]=t.useState(w||j||""),[l,S]=t.useState(""),[m,C]=t.useState(""),[x,f]=t.useState(!1),[h,s]=t.useState(null),[g,P]=t.useState(null);t.useEffect(()=>{n||s("No se proporcionó un token válido para restablecer la contraseña"),o||s("Es necesario proporcionar un correo electrónico para restablecer la contraseña")},[n,o]);const E=async r=>{if(r.preventDefault(),l.length<8){s("La contraseña debe tener al menos 8 caracteres");return}if(l!==m){s("Las contraseñas no coinciden");return}f(!0),s(null);try{const a=await R.post(I.AUTH.RESET_PASSWORD,{token:n,email:o,password:l,password_confirmation:m});a.data?.success||a.status===200?(P("Contraseña actualizada correctamente. Serás redirigido para iniciar sesión."),a.data?.token||a.data?.auth_token?await y({email:o,password:l})?setTimeout(()=>{c("/")},1500):setTimeout(()=>{c("/login")},2e3):setTimeout(()=>{c("/login")},2e3)):s("No se pudo restablecer la contraseña. Inténtalo de nuevo.")}catch(a){if(console.error("Error al restablecer la contraseña:",a),a.response?.status===422){const u=a.response.data?.errors;if(u){const i=Object.values(u)[0];s(Array.isArray(i)?i[0]:i)}else s("Los datos proporcionados no son válidos")}else a.response?.data?.message?s(a.response.data.message):s("Error al procesar la solicitud. Inténtalo de nuevo más tarde.")}finally{f(!1)}};return e.jsx("div",{className:"min-h-[80vh] flex items-center justify-center py-12 px-4",children:e.jsxs("div",{className:"max-w-md w-full space-y-8 bg-white p-8 rounded-lg shadow-lg",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-3xl font-extrabold text-gray-900",children:"Crea tu nueva contraseña"}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:"Por favor, ingresa y confirma tu nueva contraseña"})]}),h&&e.jsx("div",{className:"bg-red-50 text-red-700 p-3 rounded-md text-sm",children:h}),g&&e.jsx("div",{className:"bg-green-50 text-green-700 p-3 rounded-md text-sm",children:g}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:E,children:[!o&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Correo electrónico"}),e.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-3 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:o,onChange:r=>k(r.target.value),placeholder:"tu@email.com"})]}),!n&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"token",className:"block text-sm font-medium text-gray-700",children:"Token de recuperación"}),e.jsx("input",{id:"token",name:"token",type:"text",autoComplete:"off",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-3 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:n,onChange:r=>N(r.target.value),placeholder:"Ingresa el token de recuperación"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Nueva contraseña"}),e.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-3 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:l,onChange:r=>S(r.target.value)}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"La contraseña debe tener al menos 8 caracteres"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirmar contraseña"}),e.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:"password",autoComplete:"new-password",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md shadow-sm p-3 focus:outline-none focus:ring-primary-500 focus:border-primary-500",value:m,onChange:r=>C(r.target.value)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(T,{to:"/login",className:"text-sm font-medium text-primary-600 hover:text-primary-500",children:"Volver al inicio de sesión"}),e.jsx("button",{type:"submit",disabled:x||!n||!o,className:"inline-flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:x?e.jsxs("span",{className:"flex items-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Actualizando..."]}):"Actualizar contraseña"})]})]})]})})};export{z as default};
//# sourceMappingURL=ResetPasswordPage-Gt2ISPHV.js.map
