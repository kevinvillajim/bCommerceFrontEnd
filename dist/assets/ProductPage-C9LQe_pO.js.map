{"version":3,"file":"ProductPage-C9LQe_pO.js","sources":["../../node_modules/lucide-react/dist/esm/icons/speaker.js","../../node_modules/lucide-react/dist/esm/icons/watch.js","../../src/utils/apiResponseInspector.ts","../../src/utils/debugUtils.ts","../../src/presentation/hooks/useProducts.ts","../../src/presentation/hooks/useProductFilters.ts","../../src/presentation/hooks/useProductSearch.ts","../../src/presentation/components/product/SearchBar.tsx","../../src/presentation/components/product/CategoriesCarousel.tsx","../../src/presentation/components/product/ProductFilters.tsx","../../src/utils/productAdapter.ts","../../src/presentation/components/product/ProductGrid.tsx","../../src/presentation/components/product/SortDropdown.tsx","../../src/presentation/components/product/MobileFilterPanel.tsx","../../src/presentation/components/product/ActiveFilters.tsx","../../src/presentation/components/product/Pagination.tsx","../../src/presentation/components/product/MobilePagination.tsx","../../src/utils/categoryUtils.ts","../../src/presentation/pages/ProductPage.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.484.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"rect\", { width: \"16\", height: \"20\", x: \"4\", y: \"2\", rx: \"2\", key: \"1nb95v\" }],\n  [\"path\", { d: \"M12 6h.01\", key: \"1vi96p\" }],\n  [\"circle\", { cx: \"12\", cy: \"14\", r: \"4\", key: \"1jruaj\" }],\n  [\"path\", { d: \"M12 14h.01\", key: \"1etili\" }]\n];\nconst Speaker = createLucideIcon(\"speaker\", __iconNode);\n\nexport { __iconNode, Speaker as default };\n//# sourceMappingURL=speaker.js.map\n","/**\n * @license lucide-react v0.484.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"6\", key: \"1vlfrh\" }],\n  [\"polyline\", { points: \"12 10 12 12 13 13\", key: \"19dquz\" }],\n  [\n    \"path\",\n    { d: \"m16.13 7.66-.81-4.05a2 2 0 0 0-2-1.61h-2.68a2 2 0 0 0-2 1.61l-.78 4.05\", key: \"18k57s\" }\n  ],\n  [\"path\", { d: \"m7.88 16.36.8 4a2 2 0 0 0 2 1.61h2.72a2 2 0 0 0 2-1.61l.81-4.05\", key: \"16ny36\" }]\n];\nconst Watch = createLucideIcon(\"watch\", __iconNode);\n\nexport { __iconNode, Watch as default };\n//# sourceMappingURL=watch.js.map\n","/**\r\n * Utilidad para inspeccionar y analizar respuestas de API\r\n * Ayuda a entender la estructura de datos y detectar problemas\r\n */\r\nexport class ApiResponseInspector {\r\n\t/**\r\n\t * Analiza e imprime la estructura de un objeto de respuesta de API\r\n\t * @param response El objeto de respuesta a analizar\r\n\t * @param label Etiqueta opcional para identificar la inspección\r\n\t */\r\n\tstatic inspectResponse(\r\n\t\tresponse: any,\r\n\t\tlabel: string = \"Inspección de respuesta API\"\r\n\t): void {\r\n\t\tconsole.group(label);\r\n\r\n\t\ttry {\r\n\t\t\tif (response === null || response === undefined) {\r\n\t\t\t\tconsole.warn(\"⚠️ La respuesta es nula o indefinida\");\r\n\t\t\t\tconsole.groupEnd();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconsole.log(\"Tipo de respuesta:\", typeof response);\r\n\r\n\t\t\tif (typeof response === \"object\") {\r\n\t\t\t\tif (Array.isArray(response)) {\r\n\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t\"📊 La respuesta es un array con\",\r\n\t\t\t\t\t\tresponse.length,\r\n\t\t\t\t\t\t\"elementos\"\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tif (response.length > 0) {\r\n\t\t\t\t\t\tconsole.log(\"Muestra del primer elemento:\");\r\n\t\t\t\t\t\tconsole.dir(response[0], {depth: 2});\r\n\r\n\t\t\t\t\t\t// Detectar propiedades en snake_case vs camelCase\r\n\t\t\t\t\t\tthis.analyzeNamingConvention(response[0]);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.log(\"🔍 La respuesta es un objeto\");\r\n\r\n\t\t\t\t\t// Analizar estructura de datos\r\n\t\t\t\t\tconst structure = this.analyzeObjectStructure(response);\r\n\t\t\t\t\tconsole.log(\"Estructura:\", structure);\r\n\r\n\t\t\t\t\t// Detectar si hay una estructura anidada tipo data.data\r\n\t\t\t\t\tif (response.data) {\r\n\t\t\t\t\t\tconsole.log('⚠️ La respuesta contiene una propiedad \"data\":');\r\n\r\n\t\t\t\t\t\tif (Array.isArray(response.data)) {\r\n\t\t\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t\t\t\"📊 response.data es un array con\",\r\n\t\t\t\t\t\t\t\tresponse.data.length,\r\n\t\t\t\t\t\t\t\t\"elementos\"\r\n\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\tif (response.data.length > 0) {\r\n\t\t\t\t\t\t\t\tconsole.log(\"Muestra del primer elemento de response.data:\");\r\n\t\t\t\t\t\t\t\tconsole.dir(response.data[0], {depth: 2});\r\n\r\n\t\t\t\t\t\t\t\t// Detectar propiedades en snake_case vs camelCase\r\n\t\t\t\t\t\t\t\tthis.analyzeNamingConvention(response.data[0]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else if (\r\n\t\t\t\t\t\t\ttypeof response.data === \"object\" &&\r\n\t\t\t\t\t\t\tresponse.data !== null\r\n\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\tconsole.log(\"🔍 response.data es un objeto\");\r\n\t\t\t\t\t\t\tconsole.dir(response.data, {depth: 2});\r\n\r\n\t\t\t\t\t\t\t// Verificar si hay datos anidados aún más profundos\r\n\t\t\t\t\t\t\tif (response.data.data) {\r\n\t\t\t\t\t\t\t\tconsole.log(\"⚠️⚠️ Se detectó una estructura anidada data.data\");\r\n\r\n\t\t\t\t\t\t\t\tif (Array.isArray(response.data.data)) {\r\n\t\t\t\t\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t\t\t\t\t\"📊 response.data.data es un array con\",\r\n\t\t\t\t\t\t\t\t\t\tresponse.data.data.length,\r\n\t\t\t\t\t\t\t\t\t\t\"elementos\"\r\n\t\t\t\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\t\t\t\tif (response.data.data.length > 0) {\r\n\t\t\t\t\t\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t\t\t\t\t\t\"Muestra del primer elemento de response.data.data:\"\r\n\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\tconsole.dir(response.data.data[0], {depth: 2});\r\n\r\n\t\t\t\t\t\t\t\t\t\t// Detectar propiedades en snake_case vs camelCase\r\n\t\t\t\t\t\t\t\t\t\tthis.analyzeNamingConvention(response.data.data[0]);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Verificar si hay una propiedad meta\r\n\t\t\t\t\tif (response.meta) {\r\n\t\t\t\t\t\tconsole.log(\"📝 La respuesta contiene metadatos:\");\r\n\t\t\t\t\t\tconsole.dir(response.meta, {depth: 2});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Detectar propiedades en snake_case vs camelCase\r\n\t\t\t\t\tthis.analyzeNamingConvention(response);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tconsole.log(\"⚠️ La respuesta no es un objeto ni un array:\", response);\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error durante la inspección:\", error);\r\n\t\t}\r\n\r\n\t\tconsole.groupEnd();\r\n\t}\r\n\r\n\t/**\r\n\t * Analiza la estructura general de un objeto\r\n\t * @param obj Objeto a analizar\r\n\t * @returns Descripción de la estructura\r\n\t */\r\n\tprivate static analyzeObjectStructure(obj: any): string {\r\n\t\tif (!obj || typeof obj !== \"object\") {\r\n\t\t\treturn \"No es un objeto\";\r\n\t\t}\r\n\r\n\t\tconst keys = Object.keys(obj);\r\n\r\n\t\tif (keys.length === 0) {\r\n\t\t\treturn \"Objeto vacío {}\";\r\n\t\t}\r\n\r\n\t\treturn `Objeto con ${keys.length} propiedades: [${keys.join(\", \")}]`;\r\n\t}\r\n\r\n\t/**\r\n\t * Analiza si las propiedades del objeto usan snake_case o camelCase\r\n\t * @param obj Objeto a analizar\r\n\t */\r\n\tprivate static analyzeNamingConvention(obj: any): void {\r\n\t\tif (!obj || typeof obj !== \"object\" || Array.isArray(obj)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst keys = Object.keys(obj);\r\n\r\n\t\tif (keys.length === 0) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst snakeCaseKeys = keys.filter((key) => key.includes(\"_\"));\r\n\t\tconst camelCaseKeys = keys.filter((key) => /[a-z][A-Z]/.test(key));\r\n\r\n\t\tconsole.log(\"Análisis de convención de nombres:\");\r\n\t\tconsole.log(\r\n\t\t\t`- Propiedades en snake_case: ${snakeCaseKeys.length} (${snakeCaseKeys.slice(0, 5).join(\", \")}${snakeCaseKeys.length > 5 ? \"...\" : \"\"})`\r\n\t\t);\r\n\t\tconsole.log(\r\n\t\t\t`- Propiedades en camelCase: ${camelCaseKeys.length} (${camelCaseKeys.slice(0, 5).join(\", \")}${camelCaseKeys.length > 5 ? \"...\" : \"\"})`\r\n\t\t);\r\n\r\n\t\tif (snakeCaseKeys.length > 0 && camelCaseKeys.length > 0) {\r\n\t\t\tconsole.warn(\"⚠️ El objeto mezcla convenciones snake_case y camelCase\");\r\n\t\t} else if (snakeCaseKeys.length > 0) {\r\n\t\t\tconsole.log(\"✅ El objeto usa consistentemente snake_case\");\r\n\t\t} else if (camelCaseKeys.length > 0) {\r\n\t\t\tconsole.log(\"✅ El objeto usa consistentemente camelCase\");\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default ApiResponseInspector;\r\n","// src/utils/debugUtils.ts\r\n\r\nimport type { ExtendedProductFilterParams } from \"../presentation/types/ProductFilterParams\";\r\nimport type { Category } from \"../core/domain/entities/Category\";\r\n\r\n/**\r\n * Utilidad para depurar parámetros de filtros\r\n */\r\nexport class DebugUtils {\r\n    /**\r\n     * Log detallado de los parámetros de filtro\r\n     */\r\n    static logFilterParams(params: ExtendedProductFilterParams, categories: Category[]): void {\r\n        console.group(\"🔍 DEBUG: Parámetros de filtro\");\r\n        \r\n        console.log(\"📋 Parámetros completos:\", params);\r\n        \r\n        // Verificar categorías\r\n        if (params.categoryIds && params.categoryIds.length > 0) {\r\n            console.group(\"📂 Categorías seleccionadas:\");\r\n            console.log(\"IDs enviados:\", params.categoryIds);\r\n            \r\n            params.categoryIds.forEach(id => {\r\n                const category = categories.find(c => c.id === id);\r\n                if (category) {\r\n                    console.log(`✅ ID ${id}: ${category.name}`);\r\n                } else {\r\n                    console.warn(`❌ ID ${id}: Categoría no encontrada`);\r\n                }\r\n            });\r\n            \r\n            console.log(\"Operador:\", params.categoryOperator || \"or\");\r\n            console.groupEnd();\r\n        }\r\n        \r\n        // Verificar precios\r\n        if (params.minPrice !== undefined || params.maxPrice !== undefined) {\r\n            console.group(\"💰 Filtros de precio:\");\r\n            if (params.minPrice !== undefined) console.log(\"Precio mínimo:\", params.minPrice);\r\n            if (params.maxPrice !== undefined) console.log(\"Precio máximo:\", params.maxPrice);\r\n            console.groupEnd();\r\n        }\r\n        \r\n        // Verificar rating\r\n        if (params.rating !== undefined) {\r\n            console.log(\"⭐ Rating mínimo:\", params.rating);\r\n        }\r\n        \r\n        // Verificar descuento\r\n        if (params.minDiscount !== undefined) {\r\n            console.log(\"🏷️ Descuento mínimo:\", params.minDiscount + \"%\");\r\n        }\r\n        \r\n        // Verificar ordenamiento\r\n        if (params.sortBy) {\r\n            console.log(\"🔄 Ordenamiento:\", `${params.sortBy} ${params.sortDir || 'desc'}`);\r\n        }\r\n        \r\n        // Verificar búsqueda\r\n        if (params.term) {\r\n            console.log(\"🔍 Término de búsqueda:\", params.term);\r\n        }\r\n        \r\n        console.groupEnd();\r\n    }\r\n    \r\n    /**\r\n     * Construye URL de depuración para probar manualmente\r\n     */\r\n    static buildDebugUrl(params: ExtendedProductFilterParams, baseUrl: string = \"http://127.0.0.1:8000/api\"): string {\r\n        const queryParams = new URLSearchParams();\r\n        \r\n        // Añadir todos los parámetros\r\n        Object.entries(params).forEach(([key, value]) => {\r\n            if (value !== undefined && value !== null) {\r\n                if (Array.isArray(value)) {\r\n                    queryParams.set(key, value.join(\",\"));\r\n                } else {\r\n                    queryParams.set(key, value.toString());\r\n                }\r\n            }\r\n        });\r\n        \r\n        const url = `${baseUrl}/products?${queryParams.toString()}`;\r\n        console.log(\"🔗 URL de prueba:\", url);\r\n        return url;\r\n    }\r\n    \r\n    /**\r\n     * Compara dos objetos de parámetros para ver diferencias\r\n     */\r\n    static compareParams(params1: ExtendedProductFilterParams, params2: ExtendedProductFilterParams): void {\r\n        console.group(\"🔍 Comparación de parámetros\");\r\n        \r\n        const allKeys = new Set([...Object.keys(params1), ...Object.keys(params2)]);\r\n        \r\n        allKeys.forEach(key => {\r\n            const val1 = (params1 as any)[key];\r\n            const val2 = (params2 as any)[key];\r\n            \r\n            if (JSON.stringify(val1) !== JSON.stringify(val2)) {\r\n                console.log(`📝 ${key}:`, {\r\n                    anterior: val1,\r\n                    actual: val2\r\n                });\r\n            }\r\n        });\r\n        \r\n        console.groupEnd();\r\n    }\r\n    \r\n    /**\r\n     * Valida que los parámetros estén correctamente formateados\r\n     */\r\n    static validateParams(params: ExtendedProductFilterParams): { isValid: boolean; errors: string[] } {\r\n        const errors: string[] = [];\r\n        \r\n        // Validar categoryIds\r\n        if (params.categoryIds) {\r\n            if (!Array.isArray(params.categoryIds)) {\r\n                errors.push(\"categoryIds debe ser un array\");\r\n            } else if (params.categoryIds.some(id => typeof id !== 'number' || id <= 0)) {\r\n                errors.push(\"categoryIds debe contener solo números positivos\");\r\n            }\r\n        }\r\n        \r\n        // Validar precios\r\n        if (params.minPrice !== undefined && (typeof params.minPrice !== 'number' || params.minPrice < 0)) {\r\n            errors.push(\"minPrice debe ser un número no negativo\");\r\n        }\r\n        \r\n        if (params.maxPrice !== undefined && (typeof params.maxPrice !== 'number' || params.maxPrice < 0)) {\r\n            errors.push(\"maxPrice debe ser un número no negativo\");\r\n        }\r\n        \r\n        if (params.minPrice !== undefined && params.maxPrice !== undefined && params.minPrice > params.maxPrice) {\r\n            errors.push(\"minPrice no puede ser mayor que maxPrice\");\r\n        }\r\n        \r\n        // Validar rating\r\n        if (params.rating !== undefined && (typeof params.rating !== 'number' || params.rating < 1 || params.rating > 5)) {\r\n            errors.push(\"rating debe ser un número entre 1 y 5\");\r\n        }\r\n        \r\n        // Validar descuento\r\n        if (params.minDiscount !== undefined && (typeof params.minDiscount !== 'number' || params.minDiscount < 0 || params.minDiscount > 100)) {\r\n            errors.push(\"minDiscount debe ser un número entre 0 y 100\");\r\n        }\r\n        \r\n        // Validar ordenamiento\r\n        if (params.sortDir && !['asc', 'desc'].includes(params.sortDir)) {\r\n            errors.push(\"sortDir debe ser 'asc' o 'desc'\");\r\n        }\r\n        \r\n        if (errors.length > 0) {\r\n            console.warn(\"❌ Errores de validación:\", errors);\r\n        }\r\n        \r\n        return {\r\n            isValid: errors.length === 0,\r\n            errors\r\n        };\r\n    }\r\n}","// src/presentation/hooks/useProducts.ts\r\nimport {useState, useCallback, useEffect} from \"react\";\r\nimport {ProductService} from \"../../core/services/ProductService\";\r\nimport CacheService from \"../../infrastructure/services/CacheService\";\r\nimport appConfig from \"../../config/appConfig\";\r\nimport ApiResponseInspector from \"../../utils/apiResponseInspector\";\r\nimport { DebugUtils } from \"../../utils/debugUtils\";\r\nimport type {\r\n\tProduct,\r\n\tProductDetail,\r\n\tProductListResponse,\r\n} from \"../../core/domain/entities/Product\";\r\nimport type { ExtendedProductFilterParams } from \"../types/ProductFilterParams\";\r\n\r\n// Crear instancia del servicio de productos\r\nconst productService = new ProductService();\r\n\r\n// Crear una clave de caché basada en los parámetros de filtro\r\nconst getCacheKey = (params?: ExtendedProductFilterParams): string => {\r\n\tif (!params) return \"products_default\";\r\n\r\n\t// Crear una copia para no modificar el original\r\n\tconst paramsForKey = {...params};\r\n\r\n\t// Asegurarse de que categoryIds se maneje correctamente\r\n\tif (paramsForKey.categoryIds) {\r\n\t\t// Ordenar para asegurar consistencia independientemente del orden\r\n\t\tparamsForKey.categoryIds = [...paramsForKey.categoryIds].sort(\r\n\t\t\t(a, b) => a - b\r\n\t\t);\r\n\t}\r\n\r\n\treturn `products_${JSON.stringify(paramsForKey)}`;\r\n};\r\n\r\n/**\r\n * Hook optimizado para operaciones de productos con debugging mejorado\r\n */\r\nexport const useProducts = () => {\r\n\tconst [loading, setLoading] = useState<boolean>(false);\r\n\tconst [error, setError] = useState<string | null>(null);\r\n\tconst [products, setProducts] = useState<Product[]>([]);\r\n\tconst [product, setProduct] = useState<ProductDetail | null>(null);\r\n\tconst [meta, setMeta] = useState<{\r\n\t\ttotal: number;\r\n\t\tlimit: number;\r\n\t\toffset: number;\r\n\t} | null>(null);\r\n\tconst [isInitialized, setIsInitialized] = useState<boolean>(false);\r\n\r\n\t// Función para adaptar datos de API a nuestro modelo - CORREGIDA CON DEBUGGING\r\n\tconst adaptProduct = useCallback((apiProduct: any): Product => {\r\n\t\t// Verificar que sea un objeto para prevenir errores\r\n\t\tif (!apiProduct || typeof apiProduct !== \"object\") {\r\n\t\t\tconsole.error(\"Producto inválido para adaptar:\", apiProduct);\r\n\t\t\treturn {} as Product;\r\n\t\t}\r\n\r\n\t\t// DEBUGGING DE IMÁGENES - VER QUÉ LLEGA DESDE LA API\r\n\t\tconsole.group(`🖼️ DEBUGGING IMÁGENES - Producto ID: ${apiProduct.id}`);\r\n\t\tconsole.log(\"📦 Producto completo desde API:\", apiProduct);\r\n\t\tconsole.log(\"🎨 Datos de imágenes originales:\", {\r\n\t\t\timages: apiProduct.images,\r\n\t\t\timage: apiProduct.image,\r\n\t\t\tmain_image: apiProduct.main_image,\r\n\t\t\tthumbnail: apiProduct.thumbnail,\r\n\t\t\tfeatured_image: apiProduct.featured_image\r\n\t\t});\r\n\r\n\t\t// Procesar imágenes de manera más robusta\r\n\t\tlet processedImages: string[] = [];\r\n\r\n\t\t// Prioridad 1: array images\r\n\t\tif (Array.isArray(apiProduct.images) && apiProduct.images.length > 0) {\r\n\t\t\tconsole.log(\"📋 Procesando array images:\", apiProduct.images);\r\n\t\t\t\r\n\t\t\tprocessedImages = apiProduct.images.map((img: any) => {\r\n\t\t\t\tif (typeof img === \"string\") {\r\n\t\t\t\t\tconsole.log(\"📄 Imagen como string:\", img);\r\n\t\t\t\t\treturn img;\r\n\t\t\t\t}\r\n\t\t\t\tif (typeof img === \"object\" && img !== null) {\r\n\t\t\t\t\t// Intentar extraer URL del objeto imagen\r\n\t\t\t\t\tconst imageUrl = img.original || \r\n\t\t\t\t\t\t\t\t   img.large || \r\n\t\t\t\t\t\t\t\t   img.medium || \r\n\t\t\t\t\t\t\t\t   img.thumbnail || \r\n\t\t\t\t\t\t\t\t   img.url || \r\n\t\t\t\t\t\t\t\t   img.path || \r\n\t\t\t\t\t\t\t\t   img.src || \r\n\t\t\t\t\t\t\t\t   \"\";\r\n\t\t\t\t\tconsole.log(\"🎯 Imagen extraída de objeto:\", imageUrl, \"desde:\", img);\r\n\t\t\t\t\treturn imageUrl;\r\n\t\t\t\t}\r\n\t\t\t\tconsole.warn(\"⚠️ Formato de imagen no reconocido:\", img);\r\n\t\t\t\treturn \"\";\r\n\t\t\t}).filter(Boolean); // Filtrar strings vacíos\r\n\t\t}\r\n\r\n\t\t// Prioridad 2: campo image (singular)\r\n\t\tif (processedImages.length === 0 && apiProduct.image) {\r\n\t\t\tconsole.log(\"📄 Usando campo image singular:\", apiProduct.image);\r\n\t\t\tprocessedImages = [apiProduct.image];\r\n\t\t}\r\n\r\n\t\t// Prioridad 3: campo main_image\r\n\t\tif (processedImages.length === 0 && apiProduct.main_image) {\r\n\t\t\tconsole.log(\"🌟 Usando campo main_image:\", apiProduct.main_image);\r\n\t\t\tprocessedImages = [apiProduct.main_image];\r\n\t\t}\r\n\r\n\t\t// Prioridad 4: campo featured_image\r\n\t\tif (processedImages.length === 0 && apiProduct.featured_image) {\r\n\t\t\tconsole.log(\"⭐ Usando campo featured_image:\", apiProduct.featured_image);\r\n\t\t\tprocessedImages = [apiProduct.featured_image];\r\n\t\t}\r\n\r\n\t\t// Prioridad 5: campo thumbnail\r\n\t\tif (processedImages.length === 0 && apiProduct.thumbnail) {\r\n\t\t\tconsole.log(\"🖼️ Usando campo thumbnail:\", apiProduct.thumbnail);\r\n\t\t\tprocessedImages = [apiProduct.thumbnail];\r\n\t\t}\r\n\r\n\t\tconsole.log(\"✅ Imágenes procesadas finales:\", processedImages);\r\n\t\tconsole.groupEnd();\r\n\r\n\t\t// Mapear propiedades para manejar tanto camelCase como snake_case\r\n\t\tconst adaptedProduct: Product = {\r\n\t\t\tid: apiProduct.id,\r\n\t\t\tuserId: apiProduct.userId || apiProduct.user_id,\r\n\t\t\tcategoryId: apiProduct.categoryId || apiProduct.category_id,\r\n\t\t\tname: apiProduct.name,\r\n\t\t\tslug: apiProduct.slug,\r\n\t\t\tdescription: apiProduct.description || \"\",\r\n\t\t\tprice: Number(apiProduct.price || 0),\r\n\t\t\tstock: Number(apiProduct.stock || 0),\r\n\t\t\tweight: apiProduct.weight,\r\n\t\t\twidth: apiProduct.width,\r\n\t\t\theight: apiProduct.height,\r\n\t\t\tdepth: apiProduct.depth,\r\n\t\t\tdimensions: apiProduct.dimensions,\r\n\t\t\tcolors: apiProduct.colors,\r\n\t\t\tsizes: apiProduct.sizes,\r\n\t\t\ttags: apiProduct.tags,\r\n\t\t\tsku: apiProduct.sku,\r\n\t\t\tattributes: apiProduct.attributes,\r\n\t\t\t// USAR LAS IMÁGENES PROCESADAS\r\n\t\t\timages: processedImages,\r\n\t\t\tfeatured: Boolean(apiProduct.featured),\r\n\t\t\tpublished: Boolean(apiProduct.published),\r\n\t\t\tstatus: apiProduct.status || \"active\",\r\n\t\t\tviewCount: apiProduct.viewCount || apiProduct.view_count || 0,\r\n\t\t\tsalesCount: apiProduct.salesCount || apiProduct.sales_count || 0,\r\n\t\t\tdiscountPercentage:\r\n\t\t\t\tapiProduct.discountPercentage || apiProduct.discount_percentage || 0,\r\n\t\t\tfinalPrice: apiProduct.finalPrice || apiProduct.final_price,\r\n\t\t\tisInStock: apiProduct.isInStock || apiProduct.is_in_stock,\r\n\t\t\trating: apiProduct.rating || apiProduct.rating_avg,\r\n\t\t\tratingCount: apiProduct.rating_count || apiProduct.rating_avg_count,\r\n\t\t\tcreatedAt: apiProduct.createdAt || apiProduct.created_at,\r\n\t\t\tupdatedAt: apiProduct.updatedAt || apiProduct.updated_at,\r\n\t\t};\r\n\r\n\t\t// Log final del producto adaptado\r\n\t\tconsole.log(\"🔄 Producto adaptado:\", {\r\n\t\t\tid: adaptedProduct.id,\r\n\t\t\tname: adaptedProduct.name,\r\n\t\t\timages: adaptedProduct.images,\r\n\t\t\tprice: adaptedProduct.price\r\n\t\t});\r\n\r\n\t\treturn adaptedProduct;\r\n\t}, []);\r\n\r\n\t// Inicializar el hook\r\n\tuseEffect(() => {\r\n\t\tif (!isInitialized) {\r\n\t\t\t// Verificar la caché para productos destacados\r\n\t\t\tconst cachedFeatured = CacheService.getItem(\"products_featured\");\r\n\t\t\tif (cachedFeatured) {\r\n\t\t\t\tsetProducts(cachedFeatured.data || []);\r\n\t\t\t\tsetMeta(cachedFeatured.meta || null);\r\n\t\t\t}\r\n\t\t\tsetIsInitialized(true);\r\n\t\t}\r\n\t}, [isInitialized]);\r\n\r\n\t/**\r\n\t * Recupera productos con filtros opcionales - FUNCIÓN CORREGIDA\r\n\t */\r\n\tconst fetchProducts = useCallback(\r\n\t\tasync (\r\n\t\t\tfilterParams?: ExtendedProductFilterParams\r\n\t\t): Promise<ProductListResponse | null> => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\ttry {\r\n\t\t\t\tconsole.group(\"🔄 Iniciando fetchProducts\");\r\n\t\t\t\t\r\n\t\t\t\t// Validar parámetros si existen\r\n\t\t\t\tif (filterParams) {\r\n\t\t\t\t\tconst validation = DebugUtils.validateParams(filterParams);\r\n\t\t\t\t\tif (!validation.isValid) {\r\n\t\t\t\t\t\tconsole.error(\"❌ Parámetros inválidos:\", validation.errors);\r\n\t\t\t\t\t\tsetError(`Parámetros inválidos: ${validation.errors.join(\", \")}`);\r\n\t\t\t\t\t\tsetLoading(false);\r\n\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Log de debugging\r\n\t\t\t\t\tconsole.log(\"📊 Parámetros recibidos:\", filterParams);\r\n\t\t\t\t\tDebugUtils.buildDebugUrl(filterParams);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Generar clave de caché basada en los parámetros\r\n\t\t\t\tconst cacheKey = getCacheKey(filterParams);\r\n\t\t\t\tconsole.log(\"🔑 Clave de caché:\", cacheKey);\r\n\r\n\t\t\t\t// Intentar obtener datos de caché primero\r\n\t\t\t\tconst cachedData = CacheService.getItem(cacheKey);\r\n\t\t\t\tif (cachedData) {\r\n\t\t\t\t\tconsole.log(\"💾 Usando datos en caché\");\r\n\t\t\t\t\tsetProducts(cachedData.data || []);\r\n\t\t\t\t\tsetMeta(cachedData.meta || null);\r\n\t\t\t\t\tsetLoading(false);\r\n\t\t\t\t\treturn cachedData;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconsole.log(\"🌐 Realizando petición a la API\");\r\n\t\t\t\tconst response = await productService.getProducts(filterParams);\r\n\r\n\t\t\t\tconsole.log(\"🔍 RESPUESTA RAW DE LA API:\", response);\r\n\r\n\t\t\t\tif (response) {\r\n\t\t\t\t\tconsole.log(\"✅ Respuesta recibida:\", response);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Usar la herramienta de inspección para analizar la estructura\r\n\t\t\t\t\tApiResponseInspector.inspectResponse(\r\n\t\t\t\t\t\tresponse,\r\n\t\t\t\t\t\t\"Respuesta de productos\"\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\t// Adaptar los datos si es necesario\r\n\t\t\t\t\tlet adaptedData: Product[] = [];\r\n\r\n\t\t\t\t\tif (Array.isArray(response.data)) {\r\n\t\t\t\t\t\tconsole.log(\"📦 Respuesta contiene un array en data\");\r\n\t\t\t\t\t\tadaptedData = response.data.map(adaptProduct);\r\n\t\t\t\t\t} else if (response.data && typeof response.data === \"object\") {\r\n\t\t\t\t\t\t// Si es un solo objeto en lugar de un array\r\n\t\t\t\t\t\tconsole.log(\"📦 Respuesta contiene un objeto en data\");\r\n\t\t\t\t\t\tadaptedData = [adaptProduct(response.data)];\r\n\t\t\t\t\t} else if (Array.isArray(response)) {\r\n\t\t\t\t\t\t// Si la respuesta es directamente un array\r\n\t\t\t\t\t\tconsole.log(\"📦 Respuesta es directamente un array\");\r\n\t\t\t\t\t\tadaptedData = response.map(adaptProduct);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst result: ProductListResponse = {\r\n\t\t\t\t\t\tdata: adaptedData,\r\n\t\t\t\t\t\tmeta: response.meta || {\r\n\t\t\t\t\t\t\ttotal: adaptedData.length,\r\n\t\t\t\t\t\t\tlimit: filterParams?.limit || 10,\r\n\t\t\t\t\t\t\toffset: filterParams?.offset || 0,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tconsole.log(\"💫 Datos adaptados:\", {\r\n\t\t\t\t\t\tproductCount: adaptedData.length,\r\n\t\t\t\t\t\tmeta: result.meta,\r\n\t\t\t\t\t\tfirstProduct: adaptedData[0]\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// Guardar en caché\r\n\t\t\t\t\tCacheService.setItem(\r\n\t\t\t\t\t\tcacheKey,\r\n\t\t\t\t\t\tresult,\r\n\t\t\t\t\t\tappConfig.cache.productCacheTime\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tsetProducts(adaptedData);\r\n\t\t\t\t\tsetMeta(result.meta);\r\n\r\n\t\t\t\t\tconsole.groupEnd();\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.warn(\"⚠️ Respuesta vacía de la API\");\r\n\t\t\t\t\tsetProducts([]);\r\n\t\t\t\t\tsetMeta({total: 0, limit: 0, offset: 0});\r\n\t\t\t\t\tconsole.groupEnd();\r\n\t\t\t\t\treturn {data: [], meta: {total: 0, limit: 0, offset: 0}};\r\n\t\t\t\t}\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error(\"❌ Error obteniendo productos:\", err);\r\n\t\t\t\tconst errorMessage =\r\n\t\t\t\t\terr instanceof Error ? err.message : \"Error al obtener productos\";\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\tsetProducts([]);\r\n\t\t\t\tsetMeta({total: 0, limit: 0, offset: 0});\r\n\t\t\t\tconsole.groupEnd();\r\n\t\t\t\treturn null;\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[adaptProduct]\r\n\t);\r\n\r\n\t/**\r\n\t * Recupera detalles de un producto por ID\r\n\t */\r\n\tconst fetchProductById = useCallback(\r\n\t\tasync (id: number): Promise<ProductDetail | null> => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\tconst cacheKey = `product_${id}`;\r\n\r\n\t\t\ttry {\r\n\t\t\t\t// Intentar obtener de caché primero\r\n\t\t\t\tconst cachedProduct = CacheService.getItem(cacheKey);\r\n\r\n\t\t\t\tif (cachedProduct) {\r\n\t\t\t\t\tconsole.log(`💾 Usando producto en caché con ID ${id}`);\r\n\t\t\t\t\tsetProduct(cachedProduct);\r\n\t\t\t\t\tsetLoading(false);\r\n\t\t\t\t\treturn cachedProduct;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconsole.log(`🌐 Obteniendo producto con ID ${id} desde API`);\r\n\t\t\t\tconst productDetailResponse = await productService.getProductById(id);\r\n\r\n\t\t\t\tif (productDetailResponse) {\r\n\t\t\t\t\tconsole.log(`✅ Producto con ID ${id} recibido:`, productDetailResponse);\r\n\t\t\t\t\t// Guardar en caché\r\n\t\t\t\t\tCacheService.setItem(\r\n\t\t\t\t\t\tcacheKey,\r\n\t\t\t\t\t\tproductDetailResponse,\r\n\t\t\t\t\t\tappConfig.cache.productCacheTime\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tsetProduct(productDetailResponse);\r\n\t\t\t\t\treturn productDetailResponse;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tsetProduct(null);\r\n\t\t\t\treturn null;\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error(\"❌ Error obteniendo detalles de producto:\", err);\r\n\t\t\t\tconst errorMessage =\r\n\t\t\t\t\terr instanceof Error\r\n\t\t\t\t\t\t? err.message\r\n\t\t\t\t\t\t: \"Error al obtener detalles del producto\";\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\tsetProduct(null);\r\n\t\t\t\treturn null;\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[]\r\n\t);\r\n\r\n\t/**\r\n\t * Recupera detalles de un producto por slug\r\n\t */\r\n\tconst fetchProductBySlug = useCallback(\r\n\t\tasync (slug: string): Promise<ProductDetail | null> => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\tconst cacheKey = `product_slug_${slug}`;\r\n\r\n\t\t\ttry {\r\n\t\t\t\t// Intentar obtener de caché primero\r\n\t\t\t\tconst cachedProduct = CacheService.getItem(cacheKey);\r\n\r\n\t\t\t\tif (cachedProduct) {\r\n\t\t\t\t\tconsole.log(`💾 Usando producto en caché con slug ${slug}`);\r\n\t\t\t\t\tsetProduct(cachedProduct);\r\n\t\t\t\t\tsetLoading(false);\r\n\t\t\t\t\treturn cachedProduct;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconsole.log(`🌐 Obteniendo producto con slug ${slug} desde API`);\r\n\t\t\t\tconst productDetailResponse =\r\n\t\t\t\t\tawait productService.getProductBySlug(slug);\r\n\r\n\t\t\t\tif (productDetailResponse) {\r\n\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t`✅ Producto con slug ${slug} recibido:`,\r\n\t\t\t\t\t\tproductDetailResponse\r\n\t\t\t\t\t);\r\n\t\t\t\t\t// Guardar en caché\r\n\t\t\t\t\tCacheService.setItem(\r\n\t\t\t\t\t\tcacheKey,\r\n\t\t\t\t\t\tproductDetailResponse,\r\n\t\t\t\t\t\tappConfig.cache.productCacheTime\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tsetProduct(productDetailResponse);\r\n\t\t\t\t\treturn productDetailResponse;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tsetProduct(null);\r\n\t\t\t\treturn null;\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error(\"❌ Error obteniendo detalles de producto por slug:\", err);\r\n\t\t\t\tconst errorMessage =\r\n\t\t\t\t\terr instanceof Error\r\n\t\t\t\t\t\t? err.message\r\n\t\t\t\t\t\t: \"Error al obtener detalles del producto\";\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\tsetProduct(null);\r\n\t\t\t\treturn null;\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[]\r\n\t);\r\n\r\n\t/**\r\n\t * Recupera productos destacados\r\n\t */\r\n\tconst fetchFeaturedProducts = useCallback(\r\n\t\tasync (limit: number = 8): Promise<Product[]> => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\tconst cacheKey = `products_featured_${limit}`;\r\n\r\n\t\t\ttry {\r\n\t\t\t\t// Intentar obtener de caché primero\r\n\t\t\t\tconst cachedProducts = CacheService.getItem(cacheKey);\r\n\r\n\t\t\t\tif (cachedProducts) {\r\n\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t`💾 Usando productos destacados en caché (límite: ${limit})`\r\n\t\t\t\t\t);\r\n\t\t\t\t\tsetProducts(cachedProducts);\r\n\t\t\t\t\tsetLoading(false);\r\n\t\t\t\t\treturn cachedProducts;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconsole.log(\r\n\t\t\t\t\t`🌐 Obteniendo productos destacados desde API (límite: ${limit})`\r\n\t\t\t\t);\r\n\t\t\t\tconst featuredProducts =\r\n\t\t\t\t\tawait productService.getFeaturedProducts(limit);\r\n\r\n\t\t\t\tif (featuredProducts && featuredProducts.length > 0) {\r\n\t\t\t\t\tconsole.log(`✅ Productos destacados recibidos:`, featuredProducts);\r\n\r\n\t\t\t\t\t// Adaptar datos si es necesario\r\n\t\t\t\t\tconst adaptedProducts = featuredProducts.map(adaptProduct);\r\n\r\n\t\t\t\t\t// Guardar en caché\r\n\t\t\t\t\tCacheService.setItem(\r\n\t\t\t\t\t\tcacheKey,\r\n\t\t\t\t\t\tadaptedProducts,\r\n\t\t\t\t\t\tappConfig.cache.productCacheTime\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tsetProducts(adaptedProducts);\r\n\t\t\t\t\treturn adaptedProducts;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tsetProducts([]);\r\n\t\t\t\treturn [];\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error(\"❌ Error obteniendo productos destacados:\", err);\r\n\t\t\t\tconst errorMessage =\r\n\t\t\t\t\terr instanceof Error\r\n\t\t\t\t\t\t? err.message\r\n\t\t\t\t\t\t: \"Error al obtener productos destacados\";\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\tsetProducts([]);\r\n\t\t\t\treturn [];\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[adaptProduct]\r\n\t);\r\n\r\n\t/**\r\n\t * Recupera productos relacionados\r\n\t */\r\n\tconst fetchRelatedProducts = useCallback(\r\n\t\tasync (productId: number, limit: number = 4): Promise<Product[]> => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\tconst cacheKey = `products_related_${productId}_${limit}`;\r\n\r\n\t\t\ttry {\r\n\t\t\t\t// Intentar obtener de caché primero\r\n\t\t\t\tconst cachedProducts = CacheService.getItem(cacheKey);\r\n\r\n\t\t\t\tif (cachedProducts) {\r\n\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t`💾 Usando productos relacionados en caché para producto ${productId}`\r\n\t\t\t\t\t);\r\n\t\t\t\t\tsetLoading(false);\r\n\t\t\t\t\treturn cachedProducts;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconsole.log(\r\n\t\t\t\t\t`🌐 Obteniendo productos relacionados desde API para producto ${productId}`\r\n\t\t\t\t);\r\n\t\t\t\tconst relatedProducts = await productService.getRelatedProducts(\r\n\t\t\t\t\tproductId,\r\n\t\t\t\t\tlimit\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif (relatedProducts && relatedProducts.length > 0) {\r\n\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t`✅ Productos relacionados recibidos para producto ${productId}:`,\r\n\t\t\t\t\t\trelatedProducts\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\t// Adaptar datos si es necesario\r\n\t\t\t\t\tconst adaptedProducts = relatedProducts.map(adaptProduct);\r\n\r\n\t\t\t\t\t// Guardar en caché\r\n\t\t\t\t\tCacheService.setItem(\r\n\t\t\t\t\t\tcacheKey,\r\n\t\t\t\t\t\tadaptedProducts,\r\n\t\t\t\t\t\tappConfig.cache.productCacheTime\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\treturn adaptedProducts;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn [];\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error(\"❌ Error obteniendo productos relacionados:\", err);\r\n\t\t\t\tconst errorMessage =\r\n\t\t\t\t\terr instanceof Error\r\n\t\t\t\t\t\t? err.message\r\n\t\t\t\t\t\t: \"Error al obtener productos relacionados\";\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\treturn [];\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[adaptProduct]\r\n\t);\r\n\r\n\t/**\r\n\t * Registra visualización de producto\r\n\t */\r\n\tconst trackProductView = useCallback(\r\n\t\tasync (productId: number): Promise<void> => {\r\n\t\t\ttry {\r\n\t\t\t\tawait productService.trackProductView(productId);\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error(\"❌ Error registrando visualización de producto:\", err);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[]\r\n\t);\r\n\r\n\t/**\r\n\t * Limpia la caché de productos\r\n\t */\r\n\tconst clearProductCache = useCallback((productId?: number): void => {\r\n\t\tif (productId) {\r\n\t\t\t// Limpiar caché específica de un producto\r\n\t\t\tCacheService.removeItem(`product_${productId}`);\r\n\t\t\tconsole.log(`🗑️ Caché del producto ${productId} eliminada`);\r\n\t\t} else {\r\n\t\t\t// Identificar y limpiar todas las claves de caché relacionadas con productos\r\n\t\t\tconst allKeys = Object.keys(localStorage);\r\n\t\t\tconst productKeys = allKeys.filter(\r\n\t\t\t\t(key) => key.startsWith(\"product_\") || key.startsWith(\"products_\")\r\n\t\t\t);\r\n\r\n\t\t\tproductKeys.forEach((key) => {\r\n\t\t\t\tCacheService.removeItem(key);\r\n\t\t\t});\r\n\r\n\t\t\tconsole.log(\r\n\t\t\t\t`🗑️ ${productKeys.length} claves de caché de productos eliminadas`\r\n\t\t\t);\r\n\t\t}\r\n\t}, []);\r\n\r\n\treturn {\r\n\t\tloading,\r\n\t\terror,\r\n\t\tproducts,\r\n\t\tproduct,\r\n\t\tmeta,\r\n\t\tfetchProducts,\r\n\t\tfetchProductById,\r\n\t\tfetchProductBySlug,\r\n\t\tfetchFeaturedProducts,\r\n\t\tfetchRelatedProducts,\r\n\t\ttrackProductView,\r\n\t\tclearProductCache,\r\n\t};\r\n};\r\n\r\nexport default useProducts;","import {useState, useEffect, useCallback, useRef} from \"react\";\r\nimport {useSearchParams} from \"react-router-dom\";\r\nimport type {ExtendedProductFilterParams} from \"../types/ProductFilterParams\";\r\nimport type {Category} from \"../../core/domain/entities/Category\";\r\nimport appConfig from \"../../config/appConfig\";\r\n\r\ninterface ProductFiltersState {\r\n\tcategories: string[];\r\n\tpriceRange: {min: number; max: number} | null;\r\n\trating: number | null;\r\n\tdiscount: boolean;\r\n\tsortBy: string;\r\n\tpage: number;\r\n\tsearchTerm: string;\r\n}\r\n\r\nexport const useProductFilters = (\r\n\tallCategories: Category[],\r\n\tdefaultPageSize: number = appConfig.pagination.defaultPageSize\r\n) => {\r\n\tconst [searchParams, setSearchParams] = useSearchParams();\r\n\r\n\t// Estado para evitar bucles infinitos\r\n\tconst isUpdatingUrl = useRef(false);\r\n\tconst lastProcessedParams = useRef<string>(\"\");\r\n\r\n\t// Inicializar estado desde URL al momento de crear el estado\r\n\tconst [filtersState, setFiltersState] = useState<ProductFiltersState>(() => {\r\n\t\tconst categoryParam = searchParams.get(\"category\");\r\n\t\tconst minPriceParam = searchParams.get(\"minPrice\");\r\n\t\tconst maxPriceParam = searchParams.get(\"maxPrice\");\r\n\t\tconst ratingParam = searchParams.get(\"rating\");\r\n\t\tconst discountParam = searchParams.get(\"discount\");\r\n\t\tconst sortParam = searchParams.get(\"sort\");\r\n\t\tconst pageParam = searchParams.get(\"page\");\r\n\t\tconst searchParam = searchParams.get(\"search\");\r\n\r\n\t\tconsole.log(\"useProductFilters: Inicializando desde URL:\", {\r\n\t\t\tcategoryParam,\r\n\t\t\tminPriceParam,\r\n\t\t\tmaxPriceParam,\r\n\t\t\tratingParam,\r\n\t\t\tdiscountParam,\r\n\t\t\tsortParam,\r\n\t\t\tpageParam,\r\n\t\t\tsearchParam\r\n\t\t});\r\n\r\n\t\treturn {\r\n\t\t\tcategories: categoryParam ? categoryParam.split(\",\").map(c => decodeURIComponent(c)) : [],\r\n\t\t\tpriceRange:\r\n\t\t\t\tminPriceParam && maxPriceParam\r\n\t\t\t\t\t? {min: parseInt(minPriceParam), max: parseInt(maxPriceParam)}\r\n\t\t\t\t\t: null,\r\n\t\t\trating: ratingParam ? parseInt(ratingParam) : null,\r\n\t\t\tdiscount: discountParam === \"true\",\r\n\t\t\tsortBy: sortParam || \"featured\",\r\n\t\t\tpage: pageParam ? parseInt(pageParam) : 1,\r\n\t\t\tsearchTerm: searchParam || \"\",\r\n\t\t};\r\n\t});\r\n\r\n\t// Este useEffect actualiza la URL cuando cambia el estado\r\n\tuseEffect(() => {\r\n\t\t// Solo actualizar URL si estamos actualizando desde el estado\r\n\t\tif (!isUpdatingUrl.current) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst newParams = new URLSearchParams();\r\n\r\n\t\t// Gestionar categorías\r\n\t\tif (filtersState.categories.length > 0) {\r\n\t\t\tnewParams.set(\"category\", filtersState.categories.map(c => encodeURIComponent(c)).join(\",\"));\r\n\t\t}\r\n\r\n\t\t// Gestionar rango de precio\r\n\t\tif (filtersState.priceRange) {\r\n\t\t\tnewParams.set(\"minPrice\", filtersState.priceRange.min.toString());\r\n\t\t\tnewParams.set(\"maxPrice\", filtersState.priceRange.max.toString());\r\n\t\t}\r\n\r\n\t\t// Gestionar rating\r\n\t\tif (filtersState.rating) {\r\n\t\t\tnewParams.set(\"rating\", filtersState.rating.toString());\r\n\t\t}\r\n\r\n\t\t// Gestionar descuento\r\n\t\tif (filtersState.discount) {\r\n\t\t\tnewParams.set(\"discount\", \"true\");\r\n\t\t}\r\n\r\n\t\t// Gestionar ordenamiento\r\n\t\tif (filtersState.sortBy !== \"featured\") {\r\n\t\t\tnewParams.set(\"sort\", filtersState.sortBy);\r\n\t\t}\r\n\r\n\t\t// Gestionar página\r\n\t\tif (filtersState.page > 1) {\r\n\t\t\tnewParams.set(\"page\", filtersState.page.toString());\r\n\t\t}\r\n\r\n\t\t// Gestionar término de búsqueda\r\n\t\tif (filtersState.searchTerm) {\r\n\t\t\tnewParams.set(\"search\", filtersState.searchTerm);\r\n\t\t}\r\n\r\n\t\tconst newParamsString = newParams.toString();\r\n\t\tconsole.log(\"useProductFilters: Actualizando URL:\", newParamsString);\r\n\r\n\t\tsetSearchParams(newParams, {replace: true});\r\n\t\t\r\n\t\t// Resetear el flag después de un pequeño delay\r\n\t\tsetTimeout(() => {\r\n\t\t\tisUpdatingUrl.current = false;\r\n\t\t}, 100);\r\n\t}, [filtersState, setSearchParams]);\r\n\r\n\t// Este useEffect actualiza el estado cuando cambia la URL\r\n\tuseEffect(() => {\r\n\t\tconst currentParams = searchParams.toString();\r\n\t\t\r\n\t\t// Si ya procesamos estos parámetros, no hacer nada\r\n\t\tif (currentParams === lastProcessedParams.current) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlastProcessedParams.current = currentParams;\r\n\r\n\t\tconsole.log(\"useProductFilters: URL cambió, actualizando estado:\", currentParams);\r\n\r\n\t\tconst categoryParam = searchParams.get(\"category\");\r\n\t\tconst minPriceParam = searchParams.get(\"minPrice\");\r\n\t\tconst maxPriceParam = searchParams.get(\"maxPrice\");\r\n\t\tconst ratingParam = searchParams.get(\"rating\");\r\n\t\tconst discountParam = searchParams.get(\"discount\");\r\n\t\tconst sortParam = searchParams.get(\"sort\");\r\n\t\tconst pageParam = searchParams.get(\"page\");\r\n\t\tconst searchParam = searchParams.get(\"search\");\r\n\r\n\t\tsetFiltersState({\r\n\t\t\tcategories: categoryParam ? categoryParam.split(\",\").map(c => decodeURIComponent(c)) : [],\r\n\t\t\tpriceRange:\r\n\t\t\t\tminPriceParam && maxPriceParam\r\n\t\t\t\t\t? {min: parseInt(minPriceParam), max: parseInt(maxPriceParam)}\r\n\t\t\t\t\t: null,\r\n\t\t\trating: ratingParam ? parseInt(ratingParam) : null,\r\n\t\t\tdiscount: discountParam === \"true\",\r\n\t\t\tsortBy: sortParam || \"featured\",\r\n\t\t\tpage: pageParam ? parseInt(pageParam) : 1,\r\n\t\t\tsearchTerm: searchParam || \"\",\r\n\t\t});\r\n\t}, [searchParams]);\r\n\r\n\t// Función helper para actualizar estado y URL\r\n\tconst updateFiltersAndUrl = useCallback((updates: Partial<ProductFiltersState>) => {\r\n\t\tisUpdatingUrl.current = true;\r\n\t\tsetFiltersState((prev) => ({\r\n\t\t\t...prev,\r\n\t\t\t...updates,\r\n\t\t\tpage: updates.page !== undefined ? updates.page : 1, // Resetear página excepto si se especifica\r\n\t\t}));\r\n\t}, []);\r\n\r\n\t// Funciones para actualizar filtros\r\n\tconst setCategories = useCallback((categories: string[]) => {\r\n\t\tconsole.log(\"useProductFilters: Actualizando categorías:\", categories);\r\n\t\tupdateFiltersAndUrl({ categories });\r\n\t}, [updateFiltersAndUrl]);\r\n\r\n\tconst setPriceRange = useCallback(\r\n\t\t(priceRange: {min: number; max: number} | null) => {\r\n\t\t\tconsole.log(\"useProductFilters: Actualizando rango de precio:\", priceRange);\r\n\t\t\tupdateFiltersAndUrl({ priceRange });\r\n\t\t},\r\n\t\t[updateFiltersAndUrl]\r\n\t);\r\n\r\n\tconst setRating = useCallback((rating: number | null) => {\r\n\t\tconsole.log(\"useProductFilters: Actualizando rating:\", rating);\r\n\t\tupdateFiltersAndUrl({ rating });\r\n\t}, [updateFiltersAndUrl]);\r\n\r\n\tconst setDiscount = useCallback((discount: boolean) => {\r\n\t\tconsole.log(\"useProductFilters: Actualizando descuento:\", discount);\r\n\t\tupdateFiltersAndUrl({ discount });\r\n\t}, [updateFiltersAndUrl]);\r\n\r\n\tconst setSortBy = useCallback((sortBy: string) => {\r\n\t\tconsole.log(\"useProductFilters: Actualizando ordenamiento:\", sortBy);\r\n\t\tupdateFiltersAndUrl({ sortBy });\r\n\t}, [updateFiltersAndUrl]);\r\n\r\n\tconst setPage = useCallback((page: number) => {\r\n\t\tconsole.log(\"useProductFilters: Actualizando página:\", page);\r\n\t\tupdateFiltersAndUrl({ page });\r\n\t}, [updateFiltersAndUrl]);\r\n\r\n\tconst setSearchTerm = useCallback((searchTerm: string) => {\r\n\t\tconsole.log(\"useProductFilters: Actualizando término de búsqueda:\", searchTerm);\r\n\t\tupdateFiltersAndUrl({ searchTerm });\r\n\t}, [updateFiltersAndUrl]);\r\n\r\n\tconst clearFilters = useCallback(() => {\r\n\t\tconsole.log(\"useProductFilters: Limpiando todos los filtros\");\r\n\t\tupdateFiltersAndUrl({\r\n\t\t\tcategories: [],\r\n\t\t\tpriceRange: null,\r\n\t\t\trating: null,\r\n\t\t\tdiscount: false,\r\n\t\t\tsortBy: \"featured\",\r\n\t\t\tpage: 1,\r\n\t\t\tsearchTerm: \"\",\r\n\t\t});\r\n\t}, [updateFiltersAndUrl]);\r\n\r\n\t// Función para alternar una categoría\r\n\tconst toggleCategory = useCallback((category: string) => {\r\n\t\tconsole.log(\"useProductFilters: Alternando categoría:\", category);\r\n\t\tsetFiltersState((prev) => {\r\n\t\t\tconst isSelected = prev.categories.includes(category);\r\n\t\t\tconst newCategories = isSelected\r\n\t\t\t\t? prev.categories.filter((c) => c !== category)\r\n\t\t\t\t: [...prev.categories, category];\r\n\r\n\t\t\t// Actualizar estado y URL\r\n\t\t\tisUpdatingUrl.current = true;\r\n\t\t\treturn {\r\n\t\t\t\t...prev,\r\n\t\t\t\tcategories: newCategories,\r\n\t\t\t\tpage: 1,\r\n\t\t\t};\r\n\t\t});\r\n\t}, []);\r\n\r\n\t// Construir los parámetros para la API - FUNCIÓN CORREGIDA\r\n\tconst buildFilterParams = useCallback((): ExtendedProductFilterParams => {\r\n\t\tconsole.log(\"useProductFilters: Construyendo parámetros desde estado:\", filtersState);\r\n\r\n\t\tconst params: ExtendedProductFilterParams = {\r\n\t\t\tlimit: defaultPageSize,\r\n\t\t\toffset: (filtersState.page - 1) * defaultPageSize,\r\n\t\t\tpublished: true,\r\n\t\t\tstatus: 'active',\r\n\t\t};\r\n\r\n\t\t// Manejar término de búsqueda\r\n\t\tif (filtersState.searchTerm) {\r\n\t\t\tparams.term = filtersState.searchTerm;\r\n\t\t}\r\n\r\n\t\t// Manejar selección múltiple de categorías - CORREGIDO\r\n\t\tif (filtersState.categories.length > 0) {\r\n\t\t\t// Encontrar IDs de categorías por nombre\r\n\t\t\tconst categoryIds: number[] = [];\r\n\t\t\t\r\n\t\t\tfiltersState.categories.forEach((catName) => {\r\n\t\t\t\tconst category = allCategories.find(\r\n\t\t\t\t\t(c) => c.name.toLowerCase().trim() === catName.toLowerCase().trim()\r\n\t\t\t\t);\r\n\t\t\t\tif (category?.id) {\r\n\t\t\t\t\tcategoryIds.push(category.id);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.warn(`useProductFilters: No se encontró categoría: \"${catName}\"`);\r\n\t\t\t\t\tconsole.log(\"useProductFilters: Categorías disponibles:\", allCategories.map(c => c.name));\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tconsole.log(\"useProductFilters: IDs de categorías encontrados:\", categoryIds, \"para nombres:\", filtersState.categories);\r\n\r\n\t\t\tif (categoryIds.length > 0) {\r\n\t\t\t\tparams.categoryIds = categoryIds;\r\n\t\t\t\tparams.categoryOperator = \"or\"; // OR para mostrar productos de cualquiera de las categorías\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Añadir rango de precio si está seleccionado\r\n\t\tif (filtersState.priceRange) {\r\n\t\t\tparams.minPrice = filtersState.priceRange.min;\r\n\t\t\tparams.maxPrice = filtersState.priceRange.max;\r\n\t\t}\r\n\r\n\t\t// Añadir filtro de rating\r\n\t\tif (filtersState.rating) {\r\n\t\t\tparams.rating = filtersState.rating;\r\n\t\t}\r\n\r\n\t\t// Añadir filtro de descuento\r\n\t\tif (filtersState.discount) {\r\n\t\t\tparams.minDiscount = 5; // Productos con al menos 5% de descuento\r\n\t\t}\r\n\r\n\t\t// Añadir ordenamiento - CORREGIDO\r\n\t\tswitch (filtersState.sortBy) {\r\n\t\t\tcase \"price-asc\":\r\n\t\t\t\tparams.sortBy = \"price\";\r\n\t\t\t\tparams.sortDir = \"asc\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"price-desc\":\r\n\t\t\t\tparams.sortBy = \"price\";\r\n\t\t\t\tparams.sortDir = \"desc\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"name-asc\":\r\n\t\t\t\tparams.sortBy = \"name\";\r\n\t\t\t\tparams.sortDir = \"asc\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"name-desc\":\r\n\t\t\t\tparams.sortBy = \"name\";\r\n\t\t\t\tparams.sortDir = \"desc\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"newest\":\r\n\t\t\t\tparams.sortBy = \"created_at\";\r\n\t\t\t\tparams.sortDir = \"desc\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"rating\":\r\n\t\t\t\tparams.sortBy = \"rating\";\r\n\t\t\t\tparams.sortDir = \"desc\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"featured\":\r\n\t\t\tdefault:\r\n\t\t\t\tparams.sortBy = \"featured\";\r\n\t\t\t\tparams.sortDir = \"desc\";\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tconsole.log(\"useProductFilters: Parámetros finales para API:\", params);\r\n\t\treturn params;\r\n\t}, [filtersState, allCategories, defaultPageSize]);\r\n\r\n\treturn {\r\n\t\tfilters: filtersState,\r\n\t\tbuildFilterParams,\r\n\t\tsetCategories,\r\n\t\tsetPriceRange,\r\n\t\tsetRating,\r\n\t\tsetDiscount,\r\n\t\tsetSortBy,\r\n\t\tsetPage,\r\n\t\tsetSearchTerm,\r\n\t\tclearFilters,\r\n\t\ttoggleCategory,\r\n\t};\r\n};\r\n\r\nexport default useProductFilters;","import {useState, useCallback} from \"react\";\r\n\r\nexport const useProductSearch = () => {\r\n\tconst [searchTerm, setSearchTerm] = useState(\"\");\r\n\tconst [isSearching, setIsSearching] = useState(false);\r\n\r\n\t// Manejar cambios en el campo de búsqueda (sin actualizar URL automáticamente)\r\n\tconst handleSearchChange = useCallback(\r\n\t\t(e: React.ChangeEvent<HTMLInputElement>) => {\r\n\t\t\tconst value = e.target.value;\r\n\t\t\tsetSearchTerm(value);\r\n\t\t},\r\n\t\t[]\r\n\t);\r\n\r\n\t// Función para establecer el término de búsqueda externamente (desde URL)\r\n\tconst setSearchTermExternal = useCallback((term: string) => {\r\n\t\tsetSearchTerm(term);\r\n\t}, []);\r\n\r\n\t// Función para manejar envío del formulario\r\n\tconst handleSearchSubmit = useCallback(\r\n\t\t(onSearchSubmit: (searchTerm: string) => void) => (e: React.FormEvent) => {\r\n\t\t\te.preventDefault();\r\n\t\t\tsetIsSearching(true);\r\n\t\t\t\r\n\t\t\t// Llamar a la función proporcionada para manejar la búsqueda\r\n\t\t\tonSearchSubmit(searchTerm);\r\n\t\t\t\r\n\t\t\t// Dar tiempo para que la búsqueda se procese\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tsetIsSearching(false);\r\n\t\t\t}, 300);\r\n\t\t},\r\n\t\t[searchTerm]\r\n\t);\r\n\r\n\t// Limpiar la búsqueda\r\n\tconst clearSearch = useCallback((onClearSearch: () => void) => {\r\n\t\tsetSearchTerm(\"\");\r\n\t\tonClearSearch();\r\n\t}, []);\r\n\r\n\treturn {\r\n\t\tsearchTerm,\r\n\t\tisSearching,\r\n\t\thandleSearchChange,\r\n\t\thandleSearchSubmit,\r\n\t\tclearSearch,\r\n\t\tsetSearchTermExternal,\r\n\t};\r\n};\r\n\r\nexport default useProductSearch;","import React, {useRef} from \"react\";\r\nimport {Search, X} from \"lucide-react\";\r\n\r\ninterface SearchBarProps {\r\n\tsearchTerm: string;\r\n\tonSearchChange: (e: React.ChangeEvent<HTMLInputElement>) => void;\r\n\tonSearch: (e: React.FormEvent) => void;\r\n\tonClear?: () => void;\r\n\tisLoading?: boolean;\r\n}\r\n\r\nconst SearchBar: React.FC<SearchBarProps> = ({\r\n\tsearchTerm,\r\n\tonSearchChange,\r\n\tonSearch,\r\n\tonClear,\r\n\tisLoading = false,\r\n}) => {\r\n\t// Ref para mantener el foco después de limpiar\r\n\tconst inputRef = useRef<HTMLInputElement>(null);\r\n\r\n\t// Manejar limpieza de la búsqueda y restaurar el foco\r\n\tconst handleClear = () => {\r\n\t\tif (onClear) {\r\n\t\t\tonClear();\r\n\t\t\t// Restaurar el foco al input después de limpiar\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tif (inputRef.current) {\r\n\t\t\t\t\tinputRef.current.focus();\r\n\t\t\t\t}\r\n\t\t\t}, 0);\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"mb-8\">\r\n\t\t\t<form onSubmit={onSearch} className=\"relative\">\r\n\t\t\t\t<input\r\n\t\t\t\t\tref={inputRef}\r\n\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\tplaceholder=\"Buscar productos...\"\r\n\t\t\t\t\tclassName=\"w-full py-3 px-4 pr-16 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-300 focus:border-transparent\"\r\n\t\t\t\t\tvalue={searchTerm}\r\n\t\t\t\t\tonChange={onSearchChange}\r\n\t\t\t\t\tdisabled={isLoading}\r\n\t\t\t\t\tautoComplete=\"off\"\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t{/* Botón para limpiar la búsqueda, solo visible si hay texto */}\r\n\t\t\t\t{searchTerm && (\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\tonClick={handleClear}\r\n\t\t\t\t\t\tclassName=\"absolute right-12 top-3 text-gray-400 hover:text-gray-600 focus:outline-none\"\r\n\t\t\t\t\t\taria-label=\"Limpiar búsqueda\"\r\n\t\t\t\t\t\tdisabled={isLoading}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<X size={20} />\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<button\r\n\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\tclassName=\"absolute right-3 top-3 text-gray-400 hover:text-primary-600 focus:outline-none flex items-center justify-center h-6 w-6\"\r\n\t\t\t\t\taria-label=\"Buscar\"\r\n\t\t\t\t\tdisabled={isLoading}\r\n\t\t\t\t>\r\n\t\t\t\t\t{isLoading ? (\r\n\t\t\t\t\t\t<div className=\"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-primary-600\"></div>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<Search size={20} className=\"hover:text-primary-600\" />\r\n\t\t\t\t\t)}\r\n\t\t\t\t</button>\r\n\t\t\t</form>\r\n\r\n\t\t\t{/* Texto instructivo para indicar al usuario que debe presionar Enter o hacer clic en la lupa */}\r\n\t\t\t<p className=\"mt-1 text-xs text-gray-500 text-right\">\r\n\t\t\t\tPresiona Enter o haz clic en la lupa para buscar\r\n\t\t\t</p>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default React.memo(SearchBar);\r\n","import React, {useState} from \"react\";\r\nimport {\r\n\tChevronLeft,\r\n\tChevronRight,\r\n\tChevronRight as ChevronRightIcon,\r\n\tSmartphone,\r\n\tTv,\r\n\tLaptop,\r\n\tMonitor,\r\n\tHeadphones,\r\n\tCamera,\r\n\tWatch,\r\n\tSpeaker,\r\n\tPackage,\r\n} from \"lucide-react\";\r\nimport type {Category} from \"../../../core/domain/entities/Category\";\r\n\r\n// Diccionario de iconos\r\nconst CATEGORY_ICONS: {[key: string]: React.ElementType} = {\r\n\tsmartphone: Smartphone,\r\n\tsmartphones: Smartphone,\r\n\tteléfono: Smartphone,\r\n\ttelefono: Smartphone,\r\n\tmóvil: Smartphone,\r\n\tmovil: Smartphone,\r\n\ttv: Tv,\r\n\ttvs: Tv,\r\n\ttelevisor: Tv,\r\n\ttelevisión: Tv,\r\n\ttelevision: Tv,\r\n\tlaptop: Laptop,\r\n\tlaptops: Laptop,\r\n\tportátil: Laptop,\r\n\tportatil: Laptop,\r\n\tordenador: Laptop,\r\n\tcomputadora: Laptop,\r\n\tmonitor: Monitor,\r\n\tmonitores: Monitor,\r\n\tpantalla: Monitor,\r\n\tauricular: Headphones,\r\n\tauriculares: Headphones,\r\n\theadphone: Headphones,\r\n\taudio: Headphones,\r\n\tcámara: Camera,\r\n\tcamara: Camera,\r\n\tfoto: Camera,\r\n\treloj: Watch,\r\n\trelojes: Watch,\r\n\twatch: Watch,\r\n\taltavoz: Speaker,\r\n\taltavoces: Speaker,\r\n\tspeaker: Speaker,\r\n\telectrónica: Package,\r\n\telectronica: Package,\r\n\tinformática: Laptop,\r\n\tinformatica: Laptop,\r\n\ttecnología: Package,\r\n\ttecnologia: Package,\r\n\tmoda: Package,\r\n\tropa: Package,\r\n\taccesorios: Package,\r\n};\r\n\r\ninterface CategoriesCarouselProps {\r\n\tcategories: Category[];\r\n\tisLoading?: boolean;\r\n\tonCategoryClick?: (category: Category) => void;\r\n}\r\n\r\nconst CategoriesCarousel: React.FC<CategoriesCarouselProps> = ({\r\n\tcategories,\r\n\tisLoading = false,\r\n\tonCategoryClick,\r\n}) => {\r\n\t// Estado para controlar la página actual\r\n\tconst [currentPage, setCurrentPage] = useState(0);\r\n\r\n\t// Configuración responsiva de elementos por página\r\n\tconst getItemsPerPage = () => {\r\n\t\tif (typeof window === 'undefined') return 8;\r\n\t\t\r\n\t\tconst width = window.innerWidth;\r\n\t\tif (width < 640) return 4; // sm: 2x2\r\n\t\tif (width < 768) return 6; // md: 2x3  \r\n\t\tif (width < 1024) return 8; // lg: 2x4\r\n\t\treturn 12; // xl: 3x4\r\n\t};\r\n\r\n\tconst [itemsPerPage, setItemsPerPage] = useState(getItemsPerPage);\r\n\r\n\t// Escuchar cambios de tamaño de pantalla\r\n\tReact.useEffect(() => {\r\n\t\tconst handleResize = () => {\r\n\t\t\tsetItemsPerPage(getItemsPerPage());\r\n\t\t\t// Ajustar página actual si es necesario\r\n\t\t\tconst newTotalPages = Math.ceil(categories.length / getItemsPerPage());\r\n\t\t\tif (currentPage >= newTotalPages && newTotalPages > 0) {\r\n\t\t\t\tsetCurrentPage(newTotalPages - 1);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\twindow.addEventListener('resize', handleResize);\r\n\t\treturn () => window.removeEventListener('resize', handleResize);\r\n\t}, [categories.length, currentPage]);\r\n\r\n\t// Calcular el número de páginas\r\n\tconst totalPages = Math.ceil(categories.length / itemsPerPage);\r\n\r\n\t// Obtener las categorías para la página actual\r\n\tconst getCurrentPageCategories = () => {\r\n\t\tconst start = currentPage * itemsPerPage;\r\n\t\tconst end = start + itemsPerPage;\r\n\t\treturn categories.slice(start, end);\r\n\t};\r\n\r\n\t// Navegar a la página anterior\r\n\tconst goToPreviousPage = () => {\r\n\t\tif (currentPage > 0) {\r\n\t\t\tsetCurrentPage(currentPage - 1);\r\n\t\t}\r\n\t};\r\n\r\n\t// Navegar a la página siguiente\r\n\tconst goToNextPage = () => {\r\n\t\tif (currentPage < totalPages - 1) {\r\n\t\t\tsetCurrentPage(currentPage + 1);\r\n\t\t}\r\n\t};\r\n\r\n\t// Manejar clic en categoría\r\n\tconst handleCategoryClick = (category: Category, event: React.MouseEvent) => {\r\n\t\tevent.preventDefault();\r\n\t\tif (onCategoryClick) {\r\n\t\t\tonCategoryClick(category);\r\n\t\t}\r\n\t};\r\n\r\n\t// Función para determinar qué ícono mostrar basado en el nombre de la categoría\r\n\tconst renderIcon = (category: Category) => {\r\n\t\t// Si hay un emoji en el campo icon, usarlo\r\n\t\tif (category.icon && category.icon.match(/\\p{Emoji}/u)) {\r\n\t\t\treturn <span className=\"text-xl\">{category.icon}</span>;\r\n\t\t}\r\n\r\n\t\t// Buscar el nombre de la categoría en el diccionario de iconos\r\n\t\tconst lowerName = category.name.toLowerCase();\r\n\t\tconst categoryKey = Object.keys(CATEGORY_ICONS).find(\r\n\t\t\t(key) => lowerName.includes(key) || key.includes(lowerName)\r\n\t\t);\r\n\r\n\t\t// Si se encuentra una coincidencia, usar el ícono correspondiente\r\n\t\tif (categoryKey) {\r\n\t\t\tconst IconComponent = CATEGORY_ICONS[categoryKey];\r\n\t\t\treturn <IconComponent size={20} className=\"text-gray-600\" />;\r\n\t\t}\r\n\r\n\t\t// Si no hay coincidencia, usar un ícono genérico\r\n\t\treturn <Package size={20} className=\"text-gray-600\" />;\r\n\t};\r\n\r\n\t// Renderizar spinner durante la carga\r\n\tif (isLoading) {\r\n\t\treturn (\r\n\t\t\t<div className=\"flex justify-center py-8\">\r\n\t\t\t\t<div className=\"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary-600\"></div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\t// Si no hay categorías, mostrar mensaje\r\n\tif (categories.length === 0) {\r\n\t\treturn (\r\n\t\t\t<div className=\"p-6 bg-gray-50 text-gray-500 rounded-lg text-center\">\r\n\t\t\t\t<Package size={32} className=\"mx-auto mb-2 text-gray-400\" />\r\n\t\t\t\t<p>No hay categorías disponibles</p>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"space-y-4\">\r\n\t\t\t{/* Controles de navegación - Solo mostrar si hay múltiples páginas */}\r\n\t\t\t{totalPages > 1 && (\r\n\t\t\t\t<div className=\"flex items-center justify-between\">\r\n\t\t\t\t\t<div className=\"text-sm text-gray-500\">\r\n\t\t\t\t\t\t{categories.length} categorías\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"flex gap-2\">\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={goToPreviousPage}\r\n\t\t\t\t\t\t\tdisabled={currentPage === 0}\r\n\t\t\t\t\t\t\tclassName={`p-2 rounded-full border transition-colors ${\r\n\t\t\t\t\t\t\t\tcurrentPage > 0\r\n\t\t\t\t\t\t\t\t\t? \"cursor-pointer text-gray-700 border-gray-300 hover:bg-gray-100 hover:border-gray-400\"\r\n\t\t\t\t\t\t\t\t\t: \"text-gray-400 border-gray-200 cursor-not-allowed\"\r\n\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\taria-label=\"Página anterior\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<ChevronLeft size={18} />\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t{/* Indicadores de página */}\r\n\t\t\t\t\t\t<div className=\"flex items-center space-x-1\">\r\n\t\t\t\t\t\t\t{Array.from({length: totalPages}).map((_, index) => (\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\t\t\tonClick={() => setCurrentPage(index)}\r\n\t\t\t\t\t\t\t\t\tclassName={`w-2 h-2 rounded-full transition-colors ${\r\n\t\t\t\t\t\t\t\t\t\tindex === currentPage\r\n\t\t\t\t\t\t\t\t\t\t\t? \"bg-primary-600\"\r\n\t\t\t\t\t\t\t\t\t\t\t: \"bg-gray-300 hover:bg-gray-400\"\r\n\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t\taria-label={`Ir a página ${index + 1}`}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={goToNextPage}\r\n\t\t\t\t\t\t\tdisabled={currentPage === totalPages - 1}\r\n\t\t\t\t\t\t\tclassName={`p-2 rounded-full border transition-colors ${\r\n\t\t\t\t\t\t\t\tcurrentPage < totalPages - 1\r\n\t\t\t\t\t\t\t\t\t? \"cursor-pointer text-gray-700 border-gray-300 hover:bg-gray-100 hover:border-gray-400\"\r\n\t\t\t\t\t\t\t\t\t: \"text-gray-400 border-gray-200 cursor-not-allowed\"\r\n\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\taria-label=\"Página siguiente\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<ChevronRight size={18} />\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{/* Grid de categorías - Responsivo */}\r\n\t\t\t<div className=\"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-4 xl:grid-cols-6 gap-3\">\r\n\t\t\t\t{getCurrentPageCategories().map((category) => (\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tkey={category.id}\r\n\t\t\t\t\t\tclassName=\"group block no-underline text-gray-800 cursor-pointer\"\r\n\t\t\t\t\t\tonClick={(e) => handleCategoryClick(category, e)}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div className=\"flex flex-col items-center gap-3 p-4 rounded-lg border border-gray-100 hover:border-primary-200 hover:bg-primary-50 transition-all duration-200 hover:shadow-sm\">\r\n\t\t\t\t\t\t\t<div className=\"flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 group-hover:bg-white group-hover:shadow-sm transition-all duration-200\">\r\n\t\t\t\t\t\t\t\t{renderIcon(category)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"text-center\">\r\n\t\t\t\t\t\t\t\t<span className=\"text-sm font-medium text-gray-800 group-hover:text-primary-700 transition-colors duration-200 line-clamp-2\">\r\n\t\t\t\t\t\t\t\t\t{category.name}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t{category.product_count !== undefined && category.product_count > 0 && (\r\n\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-gray-500 mt-1 block\">\r\n\t\t\t\t\t\t\t\t\t\t{category.product_count} productos\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<ChevronRightIcon className=\"w-4 h-4 text-gray-400 group-hover:text-primary-600 transition-colors duration-200 opacity-0 group-hover:opacity-100\" />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t))}\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Información adicional */}\r\n\t\t\t{totalPages > 1 && (\r\n\t\t\t\t<div className=\"text-center text-sm text-gray-500\">\r\n\t\t\t\t\tPágina {currentPage + 1} de {totalPages}\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default CategoriesCarousel;","import React, {useState} from \"react\";\r\nimport {ChevronUp, ChevronDown, Star, X} from \"lucide-react\";\r\n\r\n// Interfaces para los props\r\ninterface ProductFiltersProps {\r\n\tcategories: string[];\r\n\tpriceRange: {min: number; max: number};\r\n\tonCategoryChange: (categories: string[]) => void;\r\n\tonPriceRangeChange: (range: {min: number; max: number} | null) => void;\r\n\tonRatingChange: (rating: number | null) => void;\r\n\tonDiscountChange: (showDiscount: boolean) => void;\r\n\tonClearFilters: () => void;\r\n\tselectedCategories: string[];\r\n\tselectedPriceRange: {min: number; max: number} | null;\r\n\tselectedRating: number | null;\r\n\tselectedDiscount: boolean;\r\n\tproductCountByCategory: Record<string, number>;\r\n}\r\n\r\n// Interfaz para las secciones de filtro\r\ninterface FilterSectionProps {\r\n\ttitle: string;\r\n\tisExpanded: boolean;\r\n\tonToggle: () => void;\r\n\tchildren: React.ReactNode;\r\n}\r\n\r\n// Sección de categorías\r\ninterface CategoryFilterSectionProps {\r\n\tcategories: string[];\r\n\tselectedCategories: string[];\r\n\tonCategoryChange: (categories: string[]) => void;\r\n\tisExpanded: boolean;\r\n\tonToggle: () => void;\r\n\tproductCountByCategory: Record<string, number>;\r\n}\r\n\r\n// Sección de precio\r\ninterface PriceFilterSectionProps {\r\n\tinitialMin: number;\r\n\tinitialMax: number;\r\n\tselectedRange: {min: number; max: number} | null;\r\n\tisExpanded: boolean;\r\n\tonToggle: () => void;\r\n\tonApply: (min: number, max: number) => void;\r\n\tonClear: () => void;\r\n}\r\n\r\n// Sección de valoración\r\ninterface RatingFilterSectionProps {\r\n\tselectedRating: number | null;\r\n\tonRatingChange: (rating: number | null) => void;\r\n\tisExpanded: boolean;\r\n\tonToggle: () => void;\r\n}\r\n\r\n// Sección de descuento\r\ninterface DiscountFilterSectionProps {\r\n\tselectedDiscount: boolean;\r\n\tonDiscountChange: (showDiscount: boolean) => void;\r\n\tisExpanded: boolean;\r\n\tonToggle: () => void;\r\n}\r\n\r\n// Componente de sección de filtro genérico\r\nconst FilterSection: React.FC<FilterSectionProps> = ({\r\n\ttitle,\r\n\tisExpanded,\r\n\tonToggle,\r\n\tchildren,\r\n}) => {\r\n\treturn (\r\n\t\t<div className=\"border-b border-gray-200 pb-4\">\r\n\t\t\t<button\r\n\t\t\t\tclassName=\"cursor-pointer flex justify-between items-center w-full py-2 text-left font-medium text-gray-700 hover:text-gray-900\"\r\n\t\t\t\tonClick={onToggle}\r\n\t\t\t>\r\n\t\t\t\t{title}\r\n\t\t\t\t{isExpanded ? <ChevronUp size={16} /> : <ChevronDown size={16} />}\r\n\t\t\t</button>\r\n\r\n\t\t\t{isExpanded && <div className=\"mt-2 space-y-2\">{children}</div>}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\n// Componente para filtro de categorías\r\nconst CategoryFilterSection: React.FC<CategoryFilterSectionProps> = ({\r\n\tcategories,\r\n\tselectedCategories,\r\n\tonCategoryChange,\r\n\tisExpanded,\r\n\tonToggle,\r\n\tproductCountByCategory,\r\n}) => {\r\n\t// Función para manejar cambios de categoría\r\n\tconst handleCategoryToggle = (category: string) => {\r\n\t\tif (selectedCategories.includes(category)) {\r\n\t\t\tonCategoryChange(selectedCategories.filter((c) => c !== category));\r\n\t\t} else {\r\n\t\t\tonCategoryChange([...selectedCategories, category]);\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<FilterSection\r\n\t\t\ttitle=\"Categorías\"\r\n\t\t\tisExpanded={isExpanded}\r\n\t\t\tonToggle={onToggle}\r\n\t\t>\r\n\t\t\t<div className=\"space-y-1 max-h-60 overflow-y-auto pr-2 scrollbar-thin\">\r\n\t\t\t\t{categories.map((category) => (\r\n\t\t\t\t\t<div key={category} className=\"flex items-center\">\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\tid={`category-${category}`}\r\n\t\t\t\t\t\t\tchecked={selectedCategories.includes(category)}\r\n\t\t\t\t\t\t\tonChange={() => handleCategoryToggle(category)}\r\n\t\t\t\t\t\t\tclassName=\"cursor-pointer h-4 w-4 text-primary-600 focus:ring-primary-500 rounded border-gray-300\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\thtmlFor={`category-${category}`}\r\n\t\t\t\t\t\t\tclassName=\"cursor-pointer ml-2 block text-sm text-gray-700\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{category}\r\n\t\t\t\t\t\t\t<span className=\"ml-1 text-gray-400 text-xs\">\r\n\t\t\t\t\t\t\t\t({productCountByCategory[category] || 0})\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t))}\r\n\t\t\t</div>\r\n\t\t</FilterSection>\r\n\t);\r\n};\r\n\r\n// Componente para filtro de precio\r\nconst PriceFilterSection: React.FC<PriceFilterSectionProps> = ({\r\n\tinitialMin,\r\n\tinitialMax,\r\n\tselectedRange,\r\n\tisExpanded,\r\n\tonToggle,\r\n\tonApply,\r\n\tonClear,\r\n}) => {\r\n\tconst [minPrice, setMinPrice] = useState<number>(\r\n\t\tselectedRange?.min || initialMin\r\n\t);\r\n\tconst [maxPrice, setMaxPrice] = useState<number>(\r\n\t\tselectedRange?.max || initialMax\r\n\t);\r\n\r\n\tconst handleMinChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n\t\tconst value = parseInt(e.target.value);\r\n\t\tsetMinPrice(isNaN(value) ? initialMin : value);\r\n\t};\r\n\r\n\tconst handleMaxChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n\t\tconst value = parseInt(e.target.value);\r\n\t\tsetMaxPrice(isNaN(value) ? initialMax : value);\r\n\t};\r\n\r\n\tconst handleApply = () => {\r\n\t\t// Asegurarse de que min no es mayor que max\r\n\t\tconst validMin = Math.min(minPrice, maxPrice);\r\n\t\tconst validMax = Math.max(minPrice, maxPrice);\r\n\t\tonApply(validMin, validMax);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<FilterSection title=\"Precio\" isExpanded={isExpanded} onToggle={onToggle}>\r\n\t\t\t<div className=\"space-y-4\">\r\n\t\t\t\t<div className=\"grid grid-cols-2 gap-4\">\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\thtmlFor=\"min-price\"\r\n\t\t\t\t\t\t\tclassName=\"block text-sm text-gray-500 mb-1\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tMínimo\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\tid=\"min-price\"\r\n\t\t\t\t\t\t\tmin={initialMin}\r\n\t\t\t\t\t\t\tmax={initialMax}\r\n\t\t\t\t\t\t\tvalue={minPrice}\r\n\t\t\t\t\t\t\tonChange={handleMinChange}\r\n\t\t\t\t\t\t\tclassName=\"w-full p-2 border border-gray-300 rounded\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\thtmlFor=\"max-price\"\r\n\t\t\t\t\t\t\tclassName=\"block text-sm text-gray-500 mb-1\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tMáximo\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\tid=\"max-price\"\r\n\t\t\t\t\t\t\tmin={initialMin}\r\n\t\t\t\t\t\t\tmax={initialMax}\r\n\t\t\t\t\t\t\tvalue={maxPrice}\r\n\t\t\t\t\t\t\tonChange={handleMaxChange}\r\n\t\t\t\t\t\t\tclassName=\"w-full p-2 border border-gray-300 rounded\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div className=\"flex space-x-2\">\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={handleApply}\r\n\t\t\t\t\t\tclassName=\"flex-1 bg-primary-600 text-white py-2 px-4 rounded hover:bg-primary-700 text-sm\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tAplicar\r\n\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t{selectedRange && (\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={onClear}\r\n\t\t\t\t\t\t\tclassName=\"bg-gray-200 text-gray-700 py-2 px-3 rounded hover:bg-gray-300 text-sm\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<X size={18} />\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</FilterSection>\r\n\t);\r\n};\r\n\r\n// Componente para filtro de valoración\r\nconst RatingFilterSection: React.FC<RatingFilterSectionProps> = ({\r\n\tselectedRating,\r\n\tonRatingChange,\r\n\tisExpanded,\r\n\tonToggle,\r\n}) => {\r\n\t// Array de posibles valoraciones\r\n\tconst ratings = [5, 4, 3, 2, 1];\r\n\r\n\treturn (\r\n\t\t<FilterSection\r\n\t\t\ttitle=\"Valoración\"\r\n\t\t\tisExpanded={isExpanded}\r\n\t\t\tonToggle={onToggle}\r\n\t\t>\r\n\t\t\t<div className=\"space-y-2\">\r\n\t\t\t\t{ratings.map((rating) => (\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tkey={rating}\r\n\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\tonRatingChange(selectedRating === rating ? null : rating)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tclassName={`cursor-pointer flex items-center w-full p-2 rounded-md transition ${\r\n\t\t\t\t\t\t\tselectedRating === rating\r\n\t\t\t\t\t\t\t\t? \"bg-primary-50 text-primary-700\"\r\n\t\t\t\t\t\t\t\t: \"hover:bg-gray-100 text-gray-700\"\r\n\t\t\t\t\t\t}`}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div className=\"flex\">\r\n\t\t\t\t\t\t\t{[...Array(5)].map((_, i) => (\r\n\t\t\t\t\t\t\t\t<Star\r\n\t\t\t\t\t\t\t\t\tkey={i}\r\n\t\t\t\t\t\t\t\t\tsize={16}\r\n\t\t\t\t\t\t\t\t\tfill={i < rating ? \"currentColor\" : \"none\"}\r\n\t\t\t\t\t\t\t\t\tclassName={i < rating ? \"text-yellow-400\" : \"text-gray-300\"}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<span className=\"ml-2 text-sm\">{rating}+ estrellas</span>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t))}\r\n\t\t\t</div>\r\n\t\t</FilterSection>\r\n\t);\r\n};\r\n\r\n// Componente para filtro de descuento\r\nconst DiscountFilterSection: React.FC<DiscountFilterSectionProps> = ({\r\n\tselectedDiscount,\r\n\tonDiscountChange,\r\n\tisExpanded,\r\n\tonToggle,\r\n}) => {\r\n\treturn (\r\n\t\t<FilterSection title=\"Ofertas\" isExpanded={isExpanded} onToggle={onToggle}>\r\n\t\t\t<div className=\"space-y-2\">\r\n\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\tid=\"discount-filter\"\r\n\t\t\t\t\t\tchecked={selectedDiscount}\r\n\t\t\t\t\t\tonChange={() => onDiscountChange(!selectedDiscount)}\r\n\t\t\t\t\t\tclassName=\"cursor-pointer h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<label\r\n\t\t\t\t\t\thtmlFor=\"discount-filter\"\r\n\t\t\t\t\t\tclassName=\"cursor-pointer ml-2 block text-sm text-gray-700\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tProductos con descuento\r\n\t\t\t\t\t</label>\r\n\t\t\t\t</div>\r\n\t\t\t\t<p className=\"text-xs text-gray-500\">\r\n\t\t\t\t\tMostrar solo productos con ofertas especiales y descuentos\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t</FilterSection>\r\n\t);\r\n};\r\n\r\n// Componente principal de filtros\r\nconst ProductFilters: React.FC<ProductFiltersProps> = ({\r\n\tcategories,\r\n\tpriceRange,\r\n\tonCategoryChange,\r\n\tonPriceRangeChange,\r\n\tonRatingChange,\r\n\tonDiscountChange,\r\n\tonClearFilters,\r\n\tselectedCategories,\r\n\tselectedPriceRange,\r\n\tselectedRating,\r\n\tselectedDiscount,\r\n\tproductCountByCategory,\r\n}) => {\r\n\t// Estado para controlar qué secciones están expandidas\r\n\tconst [expandedSections, setExpandedSections] = useState({\r\n\t\tcategories: true,\r\n\t\tprice: true,\r\n\t\trating: false,\r\n\t\tdiscount: false,\r\n\t});\r\n\r\n\t// Función para alternar la expansión de una sección\r\n\tconst toggleSection = (section: keyof typeof expandedSections) => {\r\n\t\tsetExpandedSections((prev) => ({\r\n\t\t\t...prev,\r\n\t\t\t[section]: !prev[section],\r\n\t\t}));\r\n\t};\r\n\r\n\t// Determinar si hay filtros activos\r\n\tconst hasActiveFilters =\r\n\t\tselectedCategories.length > 0 ||\r\n\t\tselectedPriceRange !== null ||\r\n\t\tselectedRating !== null ||\r\n\t\tselectedDiscount;\r\n\r\n\treturn (\r\n\t\t<div className=\"bg-white rounded-lg shadow p-4\">\r\n\t\t\t<div className=\"flex justify-between items-center mb-4\">\r\n\t\t\t\t<h2 className=\"text-lg font-medium text-gray-800\">Filtros</h2>\r\n\r\n\t\t\t\t{hasActiveFilters && (\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={onClearFilters}\r\n\t\t\t\t\t\tclassName=\"text-sm text-primary-600 hover:text-primary-700\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tLimpiar filtros\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\r\n\t\t\t<div className=\"space-y-4\">\r\n\t\t\t\t{/* Sección de Categorías */}\r\n\t\t\t\t<CategoryFilterSection\r\n\t\t\t\t\tcategories={categories}\r\n\t\t\t\t\tselectedCategories={selectedCategories}\r\n\t\t\t\t\tonCategoryChange={onCategoryChange}\r\n\t\t\t\t\tisExpanded={expandedSections.categories}\r\n\t\t\t\t\tonToggle={() => toggleSection(\"categories\")}\r\n\t\t\t\t\tproductCountByCategory={productCountByCategory}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t{/* Sección de Precio */}\r\n\t\t\t\t<PriceFilterSection\r\n\t\t\t\t\tinitialMin={priceRange.min}\r\n\t\t\t\t\tinitialMax={priceRange.max}\r\n\t\t\t\t\tselectedRange={selectedPriceRange}\r\n\t\t\t\t\tisExpanded={expandedSections.price}\r\n\t\t\t\t\tonToggle={() => toggleSection(\"price\")}\r\n\t\t\t\t\tonApply={(min, max) => onPriceRangeChange({min, max})}\r\n\t\t\t\t\tonClear={() => onPriceRangeChange(null)}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t{/* Sección de Valoración */}\r\n\t\t\t\t<RatingFilterSection\r\n\t\t\t\t\tselectedRating={selectedRating}\r\n\t\t\t\t\tonRatingChange={onRatingChange}\r\n\t\t\t\t\tisExpanded={expandedSections.rating}\r\n\t\t\t\t\tonToggle={() => toggleSection(\"rating\")}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t{/* Sección de Descuentos */}\r\n\t\t\t\t<DiscountFilterSection\r\n\t\t\t\t\tselectedDiscount={selectedDiscount}\r\n\t\t\t\t\tonDiscountChange={onDiscountChange}\r\n\t\t\t\t\tisExpanded={expandedSections.discount}\r\n\t\t\t\t\tonToggle={() => toggleSection(\"discount\")}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default ProductFilters;\r\n","import type {Product} from \"../core/domain/entities/Product\";\r\n\r\n/**\r\n * Adapta un producto de la API para su uso en la aplicación\r\n * Normaliza campos entre camelCase y snake_case, y maneja valores faltantes\r\n */\r\nexport const adaptProduct = (apiProduct: any): Product => {\r\n\tif (!apiProduct || typeof apiProduct !== \"object\") {\r\n\t\tconsole.error(\"Producto inválido para adaptar:\", apiProduct);\r\n\t\treturn {} as Product;\r\n\t}\r\n\r\n\t// Extraer las calificaciones correctamente\r\n\t// Usando todas las posibles propiedades donde podría estar el rating\r\n\tconst rating =\r\n\t\tapiProduct.ratingAvg ||\r\n\t\tapiProduct.rating_avg ||\r\n\t\tapiProduct.rating ||\r\n\t\tapiProduct.rating_data?.average_rating ||\r\n\t\t0;\r\n\r\n    const rating_count =\r\n\t\t\tapiProduct.ratingAvg_count ||\r\n\t\t\tapiProduct.rating_avg_count ||\r\n\t\t\tapiProduct.rating_count ||\r\n\t\t\tapiProduct.rating_data?.average_rating_count ||\r\n\t\t\t0;\r\n\r\n    \r\n\t// Adaptar imágenes según el formato de la API\r\n\tlet images: string[] = [];\r\n\r\n\tif (Array.isArray(apiProduct.images)) {\r\n\t\t// Si images es un array de objetos con URLs\r\n\t\tif (typeof apiProduct.images[0] === \"object\") {\r\n\t\t\timages = apiProduct.images\r\n\t\t\t\t.map((img: any) => {\r\n\t\t\t\t\t// Buscar la URL original o cualquier otra propiedad disponible\r\n\t\t\t\t\treturn img.original || img.url || img.medium || img.thumbnail || \"\";\r\n\t\t\t\t})\r\n\t\t\t\t.filter(Boolean);\r\n\t\t}\r\n\t\t// Si images es un array de strings (URLs)\r\n\t\telse if (typeof apiProduct.images[0] === \"string\") {\r\n\t\t\timages = apiProduct.images;\r\n\t\t}\r\n\t}\r\n\t// Si solo hay una imagen como string\r\n\telse if (typeof apiProduct.image === \"string\") {\r\n\t\timages = [apiProduct.image];\r\n\t}\r\n\t// Si hay una propiedad imageUrl\r\n\telse if (\r\n\t\ttypeof apiProduct.imageUrl === \"string\" ||\r\n\t\ttypeof apiProduct.image_url === \"string\"\r\n\t) {\r\n\t\timages = [apiProduct.imageUrl || apiProduct.image_url];\r\n\t}\r\n\r\n\t// Calcular el descuento y precio final\r\n\tconst discountPercentage =\r\n\t\tapiProduct.discountPercentage || apiProduct.discount_percentage || 0;\r\n\tconst price = parseFloat(apiProduct.price) || 0;\r\n\tconst finalPrice =\r\n\t\tapiProduct.finalPrice ||\r\n\t\tapiProduct.final_price ||\r\n\t\t(discountPercentage > 0 ? price * (1 - discountPercentage / 100) : price);\r\n\r\n\treturn {\r\n\t\tid: apiProduct.id,\r\n\t\tuserId: apiProduct.userId || apiProduct.user_id,\r\n\t\tcategoryId: apiProduct.categoryId || apiProduct.category_id,\r\n\t\tname: apiProduct.name || \"Producto sin nombre\",\r\n\t\tslug: apiProduct.slug || \"\",\r\n\t\tdescription: apiProduct.description || \"\",\r\n\t\tprice: price,\r\n\t\tstock: parseInt(apiProduct.stock) || 0,\r\n\t\tweight: apiProduct.weight,\r\n\t\twidth: apiProduct.width,\r\n\t\theight: apiProduct.height,\r\n\t\tdepth: apiProduct.depth,\r\n\t\tdimensions: apiProduct.dimensions,\r\n\t\tcolors: apiProduct.colors,\r\n\t\tsizes: apiProduct.sizes,\r\n\t\ttags: apiProduct.tags,\r\n\t\tsku: apiProduct.sku,\r\n\t\tattributes: apiProduct.attributes,\r\n\t\timages: images,\r\n\t\tfeatured: Boolean(apiProduct.featured),\r\n\t\tpublished: Boolean(apiProduct.published),\r\n\t\tstatus: apiProduct.status || \"active\",\r\n\t\tviewCount: apiProduct.viewCount || apiProduct.view_count || 0,\r\n\t\tsalesCount: apiProduct.salesCount || apiProduct.sales_count || 0,\r\n\t\tdiscountPercentage: discountPercentage,\r\n\t\tfinalPrice: finalPrice,\r\n\t\tisInStock:\r\n\t\t\tapiProduct.isInStock || apiProduct.is_in_stock || apiProduct.stock > 0,\r\n\t\trating: parseFloat(rating) || 0,\r\n\t\tratingCount: parseFloat(rating_count) || 0, // CORREGIDO: usar ratingCount en lugar de rating_count\r\n\t\tcreatedAt: apiProduct.createdAt || apiProduct.created_at,\r\n\t\tupdatedAt: apiProduct.updatedAt || apiProduct.updated_at,\r\n\t};\r\n};\r\n\r\n/**\r\n * Adapta una lista de productos de la API\r\n */\r\nexport const adaptProductList = (products: any[]): Product[] => {\r\n\tif (!Array.isArray(products)) {\r\n\t\tconsole.error(\"Lista de productos inválida:\", products);\r\n\t\treturn [];\r\n\t}\r\n\r\n\treturn products.map((product) => adaptProduct(product));\r\n};\r\n\r\nexport default {\r\n\tadaptProduct,\r\n\tadaptProductList,\r\n};\r\n","import React from \"react\";\r\nimport ProductCardCompact from \"./ProductCardCompact\";\r\nimport type {Product} from \"../../../core/domain/entities/Product\";\r\nimport type {Category} from \"../../../core/domain/entities/Category\";\r\nimport {adaptProduct} from \"../../../utils/productAdapter\";\r\n\r\ninterface ProductGridProps {\r\n\tproducts: Product[];\r\n\tcategories: Category[];\r\n\tisLoading: boolean;\r\n\terror: string | null;\r\n\tonRetry: () => void;\r\n\tonAddToCart: (productId: number) => void;\r\n\tonAddToWishlist: (productId: number) => void;\r\n\tgetImageUrl: (imagePath: string | undefined) => string;\r\n\tselectedCategories: string[];\r\n\ttotalItems: number;\r\n\tcurrentPage: number;\r\n\titemsPerPage: number;\r\n\tonResetFilters: () => void;\r\n}\r\n\r\nconst ProductGrid: React.FC<ProductGridProps> = ({\r\n\tproducts,\r\n\tcategories,\r\n\tisLoading,\r\n\terror,\r\n\tonRetry,\r\n\tonAddToCart,\r\n\tonAddToWishlist,\r\n\tgetImageUrl,\r\n\tselectedCategories,\r\n\ttotalItems,\r\n\tcurrentPage,\r\n\titemsPerPage,\r\n\tonResetFilters,\r\n}) => {\r\n\t// Si está cargando, mostrar spinner\r\n\tif (isLoading) {\r\n\t\treturn (\r\n\t\t\t<div className=\"flex justify-center items-center py-12\">\r\n\t\t\t\t<div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600\"></div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\t// Si hay error, mostrar mensaje\r\n\tif (error) {\r\n\t\treturn (\r\n\t\t\t<div className=\"bg-red-50 border-l-4 border-red-500 p-4 rounded\">\r\n\t\t\t\t<p className=\"text-red-700\">Error al cargar productos: {error}</p>\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={onRetry}\r\n\t\t\t\t\tclassName=\"mt-3 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700\"\r\n\t\t\t\t>\r\n\t\t\t\t\tReintentar\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\t// Si no hay productos, mostrar mensaje\r\n\tif (products.length === 0) {\r\n\t\treturn (\r\n\t\t\t<div className=\"bg-white rounded-lg shadow-sm p-8 text-center\">\r\n\t\t\t\t<h3 className=\"text-xl font-medium mb-2\">\r\n\t\t\t\t\tNo se encontraron productos\r\n\t\t\t\t</h3>\r\n\t\t\t\t<p className=\"text-gray-600 mb-4\">\r\n\t\t\t\t\tNo hay productos que coincidan con los filtros actuales.\r\n\t\t\t\t</p>\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={onResetFilters}\r\n\t\t\t\t\tclassName=\"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors\"\r\n\t\t\t\t>\r\n\t\t\t\t\tLimpiar filtros\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\t// Calcular el rango de productos mostrados\r\n\tconst start = (currentPage - 1) * itemsPerPage + 1;\r\n\tconst end = Math.min(currentPage * itemsPerPage, totalItems);\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<h2 className=\"text-2xl font-bold mb-6\">\r\n\t\t\t\t{selectedCategories.length > 0\r\n\t\t\t\t\t? selectedCategories.join(\", \")\r\n\t\t\t\t\t: \"Todos los productos\"}\r\n\t\t\t</h2>\r\n\r\n\t\t\t{/* Información de resultados */}\r\n\t\t\t<div className=\"flex justify-between items-center mb-6\">\r\n\t\t\t\t<p className=\"text-gray-600\">\r\n\t\t\t\t\tMostrando {start}-{end} de {totalItems} productos\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Grid de productos */}\r\n\t\t\t<div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4\">\r\n\t\t\t\t{products.map((product) => {\r\n\t\t\t\t\t// Adaptar producto para asegurar compatibilidad\r\n\t\t\t\t\tconst adaptedProduct = adaptProduct(product);\r\n\r\n\t\t\t\t\t// OBTENER IMAGEN DE MANERA SIMPLIFICADA\r\n\t\t\t\t\t// El hook useProducts ya procesó las imágenes, solo usar la primera\r\n\t\t\t\t\tlet imageUrl = \"\";\r\n\r\n\t\t\t\t\tconsole.group(`🎨 ProductGrid - Producto ${product.id}`);\r\n\t\t\t\t\tconsole.log(\"📦 Producto completo:\", product);\r\n\t\t\t\t\tconsole.log(\"🖼️ Imágenes disponibles:\", product.images);\r\n\r\n\t\t\t\t\tif (Array.isArray(product.images) && product.images.length > 0) {\r\n\t\t\t\t\t\t// Usar la primera imagen del array ya procesado por el hook\r\n\t\t\t\t\t\timageUrl = typeof product.images[0] === \"string\" ? product.images[0] : product.images[0]?.url || \"\";\r\n\t\t\t\t\t\tconsole.log(\"✅ Imagen seleccionada:\", imageUrl);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.warn(\"⚠️ No hay imágenes disponibles para el producto\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconsole.groupEnd();\r\n\r\n\t\t\t\t\t// Procesar la imagen a través de getImageUrl\r\n\t\t\t\t\tconst processedImageUrl = getImageUrl(imageUrl);\r\n\r\n\t\t\t\t\tconsole.log(`🔗 URL final de imagen para producto ${product.id}:`, processedImageUrl);\r\n\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<ProductCardCompact\r\n\t\t\t\t\t\t\tkey={adaptedProduct.id}\r\n\t\t\t\t\t\t\tid={adaptedProduct.id || 0}\r\n\t\t\t\t\t\t\tname={adaptedProduct.name}\r\n\t\t\t\t\t\t\tprice={adaptedProduct.price}\r\n\t\t\t\t\t\t\tdiscount={product.discountPercentage}\r\n\t\t\t\t\t\t\trating={adaptedProduct.rating || 0}\r\n\t\t\t\t\t\t\treviews={product.ratingCount || 0}\r\n\t\t\t\t\t\t\timage={processedImageUrl}\r\n\t\t\t\t\t\t\tcategory={\r\n\t\t\t\t\t\t\t\tcategories.find((cat) => cat.id === adaptedProduct.categoryId)\r\n\t\t\t\t\t\t\t\t\t?.name\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tisNew={\r\n\t\t\t\t\t\t\t\tnew Date(adaptedProduct.createdAt || \"\").getTime() >\r\n\t\t\t\t\t\t\t\tDate.now() - 30 * 24 * 60 * 60 * 1000\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tonAddToCart={onAddToCart}\r\n\t\t\t\t\t\t\tonAddToWishlist={onAddToWishlist}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t);\r\n\t\t\t\t})}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default ProductGrid;","import React, {useState, useRef, useEffect} from \"react\";\r\nimport {ChevronDown} from \"lucide-react\";\r\n\r\ninterface SortOption {\r\n\tid: string;\r\n\tlabel: string;\r\n}\r\n\r\ninterface SortDropdownProps {\r\n\toptions: SortOption[];\r\n\tselectedOption: string;\r\n\tonSortChange: (option: string) => void;\r\n}\r\n\r\nconst SortDropdown: React.FC<SortDropdownProps> = ({\r\n\toptions,\r\n\tselectedOption,\r\n\tonSortChange,\r\n}) => {\r\n\tconst [isOpen, setIsOpen] = useState(false);\r\n\tconst dropdownRef = useRef<HTMLDivElement>(null);\r\n\r\n\t// Cerrar dropdown al hacer clic fuera\r\n\tuseEffect(() => {\r\n\t\tconst handleClickOutside = (event: MouseEvent) => {\r\n\t\t\tif (\r\n\t\t\t\tdropdownRef.current &&\r\n\t\t\t\t!dropdownRef.current.contains(event.target as Node)\r\n\t\t\t) {\r\n\t\t\t\tsetIsOpen(false);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tdocument.addEventListener(\"mousedown\", handleClickOutside);\r\n\t\treturn () => {\r\n\t\t\tdocument.removeEventListener(\"mousedown\", handleClickOutside);\r\n\t\t};\r\n\t}, []);\r\n\r\n\t// Obtener etiqueta de la opción seleccionada\r\n\tconst getSelectedLabel = () => {\r\n\t\tconst option = options.find((opt) => opt.id === selectedOption);\r\n\t\treturn option ? option.label : \"Ordenar por\";\r\n\t};\r\n\r\n\t// Manejar selección de opción\r\n\tconst handleSelect = (optionId: string) => {\r\n\t\tonSortChange(optionId);\r\n\t\tsetIsOpen(false);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"relative\" ref={dropdownRef}>\r\n\t\t\t<button\r\n\t\t\t\tonClick={() => setIsOpen(!isOpen)}\r\n\t\t\t\tclassName=\"cursor-pointer flex items-center px-4 py-2 bg-white rounded-lg shadow border border-gray-200 text-gray-700 hover:bg-gray-50\"\r\n\t\t\t>\r\n\t\t\t\t<span className=\"mr-2\">{getSelectedLabel()}</span>\r\n\t\t\t\t<ChevronDown\r\n\t\t\t\t\tsize={16}\r\n\t\t\t\t\tclassName={`transition-transform ${isOpen ? \"transform rotate-180\" : \"\"}`}\r\n\t\t\t\t/>\r\n\t\t\t</button>\r\n\r\n\t\t\t{isOpen && (\r\n\t\t\t\t<div className=\"absolute right-0 mt-2 z-10 w-56 bg-white rounded-lg shadow-lg border border-gray-200 py-1\">\r\n\t\t\t\t\t{options.map((option) => (\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tkey={option.id}\r\n\t\t\t\t\t\t\tonClick={() => handleSelect(option.id)}\r\n\t\t\t\t\t\t\tclassName={`block w-full text-left px-4 py-2 text-sm ${\r\n\t\t\t\t\t\t\t\tselectedOption === option.id\r\n\t\t\t\t\t\t\t\t\t? \"bg-primary-50 text-primary-700 font-medium\"\r\n\t\t\t\t\t\t\t\t\t: \"text-gray-700 hover:bg-gray-50\"\r\n\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{option.label}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default SortDropdown;\r\n","import React from \"react\";\r\nimport {X} from \"lucide-react\";\r\nimport type {Category} from \"../../../core/domain/entities/Category\";\r\nimport RatingStars from \"../common/RatingStars\";\r\n\r\ninterface PriceRange {\r\n\tid: string;\r\n\tlabel: string;\r\n}\r\n\r\ninterface MobileFilterPanelProps {\r\n\tisOpen: boolean;\r\n\tonClose: () => void;\r\n\tcategories: Category[];\r\n\tselectedCategories: string[];\r\n\tpriceRanges: PriceRange[];\r\n\tselectedRangeId: string | null;\r\n\tselectedRating: number | null;\r\n\tshowingDiscounted: boolean;\r\n\tonCategoryChange: (category: string, isSelected: boolean) => void;\r\n\tonPriceRangeChange: (min: number, max: number) => void;\r\n\tonRatingChange: (rating: number | null) => void;\r\n\tonDiscountToggle: () => void;\r\n\tonClearFilters: () => void;\r\n\tproductCountByCategory: Record<string, number>;\r\n}\r\n\r\nconst MobileFilterPanel: React.FC<MobileFilterPanelProps> = ({\r\n\tisOpen,\r\n\tonClose,\r\n\tcategories,\r\n\tselectedCategories,\r\n\tpriceRanges,\r\n\tselectedRangeId,\r\n\tselectedRating,\r\n\tshowingDiscounted,\r\n\tonCategoryChange,\r\n\tonPriceRangeChange,\r\n\tonRatingChange,\r\n\tonDiscountToggle,\r\n\tonClearFilters,\r\n\tproductCountByCategory,\r\n}) => {\r\n\t// No renderizar si no está abierto\r\n\tif (!isOpen) return null;\r\n\r\n\t// Procesar rango de precio\r\n\tconst handlePriceRangeSelect = (rangeId: string) => {\r\n\t\tconst [min, max] = rangeId.split(\"-\").map(Number);\r\n\t\tonPriceRangeChange(min, max);\r\n\t};\r\n\r\n\t// Calcular si hay filtros activos\r\n\tconst hasActiveFilters =\r\n\t\tselectedCategories.length > 0 ||\r\n\t\tselectedRangeId !== null ||\r\n\t\tselectedRating !== null ||\r\n\t\tshowingDiscounted;\r\n\r\n\treturn (\r\n\t\t<div className=\"fixed inset-0 bg-black bg-opacity-50 z-50 flex md:hidden\">\r\n\t\t\t<div className=\"absolute inset-y-0 right-0 w-4/5 max-w-md bg-white overflow-y-auto flex flex-col\">\r\n\t\t\t\t{/* Header */}\r\n\t\t\t\t<div className=\"flex justify-between items-center p-4 border-b border-gray-200\">\r\n\t\t\t\t\t<h2 className=\"text-lg font-medium text-gray-800\">Filtros</h2>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={onClose}\r\n\t\t\t\t\t\tclassName=\"text-gray-500 hover:text-gray-700\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<X size={24} />\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{/* Content */}\r\n\t\t\t\t<div className=\"flex-1 overflow-y-auto p-4 space-y-6\">\r\n\t\t\t\t\t{/* Categorías */}\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<h3 className=\"font-medium text-gray-800 mb-3\">Categorías</h3>\r\n\t\t\t\t\t\t<div className=\"space-y-2 max-h-60 overflow-y-auto\">\r\n\t\t\t\t\t\t\t{categories.map((category) => (\r\n\t\t\t\t\t\t\t\t<div key={category.id} className=\"flex items-center\">\r\n\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\t\t\t\tid={`mobile-category-${category.id}`}\r\n\t\t\t\t\t\t\t\t\t\tchecked={selectedCategories.includes(category.name)}\r\n\t\t\t\t\t\t\t\t\t\tonChange={() =>\r\n\t\t\t\t\t\t\t\t\t\t\tonCategoryChange(\r\n\t\t\t\t\t\t\t\t\t\t\t\tcategory.name,\r\n\t\t\t\t\t\t\t\t\t\t\t\t!selectedCategories.includes(category.name)\r\n\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"h-4 w-4 text-primary-600 focus:ring-primary-500 rounded border-gray-300\"\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\t\t\t\thtmlFor={`mobile-category-${category.id}`}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"ml-2 block text-sm text-gray-700\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{category.name}\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"ml-1 text-gray-400 text-xs\">\r\n\t\t\t\t\t\t\t\t\t\t\t({productCountByCategory[category.name] || 0})\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Precio */}\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<h3 className=\"font-medium text-gray-800 mb-3\">Precio</h3>\r\n\t\t\t\t\t\t<div className=\"space-y-2\">\r\n\t\t\t\t\t\t\t{priceRanges.map((range) => (\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tkey={range.id}\r\n\t\t\t\t\t\t\t\t\tonClick={() => handlePriceRangeSelect(range.id)}\r\n\t\t\t\t\t\t\t\t\tclassName={`block w-full text-left px-3 py-2 rounded-md text-sm ${\r\n\t\t\t\t\t\t\t\t\t\tselectedRangeId === range.id\r\n\t\t\t\t\t\t\t\t\t\t\t? \"bg-primary-50 text-primary-700 font-medium\"\r\n\t\t\t\t\t\t\t\t\t\t\t: \"text-gray-700 hover:bg-gray-50\"\r\n\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{range.label}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Valoración */}\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<h3 className=\"font-medium text-gray-800 mb-3\">Valoración</h3>\r\n\t\t\t\t\t\t<div className=\"space-y-2\">\r\n\t\t\t\t\t\t\t{[5, 4, 3, 2, 1].map((rating) => (\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tkey={rating}\r\n\t\t\t\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\t\t\t\tonRatingChange(selectedRating === rating ? null : rating)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tclassName={`flex items-center w-full px-3 py-2 rounded-md text-sm ${\r\n\t\t\t\t\t\t\t\t\t\tselectedRating === rating\r\n\t\t\t\t\t\t\t\t\t\t\t? \"bg-primary-50 text-primary-700 font-medium\"\r\n\t\t\t\t\t\t\t\t\t\t\t: \"text-gray-700 hover:bg-gray-50\"\r\n\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<RatingStars rating={rating} />\r\n\t\t\t\t\t\t\t\t\t<span className=\"ml-2\">{rating}+ estrellas</span>\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Descuento */}\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\t\tid=\"mobile-discount-filter\"\r\n\t\t\t\t\t\t\t\tchecked={showingDiscounted}\r\n\t\t\t\t\t\t\t\tonChange={onDiscountToggle}\r\n\t\t\t\t\t\t\t\tclassName=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\t\thtmlFor=\"mobile-discount-filter\"\r\n\t\t\t\t\t\t\t\tclassName=\"ml-2 block text-sm text-gray-700\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tProductos con descuento\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{/* Footer */}\r\n\t\t\t\t<div className=\"p-4 border-t border-gray-200 space-y-3\">\r\n\t\t\t\t\t{hasActiveFilters && (\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={onClearFilters}\r\n\t\t\t\t\t\t\tclassName=\"w-full py-2 px-4 border border-gray-300 rounded-md text-gray-700 bg-white hover:bg-gray-50 text-sm\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tLimpiar filtros\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={onClose}\r\n\t\t\t\t\t\tclassName=\"w-full py-2 px-4 bg-primary-600 hover:bg-primary-700 text-white rounded-md text-sm\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tVer resultados\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default MobileFilterPanel;\r\n","import React from \"react\";\r\nimport {X, Filter} from \"lucide-react\";\r\n\r\ninterface ActiveFiltersProps {\r\n\tselectedCategories: string[];\r\n\tselectedPriceRange: {min: number; max: number} | null;\r\n\tselectedRating: number | null;\r\n\tsearchTerm: string;\r\n\tshowingDiscounted: boolean;\r\n\tonRemoveCategory: (category: string) => void;\r\n\tonClearPriceRange: () => void;\r\n\tonClearRating: () => void;\r\n\tonClearSearch: () => void;\r\n\tonToggleDiscount: () => void;\r\n\tonClearAllFilters: () => void;\r\n\tonToggleFilters: () => void;\r\n}\r\n\r\nconst ActiveFilters: React.FC<ActiveFiltersProps> = ({\r\n\tselectedCategories,\r\n\tselectedPriceRange,\r\n\tselectedRating,\r\n\tsearchTerm,\r\n\tshowingDiscounted,\r\n\tonRemoveCategory,\r\n\tonClearPriceRange,\r\n\tonClearRating,\r\n\tonClearSearch,\r\n\tonToggleDiscount,\r\n\tonClearAllFilters,\r\n\tonToggleFilters,\r\n}) => {\r\n\t// Verificar si hay filtros activos\r\n\tconst hasActiveFilters =\r\n\t\tselectedCategories.length > 0 ||\r\n\t\tselectedPriceRange !== null ||\r\n\t\tselectedRating !== null ||\r\n\t\tshowingDiscounted ||\r\n\t\tsearchTerm !== \"\";\r\n\r\n\t// No mostrar si no hay filtros activos\r\n\tif (!hasActiveFilters) {\r\n\t\treturn (\r\n\t\t\t<button\r\n\t\t\t\tonClick={onToggleFilters}\r\n\t\t\t\tclassName=\"md:hidden flex items-center px-4 py-2 bg-white rounded-lg shadow border border-gray-200 text-gray-700\"\r\n\t\t\t>\r\n\t\t\t\t<Filter size={18} className=\"mr-2\" />\r\n\t\t\t\t<span>Filtros</span>\r\n\t\t\t</button>\r\n\t\t);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"w-full md:w-auto\">\r\n\t\t\t<div className=\"flex items-center justify-between mb-2\">\r\n\t\t\t\t<h3 className=\"text-sm font-medium text-gray-700\">Filtros Activos</h3>\r\n\t\t\t\t{hasActiveFilters && (\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={onClearAllFilters}\r\n\t\t\t\t\t\tclassName=\"text-xs text-primary-600 hover:text-primary-700\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tLimpiar todos\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\r\n\t\t\t<div className=\"flex flex-wrap gap-2\">\r\n\t\t\t\t{/* Filtro móvil - Solo visible en móvil */}\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={onToggleFilters}\r\n\t\t\t\t\tclassName=\"md:hidden flex items-center px-3 py-1 bg-primary-50 text-primary-700 rounded-full text-sm\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<Filter size={14} className=\"mr-1\" />\r\n\t\t\t\t\t<span>Filtrar</span>\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t{/* Término de búsqueda */}\r\n\t\t\t\t{searchTerm && (\r\n\t\t\t\t\t<div className=\"flex items-center px-3 py-1 bg-blue-50 text-blue-700 rounded-full text-sm\">\r\n\t\t\t\t\t\t<span className=\"mr-1\">Búsqueda: {searchTerm}</span>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={onClearSearch}\r\n\t\t\t\t\t\t\tclassName=\"ml-1 text-blue-500 hover:text-blue-700\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<X size={14} />\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{/* Categorías seleccionadas */}\r\n\t\t\t\t{selectedCategories.map((category, key) => (\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tkey={`Active Filter - ${category} - ${key}`}\r\n\t\t\t\t\t\tclassName=\"flex items-center px-3 py-1 bg-primary-100 text-primary-700 rounded-full text-sm\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<span className=\"mr-1\">Categoría: {category}</span>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={() => onRemoveCategory(category)}\r\n\t\t\t\t\t\t\tclassName=\"ml-1 text-primary-500 hover:text-primary-700\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<X size={14} />\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t))}\r\n\r\n\t\t\t\t{/* Rango de precio */}\r\n\t\t\t\t{selectedPriceRange && (\r\n\t\t\t\t\t<div className=\"flex items-center px-3 py-1 bg-green-50 text-green-700 rounded-full text-sm\">\r\n\t\t\t\t\t\t<span className=\"mr-1\">\r\n\t\t\t\t\t\t\tPrecio: ${selectedPriceRange.min} - ${selectedPriceRange.max}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={onClearPriceRange}\r\n\t\t\t\t\t\t\tclassName=\"ml-1 text-green-500 hover:text-green-700\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<X size={14} />\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{/* Valoración */}\r\n\t\t\t\t{selectedRating !== null && (\r\n\t\t\t\t\t<div className=\"flex items-center px-3 py-1 bg-yellow-50 text-yellow-700 rounded-full text-sm\">\r\n\t\t\t\t\t\t<span className=\"mr-1\">\r\n\t\t\t\t\t\t\tValoración: {selectedRating}+ estrellas\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={onClearRating}\r\n\t\t\t\t\t\t\tclassName=\"ml-1 text-yellow-500 hover:text-yellow-700\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<X size={14} />\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{/* Descuento */}\r\n\t\t\t\t{showingDiscounted && (\r\n\t\t\t\t\t<div className=\"flex items-center px-3 py-1 bg-red-50 text-red-700 rounded-full text-sm\">\r\n\t\t\t\t\t\t<span className=\"mr-1\">Con descuento</span>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={onToggleDiscount}\r\n\t\t\t\t\t\t\tclassName=\"ml-1 text-red-500 hover:text-red-700\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<X size={14} />\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default ActiveFilters;\r\n","import React from \"react\";\r\nimport {ChevronLeft, ChevronRight} from \"lucide-react\";\r\n\r\ninterface PaginationProps {\r\n\tcurrentPage: number;\r\n\ttotalPages: number;\r\n\tonPageChange: (page: number) => void;\r\n}\r\n\r\nconst Pagination: React.FC<PaginationProps> = ({\r\n\tcurrentPage,\r\n\ttotalPages,\r\n\tonPageChange,\r\n}) => {\r\n\t// No mostrar paginación si solo hay una página\r\n\tif (totalPages <= 1) return null;\r\n\r\n\t// Determinar qué páginas mostrar\r\n\tconst getPageNumbers = () => {\r\n\t\tconst pages: (number | string)[] = [];\r\n\r\n\t\t// Siempre incluir la primera página\r\n\t\tpages.push(1);\r\n\r\n\t\t// Mostrar puntos suspensivos si no estamos cerca del principio\r\n\t\tif (currentPage > 3) {\r\n\t\t\tpages.push(\"...\");\r\n\t\t}\r\n\r\n\t\t// Páginas adyacentes a la actual\r\n\t\tfor (\r\n\t\t\tlet i = Math.max(2, currentPage - 1);\r\n\t\t\ti <= Math.min(totalPages - 1, currentPage + 1);\r\n\t\t\ti++\r\n\t\t) {\r\n\t\t\tif (i > 1 && i < totalPages) {\r\n\t\t\t\tpages.push(i);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Mostrar puntos suspensivos si no estamos cerca del final\r\n\t\tif (currentPage < totalPages - 2) {\r\n\t\t\tpages.push(\"...\");\r\n\t\t}\r\n\r\n\t\t// Siempre incluir la última página si hay más de una\r\n\t\tif (totalPages > 1) {\r\n\t\t\tpages.push(totalPages);\r\n\t\t}\r\n\r\n\t\treturn pages;\r\n\t};\r\n\r\n\tconst pages = getPageNumbers();\r\n\r\n\treturn (\r\n\t\t<div className=\"hidden md:flex justify-center mt-6\">\r\n\t\t\t<nav\r\n\t\t\t\tclassName=\"inline-flex items-center rounded-md shadow-sm\"\r\n\t\t\t\taria-label=\"Paginación\"\r\n\t\t\t>\r\n\t\t\t\t{/* Botón de página anterior */}\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={() => onPageChange(currentPage - 1)}\r\n\t\t\t\t\tdisabled={currentPage === 1}\r\n\t\t\t\t\tclassName={`relative inline-flex items-center rounded-l-md border border-gray-300 bg-white px-2 py-2 text-sm ${\r\n\t\t\t\t\t\tcurrentPage === 1\r\n\t\t\t\t\t\t\t? \"text-gray-300 cursor-not-allowed\"\r\n\t\t\t\t\t\t\t: \"text-gray-500 hover:bg-gray-50\"\r\n\t\t\t\t\t}`}\r\n\t\t\t\t>\r\n\t\t\t\t\t<span className=\"sr-only\">Anterior</span>\r\n\t\t\t\t\t<ChevronLeft size={16} />\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t{/* Números de página */}\r\n\t\t\t\t{pages.map((page, index) => (\r\n\t\t\t\t\t<React.Fragment key={index}>\r\n\t\t\t\t\t\t{typeof page === \"number\" ? (\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tonClick={() => onPageChange(page)}\r\n\t\t\t\t\t\t\t\tclassName={`relative inline-flex items-center border border-gray-300 px-4 py-2 text-sm font-medium ${\r\n\t\t\t\t\t\t\t\t\tcurrentPage === page\r\n\t\t\t\t\t\t\t\t\t\t? \"bg-primary-50 border-primary-500 text-primary-600 z-10\"\r\n\t\t\t\t\t\t\t\t\t\t: \"bg-white text-gray-500 hover:bg-gray-50\"\r\n\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{page}\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<span className=\"relative inline-flex items-center border border-gray-300 bg-white px-4 py-2 text-sm text-gray-700\">\r\n\t\t\t\t\t\t\t\t{page}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t))}\r\n\r\n\t\t\t\t{/* Botón de página siguiente */}\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={() => onPageChange(currentPage + 1)}\r\n\t\t\t\t\tdisabled={currentPage === totalPages}\r\n\t\t\t\t\tclassName={`relative inline-flex items-center rounded-r-md border border-gray-300 bg-white px-2 py-2 text-sm ${\r\n\t\t\t\t\t\tcurrentPage === totalPages\r\n\t\t\t\t\t\t\t? \"text-gray-300 cursor-not-allowed\"\r\n\t\t\t\t\t\t\t: \"text-gray-500 hover:bg-gray-50\"\r\n\t\t\t\t\t}`}\r\n\t\t\t\t>\r\n\t\t\t\t\t<span className=\"sr-only\">Siguiente</span>\r\n\t\t\t\t\t<ChevronRight size={16} />\r\n\t\t\t\t</button>\r\n\t\t\t</nav>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Pagination;\r\n","import React from \"react\";\r\nimport {ChevronLeft, ChevronRight} from \"lucide-react\";\r\n\r\ninterface MobilePaginationProps {\r\n\tcurrentPage: number;\r\n\ttotalPages: number;\r\n\tonPageChange: (page: number) => void;\r\n}\r\n\r\n/**\r\n * Componente de paginación optimizado para dispositivos móviles\r\n * Diseño intuitivo con indicadores visibles para la página actual\r\n */\r\nconst MobilePagination: React.FC<MobilePaginationProps> = ({\r\n\tcurrentPage,\r\n\ttotalPages,\r\n\tonPageChange,\r\n}) => {\r\n\t// Si no hay múltiples páginas, no mostrar paginación\r\n\tif (totalPages <= 1) return null;\r\n\r\n\t// Determinar qué páginas mostrar (máximo 5)\r\n\tconst getPageNumbers = () => {\r\n\t\tconst pageNumbers = [];\r\n\r\n\t\tif (totalPages <= 5) {\r\n\t\t\t// Si hay 5 o menos páginas, mostrar todas\r\n\t\t\tfor (let i = 1; i <= totalPages; i++) {\r\n\t\t\t\tpageNumbers.push(i);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// Para más páginas, mostrar un rango centrado en la página actual\r\n\t\t\tlet startPage;\r\n\r\n\t\t\tif (currentPage <= 3) {\r\n\t\t\t\t// Cerca del inicio\r\n\t\t\t\tstartPage = 1;\r\n\t\t\t} else if (currentPage >= totalPages - 2) {\r\n\t\t\t\t// Cerca del final\r\n\t\t\t\tstartPage = totalPages - 4;\r\n\t\t\t} else {\r\n\t\t\t\t// En medio\r\n\t\t\t\tstartPage = currentPage - 2;\r\n\t\t\t}\r\n\r\n\t\t\tfor (let i = 0; i < 5; i++) {\r\n\t\t\t\tpageNumbers.push(startPage + i);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn pageNumbers;\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"flex flex-col items-center mt-6 space-y-4\">\r\n\t\t\t{/* Indicador de página */}\r\n\t\t\t<div className=\"text-sm text-gray-500\">\r\n\t\t\t\tPágina <span className=\"font-medium text-gray-900\">{currentPage}</span>{\" \"}\r\n\t\t\t\tde <span className=\"font-medium text-gray-900\">{totalPages}</span>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Botones de paginación */}\r\n\t\t\t<div className=\"flex justify-center items-center space-x-1\">\r\n\t\t\t\t{/* Botón Anterior */}\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={() => onPageChange(currentPage - 1)}\r\n\t\t\t\t\tdisabled={currentPage === 1}\r\n\t\t\t\t\tclassName={`flex items-center justify-center w-10 h-10 rounded-lg border ${\r\n\t\t\t\t\t\tcurrentPage > 1\r\n\t\t\t\t\t\t\t? \"border-gray-300 text-gray-700 hover:bg-gray-50\"\r\n\t\t\t\t\t\t\t: \"border-gray-200 text-gray-400 cursor-not-allowed\"\r\n\t\t\t\t\t}`}\r\n\t\t\t\t\taria-label=\"Página anterior\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<ChevronLeft size={20} />\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t{/* Botones de número de página */}\r\n\t\t\t\t{getPageNumbers().map((pageNum) => (\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tkey={pageNum}\r\n\t\t\t\t\t\tonClick={() => onPageChange(pageNum)}\r\n\t\t\t\t\t\tclassName={`flex items-center justify-center w-10 h-10 rounded-lg text-sm ${\r\n\t\t\t\t\t\t\tcurrentPage === pageNum\r\n\t\t\t\t\t\t\t\t? \"bg-primary-600 text-white font-medium shadow-sm\"\r\n\t\t\t\t\t\t\t\t: \"border border-gray-300 text-gray-700 hover:bg-gray-50\"\r\n\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\taria-label={`Página ${pageNum}`}\r\n\t\t\t\t\t\taria-current={currentPage === pageNum ? \"page\" : undefined}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{pageNum}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t))}\r\n\r\n\t\t\t\t{/* Botón Siguiente */}\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={() => onPageChange(currentPage + 1)}\r\n\t\t\t\t\tdisabled={currentPage === totalPages}\r\n\t\t\t\t\tclassName={`flex items-center justify-center w-10 h-10 rounded-lg border ${\r\n\t\t\t\t\t\tcurrentPage < totalPages\r\n\t\t\t\t\t\t\t? \"border-gray-300 text-gray-700 hover:bg-gray-50\"\r\n\t\t\t\t\t\t\t: \"border-gray-200 text-gray-400 cursor-not-allowed\"\r\n\t\t\t\t\t}`}\r\n\t\t\t\t\taria-label=\"Página siguiente\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<ChevronRight size={20} />\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default MobilePagination;\r\n","import type { Category } from '../core/domain/entities/Category';\r\nimport type { Product } from '../core/domain/entities/Product';\r\n\r\n/**\r\n * Calcula el número de productos por categoría\r\n * @param categories Lista de categorías\r\n * @param products Lista de productos (opcional, si está disponible)\r\n * @returns Un objeto con el nombre de la categoría como clave y la cantidad de productos como valor\r\n */\r\nexport const calculateProductCountByCategory = (\r\n  categories: Category[],\r\n  products?: Product[]\r\n): Record<string, number> => {\r\n  const productCountMap: Record<string, number> = {};\r\n  \r\n  // Inicializar contador para todas las categorías\r\n  categories.forEach(category => {\r\n    productCountMap[category.name] = category.product_count || 0;\r\n  });\r\n  \r\n  // Si tenemos productos, actualizar contadores basados en ellos\r\n  if (products && products.length > 0) {\r\n    products.forEach(product => {\r\n      const categoryId = product.categoryId;\r\n      const category = categories.find(c => c.id === categoryId);\r\n      \r\n      if (category) {\r\n        productCountMap[category.name] = (productCountMap[category.name] || 0) + 1;\r\n      }\r\n    });\r\n  }\r\n  \r\n  return productCountMap;\r\n};\r\n\r\n/**\r\n * Ordena las categorías por cantidad de productos\r\n * @param categories Lista de categorías\r\n * @param productCountMap Mapa de conteo de productos por categoría\r\n * @returns Lista ordenada de categorías (de mayor a menor cantidad)\r\n */\r\nexport const sortCategoriesByProductCount = (\r\n  categories: Category[],\r\n  productCountMap: Record<string, number>\r\n): Category[] => {\r\n  return [...categories].sort((a, b) => {\r\n    const countA = productCountMap[a.name] || 0;\r\n    const countB = productCountMap[b.name] || 0;\r\n    return countB - countA; // Ordenar de mayor a menor\r\n  });\r\n};","import React, {useEffect, useState, useCallback, useMemo} from \"react\";\r\n\r\n// Importamos los hooks personalizados a través del archivo index\r\nimport {\r\n\tuseProductFilters,\r\n\tuseProductSearch,\r\n\tuseProducts,\r\n\tuseCategories,\r\n\tuseCart,\r\n\tuseFavorites,\r\n} from \"../hooks\";\r\n\r\n// Componentes mejorados\r\nimport SearchBar from \"../components/product/SearchBar\";\r\nimport CategoriesCarousel from \"../components/product/CategoriesCarousel\";\r\nimport ProductFilters from \"../components/product/ProductFilters\";\r\nimport ProductGrid from \"../components/product/ProductGrid\";\r\nimport SortDropdown from \"../components/product/SortDropdown\";\r\nimport MobileFilterPanel from \"../components/product/MobileFilterPanel\";\r\nimport ActiveFilters from \"../components/product/ActiveFilters\";\r\nimport Pagination from \"../components/product/Pagination\";\r\nimport MobilePagination from \"../components/product/MobilePagination\";\r\n\r\n// Utilidades y configuración\r\nimport {calculateProductCountByCategory} from \"../../utils/categoryUtils\";\r\nimport appConfig from \"../../config/appConfig\";\r\n\r\n// IMPORTAR LA FUNCIÓN DE IMAGEN CORRECTA (la que funcionaba)\r\nimport { getImageUrl} from \"../../utils/imageUtils\";\r\n\r\nimport type {Category} from \"../../core/domain/entities/Category\";\r\n\r\n// Constantes para filtros\r\nconst priceRanges = [\r\n\t{id: \"0-100\", label: \"Menos de $100\"},\r\n\t{id: \"100-300\", label: \"$100 - $300\"},\r\n\t{id: \"300-500\", label: \"$300 - $500\"},\r\n\t{id: \"500-1000\", label: \"$500 - $1000\"},\r\n\t{id: \"1000-2000\", label: \"$1000 - $2000\"},\r\n\t{id: \"2000-999999\", label: \"Más de $2000\"},\r\n];\r\n\r\nconst sortOptions = [\r\n\t{id: \"featured\", label: \"Destacados\"},\r\n\t{id: \"price-asc\", label: \"Precio: Menor a Mayor\"},\r\n\t{id: \"price-desc\", label: \"Precio: Mayor a Menor\"},\r\n\t{id: \"name-asc\", label: \"Nombre: A-Z\"},\r\n\t{id: \"name-desc\", label: \"Nombre: Z-A\"},\r\n\t{id: \"newest\", label: \"Más recientes\"},\r\n\t{id: \"rating\", label: \"Mejor valorados\"},\r\n];\r\n\r\nconst ProductPage: React.FC = () => {\r\n\t// Estado para UI\r\n\tconst [showMobileFilters, setShowMobileFilters] = useState(false);\r\n\tconst [isMobile, setIsMobile] = useState(false);\r\n\r\n\t// Hooks para datos y funcionalidad\r\n\tconst {\r\n\t\tloading: categoriesLoading,\r\n\t\terror: categoriesError,\r\n\t\tcategories: categoriesData,\r\n\t\tfetchCategories,\r\n\t} = useCategories();\r\n\r\n\tconst {\r\n\t\tsearchTerm,\r\n\t\tisSearching,\r\n\t\thandleSearchChange,\r\n\t\thandleSearchSubmit,\r\n\t\tclearSearch,\r\n\t\tsetSearchTermExternal,\r\n\t} = useProductSearch();\r\n\r\n\tconst {\r\n\t\tfilters,\r\n\t\tbuildFilterParams,\r\n\t\tsetCategories,\r\n\t\tsetPriceRange,\r\n\t\tsetRating,\r\n\t\tsetDiscount,\r\n\t\tsetSortBy,\r\n\t\tsetPage,\r\n\t\tsetSearchTerm,\r\n\t\tclearFilters,\r\n\t\ttoggleCategory,\r\n\t} = useProductFilters(categoriesData);\r\n\r\n\tconst {\r\n\t\tloading: productsLoading,\r\n\t\terror: productsError,\r\n\t\tproducts: productsData,\r\n\t\tmeta: productsMeta,\r\n\t\tfetchProducts,\r\n\t} = useProducts();\r\n\r\n\tconst {addToCart} = useCart();\r\n\tconst {toggleFavorite} = useFavorites();\r\n\r\n\t// Sincronizar término de búsqueda entre hooks\r\n\tuseEffect(() => {\r\n\t\tsetSearchTermExternal(filters.searchTerm);\r\n\t}, [filters.searchTerm, setSearchTermExternal]);\r\n\r\n\t// Calcular contador de productos por categoría\r\n\tconst productCountByCategory = useMemo(() => {\r\n\t\treturn calculateProductCountByCategory(categoriesData, productsData);\r\n\t}, [categoriesData, productsData]);\r\n\r\n\t// Detectar si es dispositivo móvil\r\n\tuseEffect(() => {\r\n\t\tconst handleResize = () => {\r\n\t\t\tsetIsMobile(window.innerWidth < 768);\r\n\t\t};\r\n\r\n\t\thandleResize(); // Check initially\r\n\t\twindow.addEventListener(\"resize\", handleResize);\r\n\r\n\t\treturn () => {\r\n\t\t\twindow.removeEventListener(\"resize\", handleResize);\r\n\t\t};\r\n\t}, []);\r\n\r\n\t// Cargar categorías al iniciar\r\n\tuseEffect(() => {\r\n\t\tconsole.log(\"Cargando categorías...\");\r\n\t\tfetchCategories(true, false); // withCounts = true, forceRefresh = false\r\n\t}, [fetchCategories]);\r\n\r\n\t// Cargar productos cuando cambian los filtros\r\n\tuseEffect(() => {\r\n\t\tif (categoriesData.length > 0) {\r\n\t\t\tconsole.log(\"Categorías cargadas, construyendo parámetros de filtro...\");\r\n\t\t\tconst params = buildFilterParams();\r\n\t\t\tconsole.log(\"Cargando productos con parámetros:\", params);\r\n\t\t\tfetchProducts(params);\r\n\t\t}\r\n\t}, [\r\n\t\tfetchProducts,\r\n\t\tbuildFilterParams,\r\n\t\tcategoriesData.length,\r\n\t\tfilters, // Dependencia de todo el objeto filters\r\n\t]);\r\n\r\n\t// Manejadores para interacciones de usuario\r\n\tconst handlePriceRangeChange = useCallback(\r\n\t\t(range: {min: number; max: number} | null) => {\r\n\t\t\tsetPriceRange(range);\r\n\t\t},\r\n\t\t[setPriceRange]\r\n\t);\r\n\r\n\tconst handleSearchSubmitInternal = useCallback(\r\n\t\t(searchTerm: string) => {\r\n\t\t\tconsole.log(\"Manejando búsqueda:\", searchTerm);\r\n\t\t\tsetSearchTerm(searchTerm);\r\n\t\t},\r\n\t\t[setSearchTerm]\r\n\t);\r\n\r\n\tconst handleClearSearch = useCallback(() => {\r\n\t\tconsole.log(\"Limpiando búsqueda\");\r\n\t\tsetSearchTerm(\"\");\r\n\t}, [setSearchTerm]);\r\n\r\n\tconst handleCategoryClick = useCallback(\r\n\t\t(category: Category) => {\r\n\t\t\tconsole.log(\"Clic en categoría:\", category.name);\r\n\t\t\ttoggleCategory(category.name);\r\n\t\t},\r\n\t\t[toggleCategory]\r\n\t);\r\n\r\n\tconst handleAddToCart = useCallback(\r\n\t\tasync (productId: number) => {\r\n\t\t\ttry {\r\n\t\t\t\tawait addToCart({\r\n\t\t\t\t\tproductId,\r\n\t\t\t\t\tquantity: 1,\r\n\t\t\t\t});\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error(\"Error al añadir al carrito:\", error);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[addToCart]\r\n\t);\r\n\r\n\tconst handleAddToWishlist = useCallback(\r\n\t\tasync (productId: number) => {\r\n\t\t\ttry {\r\n\t\t\t\tawait toggleFavorite(productId);\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error(\"Error al añadir a favoritos:\", error);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[toggleFavorite]\r\n\t);\r\n\r\n\t// FUNCIÓN HELPER PARA OBTENER IMAGEN DEL PRODUCTO\r\n\t// Esta función no causa recursión porque usa la importación directa\r\n\tconst getProductImageUrl = useCallback((imagePath: string | undefined) => {\r\n\t\treturn getImageUrl(imagePath);\r\n\t}, []);\r\n\r\n\t// Calcular el número total de páginas\r\n\tconst totalPages = productsMeta\r\n\t\t? Math.ceil(\r\n\t\t\t\tproductsMeta.total /\r\n\t\t\t\t\t(productsMeta.limit || appConfig.pagination.defaultPageSize)\r\n\t\t\t)\r\n\t\t: 0;\r\n\r\n\t// Determinar si hay filtros activos\r\n\tconst hasActiveFilters =\r\n\t\tfilters.categories.length > 0 ||\r\n\t\tfilters.priceRange !== null ||\r\n\t\tfilters.rating !== null ||\r\n\t\tfilters.discount ||\r\n\t\tfilters.sortBy !== \"featured\" ||\r\n\t\tfilters.searchTerm !== \"\";\r\n\r\n\t// Determinar si está cargando\r\n\tconst isLoading = productsLoading || categoriesLoading || isSearching;\r\n\r\n\t// Preparar categorías para el carrusel\r\n\tconst categoriesForCarousel = useMemo(() => {\r\n\t\treturn categoriesData.filter(cat => cat.is_active).slice(0, 24); // Máximo 24 categorías\r\n\t}, [categoriesData]);\r\n\r\n\tconsole.log(\"Estado actual:\", {\r\n\t\tcategoriesData: categoriesData.length,\r\n\t\tproductsData: productsData.length,\r\n\t\tfilters,\r\n\t\tisLoading,\r\n\t\thasActiveFilters,\r\n\t});\r\n\r\n\treturn (\r\n\t\t<div className=\"container mx-auto px-4 py-8\">\r\n\t\t\t<h1 className=\"text-3xl font-bold mb-6\">Productos</h1>\r\n\r\n\t\t\t{/* Search Bar Component */}\r\n\t\t\t<SearchBar\r\n\t\t\t\tsearchTerm={searchTerm}\r\n\t\t\t\tonSearchChange={handleSearchChange}\r\n\t\t\t\tonSearch={handleSearchSubmit(handleSearchSubmitInternal)}\r\n\t\t\t\tonClear={() => clearSearch(handleClearSearch)}\r\n\t\t\t\tisLoading={isSearching}\r\n\t\t\t/>\r\n\r\n\t\t\t{/* Categories Section */}\r\n\t\t\t<section className=\"mb-8\">\r\n\t\t\t\t<h2 className=\"text-xl font-bold mb-4\">Categorías</h2>\r\n\t\t\t\t{categoriesLoading ? (\r\n\t\t\t\t\t<div className=\"flex justify-center py-8\">\r\n\t\t\t\t\t\t<div className=\"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary-600\"></div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t) : categoriesError ? (\r\n\t\t\t\t\t<div className=\"p-4 bg-red-50 text-red-700 rounded-lg\">\r\n\t\t\t\t\t\t<p>Error al cargar categorías: {categoriesError}</p>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={() => fetchCategories(true, true)}\r\n\t\t\t\t\t\t\tclassName=\"mt-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tReintentar\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t) : categoriesForCarousel.length > 0 ? (\r\n\t\t\t\t\t<CategoriesCarousel \r\n\t\t\t\t\t\tcategories={categoriesForCarousel} \r\n\t\t\t\t\t\tonCategoryClick={handleCategoryClick}\r\n\t\t\t\t\t/>\r\n\t\t\t\t) : (\r\n\t\t\t\t\t<div className=\"p-4 bg-gray-50 text-gray-500 rounded-lg text-center\">\r\n\t\t\t\t\t\tNo hay categorías disponibles\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</section>\r\n\r\n\t\t\t{/* Filter and Sort Section */}\r\n\t\t\t<div className=\"flex md:justify-end justify-between mb-6\">\r\n\t\t\t\t{/* Active Filters Component */}\r\n\t\t\t\t<ActiveFilters\r\n\t\t\t\t\tselectedCategories={filters.categories}\r\n\t\t\t\t\tselectedPriceRange={filters.priceRange}\r\n\t\t\t\t\tselectedRating={filters.rating}\r\n\t\t\t\t\tsearchTerm={filters.searchTerm}\r\n\t\t\t\t\tshowingDiscounted={filters.discount}\r\n\t\t\t\t\tonRemoveCategory={(category) => {\r\n\t\t\t\t\t\tsetCategories(filters.categories.filter((c) => c !== category));\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tonClearPriceRange={() => setPriceRange(null)}\r\n\t\t\t\t\tonClearRating={() => setRating(null)}\r\n\t\t\t\t\tonClearSearch={handleClearSearch}\r\n\t\t\t\t\tonToggleDiscount={() => setDiscount(!filters.discount)}\r\n\t\t\t\t\tonClearAllFilters={clearFilters}\r\n\t\t\t\t\tonToggleFilters={() => setShowMobileFilters(true)}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t{/* Sort Dropdown Component */}\r\n\t\t\t\t<SortDropdown\r\n\t\t\t\t\toptions={sortOptions}\r\n\t\t\t\t\tselectedOption={filters.sortBy}\r\n\t\t\t\t\tonSortChange={setSortBy}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Main Content */}\r\n\t\t\t<div className=\"flex flex-col md:flex-row gap-6\">\r\n\t\t\t\t{/* Filters Sidebar - Desktop */}\r\n\t\t\t\t<div className=\"hidden md:block md:w-72 flex-shrink-0\">\r\n\t\t\t\t\t<ProductFilters\r\n\t\t\t\t\t\tcategories={categoriesData.map((cat) => cat.name)}\r\n\t\t\t\t\t\tpriceRange={{min: 0, max: 10000}}\r\n\t\t\t\t\t\tonCategoryChange={setCategories}\r\n\t\t\t\t\t\tonPriceRangeChange={handlePriceRangeChange}\r\n\t\t\t\t\t\tonRatingChange={setRating}\r\n\t\t\t\t\t\tonDiscountChange={(showDiscount) => setDiscount(showDiscount)}\r\n\t\t\t\t\t\tonClearFilters={clearFilters}\r\n\t\t\t\t\t\tselectedCategories={filters.categories}\r\n\t\t\t\t\t\tselectedPriceRange={filters.priceRange}\r\n\t\t\t\t\t\tselectedRating={filters.rating}\r\n\t\t\t\t\t\tselectedDiscount={filters.discount}\r\n\t\t\t\t\t\tproductCountByCategory={productCountByCategory}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{/* Mobile Filters Panel */}\r\n\t\t\t\t<MobileFilterPanel\r\n\t\t\t\t\tisOpen={showMobileFilters}\r\n\t\t\t\t\tonClose={() => setShowMobileFilters(false)}\r\n\t\t\t\t\tcategories={categoriesData}\r\n\t\t\t\t\tselectedCategories={filters.categories}\r\n\t\t\t\t\tpriceRanges={priceRanges}\r\n\t\t\t\t\tselectedRangeId={\r\n\t\t\t\t\t\tfilters.priceRange\r\n\t\t\t\t\t\t\t? `${filters.priceRange.min}-${filters.priceRange.max}`\r\n\t\t\t\t\t\t\t: null\r\n\t\t\t\t\t}\r\n\t\t\t\t\tselectedRating={filters.rating}\r\n\t\t\t\t\tshowingDiscounted={filters.discount}\r\n\t\t\t\t\tonCategoryChange={(category, isSelected) => {\r\n\t\t\t\t\t\tif (isSelected) {\r\n\t\t\t\t\t\t\tsetCategories([...filters.categories, category]);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tsetCategories(filters.categories.filter((c) => c !== category));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tonPriceRangeChange={(min, max) => {\r\n\t\t\t\t\t\thandlePriceRangeChange({min, max});\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tonRatingChange={setRating}\r\n\t\t\t\t\tonDiscountToggle={() => setDiscount(!filters.discount)}\r\n\t\t\t\t\tonClearFilters={clearFilters}\r\n\t\t\t\t\tproductCountByCategory={productCountByCategory}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t{/* Products Grid */}\r\n\t\t\t\t<div className=\"flex-1\">\r\n\t\t\t\t\t<ProductGrid\r\n\t\t\t\t\t\tproducts={productsData}\r\n\t\t\t\t\t\tcategories={categoriesData}\r\n\t\t\t\t\t\tisLoading={isLoading}\r\n\t\t\t\t\t\terror={productsError || null}\r\n\t\t\t\t\t\tonRetry={() => {\r\n\t\t\t\t\t\t\tconst params = buildFilterParams();\r\n\t\t\t\t\t\t\tfetchProducts(params);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tonAddToCart={handleAddToCart}\r\n\t\t\t\t\t\tonAddToWishlist={handleAddToWishlist}\r\n\t\t\t\t\t\tgetImageUrl={getProductImageUrl}\r\n\t\t\t\t\t\tselectedCategories={filters.categories}\r\n\t\t\t\t\t\ttotalItems={productsMeta?.total || 0}\r\n\t\t\t\t\t\tcurrentPage={filters.page}\r\n\t\t\t\t\t\titemsPerPage={\r\n\t\t\t\t\t\t\tproductsMeta?.limit || appConfig.pagination.defaultPageSize\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tonResetFilters={clearFilters}\r\n\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t{/* Paginación */}\r\n\t\t\t\t\t{productsMeta && productsMeta.total > productsMeta.limit && (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t{/* Paginación para móviles */}\r\n\t\t\t\t\t\t\t{isMobile && (\r\n\t\t\t\t\t\t\t\t<MobilePagination\r\n\t\t\t\t\t\t\t\t\tcurrentPage={filters.page}\r\n\t\t\t\t\t\t\t\t\ttotalPages={totalPages}\r\n\t\t\t\t\t\t\t\t\tonPageChange={setPage}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{/* Paginación para desktop */}\r\n\t\t\t\t\t\t\t{!isMobile && (\r\n\t\t\t\t\t\t\t\t<Pagination\r\n\t\t\t\t\t\t\t\t\tcurrentPage={filters.page}\r\n\t\t\t\t\t\t\t\t\ttotalPages={totalPages}\r\n\t\t\t\t\t\t\t\t\tonPageChange={setPage}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{/* Mensaje cuando no hay productos con los filtros actuales */}\r\n\t\t\t\t\t{!isLoading &&\r\n\t\t\t\t\t\t!productsError &&\r\n\t\t\t\t\t\tproductsData.length === 0 &&\r\n\t\t\t\t\t\thasActiveFilters && (\r\n\t\t\t\t\t\t\t<div className=\"mt-8 p-6 bg-yellow-50 border border-yellow-200 text-yellow-800 rounded-lg text-center\">\r\n\t\t\t\t\t\t\t\t<h3 className=\"text-lg font-medium mb-2\">\r\n\t\t\t\t\t\t\t\t\tNo se encontraron productos\r\n\t\t\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t\t\t<p className=\"mb-4\">\r\n\t\t\t\t\t\t\t\t\tNo hay productos que coincidan con los filtros seleccionados.\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tonClick={clearFilters}\r\n\t\t\t\t\t\t\t\t\tclassName=\"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\tLimpiar todos los filtros\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{/* Mensaje cuando no hay productos sin filtros */}\r\n\t\t\t\t\t{!isLoading &&\r\n\t\t\t\t\t\t!productsError &&\r\n\t\t\t\t\t\tproductsData.length === 0 &&\r\n\t\t\t\t\t\t!hasActiveFilters && (\r\n\t\t\t\t\t\t\t<div className=\"mt-8 p-6 bg-gray-50 border border-gray-200 text-gray-600 rounded-lg text-center\">\r\n\t\t\t\t\t\t\t\t<h3 className=\"text-lg font-medium mb-2\">\r\n\t\t\t\t\t\t\t\t\tNo hay productos disponibles\r\n\t\t\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\t\t\tActualmente no hay productos en el catálogo. Por favor, inténtalo más tarde.\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default ProductPage;"],"names":["__iconNode","Speaker","createLucideIcon","Watch","ApiResponseInspector","response","label","structure","error","obj","keys","snakeCaseKeys","key","camelCaseKeys","DebugUtils","params","categories","id","category","c","baseUrl","queryParams","value","url","params1","params2","val1","val2","errors","productService","ProductService","getCacheKey","paramsForKey","a","b","useProducts","loading","setLoading","useState","setError","products","setProducts","product","setProduct","meta","setMeta","isInitialized","setIsInitialized","adaptProduct","useCallback","apiProduct","processedImages","img","imageUrl","adaptedProduct","useEffect","cachedFeatured","CacheService","fetchProducts","filterParams","validation","cacheKey","cachedData","adaptedData","result","appConfig","err","errorMessage","fetchProductById","cachedProduct","productDetailResponse","fetchProductBySlug","slug","fetchFeaturedProducts","limit","cachedProducts","featuredProducts","adaptedProducts","fetchRelatedProducts","productId","relatedProducts","trackProductView","clearProductCache","productKeys","useProductFilters","allCategories","defaultPageSize","searchParams","setSearchParams","useSearchParams","isUpdatingUrl","useRef","lastProcessedParams","filtersState","setFiltersState","categoryParam","minPriceParam","maxPriceParam","ratingParam","discountParam","sortParam","pageParam","searchParam","newParams","newParamsString","currentParams","updateFiltersAndUrl","updates","prev","setCategories","setPriceRange","priceRange","setRating","rating","setDiscount","discount","setSortBy","sortBy","setPage","page","setSearchTerm","searchTerm","clearFilters","toggleCategory","newCategories","buildFilterParams","categoryIds","catName","useProductSearch","isSearching","setIsSearching","handleSearchChange","e","setSearchTermExternal","term","handleSearchSubmit","onSearchSubmit","clearSearch","onClearSearch","SearchBar","onSearchChange","onSearch","onClear","isLoading","inputRef","handleClear","jsxs","jsx","X","Search","SearchBar$1","React","CATEGORY_ICONS","Smartphone","Tv","Laptop","Monitor","Headphones","Camera","Package","CategoriesCarousel","onCategoryClick","currentPage","setCurrentPage","getItemsPerPage","width","itemsPerPage","setItemsPerPage","handleResize","newTotalPages","totalPages","getCurrentPageCategories","start","end","goToPreviousPage","goToNextPage","handleCategoryClick","event","renderIcon","lowerName","categoryKey","IconComponent","ChevronLeft","_","index","ChevronRight","ChevronRightIcon","FilterSection","title","isExpanded","onToggle","children","ChevronUp","ChevronDown","CategoryFilterSection","selectedCategories","onCategoryChange","productCountByCategory","handleCategoryToggle","PriceFilterSection","initialMin","initialMax","selectedRange","onApply","minPrice","setMinPrice","maxPrice","setMaxPrice","handleMinChange","handleMaxChange","handleApply","validMin","validMax","RatingFilterSection","selectedRating","onRatingChange","ratings","i","Star","DiscountFilterSection","selectedDiscount","onDiscountChange","ProductFilters","onPriceRangeChange","onClearFilters","selectedPriceRange","expandedSections","setExpandedSections","toggleSection","section","hasActiveFilters","min","max","rating_count","images","discountPercentage","price","finalPrice","ProductGrid","onRetry","onAddToCart","onAddToWishlist","getImageUrl","totalItems","onResetFilters","processedImageUrl","ProductCardCompact","cat","SortDropdown","options","selectedOption","onSortChange","isOpen","setIsOpen","dropdownRef","handleClickOutside","getSelectedLabel","option","opt","handleSelect","optionId","MobileFilterPanel","onClose","priceRanges","selectedRangeId","showingDiscounted","onDiscountToggle","handlePriceRangeSelect","rangeId","range","RatingStars","ActiveFilters","onRemoveCategory","onClearPriceRange","onClearRating","onToggleDiscount","onClearAllFilters","onToggleFilters","Filter","Pagination","onPageChange","pages","MobilePagination","getPageNumbers","pageNumbers","startPage","pageNum","calculateProductCountByCategory","productCountMap","categoryId","sortOptions","ProductPage","showMobileFilters","setShowMobileFilters","isMobile","setIsMobile","categoriesLoading","categoriesError","categoriesData","fetchCategories","useCategories","filters","productsLoading","productsError","productsData","productsMeta","addToCart","useCart","toggleFavorite","useFavorites","useMemo","handlePriceRangeChange","handleSearchSubmitInternal","handleClearSearch","handleAddToCart","handleAddToWishlist","getProductImageUrl","imagePath","categoriesForCarousel","showDiscount","isSelected","Fragment"],"mappings":"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","x_google_ignoreList":[0,1]}