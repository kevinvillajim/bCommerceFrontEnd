{"version":3,"file":"AdminRatingsPage-DLqiRB-8.js","sources":["../../src/core/services/AdminRatingService.ts","../../src/presentation/hooks/useAdminRatings.ts","../../src/presentation/pages/admin/AdminRatingsPage.tsx"],"sourcesContent":["// src/core/services/AdminRatingService.ts\r\nimport ApiClient from \"../../infrastructure/api/apiClient\";\r\nimport {API_ENDPOINTS} from \"../../constants/apiEndpoints\";\r\nimport type {Rating} from \"../domain/entities/Rating\";\r\n\r\n// Interfaces para las respuestas de API\r\nexport interface AdminRatingResponse {\r\n\tstatus: string;\r\n\tmessage?: string;\r\n\tdata: Rating[];\r\n\tmeta: {\r\n\t\ttotal: number;\r\n\t\tper_page: number;\r\n\t\tcurrent_page: number;\r\n\t\tlast_page: number;\r\n\t};\r\n}\r\n\r\nexport interface AdminActionResponse {\r\n\tstatus: string;\r\n\tmessage: string;\r\n\tdata?: {\r\n\t\tnewStatus?: string;\r\n\t\t[key: string]: any;\r\n\t};\r\n}\r\n\r\nexport interface AdminRatingFilters {\r\n\tstatus?: string;\r\n\ttype?: string;\r\n\trating?: number | null;\r\n\tfrom_date?: string;\r\n\tto_date?: string;\r\n\tpage?: number;\r\n\tper_page?: number;\r\n}\r\n\r\n/**\r\n * Servicio para la administración de valoraciones\r\n */\r\nexport class AdminRatingService {\r\n\t/**\r\n\t * Obtiene todas las valoraciones con filtros opcionales\r\n\t */\r\n\tasync getRatings(\r\n\t\tfilters: AdminRatingFilters = {}\r\n\t): Promise<AdminRatingResponse> {\r\n\t\ttry {\r\n\t\t\tconst response = await ApiClient.get<AdminRatingResponse>(\r\n\t\t\t\tAPI_ENDPOINTS.ADMIN.RATINGS.LIST,\r\n\t\t\t\tfilters\r\n\t\t\t);\r\n\t\t\treturn response;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al obtener valoraciones:\", error);\r\n\t\t\tthrow error;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Aprueba una valoración\r\n\t */\r\n\tasync approveRating(\r\n\t\tratingId: number,\r\n\t\tnote?: string\r\n\t): Promise<AdminActionResponse> {\r\n\t\ttry {\r\n\t\t\tconst response = await ApiClient.post<AdminActionResponse>(\r\n\t\t\t\tAPI_ENDPOINTS.ADMIN.RATINGS.APPROVE(ratingId),\r\n\t\t\t\t{note}\r\n\t\t\t);\r\n\t\t\treturn response;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(`Error al aprobar valoración ${ratingId}:`, error);\r\n\t\t\tthrow error;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Rechaza una valoración\r\n\t */\r\n\tasync rejectRating(\r\n\t\tratingId: number,\r\n\t\tnote: string\r\n\t): Promise<AdminActionResponse> {\r\n\t\ttry {\r\n\t\t\tconst response = await ApiClient.post<AdminActionResponse>(\r\n\t\t\t\tAPI_ENDPOINTS.ADMIN.RATINGS.REJECT(ratingId),\r\n\t\t\t\t{note}\r\n\t\t\t);\r\n\t\t\treturn response;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(`Error al rechazar valoración ${ratingId}:`, error);\r\n\t\t\tthrow error;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Reporta o desmarca una valoración para revisión adicional\r\n\t */\r\n\tasync flagRating(\r\n\t\tratingId: number,\r\n\t\treason: string\r\n\t): Promise<AdminActionResponse> {\r\n\t\ttry {\r\n\t\t\tconst response = await ApiClient.post<AdminActionResponse>(\r\n\t\t\t\tAPI_ENDPOINTS.ADMIN.RATINGS.FLAG(ratingId),\r\n\t\t\t\t{reason}\r\n\t\t\t);\r\n\t\t\treturn response;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(`Error al marcar/desmarcar valoración ${ratingId}:`, error);\r\n\t\t\tthrow error;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Obtiene estadísticas generales de valoraciones\r\n\t */\r\n\tasync getRatingStats(): Promise<any> {\r\n\t\ttry {\r\n\t\t\tconst response = await ApiClient.get(API_ENDPOINTS.ADMIN.RATINGS.STATS);\r\n\t\t\treturn response;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al obtener estadísticas de valoraciones:\", error);\r\n\t\t\tthrow error;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default AdminRatingService;","// src/presentation/hooks/useAdminRatings.ts\r\nimport {useState, useEffect, useCallback} from \"react\";\r\nimport AdminRatingService from \"../../core/services/AdminRatingService\";\r\nimport type {AdminRatingFilters} from \"../../core/services/AdminRatingService\";\r\nimport type {Rating} from \"../../core/domain/entities/Rating\";\r\nimport {extractErrorMessage} from \"../../utils/errorHandler\";\r\n\r\nexport const useAdminRatings = () => {\r\n\t// Estado para almacenar las valoraciones\r\n\tconst [ratings, setRatings] = useState<Rating[]>([]);\r\n\tconst [loading, setLoading] = useState(true);\r\n\tconst [error, setError] = useState<string | null>(null);\r\n\tconst [statsLoading, setStatsLoading] = useState(true);\r\n\r\n\t// Estado para filtros\r\n\tconst [statusFilter, setStatusFilter] = useState<string>(\"all\");\r\n\tconst [typeFilter, setTypeFilter] = useState<string>(\"all\");\r\n\tconst [ratingFilter, setRatingFilter] = useState<number | null>(null);\r\n\tconst [dateRangeFilter, setDateRangeFilter] = useState<{\r\n\t\tfrom: string;\r\n\t\tto: string;\r\n\t}>({\r\n\t\tfrom: \"\",\r\n\t\tto: \"\",\r\n\t});\r\n\r\n\t// Estado para paginación\r\n\tconst [pagination, setPagination] = useState({\r\n\t\tcurrentPage: 1,\r\n\t\ttotalPages: 1,\r\n\t\ttotalItems: 0,\r\n\t\titemsPerPage: 10,\r\n\t});\r\n\r\n\t// Estado para estadísticas\r\n\tconst [stats, setStats] = useState({\r\n\t\ttotal: 0,\r\n\t\tpending: 0,\r\n\t\tapproved: 0,\r\n\t\trejected: 0,\r\n\t});\r\n\r\n\t// Estado para el modal de detalle\r\n\tconst [selectedRating, setSelectedRating] = useState<Rating | null>(null);\r\n\tconst [showRatingModal, setShowRatingModal] = useState(false);\r\n\tconst [moderationNote, setModerationNote] = useState(\"\");\r\n\r\n\t// Añade un estado para controlar la inicialización\r\n\tconst [isInitialized, setIsInitialized] = useState(false);\r\n\r\n\t// Inicializar el servicio\r\n\tconst adminRatingService = new AdminRatingService();\r\n\r\n\t// Función para obtener las valoraciones\r\n\tconst fetchRatings = useCallback(async () => {\r\n\t\tsetLoading(true);\r\n\t\tsetError(null);\r\n\r\n\t\ttry {\r\n\t\t\t// Preparar los filtros para la API\r\n\t\t\tconst filters: AdminRatingFilters = {\r\n\t\t\t\tpage: pagination.currentPage,\r\n\t\t\t\tper_page: pagination.itemsPerPage,\r\n\t\t\t};\r\n\r\n\t\t\t// Agregar filtros opcionales si están establecidos\r\n\t\t\tif (statusFilter !== \"all\") filters.status = statusFilter;\r\n\t\t\tif (typeFilter !== \"all\") filters.type = typeFilter;\r\n\t\t\tif (ratingFilter !== null) filters.rating = ratingFilter;\r\n\t\t\tif (dateRangeFilter.from) filters.from_date = dateRangeFilter.from;\r\n\t\t\tif (dateRangeFilter.to) filters.to_date = dateRangeFilter.to;\r\n\r\n\t\t\t// Realizar la petición\r\n\t\t\tconst response = await adminRatingService.getRatings(filters);\r\n\r\n\t\t\t// Actualizar el estado con los datos recibidos\r\n\t\t\tif (response.status === \"success\" && response.data) {\r\n\t\t\t\tsetRatings(response.data);\r\n\r\n\t\t\t\t// Actualizar información de paginación\r\n\t\t\t\tsetPagination({\r\n\t\t\t\t\tcurrentPage: response.meta.current_page,\r\n\t\t\t\t\ttotalPages: response.meta.last_page,\r\n\t\t\t\t\ttotalItems: response.meta.total,\r\n\t\t\t\t\titemsPerPage: response.meta.per_page,\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(\r\n\t\t\t\t\tresponse.message || \"Error al obtener las valoraciones\"\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error(\"Error al obtener valoraciones:\", err);\r\n\t\t\tconst errorMessage = extractErrorMessage(\r\n\t\t\t\terr,\r\n\t\t\t\t\"Error al cargar las valoraciones\"\r\n\t\t\t);\r\n\t\t\tsetError(errorMessage);\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t}, [\r\n\t\tadminRatingService,\r\n\t\tpagination.currentPage,\r\n\t\tpagination.itemsPerPage,\r\n\t\tstatusFilter,\r\n\t\ttypeFilter,\r\n\t\tratingFilter,\r\n\t\tdateRangeFilter,\r\n\t]);\r\n\r\n\t// Función para obtener estadísticas\r\n\tconst fetchStats = useCallback(async () => {\r\n\t\tsetStatsLoading(true);\r\n\t\ttry {\r\n\t\t\tconst response = await adminRatingService.getRatingStats();\r\n\t\t\tif (response.status === \"success\" && response.data) {\r\n\t\t\t\tsetStats({\r\n\t\t\t\t\ttotal: response.data.total || 0,\r\n\t\t\t\t\tpending: response.data.pending || 0,\r\n\t\t\t\t\tapproved: response.data.approved || 0,\r\n\t\t\t\t\trejected: response.data.rejected || 0,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error(\"Error al obtener estadísticas:\", err);\r\n\t\t} finally {\r\n\t\t\tsetStatsLoading(false);\r\n\t\t}\r\n\t}, [adminRatingService]);\r\n\r\n\tuseEffect(() => {\r\n\t\t// Función para verificar la sesión antes de cargar datos\r\n\t\tconst checkSessionAndLoad = async () => {\r\n\t\t\ttry {\r\n\t\t\t\t// Opción 1: Hacer una petición liviana que solo verifique permisos\r\n\t\t\t\t// Por ejemplo: await ApiClient.get('/api/admin/check-session');\r\n\r\n\t\t\t\t// O simplemente esperar un momento para permitir que se inicialice la sesión\r\n\t\t\t\tawait new Promise((resolve) => setTimeout(resolve, 500));\r\n\r\n\t\t\t\t// Si llegamos aquí, procedemos a cargar los datos\r\n\t\t\t\tsetIsInitialized(true);\r\n\t\t\t} catch (err) {\r\n\t\t\t\t// Si hay un error, no inicializar\r\n\t\t\t\tconsole.error(\"Error al verificar la sesión:\", err);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tcheckSessionAndLoad();\r\n\t}, []);\r\n\r\n\t// Modifica el useEffect original para depender SOLO de isInitialized\r\n\tuseEffect(() => {\r\n\t\tif (isInitialized) {\r\n\t\t\tfetchRatings();\r\n\t\t\tfetchStats();\r\n\t\t}\r\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, [isInitialized]); // Eliminamos fetchRatings y fetchStats de las dependencias\r\n\r\n\t// Modificamos las funciones que cambian filtros para que llamen a fetchRatings\r\n\tconst handleStatusFilterChange = (status: string) => {\r\n\t\tsetStatusFilter(status);\r\n\t\t// Utilizamos setTimeout para asegurar que el estado se actualice antes de fetchRatings\r\n\t\tsetTimeout(() => fetchRatings(), 0);\r\n\t};\r\n\r\n\tconst handleTypeFilterChange = (type: string) => {\r\n\t\tsetTypeFilter(type);\r\n\t\tsetTimeout(() => fetchRatings(), 0);\r\n\t};\r\n\r\n\tconst handleRatingFilterChange = (rating: number | null) => {\r\n\t\tsetRatingFilter(rating);\r\n\t\tsetTimeout(() => fetchRatings(), 0);\r\n\t};\r\n\r\n\tconst handleDateRangeFilterChange = (dateRange: {\r\n\t\tfrom: string;\r\n\t\tto: string;\r\n\t}) => {\r\n\t\tsetDateRangeFilter(dateRange);\r\n\t\tsetTimeout(() => fetchRatings(), 0);\r\n\t};\r\n\r\n\t// Función para cambiar de página\r\n\tconst handlePageChange = (page: number) => {\r\n\t\tsetPagination((prev) => ({\r\n\t\t\t...prev,\r\n\t\t\tcurrentPage: page,\r\n\t\t}));\r\n\t\t// Cargar datos nuevamente cuando cambia la página\r\n\t\tsetTimeout(() => fetchRatings(), 0);\r\n\t};\r\n\r\n\t// Función para abrir el modal de valoración\r\n\tconst openRatingModal = (rating: Rating) => {\r\n\t\tsetSelectedRating(rating);\r\n\t\tsetModerationNote(\"\");\r\n\t\tsetShowRatingModal(true);\r\n\t};\r\n\r\n\t// Función para cerrar el modal de valoración\r\n\tconst closeRatingModal = () => {\r\n\t\tsetSelectedRating(null);\r\n\t\tsetShowRatingModal(false);\r\n\t\tsetModerationNote(\"\");\r\n\t};\r\n\r\n\t// Función para aprobar una valoración\r\n\tconst approveRating = async (ratingId: number) => {\r\n\t\ttry {\r\n\t\t\tconst response = await adminRatingService.approveRating(\r\n\t\t\t\tratingId,\r\n\t\t\t\tmoderationNote\r\n\t\t\t);\r\n\t\t\tif (response.status === \"success\") {\r\n\t\t\t\t// Actualizar el estado local\r\n\t\t\t\tsetRatings((prevRatings) =>\r\n\t\t\t\t\tprevRatings.map((rating) =>\r\n\t\t\t\t\t\trating.id === ratingId ? {...rating, status: \"approved\"} : rating\r\n\t\t\t\t\t)\r\n\t\t\t\t);\r\n\r\n\t\t\t\t// Actualizar estadísticas\r\n\t\t\t\tfetchStats();\r\n\r\n\t\t\t\t// Cerrar modal si está abierto\r\n\t\t\t\tcloseRatingModal();\r\n\r\n\t\t\t\treturn true;\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(response.message || \"Error al aprobar la valoración\");\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error(`Error al aprobar valoración ${ratingId}:`, err);\r\n\t\t\tsetError(extractErrorMessage(err, \"Error al aprobar la valoración\"));\r\n\t\t\treturn false;\r\n\t\t}\r\n\t};\r\n\r\n\t// Función para rechazar una valoración\r\n\tconst rejectRating = async (ratingId: number) => {\r\n\t\t// Validar que hay una nota de moderación para el rechazo\r\n\t\tif (!moderationNote) {\r\n\t\t\tsetError(\r\n\t\t\t\t\"Es necesario proporcionar una nota de moderación para rechazar una valoración\"\r\n\t\t\t);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tconst response = await adminRatingService.rejectRating(\r\n\t\t\t\tratingId,\r\n\t\t\t\tmoderationNote\r\n\t\t\t);\r\n\t\t\tif (response.status === \"success\") {\r\n\t\t\t\t// Actualizar el estado local\r\n\t\t\t\tsetRatings((prevRatings) =>\r\n\t\t\t\t\tprevRatings.map((rating) =>\r\n\t\t\t\t\t\trating.id === ratingId ? {...rating, status: \"rejected\"} : rating\r\n\t\t\t\t\t)\r\n\t\t\t\t);\r\n\r\n\t\t\t\t// Actualizar estadísticas\r\n\t\t\t\tfetchStats();\r\n\r\n\t\t\t\t// Cerrar modal si está abierto\r\n\t\t\t\tcloseRatingModal();\r\n\r\n\t\t\t\treturn true;\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(response.message || \"Error al rechazar la valoración\");\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error(`Error al rechazar valoración ${ratingId}:`, err);\r\n\t\t\tsetError(extractErrorMessage(err, \"Error al rechazar la valoración\"));\r\n\t\t\treturn false;\r\n\t\t}\r\n\t};\r\n\r\n\t// Función para reportar una valoración\r\n\tconst flagRating = async (ratingId: number, reason: string) => {\r\n\t\ttry {\r\n\t\t\tconst response = await adminRatingService.flagRating(ratingId, reason);\r\n\r\n\t\t\tif (response.status === \"success\") {\r\n\t\t\t\t// CORREGIDO: Verificar si data existe antes de acceder a newStatus\r\n\t\t\t\tif (response.data && response.data.newStatus) {\r\n\t\t\t\t\tsetRatings((prevRatings) =>\r\n\t\t\t\t\t\tprevRatings.map((rating) =>\r\n\t\t\t\t\t\t\trating.id === ratingId\r\n\t\t\t\t\t\t\t\t? {...rating, status: response.data!.newStatus as any} // CORREGIDO: non-null assertion y cast\r\n\t\t\t\t\t\t\t\t: rating\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfetchStats();\r\n\t\t\t\treturn true;\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(\r\n\t\t\t\t\tresponse.message || \"Error al modificar el estado de la valoración\"\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error(\r\n\t\t\t\t`Error al modificar estado de valoración ${ratingId}:`,\r\n\t\t\t\terr\r\n\t\t\t);\r\n\t\t\tsetError(\r\n\t\t\t\textractErrorMessage(err, \"Error al modificar estado de valoración\")\r\n\t\t\t);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t};\r\n\r\n\t// Función para refrescar los datos\r\n\tconst refreshData = () => {\r\n\t\tfetchRatings();\r\n\t\tfetchStats();\r\n\t};\r\n\r\n\treturn {\r\n\t\t// Estado\r\n\t\tratings,\r\n\t\tloading,\r\n\t\terror,\r\n\t\tstatsLoading,\r\n\t\tstats,\r\n\t\tstatusFilter,\r\n\t\ttypeFilter,\r\n\t\tratingFilter,\r\n\t\tdateRangeFilter,\r\n\t\tpagination,\r\n\t\tselectedRating,\r\n\t\tshowRatingModal,\r\n\t\tmoderationNote,\r\n\r\n\t\t// Funciones de acción\r\n\t\tsetStatusFilter: handleStatusFilterChange,\r\n\t\tsetTypeFilter: handleTypeFilterChange,\r\n\t\tsetRatingFilter: handleRatingFilterChange,\r\n\t\tsetDateRangeFilter: handleDateRangeFilterChange,\r\n\t\thandlePageChange,\r\n\t\topenRatingModal,\r\n\t\tcloseRatingModal,\r\n\t\tsetModerationNote,\r\n\t\tapproveRating,\r\n\t\trejectRating,\r\n\t\tflagRating,\r\n\t\trefreshData,\r\n\t};\r\n};\r\n\r\nexport default useAdminRatings;\r\n","// src/presentation/pages/admin/AdminRatingsPage.tsx\r\nimport React from \"react\";\r\nimport Table from \"../../components/dashboard/Table\";\r\nimport {\r\n  Star,\r\n  User,\r\n  Package,\r\n  Store,\r\n  Calendar,\r\n  Eye,\r\n  RefreshCw,\r\n  Filter,\r\n  CheckCircle,\r\n  XCircle,\r\n  AlertTriangle,\r\n  Clock,\r\n  Flag,\r\n  BarChart2,\r\n} from \"lucide-react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport type { Rating } from \"../../../core/domain/entities/Rating\";\r\nimport StatCardList from \"../../components/dashboard/StatCardList\";\r\nimport useAdminRatings from \"../../hooks/useAdminRatings\";\r\n\r\n// Mapeo de estado para las valoraciones\r\nconst ratingStatusMap: Record<\r\n  string,\r\n  { label: string; color: string; icon: React.ReactNode }\r\n> = {\r\n  pending: {\r\n    label: \"Pendiente\",\r\n    color: \"bg-yellow-100 text-yellow-800\",\r\n    icon: <Clock className=\"w-3 h-3 mr-1\" />,\r\n  },\r\n  approved: {\r\n    label: \"Aprobada\",\r\n    color: \"bg-green-100 text-green-800\",\r\n    icon: <CheckCircle className=\"w-3 h-3 mr-1\" />,\r\n  },\r\n  rejected: {\r\n    label: \"Rechazada\",\r\n    color: \"bg-red-100 text-red-800\",\r\n    icon: <XCircle className=\"w-3 h-3 mr-1\" />,\r\n  },\r\n};\r\n\r\n// Mapeo de tipo de valoración\r\nconst ratingTypeMap: Record<\r\n  string,\r\n  { label: string; color: string; icon: React.ReactNode }\r\n> = {\r\n  product: {\r\n    label: \"Producto\",\r\n    color: \"bg-blue-100 text-blue-800\",\r\n    icon: <Package className=\"w-3 h-3 mr-1\" />,\r\n  },\r\n  seller: {\r\n    label: \"Vendedor\",\r\n    color: \"bg-purple-100 text-purple-800\",\r\n    icon: <Store className=\"w-3 h-3 mr-1\" />,\r\n  },\r\n  user: {\r\n    label: \"Usuario\",\r\n    color: \"bg-orange-100 text-orange-800\",\r\n    icon: <User className=\"w-3 h-3 mr-1\" />,\r\n  },\r\n};\r\n\r\nconst AdminRatingsPage: React.FC = () => {\r\n  const {\r\n    // Estado\r\n    ratings,\r\n    loading,\r\n    error,\r\n    stats,\r\n    statusFilter,\r\n    typeFilter,\r\n    ratingFilter,\r\n    dateRangeFilter,\r\n    pagination,\r\n    selectedRating,\r\n    showRatingModal,\r\n    moderationNote,\r\n    \r\n    // Funciones de acción\r\n    setStatusFilter,\r\n    setTypeFilter,\r\n    setRatingFilter,\r\n    setDateRangeFilter,\r\n    handlePageChange,\r\n    openRatingModal,\r\n    closeRatingModal,\r\n    setModerationNote,\r\n    approveRating,\r\n    rejectRating,\r\n    flagRating,\r\n    refreshData\r\n  } = useAdminRatings();\r\n\r\n  const formatDate = (dateString: string | undefined) => {\r\n    if (!dateString) return \"N/A\";\r\n    const date = new Date(dateString);\r\n    return new Intl.DateTimeFormat(\"es-ES\", {\r\n      day: \"2-digit\",\r\n      month: \"2-digit\",\r\n      year: \"numeric\",\r\n      hour: \"2-digit\",\r\n      minute: \"2-digit\",\r\n    }).format(date);\r\n  };\r\n\r\n  const renderStars = (rating: number) => {\r\n    return (\r\n      <div className=\"flex items-center\">\r\n        {[...Array(5)].map((_, i) => (\r\n          <Star\r\n            key={i}\r\n            className={`w-4 h-4 ${\r\n              i < rating\r\n                ? \"text-yellow-500 fill-current\"\r\n                : \"text-gray-300\"\r\n            }`}\r\n          />\r\n        ))}\r\n        <span className=\"ml-1 text-sm font-medium\">{rating}</span>\r\n      </div>\r\n    );\r\n  };\r\n\r\n  const columns = [\r\n\t\t{\r\n\t\t\tkey: \"user\",\r\n\t\t\theader: \"Usuario\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (rating: Rating) => (\r\n\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t<div className=\"flex-shrink-0 h-8 w-8 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden\">\r\n\t\t\t\t\t\t{rating.user?.avatar ? (\r\n\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\tsrc={`/images/avatars/${rating.user.avatar}`}\r\n\t\t\t\t\t\t\t\talt={rating.user?.name}\r\n\t\t\t\t\t\t\t\tclassName=\"h-8 w-8 object-cover\"\r\n\t\t\t\t\t\t\t\tonError={(e) => {\r\n\t\t\t\t\t\t\t\t\t(e.target as HTMLImageElement).src =\r\n\t\t\t\t\t\t\t\t\t\t\"https://via.placeholder.com/40?text=User\";\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<User className=\"h-4 w-4 text-gray-500\" />\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"ml-3\">\r\n\t\t\t\t\t\t<div className=\"text-sm font-medium text-gray-900\">\r\n\t\t\t\t\t\t\t{rating.user?.name || `Usuario #${rating.userId}`}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"text-xs text-gray-500\">\r\n\t\t\t\t\t\t\tID: {rating.userId}\r\n\t\t\t\t\t\t\t{rating.isVerifiedPurchase && (\r\n\t\t\t\t\t\t\t\t<span className=\"ml-2 text-green-600\">\r\n\t\t\t\t\t\t\t\t\t✓ Compra verificada\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"ratingScore\",\r\n\t\t\theader: \"Valoración\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (rating: Rating) => renderStars(rating.rating),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"item\",\r\n\t\t\theader: \"Elemento\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (rating: Rating) => {\r\n\t\t\t\tif (rating.type === \"product\" && rating.productId) {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\tto={`/admin/products/${rating.productId}`}\r\n\t\t\t\t\t\t\tclassName=\"flex items-center text-primary-600 hover:text-primary-800\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Package className=\"h-4 w-4 mr-1\" />\r\n\t\t\t\t\t\t\tProducto #{rating.productId}\r\n\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t);\r\n\t\t\t\t} else if (rating.type === \"seller\" && rating.sellerId) {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\tto={`/admin/sellers/${rating.sellerId}`}\r\n\t\t\t\t\t\t\tclassName=\"flex items-center text-primary-600 hover:text-primary-800\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Store className=\"h-4 w-4 mr-1\" />\r\n\t\t\t\t\t\t\tVendedor #{rating.sellerId}\r\n\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<span className=\"text-gray-500\">\r\n\t\t\t\t\t\t\tNo especificado\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t);\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"type\",\r\n\t\t\theader: \"Tipo\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (rating: Rating) => {\r\n\t\t\t\tconst type = ratingTypeMap[rating.type] || {\r\n\t\t\t\t\tlabel: rating.type,\r\n\t\t\t\t\tcolor:\r\n\t\t\t\t\t\t\"bg-gray-100 text-gray-800\",\r\n\t\t\t\t\ticon: <AlertTriangle className=\"w-3 h-3 mr-1\" />,\r\n\t\t\t\t};\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<span\r\n\t\t\t\t\t\tclassName={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${type.color}`}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{type.icon}\r\n\t\t\t\t\t\t{type.label}\r\n\t\t\t\t\t</span>\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"title\",\r\n\t\t\theader: \"Título\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (rating: Rating) => (\r\n\t\t\t\t<div className=\"text-sm font-medium text-gray-900 line-clamp-2\">\r\n\t\t\t\t\t{rating.title || \"Sin título\"}\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"date\",\r\n\t\t\theader: \"Fecha\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (rating: Rating) => (\r\n\t\t\t\t<div className=\"text-xs text-gray-500\">\r\n\t\t\t\t\tCreado: {formatDate(rating.createdAt)}\r\n\t\t\t\t\t{rating.updatedAt !== rating.createdAt && (\r\n\t\t\t\t\t\t<div>Actualizado: {formatDate(rating.updatedAt)}</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"status\",\r\n\t\t\theader: \"Estado\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (rating: Rating) => {\r\n\t\t\t\tconst status = ratingStatusMap[rating.status] || {\r\n\t\t\t\t\tlabel: rating.status,\r\n\t\t\t\t\tcolor:\r\n\t\t\t\t\t\t\"bg-gray-100 text-gray-800\",\r\n\t\t\t\t\ticon: <AlertTriangle className=\"w-3 h-3 mr-1\" />,\r\n\t\t\t\t};\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<span\r\n\t\t\t\t\t\tclassName={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${status.color}`}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{status.icon}\r\n\t\t\t\t\t\t{status.label}\r\n\t\t\t\t\t</span>\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"actions\",\r\n\t\t\theader: \"Acciones\",\r\n\t\t\trender: (rating: Rating) => (\r\n\t\t\t\t<div className=\"flex justify-end space-x-2\">\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={() => openRatingModal(rating)}\r\n\t\t\t\t\t\tclassName=\"p-1 text-blue-600 hover:bg-blue-100 rounded-md\"\r\n\t\t\t\t\t\ttitle=\"Ver detalles\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Eye size={18} />\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t{rating.status === \"pending\" && (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tonClick={() => approveRating(rating.id || 0)}\r\n\t\t\t\t\t\t\t\tclassName=\"p-1 text-green-600 hover:bg-green-100 rounded-md\"\r\n\t\t\t\t\t\t\t\ttitle=\"Aprobar valoración\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<CheckCircle size={18} />\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tonClick={() => rejectRating(rating.id || 0)}\r\n\t\t\t\t\t\t\t\tclassName=\"p-1 text-red-600 hover:bg-red-100 rounded-md\"\r\n\t\t\t\t\t\t\t\ttitle=\"Rechazar valoración\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<XCircle size={18} />\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\tflagRating(\r\n\t\t\t\t\t\t\t\trating.id || 0,\r\n\t\t\t\t\t\t\t\trating.status === \"flagged\"\r\n\t\t\t\t\t\t\t\t\t? \"Desmarcada por administrador\"\r\n\t\t\t\t\t\t\t\t\t: \"Marcada para revisión por administrador\"\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tclassName={`p-1 ${\r\n\t\t\t\t\t\t\trating.status === \"flagged\"\r\n\t\t\t\t\t\t\t\t? \"text-green-600 hover:bg-green-100\"\r\n\t\t\t\t\t\t\t\t: \"text-orange-600 hover:bg-orange-100\"\r\n\t\t\t\t\t\t} rounded-md`}\r\n\t\t\t\t\t\ttitle={\r\n\t\t\t\t\t\t\trating.status === \"flagged\"\r\n\t\t\t\t\t\t\t\t? \"Desmarcar valoración\"\r\n\t\t\t\t\t\t\t\t: \"Reportar valoración\"\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{rating.status === \"flagged\" ? (\r\n\t\t\t\t\t\t\t<CheckCircle size={18} /> // Icono para desmarcar\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<Flag size={18} /> // Icono para marcar\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t];\r\n\r\n  const statsItemsRating = [\r\n    {\r\n      title: \"Total\",\r\n      value: stats.total,\r\n      description: \"Valoraciones y reseñas\",\r\n      icon: Star,\r\n      bgColor: \"bg-blue-50/20\",\r\n      textColor: \"text-blue-800\",\r\n      valueColor: \"text-blue-900 \",\r\n      descriptionColor: \"text-blue-700\",\r\n      iconColor: \"text-blue-600\",\r\n    },\r\n    {\r\n      title: \"Pendientes\",\r\n      value: stats.pending,\r\n      description: \"Esperando moderación\",\r\n      icon: Clock,\r\n      bgColor: \"bg-yellow-50/20\",\r\n      textColor: \"text-yellow-800\",\r\n      valueColor: \"text-yellow-900\",\r\n      descriptionColor: \"text-yellow-700\",\r\n      iconColor: \"text-yellow-6000\",\r\n    },\r\n    {\r\n      title: \"Aprobadas\",\r\n      value: stats.approved,\r\n      description: \"Publicadas\",\r\n      icon: CheckCircle,\r\n      bgColor: \"bg-green-50/20\",\r\n      textColor: \"text-green-800\",\r\n      valueColor: \"text-green-900\",\r\n      descriptionColor: \"text-green-700\",\r\n      iconColor: \"text-green-600\",\r\n    },\r\n    {\r\n      title: \"Rechazadas\",\r\n      value: stats.rejected,\r\n      description: \"Ocultadas del público\",\r\n      icon: XCircle,\r\n      bgColor: \"bg-red-50/20\",\r\n      textColor: \"text-red-800\",\r\n      valueColor: \"text-red-900\",\r\n      descriptionColor: \"text-red-700\",\r\n      iconColor: \"text-red-600\",\r\n    },\r\n  ];\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {error && (\r\n        <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative\">\r\n          <span className=\"block sm:inline\">{error}</span>\r\n        </div>\r\n      )}\r\n      \r\n      <div className=\"flex justify-between items-center\">\r\n        <h1 className=\"text-2xl font-bold text-gray-900\">\r\n          Gestión de Valoraciones y Reseñas\r\n        </h1>\r\n        <div className=\"flex space-x-2\">\r\n          <Link\r\n            to=\"/admin/ratings/dashboard\"\r\n            className=\"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors\"\r\n          >\r\n            <BarChart2 size={18} className=\"inline mr-2\" />\r\n            Estadísticas\r\n          </Link>\r\n          <button\r\n            onClick={refreshData}\r\n            className=\"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors\"\r\n          >\r\n            <RefreshCw size={18} className={`inline mr-2 ${loading ? \"animate-spin\" : \"\"}`} />\r\n            Actualizar\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Panel de estadísticas */}\r\n      <StatCardList items={statsItemsRating}/>\r\n      {/* Filtros */}\r\n      <div className=\"bg-white rounded-lg shadow-sm p-4\">\r\n        <div className=\"flex flex-col md:flex-row gap-4\">\r\n          <div className=\"flex items-center space-x-2\">\r\n            <Filter className=\"h-5 w-5 text-gray-500\" />\r\n            <select\r\n              className=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n              value={statusFilter}\r\n              onChange={(e) => setStatusFilter(e.target.value)}\r\n            >\r\n              <option value=\"all\">Todos los Estados</option>\r\n              <option value=\"pending\">Pendientes</option>\r\n              <option value=\"approved\">Aprobados</option>\r\n              <option value=\"rejected\">Rechazados</option>\r\n            </select>\r\n          </div>\r\n\r\n          <div className=\"flex items-center space-x-2\">\r\n            <select\r\n              className=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n              value={typeFilter}\r\n              onChange={(e) => setTypeFilter(e.target.value)}\r\n            >\r\n              <option value=\"all\">Todos los Tipos</option>\r\n              <option value=\"product\">Producto</option>\r\n              <option value=\"seller\">Vendedor</option>\r\n              <option value=\"user\">Usuario</option>\r\n            </select>\r\n          </div>\r\n\r\n          <div className=\"flex items-center space-x-2\">\r\n            <select\r\n              className=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n              value={ratingFilter !== null ? ratingFilter.toString() : \"all\"}\r\n              onChange={(e) =>\r\n                setRatingFilter(e.target.value === \"all\" ? null : parseInt(e.target.value))\r\n              }\r\n            >\r\n              <option value=\"all\">Todas las Puntuaciones</option>\r\n              <option value=\"5\">5 Estrellas</option>\r\n              <option value=\"4\">4 Estrellas</option>\r\n              <option value=\"3\">3 Estrellas</option>\r\n              <option value=\"2\">2 Estrellas</option>\r\n              <option value=\"1\">1 Estrella</option>\r\n            </select>\r\n          </div>\r\n\r\n          <div className=\"flex items-center space-x-2\">\r\n            <Calendar className=\"h-5 w-5 text-gray-500\" />\r\n            <input\r\n              type=\"date\"\r\n              className=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n              value={dateRangeFilter.from}\r\n              onChange={(e) =>\r\n                setDateRangeFilter({ ...dateRangeFilter, from: e.target.value })\r\n              }\r\n              placeholder=\"Desde\"\r\n            />\r\n            <input\r\n              type=\"date\"\r\n              className=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n              value={dateRangeFilter.to}\r\n              onChange={(e) =>\r\n                setDateRangeFilter({ ...dateRangeFilter, to: e.target.value })\r\n              }\r\n              placeholder=\"Hasta\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Tabla de Valoraciones */}\r\n      <Table\r\n        data={ratings}\r\n        columns={columns}\r\n        searchFields={[\"title\", \"comment\"]}\r\n        loading={loading}\r\n        emptyMessage=\"No se encontraron valoraciones\"\r\n        pagination={{\r\n          currentPage: pagination.currentPage,\r\n          totalPages: pagination.totalPages,\r\n          totalItems: pagination.totalItems,\r\n          itemsPerPage: pagination.itemsPerPage,\r\n          onPageChange: handlePageChange,\r\n        }}\r\n      />\r\n\r\n      {/* Modal de Detalle de Valoración */}\r\n      {showRatingModal && selectedRating && (\r\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\r\n          <div className=\"bg-white rounded-lg shadow-xl max-w-3xl w-full max-h-[90vh] overflow-y-auto\">\r\n            <div className=\"px-6 py-4 border-b border-gray-200 flex justify-between items-center\">\r\n              <h3 className=\"text-lg font-medium text-gray-900\">\r\n                Detalles de Valoración\r\n              </h3>\r\n              <button\r\n                onClick={closeRatingModal}\r\n                className=\"text-gray-400 hover:text-gray-500\"\r\n              >\r\n                <XCircle className=\"h-5 w-5\" />\r\n              </button>\r\n            </div>\r\n            <div className=\"p-6\">\r\n              {/* Información de Usuario */}\r\n              <div className=\"mb-6\">\r\n                <h4 className=\"text-sm font-medium text-gray-500 mb-2\">\r\n                  Usuario\r\n                </h4>\r\n                <div className=\"flex items-center\">\r\n                  <div className=\"flex-shrink-0 h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden\">\r\n                    {selectedRating.user?.avatar ? (\r\n                      <img\r\n                        src={`/images/avatars/${selectedRating.user.avatar}`}\r\n                        alt={selectedRating.user?.name}\r\n                        className=\"h-10 w-10 object-cover\"\r\n                        onError={(e) => {\r\n                          (e.target as HTMLImageElement).src =\r\n                            \"https://via.placeholder.com/40?text=User\";\r\n                        }}\r\n                      />\r\n                    ) : (\r\n                      <User className=\"h-6 w-6 text-gray-500\" />\r\n                    )}\r\n                  </div>\r\n                  <div className=\"ml-4\">\r\n                    <div className=\"text-sm font-medium text-gray-900\">\r\n                      {selectedRating.user?.name || `Usuario #${selectedRating.userId}`}\r\n                    </div>\r\n                    <div className=\"text-xs text-gray-500\">\r\n                      ID: {selectedRating.userId}\r\n                      {selectedRating.isVerifiedPurchase && (\r\n                        <span className=\"ml-2 text-green-600\">\r\n                          ✓ Compra verificada\r\n                        </span>\r\n                      )}\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Información de la Valoración */}\r\n              <div className=\"mb-6\">\r\n                <h4 className=\"text-sm font-medium text-gray-500 mb-2\">\r\n                  Valoración\r\n                </h4>\r\n                <div className=\"flex items-center mb-2\">\r\n                  {renderStars(selectedRating.rating)}\r\n                </div>\r\n                <div className=\"text-gray-900 mb-2\">\r\n                  <span className=\"font-medium\">Título:</span> {selectedRating.title}\r\n                </div>\r\n                <div className=\"bg-gray-50 p-3 rounded-lg text-gray-800 mb-2 whitespace-pre-wrap\">\r\n                  {selectedRating.comment}\r\n                </div>\r\n                <div className=\"text-sm text-gray-500\">\r\n                  <div>Creado: {formatDate(selectedRating.createdAt)}</div>\r\n                  {selectedRating.updatedAt !== selectedRating.createdAt && (\r\n                    <div>Actualizado: {formatDate(selectedRating.updatedAt)}</div>\r\n                  )}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Estado Actual */}\r\n              <div className=\"mb-6\">\r\n                <h4 className=\"text-sm font-medium text-gray-500 mb-2\">\r\n                  Estado Actual\r\n                </h4>\r\n                <div className=\"flex items-center\">\r\n                  {(() => {\r\n                    const status = ratingStatusMap[selectedRating.status] || {\r\n                      label: selectedRating.status,\r\n                      color:\r\n                        \"bg-gray-100 text-gray-800\",\r\n                      icon: <AlertTriangle className=\"w-4 h-4 mr-1\" />,\r\n                    };\r\n                    return (\r\n                      <span\r\n                        className={`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${status.color}`}\r\n                      >\r\n                        {status.icon}\r\n                        {status.label}\r\n                      </span>\r\n                    );\r\n                  })()}\r\n                </div>\r\n              </div>\r\n\r\n              {/* Acciones de Moderación */}\r\n              {selectedRating.status === \"pending\" && (\r\n                <div className=\"mb-6\">\r\n                  <h4 className=\"text-sm font-medium text-gray-500 mb-2\">\r\n                    Moderación\r\n                  </h4>\r\n                  <div className=\"mb-4\">\r\n                    <label\r\n                      htmlFor=\"moderationNote\"\r\n                      className=\"block text-sm font-medium text-gray-700 mb-1\"\r\n                    >\r\n                      Nota de Moderación (obligatoria para rechazar)\r\n                    </label>\r\n                    <textarea\r\n                      id=\"moderationNote\"\r\n                      rows={3}\r\n                      className=\"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n                      placeholder=\"Razón del rechazo o notas adicionales...\"\r\n                      value={moderationNote}\r\n                      onChange={(e) => setModerationNote(e.target.value)}\r\n                    ></textarea>\r\n                  </div>\r\n                  <div className=\"flex space-x-2\">\r\n                    <button\r\n                      onClick={() => approveRating(selectedRating.id || 0)}\r\n                      className=\"flex items-center justify-center px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors\"\r\n                    >\r\n                      <CheckCircle size={18} className=\"mr-2\" />\r\n                      Aprobar\r\n                    </button>\r\n                    <button\r\n                      onClick={() => rejectRating(selectedRating.id || 0)}\r\n                      className=\"flex items-center justify-center px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors\"\r\n                    >\r\n                      <XCircle size={18} className=\"mr-2\" />\r\n                      Rechazar\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              )}\r\n\r\n              {/* Enlace al Elemento Valorado */}\r\n              <div>\r\n                <h4 className=\"text-sm font-medium text-gray-500 mb-2\">\r\n                  Enlaces Rápidos\r\n                </h4>\r\n                <div className=\"flex flex-wrap gap-2\">\r\n                  {selectedRating.productId && (\r\n                    <Link\r\n                      to={`/admin/products/${selectedRating.productId}`}\r\n                      className=\"inline-flex items-center px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm\"\r\n                    >\r\n                      <Package className=\"w-4 h-4 mr-1\" />\r\n                      Ver Producto\r\n                    </Link>\r\n                  )}\r\n                  {selectedRating.sellerId && (\r\n                    <Link\r\n                      to={`/admin/sellers/${selectedRating.sellerId}`}\r\n                      className=\"inline-flex items-center px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm\"\r\n                    >\r\n                      <Store className=\"w-4 h-4 mr-1\" />\r\n                      Ver Vendedor\r\n                    </Link>\r\n                  )}\r\n                  {selectedRating.orderId && (\r\n                    <Link\r\n                      to={`/admin/orders/${selectedRating.orderId}`}\r\n                      className=\"inline-flex items-center px-3 py-1 bg-orange-100 text-orange-800 rounded-full text-sm\"\r\n                    >\r\n                      <Package className=\"w-4 h-4 mr-1\" />\r\n                      Ver Orden\r\n                    </Link>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminRatingsPage;"],"names":["AdminRatingService","filters","ApiClient","API_ENDPOINTS","error","ratingId","note","reason","useAdminRatings","ratings","setRatings","useState","loading","setLoading","setError","statsLoading","setStatsLoading","statusFilter","setStatusFilter","typeFilter","setTypeFilter","ratingFilter","setRatingFilter","dateRangeFilter","setDateRangeFilter","pagination","setPagination","stats","setStats","selectedRating","setSelectedRating","showRatingModal","setShowRatingModal","moderationNote","setModerationNote","isInitialized","setIsInitialized","adminRatingService","fetchRatings","useCallback","response","err","errorMessage","extractErrorMessage","fetchStats","useEffect","resolve","handleStatusFilterChange","status","handleTypeFilterChange","type","handleRatingFilterChange","rating","handleDateRangeFilterChange","dateRange","handlePageChange","page","prev","openRatingModal","closeRatingModal","prevRatings","ratingStatusMap","jsx","Clock","CheckCircle","XCircle","ratingTypeMap","Package","Store","User","AdminRatingsPage","approveRating","rejectRating","flagRating","refreshData","formatDate","dateString","date","renderStars","jsxs","_","i","Star","columns","e","Link","AlertTriangle","Eye","Fragment","Flag","statsItemsRating","BarChart2","RefreshCw","StatCardList","Filter","Calendar","Table"],"mappings":"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"}