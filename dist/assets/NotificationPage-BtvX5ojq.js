import{c as P,r as x,d as F,u as B,a as L,j as e,B as w,G as U}from"./index-DmNDOrWy.js";import{C as I,f as v,E as D}from"./dateUtils-CfeftkgG.js";import{C as k}from"./check-CHNPnXXq.js";import{B as G}from"./ban-DWyykPX6.js";import{S as V}from"./shield-C7SSAF2o.js";import{F as q}from"./file-text-DT6_O-Nw.js";import{T as O}from"./triangle-alert-B75WTV0P.js";import{S as Z}from"./shopping-cart-Ck1So-LU.js";import{S as H}from"./star-DFFyFcok.js";import{T as J}from"./trending-up-B_I49aLX.js";import{T as K}from"./truck-DP84WB3Y.js";import{P as Q}from"./package-CIRlwNqy.js";import{T as W}from"./trash-2-DifnXJFx.js";/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]],Y=P("message-circle",X),ee=a=>{switch(a){case"new_message":return e.jsx(Y,{className:"text-blue-500",size:20});case"order_status":return e.jsx(Q,{className:"text-green-500",size:20});case"shipping_update":return e.jsx(K,{className:"text-purple-500",size:20});case"product_update":return e.jsx(J,{className:"text-orange-500",size:20});case"rating_received":case"seller_rated":return e.jsx(H,{className:"text-yellow-500",size:20});case"new_order":return e.jsx(Z,{className:"text-green-600",size:20});case"low_stock":return e.jsx(O,{className:"text-red-500",size:20});case"feedback_response":return e.jsx(q,{className:"text-indigo-500",size:20});case"promotion":case"discount":return e.jsx(U,{className:"text-pink-500",size:20});case"seller_strike":return e.jsx(V,{className:"text-orange-500",size:20});case"account_blocked":return e.jsx(G,{className:"text-red-500",size:20});default:return e.jsx(w,{className:"text-gray-500",size:20})}},re=a=>{switch(a){case"new_message":return"bg-blue-50 border-blue-200";case"order_status":return"bg-green-50 border-green-200";case"shipping_update":return"bg-purple-50 border-purple-200";case"product_update":return"bg-orange-50 border-orange-200";case"rating_received":case"seller_rated":return"bg-yellow-50 border-yellow-200";case"new_order":return"bg-emerald-50 border-emerald-200";case"low_stock":return"bg-red-50 border-red-200";case"feedback_response":return"bg-indigo-50 border-indigo-200";case"promotion":case"discount":return"bg-pink-50 border-pink-200";case"seller_strike":return"bg-orange-50 border-orange-200";case"account_blocked":return"bg-red-50 border-red-200";default:return"bg-gray-50 border-gray-200"}},se=({notification:a,onMarkAsRead:g,onDelete:m,isOpen:d,onToggle:n})=>e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:l=>{l.stopPropagation(),n()},className:"p-1 rounded-full hover:bg-gray-200 transition-colors",children:e.jsx(D,{size:16,className:"text-gray-500"})}),d&&e.jsxs("div",{className:"absolute right-0 top-8 bg-white rounded-lg shadow-lg border z-10 min-w-[150px]",children:[!a.read&&e.jsxs("button",{onClick:l=>{l.stopPropagation(),g(a.id),n()},className:"w-full px-4 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center",children:[e.jsx(k,{size:14,className:"mr-2"}),"Marcar como le√≠da"]}),e.jsxs("button",{onClick:l=>{l.stopPropagation(),m(a.id),n()},className:"w-full px-4 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center",children:[e.jsx(W,{size:14,className:"mr-2"}),"Eliminar"]})]})]}),he=()=>{const[a,g]=x.useState("all"),[m,d]=x.useState(null),n=F(),{isAuthenticated:l,roleInfo:f}=B(),{notifications:o,loading:u,error:N,unreadCount:c,hasMore:y,currentPage:$,totalNotifications:p,fetchNotifications:h,markAsRead:j,markAllAsRead:C,deleteNotification:z}=L();x.useEffect(()=>{l||n("/login",{state:{from:"/notifications"}})},[l,n]),x.useEffect(()=>{l&&h(1,a==="unread")},[l,a]),x.useEffect(()=>{o.length>0&&console.log("üìä Notificaciones recibidas:",o.slice(0,2))},[o]);const A=r=>{const{type:i,data:s}=r,t=f.isSeller;switch(console.log(`üîÄ Procesando notificaci√≥n tipo: ${i}, isSeller: ${t}`,s),i){case"new_message":if(s.chat_id){const _=t?`/seller/messages/${s.chat_id}`:`/chats/${s.chat_id}`;return console.log(`üìß Redirigiendo a chat: ${_}`),_}return t?"/seller/messages":"/chats";case"feedback_response":return s.feedback_id?`/feedback/${s.feedback_id}`:"/feedback";case"order_status":return s.order_id?t?`/seller/orders/${s.order_id}`:`/orders/${s.order_id}`:t?"/seller/orders":"/orders";case"product_update":return s.product_id?t?`/seller/products/edit/${s.product_id}`:`/products/${s.product_id}`:t?"/seller/products":null;case"shipping_update":return s.tracking_number?`/tracking/${s.tracking_number}`:s.order_id?t?`/seller/orders/${s.order_id}`:`/orders/${s.order_id}`:null;case"rating_received":case"seller_rated":return s.rating_id?`/ratings/${s.rating_id}`:t?"/seller/ratings":"/profile";case"new_order":return s.order_id?t?`/seller/orders/${s.order_id}`:null:t?"/seller/orders":null;case"low_stock":return s.product_id?t?`/seller/products/edit/${s.product_id}`:null:t?"/seller/products":null;case"seller_strike":case"account_blocked":return t?"/seller/profile":"/profile";default:return console.log(`‚ùì Tipo de notificaci√≥n no reconocido: ${i}`),null}},T=async r=>{console.log(`üñ±Ô∏è Click en notificaci√≥n ${r.id} (tipo: ${r.type})`),d(null),r.read||await j(r.id);const i=A(r);i?(console.log(`üîÄ Navegando a: ${i} (usuario ${f.isSeller?"seller":"normal"})`),n(i)):console.log("‚ö†Ô∏è No hay URL de destino para esta notificaci√≥n")},S=async r=>{await z(r)},M=async r=>{await j(r)},R=async()=>{await C()},E=()=>{y&&!u&&h($+1,a==="unread")},b=r=>{g(r),d(null)};return l?e.jsxs("div",{className:"container mx-auto px-4 lg:px-8 py-10 max-w-4xl",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 space-y-4 sm:space-y-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Notificaciones"}),e.jsx("p",{className:"text-gray-600 mt-1",children:p>0&&e.jsxs(e.Fragment,{children:[p," ",p===1?"notificaci√≥n":"notificaciones",c>0&&e.jsxs("span",{className:"text-primary-600 font-medium",children:[", ",c," sin leer"]})]})})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 bg-gray-100 rounded-lg p-1",children:[e.jsx("button",{onClick:()=>b("all"),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors ${a==="all"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:"Todas"}),e.jsxs("button",{onClick:()=>b("unread"),className:`px-3 py-1.5 text-sm font-medium rounded-md transition-colors relative ${a==="unread"?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:["No le√≠das",c>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:c>99?"99":c})]})]}),c>0&&e.jsxs("button",{onClick:R,disabled:u,className:"px-4 py-2 bg-primary-600 text-white text-sm font-medium rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50 flex items-center",children:[e.jsx(I,{size:16,className:"mr-2"}),"Marcar todas"]})]})]}),N&&e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:[N,e.jsx("button",{className:"ml-2 underline",onClick:()=>h(1,a==="unread"),children:"Reintentar"})]}),u&&o.length===0?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})}):o.length===0?e.jsxs("div",{className:"text-center py-20 bg-gradient-to-b from-gray-50 to-white rounded-xl shadow-md",children:[e.jsx(w,{className:"mx-auto h-16 w-16 text-gray-300 mb-6"}),e.jsx("h2",{className:"text-2xl font-semibold text-gray-700 mb-3",children:a==="unread"?"No tienes notificaciones sin leer":"No tienes notificaciones"}),e.jsx("p",{className:"text-gray-500 mb-8 max-w-md mx-auto",children:a==="unread"?"Todas tus notificaciones est√°n al d√≠a. Te avisaremos cuando tengas algo nuevo.":"Cuando tengas actualizaciones importantes, aparecer√°n aqu√≠."}),a==="unread"&&e.jsx("button",{onClick:()=>b("all"),className:"inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-lg text-white bg-primary-600 hover:bg-primary-700 shadow-sm hover:shadow transition-all",children:"Ver todas las notificaciones"})]}):e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[o.map((r,i)=>e.jsx("div",{onClick:()=>T(r),className:`
                relative border-l-4 cursor-pointer transition-all duration-200 hover:shadow-sm
                ${r.read?"bg-white border-l-gray-200 hover:bg-gray-50":"bg-blue-50 border-l-primary-500 hover:bg-blue-100"}
                ${i!==o.length-1?"border-b border-gray-100":""}
              `,children:e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-4 flex-1",children:[e.jsx("div",{className:`
                      flex-shrink-0 w-10 h-10 rounded-full flex items-center justify-center
                      ${re(r.type)}
                    `,children:ee(r.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[e.jsx("h3",{className:`text-base font-medium ${r.read?"text-gray-700":"text-gray-900"}`,children:r.title}),!r.read&&e.jsx("div",{className:"w-2 h-2 bg-primary-500 rounded-full"})]}),e.jsx("p",{className:`text-sm ${r.read?"text-gray-600":"text-gray-700"} mb-2`,children:r.message}),e.jsxs("div",{className:"flex items-center text-xs text-gray-500",children:[e.jsx("span",{children:v(r.createdAt)}),r.readAt&&e.jsxs("span",{className:"ml-2 flex items-center",children:[e.jsx(k,{size:12,className:"mr-1"}),"Le√≠da el ",v(r.readAt)]})]})]})]}),e.jsx(se,{notification:r,onMarkAsRead:M,onDelete:S,isOpen:m===r.id,onToggle:()=>d(m===r.id?null:r.id)})]})})},r.id)),y&&e.jsx("div",{className:"p-6 bg-gray-50 border-t",children:e.jsx("button",{onClick:E,disabled:u,className:"w-full px-4 py-3 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 font-medium",children:u?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-gray-400 mr-2"}),"Cargando..."]}):"Cargar m√°s notificaciones"})})]}),m!==null&&e.jsx("div",{className:"fixed inset-0 z-0",onClick:()=>d(null)})]}):null};export{he as default};
//# sourceMappingURL=NotificationPage-BtvX5ojq.js.map
