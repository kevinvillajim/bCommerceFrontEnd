import{j as e,a6 as D,w as I,s as P,b4 as z,b5 as A,N as O,E as T,f as V,X as q,Q as G}from"./ui-vendor-DEBjJ4HS.js";import{u as U,j as B,r as i,L as y}from"./react-vendor-Cy458wKG.js";import{n as H}from"./admin-chunk-bhOJ3jtA.js";const X=()=>{const j=U(),[N]=B(),m=N.get("parent"),{loading:v,error:x,mainCategories:g,fetchMainCategories:u,createCategory:w,setError:d}=H(),[r,p]=i.useState({name:"",slug:"",description:"",parent_id:m?Number(m):void 0,icon:"",order:0,is_active:!0,featured:!1}),[t,h]=i.useState({}),[b,f]=i.useState(!1),[C,E]=i.useState(!1);i.useEffect(()=>{u(!0)},[u]);const S=a=>a.toLowerCase().trim().replace(/[√°√†√§√¢]/g,"a").replace(/[√©√®√´√™]/g,"e").replace(/[√≠√¨√Ø√Æ]/g,"i").replace(/[√≥√≤√∂√¥]/g,"o").replace(/[√∫√π√º√ª]/g,"u").replace(/[√±]/g,"n").replace(/[√ß]/g,"c").replace(/[^a-z0-9\s-]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-").replace(/^-|-$/g,""),n=a=>{const{name:s,value:o,type:L}=a.target;let c=o;if(L==="checkbox"&&(c=a.target.checked),(s==="order"||s==="parent_id")&&(c=o===""?void 0:Number(o)),p(l=>({...l,[s]:c})),s==="name"&&o&&!C){const l=S(o);p($=>({...$,slug:l}))}s==="slug"&&E(!0),t[s]&&h(l=>({...l,[s]:""}))},k=()=>{const a={};return r.name.trim()?r.name.length<2?a.name="El nombre debe tener al menos 2 caracteres":r.name.length>100&&(a.name="El nombre no puede tener m√°s de 100 caracteres"):a.name="El nombre es obligatorio",r.slug.trim()?/^[a-z0-9-]+$/.test(r.slug)?r.slug.length>150&&(a.slug="El slug no puede tener m√°s de 150 caracteres"):a.slug="El slug solo puede contener letras min√∫sculas, n√∫meros y guiones":a.slug="El slug es obligatorio",r.description&&r.description.length>500&&(a.description="La descripci√≥n no puede tener m√°s de 500 caracteres"),r.order!==void 0&&(r.order<0||r.order>999)&&(a.order="El orden debe estar entre 0 y 999"),h(a),Object.keys(a).length===0},_=async a=>{if(a.preventDefault(),!!k()){f(!0),d(null);try{const s={...r,description:r.description?.trim()||void 0,icon:r.icon?.trim()||void 0,parent_id:r.parent_id===0||r.parent_id===void 0?void 0:r.parent_id};console.log("üì§ Enviando datos de nueva categor√≠a:",s);const o=await w(s);o?(console.log("‚úÖ Categor√≠a creada exitosamente:",o),j("/admin/categories",{state:{message:`Categor√≠a "${o.name}" creada exitosamente`}})):d("Error al crear la categor√≠a. Int√©ntalo de nuevo.")}catch(s){console.error("‚ùå Error al crear categor√≠a:",s),d(s instanceof Error?s.message:"Error inesperado al crear la categor√≠a")}finally{f(!1)}}},F=a=>{if(!a)return"Sin categor√≠a padre";const s=g.find(o=>o.id===a);return s?s.name:"Categor√≠a padre desconocida"};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(y,{to:"/admin/categories",className:"p-2 text-gray-600 hover:bg-gray-100 rounded-md",title:"Volver a categor√≠as",children:e.jsx(D,{size:20})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Nueva Categor√≠a"}),r.parent_id&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Creando subcategor√≠a de:"," ",F(r.parent_id)]})]})]})}),x&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:x}),e.jsxs("form",{onSubmit:_,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsxs("h2",{className:"text-lg font-medium text-gray-900 mb-6 flex items-center",children:[e.jsx(I,{className:"h-5 w-5 mr-2"}),"Informaci√≥n B√°sica"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre *"}),e.jsxs("div",{className:"relative",children:[e.jsx(P,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",id:"name",name:"name",value:r.name,onChange:n,className:`block w-full pl-10 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${t.name?"border-red-300":"border-gray-300"}`,placeholder:"Nombre de la categor√≠a",maxLength:100,required:!0})]}),t.name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.name})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"slug",className:"block text-sm font-medium text-gray-700 mb-2",children:"Slug *"}),e.jsxs("div",{className:"relative",children:[e.jsx(z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",id:"slug",name:"slug",value:r.slug,onChange:n,className:`block w-full pl-10 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${t.slug?"border-red-300":"border-gray-300"}`,placeholder:"slug-de-la-categoria",maxLength:150,pattern:"[a-z0-9-]+",required:!0})]}),t.slug&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.slug}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Solo letras min√∫sculas, n√∫meros y guiones. Se genera autom√°ticamente del nombre."})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"parent_id",className:"block text-sm font-medium text-gray-700 mb-2",children:"Categor√≠a Padre"}),e.jsxs("select",{id:"parent_id",name:"parent_id",value:r.parent_id||"",onChange:n,className:`block w-full px-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${t.parent_id?"border-red-300":"border-gray-300"}`,children:[e.jsx("option",{value:"",children:"Sin categor√≠a padre (principal)"}),g.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),t.parent_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.parent_id})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"order",className:"block text-sm font-medium text-gray-700 mb-2",children:"Orden"}),e.jsxs("div",{className:"relative",children:[e.jsx(A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"number",id:"order",name:"order",value:r.order||"",onChange:n,className:`block w-full pl-10 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${t.order?"border-red-300":"border-gray-300"}`,placeholder:"0",min:"0",max:"999"})]}),t.order&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.order}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Orden de aparici√≥n (0 = primero)"})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Descripci√≥n"}),e.jsxs("div",{className:"relative",children:[e.jsx(O,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx("textarea",{id:"description",name:"description",value:r.description||"",onChange:n,rows:4,className:`block w-full pl-10 pr-3 py-2 border rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 ${t.description?"border-red-300":"border-gray-300"}`,placeholder:"Descripci√≥n de la categor√≠a (opcional)",maxLength:500})]}),t.description&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.description}),e.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:[(r.description||"").length,"/500 caracteres"]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{htmlFor:"icon",className:"block text-sm font-medium text-gray-700 mb-2",children:"Icono (opcional)"}),e.jsx("input",{type:"text",id:"icon",name:"icon",value:r.icon||"",onChange:n,className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",placeholder:"Ej: fas fa-laptop, lucide:computer, etc."}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Clase CSS del icono o nombre del icono a mostrar"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-6",children:"Estados"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"is_active",name:"is_active",checked:r.is_active,onChange:n,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsxs("label",{htmlFor:"is_active",className:"ml-2 text-sm text-gray-900 flex items-center",children:[e.jsx(T,{className:"h-4 w-4 mr-1"}),"Categor√≠a activa"]})]}),e.jsx("p",{className:"text-xs text-gray-500 ml-6",children:"Las categor√≠as inactivas no aparecen en la tienda"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"featured",name:"featured",checked:r.featured,onChange:n,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsxs("label",{htmlFor:"featured",className:"ml-2 text-sm text-gray-900 flex items-center",children:[e.jsx(V,{className:"h-4 w-4 mr-1"}),"Categor√≠a destacada"]})]}),e.jsx("p",{className:"text-xs text-gray-500 ml-6",children:"Las categor√≠as destacadas aparecen en secciones especiales"})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-6",children:e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsxs(y,{to:"/admin/categories",className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors flex items-center",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Cancelar"]}),e.jsxs("button",{type:"submit",disabled:b||v,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors flex items-center disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),b?"Creando...":"Crear Categor√≠a"]})]})})]})]})};export{X as default};
//# sourceMappingURL=AdminCreateCategoryPage-CA7nC7gs.js.map
