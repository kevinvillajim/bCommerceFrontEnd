import{j as e,R as L,N as V,e as E,a as _,H as p,K as k,F as G,h as H,i as K,E as X,C as J}from"./ui-vendor-DEBjJ4HS.js";import{r}from"./react-vendor-Cy458wKG.js";import{c as g,T as O}from"./admin-chunk-bhOJ3jtA.js";const Z=()=>{const[A,R]=r.useState([]),[z,b]=r.useState(!0),[d,D]=r.useState("all"),[n,T]=r.useState({total:0,pending:0,approved:0,rejected:0,recent:0}),[a,I]=r.useState(null),[M,o]=r.useState(!1),[F,m]=r.useState(!1),[x,v]=r.useState(""),[j,N]=r.useState(""),[l,y]=r.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:10}),[w,i]=r.useState(null),[S,h]=r.useState(null);r.useEffect(()=>{u(),f()},[d,l.currentPage]);const u=async()=>{b(!0),i(null);try{const s={page:l.currentPage,per_page:l.itemsPerPage};d!=="all"&&(s.status=d);const t=await g.get("/admin/seller-applications",s);if(t&&typeof t=="object"&&"status"in t&&t.status==="success"&&"data"in t&&t.data){const c=t.data;R(c.data||[]),y({currentPage:c.current_page||1,totalPages:c.last_page||1,totalItems:c.total||0,itemsPerPage:c.per_page||10})}}catch(s){console.error("Error fetching applications:",s),i("Error al cargar las solicitudes. Por favor, inténtalo de nuevo.")}finally{b(!1)}},f=async()=>{try{const s=await g.get("/admin/seller-applications/stats");s&&typeof s=="object"&&"status"in s&&s.status==="success"&&"data"in s&&T(s.data)}catch(s){console.error("Error fetching stats:",s)}},U=async s=>{i(null),h(null);try{const t=await g.post(`/admin/seller-applications/${s.id}/approve`,{admin_notes:j});t&&typeof t=="object"&&"status"in t&&t.status==="success"&&(h("Solicitud aprobada exitosamente. Se ha creado la cuenta de vendedor y el usuario ha sido notificado."),await u(),await f(),o(!1),N(""))}catch(t){i(t.response?.data?.message||"Error al aprobar la solicitud")}},$=async()=>{if(!a||!x.trim()){i("El motivo del rechazo es obligatorio");return}i(null),h(null);try{const s=await g.post(`/admin/seller-applications/${a.id}/reject`,{rejection_reason:x,admin_notes:j});s&&typeof s=="object"&&"status"in s&&s.status==="success"&&(h("Solicitud rechazada exitosamente. El usuario ha sido notificado con el motivo del rechazo."),await u(),await f(),m(!1),o(!1),v(""),N(""))}catch(s){i(s.response?.data?.message||"Error al rechazar la solicitud")}},q=s=>{switch(s){case"pending":return e.jsx(E,{className:"h-4 w-4 text-yellow-500"});case"approved":return e.jsx(_,{className:"h-4 w-4 text-green-500"});case"rejected":return e.jsx(p,{className:"h-4 w-4 text-red-500"});default:return e.jsx(J,{className:"h-4 w-4 text-gray-500"})}},P=s=>{switch(s){case"pending":return"Pendiente";case"approved":return"Aprobada";case"rejected":return"Rechazada";default:return"Desconocido"}},C=s=>{switch(s){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},B=[{key:"user",header:"Usuario",render:s=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-sm",children:s.user?.name||"N/A"}),e.jsx("div",{className:"text-xs text-gray-500",children:s.user?.email||"N/A"})]})]})},{key:"store_name",header:"Tienda",render:s=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(K,{className:"h-4 w-4 mr-2 text-gray-400"}),e.jsx("span",{className:"font-medium",children:s.store_name})]})},{key:"ruc",header:"RUC",render:s=>e.jsx("span",{className:"text-sm font-mono",children:s.ruc})},{key:"status",header:"Estado",render:s=>e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${C(s.status)}`,children:[q(s.status),e.jsx("span",{className:"ml-1",children:P(s.status)})]})},{key:"created_at",header:"Solicitud",render:s=>e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(k,{className:"h-4 w-4 mr-1"}),new Date(s.created_at).toLocaleDateString("es-ES")]})},{key:"actions",header:"Acciones",render:s=>e.jsx("div",{className:"flex space-x-2",children:e.jsx("button",{onClick:()=>{I(s),o(!0)},className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"Ver detalles",children:e.jsx(X,{className:"h-4 w-4"})})})}];return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Solicitudes de Vendedor"}),e.jsx("p",{className:"text-gray-600",children:"Gestiona las solicitudes para convertirse en vendedor"})]}),e.jsxs("button",{onClick:u,className:"flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),"Actualizar"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mt-6",children:[e.jsx("div",{className:"bg-white p-4 rounded-lg border",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(V,{className:"h-8 w-8 text-blue-500"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total"}),e.jsx("p",{className:"text-xl font-semibold text-gray-900",children:n.total})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg border",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{className:"h-8 w-8 text-yellow-500"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pendientes"}),e.jsx("p",{className:"text-xl font-semibold text-gray-900",children:n.pending})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg border",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(_,{className:"h-8 w-8 text-green-500"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Aprobadas"}),e.jsx("p",{className:"text-xl font-semibold text-gray-900",children:n.approved})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg border",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(p,{className:"h-8 w-8 text-red-500"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Rechazadas"}),e.jsx("p",{className:"text-xl font-semibold text-gray-900",children:n.rejected})]})]})}),e.jsx("div",{className:"bg-white p-4 rounded-lg border",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(k,{className:"h-8 w-8 text-purple-500"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Esta semana"}),e.jsx("p",{className:"text-xl font-semibold text-gray-900",children:n.recent})]})]})})]})]}),e.jsx("div",{className:"mb-6 flex flex-wrap gap-4 items-center",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(G,{className:"h-4 w-4 mr-2 text-gray-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700 mr-2",children:"Estado:"}),e.jsxs("select",{value:d,onChange:s=>D(s.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"all",children:"Todos"}),e.jsx("option",{value:"pending",children:"Pendientes"}),e.jsx("option",{value:"approved",children:"Aprobadas"}),e.jsx("option",{value:"rejected",children:"Rechazadas"})]})]})}),w&&e.jsx("div",{className:"mb-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:w}),S&&e.jsx("div",{className:"mb-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded",children:S}),e.jsx("div",{className:"bg-white rounded-lg shadow",children:e.jsx(O,{data:A,columns:B,loading:z,pagination:{currentPage:l.currentPage,totalPages:l.totalPages,totalItems:l.totalItems,itemsPerPage:l.itemsPerPage,onPageChange:s=>y(t=>({...t,currentPage:s}))},emptyMessage:"No se encontraron solicitudes"})}),M&&a&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[90vh] overflow-y-auto m-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Detalles de Solicitud"}),e.jsx("button",{onClick:()=>o(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(p,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Información del Usuario"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Nombre:"})," ",a.user?.name]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Email:"})," ",a.user?.email]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Estado:"}),e.jsx("span",{className:`ml-2 px-2 py-1 rounded text-xs ${C(a.status)}`,children:P(a.status)})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Información Comercial"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Tienda:"})," ",a.store_name]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"RUC:"})," ",a.ruc]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Email contacto:"})," ",a.contact_email]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Teléfono:"})," ",a.phone]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Detalles del Negocio"}),e.jsxs("div",{className:"space-y-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Actividad comercial:"}),e.jsx("p",{className:"mt-1 text-gray-700",children:a.business_activity})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Productos a vender:"}),e.jsx("p",{className:"mt-1 text-gray-700",children:a.products_to_sell})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Dirección física:"}),e.jsx("p",{className:"mt-1 text-gray-700",children:a.physical_address})]}),a.business_description&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Descripción del negocio:"}),e.jsx("p",{className:"mt-1 text-gray-700",children:a.business_description})]}),a.experience&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Experiencia:"}),e.jsx("p",{className:"mt-1 text-gray-700",children:a.experience})]}),a.additional_info&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Información adicional:"}),e.jsx("p",{className:"mt-1 text-gray-700",children:a.additional_info})]})]})]}),a.status==="rejected"&&a.rejection_reason&&e.jsxs("div",{className:"mb-6 p-4 bg-red-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-red-800 mb-2",children:"Motivo del rechazo:"}),e.jsx("p",{className:"text-red-700 text-sm",children:a.rejection_reason})]}),a.status==="pending"&&e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notas del administrador (opcional)"}),e.jsx("textarea",{value:j,onChange:s=>N(s.target.value),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Notas internas sobre la solicitud..."})]}),a.status==="pending"&&e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Rechazar"}),e.jsx("button",{onClick:()=>U(a),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Aprobar"})]}),a.status!=="pending"&&e.jsx("div",{className:"text-center text-gray-500 text-sm",children:"Esta solicitud ya ha sido procesada"})]})}),F&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md m-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-red-600",children:"Rechazar Solicitud"}),e.jsx("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(p,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Motivo del rechazo *"}),e.jsx("textarea",{value:x,onChange:s=>v(s.target.value),required:!0,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500",placeholder:"Explica por qué se rechaza la solicitud..."})]}),e.jsxs("div",{className:"flex justify-end space-x-3",children:[e.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:$,disabled:!x.trim(),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Rechazar Solicitud"})]})]})})]})};export{Z as default};
//# sourceMappingURL=AdminSolicitudesPage-CNE2iYhw.js.map
