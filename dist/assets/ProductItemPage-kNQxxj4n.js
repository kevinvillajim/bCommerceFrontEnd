import{j as e,f as be,h as Ne,d as se,aI as je,T as ae,am as ve,Z as we,aJ as _e,p as $e,au as ke,at as Ie,M as Ee,H as Ce,o as Ae,z as Pe,aK as Se}from"./ui-vendor-BUNMIuFe.js";import{r as d,d as Fe,u as Re,L as A}from"./react-vendor-Cy458wKG.js";import{i as J,c as De,C as z}from"./admin-chunk-BNcFjXlJ.js";import{u as Te,a as ze,N as K}from"./checkout-chunk-DAros4Zm.js";import{u as Ve}from"./useFavorites-DGuT7F7n.js";import{u as qe}from"./useChat-CLovqvUZ.js";import{u as Le}from"./useProducts-BIQiyVMQ.js";import{b as Ue}from"./index-C7ooKqFU.js";import{a as Me}from"./useUnifiedConfig-D-Jk3zpf.js";import{u as Oe}from"./useRatings-o8Hf9De0.js";import{R as re}from"./seller-chunk-6swISJwY.js";import"./chat-chunk-BRsdDZXf.js";import"./utils-vendor-DeGC_a19.js";import"./useImageCache-BZuULX8l.js";import"./RatingService-Cw2gm_Wj.js";const Ge=({productId:i,rating:h,ratingCount:a})=>{const[j,l]=d.useState([]),[m,_]=d.useState(1),[v,$]=d.useState(1),[P,f]=d.useState(!1),[k,u]=d.useState(null),[w,x]=d.useState(!1),y=d.useRef(!1),b=d.useRef(null),{getProductRatings:V}=Oe(),S=async(o=m)=>{if(y.current||!i){console.log("ðŸš« Evitando llamada mÃºltiple o productId invÃ¡lido");return}b.current&&b.current.abort(),b.current=new AbortController,console.log(`ðŸ”„ Cargando reseÃ±as del producto ${i}, pÃ¡gina ${o}`);try{f(!0),u(null),y.current=!0;const t=await V(i,o,5);if(console.log("ðŸ“Š Respuesta completa de la API:",t),t&&t.data){console.log("ðŸ“„ Contenido de response.data:",t.data),console.log("ðŸ§© Tipo de response.data:",typeof t.data,Array.isArray(t.data)),Array.isArray(t.data)?(console.log(`âœ… response.data es un array con ${t.data.length} elementos`),t.data.length===0?(x(!0),l([])):(l(t.data),x(!1))):typeof t.data=="object"&&t.data!==null?(console.log("ðŸ“ response.data es un objeto, propiedades:",Object.keys(t.data)),t.data.ratings&&Array.isArray(t.data.ratings)?(console.log(`âœ… Encontrado response.data.ratings con ${t.data.ratings.length} elementos`),t.data.ratings.length===0?(x(!0),l([])):(l(t.data.ratings),x(!1))):t.data.data&&Array.isArray(t.data.data)?(console.log(`âœ… Encontrado response.data.data con ${t.data.data.length} elementos`),t.data.data.length===0?(x(!0),l([])):(l(t.data.data),x(!1))):(console.warn("âš ï¸ Estructura de objeto no reconocida en response.data"),l([]),x(!0))):(console.warn("âš ï¸ response.data no es ni array ni objeto:",t.data),l([]),x(!0));const F=t.meta?.total||t.data?.total||0;$(Math.ceil(F/5)),console.log(`ðŸ“ˆ Total items: ${F}, Total pages: ${Math.ceil(F/5)}`)}else console.log("âŒ No hay response o response.data"),l([]),x(!0),$(1)}catch(t){console.error("âŒ Error cargando reseÃ±as:",t),t?.code==="ECONNABORTED"||t?.message?.includes("timeout")?u("La carga de reseÃ±as estÃ¡ tardando mÃ¡s de lo esperado. IntÃ©ntalo mÃ¡s tarde."):t?.response?.status===404?(x(!0),l([]),u(null)):t?.response?.status>=500?u("Error del servidor. IntÃ©ntalo mÃ¡s tarde."):u("No se pudieron cargar las reseÃ±as."),l([]),$(1)}finally{f(!1),y.current=!1,b.current=null}};d.useEffect(()=>(i&&(console.log(`ðŸŽ† Producto cambiado a ${i}, reseteando pÃ¡gina a 1`),_(1),u(null),x(!1),S(1)),()=>{b.current&&b.current.abort(),y.current=!1}),[i]),d.useEffect(()=>{m>1&&i&&(console.log(`ðŸ“Ž Cambiando a pÃ¡gina ${m}`),S(m))},[m]);const g=o=>e.jsx("div",{className:"flex",children:[1,2,3,4,5].map(t=>e.jsx(se,{size:16,className:`${t<=o?"text-yellow-400 fill-current":"text-gray-300"}`},t))}),I=o=>{try{return new Date(o).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"})}catch{return"Fecha no disponible"}};return P?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-gray-300 border-t-primary-600 mx-auto"}),e.jsx("p",{className:"text-gray-500 mt-2",children:"Cargando reseÃ±as..."})]}):k?e.jsxs("div",{className:"max-w-3xl",children:[h>0&&e.jsxs("div",{className:"flex items-center mb-6 p-6 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"mr-6",children:[e.jsx("div",{className:"text-4xl font-bold text-gray-900",children:h.toFixed(1)}),e.jsx("div",{className:"flex mt-2",children:g(h)}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:a>0?`${a} valoraciÃ³n${a>1?"es":""}`:"Sin valoraciones"})]}),e.jsxs("div",{className:"flex-grow text-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"ValoraciÃ³n promedio"}),e.jsxs("p",{className:"text-gray-600",children:["Basado en ",a," valoraciÃ³n",a!==1?"es":""," de clientes"]})]})]}),e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-red-400 mb-4",children:e.jsx(be,{size:48,className:"mx-auto"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Error al cargar reseÃ±as"}),e.jsx("p",{className:"text-gray-500 mb-4",children:k}),e.jsx("button",{onClick:()=>S(m),className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"Intentar nuevamente"})]})]}):e.jsxs("div",{className:"max-w-3xl",children:[h>0&&e.jsxs("div",{className:"flex items-center mb-6 p-6 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"mr-6",children:[e.jsx("div",{className:"text-4xl font-bold text-gray-900",children:h.toFixed(1)}),e.jsx("div",{className:"flex mt-2",children:g(h)}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:a>0?`${a} valoraciÃ³n${a>1?"es":""}`:"Sin valoraciones"})]}),e.jsxs("div",{className:"flex-grow text-center",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"ValoraciÃ³n promedio"}),e.jsxs("p",{className:"text-gray-600",children:["Basado en ",a," valoraciÃ³n",a!==1?"es":""," de clientes"]})]})]}),j.length>0?e.jsx("div",{className:"space-y-6",children:j.map((o,t)=>e.jsx("div",{className:"border-b border-gray-200 pb-6 last:border-b-0",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsx(Ne,{size:20,className:"text-primary-600"})})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:o.user?.name||"Usuario anÃ³nimo"}),e.jsxs("div",{className:"flex items-center mt-1",children:[g(o.rating),e.jsx("span",{className:"ml-2 text-sm text-gray-500",children:I(o.created_at)})]})]})}),o.title&&e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:o.title}),o.comment&&e.jsx("p",{className:"text-gray-700 leading-relaxed",children:o.comment}),o.seller_response&&e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Respuesta del vendedor"}),e.jsx("span",{className:"ml-2 text-xs text-blue-600",children:I(o.seller_response.created_at)})]}),e.jsx("p",{className:"text-blue-800 text-sm",children:o.seller_response.text})]})]})]})},o.id||t))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-yellow-400 mb-4",children:e.jsx(se,{size:48,className:"mx-auto fill-current"})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:w?"No hay reseÃ±as disponibles":"Sin reseÃ±as aÃºn"}),e.jsx("p",{className:"text-gray-500",children:w?"Este producto aÃºn no tiene reseÃ±as de clientes":"SÃ© el primero en valorar este producto"})]}),v>1&&e.jsxs("div",{className:"flex justify-center mt-8 space-x-2",children:[e.jsx("button",{onClick:()=>{m>1&&_(o=>o-1)},disabled:m===1||P,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-600 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Anterior"}),e.jsxs("span",{className:"px-4 py-2 text-gray-600",children:["PÃ¡gina ",m," de ",v]}),e.jsx("button",{onClick:()=>{m<v&&_(o=>o+1)},disabled:m===v||P,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-600 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Siguiente"})]})]})},ns=()=>{const{id:i}=Fe(),h=Re(),{product:a,loading:j,error:l,fetchProductById:m,trackProductView:_,clearCurrentProduct:v}=Le(),[$,P]=d.useState(0),[f,k]=d.useState("description"),[u,w]=d.useState(!1),{addToCart:x,showNotification:y}=Te(),{toggleFavorite:b,checkIsFavorite:V}=Ve(),{createChat:S}=qe(),{handleError:g,handleSuccess:I,handleStockError:o}=ze({showNotification:y,context:"ProductItemPage"}),{optimisticCartAdd:t,optimisticFavoriteAdd:F,optimisticFavoriteRemove:te}=Ue(),[n,oe]=d.useState(1),{tiers:q,getDiscountForQuantity:ie}=Me(),L=ie(n),N=L>0,U=a?.final_price||a?.price||0,ne=U*(1-L),E=N?ne:U,le=a?.price||0,Z=a&&a.final_price&&a.final_price<a.price,ce=Z||N,C=N?(U-E)*n:0,M=[...q].sort((s,r)=>s.quantity-r.quantity).find(s=>s.quantity>n),de=M?M.quantity-n:0,R={finalPrice:E,totalSavings:C,hasDiscount:N,discountPercentage:L*100,nextTier:M,itemsNeededForNext:de},O={tiers:q,enabled:q.length>0},D=s=>typeof s.stockAvailable=="number"?s.stockAvailable:typeof s.stock=="number"?s.stock:0,me=(s,r)=>D(s)>=r&&s.is_in_stock!==!1,T=s=>s!=null&&s!==0&&s!=="0"&&s!=="",xe=s=>!s||s===0||isNaN(s)?"Sin valoraciones":`${s} valoraciÃ³n${s>1?"es":""}`,X=()=>{z.removeItem("cart_user_data"),z.removeItem("cart_guest_data"),z.removeItem("header_counters");for(let s=1;s<=10;s++)z.removeItem(`user_favorites_${s}_10`);console.log("ðŸ”„ Cache de pÃ¡ginas relacionadas invalidado")};d.useEffect(()=>{(async()=>{if(!i){console.error("âŒ ProductItemPage: ID no disponible");return}try{const r=parseInt(i);if(isNaN(r)){console.error("âŒ ProductItemPage: ID invÃ¡lido:",i);return}console.log("ðŸš€ ProductItemPage: Cargando producto ID:",r);const c=await m(r);console.log("ðŸ“¥ ProductItemPage: Producto cargado:",c),_(r).catch(ye=>{console.error("âš ï¸ Error registrando visualizaciÃ³n de producto:",ye)})}catch(r){console.error("âŒ ProductItemPage: Error cargando producto:",r)}})()},[i,m,_]),d.useEffect(()=>{a&&i&&a.id!==parseInt(i)&&(console.log("ðŸ§© ProductItemPage: Limpiando producto anterior, ID cambio de",a.id,"a",i),v())},[i,a,v]);const G=s=>{if(s<1)return;if(!a){g(new Error("Producto no disponible"),"No se puede cambiar la cantidad");return}const r=D(a);if(s>r){o(r,s);return}s<=50?oe(s):y(K.WARNING,"No puedes agregar mÃ¡s de 50 unidades por producto")},ue=async()=>{if(u||!a){a||g(new Error("Producto no disponible"),"Error: No se pudo cargar la informaciÃ³n del producto");return}if(!a.is_in_stock){y(K.ERROR,"Lo sentimos, este producto estÃ¡ agotado");return}const s=D(a);if(!me(a,n)){o(s,n);return}console.log(`AÃ±adiendo al carrito: ${n} unidades de ${a.name} con precio final: $${E}`);try{if(w(!0),t(),await x({productId:Number(i),quantity:n})){X();let c=`${a.name} ha sido agregado al carrito`;N&&C>0&&(c+=` con ${R?.discountPercentage}% de descuento por volumen (ahorro: $${C.toFixed(2)})`),I(c)}else throw new Error("No se pudo agregar el producto al carrito")}catch(r){if(console.error("Error al agregar al carrito:",r),r?.response?.data?.message?.includes("stock")||r?.message?.includes("stock")||r?.response?.data?.message?.includes("insuficiente")){const c=D(a);o(c,n)}else g(r,"Error al agregar producto al carrito. IntÃ©ntalo de nuevo.")}finally{setTimeout(()=>{w(!1)},1e3)}},ge=async()=>{if(u||!a){a||g(new Error("Producto no disponible"),"Error: No se pudo cargar la informaciÃ³n del producto");return}console.log(`Gestionando favoritos: ${a.name}`);try{w(!0),V(Number(i))?te():F();const r=await b(Number(i));X(),r?I("Producto aÃ±adido a favoritos"):y(K.INFO,"Producto eliminado de favoritos")}catch(s){console.error("Error al manejar favorito:",s),g(s,"Error al gestionar favoritos. IntÃ©ntalo de nuevo.")}finally{setTimeout(()=>{w(!1)},1e3)}},pe=async()=>{if(!a){g(new Error("Producto no disponible"),"Error: No se pudo cargar la informaciÃ³n del producto");return}try{let s;if(a.seller_id)s=a.seller_id,console.log(`Usando seller_id directo del producto: ${s}`);else if(a.seller?.id)s=a.seller.id,console.log(`Usando seller.id del producto: ${s}`);else if(a.user_id){console.log(`Intentando obtener seller_id a partir de user_id: ${a.user_id}`);try{const c=await De.get(`/sellers/by-user/${a.user_id}`);c&&c.data?c.data.id?(s=c.data.id,console.log(`Convertido user_id ${a.user_id} a seller_id ${s}`)):c.data.seller_id?(s=c.data.seller_id,console.log(`Convertido user_id ${a.user_id} a seller_id ${s}`)):(console.warn("No se pudo obtener seller_id, usando user_id como fallback"),s=a.user_id):(console.warn("Respuesta de API vacÃ­a o sin data, usando user_id como fallback"),s=a.user_id)}catch(c){console.error("Error al obtener seller_id:",c),s=a.user_id,console.warn(`Fallback: usando user_id ${s} como seller_id debido a error`)}}else throw console.error("No se encontrÃ³ informaciÃ³n de vendedor en datos del producto:",a),new Error("No se pudo determinar el vendedor del producto");console.log(`Iniciando chat con vendedor ID ${s} para producto ${a.id}`);const r=await S(s,Number(i));if(r)h(`/chats/${r}`);else throw new Error("No se pudo crear el chat con el vendedor")}catch(s){console.error("Error al iniciar chat con vendedor:",s),g(s,"Error al iniciar chat con vendedor. IntÃ©ntalo de nuevo.")}},he=async()=>{const s=window.location.href;try{await navigator.clipboard.writeText(s),I("Â¡Enlace copiado al portapapeles!")}catch(r){console.error("Error al copiar enlace:",r),g(r,"No se pudo copiar el enlace")}};if(j)return e.jsx("div",{className:"container mx-auto flex items-center justify-center py-20",children:e.jsxs("div",{className:"text-center",children:[e.jsx(je,{size:40,className:"animate-spin mx-auto mb-4 text-primary-600"}),e.jsx("p",{className:"text-gray-600",children:"Cargando informaciÃ³n del producto..."})]})});if(!j&&(l||!a))return console.log("âŒ ProductItemPage: Mostrando error:",{loading:j,error:l,hasProduct:!!a}),e.jsx("div",{className:"container mx-auto py-20",children:e.jsxs("div",{className:"max-w-lg mx-auto bg-white p-8 rounded-xl shadow-md",children:[e.jsx("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"Error"}),e.jsx("p",{className:"text-gray-700 mb-6",children:l||"No se encontrÃ³ el producto solicitado."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>h(-1),className:"bg-primary-600 text-white px-6 py-2 rounded-lg hover:bg-primary-700 transition-colors",children:"Volver"}),i&&e.jsx("button",{onClick:()=>{const s=parseInt(i);isNaN(s)||(console.log("ðŸ”„ ProductItemPage: Reintentando cargar producto:",s),m(s))},className:"bg-gray-600 text-white px-6 py-2 rounded-lg hover:bg-gray-700 transition-colors",children:"Reintentar"})]})]})});const B=a.category?[a.category.name]:[],p=D(a);console.log("ðŸ” ProductItemPage: Estado actual:",{id:i,loading:j,error:l,hasProduct:!!a,productId:a?.id,productName:a?.name,availableStock:p});const Y=s=>typeof s=="string"?J(s):J(s.original||s.medium||s.thumbnail),H=s=>{if(!s)return[];if(Array.isArray(s)){if(typeof s[0]=="string"&&!s[0].startsWith("["))return s;try{return s.join(",").replace(/\[|\]|"/g,"").split(",")}catch{return[]}}return[]},Q=H(a.colors),ee=H(a.sizes),W=H(a.tags),fe=[{name:"Peso",value:T(a.weight)?`${a.weight} kg`:"N/A"},{name:"Dimensiones",value:a.dimensions||T(a.width)&&T(a.height)&&T(a.depth)?`${a.width} Ã— ${a.height} Ã— ${a.depth} cm`:"N/A"},{name:"Disponibilidad",value:a.is_in_stock?`En stock (${p} unidades)`:"Agotado"},{name:"CategorÃ­a",value:a.category?.name||"N/A"}];return e.jsx("div",{className:"container mx-auto px-4 py-10",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("nav",{className:"flex mb-6 text-sm text-gray-500",children:[e.jsx(A,{to:"/",className:"hover:text-primary-600",children:"Inicio"}),e.jsx("span",{className:"mx-2",children:"/"}),a.category?e.jsxs(e.Fragment,{children:[e.jsx(A,{to:`/category/${a.category.slug}`,className:"hover:text-primary-600",children:a.category.name}),e.jsx("span",{className:"mx-2",children:"/"})]}):null,e.jsx("span",{className:"text-gray-700 font-medium",children:a.name})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-10 p-6 lg:p-10",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gray-50 rounded-xl overflow-hidden h-96 lg:h-[500px]",children:a.images&&a.images.length>0?e.jsx("img",{src:Y(a.images[$]),alt:a.name,className:"w-full h-full object-cover transition-all duration-300"}):null}),a.images&&a.images.length>1?e.jsx("div",{className:"grid grid-cols-4 gap-3",children:a.images.map((s,r)=>e.jsx("div",{className:`bg-gray-50 rounded-lg h-24 cursor-pointer border-2 transition-all overflow-hidden ${r===$?"border-primary-500 shadow-md":"border-transparent hover:border-gray-300"}`,onClick:()=>P(r),children:e.jsx("img",{src:Y(s),alt:`${a.name} thumbnail ${r+1}`,className:"w-full h-full object-cover"})},r))}):null]}),e.jsxs("div",{className:"space-y-6",children:[a.seller&&a.seller.name?e.jsx("div",{className:"flex items-center mb-2",children:e.jsx("span",{className:"text-sm bg-primary-50 text-primary-700 px-2 py-0.5 rounded font-medium",children:a.seller.name})}):null,e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:a.name}),e.jsx("div",{className:"flex items-center space-x-3",children:a.is_in_stock?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full mr-2"}),e.jsxs("span",{className:"text-green-700 font-medium",children:["En stock (",p," disponibles)"]})]}):e.jsxs("div",{className:"flex items-center",children:[e.jsx(ae,{size:16,className:"text-red-500 mr-2"}),e.jsx("span",{className:"text-red-600 font-medium",children:"Agotado"})]})}),a.rating&&typeof a.rating=="number"&&a.rating>0?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center",children:e.jsx(re,{rating:a.rating,size:18,showValue:!0})}),e.jsx("div",{className:"text-gray-500 text-sm",children:e.jsx("span",{className:"font-medium",children:xe(a.rating_count)})})]}):null,e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"price-container",children:[e.jsxs("span",{className:"text-3xl font-bold text-primary-700",children:["$",E.toFixed(2)]}),ce&&e.jsxs("span",{className:"ml-3 text-lg text-gray-500 line-through",children:["$",le.toFixed(2)]}),Z&&a&&e.jsxs("span",{className:"ml-2 px-2 py-1 bg-green-100 text-green-800 text-sm font-medium rounded",children:[a.discount_percentage,"% OFF"]}),N&&e.jsxs("span",{className:"ml-2 px-2 py-1 bg-blue-100 text-blue-800 text-sm font-medium rounded",children:["+",R?.discountPercentage,"% Volumen"]})]}),N&&C>0&&e.jsxs("div",{className:"flex items-center text-green-600",children:[e.jsx(ve,{size:16,className:"mr-1"}),e.jsxs("span",{className:"font-medium",children:["Â¡Ahorras $",C.toFixed(2)," con descuento por volumen!"]})]})]}),O.enabled&&O.tiers.length>0&&e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(we,{size:20,className:"text-blue-600 mr-2 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900 mb-2",children:"Â¡Descuentos por volumen disponibles!"}),e.jsx("div",{className:"space-y-1",children:O.tiers.map((s,r)=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:`${n>=s.quantity?"text-green-700 font-medium":"text-blue-800"}`,children:[s.quantity,"+ unidades = ",s.discount,"% descuento"]}),n>=s.quantity&&e.jsx("span",{className:"text-green-600 text-xs font-medium",children:"âœ“ Aplicado"})]},r))}),R?.nextTier&&e.jsx("div",{className:"mt-2 pt-2 border-t border-blue-200",children:e.jsxs("span",{className:"text-xs text-blue-600",children:["Â¡AÃ±ade ",R.itemsNeededForNext," mÃ¡s y obtÃ©n ",R.nextTier.discount,"% de descuento!"]})})]})]})}),Q.length>0?e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Color:"}),e.jsx("div",{className:"flex space-x-3",children:Q.map((s,r)=>e.jsx("div",{className:"px-3 py-1 border border-gray-300 rounded-full cursor-pointer hover:border-primary-500",title:s,children:s},r))})]}):null,ee.length>0?e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"TamaÃ±o:"}),e.jsx("div",{className:"flex space-x-3",children:ee.map((s,r)=>e.jsx("div",{className:"px-3 py-1 border border-gray-300 rounded-full cursor-pointer hover:border-primary-500",title:s,children:s},r))})]}):null,e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Cantidad:"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex border border-gray-300 rounded-lg overflow-hidden h-12",children:[e.jsx("button",{className:"px-4 bg-gray-50 text-gray-600 hover:bg-gray-100 flex items-center justify-center disabled:opacity-50",onClick:()=>G(n-1),disabled:n<=1,children:e.jsx(_e,{size:18})}),e.jsx("input",{type:"number",className:"w-20 text-center border-x border-gray-300 text-gray-700 font-medium focus:outline-none",min:"1",max:Math.min(p,50),value:n,onChange:s=>G(parseInt(s.target.value)||1)}),e.jsx("button",{className:"px-4 bg-gray-50 text-gray-600 hover:bg-gray-100 flex items-center justify-center disabled:opacity-50",onClick:()=>G(n+1),disabled:n>=Math.min(p,50),children:e.jsx($e,{size:18})})]}),e.jsxs("div",{className:"text-lg",children:[e.jsx("span",{className:"text-gray-600",children:"Total: "}),e.jsxs("span",{className:"font-bold text-primary-700",children:["$",(E*n).toFixed(2)]}),N&&e.jsxs("div",{className:"text-sm text-green-600",children:["(Ahorras $",C.toFixed(2),")"]})]})]}),p<10&&p>0&&e.jsxs("div",{className:"mt-2 text-sm text-amber-600 flex items-center",children:[e.jsx(ae,{size:14,className:"mr-1"}),"Â¡Solo quedan ",p," unidades disponibles!"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("button",{className:"flex-grow h-12 bg-primary-600 hover:bg-primary-700 text-white rounded-lg font-medium transition-colors duration-200 flex items-center justify-center disabled:opacity-50",onClick:ue,disabled:!a.is_in_stock||u||p===0,children:[e.jsx(ke,{size:20,className:"mr-2"}),u?"Agregando...":a.is_in_stock&&p>0?`AÃ±adir al Carrito - $${(E*n).toFixed(2)}`:"Producto Agotado"]}),e.jsx("button",{className:"h-12 w-12 border border-gray-300 rounded-lg flex items-center justify-center text-gray-600 hover:text-primary-600 hover:border-primary-600 transition-colors duration-200 disabled:opacity-50",onClick:ge,disabled:u,title:"AÃ±adir a favoritos",children:e.jsx(Ie,{size:20})}),e.jsxs("button",{className:"h-12 px-4 border border-gray-300 rounded-lg flex items-center justify-center text-gray-600 hover:text-primary-600 hover:border-primary-600 transition-colors duration-200",onClick:pe,title:"Chatear con el vendedor",children:[e.jsx(Ee,{size:20,className:"mr-2"}),"Contactar"]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-5 space-y-4",children:[e.jsxs("div",{className:"flex items-start",children:[e.jsx(Ce,{className:"text-primary-600 mt-1 flex-shrink-0 mr-3",size:20}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Entrega rÃ¡pida"}),e.jsx("p",{className:"text-sm text-gray-600",children:a.is_in_stock?e.jsxs(e.Fragment,{children:["Disponible para entrega en"," ",e.jsx("span",{className:"font-medium",children:"1-3 dÃ­as hÃ¡biles"})]}):"Producto agotado temporalmente"})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx(Ae,{className:"text-primary-600 mt-1 flex-shrink-0 mr-3",size:20}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"GarantÃ­a de 1 aÃ±o"}),e.jsx("p",{className:"text-sm text-gray-600",children:"GarantÃ­a del fabricante contra defectos"})]})]}),e.jsxs("div",{className:"flex items-start",children:[e.jsx(Pe,{className:"text-primary-600 mt-1 flex-shrink-0 mr-3",size:20}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"DevoluciÃ³n gratuita"}),e.jsx("p",{className:"text-sm text-gray-600",children:"DevoluciÃ³n sin costo en los primeros 30 dÃ­as"})]})]})]}),B.length>0||W.length>0?e.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[B.length>0?e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx("span",{className:"text-gray-600 mr-2",children:"CategorÃ­as:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:B.map((s,r)=>e.jsx(A,{to:`/category/${a.category?.slug||""}`,className:"bg-gray-100 hover:bg-gray-200 px-3 py-1 text-sm rounded-full text-gray-700 transition-colors",children:s},r))})]}):null,W.length>0?e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-gray-600 mr-2",children:"Etiquetas:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:W.map((s,r)=>e.jsx(A,{to:`/tags/${s}`,className:"bg-gray-100 hover:bg-gray-200 px-3 py-1 text-sm rounded-full text-gray-700 transition-colors",children:s},r))})]}):null]}):null,e.jsxs("button",{onClick:he,className:"flex items-center text-gray-500 text-sm hover:text-primary-600 transition-colors cursor-pointer",children:[e.jsx(Se,{size:16,className:"mr-2"}),e.jsx("span",{children:"Compartir este producto"})]})]})]}),e.jsxs("div",{className:"border-t border-gray-200",children:[e.jsxs("div",{className:"flex border-b border-gray-200",children:[e.jsx("button",{className:`py-4 px-6 font-medium text-sm ${f==="description"?"text-primary-600 border-b-2 border-primary-600":"text-gray-500 hover:text-gray-700"}`,onClick:()=>k("description"),children:"DescripciÃ³n"}),e.jsx("button",{className:`py-4 px-6 font-medium text-sm ${f==="specifications"?"text-primary-600 border-b-2 border-primary-600":"text-gray-500 hover:text-gray-700"}`,onClick:()=>k("specifications"),children:"Especificaciones"}),e.jsx("button",{className:`py-4 px-6 font-medium text-sm ${f==="reviews"?"text-primary-600 border-b-2 border-primary-600":"text-gray-500 hover:text-gray-700"}`,onClick:()=>k("reviews"),children:"Valoraciones"})]}),e.jsxs("div",{className:"flex justify-center p-6 lg:p-10",children:[f==="description"&&e.jsxs("div",{className:"max-w-3xl space-y-6",children:[a.short_description?e.jsx("p",{className:"font-medium text-lg text-gray-800",children:a.short_description}):null,e.jsx("p",{className:"text-gray-700 leading-relaxed",children:a.description})]}),f==="specifications"&&e.jsx("div",{className:"max-w-3xl",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-y-4 gap-x-8",children:fe.map((s,r)=>e.jsxs("div",{className:"flex border-b border-gray-100 pb-3",children:[e.jsxs("span",{className:"w-40 font-medium text-gray-700",children:[s.name,":"]}),e.jsx("span",{className:"text-gray-600",children:s.value})]},r))})}),f==="reviews"&&e.jsx(Ge,{productId:a.id||0,rating:a.rating||0,ratingCount:a.rating_count||a.ratingCount||0})]})]})]}),a.related_products&&a.related_products.length>0?e.jsxs("div",{className:"mt-16",children:[e.jsx("h2",{className:"text-2xl font-bold mb-8",children:"Productos relacionados"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:a.related_products.map(s=>e.jsxs("div",{className:"bg-white rounded-xl shadow-md overflow-hidden hover:shadow-lg transition-shadow",children:[e.jsx("div",{className:"h-52 bg-gray-50 flex items-center justify-center p-4",children:e.jsx("img",{src:J(s.images&&s.images.length>0?typeof s.images[0]=="string"?s.images[0]:s.images[0].original||s.images[0].medium:null),alt:s.name,className:"max-h-full max-w-full object-contain"})}),e.jsxs("div",{className:"p-5",children:[s.rating&&typeof s.rating=="number"&&s.rating>0?e.jsx("div",{className:"flex items-center mb-2",children:e.jsx(re,{rating:s.rating,size:14,showValue:!0})}):null,e.jsx(A,{to:`/product/${s.id}`,children:e.jsx("h3",{className:"font-medium text-gray-800 mb-2 hover:text-primary-600 transition-colors line-clamp-2 h-12",children:s.name})}),e.jsxs("p",{className:"text-primary-600 font-bold",children:["$",s.final_price&&typeof s.final_price=="number"&&s.final_price>0?s.final_price.toFixed(2):s.price.toFixed(2)]}),e.jsx(A,{to:`/product/${s.id}`,className:"block w-full mt-3",children:e.jsx("button",{className:"w-full bg-gray-100 hover:bg-gray-200 text-gray-800 py-2 rounded-lg font-medium text-sm transition-colors",children:"Ver detalles"})})]})]},s.id))})]}):null]})})};export{ns as default};
//# sourceMappingURL=ProductItemPage-kNQxxj4n.js.map
