import{l as g,t as d,r as l,m as h,n as f}from"./index-DmNDOrWy.js";class M{async getAllCategories(e){try{console.log("ðŸ“¤ AdminCategoryService: Obteniendo todas las categorÃ­as como admin:",e);const r=await g.get(d.CATEGORIES.LIST,e);return console.log("ðŸ“¥ AdminCategoryService: Respuesta del servidor:",r),r}catch(r){return console.error("âŒ Error en AdminCategoryService.getAllCategories:",r),null}}async getCategoryById(e){try{console.log(`ðŸ“¤ AdminCategoryService: Obteniendo categorÃ­a ${e} como admin`);const r=await g.get(d.CATEGORIES.DETAILS(e));return console.log("âœ… AdminCategoryService: CategorÃ­a obtenida:",r),r}catch(r){return console.error("âŒ Error en AdminCategoryService.getCategoryById:",r),null}}async createCategory(e){try{console.log("ðŸ“¤ AdminCategoryService: Creando categorÃ­a como admin:",e);const r=await g.post(d.ADMIN.CATEGORIES.CREATE,e);return console.log("âœ… AdminCategoryService: CategorÃ­a creada:",r),r}catch(r){return console.error("âŒ Error en AdminCategoryService.createCategory:",r),null}}async updateCategory(e){try{if(console.log(`ðŸ“¤ AdminCategoryService: Actualizando categorÃ­a ${e.id} como admin:`,e),!e.id)throw new Error("ID de categorÃ­a requerido para actualizaciÃ³n");const r=await g.put(d.ADMIN.CATEGORIES.UPDATE(e.id),e);return console.log("âœ… AdminCategoryService: CategorÃ­a actualizada:",r),r}catch(r){return console.error("âŒ Error en AdminCategoryService.updateCategory:",r),null}}async partialUpdateCategory(e,r){try{console.log(`ðŸ“¤ AdminCategoryService: Actualizando parcialmente categorÃ­a ${e} como admin:`,r);const t=await g.patch(d.ADMIN.CATEGORIES.PARTIAL_UPDATE(e),r);return console.log("âœ… AdminCategoryService: CategorÃ­a actualizada parcialmente:",t),t}catch(t){return console.error("âŒ Error en AdminCategoryService.partialUpdateCategory:",t),null}}async deleteCategory(e){try{console.log(`ðŸ“¤ AdminCategoryService: Eliminando categorÃ­a ${e} como admin`);const r=await g.delete(d.ADMIN.CATEGORIES.DELETE(e));return console.log("âœ… AdminCategoryService: CategorÃ­a eliminada:",r),!0}catch(r){return console.error("âŒ Error en AdminCategoryService.deleteCategory:",r),!1}}async toggleActive(e,r){try{console.log(`ðŸ“¤ AdminCategoryService: Cambiando estado activo de categorÃ­a ${e} a ${r}`);const t=await g.patch(d.ADMIN.CATEGORIES.PARTIAL_UPDATE(e),{is_active:r});return console.log("âœ… AdminCategoryService: Estado activo actualizado:",t),!0}catch(t){return console.error("âŒ Error en AdminCategoryService.toggleActive:",t),t instanceof Error&&console.error("Error message:",t.message),!1}}async toggleFeatured(e,r){try{console.log(`ðŸ“¤ AdminCategoryService: Cambiando estado destacado de categorÃ­a ${e} a ${r}`);const t=await g.patch(d.ADMIN.CATEGORIES.PARTIAL_UPDATE(e),{featured:r});return console.log("âœ… AdminCategoryService: Estado destacado actualizado:",t),!0}catch(t){return console.error("âŒ Error en AdminCategoryService.toggleFeatured:",t),t instanceof Error&&console.error("Error message:",t.message),!1}}async updateOrder(e,r){try{console.log(`ðŸ“¤ AdminCategoryService: Actualizando orden de categorÃ­a ${e} a ${r}`);const t=await g.patch(d.ADMIN.CATEGORIES.PARTIAL_UPDATE(e),{order:r});return console.log("âœ… AdminCategoryService: Orden actualizado:",t),!0}catch(t){return console.error("âŒ Error en AdminCategoryService.updateOrder:",t),t instanceof Error&&console.error("Error message:",t.message),!1}}async getMainCategories(e=!0){try{console.log("ðŸ“¤ AdminCategoryService: Obteniendo categorÃ­as principales como admin");const r=await g.get(d.CATEGORIES.MAIN,{with_counts:e});return console.log("âœ… AdminCategoryService: CategorÃ­as principales obtenidas:",r),r||[]}catch(r){return console.error("âŒ Error en AdminCategoryService.getMainCategories:",r),[]}}async getSubcategories(e){try{console.log(`ðŸ“¤ AdminCategoryService: Obteniendo subcategorÃ­as de ${e} como admin`);const r=await g.get(d.CATEGORIES.SUBCATEGORIES(e));return console.log("âœ… AdminCategoryService: SubcategorÃ­as obtenidas:",r),r||[]}catch(r){return console.error("âŒ Error en AdminCategoryService.getSubcategories:",r),[]}}}class G{adminCategoryService;constructor(e){this.adminCategoryService=e}async execute(e){console.log("GetAllCategoriesUseCase: Obteniendo todas las categorÃ­as como admin");try{const r=await this.adminCategoryService.getAllCategories(e);return console.log("GetAllCategoriesUseCase: CategorÃ­as obtenidas correctamente:",r),r}catch(r){throw console.error("GetAllCategoriesUseCase: Error al obtener categorÃ­as:",r),r}}}class R{adminCategoryService;constructor(e){this.adminCategoryService=e}async execute(e){console.log("CreateCategoryAsAdminUseCase: Creando categorÃ­a como admin:",e);try{const r=await this.adminCategoryService.createCategory(e);return console.log("CreateCategoryAsAdminUseCase: CategorÃ­a creada correctamente:",r),r}catch(r){throw console.error("CreateCategoryAsAdminUseCase: Error al crear categorÃ­a:",r),r}}}class z{adminCategoryService;constructor(e){this.adminCategoryService=e}async execute(e){console.log(`UpdateAnyCategoryUseCase: Actualizando categorÃ­a ${e.id} como admin:`,e);try{const r=await this.adminCategoryService.updateCategory(e);return console.log("UpdateAnyCategoryUseCase: CategorÃ­a actualizada correctamente:",r),r}catch(r){throw console.error("UpdateAnyCategoryUseCase: Error al actualizar categorÃ­a:",r),r}}}class x{adminCategoryService;constructor(e){this.adminCategoryService=e}async execute(e){console.log(`DeleteAnyCategoryUseCase: Eliminando categorÃ­a ${e} como admin`);try{const r=await this.adminCategoryService.deleteCategory(e);return console.log("DeleteAnyCategoryUseCase: CategorÃ­a eliminada correctamente:",r),r}catch(r){throw console.error("DeleteAnyCategoryUseCase: Error al eliminar categorÃ­a:",r),r}}}class B{adminCategoryService;constructor(e){this.adminCategoryService=e}async execute(e,r){console.log(`ToggleCategoryActiveUseCase: Cambiando estado activo de categorÃ­a ${e} a ${r}`);try{const t=await this.adminCategoryService.toggleActive(e,r);return console.log("ToggleCategoryActiveUseCase: Estado activo actualizado correctamente:",t),t}catch(t){throw console.error("ToggleCategoryActiveUseCase: Error al cambiar estado activo:",t),t}}}class P{adminCategoryService;constructor(e){this.adminCategoryService=e}async execute(e,r){console.log(`ToggleCategoryFeaturedUseCase: Cambiando estado destacado de categorÃ­a ${e} a ${r}`);try{const t=await this.adminCategoryService.toggleFeatured(e,r);return console.log("ToggleCategoryFeaturedUseCase: Estado destacado actualizado correctamente:",t),t}catch(t){throw console.error("ToggleCategoryFeaturedUseCase: Error al cambiar estado destacado:",t),t}}}class N{adminCategoryService;constructor(e){this.adminCategoryService=e}async execute(e){console.log(`GetCategoryByIdUseCase: Obteniendo categorÃ­a ${e} como admin`);try{const r=await this.adminCategoryService.getCategoryById(e);return console.log("GetCategoryByIdUseCase: CategorÃ­a obtenida correctamente:",r),r}catch(r){throw console.error("GetCategoryByIdUseCase: Error al obtener categorÃ­a:",r),r}}}const E=new M,F=new G(E),L=new R(E),k=new z(E),K=new x(E),W=new B(E),j=new P(E),q=new N(E),H=()=>{const[u,e]=l.useState(!1),[r,t]=l.useState(null),[p,C]=l.useState([]),[b,y]=l.useState([]),[m,A]=l.useState(null),i=l.useCallback(a=>!a||typeof a!="object"?(console.error("CategorÃ­a invÃ¡lida para adaptar:",a),{}):{id:a.id,name:a.name||"",slug:a.slug||"",description:a.description||"",parent_id:a.parent_id,icon:a.icon,image:a.image,order:a.order,is_active:!!(a.is_active??!0),featured:!!(a.featured??!1),created_at:a.created_at,updated_at:a.updated_at,subcategories:Array.isArray(a.subcategories)?a.subcategories.map(c=>i(c)):void 0,product_count:a.product_count||0,full_path:a.full_path,has_children:!!a.has_children,url:a.url,parent:a.parent?i(a.parent):void 0,image_url:a.image_url,icon_url:a.icon_url},[]),U=l.useCallback(async(a,c=!1)=>{e(!0),t(null);const s=`admin_categories_${JSON.stringify(a)}`;try{if(!c){const o=h.getItem(s);if(o&&o.data)return console.log("ðŸ’¾ useAdminCategories: Usando categorÃ­as en cachÃ©"),C(o.data||[]),e(!1),o}console.log("ðŸŒ useAdminCategories: Obteniendo categorÃ­as desde API");const n=await F.execute({...a});if(n&&n.data&&Array.isArray(n.data)){const o=n.data.map(i),v={data:o,meta:n.meta||{total:o.length}};return h.setItem(s,v,f.cache.categoryCacheTime),C(o),v}else return console.warn("Respuesta de categorÃ­as no tiene el formato esperado:",n),C([]),{data:[],meta:{total:0}}}catch(n){const o=n instanceof Error?n.message:"Error al obtener categorÃ­as";return t(o),console.error("Error al obtener categorÃ­as:",n),C([]),{data:[],meta:{total:0}}}finally{e(!1)}},[i]),I=l.useCallback(async(a=!0,c=!1)=>{e(!0),t(null);const s=`admin_main_categories_${a?"with_counts":"no_counts"}`;try{if(!c){const o=h.getItem(s);if(o)return console.log("ðŸ’¾ useAdminCategories: Usando categorÃ­as principales en cachÃ©"),y(o),e(!1),o}console.log("ðŸŒ useAdminCategories: Obteniendo categorÃ­as principales desde API");const n=await E.getMainCategories(a);if(n&&Array.isArray(n)){const o=n.map(i);return h.setItem(s,o,f.cache.categoryCacheTime),y(o),o}else return console.warn("Respuesta de categorÃ­as principales no tiene el formato esperado:",n),y([]),[]}catch(n){const o=n instanceof Error?n.message:"Error al obtener categorÃ­as principales";return t(o),console.error("Error al obtener categorÃ­as principales:",n),y([]),[]}finally{e(!1)}},[i]),w=l.useCallback(async a=>{e(!0),t(null);const c=`admin_category_${a}`;try{const s=h.getItem(c);if(s)return console.log(`ðŸ’¾ useAdminCategories: Usando categorÃ­a ${a} en cachÃ©`),A(s),e(!1),s;console.log(`ðŸŒ useAdminCategories: Obteniendo categorÃ­a ${a} desde API`);const n=await q.execute(a);if(n){const o=i(n);return h.setItem(c,o,f.cache.categoryCacheTime),A(o),o}return A(null),null}catch(s){const n=s instanceof Error?s.message:"Error al obtener categorÃ­a";return t(n),console.error("Error al obtener categorÃ­a:",s),A(null),null}finally{e(!1)}},[i]),_=l.useCallback(async a=>{e(!0),t(null);try{console.log("ðŸŒ useAdminCategories: Creando nueva categorÃ­a:",a);const c=await L.execute(a);if(c){const s=i(c);return C(n=>[...n,s]),a.parent_id||y(n=>[...n,s]),S(),s}return null}catch(c){const s=c instanceof Error?c.message:"Error al crear categorÃ­a";return t(s),console.error("Error al crear categorÃ­a:",c),null}finally{e(!1)}},[i]),T=l.useCallback(async a=>{e(!0),t(null);try{console.log(`ðŸŒ useAdminCategories: Actualizando categorÃ­a ${a.id}:`,a);const c=await k.execute(a);if(c){const s=i(c);return C(n=>n.map(o=>o.id===a.id?s:o)),y(n=>n.map(o=>o.id===a.id?s:o)),m?.id===a.id&&A(s),S(),s}return null}catch(c){const s=c instanceof Error?c.message:"Error al actualizar categorÃ­a";return t(s),console.error("Error al actualizar categorÃ­a:",c),null}finally{e(!1)}},[i,m]),$=l.useCallback(async a=>{e(!0),t(null);try{return console.log(`ðŸŒ useAdminCategories: Eliminando categorÃ­a ${a}`),await K.execute(a)?(C(s=>s.filter(n=>n.id!==a)),y(s=>s.filter(n=>n.id!==a)),m?.id===a&&A(null),S(),!0):!1}catch(c){const s=c instanceof Error?c.message:"Error al eliminar categorÃ­a";return t(s),console.error("Error al eliminar categorÃ­a:",c),!1}finally{e(!1)}},[m]),O=l.useCallback(async(a,c)=>{e(!0),t(null);try{if(console.log(`ðŸŒ useAdminCategories: Cambiando estado activo de categorÃ­a ${a} a ${c}`),await W.execute(a,c)){const n=o=>o.id===a?{...o,is_active:c}:o;return C(o=>o.map(n)),y(o=>o.map(n)),m?.id===a&&A(o=>o&&{...o,is_active:c}),S(),!0}return!1}catch(s){const n=s instanceof Error?s.message:"Error al cambiar estado activo";return t(n),console.error("Error al cambiar estado activo:",s),!1}finally{e(!1)}},[m]),D=l.useCallback(async(a,c)=>{e(!0),t(null);try{if(console.log(`ðŸŒ useAdminCategories: Cambiando estado destacado de categorÃ­a ${a} a ${c}`),await j.execute(a,c)){const n=o=>o.id===a?{...o,featured:c}:o;return C(o=>o.map(n)),y(o=>o.map(n)),m?.id===a&&A(o=>o&&{...o,featured:c}),S(),!0}return!1}catch(s){const n=s instanceof Error?s.message:"Error al cambiar estado destacado";return t(n),console.error("Error al cambiar estado destacado:",s),!1}finally{e(!1)}},[m]),S=l.useCallback(()=>{const c=Object.keys(localStorage).filter(s=>s.startsWith("admin_categories_")||s.startsWith("admin_category_")||s.startsWith("admin_main_categories_")||s.startsWith("category_")||s.startsWith("categories_"));c.forEach(s=>{h.removeItem(s)}),console.log(`ðŸ—‘ï¸ ${c.length} claves de cachÃ© de categorÃ­as de admin eliminadas`)},[]);return{loading:u,error:r,categories:p,mainCategories:b,categoryDetail:m,fetchAllCategories:U,fetchMainCategories:I,fetchCategoryById:w,createCategory:_,updateCategory:T,deleteCategory:$,toggleActive:O,toggleFeatured:D,clearCategoryCache:S,setError:a=>t(a),setLoading:a=>e(a)}};export{H as u};
//# sourceMappingURL=useAdminCategories-D_zTNu7p.js.map
