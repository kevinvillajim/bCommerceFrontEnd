{"version":3,"file":"BaseDashboardLayout-BjTwwvyP.js","sources":["../../src/presentation/components/dashboard/DashboardContext.tsx","../../src/presentation/components/dashboard/SideBar.tsx","../../src/presentation/components/dashboard/NotificationModal.tsx","../../src/presentation/components/dashboard/DashboardHeader.tsx","../../src/presentation/components/dashboard/DashboardFooter.tsx","../../src/presentation/components/dashboard/BaseDashboardLayout.tsx"],"sourcesContent":["import React, {\r\n\tcreateContext,\r\n\tuseState,\r\n\tuseContext,\r\n\tuseEffect,\r\n} from \"react\";\r\nimport type { ReactNode } from \"react\";\r\nimport {useLocation} from \"react-router-dom\";\r\nimport type {Notification, PendingActions, DashboardType} from \"./index\";\r\n\r\ninterface DashboardContextProps {\r\n\t// Estado del sidebar\r\n\tisSidebarOpen: boolean;\r\n\ttoggleSidebar: () => void;\r\n\r\n\t// Estado de notificaciones\r\n\tnotifications: Notification[];\r\n\tunreadNotificationsCount: number;\r\n\taddNotification: (notification: Omit<Notification, \"id\">) => void;\r\n\tmarkAllNotificationsAsRead: () => void;\r\n\tmarkNotificationAsRead: (id: string) => void;\r\n\r\n\t// Acciones pendientes\r\n\tpendingActions: PendingActions;\r\n\tsetPendingAction: (key: string, value: number) => void;\r\n\tincrementPendingAction: (key: string) => void;\r\n\tdecrementPendingAction: (key: string) => void;\r\n\r\n\t// Tipo de dashboard actual\r\n\tdashboardType: DashboardType;\r\n\r\n\t// Título dinámico de la página actual\r\n\tcurrentPageTitle: string;\r\n\tsetPageTitle: (path: string, title: string) => void;\r\n}\r\n\r\n// Crear el contexto\r\nconst DashboardContext = createContext<DashboardContextProps | undefined>(\r\n\tundefined\r\n);\r\n\r\n// Props para el proveedor\r\ninterface DashboardProviderProps {\r\n\tchildren: ReactNode;\r\n\tinitialType: DashboardType;\r\n\tinitialPageTitles?: Record<string, string>;\r\n}\r\n\r\n// Generador de ID único para notificaciones\r\nconst generateId = (): string => {\r\n\treturn Date.now().toString(36) + Math.random().toString(36).substr(2);\r\n};\r\n\r\n/**\r\n * Proveedor del contexto del Dashboard\r\n */\r\nexport const DashboardProvider: React.FC<DashboardProviderProps> = ({\r\n\tchildren,\r\n\tinitialType,\r\n\tinitialPageTitles = {},\r\n}) => {\r\n\t// Estado del sidebar\r\n\tconst [isSidebarOpen, setIsSidebarOpen] = useState(true);\r\n\r\n\t// Tipo de dashboard\r\n\tconst [dashboardType] = useState<DashboardType>(initialType);\r\n\r\n\t// Estado de notificaciones\r\n\tconst [notifications, setNotifications] = useState<Notification[]>([]);\r\n\tconst [unreadNotificationsCount, setUnreadNotificationsCount] = useState(0);\r\n\r\n\t// Acciones pendientes\r\n\tconst [pendingActions, setPendingActions] = useState<PendingActions>({});\r\n\r\n\t// Títulos de página\r\n\tconst [pageTitles, setPageTitles] =\r\n\t\tuseState<Record<string, string>>(initialPageTitles);\r\n\r\n\t// Current pathname para determinar el título actual\r\n\tconst location = useLocation();\r\n\r\n\t// Calcular el título actual basado en la ruta\r\n\tconst getCurrentPageTitle = (): string => {\r\n\t\tconst {pathname} = location;\r\n\r\n\t\t// Buscar coincidencias exactas primero\r\n\t\tif (pageTitles[pathname]) {\r\n\t\t\treturn pageTitles[pathname];\r\n\t\t}\r\n\r\n\t\t// Buscar coincidencias parciales\r\n\t\tfor (const [path, title] of Object.entries(pageTitles)) {\r\n\t\t\tif (pathname.includes(path)) {\r\n\t\t\t\treturn title;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Título por defecto según el tipo de dashboard\r\n\t\tswitch (dashboardType) {\r\n\t\t\tcase \"admin\":\r\n\t\t\t\treturn \"Panel de Administración\";\r\n\t\t\tcase \"seller\":\r\n\t\t\t\treturn \"Portal del Vendedor\";\r\n\t\t\tcase \"customer\":\r\n\t\t\t\treturn \"Mi Cuenta\";\r\n\t\t\tdefault:\r\n\t\t\t\treturn \"Dashboard\";\r\n\t\t}\r\n\t};\r\n\r\n\t// Actualizar el contador de notificaciones no leídas\r\n\tuseEffect(() => {\r\n\t\tconst count = notifications.filter(\r\n\t\t\t(notification) => !notification.read\r\n\t\t).length;\r\n\t\tsetUnreadNotificationsCount(count);\r\n\t}, [notifications]);\r\n\r\n\t// Utilidades y funciones para modificar estados\r\n\tconst toggleSidebar = () => setIsSidebarOpen((prev) => !prev);\r\n\r\n\tconst addNotification = (notification: Omit<Notification, \"id\">) => {\r\n\t\tconst newNotification: Notification = {\r\n\t\t\t...notification,\r\n\t\t\tid: generateId(),\r\n\t\t};\r\n\t\tsetNotifications((prev) => [newNotification, ...prev]);\r\n\t};\r\n\r\n\tconst markAllNotificationsAsRead = () => {\r\n\t\tsetNotifications((prev) =>\r\n\t\t\tprev.map((notification) => ({...notification, read: true}))\r\n\t\t);\r\n\t};\r\n\r\n\tconst markNotificationAsRead = (id: string) => {\r\n\t\tsetNotifications((prev) =>\r\n\t\t\tprev.map((notification) =>\r\n\t\t\t\tnotification.id === id ? {...notification, read: true} : notification\r\n\t\t\t)\r\n\t\t);\r\n\t};\r\n\r\n\tconst setPendingAction = (key: string, value: number) => {\r\n\t\tsetPendingActions((prev) => ({...prev, [key]: value}));\r\n\t};\r\n\r\n\tconst incrementPendingAction = (key: string) => {\r\n\t\tsetPendingActions((prev) => ({\r\n\t\t\t...prev,\r\n\t\t\t[key]: (prev[key] || 0) + 1,\r\n\t\t}));\r\n\t};\r\n\r\n\tconst decrementPendingAction = (key: string) => {\r\n\t\tsetPendingActions((prev) => ({\r\n\t\t\t...prev,\r\n\t\t\t[key]: Math.max(0, (prev[key] || 0) - 1),\r\n\t\t}));\r\n\t};\r\n\r\n\tconst setPageTitle = (path: string, title: string) => {\r\n\t\tsetPageTitles((prev) => ({...prev, [path]: title}));\r\n\t};\r\n\r\n\t// Valor del contexto\r\n\tconst value: DashboardContextProps = {\r\n\t\tisSidebarOpen,\r\n\t\ttoggleSidebar,\r\n\t\tnotifications,\r\n\t\tunreadNotificationsCount,\r\n\t\taddNotification,\r\n\t\tmarkAllNotificationsAsRead,\r\n\t\tmarkNotificationAsRead,\r\n\t\tpendingActions,\r\n\t\tsetPendingAction,\r\n\t\tincrementPendingAction,\r\n\t\tdecrementPendingAction,\r\n\t\tdashboardType,\r\n\t\tcurrentPageTitle: getCurrentPageTitle(),\r\n\t\tsetPageTitle,\r\n\t};\r\n\r\n\treturn (\r\n\t\t<DashboardContext.Provider value={value}>\r\n\t\t\t{children}\r\n\t\t</DashboardContext.Provider>\r\n\t);\r\n};\r\n\r\n/**\r\n * Hook para usar el contexto del Dashboard\r\n */\r\nexport const useDashboard = () => {\r\n\tconst context = useContext(DashboardContext);\r\n\r\n\tif (context === undefined) {\r\n\t\tthrow new Error(\r\n\t\t\t\"useDashboard debe ser usado dentro de un DashboardProvider\"\r\n\t\t);\r\n\t}\r\n\r\n\treturn context;\r\n};\r\n\r\nexport default DashboardContext;\r\n","import React from \"react\";\r\nimport type { ReactNode } from \"react\";\r\nimport {NavLink} from \"react-router-dom\";\r\nimport {X} from \"lucide-react\";\r\n\r\ninterface SidebarLinkProps {\r\n\tpath: string;\r\n\tlabel: string;\r\n\ticon?: ReactNode;\r\n\tisNotificated?: boolean;\r\n\tnotificationCount?: number;\r\n}\r\n\r\ninterface SidebarGroupProps {\r\n\ttitle: string;\r\n\tlinks: SidebarLinkProps[];\r\n}\r\n\r\ninterface SidebarTitleProps {\r\n\ttitle: string;\r\n\ticon: ReactNode;\r\n}\r\n\r\ninterface SidebarProps {\r\n\t/**\r\n\t * Grupos de enlaces para el sidebar\r\n\t */\r\n\tgroups: SidebarGroupProps[];\r\n\r\n\t/**\r\n\t * Título e icono del sidebar\r\n\t */\r\n\ttitle: SidebarTitleProps;\r\n\r\n\t/**\r\n\t * Estado de apertura del sidebar (para móvil)\r\n\t */\r\n\tisOpen?: boolean;\r\n\r\n\t/**\r\n\t * Función para cambiar el estado de apertura del sidebar\r\n\t */\r\n\ttoggleSidebar?: () => void;\r\n}\r\n\r\n/**\r\n * Componente de enlace individual para el sidebar\r\n */\r\nconst SidebarLink: React.FC<SidebarLinkProps> = ({\r\n\tpath,\r\n\tlabel,\r\n\ticon,\r\n\tisNotificated,\r\n\tnotificationCount,\r\n}) => {\r\n\tconsole.log(\"SidebarLink →\", { label, notificationCount });\r\n\treturn (\r\n\t\t<NavLink\r\n\t\t\tto={path}\r\n\t\t\tend={true}\r\n\t\t\tclassName={({isActive}) =>\r\n\t\t\t\t`flex items-center px-4 py-2 mt-2 text-sm transition-colors duration-200 rounded-lg ${\r\n\t\t\t\t\tisActive\r\n\t\t\t\t\t\t? \"bg-primary-100 text-primary-700\"\r\n\t\t\t\t\t\t: \"text-gray-600 hover:bg-gray-200\"\r\n\t\t\t\t}`\r\n\t\t\t}\r\n\t\t>\r\n\t\t\t{icon}\r\n\t\t\t<span className=\"mx-1\">{label}</span>\r\n\t\t\t{isNotificated && notificationCount && notificationCount > 0 && (\r\n\t\t\t\t<span className=\"ml-auto inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-red-100 bg-red-500 rounded-full\">\r\n{(() => {\r\n  const count = Number(notificationCount);\r\n  if (count > 99) return \"99+\";\r\n  if (count > 0) return count;\r\n  return \"\";\r\n})()}\t\t\t\t</span>\r\n\t\t\t)}\r\n\t\t</NavLink>\r\n\t);\r\n};\r\n\r\n/**\r\n * Componente de barra lateral para dashboards\r\n */\r\nconst Sidebar: React.FC<SidebarProps> = ({\r\n\tgroups,\r\n\ttitle,\r\n\tisOpen = true,\r\n\ttoggleSidebar = () => {},\r\n}) => {\r\n\r\n\treturn (\r\n\t\t<aside\r\n\t\t\tclassName={`bg-white fixed md:static inset-y-0 left-0 z-30 w-64 transition-transform duration-300 transform ${\r\n\t\t\t\tisOpen ? \"translate-x-0\" : \"-translate-x-full\"\r\n\t\t\t} md:translate-x-0 overflow-y-auto`}\r\n\t\t>\r\n\t\t\t{/* Header del Sidebar */}\r\n\t\t\t<div className=\"flex items-center justify-between px-4 py-3 border-b border-gray-200\">\r\n\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t{title.icon}\r\n\t\t\t\t\t<h2 className=\"text-lg font-semibold text-gray-900 ml-2\">\r\n\t\t\t\t\t\t{title.title}\r\n\t\t\t\t\t</h2>\r\n\t\t\t\t</div>\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={toggleSidebar}\r\n\t\t\t\t\tclassName=\"p-1 rounded-md text-gray-500 md:hidden hover:text-gray-900 hover:bg-gray-100\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<X size={20} />\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Contenido del Sidebar */}\r\n\t\t\t<div className=\"p-4\">\r\n\t\t\t\t{groups.map((group, index) => (\r\n\t\t\t\t\t<div key={index} className=\"mb-6\">\r\n\t\t\t\t\t\t<h3 className=\"px-4 text-xs font-semibold text-gray-500 uppercase tracking-wider\">\r\n\t\t\t\t\t\t\t{group.title}\r\n\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t<div className=\"mt-2\">\r\n\t\t\t\t\t\t\t{group.links.map((link, linkIndex) => (\r\n\t\t\t\t\t\t\t\t<SidebarLink key={linkIndex} {...link} />\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t))}\r\n\t\t\t</div>\r\n\t\t</aside>\r\n\t);\r\n};\r\n\r\nexport default Sidebar;\r\n","import React, { useState, useEffect, useCallback } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport {\r\n  Bell,\r\n  Check,\r\n  CheckCheck,\r\n  Trash2,\r\n  Package,\r\n  ShoppingCart,\r\n  MessageCircle,\r\n  Star,\r\n  TrendingUp,\r\n  AlertTriangle,\r\n  Gift,\r\n  Truck,\r\n  FileText,\r\n  MoreVertical,\r\n  Shield,\r\n  Ban,\r\n  X,\r\n} from \"lucide-react\";\r\nimport { useNotifications } from \"../../hooks/useNotifications\";\r\nimport { useAuth } from \"../../hooks/useAuth\";\r\nimport { useInvalidateCounters } from \"../../hooks/useHeaderCounters\";\r\nimport type { Notification } from \"../../../core/domain/entities/Notification\";\r\nimport { formatRelativeTime } from \"../../../utils/dateUtils\";\r\n\r\ninterface NotificationModalProps {\r\n  isOpen: boolean;\r\n  onClose: () => void;\r\n  isAdmin?: boolean;\r\n}\r\n\r\n// Función para obtener el icono según el tipo de notificación\r\nconst getNotificationIcon = (type: string) => {\r\n  switch (type) {\r\n    case \"new_message\":\r\n      return <MessageCircle className=\"text-blue-500\" size={16} />;\r\n    case \"order_status\":\r\n      return <Package className=\"text-green-500\" size={16} />;\r\n    case \"shipping_update\":\r\n      return <Truck className=\"text-purple-500\" size={16} />;\r\n    case \"product_update\":\r\n      return <TrendingUp className=\"text-orange-500\" size={16} />;\r\n    case \"rating_received\":\r\n    case \"seller_rated\":\r\n      return <Star className=\"text-yellow-500\" size={16} />;\r\n    case \"new_order\":\r\n      return <ShoppingCart className=\"text-green-600\" size={16} />;\r\n    case \"low_stock\":\r\n      return <AlertTriangle className=\"text-red-500\" size={16} />;\r\n    case \"feedback_response\":\r\n      return <FileText className=\"text-indigo-500\" size={16} />;\r\n    case \"promotion\":\r\n    case \"discount\":\r\n      return <Gift className=\"text-pink-500\" size={16} />;\r\n    case \"seller_strike\":\r\n      return <Shield className=\"text-orange-500\" size={16} />;\r\n    case \"account_blocked\":\r\n      return <Ban className=\"text-red-500\" size={16} />;\r\n    case \"seller_suspended\":\r\n      return <AlertTriangle className=\"text-yellow-600\" size={16} />;\r\n    case \"seller_inactive\":\r\n      return <Ban className=\"text-red-600\" size={16} />;\r\n    default:\r\n      return <Bell className=\"text-gray-500\" size={16} />;\r\n  }\r\n};\r\n\r\n// Función para obtener URL de notificación según el rol\r\nconst getNotificationUrl = (notification: Notification, isSeller: boolean): string | null => {\r\n  const { type, data } = notification;\r\n\r\n  switch (type) {\r\n    case \"new_message\":\r\n      if (data.chat_id) {\r\n        return isSeller ? `/seller/messages/${data.chat_id}` : `/chats/${data.chat_id}`;\r\n      }\r\n      return isSeller ? \"/seller/messages\" : \"/chats\";\r\n\r\n    case \"order_status\":\r\n      if (data.order_id) {\r\n        return isSeller ? `/seller/orders/${data.order_id}` : `/orders/${data.order_id}`;\r\n      }\r\n      return isSeller ? \"/seller/orders\" : \"/orders\";\r\n\r\n    case \"shipping_update\":\r\n      if (data.tracking_number) {\r\n        return `/tracking/${data.tracking_number}`;\r\n      } else if (data.order_id) {\r\n        return isSeller ? `/seller/orders/${data.order_id}` : `/orders/${data.order_id}`;\r\n      }\r\n      return null;\r\n\r\n    case \"rating_received\":\r\n    case \"seller_rated\":\r\n      if (data.rating_id) {\r\n        return `/ratings/${data.rating_id}`;\r\n      }\r\n      return isSeller ? \"/seller/ratings\" : \"/profile\";\r\n\r\n    case \"new_order\":\r\n      if (data.order_id) {\r\n        return isSeller ? `/seller/orders/${data.order_id}` : null;\r\n      }\r\n      return isSeller ? \"/seller/orders\" : null;\r\n\r\n    case \"seller_suspended\":\r\n    case \"seller_inactive\":\r\n      return isSeller ? \"/seller/dashboard\" : null;\r\n\r\n    default:\r\n      return null;\r\n  }\r\n};\r\n\r\nconst NotificationModal: React.FC<NotificationModalProps> = ({\r\n  isOpen,\r\n  onClose,\r\n  isAdmin = false,\r\n}) => {\r\n  const [activeMenu, setActiveMenu] = useState<number | null>(null);\r\n  const { roleInfo } = useAuth();\r\n  \r\n  // Hook para actualizar contadores del header en tiempo real\r\n  const { optimisticNotificationRead, forceRefresh } = useInvalidateCounters();\r\n\r\n  const {\r\n    notifications,\r\n    loading,\r\n    error,\r\n    unreadCount,\r\n    fetchNotifications,\r\n    markAsRead,\r\n    markAllAsRead,\r\n    deleteNotification,\r\n  } = useNotifications();\r\n\r\n  // Fetch notificaciones cuando se abre el modal\r\n  useEffect(() => {\r\n    if (isOpen) {\r\n      fetchNotifications(1, false); // Cargar primera página, todas las notificaciones\r\n    }\r\n  }, [isOpen, fetchNotifications]);\r\n\r\n  // Manejar click en notificación\r\n  const handleNotificationClick = useCallback(\r\n    async (notification: Notification) => {\r\n      setActiveMenu(null);\r\n\r\n      // Marcar como leída si no lo está\r\n      if (!notification.read) {\r\n        const success = await markAsRead(notification.id!);\r\n        if (success) {\r\n          // 🔥 TIEMPO REAL: Actualizar contador del header inmediatamente\r\n          optimisticNotificationRead();\r\n          console.log(\"🔔 Contador del header actualizado por clic en notificación\");\r\n        }\r\n      }\r\n\r\n      // Cerrar modal\r\n      onClose();\r\n\r\n      // Obtener URL de destino y navegar\r\n      const url = getNotificationUrl(notification, roleInfo.isSeller);\r\n      if (url) {\r\n        window.location.href = url;\r\n      }\r\n    },\r\n    [markAsRead, onClose, roleInfo.isSeller, optimisticNotificationRead]\r\n  );\r\n\r\n  // Manejar marcar todas como leídas\r\n  const handleMarkAllAsRead = useCallback(async () => {\r\n    const success = await markAllAsRead();\r\n    if (success) {\r\n      // 🔥 TIEMPO REAL: Refrescar contadores del header (pondrá en 0)\r\n      await forceRefresh();\r\n      console.log(\"🔔 Contadores del header actualizados - marcar todas como leídas\");\r\n    }\r\n  }, [markAllAsRead, forceRefresh]);\r\n\r\n  // Manejar eliminación\r\n  const handleDelete = useCallback(\r\n    async (id: number) => {\r\n      await deleteNotification(id);\r\n      setActiveMenu(null);\r\n    },\r\n    [deleteNotification]\r\n  );\r\n\r\n  // Manejar marcar como leída individual\r\n  const handleMarkAsRead = useCallback(\r\n    async (id: number) => {\r\n      const success = await markAsRead(id);\r\n      if (success) {\r\n        // 🔥 TIEMPO REAL: Actualizar contador del header inmediatamente\r\n        optimisticNotificationRead();\r\n        console.log(\"🔔 Contador del header actualizado por marcar como leída individual\");\r\n      }\r\n      setActiveMenu(null);\r\n    },\r\n    [markAsRead, optimisticNotificationRead]\r\n  );\r\n\r\n  if (!isOpen) return null;\r\n\r\n  return (\r\n    <div className=\"fixed inset-0 z-50 overflow-hidden\">\r\n      {/* Backdrop */}\r\n      <div\r\n        className=\"absolute inset-0 bg-black bg-opacity-50 transition-opacity\"\r\n        onClick={onClose}\r\n      />\r\n\r\n      {/* Modal */}\r\n      <div className=\"relative flex items-start justify-center min-h-screen px-4 pt-16 pb-20\">\r\n        <div className=\"relative bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[80vh] flex flex-col\">\r\n          {/* Header */}\r\n          <div className=\"flex items-center justify-between p-6 border-b border-gray-200\">\r\n            <div>\r\n              <h2 className=\"text-xl font-semibold text-gray-900\">Notificaciones</h2>\r\n              {unreadCount > 0 && (\r\n                <p className=\"text-sm text-gray-600 mt-1\">\r\n                  {unreadCount} sin leer\r\n                </p>\r\n              )}\r\n            </div>\r\n            \r\n            <div className=\"flex items-center space-x-3\">\r\n              {/* 🔧 MEJORADO: Botón marcar todas como leídas más visible */}\r\n              {unreadCount > 0 && (\r\n                <button\r\n                  onClick={handleMarkAllAsRead}\r\n                  disabled={loading}\r\n                  className=\"px-4 py-2 bg-primary-100 text-primary-700 hover:bg-primary-200 disabled:opacity-50 flex items-center rounded-lg transition-all duration-200 text-sm font-medium border border-primary-200 hover:border-primary-300\"\r\n                  title={`Marcar ${unreadCount} notificación${unreadCount > 1 ? 'es' : ''} como leída${unreadCount > 1 ? 's' : ''}`}\r\n                >\r\n                  <CheckCheck size={16} className=\"mr-2\" />\r\n                  Marcar todas ({unreadCount})\r\n                </button>\r\n              )}\r\n              \r\n              {/* Cerrar */}\r\n              <button\r\n                onClick={onClose}\r\n                className=\"p-2 hover:bg-gray-100 rounded-full transition-colors\"\r\n                title=\"Cerrar notificaciones\"\r\n              >\r\n                <X size={20} className=\"text-gray-500\" />\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          {/* Content */}\r\n          <div className=\"flex-1 overflow-y-auto\">\r\n            {loading && notifications.length === 0 ? (\r\n              <div className=\"flex justify-center items-center h-32\">\r\n                <div className=\"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary-600\"></div>\r\n              </div>\r\n            ) : error ? (\r\n              <div className=\"p-6 text-center text-red-600\">\r\n                <p>{error}</p>\r\n                <button\r\n                  onClick={() => fetchNotifications(1, false)}\r\n                  className=\"mt-2 text-sm underline\"\r\n                >\r\n                  Reintentar\r\n                </button>\r\n              </div>\r\n            ) : notifications.length === 0 ? (\r\n              <div className=\"p-8 text-center\">\r\n                <Bell className=\"mx-auto h-12 w-12 text-gray-300 mb-4\" />\r\n                <h3 className=\"text-lg font-medium text-gray-700 mb-2\">\r\n                  No tienes notificaciones\r\n                </h3>\r\n                <p className=\"text-gray-500\">\r\n                  Cuando tengas actualizaciones importantes, aparecerán aquí.\r\n                </p>\r\n              </div>\r\n            ) : (\r\n              <div className=\"divide-y divide-gray-100\">\r\n                {notifications.slice(0, 10).map((notification) => (\r\n                  <div\r\n                    key={notification.id}\r\n                    onClick={() => handleNotificationClick(notification)}\r\n                    className={`p-4 hover:bg-gray-50 cursor-pointer transition-colors ${\r\n                      !notification.read ? \"bg-primary-50\" : \"bg-white\"\r\n                    }`}\r\n                  >\r\n                    <div className=\"flex items-start justify-between\">\r\n                      <div className=\"flex items-start space-x-3 flex-1\">\r\n                        {/* Icono */}\r\n                        <div className=\"flex-shrink-0 mt-1\">\r\n                          {getNotificationIcon(notification.type)}\r\n                        </div>\r\n\r\n                        {/* Contenido */}\r\n                        <div className=\"flex-1 min-w-0\">\r\n                          <div className=\"flex items-center space-x-2 mb-1\">\r\n                            <h4 className={`text-sm font-medium ${\r\n                              !notification.read ? \"text-gray-900\" : \"text-gray-700\"\r\n                            }`}>\r\n                              {notification.title}\r\n                            </h4>\r\n                            {!notification.read && (\r\n                              <div className=\"w-1.5 h-1.5 bg-primary-500 rounded-full\"></div>\r\n                            )}\r\n                          </div>\r\n\r\n                          <p className=\"text-sm text-gray-600 mb-1\">\r\n                            {notification.message}\r\n                          </p>\r\n\r\n                          <p className=\"text-xs text-gray-400\">\r\n                            {formatRelativeTime(notification.createdAt)}\r\n                          </p>\r\n                        </div>\r\n                      </div>\r\n\r\n                      {/* Menú de acciones */}\r\n                      <div className=\"relative\">\r\n                        <button\r\n                          onClick={(e) => {\r\n                            e.stopPropagation();\r\n                            setActiveMenu(\r\n                              activeMenu === notification.id ? null : notification.id!\r\n                            );\r\n                          }}\r\n                          className=\"p-1 rounded-full hover:bg-gray-200 transition-colors\"\r\n                        >\r\n                          <MoreVertical size={14} className=\"text-gray-500\" />\r\n                        </button>\r\n\r\n                        {activeMenu === notification.id && (\r\n                          <div className=\"absolute right-0 top-8 bg-white rounded-lg shadow-lg border border-gray-200 z-10 min-w-[140px]\">\r\n                            {!notification.read && (\r\n                              <button\r\n                                onClick={(e) => {\r\n                                  e.stopPropagation();\r\n                                  handleMarkAsRead(notification.id!);\r\n                                }}\r\n                                className=\"w-full px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center\"\r\n                              >\r\n                                <Check size={12} className=\"mr-2\" />\r\n                                Marcar como leída\r\n                              </button>\r\n                            )}\r\n                            <button\r\n                              onClick={(e) => {\r\n                                e.stopPropagation();\r\n                                handleDelete(notification.id!);\r\n                              }}\r\n                              className=\"w-full px-3 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center\"\r\n                            >\r\n                              <Trash2 size={12} className=\"mr-2\" />\r\n                              Eliminar\r\n                            </button>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* Footer */}\r\n          <div className=\"p-4 border-t border-gray-200 bg-gray-50\">\r\n            <Link\r\n              to={isAdmin ? \"/admin/notifications\" : \"/seller/notifications\"}\r\n              onClick={onClose}\r\n              className=\"block w-full text-center py-2 px-4 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors text-sm font-medium\"\r\n            >\r\n              Ver todas las notificaciones\r\n            </Link>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Click outside para cerrar menús */}\r\n      {activeMenu !== null && (\r\n        <div\r\n          className=\"fixed inset-0 z-0\"\r\n          onClick={() => setActiveMenu(null)}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default NotificationModal;\r\n","import React, {useState, useEffect, useContext} from \"react\";\r\nimport {Link} from \"react-router-dom\";\r\nimport {\r\n\tUser,\r\n\tSettings,\r\n\tBell,\r\n\tMenu,\r\n\tChevronDown,\r\n\tLogOut,\r\n\tAlertTriangle,\r\n} from \"lucide-react\";\r\nimport {AuthContext} from \"../../contexts/AuthContext\";\r\nimport {useHeaderCounters, useInvalidateCounters} from \"../../hooks/useHeaderCounters\";\r\nimport ThemeToggle from \"../common/ThemeToggle\";\r\nimport {useDashboard} from \"./DashboardContext\";\r\nimport NotificationModal from \"./NotificationModal\";\r\nimport {useNotifications} from \"../../hooks/useNotifications\";\r\n\r\n/**\r\n * Tipos de notificaciones para mostrar en el panel\r\n */\r\nexport interface Notification {\r\n\tid: string;\r\n\ttitle: string;\r\n\tdescription: string;\r\n\ttime: string;\r\n\tread: boolean;\r\n\ttype?: \"default\" | \"warning\" | \"error\" | \"success\";\r\n}\r\n\r\n/**\r\n * Tipos de acciones pendientes para mostrar en la parte superior\r\n */\r\nexport interface PendingActions {\r\n\t[key: string]: number;\r\n}\r\n\r\ninterface DashboardHeaderProps {\r\n\ttoggleSidebar: () => void;\r\n\tisAdmin?: boolean;\r\n\tunreadNotifications?: number;\r\n\tnotifications?: Notification[];\r\n\tpendingActions?: PendingActions;\r\n\tonReadAllNotifications?: () => void;\r\n\tvisibleInMobile?: boolean;\r\n}\r\n\r\n/**\r\n * Componente Header reutilizable para dashboards OPTIMIZADO\r\n */\r\nconst DashboardHeader: React.FC<DashboardHeaderProps> = ({\r\n\ttoggleSidebar,\r\n\tisAdmin = false,\r\n\tunreadNotifications: _unreadNotifications,\r\n\tnotifications: _notifications = [],\r\n\tpendingActions = {},\r\n\tonReadAllNotifications = () => {},\r\n\tvisibleInMobile = true,\r\n}) => {\r\n\tconst [isProfileMenuOpen, setIsProfileMenuOpen] = useState(false);\r\n\tconst [isNotificationModalOpen, setIsNotificationModalOpen] = useState(false);\r\n\tconst {user, logout} = useContext(AuthContext);\r\n\tconst {currentPageTitle} = useDashboard();\r\n\r\n\t// ✅ USAR EL HOOK UNIFICADO OPTIMIZADO - CORRECCIÓN PRINCIPAL\r\n\tconst {counters, loading: countersLoading} = useHeaderCounters();\r\n\tconst {forceRefresh} = useInvalidateCounters();\r\n\tconst {markAllAsRead} = useNotifications();\r\n\r\n\t// ✅ USAR EL CONTADOR DE NOTIFICACIONES DEL HOOK OPTIMIZADO\r\n\t// Ya no usar props, solo del hook que se conecta al backend\r\n\tconst finalUnreadNotifications = counters.notificationCount;\r\n\r\n\tconsole.log(\"DashboardHeader: Contadores optimizados\", {\r\n\t\tfinalUnreadNotifications,\r\n\t\thookUnread: counters.notificationCount,\r\n\t\tisAdmin,\r\n\t\tloading: countersLoading,\r\n\t});\r\n\r\n\t// Calcular total de acciones pendientes\r\n\tconst totalPendingActions = Object.values(pendingActions).reduce(\r\n\t\t(total, value) => total + (value || 0),\r\n\t\t0\r\n\t);\r\n\r\n\tconst toggleProfileMenu = () => {\r\n\t\tsetIsProfileMenuOpen(!isProfileMenuOpen);\r\n\t};\r\n\r\n\tconst toggleNotificationModal = () => {\r\n\t\tsetIsNotificationModalOpen(!isNotificationModalOpen);\r\n\t};\r\n\r\n\t// Función mejorada para marcar todas las notificaciones como leídas\r\n\tconst handleMarkAllAsRead = async () => {\r\n\t\tconst success = await markAllAsRead();\r\n\t\tif (success) {\r\n\t\t\t// 🔥 TIEMPO REAL: Refrescar contadores del header\r\n\t\t\tawait forceRefresh();\r\n\t\t\tconsole.log(\"🔔 Header - Contadores actualizados después de marcar todas\");\r\n\t\t}\r\n\t\t// También ejecutar callback del prop si existe\r\n\t\tonReadAllNotifications();\r\n\t};\r\n\r\n\t// Obtener la inicial del nombre del usuario para el avatar\r\n\tconst getInitial = () => {\r\n\t\treturn user?.name?.charAt(0).toUpperCase() || (isAdmin ? \"A\" : \"U\");\r\n\t};\r\n\r\n\t// Cerrar menús al hacer clic fuera\r\n\tuseEffect(() => {\r\n\t\tconst handleClickOutside = (event: MouseEvent) => {\r\n\t\t\tconst target = event.target as Element;\r\n\r\n\t\t\tif (\r\n\t\t\t\t!target.closest(\".profile-menu\") &&\r\n\t\t\t\t!target.closest(\".profile-button\")\r\n\t\t\t) {\r\n\t\t\t\tsetIsProfileMenuOpen(false);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tdocument.addEventListener(\"mousedown\", handleClickOutside);\r\n\t\treturn () => {\r\n\t\t\tdocument.removeEventListener(\"mousedown\", handleClickOutside);\r\n\t\t};\r\n\t}, []);\r\n\r\n\t// Obtener el color del avatar basado en el rol\r\n\tconst getAvatarColor = () => {\r\n\t\treturn isAdmin\r\n\t\t\t? \"bg-red-100 text-red-600\"\r\n\t\t\t: \"bg-primary-100 text-primary-600\";\r\n\t};\r\n\r\n\treturn (\r\n\t\t<header className=\"bg-white shadow-sm z-20\">\r\n\t\t\t<div className=\"flex items-center justify-between px-4 py-3\">\r\n\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t{visibleInMobile && (\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName=\"md:hidden text-gray-600 focus:outline-none mr-3\"\r\n\t\t\t\t\t\t\tonClick={toggleSidebar}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Menu size={24} />\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{/* Indicador de acciones pendientes */}\r\n\t\t\t\t\t{totalPendingActions > 0 && (\r\n\t\t\t\t\t\t<div className=\"flex items-center mr-4\">\r\n\t\t\t\t\t\t\t<span className=\"bg-red-500 text-white text-sm font-medium rounded-md px-2 py-1 flex items-center\">\r\n\t\t\t\t\t\t\t\t<AlertTriangle size={16} className=\"mr-1\" />\r\n\t\t\t\t\t\t\t\t{totalPendingActions} acción\r\n\t\t\t\t\t\t\t\t{totalPendingActions === 1 ? \"\" : \"es\"} pendiente\r\n\t\t\t\t\t\t\t\t{totalPendingActions === 1 ? \"\" : \"s\"}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t<h1 className=\"text-lg font-medium text-gray-800 items-center\">\r\n\t\t\t\t\t\t{currentPageTitle}\r\n\t\t\t\t\t</h1>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div className=\"flex items-center space-x-4\">\r\n\t\t\t\t\t{/* Theme toggle */}\r\n\t\t\t\t\t<ThemeToggle />\r\n\r\n\t\t\t\t\t{/* Visit store / Ir a Tienda - Para administradores y sellers */}\r\n\t\t\t\t\t{(isAdmin || user?.role === 'seller') && (\r\n\t\t\t\t\t\t<a\r\n\t\t\t\t\t\t\thref=\"/\"\r\n\t\t\t\t\t\t\ttarget=\"\"\r\n\t\t\t\t\t\t\trel=\"noopener noreferrer\"\r\n\t\t\t\t\t\t\tclassName=\"text-gray-600 hover:text-gray-900\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<span className=\"text-sm\">{isAdmin ? 'Visitar Tienda' : 'Ir a Tienda'}</span>\r\n\t\t\t\t\t\t</a>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{/* 🎆 NOTIFICACIONES CON MODAL Y BOTÓN DIRECTO */}\r\n\t\t\t\t\t<div className=\"flex items-center space-x-2\">\r\n\t\t\t\t\t\t{/* Botón directo marcar todas como leídas */}\r\n\t\t\t\t\t\t{finalUnreadNotifications > 0 && (\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tonClick={handleMarkAllAsRead}\r\n\t\t\t\t\t\t\t\tclassName=\"text-xs text-primary-600 hover:text-primary-700 px-2 py-1 rounded-md hover:bg-primary-50 transition-colors\"\r\n\t\t\t\t\t\t\t\ttitle=\"Marcar todas como leídas\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tMarcar todas\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t{/* Botón de notificaciones */}\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName=\"text-gray-600 hover:text-gray-900 p-1 rounded-full relative transition-colors\"\r\n\t\t\t\t\t\t\tonClick={toggleNotificationModal}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Bell size={20} />\r\n\t\t\t\t\t\t\t{finalUnreadNotifications > 0 && (\r\n\t\t\t\t\t\t\t\t<span className=\"absolute top-0 right-0 transform translate-x-1/2 -translate-y-1/2 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center\">\r\n\t\t\t\t\t\t\t\t\t{finalUnreadNotifications > 9\r\n\t\t\t\t\t\t\t\t\t\t? \"9+\"\r\n\t\t\t\t\t\t\t\t\t\t: finalUnreadNotifications}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t{/* Indicador de loading para contadores */}\r\n\t\t\t\t\t\t\t{countersLoading && (\r\n\t\t\t\t\t\t\t\t<span className=\"absolute top-0 right-0 transform translate-x-1/2 -translate-y-1/2 bg-blue-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"w-2 h-2 bg-white rounded-full animate-pulse\"></div>\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* User Profile */}\r\n\t\t\t\t\t<div className=\"relative\">\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tclassName=\"profile-button flex items-center space-x-2 text-gray-800 focus:outline-none\"\r\n\t\t\t\t\t\t\tonClick={toggleProfileMenu}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tclassName={`h-8 w-8 rounded-full ${getAvatarColor()} flex items-center justify-center font-medium`}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{getInitial()}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<span className=\"hidden md:block font-medium\">\r\n\t\t\t\t\t\t\t\t{user?.name || (isAdmin ? \"Admin\" : \"Usuario\")}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t<ChevronDown size={18} className=\"hidden md:block\" />\r\n\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t{/* User Dropdown Menu */}\r\n\t\t\t\t\t\t{isProfileMenuOpen && (\r\n\t\t\t\t\t\t\t<div className=\"profile-menu absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg py-2 z-30 border border-gray-200\">\r\n\t\t\t\t\t\t\t\t<div className=\"px-4 py-3 border-b border-gray-200\">\r\n\t\t\t\t\t\t\t\t\t<p className=\"text-sm font-medium text-gray-800\">\r\n\t\t\t\t\t\t\t\t\t\t{user?.name || (isAdmin ? \"Admin\" : \"Usuario\")}\r\n\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-gray-500 truncate\">\r\n\t\t\t\t\t\t\t\t\t\t{user?.email ||\r\n\t\t\t\t\t\t\t\t\t\t\t(isAdmin ? \"admin@ejemplo.com\" : \"usuario@ejemplo.com\")}\r\n\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\t\tto={isAdmin ? \"/admin/profile\" : \"/seller/profile\"}\r\n\t\t\t\t\t\t\t\t\tclassName=\"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\r\n\t\t\t\t\t\t\t\t\tonClick={() => setIsProfileMenuOpen(false)}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t\t\t\t\t<User size={16} className=\"mr-2\" />\r\n\t\t\t\t\t\t\t\t\t\tMi Perfil\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</Link>\r\n\r\n\t\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\t\tto={isAdmin ? \"/admin/settings\" : \"/seller/settings\"}\r\n\t\t\t\t\t\t\t\t\tclassName=\"block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100\"\r\n\t\t\t\t\t\t\t\t\tonClick={() => setIsProfileMenuOpen(false)}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t\t\t\t\t<Settings size={16} className=\"mr-2\" />\r\n\t\t\t\t\t\t\t\t\t\tConfiguración\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</Link>\r\n\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tonClick={logout}\r\n\t\t\t\t\t\t\t\t\tclassName=\"block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-100\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t\t\t\t\t<LogOut size={16} className=\"mr-2\" />\r\n\t\t\t\t\t\t\t\t\t\tCerrar Sesión\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* ✅ MODAL DE NOTIFICACIONES */}\r\n\t\t\t<NotificationModal\r\n\t\t\t\tisOpen={isNotificationModalOpen}\r\n\t\t\t\tonClose={() => setIsNotificationModalOpen(false)}\r\n\t\t\t\tisAdmin={isAdmin}\r\n\t\t\t/>\r\n\t\t</header>\r\n\t);\r\n};\r\n\r\nexport default DashboardHeader;\r\n","import React from \"react\";\r\n\r\ninterface DashboardFooterProps {\r\n\t/**\r\n\t * Tipo de dashboard para mostrar texto apropiado\r\n\t */\r\n\ttype: \"admin\" | \"seller\" | \"customer\" | \"payment\";\r\n\r\n\t/**\r\n\t * Año actual (por defecto usa el año actual)\r\n\t */\r\n\tyear?: number;\r\n\r\n\t/**\r\n\t * Texto adicional opcional\r\n\t */\r\n\tadditionalText?: string;\r\n}\r\n\r\n/**\r\n * Componente Footer reutilizable para todos los dashboards\r\n */\r\nconst DashboardFooter: React.FC<DashboardFooterProps> = ({\r\n\ttype = \"admin\",\r\n\tyear = new Date().getFullYear(),\r\n\tadditionalText,\r\n}) => {\r\n\t// Determinar el texto según el tipo de dashboard\r\n\tconst getFooterText = () => {\r\n\t\tswitch (type) {\r\n\t\t\tcase \"admin\":\r\n\t\t\t\treturn \"Panel de Administración Comersia\";\r\n\t\t\tcase \"seller\":\r\n\t\t\t\treturn \"Portal de Vendedor Comersia\";\r\n\t\t\tcase \"customer\":\r\n\t\t\t\treturn \"Comersia\";\r\n\t\t\tcase \"payment\":\r\n\t\t\t\treturn \"Panel de Pagos Comersia\";\r\n\t\t\tdefault:\r\n\t\t\t\treturn \"Comersia\";\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<footer className=\"bg-white py-3 px-4 text-center text-sm text-gray-500 border-t border-gray-200\">\r\n\t\t\t<p>\r\n\t\t\t\t&copy; {year} {getFooterText()}.\r\n\t\t\t\t{additionalText\r\n\t\t\t\t\t? ` ${additionalText}`\r\n\t\t\t\t\t: \" Todos los derechos reservados.\"}\r\n\t\t\t</p>\r\n\t\t</footer>\r\n\t);\r\n};\r\n\r\nexport default DashboardFooter;\r\n","import type { ReactNode } from \"react\";\r\nimport {Outlet} from \"react-router-dom\";\r\nimport Sidebar from \"../dashboard/SideBar\";\r\nimport DashboardHeader from \"./DashboardHeader\";\r\nimport DashboardFooter from \"./DashboardFooter\";\r\nimport {useDashboard} from \"./DashboardContext\";\r\n\r\ninterface GroupItem {\r\n\ttitle: string;\r\n\tlinks: {\r\n\t\tpath: string;\r\n\t\tlabel: string;\r\n\t\ticon?: React.ReactNode;\r\n\t\tisNotificated?: boolean;\r\n\t\tnotificationCount?: number;\r\n\t}[];\r\n}\r\n\r\ninterface Title {\r\n\ttitle: string;\r\n\ticon: React.ReactNode;\r\n}\r\n\r\ninterface BaseDashboardLayoutProps {\r\n\t/**\r\n\t * Grupos de menú para el sidebar\r\n\t */\r\n\tsidebarGroups: GroupItem[];\r\n\r\n\t/**\r\n\t * Título del sidebar\r\n\t */\r\n\tsidebarTitle: Title;\r\n\r\n\t/**\r\n\t * Componentes adicionales para insertar después del header\r\n\t */\r\n\theaderExtras?: ReactNode;\r\n\r\n\t/**\r\n\t * Componentes adicionales para insertar antes del footer\r\n\t */\r\n\tfooterExtras?: ReactNode;\r\n}\r\n\r\n/**\r\n * Layout base para implementar en AdminLayout, SellerLayout y otros layouts de dashboard\r\n */\r\nconst BaseDashboardLayout: React.FC<BaseDashboardLayoutProps> = ({\r\n\tsidebarGroups,\r\n\tsidebarTitle,\r\n\theaderExtras,\r\n\tfooterExtras,\r\n}) => {\r\n\tconst {\r\n\t\tisSidebarOpen,\r\n\t\ttoggleSidebar,\r\n\t\tmarkAllNotificationsAsRead,\r\n\t\tpendingActions,\r\n\t\tdashboardType,\r\n\t} = useDashboard();\r\n\r\n\r\n\treturn (\r\n\t\t<div className=\"flex h-screen bg-gray-100\">\r\n\t\t\t{/* Sidebar */}\r\n\t\t\t<Sidebar\r\n\t\t\t\tgroups={sidebarGroups}\r\n\t\t\t\ttitle={sidebarTitle}\r\n\t\t\t\tisOpen={isSidebarOpen}\r\n\t\t\t\ttoggleSidebar={toggleSidebar}\r\n\t\t\t/>\r\n\r\n\t\t\t{/* Main Content */}\r\n\t\t\t<div className=\"flex-1 flex flex-col overflow-hidden\">\r\n\t\t\t\t{/* Header */}\r\n\t\t\t\t<DashboardHeader\r\n\t\t\t\t\ttoggleSidebar={toggleSidebar}\r\n\t\t\t\t\tisAdmin={dashboardType === \"admin\"}\r\n\t\t\t\t\tpendingActions={pendingActions}\r\n\t\t\t\t\tonReadAllNotifications={markAllNotificationsAsRead}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t{/* Header extras - componentes adicionales que pueden ser inyectados */}\r\n\t\t\t\t{headerExtras && headerExtras}\r\n\r\n\t\t\t\t{/* Main Content */}\r\n\t\t\t\t<main className=\"flex-1 overflow-y-auto bg-gray-50 p-4 md:p-6\">\r\n\t\t\t\t\t<Outlet />\r\n\t\t\t\t</main>\r\n\r\n\t\t\t\t{/* Footer extras - componentes adicionales que pueden ser inyectados */}\r\n\t\t\t\t{footerExtras && footerExtras}\r\n\r\n\t\t\t\t{/* Footer */}\r\n\t\t\t\t<DashboardFooter type={dashboardType} />\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default BaseDashboardLayout;\r\n"],"names":["DashboardContext","createContext","generateId","DashboardProvider","children","initialType","initialPageTitles","isSidebarOpen","setIsSidebarOpen","useState","dashboardType","notifications","setNotifications","unreadNotificationsCount","setUnreadNotificationsCount","pendingActions","setPendingActions","pageTitles","setPageTitles","location","useLocation","getCurrentPageTitle","pathname","path","title","useEffect","count","notification","toggleSidebar","prev","addNotification","newNotification","markAllNotificationsAsRead","markNotificationAsRead","id","setPendingAction","key","value","incrementPendingAction","decrementPendingAction","setPageTitle","jsx","useDashboard","context","useContext","SidebarLink","label","icon","isNotificated","notificationCount","jsxs","NavLink","isActive","Sidebar","groups","isOpen","X","group","index","link","linkIndex","getNotificationIcon","type","MessageCircle","Package","Truck","TrendingUp","Star","ShoppingCart","AlertTriangle","FileText","Gift","Shield","Ban","Bell","getNotificationUrl","isSeller","data","NotificationModal","onClose","isAdmin","activeMenu","setActiveMenu","roleInfo","useAuth","optimisticNotificationRead","forceRefresh","useInvalidateCounters","loading","error","unreadCount","fetchNotifications","markAsRead","markAllAsRead","deleteNotification","useNotifications","handleNotificationClick","useCallback","url","handleMarkAllAsRead","handleDelete","handleMarkAsRead","CheckCheck","formatRelativeTime","e","MoreVertical","Check","Trash2","Link","DashboardHeader","_unreadNotifications","_notifications","onReadAllNotifications","visibleInMobile","isProfileMenuOpen","setIsProfileMenuOpen","isNotificationModalOpen","setIsNotificationModalOpen","user","logout","AuthContext","currentPageTitle","counters","countersLoading","useHeaderCounters","finalUnreadNotifications","totalPendingActions","total","toggleProfileMenu","toggleNotificationModal","getInitial","handleClickOutside","event","target","getAvatarColor","Menu","ThemeToggle","ChevronDown","User","Settings","LogOut","DashboardFooter","year","additionalText","getFooterText","BaseDashboardLayout","sidebarGroups","sidebarTitle","headerExtras","footerExtras","Outlet"],"mappings":"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"}