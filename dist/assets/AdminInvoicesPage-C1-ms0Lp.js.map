{"version":3,"file":"AdminInvoicesPage-C1-ms0Lp.js","sources":["../../src/presentation/pages/admin/AdminInvoicesPage.tsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport Table from \"../../components/dashboard/Table\";\r\nimport {\r\n  FileText,\r\n  User,\r\n  Store,\r\n  Calendar,\r\n  DollarSign,\r\n  CheckCircle,\r\n  XCircle,\r\n  AlertTriangle,\r\n  RefreshCw,\r\n  Filter,\r\n  Eye,\r\n  Download,\r\n  ShoppingBag,\r\n  Clock,\r\n  Send,\r\n  X\r\n} from \"lucide-react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport type { Invoice } from \"../../../core/domain/entities/Invoice\";\r\nimport StatCardList from \"../../components/dashboard/StatCardList\";\r\n\r\n// Datos simulados para facturas\r\nconst mockInvoices: Invoice[] = [\r\n  {\r\n    id: 1,\r\n    invoiceNumber: \"INV-001-2023\",\r\n    orderId: 1001,\r\n    userId: 101,\r\n    sellerId: 201,\r\n    issueDate: \"2023-11-01T10:30:00Z\",\r\n    subtotal: 125.40,\r\n    taxAmount: 15.05,\r\n    totalAmount: 140.45,\r\n    status: \"AUTHORIZED\",\r\n    sriAuthorizationNumber: \"2311202301179123400110010010000000011234567816\",\r\n    sriAccessKey: \"2311202301179123400110010010000000011234567816\",\r\n    items: [\r\n      {\r\n        id: 1,\r\n        productId: 501,\r\n        description: \"Smartphone Samsung Galaxy A53\",\r\n        quantity: 1,\r\n        unitPrice: 120.99,\r\n        discount: 0,\r\n        taxRate: 12,\r\n        taxAmount: 14.52,\r\n        total: 135.51,\r\n        product: {\r\n          name: \"Smartphone Samsung Galaxy A53\",\r\n          image: \"samsung-a53.jpg\"\r\n        }\r\n      },\r\n      {\r\n        id: 2,\r\n        productId: 502,\r\n        description: \"Protector de pantalla\",\r\n        quantity: 1,\r\n        unitPrice: 4.41,\r\n        discount: 0,\r\n        taxRate: 12,\r\n        taxAmount: 0.53,\r\n        total: 4.94,\r\n        product: {\r\n          name: \"Protector de pantalla para Samsung Galaxy A53\",\r\n          image: \"screen-protector.jpg\"\r\n        }\r\n      }\r\n    ],\r\n    order: {\r\n      orderNumber: \"ORD-001-2023\",\r\n      createdAt: \"2023-11-01T09:15:00Z\"\r\n    },\r\n    user: {\r\n      name: \"Juan Pérez\",\r\n      email: \"juan.perez@example.com\"\r\n    },\r\n    seller: {\r\n      storeName: \"ElectroStore\"\r\n    }\r\n  },\r\n  {\r\n    id: 2,\r\n    invoiceNumber: \"INV-002-2023\",\r\n    orderId: 1002,\r\n    userId: 102,\r\n    sellerId: 202,\r\n    issueDate: \"2023-11-02T15:45:00Z\",\r\n    subtotal: 350.00,\r\n    taxAmount: 42.00,\r\n    totalAmount: 392.00,\r\n    status: \"ISSUED\",\r\n    items: [\r\n      {\r\n        id: 3,\r\n        productId: 601,\r\n        description: \"Laptop HP Pavilion\",\r\n        quantity: 1,\r\n        unitPrice: 350.00,\r\n        discount: 0,\r\n        taxRate: 12,\r\n        taxAmount: 42.00,\r\n        total: 392.00,\r\n        product: {\r\n          name: \"Laptop HP Pavilion 15-eg2xxx\",\r\n          image: \"hp-pavilion.jpg\"\r\n        }\r\n      }\r\n    ],\r\n    order: {\r\n      orderNumber: \"ORD-002-2023\",\r\n      createdAt: \"2023-11-02T14:30:00Z\"\r\n    },\r\n    user: {\r\n      name: \"María Rodríguez\",\r\n      email: \"maria.rodriguez@example.com\"\r\n    },\r\n    seller: {\r\n      storeName: \"TechWorld\"\r\n    }\r\n  },\r\n  {\r\n    id: 3,\r\n    invoiceNumber: \"INV-003-2023\",\r\n    orderId: 1003,\r\n    userId: 103,\r\n    sellerId: 203,\r\n    issueDate: \"2023-11-03T09:20:00Z\",\r\n    subtotal: 75.00,\r\n    taxAmount: 9.00,\r\n    totalAmount: 84.00,\r\n    status: \"AUTHORIZED\",\r\n    sriAuthorizationNumber: \"2311202301179123400110010010000000031234567811\",\r\n    sriAccessKey: \"2311202301179123400110010010000000031234567811\",\r\n    items: [\r\n      {\r\n        id: 4,\r\n        productId: 701,\r\n        description: \"Zapatillas deportivas Nike Air\",\r\n        quantity: 1,\r\n        unitPrice: 75.00,\r\n        discount: 0,\r\n        taxRate: 12,\r\n        taxAmount: 9.00,\r\n        total: 84.00,\r\n        product: {\r\n          name: \"Zapatillas Nike Air Max\",\r\n          image: \"nike-air.jpg\"\r\n        }\r\n      }\r\n    ],\r\n    order: {\r\n      orderNumber: \"ORD-003-2023\",\r\n      createdAt: \"2023-11-03T08:45:00Z\"\r\n    },\r\n    user: {\r\n      name: \"Carlos Sánchez\",\r\n      email: \"carlos.sanchez@example.com\"\r\n    },\r\n    seller: {\r\n      storeName: \"SportFashion\"\r\n    }\r\n  },\r\n  {\r\n    id: 4,\r\n    invoiceNumber: \"INV-004-2023\",\r\n    orderId: 1004,\r\n    userId: 104,\r\n    sellerId: 204,\r\n    issueDate: \"2023-11-04T16:30:00Z\",\r\n    subtotal: 220.00,\r\n    taxAmount: 26.40,\r\n    totalAmount: 246.40,\r\n    status: \"CANCELLED\",\r\n    sriAuthorizationNumber: \"2311202301179123400110010010000000041234567817\",\r\n    sriAccessKey: \"2311202301179123400110010010000000041234567817\",\r\n    cancellationReason: \"Producto agotado\",\r\n    cancelledAt: \"2023-11-05T10:15:00Z\",\r\n    items: [\r\n      {\r\n        id: 5,\r\n        productId: 801,\r\n        description: \"Smartwatch Apple Watch Series 7\",\r\n        quantity: 1,\r\n        unitPrice: 220.00,\r\n        discount: 0,\r\n        taxRate: 12,\r\n        taxAmount: 26.40,\r\n        total: 246.40,\r\n        product: {\r\n          name: \"Apple Watch Series 7\",\r\n          image: \"apple-watch.jpg\"\r\n        }\r\n      }\r\n    ],\r\n    order: {\r\n      orderNumber: \"ORD-004-2023\",\r\n      createdAt: \"2023-11-04T15:00:00Z\"\r\n    },\r\n    user: {\r\n      name: \"Ana Martínez\",\r\n      email: \"ana.martinez@example.com\"\r\n    },\r\n    seller: {\r\n      storeName: \"iPlace\"\r\n    }\r\n  },\r\n  {\r\n    id: 5,\r\n    invoiceNumber: \"INV-005-2023\",\r\n    orderId: 1005,\r\n    userId: 105,\r\n    sellerId: 205,\r\n    issueDate: \"2023-11-05T11:20:00Z\",\r\n    subtotal: 150.00,\r\n    taxAmount: 18.00,\r\n    totalAmount: 168.00,\r\n    status: \"REJECTED\",\r\n    sriResponse: {\r\n      errors: [\"Datos de identificación incorrectos\"],\r\n      status: \"REJECTED\",\r\n      timestamp: \"2023-11-05T11:25:00Z\"\r\n    },\r\n    items: [\r\n      {\r\n        id: 6,\r\n        productId: 901,\r\n        description: \"Auriculares Sony WH-1000XM4\",\r\n        quantity: 1,\r\n        unitPrice: 150.00,\r\n        discount: 0,\r\n        taxRate: 12,\r\n        taxAmount: 18.00,\r\n        total: 168.00,\r\n        product: {\r\n          name: \"Sony WH-1000XM4\",\r\n          image: \"sony-headphones.jpg\"\r\n        }\r\n      }\r\n    ],\r\n    order: {\r\n      orderNumber: \"ORD-005-2023\",\r\n      createdAt: \"2023-11-05T10:45:00Z\"\r\n    },\r\n    user: {\r\n      name: \"Javier García\",\r\n      email: \"javier.garcia@example.com\"\r\n    },\r\n    seller: {\r\n      storeName: \"AudioWorld\"\r\n    }\r\n  },\r\n  {\r\n    id: 6,\r\n    invoiceNumber: \"INV-006-2023\",\r\n    orderId: 1006,\r\n    userId: 106,\r\n    sellerId: 206,\r\n    issueDate: \"2023-11-06T13:40:00Z\",\r\n    subtotal: 89.99,\r\n    taxAmount: 10.80,\r\n    totalAmount: 100.79,\r\n    status: \"AUTHORIZED\",\r\n    sriAuthorizationNumber: \"2311202301179123400110010010000000061234567813\",\r\n    sriAccessKey: \"2311202301179123400110010010000000061234567813\",\r\n    items: [\r\n      {\r\n        id: 7,\r\n        productId: 1001,\r\n        description: \"Cafetera Nespresso Essenza Mini\",\r\n        quantity: 1,\r\n        unitPrice: 89.99,\r\n        discount: 0,\r\n        taxRate: 12,\r\n        taxAmount: 10.80,\r\n        total: 100.79,\r\n        product: {\r\n          name: \"Nespresso Essenza Mini\",\r\n          image: \"nespresso.jpg\"\r\n        }\r\n      }\r\n    ],\r\n    order: {\r\n      orderNumber: \"ORD-006-2023\",\r\n      createdAt: \"2023-11-06T12:30:00Z\"\r\n    },\r\n    user: {\r\n      name: \"Lucía Fernández\",\r\n      email: \"lucia.fernandez@example.com\"\r\n    },\r\n    seller: {\r\n      storeName: \"HomeAppliances\"\r\n    }\r\n  },\r\n  {\r\n    id: 7,\r\n    invoiceNumber: \"INV-007-2023\",\r\n    orderId: 1007,\r\n    userId: 107,\r\n    sellerId: 207,\r\n    issueDate: \"2023-11-07T09:50:00Z\",\r\n    subtotal: 45.50,\r\n    taxAmount: 5.46,\r\n    totalAmount: 50.96,\r\n    status: \"DRAFT\",\r\n    items: [\r\n      {\r\n        id: 8,\r\n        productId: 1101,\r\n        description: \"Libro 'El Señor de los Anillos'\",\r\n        quantity: 1,\r\n        unitPrice: 25.00,\r\n        discount: 0,\r\n        taxRate: 12,\r\n        taxAmount: 3.00,\r\n        total: 28.00,\r\n        product: {\r\n          name: \"El Señor de los Anillos - Edición Especial\",\r\n          image: \"lotr-book.jpg\"\r\n        }\r\n      },\r\n      {\r\n        id: 9,\r\n        productId: 1102,\r\n        description: \"Libro 'Harry Potter y la Piedra Filosofal'\",\r\n        quantity: 1,\r\n        unitPrice: 20.50,\r\n        discount: 0,\r\n        taxRate: 12,\r\n        taxAmount: 2.46,\r\n        total: 22.96,\r\n        product: {\r\n          name: \"Harry Potter y la Piedra Filosofal\",\r\n          image: \"harry-potter.jpg\"\r\n        }\r\n      }\r\n    ],\r\n    order: {\r\n      orderNumber: \"ORD-007-2023\",\r\n      createdAt: \"2023-11-07T09:30:00Z\"\r\n    },\r\n    user: {\r\n      name: \"David López\",\r\n      email: \"david.lopez@example.com\"\r\n    },\r\n    seller: {\r\n      storeName: \"BookWorld\"\r\n    }\r\n  }\r\n];\r\n\r\n// Mapeo de estado para facturas\r\nconst invoiceStatusMap: Record<string, { label: string, color: string, icon: React.ReactNode }> = {\r\n  DRAFT: { \r\n    label: \"Borrador\", \r\n    color: \"bg-gray-100 text-gray-800\",\r\n    icon: <Clock className=\"w-3 h-3 mr-1\" />\r\n  },\r\n  ISSUED: { \r\n    label: \"Emitida\", \r\n    color: \"bg-blue-100 text-blue-800\",\r\n    icon: <FileText className=\"w-3 h-3 mr-1\" />\r\n  },\r\n  AUTHORIZED: { \r\n    label: \"Autorizada\", \r\n    color: \"bg-green-100 text-green-800\",\r\n    icon: <CheckCircle className=\"w-3 h-3 mr-1\" />\r\n  },\r\n  CANCELLED: { \r\n    label: \"Anulada\", \r\n    color: \"bg-orange-100 text-orange-800\",\r\n    icon: <XCircle className=\"w-3 h-3 mr-1\" />\r\n  },\r\n  REJECTED: { \r\n    label: \"Rechazada\", \r\n    color: \"bg-red-100 text-red-800\",\r\n    icon: <AlertTriangle className=\"w-3 h-3 mr-1\" />\r\n  }\r\n};\r\n\r\nconst AdminInvoicesPage: React.FC = () => {\r\n\tconst [invoices, setInvoices] = useState<Invoice[]>([]);\r\n\tconst [loading, setLoading] = useState(true);\r\n\tconst [statusFilter, setStatusFilter] = useState<string>(\"all\");\r\n\tconst [dateRangeFilter, setDateRangeFilter] = useState<{\r\n\t\tfrom: string;\r\n\t\tto: string;\r\n\t}>({\r\n\t\tfrom: \"\",\r\n\t\tto: \"\",\r\n\t});\r\n\tconst [amountFilter, setAmountFilter] = useState<{\r\n\t\tmin: string;\r\n\t\tmax: string;\r\n\t}>({\r\n\t\tmin: \"\",\r\n\t\tmax: \"\",\r\n\t});\r\n\tconst [pagination, setPagination] = useState({\r\n\t\tcurrentPage: 1,\r\n\t\ttotalPages: 1,\r\n\t\ttotalItems: 0,\r\n\t\titemsPerPage: 10,\r\n\t});\r\n\tconst [selectedInvoice, setSelectedInvoice] = useState<Invoice | null>(null);\r\n\tconst [showInvoiceModal, setShowInvoiceModal] = useState(false);\r\n\tconst [showPrintOptions, setShowPrintOptions] = useState(false);\r\n\tconst [_showDeleteConfirmation, setShowDeleteConfirmation] = useState(false);\r\n\r\n\t// Cargar datos\r\n\tuseEffect(() => {\r\n\t\tconst fetchInvoices = () => {\r\n\t\t\tsetLoading(true);\r\n\t\t\t// Simulación de llamada a API\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tsetInvoices(mockInvoices);\r\n\t\t\t\tsetPagination({\r\n\t\t\t\t\tcurrentPage: 1,\r\n\t\t\t\t\ttotalPages: 1,\r\n\t\t\t\t\ttotalItems: mockInvoices.length,\r\n\t\t\t\t\titemsPerPage: 10,\r\n\t\t\t\t});\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}, 500);\r\n\t\t};\r\n\r\n\t\tfetchInvoices();\r\n\t}, []);\r\n\r\n\t// Filtrar facturas\r\n\tconst filteredInvoices = invoices.filter((invoice) => {\r\n\t\t// Filtro por estado\r\n\t\tconst matchesStatus =\r\n\t\t\tstatusFilter === \"all\" || invoice.status === statusFilter;\r\n\r\n\t\t// Filtro por rango de fechas\r\n\t\tlet matchesDateRange = true;\r\n\t\tif (dateRangeFilter.from) {\r\n\t\t\tconst invoiceDate = new Date(invoice.issueDate);\r\n\t\t\tconst fromDate = new Date(dateRangeFilter.from);\r\n\t\t\tmatchesDateRange = invoiceDate >= fromDate;\r\n\t\t}\r\n\t\tif (dateRangeFilter.to && matchesDateRange) {\r\n\t\t\tconst invoiceDate = new Date(invoice.issueDate);\r\n\t\t\tconst toDate = new Date(dateRangeFilter.to);\r\n\t\t\t// Ajustar a final del día\r\n\t\t\ttoDate.setHours(23, 59, 59, 999);\r\n\t\t\tmatchesDateRange = invoiceDate <= toDate;\r\n\t\t}\r\n\r\n\t\t// Filtro por monto\r\n\t\tlet matchesAmount = true;\r\n\t\tif (amountFilter.min) {\r\n\t\t\tconst minAmount = parseFloat(amountFilter.min);\r\n\t\t\tmatchesAmount = invoice.totalAmount >= minAmount;\r\n\t\t}\r\n\t\tif (amountFilter.max && matchesAmount) {\r\n\t\t\tconst maxAmount = parseFloat(amountFilter.max);\r\n\t\t\tmatchesAmount = invoice.totalAmount <= maxAmount;\r\n\t\t}\r\n\r\n\t\treturn matchesStatus && matchesDateRange && matchesAmount;\r\n\t});\r\n\r\n\t// Abrir modal de factura\r\n\tconst openInvoiceModal = (invoice: Invoice) => {\r\n\t\tsetSelectedInvoice(invoice);\r\n\t\tsetShowInvoiceModal(true);\r\n\t\tsetShowPrintOptions(false);\r\n\t};\r\n\r\n\t// Cerrar modal\r\n\tconst closeInvoiceModal = () => {\r\n\t\tsetShowInvoiceModal(false);\r\n\t\tsetSelectedInvoice(null);\r\n\t\tsetShowPrintOptions(false);\r\n\t\tsetShowDeleteConfirmation(false);\r\n\t};\r\n\r\n\t// Formatear fecha\r\n\tconst formatDate = (dateString: string | undefined) => {\r\n\t\tif (!dateString) return \"N/A\";\r\n\r\n\t\tconst date = new Date(dateString);\r\n\t\treturn new Intl.DateTimeFormat(\"es-ES\", {\r\n\t\t\tday: \"2-digit\",\r\n\t\t\tmonth: \"2-digit\",\r\n\t\t\tyear: \"numeric\",\r\n\t\t\thour: \"2-digit\",\r\n\t\t\tminute: \"2-digit\",\r\n\t\t}).format(date);\r\n\t};\r\n\r\n\t// Formatear moneda\r\n\tconst formatCurrency = (amount: number) => {\r\n\t\treturn new Intl.NumberFormat(\"es-EC\", {\r\n\t\t\tstyle: \"currency\",\r\n\t\t\tcurrency: \"USD\",\r\n\t\t\tminimumFractionDigits: 2,\r\n\t\t}).format(amount);\r\n\t};\r\n\r\n\t// Descargar factura\r\n\tconst downloadInvoice = (invoiceId: number, format: \"pdf\" | \"xml\") => {\r\n\t\t// En una aplicación real, se redirigiría a la API para descargar\r\n\t\talert(\r\n\t\t\t`Descargando factura #${invoiceId} en formato ${format.toUpperCase()}`\r\n\t\t);\r\n\r\n\t\tif (showPrintOptions) {\r\n\t\t\tsetShowPrintOptions(false);\r\n\t\t}\r\n\t};\r\n\r\n\t// Enviar factura por correo electrónico\r\n\tconst sendInvoiceByEmail = (invoiceId: number) => {\r\n\t\talert(`Enviando factura #${invoiceId} por correo electrónico al cliente`);\r\n\r\n\t\tif (showPrintOptions) {\r\n\t\t\tsetShowPrintOptions(false);\r\n\t\t}\r\n\t};\r\n\r\n\t// Anular factura\r\n\tconst cancelInvoice = (invoiceId: number) => {\r\n\t\t// En una aplicación real, se enviaría una solicitud a la API\r\n\t\tconst reason = prompt(\"¿Cuál es el motivo de la anulación?\");\r\n\r\n\t\tif (reason) {\r\n\t\t\tsetInvoices((prevInvoices) =>\r\n\t\t\t\tprevInvoices.map((invoice) =>\r\n\t\t\t\t\tinvoice.id === invoiceId\r\n\t\t\t\t\t\t? {\r\n\t\t\t\t\t\t\t\t...invoice,\r\n\t\t\t\t\t\t\t\tstatus: \"CANCELLED\",\r\n\t\t\t\t\t\t\t\tcancellationReason: reason,\r\n\t\t\t\t\t\t\t\tcancelledAt: new Date().toISOString(),\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t: invoice\r\n\t\t\t\t)\r\n\t\t\t);\r\n\r\n\t\t\talert(`Factura #${invoiceId} anulada con éxito.`);\r\n\t\t\tcloseInvoiceModal();\r\n\t\t}\r\n\t};\r\n\r\n\t// Autorizar factura (SRI)\r\n\tconst authorizeInvoice = (invoiceId: number) => {\r\n\t\t// En una aplicación real, se enviaría una solicitud a la API\r\n\t\tsetInvoices((prevInvoices) =>\r\n\t\t\tprevInvoices.map((invoice) =>\r\n\t\t\t\tinvoice.id === invoiceId\r\n\t\t\t\t\t? {\r\n\t\t\t\t\t\t\t...invoice,\r\n\t\t\t\t\t\t\tstatus: \"AUTHORIZED\",\r\n\t\t\t\t\t\t\tsriAuthorizationNumber: `23112023011791234001100100100000000${invoiceId}1234567813`,\r\n\t\t\t\t\t\t\tsriAccessKey: `23112023011791234001100100100000000${invoiceId}1234567813`,\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t: invoice\r\n\t\t\t)\r\n\t\t);\r\n\r\n\t\talert(`Factura #${invoiceId} autorizada con éxito.`);\r\n\t\tcloseInvoiceModal();\r\n\t};\r\n\r\n\t// Manejar cambio de página\r\n\tconst handlePageChange = (page: number) => {\r\n\t\tsetPagination((prev) => ({...prev, currentPage: page}));\r\n\t\t// En una app real, aquí obtendrías los datos para la nueva página\r\n\t};\r\n\r\n\t// Refrescar datos\r\n\tconst refreshData = () => {\r\n\t\tsetLoading(true);\r\n\t\t// Simular recarga de datos\r\n\t\tsetTimeout(() => {\r\n\t\t\tsetLoading(false);\r\n\t\t}, 500);\r\n\t};\r\n\r\n\t// Definir columnas de la tabla\r\n\tconst columns = [\r\n\t\t{\r\n\t\t\tkey: \"invoice\",\r\n\t\t\theader: \"Factura\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (invoice: Invoice) => (\r\n\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t<div className=\"flex-shrink-0 h-10 w-10 bg-blue-100 rounded-lg flex items-center justify-center\">\r\n\t\t\t\t\t\t<FileText className=\"h-5 w-5 text-blue-600\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"ml-4\">\r\n\t\t\t\t\t\t<div className=\"text-sm font-medium text-gray-900\">\r\n\t\t\t\t\t\t\t{invoice.invoiceNumber}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"text-xs text-gray-500\">\r\n\t\t\t\t\t\t\tPedido: {invoice.order?.orderNumber || `#${invoice.orderId}`}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"client\",\r\n\t\t\theader: \"Cliente\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (invoice: Invoice) => (\r\n\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t<div className=\"flex-shrink-0 h-8 w-8 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden\">\r\n\t\t\t\t\t\t<User className=\"h-4 w-4 text-gray-500\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"ml-3\">\r\n\t\t\t\t\t\t<div className=\"text-sm font-medium text-gray-900\">\r\n\t\t\t\t\t\t\t{invoice.user?.name || `Usuario #${invoice.userId}`}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"text-xs text-gray-500\">\r\n\t\t\t\t\t\t\t{invoice.user?.email}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"seller\",\r\n\t\t\theader: \"Vendedor\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (invoice: Invoice) => (\r\n\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t<div className=\"flex-shrink-0 h-8 w-8 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden\">\r\n\t\t\t\t\t\t<Store className=\"h-4 w-4 text-gray-500\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"ml-3\">\r\n\t\t\t\t\t\t<div className=\"text-sm font-medium text-gray-900\">\r\n\t\t\t\t\t\t\t{invoice.seller?.storeName || `Vendedor #${invoice.sellerId}`}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"amount\",\r\n\t\t\theader: \"Monto\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (invoice: Invoice) => (\r\n\t\t\t\t<div className=\"text-sm font-medium text-gray-900\">\r\n\t\t\t\t\t{formatCurrency(invoice.totalAmount)}\r\n\t\t\t\t\t<div className=\"text-xs text-gray-500\">\r\n\t\t\t\t\t\tSubtotal: {formatCurrency(invoice.subtotal)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"text-xs text-gray-500\">\r\n\t\t\t\t\t\tIVA: {formatCurrency(invoice.taxAmount)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"date\",\r\n\t\t\theader: \"Fecha\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (invoice: Invoice) => (\r\n\t\t\t\t<div className=\"text-sm text-gray-500\">\r\n\t\t\t\t\t{formatDate(invoice.issueDate)}\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"status\",\r\n\t\t\theader: \"Estado\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (invoice: Invoice) => {\r\n\t\t\t\tconst status = invoiceStatusMap[invoice.status] || {\r\n\t\t\t\t\tlabel: invoice.status,\r\n\t\t\t\t\tcolor:\r\n\t\t\t\t\t\t\"bg-gray-100 text-gray-800\",\r\n\t\t\t\t\ticon: <AlertTriangle className=\"w-3 h-3 mr-1\" />,\r\n\t\t\t\t};\r\n\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\tclassName={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${status.color}`}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{status.icon}\r\n\t\t\t\t\t\t\t{status.label}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t{invoice.cancellationReason && (\r\n\t\t\t\t\t\t\t<div className=\"text-xs text-red-500 mt-1\">\r\n\t\t\t\t\t\t\t\tMotivo: {invoice.cancellationReason}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"actions\",\r\n\t\t\theader: \"Acciones\",\r\n\t\t\trender: (invoice: Invoice) => {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div className=\"flex justify-end space-x-2\">\r\n\t\t\t\t\t\t{/* Ver detalles */}\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={() => openInvoiceModal(invoice)}\r\n\t\t\t\t\t\t\tclassName=\"p-1 text-blue-600 hover:bg-blue-100 rounded-md\"\r\n\t\t\t\t\t\t\ttitle=\"Ver detalles\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Eye size={18} />\r\n\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t{/* Descargar */}\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={() => downloadInvoice(invoice.id || 0, \"pdf\")}\r\n\t\t\t\t\t\t\tclassName=\"p-1 text-green-600 hover:bg-green-100 rounded-md\"\r\n\t\t\t\t\t\t\ttitle=\"Descargar\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Download size={18} />\r\n\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t{/* Anular (solo si está en estado ISSUED o AUTHORIZED) */}\r\n\t\t\t\t\t\t{(invoice.status === \"ISSUED\" ||\r\n\t\t\t\t\t\t\tinvoice.status === \"AUTHORIZED\") && (\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tonClick={() => cancelInvoice(invoice.id || 0)}\r\n\t\t\t\t\t\t\t\tclassName=\"p-1 text-red-600 hover:bg-red-100 rounded-md\"\r\n\t\t\t\t\t\t\t\ttitle=\"Anular factura\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<XCircle size={18} />\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t},\r\n\t];\r\n\r\n\tconst flattenedInvoices = filteredInvoices.map((invoice) => ({\r\n\t\t...invoice,\r\n\t\t// Añade propiedades adicionales para búsqueda\r\n\t\tuserName: invoice.user?.name || \"\",\r\n\t\tsellerStoreName: invoice.seller?.storeName || \"\",\r\n\t}));\r\n\r\n\tconst statItems = [\r\n\t\t{ \r\n\t\t  title: \"Total\", \r\n\t\t  value: invoices.length, \r\n\t\t  description: \"Facturas\", \r\n\t\t  icon: FileText, \r\n\t\t  bgColor: \"bg-blue-50/20\", \r\n\t\t  textColor: \"text-blue-800\", \r\n\t\t  valueColor: \"text-blue-900\", \r\n\t\t  descriptionColor: \"text-blue-700\", \r\n\t\t  iconColor: \"text-blue-600\", \r\n\t\t},\r\n\t\t{ \r\n\t\t  title: \"Autorizadas\", \r\n\t\t  value: invoices.filter((i) => i.status === \"AUTHORIZED\").length, \r\n\t\t  description: \"En regla\", \r\n\t\t  icon: CheckCircle, \r\n\t\t  bgColor: \"bg-green-50/20\", \r\n\t\t  textColor: \"text-green-800\", \r\n\t\t  valueColor: \"text-green-900\", \r\n\t\t  descriptionColor: \"text-green-700\", \r\n\t\t  iconColor: \"text-green-600\", \r\n\t\t},\r\n\t\t{ \r\n\t\t  title: \"Pendientes\", \r\n\t\t  value: invoices.filter((i) => i.status === \"DRAFT\" || i.status === \"ISSUED\").length, \r\n\t\t  description: \"Requieren atención\", \r\n\t\t  icon: Clock, \r\n\t\t  bgColor: \"bg-yellow-50\", \r\n\t\t  textColor: \"text-yellow-800\", \r\n\t\t  valueColor: \"text-yellow-900\", \r\n\t\t  descriptionColor: \"text-yellow-700\", \r\n\t\t  iconColor: \"text-yellow-600\", \r\n\t\t},\r\n\t\t{ \r\n\t\t  title: \"Problemas\", \r\n\t\t  value: invoices.filter((i) => i.status === \"REJECTED\" || i.status === \"CANCELLED\").length, \r\n\t\t  description: \"Anuladas o rechazadas\", \r\n\t\t  icon: AlertTriangle, \r\n\t\t  bgColor: \"bg-red-50/20\", \r\n\t\t  textColor: \"text-red-800\", \r\n\t\t  valueColor: \"text-red-900\", \r\n\t\t  descriptionColor: \"text-red-700\", \r\n\t\t  iconColor: \"text-red-600\", \r\n\t\t}\r\n\t  ];\r\n\r\n\treturn (\r\n\t\t<div className=\"space-y-6\">\r\n\t\t\t<div className=\"flex justify-between items-center\">\r\n\t\t\t\t<h1 className=\"text-2xl font-bold text-gray-900\">\r\n\t\t\t\t\tGestión de Facturas\r\n\t\t\t\t</h1>\r\n\t\t\t\t<div className=\"flex space-x-2\">\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={refreshData}\r\n\t\t\t\t\t\tclassName=\"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<RefreshCw size={18} className=\"inline mr-2\" />\r\n\t\t\t\t\t\tActualizar\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Panel de estadísticas */}\r\n\t\t\t<StatCardList items={statItems} />\r\n\t\t\t\r\n\t\t\t{/* Filtros */}\r\n\t\t\t<div className=\"bg-white rounded-lg shadow-sm p-4\">\r\n\t\t\t\t<div className=\"flex flex-col md:flex-row gap-4\">\r\n\t\t\t\t\t{/* Filtro de Estado */}\r\n\t\t\t\t\t<div className=\"flex items-center space-x-2\">\r\n\t\t\t\t\t\t<Filter className=\"h-5 w-5 text-gray-500\" />\r\n\t\t\t\t\t\t<select\r\n\t\t\t\t\t\t\tclassName=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n\t\t\t\t\t\t\tvalue={statusFilter}\r\n\t\t\t\t\t\t\tonChange={(e) => setStatusFilter(e.target.value)}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<option value=\"all\">Todos los Estados</option>\r\n\t\t\t\t\t\t\t<option value=\"DRAFT\">Borrador</option>\r\n\t\t\t\t\t\t\t<option value=\"ISSUED\">Emitida</option>\r\n\t\t\t\t\t\t\t<option value=\"AUTHORIZED\">Autorizada</option>\r\n\t\t\t\t\t\t\t<option value=\"CANCELLED\">Anulada</option>\r\n\t\t\t\t\t\t\t<option value=\"REJECTED\">Rechazada</option>\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Filtro de Fecha */}\r\n\t\t\t\t\t<div className=\"flex items-center space-x-2\">\r\n\t\t\t\t\t\t<Calendar className=\"h-5 w-5 text-gray-500\" />\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"date\"\r\n\t\t\t\t\t\t\tclassName=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n\t\t\t\t\t\t\tvalue={dateRangeFilter.from}\r\n\t\t\t\t\t\t\tonChange={(e) =>\r\n\t\t\t\t\t\t\t\tsetDateRangeFilter({...dateRangeFilter, from: e.target.value})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tplaceholder=\"Desde\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"date\"\r\n\t\t\t\t\t\t\tclassName=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n\t\t\t\t\t\t\tvalue={dateRangeFilter.to}\r\n\t\t\t\t\t\t\tonChange={(e) =>\r\n\t\t\t\t\t\t\t\tsetDateRangeFilter({...dateRangeFilter, to: e.target.value})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tplaceholder=\"Hasta\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Filtro de Monto */}\r\n\t\t\t\t\t<div className=\"flex items-center space-x-2\">\r\n\t\t\t\t\t\t<DollarSign className=\"h-5 w-5 text-gray-500\" />\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\tclassName=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 w-24\"\r\n\t\t\t\t\t\t\tvalue={amountFilter.min}\r\n\t\t\t\t\t\t\tonChange={(e) =>\r\n\t\t\t\t\t\t\t\tsetAmountFilter({...amountFilter, min: e.target.value})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tplaceholder=\"Min $\"\r\n\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\tstep=\"0.01\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\tclassName=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 w-24\"\r\n\t\t\t\t\t\t\tvalue={amountFilter.max}\r\n\t\t\t\t\t\t\tonChange={(e) =>\r\n\t\t\t\t\t\t\t\tsetAmountFilter({...amountFilter, max: e.target.value})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tplaceholder=\"Max $\"\r\n\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\tstep=\"0.01\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Tabla de Facturas */}\r\n\t\t\t<Table\r\n\t\t\t\tdata={flattenedInvoices}\r\n\t\t\t\tcolumns={columns}\r\n\t\t\t\tsearchFields={[\"invoiceNumber\", \"userName\", \"sellerStoreName\"]}\r\n\t\t\t\tloading={loading}\r\n\t\t\t\temptyMessage=\"No se encontraron facturas\"\r\n\t\t\t\tpagination={{\r\n\t\t\t\t\tcurrentPage: pagination.currentPage,\r\n\t\t\t\t\ttotalPages: pagination.totalPages,\r\n\t\t\t\t\ttotalItems: pagination.totalItems,\r\n\t\t\t\t\titemsPerPage: pagination.itemsPerPage,\r\n\t\t\t\t\tonPageChange: handlePageChange,\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\r\n\t\t\t{/* Modal de Detalle de Factura */}\r\n\t\t\t{showInvoiceModal && selectedInvoice && (\r\n\t\t\t\t<div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\r\n\t\t\t\t\t<div className=\"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto\">\r\n\t\t\t\t\t\t<div className=\"px-6 py-4 border-b border-gray-200 flex justify-between items-center\">\r\n\t\t\t\t\t\t\t<h3 className=\"text-lg font-medium text-gray-900\">\r\n\t\t\t\t\t\t\t\tDetalle de Factura {selectedInvoice.invoiceNumber}\r\n\t\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tonClick={closeInvoiceModal}\r\n\t\t\t\t\t\t\t\tclassName=\"text-gray-400 hover:text-gray-500\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<X className=\"h-5 w-5\" />\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"p-6\">\r\n\t\t\t\t\t\t\t{/* Información de cabecera */}\r\n\t\t\t\t\t\t\t<div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6\">\r\n\t\t\t\t\t\t\t\t{/* Información general */}\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<h4 className=\"text-sm font-medium text-gray-500 mb-2\">\r\n\t\t\t\t\t\t\t\t\t\tInformación General\r\n\t\t\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t\t\t<div className=\"space-y-1 text-sm\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex justify-between\">\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-gray-600\">\r\n\t\t\t\t\t\t\t\t\t\t\t\tNúmero:\r\n\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{selectedInvoice.invoiceNumber}\r\n\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex justify-between\">\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-gray-600\">\r\n\t\t\t\t\t\t\t\t\t\t\t\tPedido:\r\n\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\t\t\t\t\tto={`/admin/orders/${selectedInvoice.orderId}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"font-medium text-primary-600 hover:text-primary-700\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{selectedInvoice.order?.orderNumber ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`#${selectedInvoice.orderId}`}\r\n\t\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex justify-between\">\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-gray-600\">\r\n\t\t\t\t\t\t\t\t\t\t\t\tFecha emisión:\r\n\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{formatDate(selectedInvoice.issueDate)}\r\n\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex justify-between\">\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-gray-600\">\r\n\t\t\t\t\t\t\t\t\t\t\t\tEstado:\r\n\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${invoiceStatusMap[selectedInvoice.status]?.color}`}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{invoiceStatusMap[selectedInvoice.status]?.icon}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{invoiceStatusMap[selectedInvoice.status]?.label}\r\n\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t{/* Información del cliente */}\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<h4 className=\"text-sm font-medium text-gray-500 mb-2\">\r\n\t\t\t\t\t\t\t\t\t\tCliente\r\n\t\t\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center mb-3\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex-shrink-0 h-8 w-8 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden\">\r\n\t\t\t\t\t\t\t\t\t\t\t<User className=\"h-4 w-4 text-gray-500\" />\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"ml-3\">\r\n\t\t\t\t\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\t\t\t\t\tto={`/admin/users/${selectedInvoice.userId}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"text-sm font-medium text-primary-600 hover:text-primary-700\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{selectedInvoice.user?.name ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`Usuario #${selectedInvoice.userId}`}\r\n\t\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<div className=\"space-y-1 text-sm pl-11\">\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-gray-600\">\r\n\t\t\t\t\t\t\t\t\t\t\t\tEmail:\r\n\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"ml-1 text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{selectedInvoice.user?.email}\r\n\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t{/* Información del vendedor */}\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<h4 className=\"text-sm font-medium text-gray-500 mb-2\">\r\n\t\t\t\t\t\t\t\t\t\tVendedor\r\n\t\t\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center mb-3\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex-shrink-0 h-8 w-8 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden\">\r\n\t\t\t\t\t\t\t\t\t\t\t<Store className=\"h-4 w-4 text-gray-500\" />\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"ml-3\">\r\n\t\t\t\t\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\t\t\t\t\tto={`/admin/sellers/${selectedInvoice.sellerId}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"text-sm font-medium text-primary-600 hover:text-primary-700\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{selectedInvoice.seller?.storeName ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t`Vendedor #${selectedInvoice.sellerId}`}\r\n\t\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t{/* Información SRI (si está autorizada) */}\r\n\t\t\t\t\t\t\t{selectedInvoice.status === \"AUTHORIZED\" &&\r\n\t\t\t\t\t\t\t\tselectedInvoice.sriAuthorizationNumber && (\r\n\t\t\t\t\t\t\t\t\t<div className=\"bg-green-50/20 p-4 rounded-lg mb-6\">\r\n\t\t\t\t\t\t\t\t\t\t<h4 className=\"text-sm font-medium text-green-800 mb-2 flex items-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t<CheckCircle className=\"h-4 w-4 mr-1\" />\r\n\t\t\t\t\t\t\t\t\t\t\tInformación de Autorización SRI\r\n\t\t\t\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-green-700\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tNúmero de Autorización:\r\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-green-900 font-mono break-all mt-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{selectedInvoice.sriAuthorizationNumber}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-green-700\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tClave de Acceso:\r\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-green-900 font-mono break-all mt-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{selectedInvoice.sriAccessKey}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{/* Información de rechazo (si fue rechazada) */}\r\n\t\t\t\t\t\t\t{selectedInvoice.status === \"REJECTED\" &&\r\n\t\t\t\t\t\t\t\tselectedInvoice.sriResponse && (\r\n\t\t\t\t\t\t\t\t\t<div className=\"bg-red-50/20 p-4 rounded-lg mb-6\">\r\n\t\t\t\t\t\t\t\t\t\t<h4 className=\"text-sm font-medium text-red-800 mb-2 flex items-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t<AlertTriangle className=\"h-4 w-4 mr-1\" />\r\n\t\t\t\t\t\t\t\t\t\t\tMotivo de Rechazo\r\n\t\t\t\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t<ul className=\"list-disc list-inside text-sm text-red-700 space-y-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{Array.isArray(selectedInvoice.sriResponse.errors) ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tselectedInvoice.sriResponse.errors.map(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t(error, idx) => <li key={idx}>{error}</li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<li>Error desconocido</li>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{/* Información de cancelación (si fue anulada) */}\r\n\t\t\t\t\t\t\t{selectedInvoice.status === \"CANCELLED\" &&\r\n\t\t\t\t\t\t\t\tselectedInvoice.cancellationReason && (\r\n\t\t\t\t\t\t\t\t\t<div className=\"bg-orange-50/20 p-4 rounded-lg mb-6\">\r\n\t\t\t\t\t\t\t\t\t\t<h4 className=\"text-sm font-medium text-orange-800 mb-2 flex items-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t<XCircle className=\"h-4 w-4 mr-1\" />\r\n\t\t\t\t\t\t\t\t\t\t\tInformación de Anulación\r\n\t\t\t\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-orange-700\">\r\n\t\t\t\t\t\t\t\t\t\t\t\tMotivo:\r\n\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-orange-900 mt-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{selectedInvoice.cancellationReason}\r\n\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t{selectedInvoice.cancelledAt && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"mt-2 text-xs text-orange-700\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tFecha de anulación:{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{formatDate(selectedInvoice.cancelledAt)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{/* Tabla de artículos */}\r\n\t\t\t\t\t\t\t<div className=\"mb-6\">\r\n\t\t\t\t\t\t\t\t<h4 className=\"text-sm font-medium text-gray-500 mb-2\">\r\n\t\t\t\t\t\t\t\t\tArtículos\r\n\t\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t\t<div className=\"overflow-x-auto\">\r\n\t\t\t\t\t\t\t\t\t<table className=\"min-w-full divide-y divide-gray-200\">\r\n\t\t\t\t\t\t\t\t\t\t<thead className=\"bg-gray-50\">\r\n\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<th\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tscope=\"col\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tDescripción\r\n\t\t\t\t\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<th\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tscope=\"col\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tCantidad\r\n\t\t\t\t\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<th\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tscope=\"col\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tPrecio Unit.\r\n\t\t\t\t\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<th\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tscope=\"col\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tIVA\r\n\t\t\t\t\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<th\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tscope=\"col\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tTotal\r\n\t\t\t\t\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t</thead>\r\n\t\t\t\t\t\t\t\t\t\t<tbody className=\"bg-white divide-y divide-gray-200\">\r\n\t\t\t\t\t\t\t\t\t\t\t{selectedInvoice.items.map((item) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<tr\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={item.id}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"hover:bg-gray-50\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{item.description}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{item.quantity}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatCurrency(item.unitPrice)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatCurrency(item.taxAmount)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatCurrency(item.total)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t\t\t\t\t\t<tfoot className=\"bg-gray-50\">\r\n\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<td\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolSpan={3}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"px-6 py-4 text-right text-sm font-medium text-gray-500\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tSubtotal:\r\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<td\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolSpan={2}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"px-6 py-4 text-sm text-gray-900\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{formatCurrency(selectedInvoice.subtotal)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<td\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolSpan={3}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"px-6 py-4 text-right text-sm font-medium text-gray-500\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tIVA (12%):\r\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<td\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolSpan={2}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"px-6 py-4 text-sm text-gray-900\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{formatCurrency(selectedInvoice.taxAmount)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<td\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolSpan={3}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"px-6 py-4 text-right text-sm font-medium text-gray-900\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tTotal:\r\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<td\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tcolSpan={2}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"px-6 py-4 text-sm font-bold text-gray-900\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{formatCurrency(selectedInvoice.totalAmount)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t\t</tfoot>\r\n\t\t\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t{/* Acciones */}\r\n\t\t\t\t\t\t\t<div className=\"flex flex-wrap justify-end gap-2 mt-6\">\r\n\t\t\t\t\t\t\t\t{/* Opción para imprimir/descargar */}\r\n\t\t\t\t\t\t\t\t<div className=\"relative\">\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => setShowPrintOptions(!showPrintOptions)}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors flex items-center\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<Download className=\"h-4 w-4 mr-2\" />\r\n\t\t\t\t\t\t\t\t\t\tDescargar/Imprimir\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t{showPrintOptions && (\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-10\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"py-1\"\r\n\t\t\t\t\t\t\t\t\t\t\t\trole=\"menu\"\r\n\t\t\t\t\t\t\t\t\t\t\t\taria-orientation=\"vertical\"\r\n\t\t\t\t\t\t\t\t\t\t\t\taria-labelledby=\"options-menu\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdownloadInvoice(selectedInvoice.id || 0, \"pdf\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\trole=\"menuitem\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<FileText className=\"h-4 w-4 mr-2 text-gray-500\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tDescargar PDF\r\n\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdownloadInvoice(selectedInvoice.id || 0, \"xml\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\trole=\"menuitem\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<FileText className=\"h-4 w-4 mr-2 text-gray-500\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tDescargar XML\r\n\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsendInvoiceByEmail(selectedInvoice.id || 0)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 w-full text-left\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\trole=\"menuitem\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Send className=\"h-4 w-4 mr-2 text-gray-500\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tEnviar por email\r\n\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t{/* Anular factura (solo si está en ISSUED o AUTHORIZED) */}\r\n\t\t\t\t\t\t\t\t{(selectedInvoice.status === \"ISSUED\" ||\r\n\t\t\t\t\t\t\t\t\tselectedInvoice.status === \"AUTHORIZED\") && (\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => cancelInvoice(selectedInvoice.id || 0)}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<XCircle className=\"h-4 w-4 mr-2\" />\r\n\t\t\t\t\t\t\t\t\t\tAnular Factura\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t{/* Autorizar factura (solo si está en ISSUED) */}\r\n\t\t\t\t\t\t\t\t{selectedInvoice.status === \"ISSUED\" && (\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => authorizeInvoice(selectedInvoice.id || 0)}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<CheckCircle className=\"h-4 w-4 mr-2\" />\r\n\t\t\t\t\t\t\t\t\t\tAutorizar SRI\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t{/* Ver orden relacionada */}\r\n\t\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\t\tto={`/admin/orders/${selectedInvoice.orderId}`}\r\n\t\t\t\t\t\t\t\t\tclassName=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<ShoppingBag className=\"h-4 w-4 mr-2\" />\r\n\t\t\t\t\t\t\t\t\tVer Orden\r\n\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default AdminInvoicesPage;"],"names":["mockInvoices","invoiceStatusMap","jsx","Clock","FileText","CheckCircle","XCircle","AlertTriangle","AdminInvoicesPage","invoices","setInvoices","useState","loading","setLoading","statusFilter","setStatusFilter","dateRangeFilter","setDateRangeFilter","amountFilter","setAmountFilter","pagination","setPagination","selectedInvoice","setSelectedInvoice","showInvoiceModal","setShowInvoiceModal","showPrintOptions","setShowPrintOptions","_showDeleteConfirmation","setShowDeleteConfirmation","useEffect","filteredInvoices","invoice","matchesStatus","matchesDateRange","invoiceDate","fromDate","toDate","matchesAmount","minAmount","maxAmount","openInvoiceModal","closeInvoiceModal","formatDate","dateString","date","formatCurrency","amount","downloadInvoice","invoiceId","format","sendInvoiceByEmail","cancelInvoice","reason","prevInvoices","authorizeInvoice","handlePageChange","page","prev","refreshData","columns","jsxs","User","Store","status","Eye","Download","flattenedInvoices","statItems","i","RefreshCw","StatCardList","Filter","e","Calendar","DollarSign","Table","X","Link","error","idx","item","Send","ShoppingBag"],"mappings":"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"}