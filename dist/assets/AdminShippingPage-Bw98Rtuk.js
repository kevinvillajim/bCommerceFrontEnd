import{j as e,R as Q,F as Z,H as G,J as E,a as V,T as O,e as J,P as k,ao as M,aR as H,g as z,aM as L,K as ee,h as se,E as te}from"./ui-vendor-DEBjJ4HS.js";import{r as d,L as P}from"./react-vendor-Cy458wKG.js";import{c as _,A,T as ae,f as U}from"./admin-chunk-C7Ad4l4I.js";class re{async getShippings(s={}){try{console.log("AdminShippingService: Obteniendo envíos con filtros:",s);const a=await _.get(A.ADMIN.SHIPPING_LIST,s);if(!a||!a.data)return{shippings:[],pagination:{currentPage:1,totalPages:1,totalItems:0,itemsPerPage:10}};const r=Array.isArray(a.data)?a.data.map(x=>this.mapShippingToModel(x)):[],c=a.pagination||{currentPage:1,totalPages:1,totalItems:r.length,itemsPerPage:10};return{shippings:r,pagination:{currentPage:Number(c.currentPage)||1,totalPages:Number(c.totalPages)||1,totalItems:Number(c.totalItems)||r.length,itemsPerPage:Number(c.itemsPerPage)||10}}}catch(a){return console.error("AdminShippingService: Error al obtener envíos:",a),{shippings:[],pagination:{currentPage:1,totalPages:1,totalItems:0,itemsPerPage:10}}}}async getShippingDetail(s){try{console.log(`AdminShippingService: Obteniendo detalles de orden ${s}`);const a=await _.get(A.ADMIN.ORDER_DETAIL(s));if(!a||!a.data)throw new Error("No se pudo obtener los detalles de la orden");return this.mapOrderToShipping(a.data)}catch(a){return console.error(`AdminShippingService: Error al obtener detalles de orden ${s}:`,a),null}}async getShippingHistory(s){try{console.log(`AdminShippingService: Obteniendo historial de envío ${s}`);const a=await _.get(A.SHIPPING.HISTORY(s));return!a||!a.data?[]:Array.isArray(a.data)?a.data.map((c,x)=>({id:c.id||x+1,status:c.status||"",location:typeof c.location=="object"?c.location.address||"":c.location||"",timestamp:c.timestamp||"",description:c.details||c.description||""})):[]}catch(a){return console.error(`AdminShippingService: Error al obtener historial de envío ${s}:`,a),[]}}async updateShippingStatus(s,a){try{console.log(`AdminShippingService: Actualizando estado de orden ${s} a ${a}`);const r=await _.put(A.ADMIN.UPDATE_ORDER_STATUS(s),{status:a});return!!(r&&(r.success===!0||r.status==="success"))}catch(r){return console.error(`AdminShippingService: Error al actualizar estado de orden ${s}:`,r),!1}}async advanceShippingStatus(s,a){try{console.log(`AdminShippingService: Avanzando estado de orden ${s}`);const r=this.getNextStatus(a),c=await _.put(A.ADMIN.UPDATE_ORDER_STATUS(s),{status:r});return!!(c&&(c.success===!0||c.status==="success"))}catch(r){return console.error(`AdminShippingService: Error al avanzar estado de orden ${s}:`,r),!1}}async sendTrackingNotification(s){try{return console.log(`AdminShippingService: Enviando notificación para orden ${s}`),!0}catch(a){return console.error(`AdminShippingService: Error al enviar notificación ${s}:`,a),!1}}mapOrderToShipping(s){const a=s.shipping_data||{};let r="pending";return s.status==="shipped"||s.status==="in_transit"?r="in_transit":s.status==="delivered"?r="delivered":s.status==="cancelled"?r="cancelled":s.status==="completed"&&(r="delivered"),{id:s.id||0,trackingNumber:a.tracking_number||`ORD-${s.id||0}`,orderId:s.id||0,orderNumber:s.order_number||`ORD-${s.id||0}`,userId:s.user_id||0,customerName:s.user_name||"Cliente",status:r,carrier:a.shipping_company||"Transportista por defecto",estimatedDeliveryDate:a.estimated_delivery,shippedDate:s.status==="shipped"?s.updated_at:void 0,deliveredDate:s.status==="delivered"?s.updated_at:void 0,address:{street:a.address||"",city:a.city||"",state:a.state||"",country:a.country||"",postalCode:a.postal_code||"",phone:a.phone||""},weight:a.weight||0,dimensions:a.dimensions||"",trackingHistory:[],createdAt:s.created_at||new Date().toISOString(),updatedAt:s.updated_at||new Date().toISOString()}}getNextStatus(s){return{pending:"processing",processing:"shipped",shipped:"in_transit",in_transit:"delivered",delivered:"completed"}[s]||"processing"}mapShippingToModel(s){return{id:s.id||0,trackingNumber:s.tracking_number||"",orderId:s.order_id||0,orderNumber:s.order?.order_number||`ORD-${s.order_id||0}`,userId:s.user_id||0,customerName:s.user_name||"Cliente",status:s.status||"pending",carrier:s.carrier_name||"Transportista por defecto",estimatedDeliveryDate:s.estimated_delivery,shippedDate:s.shipped_date,deliveredDate:s.delivered_at,address:this.extractAddressFromShipping(s),weight:s.weight||0,dimensions:s.dimensions||"",trackingHistory:s.history||[],createdAt:s.created_at||new Date().toISOString(),updatedAt:s.updated_at||new Date().toISOString()}}extractAddressFromShipping(s){const a={street:"",city:"",state:"",country:"",postalCode:"",phone:""};if(s.current_location){const r=typeof s.current_location=="string"?JSON.parse(s.current_location):s.current_location;r.address&&(a.street=r.address)}if(s.order&&s.order.shipping_data){const r=typeof s.order.shipping_data=="string"?JSON.parse(s.order.shipping_data):s.order.shipping_data;r&&(a.city=r.city||"",a.state=r.state||"",a.country=r.country||"",a.postalCode=r.postal_code||"",a.phone=r.phone||"")}return a}}const ie=()=>{const s=d.useRef(new re).current,[a,r]=d.useState([]),[c,x]=d.useState(null),[T,o]=d.useState(!1),[v,p]=d.useState(null),[R,N]=d.useState(!1),[j,I]=d.useState("all"),[f,D]=d.useState("all"),[g,F]=d.useState({from:"",to:""}),[m,$]=d.useState(""),[h,S]=d.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:10}),w=d.useRef(!1),t=d.useRef(!1),n=d.useCallback(async()=>{if(!t.current){o(!0),t.current=!0,p(null);try{const i={page:h.currentPage,limit:h.itemsPerPage};j!=="all"&&(i.status=j),f!=="all"&&(i.carrier=f),g.from&&(i.dateFrom=g.from),g.to&&(i.dateTo=g.to),m&&(i.search=m);const l=await s.getShippings(i);r(l.shippings),S(l.pagination)}catch(i){console.error("Error al obtener envíos:",i),p(i instanceof Error?i.message:"Error al cargar envíos")}finally{o(!1),t.current=!1}}},[s,h.currentPage,h.itemsPerPage,j,f,g.from,g.to,m]),b=d.useCallback(async i=>{o(!0);try{if(i.trackingHistory&&i.trackingHistory.length>0){x(i),N(!0),o(!1);return}const l=await s.getShippingDetail(i.id);if(l){let u=[];l.trackingNumber&&(u=await s.getShippingHistory(l.trackingNumber));const q={...l,trackingHistory:u};x(q)}else x(i);N(!0)}catch(l){console.error(`Error al obtener detalles del envío ${i.id}:`,l),p(l instanceof Error?l.message:"Error al cargar detalles del envío"),x(i),N(!0)}finally{o(!1)}},[s]),W=d.useCallback(async(i,l)=>{o(!0);try{return await s.updateShippingStatus(i,l)?(await n(),!0):!1}catch(u){return console.error(`Error al actualizar estado del envío ${i}:`,u),p(u instanceof Error?u.message:"Error al actualizar estado"),!1}finally{o(!1)}},[s,n]),B=d.useCallback(async(i,l)=>{o(!0);try{return await s.advanceShippingStatus(i,l)?(await n(),!0):!1}catch(u){return console.error(`Error al avanzar estado del envío ${i}:`,u),p(u instanceof Error?u.message:"Error al avanzar estado"),!1}finally{o(!1)}},[s,n]),K=d.useCallback(async i=>{o(!0);try{return await s.sendTrackingNotification(i)?(alert("Notificación enviada correctamente"),!0):!1}catch(l){return console.error(`Error al enviar notificación para ${i}:`,l),p(l instanceof Error?l.message:"Error al enviar notificación"),!1}finally{o(!1)}},[s]),X=d.useCallback(i=>{S(l=>({...l,currentPage:i}))},[]),Y=d.useCallback(()=>{n()},[n]);return d.useEffect(()=>{if(!w.current)return;const i=setTimeout(()=>{n()},300);return()=>clearTimeout(i)},[n,h.currentPage,j,f]),d.useEffect(()=>{w.current||(n(),w.current=!0)},[n]),{adminShippings:a,selectedAdminShipping:c,loading:T,error:v,showTrackingModal:R,statusFilter:j,carrierFilter:f,dateRangeFilter:g,searchTerm:m,pagination:h,setStatusFilter:I,setCarrierFilter:D,setDateRangeFilter:F,setSearchTerm:$,setShowTrackingModal:N,fetchAdminShippings:n,fetchAdminShippingDetail:b,updateAdminShippingStatus:W,advanceAdminShippingStatus:B,sendAdminTrackingNotification:K,handleAdminPageChange:X,refreshAdminData:Y}},y={pending:{label:"Pendiente",color:"bg-yellow-100 text-yellow-800",icon:e.jsx(J,{className:"w-3 h-3 mr-1"})},processing:{label:"En preparación",color:"bg-blue-100 text-blue-800",icon:e.jsx(k,{className:"w-3 h-3 mr-1"})},ready_to_ship:{label:"Listo para enviar",color:"bg-purple-100 text-purple-800",icon:e.jsx(k,{className:"w-3 h-3 mr-1"})},shipped:{label:"Enviado",color:"bg-indigo-100 text-indigo-800",icon:e.jsx(E,{className:"w-3 h-3 mr-1"})},in_transit:{label:"En tránsito",color:"bg-indigo-100 text-indigo-800",icon:e.jsx(E,{className:"w-3 h-3 mr-1"})},out_for_delivery:{label:"En reparto",color:"bg-green-100 text-green-800",icon:e.jsx(E,{className:"w-3 h-3 mr-1"})},delivered:{label:"Entregado",color:"bg-emerald-100 text-emerald-800",icon:e.jsx(V,{className:"w-3 h-3 mr-1"})},failed_delivery:{label:"Entrega fallida",color:"bg-red-100 text-red-800",icon:e.jsx(O,{className:"w-3 h-3 mr-1"})},returned:{label:"Devuelto",color:"bg-orange-100 text-orange-800",icon:e.jsx(H,{className:"w-3 h-3 mr-1 transform rotate-180"})},cancelled:{label:"Cancelado",color:"bg-gray-100 text-gray-800",icon:e.jsx(G,{className:"w-3 h-3 mr-1"})}},ne=[{id:"MRW",name:"MRW"},{id:"SEUR",name:"SEUR"},{id:"Correos Express",name:"Correos Express"},{id:"DHL",name:"DHL"},{id:"FedEx",name:"FedEx"},{id:"UPS",name:"UPS"},{id:"GLS",name:"GLS"}],oe=()=>{const{adminShippings:C,selectedAdminShipping:s,loading:a,error:r,showTrackingModal:c,statusFilter:x,carrierFilter:T,dateRangeFilter:o,pagination:v,setStatusFilter:p,setCarrierFilter:R,setDateRangeFilter:N,setShowTrackingModal:j,fetchAdminShippingDetail:I,advanceAdminShippingStatus:f,sendAdminTrackingNotification:D,handleAdminPageChange:g,refreshAdminData:F}=ie(),m=t=>{if(!t)return"N/A";const n=new Date(t);return new Intl.DateTimeFormat("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(n)},$=t=>{I(t)},h=()=>{j(!1)},S=t=>({pending:"processing",processing:"ready_to_ship",ready_to_ship:"shipped",shipped:"in_transit",in_transit:"out_for_delivery",out_for_delivery:"delivered",delivered:"delivered",failed_delivery:"out_for_delivery",returned:"returned",cancelled:"cancelled"})[t]||t,w=[{key:"tracking",header:"Seguimiento",sortable:!0,render:t=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-lg bg-indigo-100 flex items-center justify-center",children:e.jsx(E,{className:"h-6 w-6 text-indigo-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.trackingNumber}),e.jsxs("div",{className:"text-xs text-gray-500 flex items-center",children:[e.jsx(ee,{className:"w-3 h-3 mr-1"}),m(t.createdAt)]})]})]})},{key:"order",header:"Pedido",sortable:!0,render:t=>e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{className:"h-4 w-4 text-gray-500 mr-1"}),e.jsx(P,{to:`/admin/orders/${t.orderId}`,className:"text-primary-600 hover:text-primary-800",children:t.orderNumber})]})},{key:"customer",header:"Cliente",sortable:!0,render:t=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-gray-200 flex items-center justify-center",children:e.jsx(se,{className:"h-4 w-4 text-gray-500"})}),e.jsxs("div",{className:"ml-3",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.customerName}),e.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",t.userId]})]})]})},{key:"address",header:"Dirección",render:t=>e.jsxs("div",{className:"flex items-start",children:[e.jsx(M,{className:"h-4 w-4 text-gray-500 mr-1 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-xs text-gray-600",children:[e.jsx("div",{children:t.address.street}),e.jsxs("div",{children:[t.address.city,", ",t.address.state]}),e.jsxs("div",{children:[t.address.postalCode,", ",t.address.country]})]})]})},{key:"carrier",header:"Transportista",sortable:!0,render:t=>e.jsx("div",{className:"text-sm font-medium",children:t.carrier})},{key:"status",header:"Estado",sortable:!0,render:t=>{const n=y[t.status]||{label:t.status,color:"bg-gray-100 text-gray-800",icon:e.jsx(O,{className:"w-3 h-3 mr-1"})};return e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${n.color}`,children:[n.icon,n.label]})}},{key:"dates",header:"Fechas clave",render:t=>e.jsxs("div",{className:"text-xs text-gray-600",children:[t.shippedDate&&e.jsxs("div",{className:"mb-1",children:[e.jsx("span",{className:"font-medium",children:"Envío:"})," ",m(t.shippedDate)]}),t.estimatedDeliveryDate&&e.jsxs("div",{className:"mb-1",children:[e.jsx("span",{className:"font-medium",children:"Est. entrega:"})," ",m(t.estimatedDeliveryDate)]}),t.deliveredDate&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Entregado:"})," ",m(t.deliveredDate)]})]})},{key:"actions",header:"Acciones",render:t=>{const n=["pending","processing","ready_to_ship","shipped","in_transit","out_for_delivery","failed_delivery"].includes(t.status);return e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx("button",{onClick:()=>$(t),className:"p-1 text-blue-600 hover:bg-blue-100 rounded-md",title:"Ver seguimiento",children:e.jsx(te,{size:18})}),e.jsx(P,{to:`/admin/orders/${t.orderId}`,className:"p-1 text-purple-600 hover:bg-purple-100 rounded-md",title:"Ver pedido",children:e.jsx(z,{size:18})}),e.jsx("button",{onClick:()=>D(t.id),className:"p-1 text-indigo-600 hover:bg-indigo-100 rounded-md",title:"Enviar notificación",children:e.jsx(L,{size:18})}),n&&e.jsx("button",{onClick:()=>f(t.id,t.status),className:"p-1 text-green-600 hover:bg-green-100 rounded-md",title:`Avanzar a ${y[S(t.status)]?.label||"siguiente estado"}`,children:e.jsx(H,{size:18})})]})}}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestión de Envíos"}),e.jsx("div",{className:"flex space-x-2",children:e.jsxs("button",{onClick:F,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[e.jsx(Q,{size:18,className:"inline mr-2"}),"Actualizar"]})})]}),r&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:e.jsx("p",{children:r})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Estado del envío"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Z,{className:"h-5 w-5 text-gray-500 mr-2"}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",value:x,onChange:t=>p(t.target.value),children:[e.jsx("option",{value:"all",children:"Todos los Estados"}),Object.entries(y).map(([t,{label:n}])=>e.jsx("option",{value:t,children:n},t))]})]})]}),e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Transportista"}),e.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",value:T,onChange:t=>R(t.target.value),children:[e.jsx("option",{value:"all",children:"Todos los Transportistas"}),ne.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{className:"flex flex-col space-y-1 lg:col-span-2",children:[e.jsx("label",{className:"text-sm text-gray-600",children:"Rango de fechas"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("input",{type:"date",className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",value:o.from,onChange:t=>N(n=>({...n,from:t.target.value})),placeholder:"Desde"}),e.jsx("input",{type:"date",className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",value:o.to,onChange:t=>N(n=>({...n,to:t.target.value})),placeholder:"Hasta"})]})]})]})}),e.jsx(ae,{data:C,columns:w,searchFields:["trackingNumber","orderNumber","customerName"],loading:a,emptyMessage:"No se encontraron envíos",pagination:{currentPage:v.currentPage,totalPages:v.totalPages,totalItems:v.totalItems,itemsPerPage:v.itemsPerPage,onPageChange:g}}),c&&s&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Seguimiento de Envío: ",s.trackingNumber]}),e.jsx("button",{onClick:h,className:"text-gray-500 hover:text-gray-700",children:e.jsx(G,{size:24})})]}),s.orderTotal&&e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-900",children:"Valor del pedido"}),e.jsx("p",{className:"text-lg font-bold text-blue-900",children:U(s.orderTotal)})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm text-blue-700",children:[s.itemCount||1," producto(s)"]}),e.jsx(P,{to:`/admin/orders/${s.orderId}`,className:"text-sm text-blue-600 hover:text-blue-800 underline",children:"Ver pedido completo"})]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-2 text-gray-900",children:"Información del envío"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Pedido"}),e.jsx("p",{className:"text-gray-900 text-sm font-medium",children:s.orderNumber})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Transportista"}),e.jsx("p",{className:"text-gray-900 text-sm font-medium",children:s.carrier})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Estado"}),e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${y[s.status]?.color}`,children:[y[s.status]?.icon,y[s.status]?.label||s.status]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Fecha de creación"}),e.jsx("p",{className:"text-gray-900 text-sm font-medium",children:m(s.createdAt)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Peso"}),e.jsxs("p",{className:"text-gray-900 text-sm font-medium",children:[s.weight||"N/A"," kg"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Dimensiones"}),e.jsx("p",{className:"text-gray-900 text-sm font-medium",children:s.dimensions||"N/A"})]}),s.shippingCost&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Costo de envío"}),e.jsx("p",{className:"text-gray-900 text-sm font-medium",children:U(s.shippingCost)})]}),s.estimatedDeliveryDate&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Entrega estimada"}),e.jsx("p",{className:"text-gray-900 text-sm font-medium",children:m(s.estimatedDeliveryDate)})]}),s.deliveredDate&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Fecha de entrega"}),e.jsx("p",{className:"text-gray-900 text-sm font-medium",children:m(s.deliveredDate)})]}),s.notes&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Notas especiales"}),e.jsx("p",{className:"text-gray-900 text-sm",children:s.notes})]})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-2 text-gray-900",children:"Dirección de entrega"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("p",{className:"text-gray-900 text-sm font-medium mb-1",children:s.customerName}),e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:s.address.street}),e.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:[s.address.city,","," ",s.address.state]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-1",children:[s.address.postalCode,","," ",s.address.country]}),s.address.phone&&e.jsxs("p",{className:"text-sm text-gray-600",children:["Teléfono: ",s.address.phone]}),s.address.email&&e.jsxs("p",{className:"text-sm text-gray-600",children:["Email: ",s.address.email]}),s.customerEmail&&e.jsxs("p",{className:"text-sm text-gray-600",children:["Email: ",s.customerEmail]})]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium mb-4 text-gray-900",children:"Historial de seguimiento"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-5 top-0 bottom-0 w-0.5 bg-gray-300"}),e.jsx("ul",{className:"space-y-4",children:s.trackingHistory&&s.trackingHistory.length>0?[...s.trackingHistory].reverse().map((t,n)=>{const b=n===0;return e.jsxs("li",{className:"relative pl-12",children:[e.jsx("div",{className:`absolute left-4 w-2 h-2 rounded-full ring-4 ring-white z-10 ${b?"bg-green-600":"bg-primary-600"}`}),e.jsxs("div",{className:`rounded-lg p-4 ${b?"bg-green-50 border border-green-200":"bg-gray-50"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("p",{className:`text-sm font-medium ${b?"text-green-900":"text-gray-900"}`,children:[(t.status==="shipped"||t.status==="in_transit")&&e.jsx(E,{className:"inline w-4 h-4 mr-2 text-blue-600"}),t.status==="delivered"&&e.jsx(V,{className:"inline w-4 h-4 mr-2 text-green-600"}),t.status==="failed_delivery"&&e.jsx(O,{className:"inline w-4 h-4 mr-2 text-red-600"}),t.status==="pending"&&e.jsx(J,{className:"inline w-4 h-4 mr-2 text-yellow-600"}),t.status==="processing"&&e.jsx(k,{className:"inline w-4 h-4 mr-2 text-blue-600"}),t.description||y[t.status]?.label||t.status]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-gray-500",children:m(t.timestamp||t.createdAt)}),b&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 mt-1",children:"Última actualización"})]})]}),t.location&&e.jsxs("p",{className:"text-sm text-gray-600 flex items-center",children:[e.jsx(M,{className:"w-3 h-3 mr-1 text-gray-400"}),"Ubicación: ",t.location]}),t.notes&&e.jsxs("p",{className:"text-sm text-gray-600 mt-1 italic",children:["Nota: ",t.notes]})]})]},t.id||n)}):e.jsxs("li",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-400 mb-2",children:e.jsx(k,{className:"w-12 h-12 mx-auto"})}),e.jsx("p",{className:"text-gray-500 text-sm",children:"No hay historial de seguimiento disponible aún."}),e.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"El historial se actualizará cuando el envío comience su tránsito."})]})})]})]}),e.jsxs("div",{className:"mt-6 flex justify-between items-center",children:[e.jsxs("div",{className:"flex space-x-2",children:[["pending","processing","ready_to_ship","shipped","in_transit","out_for_delivery","failed_delivery"].includes(s.status)&&e.jsxs("button",{onClick:()=>f(s.id,s.status),className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(H,{size:18,className:"inline mr-2"}),"Avanzar a ",y[S(s.status)]?.label]}),e.jsxs(P,{to:`/admin/orders/${s.orderId}`,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:[e.jsx(z,{size:18,className:"inline mr-2"}),"Ver pedido completo"]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>D(s.id),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors",children:[e.jsx(L,{size:18,className:"inline mr-2"}),"Notificar cliente"]}),e.jsx("button",{onClick:h,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors",children:"Cerrar"})]})]})]})})})]})};export{oe as default};
//# sourceMappingURL=AdminShippingPage-Bw98Rtuk.js.map
