import{j as e,aI as le,X as y,O as ce,h as de,J as me,D as ue,q as ge,p as N,aQ as pe,aR as K,aS as he,n as xe,aT as ye,aU as be,k as U,aO as fe,aA as je}from"./ui-vendor-BUNMIuFe.js";import{u as Ne,d as ve,r as u}from"./react-vendor-Cy458wKG.js";import{l as we,b as R,c as Ce}from"./admin-chunk-BNcFjXlJ.js";import{u as ke}from"./useCategoriesSelect-DJGkSPcx.js";import"./seller-chunk-6swISJwY.js";import"./utils-vendor-DeGC_a19.js";const De=()=>{const x=Ne(),{id:C}=ve(),b=C?parseInt(C):0,[v,k]=u.useState(!0),[f,I]=u.useState(!1),[O,w]=u.useState([]),[B,S]=u.useState(!0),{updateProduct:q,fetchProductById:A}=we(),{parentCategoryOptions:L,subcategoryOptions:z,selectedParentId:j,setSelectedParentId:E,loading:G}=ke(),[g,J]=u.useState({basic:!0,pricing:!0,categorization:!0,physical:!1,variations:!1,media:!0,seo:!1,advanced:!1,seller:!0}),[t,l]=u.useState({name:"",description:"",short_description:"",parentCategory:"",category:"",tags:[],currentTag:"",price:"",stock:"",discount_percentage:"",weight:"",width:"",height:"",depth:"",dimensions:"",colors:[],currentColor:"",sizes:[],currentSize:"",attributes:[],currentAttributeKey:"",currentAttributeValue:"",images:[],existingImages:[],previewImages:[],imagesToRemove:[],status:"active",featured:!1,published:!0,sellerId:""}),W=["name","description","price","stock","category","sellerId"],[o,P]=u.useState({});u.useEffect(()=>{(async()=>{try{S(!0);const r=await Ce.get("/admin/sellers-simple");if(console.log("Sellers API response:",r),r?.data){const a=r.data?.data||r.data;console.log("Processed sellers data:",a),w(Array.isArray(a)?a:[])}else console.error("No data in sellers response:",r),w([])}catch(r){console.error("Error loading sellers:",r),w([])}finally{S(!1)}})()},[]),u.useEffect(()=>{(async()=>{if(!b){x("/admin/products");return}try{k(!0);const r=await A(b);if(!r)throw new Error("No se pudo obtener la información del producto");console.log("Producto recibido:",r),console.log("Category ID:",r.category_id),console.log("Category:",r.category);let a=r.category?.parent_id,n=r.category_id;a||(a=n),console.log("⭐ Valores de categoría actualizados:",{parentCategoryId:a,categoryId:n,categoryIdType:typeof n,parentCategoryIdType:typeof a}),a&&E(Number(a)),await new Promise(c=>setTimeout(c,10));const m=c=>!Array.isArray(c)||c.length===0?[]:c.some(i=>typeof i=="string"&&i.includes('"'))?(c.join("").match(/\"([^\"]+)\"/g)||[]).map(p=>p.replace(/"/g,"")):c.map(i=>typeof i=="string"?i.replace(/[\[\]"\\]/g,"").trim():String(i)).filter(Boolean);l(c=>(console.log("Actualizando formData con valores:",{parentCategory:String(a),category:String(n),sellerId:String(r.sellerId||r.seller_id||r.seller?.id||"")}),{...c,name:r.name||"",description:r.description||"",short_description:r.shortDescription||"",price:r.price?r.price.toString():"",stock:r.stock?r.stock.toString():"",discount_percentage:r.discount_percentage?r.discount_percentage.toString():"",weight:r.weight?r.weight.toString():"",width:r.width?r.width.toString():"",height:r.height?r.height.toString():"",depth:r.depth?r.depth.toString():"",dimensions:r.dimensions||"",status:r.status||"active",featured:!!r.featured,published:!!r.published,parentCategory:a?String(a):"",category:n?String(n):"",sellerId:String(r.sellerId||r.seller_id||r.seller?.id||""),tags:m(r.tags||[]),colors:m(r.colors||[]),sizes:m(r.sizes||[]),attributes:Array.isArray(r.attributes)?r.attributes:typeof r.attributes=="string"&&r.attributes?(()=>{try{return JSON.parse(r.attributes)}catch(i){return console.error("Error al parsear atributos:",i),[]}})():[],existingImages:Array.isArray(r.images)?r.images.map(i=>typeof i=="string"?{original:i,thumbnail:i,medium:i,large:i}:{id:i.id,original:i.original||"",thumbnail:i.thumbnail||i.original||"",medium:i.medium||i.original||"",large:i.large||i.original||"",alt:i.alt,position:i.position}):[],images:[],previewImages:Array.isArray(r.images)?r.images.map(i=>{const V=R.imageBaseUrl;let p;return typeof i=="string"?p=i:p=i.original||i.medium||i.thumbnail,p&&!p.startsWith("http")?`${V}${p}`:p||""}):[],imagesToRemove:[]}))}catch(r){console.error("Error al cargar los datos del producto:",r),alert("No se pudo cargar el producto. Inténtalo de nuevo más tarde."),x("/admin/products")}finally{k(!1)}})()},[b,x,A]),u.useEffect(()=>{!v&&t.category&&(console.log("selectedParentId cambió a:",j),j&&l(s=>({...s,parentCategory:String(j)})))},[j,v]);const M=s=>{J(r=>({...r,[s]:!r[s]}))},d=s=>{const{name:r,value:a,type:n}=s.target;if(n==="checkbox"){const m=s.target.checked;l(c=>{const i={...c,[r]:m};return console.log("handleInputChange - Checkbox actualizado:",i),i});return}l(m=>{const c={...m,[r]:a};return console.log("handleInputChange - Input actualizado:",c),c}),r==="parentCategory"&&a&&(E(parseInt(a)),l(m=>{const c={...m,category:""};return console.log("handleInputChange - parentCategory cambiado, subcategoría reseteada:",c),c})),o[r]&&P(m=>{const c={...m};return delete c[r],console.log("handleInputChange - Error de validación eliminado para:",r),c})},H=s=>{if(s.target.files&&s.target.files.length>0){const r=Array.from(s.target.files),a=r.map(n=>URL.createObjectURL(n));l(n=>({...n,images:[...n.images,...r],previewImages:[...n.previewImages,...a]}))}},Q=s=>{const r=[...t.images],a=[...t.previewImages];URL.revokeObjectURL(a[s]),r.splice(s,1),a.splice(s,1),l(n=>({...n,images:r,previewImages:a}))},X=s=>{const r=[...t.existingImages],a=r[s];a.id&&l(n=>({...n,imagesToRemove:[...n.imagesToRemove,a.id]})),r.splice(s,1),l(n=>({...n,existingImages:r}))},D=()=>{t.currentTag.trim()&&!t.tags.includes(t.currentTag.trim())&&l(s=>({...s,tags:[...s.tags,s.currentTag.trim()],currentTag:""}))},Y=s=>{l(r=>({...r,tags:r.tags.filter(a=>a!==s)}))},Z=s=>{s.key==="Enter"&&(s.preventDefault(),D())},_=()=>{t.currentColor.trim()&&!t.colors.includes(t.currentColor.trim())&&l(s=>({...s,colors:[...s.colors,t.currentColor.trim()],currentColor:""}))},ee=s=>{l(r=>({...r,colors:r.colors.filter(a=>a!==s)}))},re=s=>{s.key==="Enter"&&(s.preventDefault(),_())},F=()=>{t.currentSize.trim()&&!t.sizes.includes(t.currentSize.trim())&&l(s=>({...s,sizes:[...s.sizes,t.currentSize.trim()],currentSize:""}))},se=s=>{l(r=>({...r,sizes:r.sizes.filter(a=>a!==s)}))},te=s=>{s.key==="Enter"&&(s.preventDefault(),F())},$=()=>{const s=t.currentAttributeKey.trim(),r=t.currentAttributeValue.trim();s&&r&&l(a=>({...a,attributes:[...a.attributes,{key:s,value:r}],currentAttributeKey:"",currentAttributeValue:""}))},ae=s=>{l(r=>{const a=[...r.attributes];return a.splice(s,1),{...r,attributes:a}})},oe=s=>{if(s.key==="Enter"){s.preventDefault();const r=document.getElementById("attributeValue");r&&r.focus()}},ie=s=>{s.key==="Enter"&&(s.preventDefault(),$())},ne=()=>{const s={};return W.forEach(r=>{t[r]||(s[r]=`El campo ${r} es obligatorio`)}),t.price&&(isNaN(Number(t.price))||Number(t.price)<=0)&&(s.price="El precio debe ser un número mayor que cero"),t.stock&&(isNaN(Number(t.stock))||Number(t.stock)<0)&&(s.stock="El stock debe ser un número no negativo"),t.discount_percentage&&(isNaN(Number(t.discount_percentage))||Number(t.discount_percentage)<0||Number(t.discount_percentage)>100)&&(s.discount_percentage="El descuento debe ser un porcentaje entre 0 y 100"),["weight","width","height","depth"].forEach(r=>{const a=t[r];a&&isNaN(Number(a))&&(s[r]=`El campo ${r} debe ser un número`)}),P(s),Object.keys(s).length===0},T=async s=>{if(s.preventDefault(),!ne()){const r=Object.keys(o)[0],a=document.getElementById(r);a&&(a.scrollIntoView({behavior:"smooth",block:"center"}),a.focus());return}I(!0);try{const r={id:b,name:t.name,description:t.description,short_description:t.short_description||void 0,price:parseFloat(t.price),stock:parseInt(t.stock),category_id:parseInt(t.category),seller_id:parseInt(t.sellerId),status:t.status,tags:t.tags,discount_percentage:t.discount_percentage?parseFloat(t.discount_percentage):void 0,weight:t.weight?parseFloat(t.weight):void 0,width:t.width?parseFloat(t.width):void 0,height:t.height?parseFloat(t.height):void 0,depth:t.depth?parseFloat(t.depth):void 0,colors:t.colors,sizes:t.sizes,featured:t.featured,published:t.published,replace_images:!1};console.log("Datos enviados al backend:",r);const a=await q(r);if(a)console.log("Respuesta del servidor después de la actualización:",a),x("/admin/products");else throw new Error("No se pudo actualizar el producto")}catch(r){console.error("Error al actualizar producto:",r),alert(r instanceof Error?r.message:"Error al actualizar producto")}finally{I(!1)}},h=({title:s,section:r,icon:a})=>e.jsxs("div",{className:"flex items-center justify-between cursor-pointer py-3 border-b border-gray-200",onClick:()=>M(r),children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(a,{className:"w-5 h-5 text-primary-600 mr-2"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:s})]}),g[r]?e.jsx(fe,{className:"w-5 h-5 text-gray-500"}):e.jsx(je,{className:"w-5 h-5 text-gray-500"})]});return v?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[e.jsx(le,{className:"w-12 h-12 text-primary-600 animate-spin mb-4"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Cargando datos del producto..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Editar Producto (Admin): ",t.name]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{type:"button",onClick:()=>x("/admin/products"),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(y,{size:18,className:"inline mr-1"})," Cancelar"]}),e.jsx("button",{type:"button",onClick:T,disabled:f,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:f?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"inline-block animate-spin mr-1",children:"⟳"})," ","Guardando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{size:18,className:"inline mr-1"})," Guardar Cambios"]})})]})]}),e.jsxs("form",{onSubmit:T,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx(h,{title:"Asignación de Vendedor",section:"seller",icon:de}),g.seller&&e.jsx("div",{className:"mt-4",children:e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"sellerId",className:"block text-sm font-medium text-gray-700 mb-1",children:["Vendedor Asignado ",e.jsx("span",{className:"text-red-500",children:"*"})]}),B?e.jsx("div",{className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-100 text-gray-400",children:"Cargando vendedores..."}):e.jsxs("select",{id:"sellerId",name:"sellerId",value:t.sellerId,onChange:d,className:`w-full px-3 py-2 border ${o.sellerId?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500`,children:[e.jsx("option",{value:"",children:"Seleccionar Vendedor"}),O.map(s=>e.jsx("option",{value:s.id,children:s.store_name||s.name||`Vendedor ${s.id}`},s.id))]}),o.sellerId&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.sellerId})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx(h,{title:"Información Básica",section:"basic",icon:me}),g.basic&&e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:["Nombre del Producto ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"name",name:"name",value:t.name,onChange:d,className:`w-full px-3 py-2 border ${o.name?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500`}),o.name&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.name})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"short_description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripción Corta"}),e.jsx("input",{type:"text",id:"short_description",name:"short_description",value:t.short_description,onChange:d,placeholder:"Resumen breve del producto (para listados y búsquedas)",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:["Descripción Completa ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{id:"description",name:"description",rows:4,value:t.description,onChange:d,className:`w-full px-3 py-2 border ${o.description?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500`}),o.description&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.description})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx(h,{title:"Precios y Stock",section:"pricing",icon:ue}),g.pricing&&e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700 mb-1",children:["Precio ($) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",id:"price",name:"price",min:"0",step:"0.01",value:t.price,onChange:d,className:`w-full px-3 py-2 border ${o.price?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500`}),o.price&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.price})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"discount_percentage",className:"block text-sm font-medium text-gray-700 mb-1",children:"Descuento (%)"}),e.jsx("input",{type:"number",id:"discount_percentage",name:"discount_percentage",min:"0",max:"100",step:"0.1",value:t.discount_percentage,onChange:d,className:`w-full px-3 py-2 border ${o.discount_percentage?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500`}),o.discount_percentage&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.discount_percentage})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"stock",className:"block text-sm font-medium text-gray-700 mb-1",children:["Cantidad en Stock ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",id:"stock",name:"stock",min:"0",value:t.stock,onChange:d,className:`w-full px-3 py-2 border ${o.stock?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500`}),o.stock&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.stock})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado del Producto"}),e.jsxs("select",{id:"status",name:"status",value:t.status,onChange:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"active",children:"Activo"}),e.jsx("option",{value:"inactive",children:"Inactivo"}),e.jsx("option",{value:"draft",children:"Borrador"})]})]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"flex space-x-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"featured",name:"featured",type:"checkbox",checked:t.featured,onChange:d,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"featured",className:"ml-2 block text-sm text-gray-900",children:"Producto Destacado"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{id:"published",name:"published",type:"checkbox",checked:t.published,onChange:d,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"published",className:"ml-2 block text-sm text-gray-900",children:"Publicado"})]})]})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx(h,{title:"Categorización",section:"categorization",icon:ge}),g.categorization&&e.jsxs("div",{className:"mt-4 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"parentCategory",className:"block text-sm font-medium text-gray-700 mb-1",children:["Categoría Principal ",e.jsx("span",{className:"text-red-500",children:"*"})]}),G?e.jsx("div",{className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-100 text-gray-400",children:"Cargando categorías..."}):e.jsxs("select",{id:"parentCategory",name:"parentCategory",value:t.parentCategory,onChange:d,className:`w-full px-3 py-2 border ${o.parentCategory?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500`,children:[e.jsx("option",{value:"",children:"Seleccionar Categoría Principal"}),L.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]}),o.parentCategory&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.parentCategory})]}),e.jsxs("div",{className:t.parentCategory?"":"opacity-50",children:[e.jsxs("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-1",children:["Subcategoría ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{id:"category",name:"category",value:t.category,onChange:d,disabled:!t.parentCategory,className:`w-full px-3 py-2 border ${o.category?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 disabled:bg-gray-100 disabled:cursor-not-allowed`,children:[!t.category&&e.jsx("option",{value:"",children:t.parentCategory?z.length>0?"Seleccionar Subcategoría":"No hay subcategorías disponibles":"Primero selecciona una categoría principal"}),z.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value)),t.parentCategory&&e.jsx("option",{value:t.parentCategory,children:"Usar categoría principal"})]}),o.category&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.category})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Etiquetas (Tags)"}),e.jsxs("div",{className:"flex",children:[e.jsx("input",{type:"text",placeholder:"Añade una etiqueta y presiona Enter",value:t.currentTag,onChange:s=>l(r=>({...r,currentTag:s.target.value})),onKeyDown:Z,className:"flex-grow px-3 py-2 border border-gray-300 rounded-l-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"}),e.jsx("button",{type:"button",onClick:D,className:"px-4 py-2 bg-primary-600 text-white rounded-r-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:e.jsx(N,{size:18})})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[t.tags.map(s=>e.jsxs("div",{className:"bg-gray-100 text-gray-800 px-2 py-1 rounded-md flex items-center",children:[e.jsx("span",{children:s}),e.jsx("button",{type:"button",onClick:()=>Y(s),className:"ml-1 text-gray-500 hover:text-gray-700",children:e.jsx(y,{size:14})})]},s)),t.tags.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"Aún no se han añadido etiquetas"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx(h,{title:"Características Físicas",section:"physical",icon:pe}),g.physical&&e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"weight",className:"block text-sm font-medium text-gray-700 mb-1",children:"Peso (kg)"}),e.jsx("input",{type:"number",id:"weight",name:"weight",min:"0",step:"0.001",value:t.weight,onChange:d,className:`w-full px-3 py-2 border ${o.weight?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500`}),o.weight&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.weight})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"width",className:"block text-sm font-medium text-gray-700 mb-1",children:"Ancho (cm)"}),e.jsx("input",{type:"number",id:"width",name:"width",min:"0",step:"0.1",value:t.width,onChange:d,className:`w-full px-3 py-2 border ${o.width?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500`}),o.width&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.width})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"height",className:"block text-sm font-medium text-gray-700 mb-1",children:"Alto (cm)"}),e.jsx("input",{type:"number",id:"height",name:"height",min:"0",step:"0.1",value:t.height,onChange:d,className:`w-full px-3 py-2 border ${o.height?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500`}),o.height&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.height})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"depth",className:"block text-sm font-medium text-gray-700 mb-1",children:"Profundidad (cm)"}),e.jsx("input",{type:"number",id:"depth",name:"depth",min:"0",step:"0.1",value:t.depth,onChange:d,className:`w-full px-3 py-2 border ${o.depth?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500`}),o.depth&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.depth})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx(h,{title:"Variaciones y Atributos",section:"variations",icon:K}),g.variations&&e.jsxs("div",{className:"mt-4 space-y-8",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-md font-medium text-gray-800 mb-2 flex items-center",children:[e.jsx(K,{className:"w-4 h-4 mr-1"})," Colores Disponibles"]}),e.jsxs("div",{className:"flex",children:[e.jsx("input",{type:"text",placeholder:"Añade un color y presiona Enter",value:t.currentColor,onChange:s=>l(r=>({...r,currentColor:s.target.value})),onKeyDown:re,className:"flex-grow px-3 py-2 border border-gray-300 rounded-l-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"}),e.jsx("button",{type:"button",onClick:_,className:"px-4 py-2 bg-primary-600 text-white rounded-r-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:e.jsx(N,{size:18})})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[t.colors.map(s=>e.jsxs("div",{className:"bg-gray-100 text-gray-800 px-2 py-1 rounded-md flex items-center",children:[e.jsx("span",{children:s}),e.jsx("button",{type:"button",onClick:()=>ee(s),className:"ml-1 text-gray-500 hover:text-gray-700",children:e.jsx(y,{size:14})})]},s)),t.colors.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"Aún no se han añadido colores"})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-md font-medium text-gray-800 mb-2 flex items-center",children:[e.jsx(he,{className:"w-4 h-4 mr-1"})," Tallas Disponibles"]}),e.jsxs("div",{className:"flex",children:[e.jsx("input",{type:"text",placeholder:"Añade una talla y presiona Enter",value:t.currentSize,onChange:s=>l(r=>({...r,currentSize:s.target.value})),onKeyDown:te,className:"flex-grow px-3 py-2 border border-gray-300 rounded-l-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"}),e.jsx("button",{type:"button",onClick:F,className:"px-4 py-2 bg-primary-600 text-white rounded-r-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:e.jsx(N,{size:18})})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[t.sizes.map(s=>e.jsxs("div",{className:"bg-gray-100 text-gray-800 px-2 py-1 rounded-md flex items-center",children:[e.jsx("span",{children:s}),e.jsx("button",{type:"button",onClick:()=>se(s),className:"ml-1 text-gray-500 hover:text-gray-700",children:e.jsx(y,{size:14})})]},s)),t.sizes.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"Aún no se han añadido tallas"})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-md font-medium text-gray-800 mb-2 flex items-center",children:[e.jsx(xe,{className:"w-4 h-4 mr-1"})," Atributos Personalizados"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",id:"attributeKey",placeholder:"Nombre del atributo (ej: Material)",value:t.currentAttributeKey,onChange:s=>l(r=>({...r,currentAttributeKey:s.target.value})),onKeyDown:oe,className:"px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"}),e.jsxs("div",{className:"flex",children:[e.jsx("input",{type:"text",id:"attributeValue",placeholder:"Valor (ej: Algodón)",value:t.currentAttributeValue,onChange:s=>l(r=>({...r,currentAttributeValue:s.target.value})),onKeyDown:ie,className:"flex-grow px-3 py-2 border border-gray-300 rounded-l-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"}),e.jsx("button",{type:"button",onClick:$,className:"px-4 py-2 bg-primary-600 text-white rounded-r-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:e.jsx(N,{size:18})})]})]}),e.jsx("div",{className:"mt-4",children:t.attributes.length>0?e.jsx("div",{className:"bg-gray-50 p-4 rounded-md",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Atributo"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Valor"}),e.jsx("th",{className:"px-3 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acción"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:t.attributes.map((s,r)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-3 py-2 text-sm text-gray-800",children:s.key}),e.jsx("td",{className:"px-3 py-2 text-sm text-gray-600",children:s.value}),e.jsx("td",{className:"px-3 py-2 text-right",children:e.jsx("button",{type:"button",onClick:()=>ae(r),className:"text-red-600 hover:text-red-800",children:e.jsx(y,{size:16})})})]},r))})]})}):e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Aún no se han añadido atributos personalizados"})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx(h,{title:"Imágenes del Producto",section:"media",icon:ye}),g.media&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx("input",{type:"file",id:"images",accept:"image/*",multiple:!0,onChange:H,className:"hidden"}),e.jsxs("label",{htmlFor:"images",className:"cursor-pointer flex flex-col items-center justify-center",children:[e.jsx(be,{className:"h-12 w-12 text-gray-400 mb-2"}),e.jsx("p",{className:"text-gray-600 mb-1",children:"Arrastra y suelta imágenes aquí o haz clic para subir"}),e.jsx("p",{className:"text-xs text-gray-500",children:"JPEG, PNG, WebP hasta 2MB"})]})]}),t.existingImages.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium text-gray-800 mb-3",children:"Imágenes actuales"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:t.existingImages.map((s,r)=>{const a=R.imageBaseUrl;let n=s.original||s.medium||s.thumbnail;const m=n&&n.startsWith("http")?n:`${a}${n}`;return e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"aspect-w-1 aspect-h-1 w-full overflow-hidden rounded-lg bg-gray-100",children:e.jsx("img",{src:m,alt:t.name||`Imagen existente ${r+1}`,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"})}),e.jsx("button",{type:"button",onClick:()=>X(r),className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(U,{size:14})}),r===0&&e.jsx("div",{className:"absolute bottom-2 left-2 bg-primary-500 text-white text-xs py-1 px-2 rounded-md",children:"Principal"})]},`existing-${r}`)})})]}),t.images.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium text-gray-800 mb-3",children:"Nuevas imágenes a agregar"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:t.images.map((s,r)=>e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"aspect-w-1 aspect-h-1 w-full overflow-hidden rounded-lg bg-gray-100",children:e.jsx("img",{src:t.previewImages[r],alt:t.name||`Nueva imagen ${r+1}`,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"})}),e.jsx("button",{type:"button",onClick:()=>Q(r),className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(U,{size:14})})]},`new-${r}`))})]}),t.existingImages.length===0&&t.images.length===0&&e.jsx("p",{className:"text-sm text-gray-500 text-center mt-4",children:"No hay imágenes para este producto. Agrega al menos una imagen."})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:f,className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:f?"Guardando...":"Guardar Producto"})})]})]})};export{De as default};
//# sourceMappingURL=AdminProductEditPage-uM1NGDv-.js.map
