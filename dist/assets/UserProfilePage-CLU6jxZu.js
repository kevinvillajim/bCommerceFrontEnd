import{j as e,h as L,L as K,M as $,n as A,av as Q,an as O,aA as M,V as W,m as X,I as Z,w as q,E as T,i as I,f as k,G as B,r as G,c as R,am as J,aj as ee}from"./ui-vendor-BUNMIuFe.js";import{r as o}from"./react-vendor-Cy458wKG.js";import{c as D,A as U}from"./admin-chunk-BNcFjXlJ.js";import{u as F}from"./chat-chunk-BRsdDZXf.js";import{u as se}from"./usePasswordValidation-DE6-gHPX.js";import"./utils-vendor-DeGC_a19.js";import"./seller-chunk-6swISJwY.js";const re=({activeTab:r,setActiveTab:m,userCreatedAt:t,userName:p,userEmail:u})=>{const{logout:N,user:y,isSeller:j,isAdmin:a}=F(),[l,i]=o.useState(!1),[n,d]=o.useState(!1);o.useEffect(()=>{v()},[]);const v=async()=>{try{const[c,h]=await Promise.all([j(),a()]);i(c),d(h)}catch(c){console.error("Error checking user roles:",c)}},S=()=>p?p.charAt(0).toUpperCase():y?.name?y.name.charAt(0).toUpperCase():"U",_=c=>{if(!c)return"N/A";const h=new Date(c);return new Intl.DateTimeFormat("es-ES",{year:"numeric",month:"long",day:"numeric"}).format(h)},x=async()=>{try{await N()}catch(c){console.error("Error al cerrar sesión:",c)}};return e.jsx("div",{className:"lg:w-1/4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-primary-500 to-primary-600 p-6 text-white",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-24 h-24 bg-white rounded-full flex items-center justify-center mb-4 border-4 border-white shadow-md",children:e.jsx("span",{className:"text-primary-600 text-3xl font-bold",children:S()})}),e.jsx("h2",{className:"text-xl font-semibold",children:p||y?.name}),e.jsx("p",{className:"text-primary-100",children:u||y?.email}),t&&e.jsxs("div",{className:"mt-2 text-xs bg-primary-800 bg-opacity-20 rounded-full px-3 py-1",children:["Cliente desde ",_(t)]})]})}),e.jsx("nav",{className:"p-4",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:e.jsxs("button",{onClick:()=>m("personal"),className:`w-full flex items-center p-3 rounded-lg transition-colors ${r==="personal"?"bg-primary-50 text-primary-600 font-medium":"text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(L,{size:18,className:"mr-3"}),"Información Personal"]})}),e.jsx("li",{children:e.jsxs("button",{onClick:()=>m("security"),className:`w-full flex items-center p-3 rounded-lg transition-colors ${r==="security"?"bg-primary-50 text-primary-600 font-medium":"text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(K,{size:18,className:"mr-3"}),"Seguridad"]})}),e.jsx("li",{children:e.jsxs("button",{onClick:()=>m("feedback"),className:`w-full flex items-center p-3 rounded-lg transition-colors ${r==="feedback"?"bg-primary-50 text-primary-600 font-medium":"text-gray-700 hover:bg-gray-50"}`,children:[e.jsx($,{size:18,className:"mr-3"}),"Feedback y Sugerencias"]})}),!l&&!n&&e.jsx("li",{children:e.jsxs("button",{onClick:()=>m("seller-application"),className:`w-full flex items-center p-3 rounded-lg transition-colors ${r==="seller-application"?"bg-primary-50 text-primary-600 font-medium":"text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(A,{size:18,className:"mr-3"}),"Solicitud de Vendedor"]})}),e.jsx("li",{className:"pt-4 border-t border-gray-200 mt-4",children:e.jsxs("button",{className:"w-full flex items-center p-3 rounded-lg text-red-600 hover:bg-red-50 transition-colors",onClick:x,children:[e.jsx(Q,{size:18,className:"mr-3"}),"Cerrar Sesión"]})})]})})]})})},ae=["Ecuador","Colombia","Perú","Brasil","Argentina","Chile","Venezuela","Bolivia","Paraguay","Uruguay"],te=["Azuay","Bolívar","Cañar","Carchi","Chimborazo","Cotopaxi","El Oro","Esmeraldas","Galápagos","Guayas","Imbabura","Loja","Los Ríos","Manabí","Morona Santiago","Napo","Orellana","Pastaza","Pichincha","Santa Elena","Santo Domingo","Sucumbíos","Tungurahua","Zamora Chinchipe"],ne=({value:r,onChange:m,className:t=""})=>{const p=a=>{if(!a)return{pais:"Ecuador",estado:"",ciudad:""};const l=a.split(",").map(i=>i.trim());return l.length>=3?{ciudad:l[0]||"",estado:l[1]||"",pais:l[2]||"Ecuador"}:l.length===2?{ciudad:l[0]||"",estado:l[1]||"",pais:"Ecuador"}:{ciudad:a,estado:"",pais:"Ecuador"}},[u,N]=o.useState(()=>p(r)),y=a=>[a.ciudad,a.estado,a.pais].filter(Boolean).join(", ");o.useEffect(()=>{r!==y(u)&&N(p(r))},[r]);const j=(a,l)=>{const i={...u,[a]:l};a==="pais"&&l!=="Ecuador"&&(i.estado=""),N(i),m(y(i))};return e.jsxs("div",{className:t,children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(O,{className:"inline mr-1",size:16}),"Ubicación"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:u.pais,onChange:a=>j("pais",a.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 appearance-none",children:ae.map(a=>e.jsx("option",{value:a,children:a},a))}),e.jsx(M,{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400",size:16})]}),u.pais==="Ecuador"?e.jsxs("div",{className:"relative",children:[e.jsxs("select",{value:u.estado,onChange:a=>j("estado",a.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 appearance-none",children:[e.jsx("option",{value:"",children:"Provincia..."}),te.map(a=>e.jsx("option",{value:a,children:a},a))]}),e.jsx(M,{className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400",size:16})]}):e.jsx("input",{type:"text",placeholder:"Estado/Provincia",value:u.estado,onChange:a=>j("estado",a.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.jsx("input",{type:"text",placeholder:"Ciudad",value:u.ciudad,onChange:a=>j("ciudad",a.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsx("div",{className:"mt-2 text-sm text-gray-600",children:y(u)||"Ingresa tu ubicación"})]})},V=({userProfile:r,onProfileUpdate:m})=>{const{updateProfile:t}=F(),[p,u]=o.useState(!1),[N,y]=o.useState(!1),[j,a]=o.useState(null),[l,i]=o.useState(null),[n,d]=o.useState({name:"",email:"",age:"",gender:"",location:""});o.useEffect(()=>{r&&d({name:r.name||"",email:r.email||"",age:r.age?.toString()||"",gender:r.gender||"",location:r.location||""})},[r]);const v=c=>{const{name:h,value:C}=c.target;d(g=>({...g,[h]:C}))},S=c=>{d(h=>({...h,location:c}))},_=async c=>{c.preventDefault(),a(null),i(null),y(!0);try{const h={name:n.name,age:n.age?parseInt(n.age):null,gender:n.gender||null,location:n.location||null};try{const C=await D.put("/profile",h);if(C&&m&&r){const g={...r,name:C.name||r.name,age:C.age??r.age,gender:C.gender??r.gender,location:C.location??r.location};t(h),m(g),i("Perfil actualizado correctamente"),u(!1)}}catch(C){console.error("Error con ApiClient:",C);const g=await t(h);if(g&&m&&r){const P={...r,name:g.name||r.name,age:g.age??r.age,gender:g.gender??r.gender,location:g.location??r.location};m(P),i("Perfil actualizado correctamente"),u(!1)}}}catch(h){console.error("Error al actualizar perfil:",h),h instanceof Error?a(h.message):a("No se pudo actualizar el perfil. Inténtelo de nuevo.")}finally{y(!1)}},x=()=>{u(!1),r&&d({name:r.name||"",email:r.email||"",age:r.age?.toString()||"",gender:r.gender||"",location:r.location||""})};return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Información Personal"}),!p&&e.jsxs("button",{onClick:()=>u(!0),className:"flex items-center text-primary-600 hover:text-primary-700",children:[e.jsx(W,{size:18,className:"mr-1"}),"Editar"]})]}),l&&e.jsx("div",{className:"bg-green-50 border-l-4 border-green-400 p-4 mb-4 text-sm text-green-700",children:l}),j&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 mb-4 text-sm text-red-700",children:j}),p?e.jsxs("form",{onSubmit:_,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre completo *"}),e.jsx("input",{type:"text",name:"name",value:n.name,onChange:v,required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Correo electrónico"}),e.jsx("input",{type:"email",value:n.email,disabled:!0,className:"w-full p-3 border border-gray-300 rounded-lg bg-gray-100 text-gray-500"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"El correo no se puede cambiar por seguridad"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Edad"}),e.jsx("input",{type:"number",name:"age",value:n.age,onChange:v,min:"1",max:"150",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Género"}),e.jsxs("select",{name:"gender",value:n.gender,onChange:v,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"Seleccionar..."}),e.jsx("option",{value:"Masculino",children:"Masculino"}),e.jsx("option",{value:"Femenino",children:"Femenino"}),e.jsx("option",{value:"No binario",children:"No binario"}),e.jsx("option",{value:"Prefiero no decirlo",children:"Prefiero no decir"})]})]})]}),e.jsx(ne,{value:n.location,onChange:S}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsx("button",{type:"button",onClick:x,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:N,className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:N?"Guardando...":"Guardar Cambios"})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Nombre completo"}),e.jsxs("div",{className:"flex items-center text-gray-800",children:[e.jsx(L,{size:18,className:"text-primary-500 mr-2"}),r?.name||"No especificado"]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Correo electrónico"}),e.jsxs("div",{className:"flex items-center text-gray-800",children:[e.jsx(X,{size:18,className:"text-primary-500 mr-2"}),r?.email||"No especificado",r?.emailVerifiedAt&&e.jsx("span",{className:"ml-2 bg-green-100 text-green-800 text-xs px-2 py-0.5 rounded-full",children:"Verificado"})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Edad"}),e.jsxs("div",{className:"flex items-center text-gray-800",children:[e.jsx(Z,{size:18,className:"text-primary-500 mr-2"}),r?.age||"No especificada"]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Género"}),e.jsxs("div",{className:"flex items-center text-gray-800",children:[e.jsx(L,{size:18,className:"text-primary-500 mr-2"}),r?.gender||"No especificado"]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg md:col-span-2",children:[e.jsx("div",{className:"text-sm text-gray-500 mb-1",children:"Ubicación"}),e.jsxs("div",{className:"flex items-center text-gray-800",children:[e.jsx(O,{size:18,className:"text-primary-500 mr-2"}),r?.location||"No especificada"]})]})]}),e.jsx("div",{className:"bg-blue-50 border-l-4 border-primary-400 p-4 text-sm text-primary-700",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Nota:"})," Tu información de ubicación se utiliza para calcular costos de envío y mejorar tu experiencia de compra."]})})]})]})},ie=()=>{const[r,m]=o.useState(!1),[t,p]=o.useState(null),[u,N]=o.useState(null),{rules:y,validatePassword:j}=se(),[a,l]=o.useState({currentPassword:"",newPassword:"",confirmPassword:""}),[i,n]=o.useState({current:!1,new:!1,confirm:!1}),d=_=>{const{name:x,value:c}=_.target;l(h=>({...h,[x]:c}))},v=async _=>{if(_.preventDefault(),p(null),N(null),m(!0),a.newPassword!==a.confirmPassword){p("Las contraseñas no coinciden"),m(!1);return}const x=j(a.newPassword);if(!x.isValid){p(x.errors[0]),m(!1);return}try{await D.post(U.AUTH.UPDATE_PASSWORD,{current_password:a.currentPassword,password:a.newPassword,password_confirmation:a.confirmPassword}),l({currentPassword:"",newPassword:"",confirmPassword:""}),N("Contraseña actualizada correctamente")}catch(c){if(console.error("Error al cambiar contraseña:",c),c.response?.data?.errors){const h=Object.values(c.response.data.errors).flat();p(h[0])}else c.response?.data?.message?p(c.response.data.message):p("Error al actualizar la contraseña. Inténtelo de nuevo.")}finally{m(!1)}},S=_=>{n(x=>({...x,[_]:!x[_]}))};return e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-6",children:"Configuración de Seguridad"}),u&&e.jsx("div",{className:"bg-green-50 border-l-4 border-green-400 p-4 mb-4 text-sm text-green-700",children:u}),t&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 mb-4 text-sm text-red-700",children:t}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-4",children:"Cambiar Contraseña"}),e.jsxs("form",{onSubmit:v,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Contraseña actual"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:i.current?"text":"password",id:"currentPassword",name:"currentPassword",value:a.currentPassword,onChange:d,className:"w-full p-3 pr-10 border border-gray-300 rounded-lg focus:ring-primary-500 focus:border-primary-500",required:!0}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700",onClick:()=>S("current"),children:i.current?e.jsx(q,{size:18}):e.jsx(T,{size:18})})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nueva contraseña"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:i.new?"text":"password",id:"newPassword",name:"newPassword",value:a.newPassword,onChange:d,className:"w-full p-3 pr-10 border border-gray-300 rounded-lg focus:ring-primary-500 focus:border-primary-500",required:!0}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700",onClick:()=>S("new"),children:i.new?e.jsx(q,{size:18}):e.jsx(T,{size:18})})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:y.validationMessage})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirmar nueva contraseña"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:i.confirm?"text":"password",id:"confirmPassword",name:"confirmPassword",value:a.confirmPassword,onChange:d,className:"w-full p-3 pr-10 border border-gray-300 rounded-lg focus:ring-primary-500 focus:border-primary-500",required:!0}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-500 hover:text-gray-700",onClick:()=>S("confirm"),children:i.confirm?e.jsx(q,{size:18}):e.jsx(T,{size:18})})]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",disabled:r,children:r?"Actualizando...":"Actualizar Contraseña"})})]})]})]})},oe=()=>{const{user:r,isSeller:m}=F(),[t,p]=o.useState(null),[u,N]=o.useState(!0),[y,j]=o.useState(!1),[a,l]=o.useState(!1),[i,n]=o.useState(null),[d,v]=o.useState(null),[S,_]=o.useState(!1),[x,c]=o.useState({store_name:"",business_activity:"",products_to_sell:"",ruc:"",contact_email:r?.email||"",phone:"",physical_address:"",business_description:"",experience:"",additional_info:""});o.useEffect(()=>{h(),C()},[]);const h=async()=>{try{const b=await m();_(b)}catch(b){console.error("Error checking seller status:",b)}},C=async()=>{N(!0);try{const b=await D.get("/seller-applications/my-application");b?.status==="success"&&b.data?p(b.data):b?.status==="success"&&!b.data&&p(null)}catch(b){console.error("Error fetching application:",b)}finally{N(!1)}},g=b=>{const{name:z,value:Y}=b.target;c(H=>({...H,[z]:Y}))},P=async b=>{b.preventDefault(),j(!0),n(null),v(null);try{(await D.post("/seller-applications",x))?.status==="success"&&(v("Solicitud enviada exitosamente. Te contactaremos pronto."),l(!1),await C(),c({store_name:"",business_activity:"",products_to_sell:"",ruc:"",contact_email:r?.email||"",phone:"",physical_address:"",business_description:"",experience:"",additional_info:""}))}catch(z){n(z.response?.data?.message||"Error al enviar la solicitud")}finally{j(!1)}},s=b=>{switch(b){case"pending":return e.jsx(R,{className:"h-5 w-5 text-yellow-500"});case"approved":return e.jsx(G,{className:"h-5 w-5 text-green-500"});case"rejected":return e.jsx(B,{className:"h-5 w-5 text-red-500"});default:return e.jsx(k,{className:"h-5 w-5 text-gray-500"})}},f=b=>{switch(b){case"pending":return"Pendiente de revisión";case"approved":return"Aprobada";case"rejected":return"Rechazada";default:return"Desconocido"}},w=b=>{switch(b){case"pending":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},E=()=>{t&&t.status==="rejected"&&c({store_name:t.store_name,business_activity:t.business_activity,products_to_sell:t.products_to_sell,ruc:t.ruc,contact_email:t.contact_email,phone:t.phone,physical_address:t.physical_address,business_description:t.business_description||"",experience:t.experience||"",additional_info:t.additional_info||""}),l(!0)};return u?e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})})}):S?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(A,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"¡Ya eres un vendedor!"}),e.jsx("p",{className:"text-gray-600",children:"Ya tienes una cuenta de vendedor activa en Comersia."})]})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx(A,{className:"h-6 w-6 mr-2 text-primary-600"}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Solicitud de Vendedor"})]}),i&&e.jsx("div",{className:"mb-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:i}),d&&e.jsx("div",{className:"mb-4 bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded",children:d}),a?e.jsxs("form",{onSubmit:P,className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre de la tienda *"}),e.jsx("input",{type:"text",name:"store_name",value:x.store_name,onChange:g,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"RUC *"}),e.jsx("input",{type:"text",name:"ruc",value:x.ruc,onChange:g,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email de contacto *"}),e.jsx("input",{type:"email",name:"contact_email",value:x.contact_email,onChange:g,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Teléfono *"}),e.jsx("input",{type:"tel",name:"phone",value:x.phone,onChange:g,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Actividad comercial *"}),e.jsx("textarea",{name:"business_activity",value:x.business_activity,onChange:g,required:!0,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Describe tu actividad comercial principal"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Productos que deseas vender *"}),e.jsx("textarea",{name:"products_to_sell",value:x.products_to_sell,onChange:g,required:!0,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Describe los tipos de productos que planeas vender"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dirección física *"}),e.jsx("textarea",{name:"physical_address",value:x.physical_address,onChange:g,required:!0,rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Dirección completa de tu negocio"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Descripción del negocio"}),e.jsx("textarea",{name:"business_description",value:x.business_description,onChange:g,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Cuéntanos más sobre tu negocio"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Experiencia en ventas"}),e.jsx("textarea",{name:"experience",value:x.experience,onChange:g,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Describe tu experiencia previa en ventas (opcional)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Información adicional"}),e.jsx("textarea",{name:"additional_info",value:x.additional_info,onChange:g,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500",placeholder:"Cualquier información adicional que consideres relevante"})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200 transition-colors",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:y,className:"px-6 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:y?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"}),"Enviando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Enviar solicitud"]})})]})]}):e.jsx("div",{children:t?e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Estado de tu solicitud"}),e.jsxs("div",{className:`flex items-center px-3 py-1 rounded-full text-sm font-medium ${w(t.status)}`,children:[s(t.status),e.jsx("span",{className:"ml-2",children:f(t.status)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Nombre de tienda:"}),e.jsx("p",{className:"text-gray-900",children:t.store_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"RUC:"}),e.jsx("p",{className:"text-gray-900",children:t.ruc})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Fecha de solicitud:"}),e.jsx("p",{className:"text-gray-900",children:new Date(t.created_at).toLocaleDateString("es-ES")})]}),t.reviewed_at&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Fecha de revisión:"}),e.jsx("p",{className:"text-gray-900",children:new Date(t.reviewed_at).toLocaleDateString("es-ES")})]})]}),t.status==="rejected"&&t.rejection_reason&&e.jsxs("div",{className:"mt-4 p-4 bg-red-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-red-800 mb-2",children:"Motivo del rechazo:"}),e.jsx("p",{className:"text-red-700",children:t.rejection_reason})]}),t.status==="approved"&&e.jsxs("div",{className:"mt-4 p-4 bg-green-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-green-800 mb-2",children:"¡Felicitaciones!"}),e.jsx("p",{className:"text-green-700 mb-3",children:"Tu solicitud ha sido aprobada. Ya puedes acceder a tu panel de vendedor."}),e.jsx("a",{href:"/seller",className:"inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors text-sm",children:"Ir al Panel de Vendedor"})]}),t.status==="rejected"&&e.jsxs("div",{className:"mt-4 p-4 bg-primary-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-primary-800 mb-2",children:"¿Quieres intentar de nuevo?"}),e.jsx("p",{className:"text-primary-700 mb-3",children:"Si has solucionado los problemas mencionados en el motivo del rechazo, puedes enviar una nueva solicitud."}),e.jsxs("button",{onClick:E,className:"inline-flex items-center px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 transition-colors text-sm",children:[e.jsx(I,{className:"h-4 w-4 mr-2"}),"Enviar Nueva Solicitud"]})]})]}):e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"bg-primary-50 rounded-lg p-8 mb-6",children:[e.jsx(A,{className:"h-16 w-16 text-primary-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"¿Quieres ser vendedor en Comersia?"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Para ser vendedor en nuestra plataforma, debes completar una solicitud. Nuestro equipo la revisará y te contactaremos pronto."}),e.jsxs("button",{onClick:()=>l(!0),className:"bg-primary-600 text-white px-6 py-3 rounded-lg hover:bg-primary-700 transition-colors flex items-center mx-auto",children:[e.jsx(I,{className:"h-5 w-5 mr-2"}),"Solicitar ser vendedor"]})]})})})]})},le=()=>{const[r,m]=o.useState([]),[t,p]=o.useState(!0),[u,N]=o.useState(!1),[y,j]=o.useState(!1),[a,l]=o.useState(null),[i,n]=o.useState({title:"",description:"",type:"improvement"}),[d,v]=o.useState({});o.useEffect(()=>{S()},[]);const S=async()=>{try{p(!0);const s=await D.get(`${U.FEEDBACK.LIST}?limit=50`);m(s.data||[])}catch(s){console.error("Error fetching feedbacks:",s)}finally{p(!1)}},_=async s=>{try{await navigator.clipboard.writeText(s),l(s),setTimeout(()=>l(null),2e3)}catch(f){console.error("Failed to copy code:",f)}},x=async s=>{if(s.preventDefault(),v({}),!i.title.trim()){v({title:["El título es obligatorio"]});return}if(i.title.length<5){v({title:["El título debe tener al menos 5 caracteres"]});return}if(!i.description.trim()){v({description:["La descripción es obligatoria"]});return}if(i.description.length<20){v({description:["La descripción debe tener al menos 20 caracteres"]});return}try{N(!0),await D.post(U.FEEDBACK.CREATE,i),n({title:"",description:"",type:"improvement"}),v({}),j(!1),await S()}catch(f){if(console.error("Error submitting feedback:",f),f.response?.status===422){const w=f.response.data;let E={};w?.errors?E=w.errors:w?.data?E=w.data:w&&typeof w=="object"&&!w.message&&(E=w),console.log("Validation errors received:",E),v(E)}else{const w=f.response?.data?.message||f.message||"Error al enviar feedback";v({general:[w]})}}finally{N(!1)}},c=s=>{switch(s){case"pending":return e.jsx(R,{className:"w-5 h-5 text-yellow-500"});case"approved":return e.jsx(G,{className:"w-5 h-5 text-green-500"});case"rejected":return e.jsx(B,{className:"w-5 h-5 text-red-500"})}},h=s=>{switch(s){case"pending":return"Pendiente";case"approved":return"Aprobado";case"rejected":return"Rechazado"}},C=s=>{switch(s){case"bug":return"Error/Bug";case"improvement":return"Mejora";case"other":return"Otro"}},g=s=>new Date(s).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});function P(s){const f=Math.floor(s),w=(s-f)*24,E=Math.floor(w),b=Math.floor((w-E)*60);return`Te quedan ${f} días, ${E} horas y ${b} minutos para utilizar este cupón.`}return t?e.jsx("div",{className:"p-8",children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})})}):e.jsxs("div",{className:"p-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Feedback y Sugerencias"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Comparte tus opiniones, reporta errores o sugiere mejoras. ¡Si tu feedback es aprobado, recibirás un cupón de descuento especial!"})]}),e.jsxs("button",{onClick:()=>j(!y),className:"bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 transition-colors flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4"}),"Nuevo Feedback"]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(k,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900",children:"¿Cómo funciona el sistema de recompensas?"}),e.jsx("p",{className:"text-blue-700 text-sm mt-1",children:"Cuando envías feedback valioso (reportes de bugs, sugerencias útiles, o ideas de mejora), nuestro equipo lo revisa. Si es aprobado, recibirás un cupón de descuento que podrás usar en cualquier compra."})]})]})}),y&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Enviar Nuevo Feedback"}),d.general&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-5 h-5 text-red-600"}),e.jsx("div",{children:d.general.map((s,f)=>e.jsx("p",{className:"text-red-700 text-sm",children:s},f))})]})}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de Feedback"}),e.jsxs("select",{value:i.type,onChange:s=>n({...i,type:s.target.value}),className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent ${d.type?"border-red-300 bg-red-50":"border-gray-300"}`,children:[e.jsx("option",{value:"improvement",children:"Mejora"}),e.jsx("option",{value:"bug",children:"Error/Bug"}),e.jsx("option",{value:"other",children:"Otro"})]}),d.type&&e.jsx("div",{className:"mt-2",children:d.type.map((s,f)=>e.jsx("p",{className:"text-red-600 text-sm",children:s},f))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Título ",e.jsx("span",{className:"text-gray-500",children:"(mínimo 5 caracteres)"})]}),e.jsx("input",{type:"text",value:i.title,onChange:s=>n({...i,title:s.target.value}),placeholder:"Describe brevemente tu feedback",className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent ${d.title?"border-red-300 bg-red-50":"border-gray-300"}`,required:!0}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:[i.title.length,"/100 caracteres"]}),d.title&&e.jsx("div",{className:"mt-2",children:d.title.map((s,f)=>e.jsx("p",{className:"text-red-600 text-sm",children:s},f))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Descripción ",e.jsx("span",{className:"text-gray-500",children:"(mínimo 20 caracteres)"})]}),e.jsx("textarea",{value:i.description,onChange:s=>n({...i,description:s.target.value}),placeholder:"Describe detalladamente tu feedback, sugerencia o el error encontrado",rows:4,className:`w-full p-3 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent ${d.description?"border-red-300 bg-red-50":"border-gray-300"}`,required:!0}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:[i.description.length,"/1000 caracteres"]}),d.description&&e.jsx("div",{className:"mt-2",children:d.description.map((s,f)=>e.jsx("p",{className:"text-red-600 text-sm",children:s},f))})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{type:"submit",disabled:u,className:"bg-primary-600 text-white px-6 py-2 rounded-lg hover:bg-primary-700 transition-colors flex items-center gap-2 disabled:opacity-50",children:[e.jsx(I,{className:"w-4 h-4"}),u?"Enviando...":"Enviar Feedback"]}),e.jsx("button",{type:"button",onClick:()=>j(!1),className:"bg-gray-600 text-white px-6 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancelar"})]})]})]}),e.jsx("div",{className:"space-y-4",children:r.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx($,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No tienes feedback enviado"}),e.jsx("p",{className:"text-gray-500",children:"¡Comparte tus ideas y sugerencias para mejorar la plataforma!"})]}):r.map(s=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-sm text-gray-500",children:C(s.type)}),e.jsx("span",{className:"text-gray-300",children:"•"}),e.jsx("span",{className:"text-sm text-gray-500",children:g(s.created_at)})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[c(s.status),e.jsx("span",{className:`text-sm font-medium ${s.status==="approved"?"text-green-600":s.status==="rejected"?"text-red-600":"text-yellow-600"}`,children:h(s.status)})]})]}),e.jsx("p",{className:"text-gray-700 mb-4",children:s.description}),s.admin_notes&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 mb-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:"Respuesta del equipo:"}),e.jsx("p",{className:"text-gray-700 text-sm",children:s.admin_notes})]}),s.discount_code&&e.jsxs("div",{className:`border rounded-lg p-4 ${s.discount_code.is_used||s.discount_code.is_expired?"bg-red-50 border-red-200":"bg-green-50 border-green-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:`w-5 h-5 ${s.discount_code.is_used||s.discount_code.is_expired?"text-red-600":"text-green-600"}`}),e.jsx("h4",{className:`font-medium ${s.discount_code.is_used||s.discount_code.is_expired?"text-red-900":"text-green-900"}`,children:s.discount_code.is_used?"¡Cupón ya utilizado!":s.discount_code.is_expired?"¡Cupón expirado!":"¡Cupón de descuento disponible!"})]}),!s.discount_code.is_used&&!s.discount_code.is_expired&&e.jsxs("button",{onClick:()=>_(s.discount_code.code),className:"flex items-center gap-1 px-3 py-1 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors text-sm",children:[e.jsx(ee,{className:"w-3 h-3"}),a===s.discount_code.code?"¡Copiado!":"Copiar"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:`font-medium ${s.discount_code.is_used||s.discount_code.is_expired?"text-red-700":"text-green-700"}`,children:"Código:"}),e.jsx("p",{className:`font-mono font-bold ${s.discount_code.is_used||s.discount_code.is_expired?"text-red-900 line-through":"text-green-900"}`,children:s.discount_code.code})]}),e.jsxs("div",{children:[e.jsx("span",{className:`font-medium ${s.discount_code.is_used||s.discount_code.is_expired?"text-red-700":"text-green-700"}`,children:"Descuento:"}),e.jsxs("p",{className:`font-bold ${s.discount_code.is_used||s.discount_code.is_expired?"text-red-900":"text-green-900"}`,children:[s.discount_code.discount_percentage,"% OFF"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:`font-medium ${s.discount_code.is_used||s.discount_code.is_expired?"text-red-700":"text-green-700"}`,children:s.discount_code.is_used?"Usado:":"Válido hasta:"}),e.jsx("p",{className:s.discount_code.is_used||s.discount_code.is_expired?"text-red-900":"text-green-900",children:s.discount_code.is_used&&s.discount_code.used_at?g(s.discount_code.used_at):g(s.discount_code.expires_at)})]})]}),e.jsx("div",{className:"mt-3 pt-2 border-t border-gray-200",children:s.discount_code.is_used?e.jsx("p",{className:"text-red-600 text-sm font-medium",children:"✗ Cupón ya utilizado"}):s.discount_code.is_expired?e.jsx("p",{className:"text-red-600 text-sm font-medium",children:" Cupón expirado"}):e.jsx("p",{className:"text-green-600 text-sm font-medium",children:P(s.discount_code.days_left)})})]})]},s.id))})]})},he=()=>{const{user:r}=F(),[m,t]=o.useState(null),[p,u]=o.useState(!0),[N,y]=o.useState("personal");o.useEffect(()=>{a()},[r?.id]);const j=n=>({id:n.id,name:n.name,email:n.email,emailVerifiedAt:n.email_verified_at,age:n.age,gender:n.gender,location:n.location,created_at:n.created_at}),a=async()=>{u(!0);try{const n=await D.get(U.PROFILE.LIST);if(n){const d=j(n);t(d)}}catch(n){console.error("Error al cargar el perfil del usuario:",n)}finally{u(!1)}},l=n=>{t(n)},i=()=>{if(p)return e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})});switch(N){case"personal":return e.jsx(V,{userProfile:m,onProfileUpdate:l});case"security":return e.jsx(ie,{});case"feedback":return e.jsx(le,{});case"seller-application":return e.jsx(oe,{});default:return e.jsx(V,{userProfile:m,onProfileUpdate:l})}};return e.jsxs("div",{className:"container mx-auto px-4 lg:px-20 py-10",children:[e.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Mi Perfil"}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[e.jsx(re,{activeTab:N,setActiveTab:y,userCreatedAt:m?.created_at,userName:m?.name,userEmail:m?.email}),e.jsx("div",{className:"lg:w-3/4",children:e.jsx("div",{className:"bg-white rounded-xl shadow-lg overflow-hidden",children:i()})})]})]})};export{he as default};
//# sourceMappingURL=UserProfilePage-CLU6jxZu.js.map
