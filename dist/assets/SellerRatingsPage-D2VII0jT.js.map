{"version":3,"file":"SellerRatingsPage-D2VII0jT.js","sources":["../../src/presentation/components/rating/RatingsSummary.tsx","../../src/presentation/hooks/useSellerRatings.ts","../../src/presentation/pages/seller/SellerRatingsPage.tsx"],"sourcesContent":["import React from \"react\";\r\nimport {Star} from \"lucide-react\";\r\nimport StarRating from \"./StarRating\";\r\n\r\ninterface RatingsSummaryProps {\r\n\taverageRating: number;\r\n\ttotalRatings: number;\r\n\tdistribution: {\r\n\t\t\"1\": number;\r\n\t\t\"2\": number;\r\n\t\t\"3\": number;\r\n\t\t\"4\": number;\r\n\t\t\"5\": number;\r\n\t};\r\n\tclassName?: string;\r\n}\r\n\r\n/**\r\n * Componente para mostrar un resumen de las valoraciones\r\n * Incluye valoración media, total y distribución por estrellas\r\n */\r\nconst RatingsSummary: React.FC<RatingsSummaryProps> = ({\r\n\taverageRating,\r\n\ttotalRatings,\r\n\tdistribution,\r\n\tclassName = \"\",\r\n}) => {\r\n\t// Calcular porcentajes para cada nivel de estrellas\r\n\tconst calculatePercentage = (count: number): number => {\r\n\t\treturn totalRatings > 0 ? (count / totalRatings) * 100 : 0;\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div\r\n\t\t\tclassName={`bg-white rounded-lg shadow-sm p-4 ${className}`}\r\n\t\t>\r\n\t\t\t<div className=\"flex flex-col md:flex-row items-start md:items-center\">\r\n\t\t\t\t{/* Valoración promedio */}\r\n\t\t\t\t<div className=\"flex flex-col items-center mb-4 md:mb-0 md:mr-8\">\r\n\t\t\t\t\t<div className=\"text-3xl font-bold text-gray-900\">\r\n\t\t\t\t\t\t{averageRating.toFixed(1)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<StarRating value={averageRating} readOnly size=\"small\" />\r\n\t\t\t\t\t<div className=\"text-sm text-gray-500 mt-1\">\r\n\t\t\t\t\t\t({totalRatings} {totalRatings === 1 ? \"valoración\" : \"valoraciones\"}\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{/* Distribución de estrellas */}\r\n\t\t\t\t<div className=\"flex-grow w-full md:w-auto\">\r\n\t\t\t\t\t{[5, 4, 3, 2, 1].map((stars) => {\r\n\t\t\t\t\t\tconst count = distribution[stars.toString() as keyof typeof distribution] || 0;\r\n\t\t\t\t\t\tconst percentage = calculatePercentage(count);\r\n\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<div key={stars} className=\"flex items-center mb-1\">\r\n\t\t\t\t\t\t\t\t<div className=\"flex items-center w-16 text-sm text-gray-600\">\r\n\t\t\t\t\t\t\t\t\t<span>{stars}</span>\r\n\t\t\t\t\t\t\t\t\t<Star size={12} className=\"ml-1 text-yellow-400\" />\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<div className=\"flex-grow mx-2\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"h-2 bg-gray-200 rounded-full overflow-hidden\">\r\n\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"h-full bg-yellow-400 rounded-full\"\r\n\t\t\t\t\t\t\t\t\t\t\tstyle={{width: `${percentage}%`}}\r\n\t\t\t\t\t\t\t\t\t\t></div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<div className=\"w-12 text-right text-xs text-gray-500\">\r\n\t\t\t\t\t\t\t\t\t{count} ({percentage.toFixed(0)}%)\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t})}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default RatingsSummary;\r\n","// src/presentation/hooks/useSellerRatings.ts\r\nimport {useState, useEffect, useCallback, useMemo, useRef} from \"react\";\r\nimport RatingService from \"../../core/services/RatingService\";\r\nimport type {ExtendedRating} from \"../types/ratingTypes\";\r\nimport {extractErrorMessage} from \"../../utils/errorHandler\";\r\n\r\n// Estructura para las estadísticas de valoraciones\r\ninterface RatingStats {\r\n\taverageRating: number;\r\n\ttotalCount: number;\r\n\tdistribution: {\r\n\t\t\"1\": number;\r\n\t\t\"2\": number;\r\n\t\t\"3\": number;\r\n\t\t\"4\": number;\r\n\t\t\"5\": number;\r\n\t};\r\n\tstatusCounts: {\r\n\t\tpending: number;\r\n\t\tapproved: number;\r\n\t\trejected: number;\r\n\t};\r\n\tverifiedCount: number;\r\n\trespondedCount: number;\r\n}\r\n\r\n/**\r\n * Hook personalizado para gestionar las valoraciones del vendedor\r\n */\r\nexport const useSellerRatings = () => {\r\n\t// Usamos useRef para mantener la misma instancia del servicio entre renderizados\r\n\tconst ratingServiceRef = useRef<RatingService>(new RatingService());\r\n\tconst ratingService = ratingServiceRef.current;\r\n\r\n\t// Estados\r\n\tconst [ratings, setRatings] = useState<ExtendedRating[]>([]);\r\n\tconst [loading, setLoading] = useState<boolean>(true);\r\n\tconst [error, setError] = useState<string | null>(null);\r\n\r\n\t// Filtros\r\n\tconst [searchTerm, setSearchTerm] = useState<string>(\"\");\r\n\tconst [statusFilter, setStatusFilter] = useState<string>(\"all\");\r\n\tconst [ratingFilter, setRatingFilter] = useState<string>(\"all\");\r\n\tconst [verifiedFilter, setVerifiedFilter] = useState<string>(\"all\");\r\n\tconst [productFilter, setProductFilter] = useState<string>(\"all\");\r\n\r\n\t// Paginación\r\n\tconst [pagination, setPagination] = useState({\r\n\t\tcurrentPage: 1,\r\n\t\ttotalPages: 1,\r\n\t\ttotalItems: 0,\r\n\t\titemsPerPage: 10,\r\n\t});\r\n\r\n\t// Cargar valoraciones\r\n\tconst fetchRatings = useCallback(async () => {\r\n\t\tsetLoading(true);\r\n\t\tsetError(null);\r\n\r\n\t\ttry {\r\n\t\t\tconst response = await ratingService.getMyReceivedRatings(\r\n\t\t\t\tpagination.currentPage,\r\n\t\t\t\tpagination.itemsPerPage,\r\n\t\t\t\tstatusFilter !== \"all\" ? statusFilter : undefined\r\n\t\t\t);\r\n\r\n\t\t\tif (response) {\r\n\t\t\t\tsetRatings(response.data);\r\n\r\n\t\t\t\t// Actualizar paginación\r\n\t\t\t\tsetPagination((prev) => ({\r\n\t\t\t\t\t...prev,\r\n\t\t\t\t\ttotalPages: response.meta.last_page,\r\n\t\t\t\t\ttotalItems: response.meta.total,\r\n\t\t\t\t}));\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error(\"Error al obtener valoraciones:\", err);\r\n\t\t\tconst errorMessage = extractErrorMessage(\r\n\t\t\t\terr,\r\n\t\t\t\t\"Error al cargar valoraciones\"\r\n\t\t\t);\r\n\t\t\tsetError(errorMessage);\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t}, [pagination.currentPage, pagination.itemsPerPage, statusFilter]);\r\n\r\n\t// Cargar datos al montar el componente\r\n\tuseEffect(() => {\r\n\t\tfetchRatings();\r\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\r\n\t}, []);\r\n\r\n\t// Función para cambiar de página\r\n\tconst handlePageChange = (page: number) => {\r\n\t\tsetPagination((prev) => ({\r\n\t\t\t...prev,\r\n\t\t\tcurrentPage: page,\r\n\t\t}));\r\n\t\t// Llamar directamente a fetchRatings después de actualizar la página\r\n\t\tsetTimeout(() => fetchRatings(), 0);\r\n\t};\r\n\r\n\t// Función para cambiar filtro de estado\r\n\tconst handleStatusFilterChange = (value: string) => {\r\n\t\tsetStatusFilter(value);\r\n\t\tsetPagination((prev) => ({\r\n\t\t\t...prev,\r\n\t\t\tcurrentPage: 1,\r\n\t\t}));\r\n\t\t// Llamar directamente a fetchRatings después de actualizar el filtro\r\n\t\tsetTimeout(() => fetchRatings(), 0);\r\n\t};\r\n\r\n\t// Función para limpiar filtros\r\n\tconst clearFilters = () => {\r\n\t\tsetSearchTerm(\"\");\r\n\t\tsetStatusFilter(\"all\");\r\n\t\tsetRatingFilter(\"all\");\r\n\t\tsetVerifiedFilter(\"all\");\r\n\t\tsetProductFilter(\"all\");\r\n\t\tsetPagination((prev) => ({\r\n\t\t\t...prev,\r\n\t\t\tcurrentPage: 1,\r\n\t\t}));\r\n\t\t// Llamar directamente a fetchRatings después de limpiar filtros\r\n\t\tsetTimeout(() => fetchRatings(), 0);\r\n\t};\r\n\r\n\t// Función para responder a una valoración\r\n\tconst replyToRating = async (ratingId: number, replyText: string) => {\r\n\t\ttry {\r\n\t\t\tconst response = await ratingService.replyToRating({\r\n\t\t\t\trating_id: ratingId,\r\n\t\t\t\treply_text: replyText,\r\n\t\t\t});\r\n\r\n\t\t\t// Recargar valoraciones tras responder\r\n\t\t\tfetchRatings();\r\n\r\n\t\t\treturn response;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al responder valoración:\", error);\r\n\t\t\tthrow error;\r\n\t\t}\r\n\t};\r\n\r\n\t// Función para reportar una valoración\r\n\tconst reportRating = async (ratingId: number, reason: string) => {\r\n\t\ttry {\r\n\t\t\tconst response = await ratingService.reportRating({\r\n\t\t\t\trating_id: ratingId,\r\n\t\t\t\treason,\r\n\t\t\t});\r\n\r\n\t\t\t// Recargar valoraciones tras reportar\r\n\t\t\tfetchRatings();\r\n\r\n\t\t\treturn response;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al reportar valoración:\", error);\r\n\t\t\tthrow error;\r\n\t\t}\r\n\t};\r\n\r\n\t// Calcular estadísticas\r\n\tconst stats = useMemo(() => {\r\n\t\tconst defaultStats: RatingStats = {\r\n\t\t\taverageRating: 0,\r\n\t\t\ttotalCount: 0,\r\n\t\t\tdistribution: {\r\n\t\t\t\t\"1\": 0,\r\n\t\t\t\t\"2\": 0,\r\n\t\t\t\t\"3\": 0,\r\n\t\t\t\t\"4\": 0,\r\n\t\t\t\t\"5\": 0,\r\n\t\t\t},\r\n\t\t\tstatusCounts: {\r\n\t\t\t\tpending: 0,\r\n\t\t\t\tapproved: 0,\r\n\t\t\t\trejected: 0,\r\n\t\t\t},\r\n\t\t\tverifiedCount: 0,\r\n\t\t\trespondedCount: 0,\r\n\t\t};\r\n\r\n\t\tif (!ratings.length) return defaultStats;\r\n\r\n\t\t// Calcular contadores\r\n\t\tlet totalRating = 0;\r\n\t\tconst distribution = {\"1\": 0, \"2\": 0, \"3\": 0, \"4\": 0, \"5\": 0};\r\n\t\tconst statusCounts = {pending: 0, approved: 0, rejected: 0};\r\n\t\tlet verifiedCount = 0;\r\n\t\tlet respondedCount = 0;\r\n\r\n\t\tratings.forEach((rating) => {\r\n\t\t\t// Suma para el promedio\r\n\t\t\ttotalRating += rating.rating;\r\n\r\n\t\t\t// Distribución de estrellas\r\n\t\t\tconst ratingKey = String(rating.rating) as keyof typeof distribution;\r\n\t\t\tdistribution[ratingKey]++;\r\n\r\n\t\t\t// Estado\r\n\t\t\tstatusCounts[rating.status as keyof typeof statusCounts]++;\r\n\r\n\t\t\t// Compras verificadas\r\n\t\t\tif (rating.is_verified_purchase) {\r\n\t\t\t\tverifiedCount++;\r\n\t\t\t}\r\n\r\n\t\t\t// Valoraciones con respuesta\r\n\t\t\tif (rating.seller_response) {\r\n\t\t\t\trespondedCount++;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn {\r\n\t\t\taverageRating: ratings.length ? totalRating / ratings.length : 0,\r\n\t\t\ttotalCount: ratings.length,\r\n\t\t\tdistribution,\r\n\t\t\tstatusCounts,\r\n\t\t\tverifiedCount,\r\n\t\t\trespondedCount,\r\n\t\t};\r\n\t}, [ratings]);\r\n\r\n\t// Aplicar filtros a las valoraciones\r\n\tconst filteredRatings = useMemo(() => {\r\n\t\treturn ratings.filter((rating) => {\r\n\t\t\t// Filtro por término de búsqueda\r\n\t\t\tif (searchTerm && !matchesSearchTerm(rating, searchTerm)) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\t// Filtro por puntuación\r\n\t\t\tif (ratingFilter !== \"all\" && String(rating.rating) !== ratingFilter) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\t// Filtro por estado\r\n\t\t\tif (statusFilter !== \"all\" && rating.status !== statusFilter) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\t// Filtro por compra verificada\r\n\t\t\tif (verifiedFilter === \"verified\" && !rating.is_verified_purchase) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif (verifiedFilter === \"unverified\" && rating.is_verified_purchase) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\t// Filtro por producto\r\n\t\t\tif (\r\n\t\t\t\tproductFilter !== \"all\" &&\r\n\t\t\t\tString(rating.product_id) !== productFilter\r\n\t\t\t) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\treturn true;\r\n\t\t});\r\n\t}, [\r\n\t\tratings,\r\n\t\tsearchTerm,\r\n\t\tratingFilter,\r\n\t\tstatusFilter,\r\n\t\tverifiedFilter,\r\n\t\tproductFilter,\r\n\t]);\r\n\r\n\t// Función auxiliar para buscar términos en diferentes campos\r\n\tconst matchesSearchTerm = (rating: ExtendedRating, term: string): boolean => {\r\n\t\tconst searchLower = term.toLowerCase();\r\n\r\n\t\t// Buscar en título y comentario\r\n\t\tif (\r\n\t\t\t(rating.title && rating.title.toLowerCase().includes(searchLower)) ||\r\n\t\t\t(rating.comment && rating.comment.toLowerCase().includes(searchLower))\r\n\t\t) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t// Buscar en datos de usuario\r\n\t\tif (\r\n\t\t\trating.user &&\r\n\t\t\trating.user.name &&\r\n\t\t\trating.user.name.toLowerCase().includes(searchLower)\r\n\t\t) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t// Buscar en datos de producto\r\n\t\tif (\r\n\t\t\trating.product &&\r\n\t\t\trating.product.name &&\r\n\t\t\trating.product.name.toLowerCase().includes(searchLower)\r\n\t\t) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t};\r\n\r\n\t// Obtener lista única de productos para los filtros\r\n\tconst getUniqueProducts = useCallback(() => {\r\n\t\tconst uniqueProducts = new Map();\r\n\r\n\t\tratings.forEach((rating) => {\r\n\t\t\tif (rating.product_id && rating.product?.name) {\r\n\t\t\t\tuniqueProducts.set(String(rating.product_id), {\r\n\t\t\t\t\tid: String(rating.product_id),\r\n\t\t\t\t\tname: rating.product.name,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn Array.from(uniqueProducts.values());\r\n\t}, [ratings]);\r\n\r\n\treturn {\r\n\t\tratings,\r\n\t\tfilteredRatings,\r\n\t\tloading,\r\n\t\terror,\r\n\t\tstats,\r\n\t\tpagination,\r\n\t\thandlePageChange,\r\n\t\tsearchTerm,\r\n\t\tsetSearchTerm,\r\n\t\tstatusFilter,\r\n\t\tsetStatusFilter: handleStatusFilterChange, // Reemplazamos setStatusFilter con la nueva función\r\n\t\tratingFilter,\r\n\t\tsetRatingFilter,\r\n\t\tverifiedFilter,\r\n\t\tsetVerifiedFilter,\r\n\t\tproductFilter,\r\n\t\tsetProductFilter,\r\n\t\tclearFilters,\r\n\t\tfetchRatings,\r\n\t\treplyToRating,\r\n\t\treportRating,\r\n\t\tgetUniqueProducts,\r\n\t};\r\n};\r\n\r\nexport default useSellerRatings;","import React, {useState} from \"react\";\r\nimport {Link} from \"react-router-dom\";\r\nimport {\r\n\tClock,\r\n\tSearch,\r\n\tFilter,\r\n\tRefreshCw,\r\n\tMessageSquare,\r\n\tAlertTriangle,\r\n\tFlag,\r\n\tPackage,\r\n\tEye,\r\n\tCheckCircle,\r\n\tXCircle,\r\n} from \"lucide-react\";\r\n\r\nimport Table from \"../../components/dashboard/Table\";\r\nimport RatingStars from \"../../components/common/RatingStars\";\r\nimport {formatDate} from \"../../../utils/formatters/formatDate\";\r\nimport RatingsSummary from \"../../components/rating/RatingsSummary\";\r\nimport {useSellerRatings} from \"../../hooks/useSellerRatings\";\r\nimport type {ExtendedRating} from \"../../types/ratingTypes\";\r\n\r\nconst SellerRatingsPage: React.FC = () => {\r\n\t// Estados para respuesta y reporte\r\n\tconst [replyRatingId, setReplyRatingId] = useState<number | null>(null);\r\n\tconst [replyText, setReplyText] = useState<string>(\"\");\r\n\tconst [reportRatingId, setReportRatingId] = useState<number | null>(null);\r\n\tconst [reportReason, setReportReason] = useState<string>(\"\");\r\n\tconst [isSubmitting, setIsSubmitting] = useState<boolean>(false);\r\n\r\n\t// Usar nuestro hook personalizado para gestionar las valoraciones\r\n\tconst {\r\n\t\tfilteredRatings,\r\n\t\tloading,\r\n\t\terror,\r\n\t\tstats,\r\n\t\tstatusFilter,\r\n\t\tsetStatusFilter,\r\n\t\tratingFilter,\r\n\t\tsetRatingFilter,\r\n\t\tverifiedFilter,\r\n\t\tsetVerifiedFilter,\r\n\t\tproductFilter,\r\n\t\tsetProductFilter,\r\n\t\tsearchTerm,\r\n\t\tsetSearchTerm,\r\n\t\tclearFilters,\r\n\t\tpagination,\r\n\t\thandlePageChange,\r\n\t\tfetchRatings,\r\n\t\treplyToRating,\r\n\t\treportRating,\r\n\t\tgetUniqueProducts,\r\n\t} = useSellerRatings();\r\n\r\n\t// Obtener lista única de productos\r\n\tconst uniqueProducts = getUniqueProducts();\r\n\r\n\t// Manejar respuesta a valoración\r\n\tconst handleReplySubmit = async (e: React.FormEvent) => {\r\n\t\te.preventDefault();\r\n\r\n\t\tif (!replyRatingId || !replyText.trim()) return;\r\n\r\n\t\ttry {\r\n\t\t\tsetIsSubmitting(true);\r\n\r\n\t\t\t// Usar la función del hook\r\n\t\t\tawait replyToRating(replyRatingId, replyText.trim());\r\n\r\n\t\t\t// Mostrar mensaje de éxito\r\n\t\t\talert(\"Respuesta enviada con éxito\");\r\n\r\n\t\t\t// Limpiar formulario\r\n\t\t\tsetReplyRatingId(null);\r\n\t\t\tsetReplyText(\"\");\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al responder valoración:\", error);\r\n\t\t\talert(\"Error al enviar la respuesta\");\r\n\t\t} finally {\r\n\t\t\tsetIsSubmitting(false);\r\n\t\t}\r\n\t};\r\n\r\n\t// Manejar reportar valoración\r\n\tconst handleReportSubmit = async (e: React.FormEvent) => {\r\n\t\te.preventDefault();\r\n\r\n\t\tif (!reportRatingId || !reportReason.trim()) return;\r\n\r\n\t\ttry {\r\n\t\t\tsetIsSubmitting(true);\r\n\r\n\t\t\t// Usar la función del hook\r\n\t\t\tawait reportRating(reportRatingId, reportReason.trim());\r\n\r\n\t\t\t// Mostrar mensaje de éxito\r\n\t\t\talert(\"Reporte enviado con éxito\");\r\n\r\n\t\t\t// Limpiar formulario\r\n\t\t\tsetReportRatingId(null);\r\n\t\t\tsetReportReason(\"\");\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al reportar valoración:\", error);\r\n\t\t\talert(\"Error al enviar el reporte\");\r\n\t\t} finally {\r\n\t\t\tsetIsSubmitting(false);\r\n\t\t}\r\n\t};\r\n\r\n\t// Cancelar respuesta o reporte\r\n\tconst handleCancelAction = () => {\r\n\t\tsetReplyRatingId(null);\r\n\t\tsetReplyText(\"\");\r\n\t\tsetReportRatingId(null);\r\n\t\tsetReportReason(\"\");\r\n\t};\r\n\r\n\t// Definir columnas de la tabla\r\n\tconst columns = [\r\n\t\t{\r\n\t\t\tkey: \"product\",\r\n\t\t\theader: \"Producto\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (rating: ExtendedRating) => (\r\n\t\t\t\t<div className=\"flex items-center space-x-3\">\r\n\t\t\t\t\t{rating.product?.image ? (\r\n\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\tsrc={rating.product.image}\r\n\t\t\t\t\t\t\talt={rating.product.name}\r\n\t\t\t\t\t\t\tclassName=\"w-12 h-12 rounded-md object-cover\"\r\n\t\t\t\t\t\t\tonError={(e) => {\r\n\t\t\t\t\t\t\t\tconst target = e.target as HTMLImageElement;\r\n\t\t\t\t\t\t\t\ttarget.src = \"https://via.placeholder.com/100?text=Producto\";\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<div className=\"w-12 h-12 bg-gray-200 rounded-md flex items-center justify-center\">\r\n\t\t\t\t\t\t\t<Package className=\"w-6 h-6 text-gray-500\" />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\tto={`/seller/products/${rating.product_id}`}\r\n\t\t\t\t\t\t\tclassName=\"font-medium text-primary-600 hover:underline\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{rating.product?.name || `Producto #${rating.product_id}`}\r\n\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t<div className=\"text-xs text-gray-500\">\r\n\t\t\t\t\t\t\tID: {rating.product_id}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"rating\",\r\n\t\t\theader: \"Valoración\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (rating: ExtendedRating) => (\r\n\t\t\t\t<div className=\"flex flex-col items-start space-y-1\">\r\n\t\t\t\t\t<RatingStars rating={rating.rating} size={18} />\r\n\t\t\t\t\t<div className=\"text-sm font-medium\">{rating.rating}/5</div>\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"user\",\r\n\t\t\theader: \"Cliente\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (rating: ExtendedRating) => (\r\n\t\t\t\t<div className=\"flex items-center space-x-2\">\r\n\t\t\t\t\t{rating.user?.avatar ? (\r\n\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\tsrc={rating.user.avatar}\r\n\t\t\t\t\t\t\talt={rating.user.name}\r\n\t\t\t\t\t\t\tclassName=\"w-8 h-8 rounded-full object-cover\"\r\n\t\t\t\t\t\t\tonError={(e) => {\r\n\t\t\t\t\t\t\t\tconst target = e.target as HTMLImageElement;\r\n\t\t\t\t\t\t\t\ttarget.src = \"https://via.placeholder.com/100?text=User\";\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<div className=\"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center\">\r\n\t\t\t\t\t\t\t<span className=\"text-gray-500 text-sm font-medium\">\r\n\t\t\t\t\t\t\t\t{rating.user?.name\r\n\t\t\t\t\t\t\t\t\t? rating.user.name.charAt(0).toUpperCase()\r\n\t\t\t\t\t\t\t\t\t: \"U\"}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<div className=\"font-medium\">\r\n\t\t\t\t\t\t\t{rating.user?.name || `Usuario #${rating.user_id}`}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"flex items-center text-xs text-gray-500\">\r\n\t\t\t\t\t\t\t{rating.is_verified_purchase && (\r\n\t\t\t\t\t\t\t\t<span className=\"flex items-center text-green-600\">\r\n\t\t\t\t\t\t\t\t\t<CheckCircle size={12} className=\"mr-1\" />\r\n\t\t\t\t\t\t\t\t\tCompra verificada\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"comment\",\r\n\t\t\theader: \"Comentario\",\r\n\t\t\trender: (rating: ExtendedRating) => (\r\n\t\t\t\t<div>\r\n\t\t\t\t\t{rating.title && (\r\n\t\t\t\t\t\t<div className=\"font-medium text-gray-900\">\r\n\t\t\t\t\t\t\t{rating.title}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t{rating.comment && (\r\n\t\t\t\t\t\t<div className=\"text-sm text-gray-600 line-clamp-2\">\r\n\t\t\t\t\t\t\t{rating.comment}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t<div className=\"text-xs text-gray-500 mt-1\">\r\n\t\t\t\t\t\t{formatDate(rating.created_at)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"status\",\r\n\t\t\theader: \"Estado\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (rating: ExtendedRating) => {\r\n\t\t\t\tlet statusData = {\r\n\t\t\t\t\ticon: Clock,\r\n\t\t\t\t\tcolorClass:\r\n\t\t\t\t\t\t\"bg-yellow-100 text-yellow-800\",\r\n\t\t\t\t\ttext: \"Pendiente\",\r\n\t\t\t\t};\r\n\r\n\t\t\t\tif (rating.status === \"approved\") {\r\n\t\t\t\t\tstatusData = {\r\n\t\t\t\t\t\ticon: CheckCircle,\r\n\t\t\t\t\t\tcolorClass:\r\n\t\t\t\t\t\t\t\"bg-green-100 text-green-800\",\r\n\t\t\t\t\t\ttext: \"Aprobada\",\r\n\t\t\t\t\t};\r\n\t\t\t\t} else if (rating.status === \"rejected\") {\r\n\t\t\t\t\tstatusData = {\r\n\t\t\t\t\t\ticon: XCircle,\r\n\t\t\t\t\t\tcolorClass:\r\n\t\t\t\t\t\t\t\"bg-red-100 text-red-800\",\r\n\t\t\t\t\t\ttext: \"Rechazada\",\r\n\t\t\t\t\t};\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div className=\"flex flex-col space-y-2\">\r\n\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\tclassName={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${statusData.colorClass}`}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<statusData.icon size={12} className=\"mr-1\" />\r\n\t\t\t\t\t\t\t{statusData.text}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"response\",\r\n\t\t\theader: \"Respuesta\",\r\n\t\t\trender: (rating: ExtendedRating) => (\r\n\t\t\t\t<div>\r\n\t\t\t\t\t{rating.seller_response ? (\r\n\t\t\t\t\t\t<div className=\"text-sm text-gray-600 bg-gray-50 p-2 rounded border border-gray-200\">\r\n\t\t\t\t\t\t\t<div className=\"line-clamp-2\">{rating.seller_response.text}</div>\r\n\t\t\t\t\t\t\t<div className=\"text-xs text-gray-500 mt-1\">\r\n\t\t\t\t\t\t\t\t{formatDate(rating.seller_response.created_at)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<span className=\"text-gray-500 text-sm\">\r\n\t\t\t\t\t\t\tSin respuesta\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"actions\",\r\n\t\t\theader: \"Acciones\",\r\n\t\t\trender: (rating: ExtendedRating) => (\r\n\t\t\t\t<div className=\"flex justify-end space-x-2\">\r\n\t\t\t\t\t{/* Ver detalles completos */}\r\n\t\t\t\t\t<Link\r\n\t\t\t\t\t\tto={`/seller/ratings/${rating.id}`}\r\n\t\t\t\t\t\tclassName=\"p-1 text-blue-600 hover:bg-blue-100 rounded-md\"\r\n\t\t\t\t\t\ttitle=\"Ver detalles completos\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Eye size={18} />\r\n\t\t\t\t\t</Link>\r\n\r\n\t\t\t\t\t{/* Ver producto relacionado */}\r\n\t\t\t\t\t<Link\r\n\t\t\t\t\t\tto={`/seller/products/${rating.product_id}`}\r\n\t\t\t\t\t\tclassName=\"p-1 text-gray-600 hover:bg-gray-100 rounded-md\"\r\n\t\t\t\t\t\ttitle=\"Ver producto\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Package size={18} />\r\n\t\t\t\t\t</Link>\r\n\r\n\t\t\t\t\t{/* Responder a valoración */}\r\n\t\t\t\t\t{!rating.seller_response && (\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tsetReplyRatingId(rating.id || 0);\r\n\t\t\t\t\t\t\t\tsetReplyText(\"\");\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tclassName=\"p-1 text-green-600 hover:bg-green-100 rounded-md\"\r\n\t\t\t\t\t\t\ttitle=\"Responder a la valoración\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<MessageSquare size={18} />\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{/* Reportar valoración */}\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tsetReportRatingId(rating.id || 0);\r\n\t\t\t\t\t\t\tsetReportReason(\"\");\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tclassName=\"p-1 text-orange-600 hover:bg-orange-100 rounded-md0\"\r\n\t\t\t\t\t\ttitle=\"Reportar valoración\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Flag size={18} />\r\n\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t{/* Indicador de alerta para valoraciones negativas sin respuesta */}\r\n\t\t\t\t\t{rating.rating <= 2 && !rating.seller_response && (\r\n\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\tclassName=\"p-1 text-red-600\"\r\n\t\t\t\t\t\t\ttitle=\"Valoración negativa sin respuesta\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<AlertTriangle size={18} />\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t];\r\n\r\n\treturn (\r\n\t\t<div className=\"space-y-6\">\r\n\t\t\t<div className=\"flex justify-between items-center\">\r\n\t\t\t\t<h1 className=\"text-2xl font-bold text-gray-900\">\r\n\t\t\t\t\tValoraciones y Reseñas\r\n\t\t\t\t</h1>\r\n\t\t\t\t<div className=\"flex space-x-2\">\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={() => fetchRatings()}\r\n\t\t\t\t\t\tclassName=\"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors\"\r\n\t\t\t\t\t\tdisabled={loading}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<RefreshCw\r\n\t\t\t\t\t\t\tsize={18}\r\n\t\t\t\t\t\t\tclassName={`inline mr-2 ${loading ? \"animate-spin\" : \"\"}`}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\tActualizar\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Error message */}\r\n\t\t\t{error && (\r\n\t\t\t\t<div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative\">\r\n\t\t\t\t\t<strong className=\"font-bold\">Error: </strong>\r\n\t\t\t\t\t<span className=\"block sm:inline\">{error}</span>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{/* Panel de filtros */}\r\n\t\t\t<div className=\"bg-white rounded-lg shadow-sm p-4\">\r\n\t\t\t\t<div className=\"flex flex-col md:flex-row gap-4\">\r\n\t\t\t\t\t{/* Buscador */}\r\n\t\t\t\t\t<div className=\"relative flex-grow\">\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\tplaceholder=\"Buscar por producto, cliente, comentario...\"\r\n\t\t\t\t\t\t\tclassName=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500\"\r\n\t\t\t\t\t\t\tvalue={searchTerm}\r\n\t\t\t\t\t\t\tonChange={(e) => setSearchTerm(e.target.value)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<Search className=\"absolute left-3 top-2.5 h-5 w-5 text-gray-400\" />\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Filtro de Puntuación */}\r\n\t\t\t\t\t<div className=\"flex items-center space-x-2\">\r\n\t\t\t\t\t\t<Filter className=\"h-5 w-5 text-gray-500\" />\r\n\t\t\t\t\t\t<select\r\n\t\t\t\t\t\t\tclassName=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n\t\t\t\t\t\t\tvalue={ratingFilter}\r\n\t\t\t\t\t\t\tonChange={(e) => setRatingFilter(e.target.value)}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<option value=\"all\">Todas las estrellas</option>\r\n\t\t\t\t\t\t\t<option value=\"5\">5 estrellas</option>\r\n\t\t\t\t\t\t\t<option value=\"4\">4 estrellas</option>\r\n\t\t\t\t\t\t\t<option value=\"3\">3 estrellas</option>\r\n\t\t\t\t\t\t\t<option value=\"2\">2 estrellas</option>\r\n\t\t\t\t\t\t\t<option value=\"1\">1 estrella</option>\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Filtro de Estado */}\r\n\t\t\t\t\t<div className=\"flex items-center space-x-2\">\r\n\t\t\t\t\t\t<select\r\n\t\t\t\t\t\t\tclassName=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n\t\t\t\t\t\t\tvalue={statusFilter}\r\n\t\t\t\t\t\t\tonChange={(e) => setStatusFilter(e.target.value)}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<option value=\"all\">Todos los estados</option>\r\n\t\t\t\t\t\t\t<option value=\"pending\">Pendientes</option>\r\n\t\t\t\t\t\t\t<option value=\"approved\">Aprobadas</option>\r\n\t\t\t\t\t\t\t<option value=\"rejected\">Rechazadas</option>\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Filtro de Producto */}\r\n\t\t\t\t\t{uniqueProducts.length > 0 && (\r\n\t\t\t\t\t\t<div className=\"flex items-center space-x-2\">\r\n\t\t\t\t\t\t\t<select\r\n\t\t\t\t\t\t\t\tclassName=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n\t\t\t\t\t\t\t\tvalue={productFilter}\r\n\t\t\t\t\t\t\t\tonChange={(e) => setProductFilter(e.target.value)}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<option value=\"all\">Todos los productos</option>\r\n\t\t\t\t\t\t\t\t{uniqueProducts.map((product) => (\r\n\t\t\t\t\t\t\t\t\t<option key={product.id} value={product.id}>\r\n\t\t\t\t\t\t\t\t\t\t{product.name}\r\n\t\t\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t</select>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{/* Filtro de Compra Verificada */}\r\n\t\t\t\t\t<div className=\"flex items-center space-x-2\">\r\n\t\t\t\t\t\t<select\r\n\t\t\t\t\t\t\tclassName=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n\t\t\t\t\t\t\tvalue={verifiedFilter}\r\n\t\t\t\t\t\t\tonChange={(e) => setVerifiedFilter(e.target.value)}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<option value=\"all\">Todas las compras</option>\r\n\t\t\t\t\t\t\t<option value=\"verified\">Compras verificadas</option>\r\n\t\t\t\t\t\t\t<option value=\"unverified\">Compras no verificadas</option>\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Botón para limpiar filtros */}\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={clearFilters}\r\n\t\t\t\t\t\tclassName=\"bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tLimpiar filtros\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Estadísticas resumidas */}\r\n\t\t\t<RatingsSummary\r\n\t\t\t\taverageRating={stats.averageRating}\r\n\t\t\t\ttotalRatings={stats.totalCount}\r\n\t\t\t\tdistribution={stats.distribution}\r\n\t\t\t/>\r\n\r\n\t\t\t<div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n\t\t\t\t<div className=\"bg-white rounded-lg shadow-sm p-4\">\r\n\t\t\t\t\t<div className=\"flex justify-between items-start\">\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<h3 className=\"text-sm font-medium text-gray-500\">\r\n\t\t\t\t\t\t\t\tPendientes\r\n\t\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t\t<p className=\"text-2xl font-bold text-yellow-600\">\r\n\t\t\t\t\t\t\t\t{stats.statusCounts.pending}\r\n\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"p-2 bg-yellow-50 rounded-lg\">\r\n\t\t\t\t\t\t\t<Clock className=\"h-5 w-5 text-yellow-600\" />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div className=\"bg-white rounded-lg shadow-sm p-4\">\r\n\t\t\t\t\t<div className=\"flex justify-between items-start\">\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<h3 className=\"text-sm font-medium text-gray-500\">\r\n\t\t\t\t\t\t\t\tAprobadas\r\n\t\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t\t<p className=\"text-2xl font-bold text-green-600\">\r\n\t\t\t\t\t\t\t\t{stats.statusCounts.approved}\r\n\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"p-2 bg-green-50 rounded-lg\">\r\n\t\t\t\t\t\t\t<CheckCircle className=\"h-5 w-5 text-green-600\" />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div className=\"bg-white rounded-lg shadow-sm p-4\">\r\n\t\t\t\t\t<div className=\"flex justify-between items-start\">\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<h3 className=\"text-sm font-medium text-gray-500\">\r\n\t\t\t\t\t\t\t\tRespondidas\r\n\t\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t\t<p className=\"text-2xl font-bold text-blue-600\">\r\n\t\t\t\t\t\t\t\t{stats.respondedCount}\r\n\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"p-2 bg-blue-50 rounded-lg\">\r\n\t\t\t\t\t\t\t<MessageSquare className=\"h-5 w-5 text-blue-600\" />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Formulario para responder a una valoración */}\r\n\t\t\t{replyRatingId && (\r\n\t\t\t\t<div className=\"bg-white rounded-lg shadow-sm p-6 border-l-4 border-green-500\">\r\n\t\t\t\t\t<h3 className=\"text-lg font-medium text-gray-900 mb-4\">\r\n\t\t\t\t\t\tResponder a la valoración\r\n\t\t\t\t\t</h3>\r\n\t\t\t\t\t<form onSubmit={handleReplySubmit} className=\"space-y-4\">\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\t\thtmlFor=\"reply-text\"\r\n\t\t\t\t\t\t\t\tclassName=\"block text-sm font-medium text-gray-700 mb-2\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tTu respuesta\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<textarea\r\n\t\t\t\t\t\t\t\tid=\"reply-text\"\r\n\t\t\t\t\t\t\t\trows={4}\r\n\t\t\t\t\t\t\t\tclassName=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500\"\r\n\t\t\t\t\t\t\t\tplaceholder=\"Escribe tu respuesta a esta valoración...\"\r\n\t\t\t\t\t\t\t\tvalue={replyText}\r\n\t\t\t\t\t\t\t\tonChange={(e) => setReplyText(e.target.value)}\r\n\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t></textarea>\r\n\t\t\t\t\t\t\t<p className=\"mt-1 text-sm text-gray-500\">\r\n\t\t\t\t\t\t\t\tTu respuesta será visible públicamente para todos los usuarios.\r\n\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"flex justify-end space-x-3\">\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\tonClick={handleCancelAction}\r\n\t\t\t\t\t\t\t\tclassName=\"px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300\"\r\n\t\t\t\t\t\t\t\tdisabled={isSubmitting}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tCancelar\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\t\t\tclassName=\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700\"\r\n\t\t\t\t\t\t\t\tdisabled={!replyText.trim() || isSubmitting}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{isSubmitting ? \"Enviando...\" : \"Enviar respuesta\"}\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</form>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{/* Formulario para reportar una valoración */}\r\n\t\t\t{reportRatingId && (\r\n\t\t\t\t<div className=\"bg-white rounded-lg shadow-sm p-6 border-l-4 border-orange-500\">\r\n\t\t\t\t\t<h3 className=\"text-lg font-medium text-gray-900 mb-4\">\r\n\t\t\t\t\t\tReportar valoración\r\n\t\t\t\t\t</h3>\r\n\t\t\t\t\t<form onSubmit={handleReportSubmit} className=\"space-y-4\">\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\t\thtmlFor=\"report-reason\"\r\n\t\t\t\t\t\t\t\tclassName=\"block text-sm font-medium text-gray-700 mb-2\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tMotivo del reporte\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<textarea\r\n\t\t\t\t\t\t\t\tid=\"report-reason\"\r\n\t\t\t\t\t\t\t\trows={4}\r\n\t\t\t\t\t\t\t\tclassName=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500\"\r\n\t\t\t\t\t\t\t\tplaceholder=\"Describe por qué consideras que esta valoración debe ser revisada...\"\r\n\t\t\t\t\t\t\t\tvalue={reportReason}\r\n\t\t\t\t\t\t\t\tonChange={(e) => setReportReason(e.target.value)}\r\n\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t></textarea>\r\n\t\t\t\t\t\t\t<p className=\"mt-1 text-sm text-gray-500\">\r\n\t\t\t\t\t\t\t\tTu reporte será revisado por el equipo de moderación.\r\n\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"flex justify-end space-x-3\">\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\tonClick={handleCancelAction}\r\n\t\t\t\t\t\t\t\tclassName=\"px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300\"\r\n\t\t\t\t\t\t\t\tdisabled={isSubmitting}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tCancelar\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\t\t\tclassName=\"px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700\"\r\n\t\t\t\t\t\t\t\tdisabled={!reportReason.trim() || isSubmitting}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{isSubmitting ? \"Enviando...\" : \"Enviar reporte\"}\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</form>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{/* Tabla de Valoraciones */}\r\n\t\t\t<Table\r\n\t\t\t\tdata={filteredRatings}\r\n\t\t\t\tcolumns={columns}\r\n\t\t\t\tsearchFields={[\"title\", \"comment\"]}\r\n\t\t\t\tloading={loading}\r\n\t\t\t\temptyMessage=\"No se encontraron valoraciones\"\r\n\t\t\t\tpagination={{\r\n\t\t\t\t\tcurrentPage: pagination.currentPage,\r\n\t\t\t\t\ttotalPages: pagination.totalPages,\r\n\t\t\t\t\ttotalItems: pagination.totalItems,\r\n\t\t\t\t\titemsPerPage: pagination.itemsPerPage,\r\n\t\t\t\t\tonPageChange: handlePageChange,\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default SellerRatingsPage;\r\n"],"names":["RatingsSummary","averageRating","totalRatings","distribution","className","calculatePercentage","count","jsx","jsxs","StarRating","stars","percentage","Star","useSellerRatings","ratingService","useRef","RatingService","ratings","setRatings","useState","loading","setLoading","error","setError","searchTerm","setSearchTerm","statusFilter","setStatusFilter","ratingFilter","setRatingFilter","verifiedFilter","setVerifiedFilter","productFilter","setProductFilter","pagination","setPagination","fetchRatings","useCallback","response","prev","err","errorMessage","extractErrorMessage","useEffect","handlePageChange","page","handleStatusFilterChange","value","clearFilters","replyToRating","ratingId","replyText","reportRating","reason","stats","useMemo","defaultStats","totalRating","statusCounts","verifiedCount","respondedCount","rating","ratingKey","filteredRatings","matchesSearchTerm","term","searchLower","getUniqueProducts","uniqueProducts","SellerRatingsPage","replyRatingId","setReplyRatingId","setReplyText","reportRatingId","setReportRatingId","reportReason","setReportReason","isSubmitting","setIsSubmitting","handleReplySubmit","e","handleReportSubmit","handleCancelAction","columns","target","Package","Link","RatingStars","CheckCircle","formatDate","statusData","Clock","XCircle","Eye","MessageSquare","Flag","AlertTriangle","RefreshCw","Search","Filter","product","Table"],"mappings":"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"}