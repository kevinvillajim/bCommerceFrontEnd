import{j as e,q as W,au as D,C as I,a as $,ai as H,aD as M,aE as U,aF as B,H as q,aG as V,aH as G,al as Z,ap as J,a3 as K}from"./ui-vendor-BUNMIuFe.js";import{r as d,L as Q}from"./react-vendor-Cy458wKG.js";import{u as O,N as C}from"./checkout-chunk-C5n3Mg9L.js";import{P as F}from"./ProductCardCompact-Bkz7-06O.js";import{P as T}from"./seller-chunk-6swISJwY.js";import{c as L}from"./admin-chunk-BNcFjXlJ.js";import{u as X}from"./useFavorites-Djw2mJtN.js";import{b as Y}from"./index-BStY3ojk.js";import"./chat-chunk-BRsdDZXf.js";import"./utils-vendor-DeGC_a19.js";const ee=({images:t,autoPlay:r=!0,autoPlayInterval:a=5e3})=>{const[o,c]=d.useState(0);d.useEffect(()=>{if(!r)return;const f=setInterval(()=>{c(x=>(x+1)%t.length)},a);return()=>clearInterval(f)},[r,a,t.length]);const l=()=>{c(f=>(f+1)%t.length)},n=()=>{c(f=>(f-1+t.length)%t.length)},m=f=>{c(f)};return e.jsxs("div",{className:"relative w-full h-[45vh] overflow-hidden image-slider",children:[e.jsx("div",{className:"relative w-full h-full",children:t.map((f,x)=>e.jsx("div",{className:`absolute top-0 left-0 w-full h-full transition-opacity duration-500 ease-in-out
              ${x===o?"opacity-100 z-20":"opacity-0 z-10"}`,children:e.jsxs("div",{className:"relative w-full h-full flex justify-center items-center",children:[e.jsx("div",{className:"w-[80%] h-full z-20 relative",children:e.jsx("img",{src:f,alt:`Slide ${x+1}`,className:"w-full h-full object-cover rounded-lg shadow-lg"})}),e.jsx("div",{className:"absolute inset-0 z-10",children:e.jsx("img",{src:f,alt:`Slide background ${x+1}`,className:"w-full h-full object-cover filter blur-sm opacity-50"})})]})},x))}),e.jsx("button",{onClick:n,className:"hover:opacity-100 hover:border-1 hover:border-blue-200 opacity-75 cursor-pointer absolute left-4 top-1/2 transform -translate-y-1/2 z-30 bg-black bg-opacity-30 hover:bg-opacity-50 text-white p-3 rounded-full transition-all","aria-label":"Previous slide",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("button",{onClick:l,className:"hover:opacity-100 hover:border-1 hover:border-blue-200 opacity-75 cursor-pointer absolute right-4 top-1/2 transform -translate-y-1/2 z-30 bg-black bg-opacity-30 hover:bg-opacity-50 text-white p-3 rounded-full transition-all","aria-label":"Next slide",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),e.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 z-30 flex space-x-2",children:t.map((f,x)=>e.jsx("button",{onClick:()=>m(x),className:`cursor-pointer w-2 h-2 rounded-full transition-all ${x===o?"bg-white scale-110":"bg-white bg-opacity-50 hover:bg-opacity-75"}`,"aria-label":`Go to slide ${x+1}`},x))})]})},te=({category:t,icon:r,link:a=void 0})=>e.jsx("a",{href:a,children:e.jsxs("div",{className:"cursor-pointer bg-white shadow-md hover:shadow-xl rounded-xl p-6 text-center transition-all duration-300 hover:scale-105 border border-gray-50 category-card",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 bg-gray-100 rounded-full flex items-center justify-center text-gray-600 hover:text-primary-600 hover:bg-primary-50 transition-colors category-icon",children:e.jsx(r,{size:28,strokeWidth:1.5})}),e.jsx("h3",{className:"font-medium text-gray-800 tracking-wide",children:t})]})}),ae=({categories:t})=>e.jsx("div",{className:"max-w-4xl mx-auto p-4",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:t.map((r,a)=>e.jsx(te,{category:r.title,icon:r.icon,link:r.link},`${r.id} - ${a}`))})}),re=({slides:t,interval:r=5e3})=>{const[a,o]=d.useState(0);d.useEffect(()=>{const l=setInterval(()=>{o(n=>(n+1)%t.length)},r);return()=>clearInterval(l)},[t.length,r]);const c=l=>{o(l)};return e.jsxs("div",{className:"relative overflow-hidden rounded-xl h-96 text-slider",children:[t.map((l,n)=>e.jsx("div",{className:`absolute inset-0 w-full h-full transition-opacity duration-700 ${a===n?"opacity-100":"opacity-0 pointer-events-none"}`,style:{backgroundImage:`linear-gradient(${l.color}, ${l.color}), url(${l.image})`,backgroundSize:"cover",backgroundPosition:"center",backgroundBlendMode:"multiply"},children:e.jsx("div",{className:"relative h-full flex flex-col justify-center p-8 md:p-12 items-start text-left",children:e.jsxs("div",{className:"max-w-md",children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-4 text-white",children:l.title}),e.jsx("p",{className:"text-lg md:text-xl mb-6 text-white opacity-90",children:l.description}),e.jsx("button",{onClick:l.buttonAction,className:"cursor-pointer bg-white text-gray-900 font-medium px-6 py-3 rounded-md hover:bg-gray-100 transition-colors",children:l.buttonText})]})})},n)),e.jsx("div",{className:"absolute bottom-4 left-0 right-0 flex justify-center space-x-2",children:t.map((l,n)=>e.jsx("button",{onClick:()=>c(n),className:`cursor-pointer w-2 h-2 rounded-full transition-all duration-300 ${a===n?"bg-white scale-125":"bg-white bg-opacity-50 hover:bg-opacity-75"}`,"aria-label":`Go to slide ${n+1}`},n))})]})},se=({products:t=[],title:r,onClick:a})=>{const{addToCart:o,showNotification:c}=O(),[l,n]=d.useState({}),m=(s,p=0)=>{if(typeof s=="number")return s;if(typeof s=="string"){const h=parseFloat(s);return isNaN(h)?p:h}return p},f=s=>{if(s.final_price!==void 0)return m(s.final_price);const p=m(s.price),h=m(s.discount_percentage)||m(s.discount)||0;return h>0?p-p*(h/100):p},x=s=>m(s.discount_percentage)||m(s.discount)||0,y=s=>s.main_image||s.image||"https://via.placeholder.com/400x300/f3f4f6/9ca3af?text=Sin+Imagen",u=s=>`$${s.toFixed(2)}`,g=async s=>{if(!(!s.id||l[s.id])){n(p=>({...p,[s.id]:!0}));try{a?a(s.id):await o({productId:s.id,quantity:1})?c(C.SUCCESS,`${s.name} ha sido agregado al carrito`):c(C.ERROR,"Error al agregar producto al carrito")}catch(p){console.error("Error adding to cart:",p),c(C.ERROR,"Error al agregar producto al carrito")}finally{setTimeout(()=>{s.id&&n(p=>({...p,[s.id]:!1}))},500)}}};return e.jsxs("section",{className:"mb-12",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:r}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(s=>{const p=f(s),h=x(s),R=h>0,P=y(s);return e.jsxs("div",{className:"bg-white shadow rounded-xl overflow-hidden hover:shadow-lg transition-all duration-300 group",children:[e.jsx("div",{className:"h-48 bg-gray-100 relative overflow-hidden",style:{backgroundImage:`url("${P}")`,backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat"},onError:i=>{const b=i.target;b.style.backgroundImage='url("https://via.placeholder.com/400x300/f3f4f6/9ca3af?text=Error+Imagen")'},children:R&&e.jsxs("div",{className:"absolute top-3 right-3 bg-primary-600 text-white text-sm font-medium px-2 py-1 rounded-md flex items-center",children:[e.jsx(W,{size:14,className:"mr-1"}),h,"% OFF"]})}),e.jsxs("div",{className:"p-4",children:[e.jsx(Q,{to:`/products/${s.id||0}`,children:e.jsx("h3",{className:"font-medium text-lg mb-2 text-gray-800 hover:text-primary-600 transition-colors cursor-pointer",children:s.name})}),s.description&&e.jsx("p",{className:"text-gray-600 text-sm mb-4",children:s.description}),s.category_name&&e.jsx("p",{className:"text-gray-500 text-xs mb-2",children:s.category_name}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{children:R?e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"line-through text-gray-500 text-sm",children:u(m(s.price))}),e.jsx("span",{className:"font-bold text-primary-600",children:u(p)})]}):e.jsx("span",{className:"font-bold text-primary-600",children:u(p)})}),e.jsxs("button",{onClick:()=>g(s),disabled:!s.id||l[s.id]||!s.is_in_stock,className:`cursor-pointer px-3 py-2 rounded-lg text-sm flex items-center transition-colors disabled:opacity-50 disabled:cursor-not-allowed ${s.is_in_stock!==!1?"bg-primary-600 text-white hover:bg-primary-700":"bg-gray-400 text-white"}`,children:[s.id&&l[s.id]?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-1"}):e.jsx(D,{size:16,className:"mr-1"}),e.jsx("span",{className:"hidden md:block",children:s.is_in_stock===!1?"Sin Stock":"A√±adir al Carrito"})]})]})]})]},s.id||`product-${Math.random()}`)})})]})},oe=d.memo(({personalizedProducts:t,trendingProducts:r,onAddToCart:a,onAddToWishlist:o,color:c})=>{const l=d.useRef(null),n=d.useRef(null),[m,f]=d.useState(!1),[x,y]=d.useState(!0),[u,g]=d.useState(!1),[s,p]=d.useState(!0),h=i=>{if(i&&i.current){const b=i.current.querySelector(".product-card-wrapper");if(b){const k=window.innerWidth<640?1:2,v=-1*(b.clientWidth+12)*k;i.current.scrollBy({left:v,behavior:"smooth"})}else i.current.scrollBy({left:-400,behavior:"smooth"})}},R=i=>{if(i&&i.current){const b=i.current.querySelector(".product-card-wrapper");if(b){const k=window.innerWidth<640?1:2,v=(b.clientWidth+12)*k;i.current.scrollBy({left:v,behavior:"smooth"})}else i.current.scrollBy({left:400,behavior:"smooth"})}},P=(i,b,k)=>{i&&(b(i.scrollLeft>0),k(i.scrollWidth>i.clientWidth&&i.scrollLeft<i.scrollWidth-i.clientWidth))};return d.useEffect(()=>{const i=l.current,b=n.current,k=()=>{i&&P(i,f,y)},v=()=>{b&&P(b,g,p)},S=()=>{i&&k(),b&&v()};return i&&(i.addEventListener("scroll",k),k()),b&&(b.addEventListener("scroll",v),v()),window.addEventListener("resize",S),()=>{i&&i.removeEventListener("scroll",k),b&&b.removeEventListener("scroll",v),window.removeEventListener("resize",S)}},[]),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Recomendados para ti"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>h(l),disabled:!m,className:`p-1 rounded-full border ${m?"text-gray-700 border-gray-300 hover:bg-gray-100":"text-gray-400 border-gray-200 cursor-not-allowed"}`,children:e.jsx(I,{size:20})}),e.jsx("button",{onClick:()=>R(l),disabled:!x,className:`p-1 rounded-full border ${x?"text-gray-700 border-gray-300 hover:bg-gray-100":"text-gray-400 border-gray-200 cursor-not-allowed"}`,children:e.jsx($,{size:20})})]})]}),e.jsx("div",{ref:l,className:"flex overflow-x-auto gap-3 pb-4 hide-scrollbar",children:t.map(i=>e.jsx("div",{className:"product-card-wrapper flex-none w-[calc(100%-24px)] sm:w-[calc(50%-12px)] md:w-[calc(33.333%-12px)] xl:w-[calc(20%-12px)]",children:e.jsx(F,{...i,color:c,onAddToCart:a,onAddToWishlist:o})},`personalized-${i.id}`))})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Ofertas y tendencias"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>h(n),disabled:!u,className:`p-1 rounded-full border ${u?"text-gray-700 border-gray-300 hover:bg-gray-100":"text-gray-400 border-gray-200 cursor-not-allowed"}`,children:e.jsx(I,{size:20})}),e.jsx("button",{onClick:()=>R(n),disabled:!s,className:`p-1 rounded-full border ${s?"text-gray-700 border-gray-300 hover:bg-gray-100":"text-gray-400 border-gray-200 cursor-not-allowed"}`,children:e.jsx($,{size:20})})]})]}),e.jsx("div",{ref:n,className:"flex overflow-x-auto gap-3 pb-4 hide-scrollbar",children:r.map(i=>e.jsx("div",{className:"product-card-wrapper flex-none w-[calc(100%-24px)] sm:w-[calc(50%-12px)] md:w-[calc(33.333%-12px)] xl:w-[calc(20%-12px)]",children:e.jsx(F,{...i,color:c,onAddToCart:a,onAddToWishlist:o})},`trending-${i.id}`))})]}),e.jsx("style",{children:`
        .hide-scrollbar {
          -ms-overflow-style: none;  /* IE and Edge */
          scrollbar-width: none;  /* Firefox */
        }
        .hide-scrollbar::-webkit-scrollbar {
          display: none;  /* Chrome, Safari, Opera */
        }
      `})]})}),ne=({title:t,features:r=[]})=>e.jsxs("section",{className:"mb-12 py-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-8 text-center",children:t}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map((a,o)=>e.jsxs("div",{className:"bg-white shadow-md hover:shadow-lg rounded-xl p-6 transition-all duration-300 hover:translate-y-[-5px] feature-card",children:[e.jsx("div",{className:`w-14 h-14 ${a.color||"bg-indigo-50 text-indigo-600"} rounded-full flex items-center justify-center mb-4 feature-icon`,children:e.jsx(a.icon,{size:28,strokeWidth:1.5})}),e.jsx("h3",{className:"font-bold text-lg mb-3 text-gray-800",children:a.title}),e.jsx("p",{className:"text-gray-600 leading-relaxed",children:a.description})]},o))})]}),ie=({count:t=6,title:r="Cargando productos..."})=>e.jsxs("section",{className:"mb-12",children:[e.jsx("div",{className:"mb-6",children:r?e.jsx("h2",{className:"text-2xl font-bold",children:r}):e.jsx("div",{className:"h-8 bg-gray-200 rounded w-64 animate-pulse"})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:t}).map((a,o)=>e.jsxs("div",{className:"bg-white shadow rounded-xl overflow-hidden animate-pulse",children:[e.jsx("div",{className:"h-48 bg-gray-200 relative",children:e.jsx("div",{className:"absolute top-3 right-3 bg-gray-300 rounded-md w-16 h-6"})}),e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"h-6 bg-gray-200 rounded mb-2 w-3/4"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-1 w-full"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-4 w-2/3"}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-16"}),e.jsx("div",{className:"h-5 bg-gray-300 rounded w-20"})]}),e.jsx("div",{className:"bg-gray-200 rounded-lg w-32 h-10"})]})]})]},o))})]}),ce=({showPersonalized:t=!0})=>e.jsxs("div",{className:"space-y-8",children:[t&&e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"h-7 bg-gray-200 rounded animate-pulse w-64"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"p-1 rounded-full border border-gray-200 bg-gray-100 opacity-50",children:e.jsx(I,{size:20,className:"text-gray-400"})}),e.jsx("div",{className:"p-1 rounded-full border border-gray-200 bg-gray-100 opacity-50",children:e.jsx($,{size:20,className:"text-gray-400"})})]})]}),e.jsx("div",{className:"flex overflow-hidden gap-3 pb-4",children:Array.from({length:5}).map((r,a)=>e.jsx("div",{className:"flex-none w-[calc(100%-24px)] sm:w-[calc(50%-12px)] md:w-[calc(33.333%-12px)] xl:w-[calc(20%-12px)]",children:e.jsxs("div",{className:"bg-white shadow rounded-xl overflow-hidden animate-pulse",children:[e.jsxs("div",{className:"h-40 bg-gray-200 relative",children:[e.jsx("div",{className:"absolute top-2 right-2 bg-gray-300 rounded w-12 h-5"}),e.jsx("div",{className:"absolute bottom-2 left-2 bg-gray-300 rounded w-16 h-4"})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("div",{className:"h-5 bg-gray-200 rounded mb-2 w-full"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-3 w-2/3"}),e.jsx("div",{className:"flex justify-between items-center mb-3",children:e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-12"}),e.jsx("div",{className:"h-5 bg-gray-300 rounded w-16"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1 bg-gray-200 rounded h-8"}),e.jsx("div",{className:"bg-gray-200 rounded h-8 w-8"})]})]})]})},`personalized-skeleton-${a}`))})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"h-7 bg-gray-200 rounded animate-pulse w-48"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"p-1 rounded-full border border-gray-200 bg-gray-100 opacity-50",children:e.jsx(I,{size:20,className:"text-gray-400"})}),e.jsx("div",{className:"p-1 rounded-full border border-gray-200 bg-gray-100 opacity-50",children:e.jsx($,{size:20,className:"text-gray-400"})})]})]}),e.jsx("div",{className:"flex overflow-hidden gap-3 pb-4",children:Array.from({length:5}).map((r,a)=>e.jsx("div",{className:"flex-none w-[calc(100%-24px)] sm:w-[calc(50%-12px)] md:w-[calc(33.333%-12px)] xl:w-[calc(20%-12px)]",children:e.jsxs("div",{className:"bg-white shadow rounded-xl overflow-hidden animate-pulse",children:[e.jsxs("div",{className:"h-40 bg-gray-200 relative",children:[e.jsx("div",{className:"absolute top-2 right-2 bg-gray-300 rounded w-14 h-5"}),e.jsx("div",{className:"absolute bottom-2 left-2 bg-gray-300 rounded w-16 h-4"})]}),e.jsxs("div",{className:"p-3",children:[e.jsx("div",{className:"h-5 bg-gray-200 rounded mb-2 w-full"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded mb-3 w-3/4"}),e.jsx("div",{className:"flex justify-between items-center mb-3",children:e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("div",{className:"h-3 bg-gray-200 rounded w-12"}),e.jsx("div",{className:"h-5 bg-gray-300 rounded w-16"})]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex-1 bg-gray-200 rounded h-8"}),e.jsx("div",{className:"bg-gray-200 rounded h-8 w-8"})]})]})]})},`trending-skeleton-${a}`))})]}),e.jsx("style",{children:`
        @keyframes pulse {
          0%, 100% {
            opacity: 1;
          }
          50% {
            opacity: 0.5;
          }
        }
        
        .animate-pulse {
          animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
      `})]}),le=t=>{const r=()=>{if(t.main_image)return t.main_image;if(t.image)return t.image;if(t.images&&t.images.length>0){const n=t.images[0];if(typeof n=="string")return n;if(typeof n=="object"&&n.url)return n.url}return"/images/placeholder-product.jpg"},a=()=>{if(t.discount_percentage)return t.discount_percentage;if(t.discountPercentage)return t.discountPercentage;const n=t.final_price||t.finalPrice;if(n&&n<t.price)return Math.round((t.price-n)/t.price*100)},o=()=>{if(t.rating!==null&&t.rating!==void 0)return t.rating;if(t.calculated_rating!==null&&t.calculated_rating!==void 0)return t.calculated_rating},c=()=>{if(t.rating_count!==null&&t.rating_count!==void 0)return t.rating_count;if(t.ratingCount!==null&&t.ratingCount!==void 0)return t.ratingCount;if(t.calculated_rating_count!==null&&t.calculated_rating_count!==void 0)return t.calculated_rating_count},l=()=>{if(typeof t.isNew=="boolean")return t.isNew;if(t.created_at||t.createdAt){const n=new Date(t.created_at||t.createdAt),m=new Date;return m.setDate(m.getDate()-30),n>m}return!1};return{id:t.id,name:t.name||"Producto sin nombre",price:t.final_price||t.finalPrice||t.price||0,discount:a(),rating:o(),reviews:c(),image:r(),category:t.category_name||t.category?.name,isNew:l(),stock:t.stock||0,slug:t.slug}},A=t=>t.filter(r=>r.id!==void 0).map(le),de=(t=12)=>{const[r,a]=d.useState([]),[o,c]=d.useState([]),[l,n]=d.useState([]),[m,f]=d.useState(!0),[x,y]=d.useState(null),[u,g]=d.useState(!1),[s,p]=d.useState(!1),h=d.useRef(!1),R=d.useRef(t),P=d.useRef(null),i=()=>{const v=localStorage.getItem("auth_token"),S=!!v&&v.trim()!=="";return g(S),S},b=async()=>{if(h.current){console.log("üö´ useHomeProducts: Fetch en curso, ignorando solicitud duplicada");return}h.current=!0,f(!0),y(null);try{const v=i();console.log("üè† useHomeProducts: Cargando productos optimizados...",{isAuthenticated:v,limit:t});const S=T.getFeaturedRandom(6);if(v){console.log("üîê Usuario autenticado - personalizados + trending");const[j,N,E]=await Promise.allSettled([T.getPersonalizedProducts(t),T.getTrendingAndOffers(t),S]);if(j.status==="fulfilled"&&j.value.data){const w=A(j.value.data);a(w),console.log("‚úÖ Recomendaciones personalizadas:",w.length)}else{console.log("‚ö†Ô∏è Fallback a trending para personalizadas");const w=await T.getTrendingAndOffers(t),z=A(w.data||[]);a(z)}if(N.status==="fulfilled"&&N.value.data){const w=A(N.value.data);c(w),console.log("‚úÖ Trending and offers:",w.length)}else{console.log("‚ö†Ô∏è Fallback a discounted para trending");const w=await T.getDiscountedProducts(t),z=A(w.data||[]);c(z)}E.status==="fulfilled"&&E.value.data?(n(E.value.data),console.log("‚úÖ Featured products:",E.value.data.length)):(n([]),console.log("‚ö†Ô∏è No featured products available"))}else{console.log("üåç Usuario no autenticado - trending + discounted + featured");const[j,N,E]=await Promise.allSettled([T.getTrendingAndOffers(t),T.getDiscountedProducts(t),S]);if(j.status==="fulfilled"&&j.value.data){const w=A(j.value.data);a(w),console.log("‚úÖ Trending products:",w.length)}else{const w=await T.getPopularProducts(t),z=A(w.data||[]);a(z)}if(N.status==="fulfilled"&&N.value.data){const w=A(N.value.data);c(w),console.log("‚úÖ Discounted products:",w.length)}else{const w=await T.getPopularProducts(t),z=A(w.data||[]);c(z)}E.status==="fulfilled"&&E.value.data?(n(E.value.data),console.log("‚úÖ Featured products (no auth):",E.value.data.length)):n([])}console.log("üè† useHomeProducts: Carga completada")}catch(v){console.error("‚ùå useHomeProducts: Error general:",v),y(v instanceof Error?v.message:"Error desconocido"),a([]),c([]),n([])}finally{f(!1),p(!0),h.current=!1,R.current=t}},k=d.useMemo(()=>()=>{P.current&&clearTimeout(P.current),P.current=setTimeout(()=>{b()},100)},[]);return d.useEffect(()=>((!s||R.current!==t)&&!h.current&&k(),()=>{P.current&&clearTimeout(P.current)}),[t,k,s]),{personalizedProducts:r,trendingProducts:o,featuredProducts:l,loading:m,error:x,refetch:b,isAuthenticated:u,hasInitialLoad:s}};class ue{static BASE_PATH="/recommendations";static async getRecommendations(r=10){try{console.log("üéØ RecommendationService: Llamando a /recommendations...",{limit:r});const a=await L.get(this.BASE_PATH,{limit:r});return console.log("üéØ RecommendationService: Respuesta recibida:",a),a.success&&a.data&&Array.isArray(a.data)?(console.log("‚úÖ RecommendationService: Productos REALES obtenidos:",{count:a.data.length,productos:a.data.map(o=>o.name).slice(0,3),primer_producto:a.data[0]}),a):(console.warn("‚ö†Ô∏è RecommendationService: Respuesta sin √©xito o datos v√°lidos:",a),{success:!1,data:[],meta:{total:0,count:0,error:"Respuesta sin datos v√°lidos"}})}catch(a){return console.error("‚ùå RecommendationService: ERROR COMPLETO:",a),console.error("‚ùå Error status:",a.response?.status),console.error("‚ùå Error data:",a.response?.data),{success:!1,data:[],meta:{total:0,count:0,error:`Error del servidor: ${a.response?.status||"desconocido"}`}}}}static async trackInteraction(r,a,o={}){try{console.log("üìä RecommendationService: Registrando interacci√≥n:",{interactionType:r,itemId:a,metadata:o}),await L.post(`${this.BASE_PATH}/track-interaction`,{interactionType:r,itemId:a,metadata:o}),console.log("‚úÖ RecommendationService: Interacci√≥n registrada exitosamente")}catch(c){console.error("‚ùå RecommendationService: Error registrando interacci√≥n:",c)}}static async getUserProfile(){try{console.log("üë§ RecommendationService: Obteniendo perfil de usuario...");const r=await L.get(`${this.BASE_PATH}/user-profile`);return console.log("‚úÖ RecommendationService: Perfil obtenido:",r),r}catch(r){return console.error("‚ùå RecommendationService: Error obteniendo perfil:",r),null}}}class _{static config={enableLogging:!0,batchInteractions:!1,batchSize:5,batchDelay:2e3,minTimeSpent:10};static isAuthenticated(){const r=localStorage.getItem("auth_token");return!!(r&&r.trim()!=="")}static log(r,a){this.config.enableLogging&&console.log(`üîç UserInteractionService: ${r}`,a||"")}static async recordInteraction(r,a,o={}){if(!this.isAuthenticated())return this.log(`Usuario no autenticado - omitiendo ${r} para item ${a}`),!1;try{const c={timestamp:new Date().toISOString(),action:r,...o};return await ue.trackInteraction(r,a,c),this.log(`‚úÖ ${r} registrado exitosamente`,{itemId:a,metadata:c}),!0}catch(c){return this.log(`‚ùå Error registrando ${r}:`,c),!1}}static async trackProductView(r,a="unknown",o={}){return await this.recordInteraction("view",r,{source:a,...o})}static async trackProductClick(r,a="unknown",o={}){return await this.recordInteraction("click",r,{source:a,...o})}static async trackAddToCart(r,a=1,o="unknown"){return await this.recordInteraction("add_to_cart",r,{quantity:a,source:o})}static async trackAddToWishlist(r,a="unknown"){return await this.recordInteraction("add_to_wishlist",r,{source:a})}static async trackRemoveFromWishlist(r,a="unknown"){return await this.recordInteraction("remove_from_wishlist",r,{source:a})}static async trackSearch(r,a=0,o="search_bar"){return await this.recordInteraction("search",0,{search_term:r.toLowerCase().trim(),results_count:a,source:o})}static async trackCategoryView(r,a,o="navigation"){return await this.recordInteraction("category_view",r,{category_name:a,source:o})}static async trackPurchase(r,a,o){const c=[];for(const l of r){const n=await this.recordInteraction("purchase",l,{total_amount:a,order_id:o,product_count:r.length});c.push(n)}return c}static async trackTimeOnProduct(r,a,o="product_page"){return a<this.config.minTimeSpent?(this.log(`Tiempo insuficiente (${a}s) - no se registra`),!1):await this.recordInteraction("time_spent",r,{time_spent_seconds:a,source:o})}static async trackRating(r,a,o="product_page"){return await this.recordInteraction("rating",r,{rating_value:a,source:o})}static updateConfig(r){this.config={...this.config,...r},this.log("Configuraci√≥n actualizada:",this.config)}static getConfig(){return{...this.config}}static setLogging(r){this.config.enableLogging=r}}const ge=(t="unknown")=>{const r=d.useCallback((u,g,s)=>{_.trackProductView(u,g||t,s)},[t]),a=d.useCallback((u,g,s)=>{_.trackProductClick(u,g||t,s)},[t]),o=d.useCallback((u,g=1,s)=>{_.trackAddToCart(u,g,s||t)},[t]),c=d.useCallback((u,g)=>{_.trackAddToWishlist(u,g||t)},[t]),l=d.useCallback((u,g)=>{_.trackRemoveFromWishlist(u,g||t)},[t]),n=d.useCallback((u,g,s)=>{_.trackSearch(u,g,s||t)},[t]),m=d.useCallback((u,g,s)=>{_.trackCategoryView(u,g,s||t)},[t]),f=d.useCallback((u,g,s)=>{_.trackTimeOnProduct(u,g,s||t)},[t]),x=d.useCallback((u,g,s)=>{_.trackRating(u,g,s||t)},[t]),y=d.useCallback((u,g,s)=>{_.trackPurchase(u,g,s)},[]);return{trackProductView:r,trackProductClick:a,trackAddToCart:o,trackAddToWishlist:c,trackRemoveFromWishlist:l,trackSearch:n,trackCategoryView:m,trackTimeOnProduct:f,trackRating:x,trackPurchase:y}},Ne=()=>{const{personalizedProducts:t,trendingProducts:r,featuredProducts:a,loading:o,error:c,isAuthenticated:l,hasInitialLoad:n}=de(12),{trackAddToCart:m,trackAddToWishlist:f}=ge("home_page"),{addToCart:x,showNotification:y}=O(),{toggleFavorite:u}=X(),{optimisticCartAdd:g,optimisticFavoriteAdd:s,optimisticFavoriteRemove:p,invalidateCounters:h}=Y(),R=["./banner1.png","./banner2.png"],P=[{id:1,title:"Smartphones",icon:H,link:"/products/1"},{id:2,title:"Laptops",icon:M,link:"/products/2"},{id:3,title:"Monitores",icon:U,link:"/products/3"},{id:4,title:"TVs",icon:B,link:"/products/4"}],i=[{title:"Ll√©vate m√°s, paga menos ¬°Solo en comersia!",description:"Regreso a clase con los mejores precios del mercado.",buttonText:"Comprar Ahora",buttonAction:()=>console.log("Shop Now clicked"),image:"./2banner1.png",color:"rgba(75, 0, 130, 0)"},{title:"T√∫ proveedor mayorista de confianza.",description:"Env√≠o gratis a todo el Ecuador en tu primera compra.",buttonText:"Ver Colecci√≥n",buttonAction:()=>console.log("View Collection clicked"),image:"./2banner2.png",color:"rgba(46, 204, 113, 0)"},{title:"Potencia, precisi√≥n y precios bajos para tu taller.",description:"Aplica cup√≥n de descuento",buttonText:"Ver Ofertas",buttonAction:()=>console.log("See Offers clicked"),image:"./2banner3.png",color:"rgba(255, 165, 0, 0)"}],b=[{title:"Entrega R√°pida",description:"Recibe tus productos en la puerta de tu casa r√°pidamente con nuestras opciones de env√≠o express.",icon:q,color:"bg-blue-50 text-blue-600"},{title:"Pago Seguro",description:"Garantizamos m√©todos de pago seguros con encriptaci√≥n y protecci√≥n contra fraudes para tu tranquilidad.",icon:V,color:"bg-green-50 text-green-600"},{title:"Soporte 24/7",description:"Nuestro equipo de atenci√≥n al cliente est√° disponible las 24 horas para ayudarte con cualquier pregunta o problema.",icon:G,color:"bg-purple-50 text-purple-600"},{title:"Rendimiento R√°pido",description:"Navega por nuestra tienda con velocidad instant√°nea, sin retrasos ni ralentizaciones al comprar con nosotros.",icon:Z,color:"bg-amber-50 text-amber-600"},{title:"Garant√≠a de Calidad",description:"Todos nuestros productos son probados rigurosamente y vienen con garant√≠a de satisfacci√≥n o te devolvemos tu dinero.",icon:J,color:"bg-red-50 text-red-600"},{title:"Pago Flexible",description:"Elige entre varios m√©todos de pago incluyendo tarjetas de cr√©dito, PayPal y opciones de pago a plazos.",icon:K,color:"bg-indigo-50 text-indigo-600"}],k=async j=>{try{console.log(`Producto ${j} a√±adido al carrito`),g(),m(j,1,"home_carousel"),await x({productId:j,quantity:1})?(y(C.SUCCESS,"Producto agregado al carrito exitosamente"),h()):(y(C.ERROR,"Error al agregar producto al carrito"),h())}catch(N){console.error("Error adding to cart:",N),y(C.ERROR,"Error al agregar producto al carrito"),h()}},v=async j=>{try{console.log(`Producto ${j} a√±adido a la lista de deseos`),f(j,"home_carousel");const N=await u(j);N!==void 0?(N?(s(),y(C.SUCCESS,"Producto a√±adido a favoritos")):(p(),y(C.INFO,"Producto eliminado de favoritos")),h()):y(C.ERROR,"Error al gestionar favoritos")}catch(N){console.error("Error managing wishlist:",N),y(C.ERROR,"Error al gestionar favoritos")}},S=async j=>{try{console.log(`Producto destacado ${j} a√±adido al carrito`),g(),m(j,1,"featured_products"),await x({productId:j,quantity:1})?(y(C.SUCCESS,"Producto destacado agregado al carrito exitosamente"),h()):(y(C.ERROR,"Error al agregar producto destacado al carrito"),h())}catch(N){console.error("Error adding featured product to cart:",N),y(C.ERROR,"Error al agregar producto destacado al carrito"),h()}};return e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("section",{className:"mb-12",children:e.jsx(ee,{images:R,autoPlay:!0,autoPlayInterval:5e3})}),e.jsxs("section",{className:"mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-center mb-6",children:"Categor√≠as de Tecnolog√≠a"}),e.jsx(ae,{categories:P})]})]}),e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsx("section",{className:"mb-12",children:e.jsx(re,{slides:i,interval:4e3})}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-8",children:l?"Descubre productos para ti":"Productos populares"}),c&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:e.jsxs("p",{children:["Error cargando productos: ",c]})}),o&&!n?e.jsx(ce,{showPersonalized:!0,isAuthenticated:l}):t.length>0||r.length>0?e.jsx(oe,{personalizedProducts:t,trendingProducts:r,onAddToCart:k,onAddToWishlist:v,color:!1,isAuthenticated:l}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-600",children:"Cargando productos..."})})]}),e.jsx("section",{className:"mb-12",children:o&&!n?e.jsx(ie,{count:6,title:"Cargando productos destacados..."}):a.length>0?e.jsx(se,{products:a,title:"Productos destacados",onClick:S}):n?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-600",children:"No hay productos destacados disponibles en este momento."})}):e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-600",children:"Cargando productos destacados..."})})}),e.jsx("section",{className:"mb-12",children:e.jsx(ne,{features:b,title:"Por qu√© elegirnos"})})]})]})};export{Ne as default};
//# sourceMappingURL=HomePage-CM-KohMh.js.map
