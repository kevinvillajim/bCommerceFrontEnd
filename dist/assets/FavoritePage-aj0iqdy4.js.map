{"version":3,"file":"FavoritePage-aj0iqdy4.js","sources":["../../src/presentation/hooks/useFavoriteApi.ts","../../src/presentation/pages/FavoritePage.tsx"],"sourcesContent":["import {useState} from \"react\";\r\nimport ApiClient from \"../../infrastructure/api/apiClient\";\r\nimport {API_ENDPOINTS} from \"../../constants/apiEndpoints\";\r\nimport type {Favorite} from \"../../core/domain/entities/Favorite\";\r\nimport {useAuth} from \"./useAuth\";\r\n\r\n// Interfaces para las respuestas de la API\r\ninterface ApiResponse<T> {\r\n\tstatus: string;\r\n\tdata: T;\r\n\tmessage?: string;\r\n\tmeta?: any;\r\n}\r\n\r\ninterface FavoriteApiResponse {\r\n\tis_favorite: boolean;\r\n\tfavorite_id: number | null;\r\n\tnotification_preferences?: {\r\n\t\tnotify_price_change: boolean;\r\n\t\tnotify_promotion: boolean;\r\n\t\tnotify_low_stock: boolean;\r\n\t} | null;\r\n}\r\n\r\ninterface FavoritesResponse {\r\n\tfavorites: Array<{\r\n\t\tfavorite: Favorite;\r\n\t\tproduct?: any;\r\n\t}>;\r\n\tmeta: {\r\n\t\ttotal: number;\r\n\t\tlimit: number;\r\n\t\toffset: number;\r\n\t\thas_more: boolean;\r\n\t};\r\n}\r\n\r\ninterface UseFavoriteApiReturn {\r\n\tloading: boolean;\r\n\terror: string | null;\r\n\tgetUserFavorites: (\r\n\t\tlimit?: number,\r\n\t\toffset?: number\r\n\t) => Promise<FavoritesResponse>;\r\n\ttoggleFavorite: (\r\n\t\tproductId: number,\r\n\t\tnotificationPreferences?: {\r\n\t\t\tnotify_price_change?: boolean;\r\n\t\t\tnotify_promotion?: boolean;\r\n\t\t\tnotify_low_stock?: boolean;\r\n\t\t}\r\n\t) => Promise<{\r\n\t\tis_favorite: boolean;\r\n\t\tfavorite_id: number | null;\r\n\t\tmessage: string;\r\n\t}>;\r\n\tcheckIsFavorite: (productId: number) => Promise<{\r\n\t\tis_favorite: boolean;\r\n\t\tfavorite_id: number | null;\r\n\t\tnotification_preferences: {\r\n\t\t\tnotify_price_change: boolean;\r\n\t\t\tnotify_promotion: boolean;\r\n\t\t\tnotify_low_stock: boolean;\r\n\t\t} | null;\r\n\t}>;\r\n\tupdateNotificationPreferences: (\r\n\t\tfavoriteId: number,\r\n\t\tpreferences: {\r\n\t\t\tnotify_price_change: boolean;\r\n\t\t\tnotify_promotion: boolean;\r\n\t\t\tnotify_low_stock: boolean;\r\n\t\t}\r\n\t) => Promise<{\r\n\t\tsuccess: boolean;\r\n\t\tmessage: string;\r\n\t\tfavorite?: any;\r\n\t}>;\r\n}\r\n\r\nexport const useFavoriteApi = (): UseFavoriteApiReturn => {\r\n\tconst [loading, setLoading] = useState<boolean>(false);\r\n\tconst [error, setError] = useState<string | null>(null);\r\n\tconst {isAuthenticated} = useAuth();\r\n\r\n\tconst getUserFavorites = async (\r\n\t\tlimit = 10,\r\n\t\toffset = 0\r\n\t): Promise<FavoritesResponse> => {\r\n\t\ttry {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\tif (!isAuthenticated) {\r\n\t\t\t\tthrow new Error(\"User must be authenticated to get favorites\");\r\n\t\t\t}\r\n\r\n\t\t\tconst response = await ApiClient.get<ApiResponse<any[]>>(\r\n\t\t\t\tAPI_ENDPOINTS.FAVORITES.LIST,\r\n\t\t\t\t{\r\n\t\t\t\t\tlimit,\r\n\t\t\t\t\toffset,\r\n\t\t\t\t}\r\n\t\t\t);\r\n\r\n\t\t\t// Verificamos la estructura real de la respuesta\r\n\t\t\t// Según la respuesta del servidor, los favoritos están en `data` y son un array\r\n\t\t\tconst apiData = response?.data || [];\r\n\r\n\t\t\t// Procesamos los datos para el formato que espera nuestra aplicación\r\n\t\t\tconst favorites = apiData.map((item, index) => {\r\n\t\t\t\t// El backend envía `favorite` como un objeto vacío y toda la información está en `product`\r\n\t\t\t\treturn {\r\n\t\t\t\t\tfavorite: {\r\n\t\t\t\t\t\t// Usamos el ID del producto como ID del favorito, con un prefijo para garantizar unicidad\r\n\t\t\t\t\t\tid: item.product?.id ? item.product.id + 1000 : index + 1000,\r\n\t\t\t\t\t\tuserId: 0, // No tenemos este dato\r\n\t\t\t\t\t\tproductId: item.product?.id || 0,\r\n\t\t\t\t\t\t// Valores por defecto para las notificaciones ya que el backend no los envía\r\n\t\t\t\t\t\tnotifyPriceChange: true,\r\n\t\t\t\t\t\tnotifyPromotion: true,\r\n\t\t\t\t\t\tnotifyLowStock: true,\r\n\t\t\t\t\t},\r\n\t\t\t\t\tproduct: item.product,\r\n\t\t\t\t};\r\n\t\t\t});\r\n\r\n\t\t\treturn {\r\n\t\t\t\tfavorites,\r\n\t\t\t\tmeta: response?.meta || {\r\n\t\t\t\t\ttotal: favorites.length,\r\n\t\t\t\t\tlimit,\r\n\t\t\t\t\toffset,\r\n\t\t\t\t\thas_more: false,\r\n\t\t\t\t},\r\n\t\t\t};\r\n\t\t} catch (err) {\r\n\t\t\tconst errorMessage =\r\n\t\t\t\terr instanceof Error ? err.message : \"Failed to fetch favorites\";\r\n\t\t\tsetError(errorMessage);\r\n\t\t\treturn {\r\n\t\t\t\tfavorites: [],\r\n\t\t\t\tmeta: {\r\n\t\t\t\t\ttotal: 0,\r\n\t\t\t\t\tlimit,\r\n\t\t\t\t\toffset,\r\n\t\t\t\t\thas_more: false,\r\n\t\t\t\t},\r\n\t\t\t};\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t};\r\n\r\n\tconst toggleFavorite = async (\r\n\t\tproductId: number,\r\n\t\tnotificationPreferences?: {\r\n\t\t\tnotify_price_change?: boolean;\r\n\t\t\tnotify_promotion?: boolean;\r\n\t\t\tnotify_low_stock?: boolean;\r\n\t\t}\r\n\t) => {\r\n\t\ttry {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\tif (!isAuthenticated) {\r\n\t\t\t\tthrow new Error(\"User must be authenticated to toggle favorites\");\r\n\t\t\t}\r\n\r\n\t\t\t// Establecer valores predeterminados si no se proporcionan\r\n\t\t\tconst preferences = {\r\n\t\t\t\tnotify_price_change:\r\n\t\t\t\t\tnotificationPreferences?.notify_price_change !== undefined\r\n\t\t\t\t\t\t? notificationPreferences.notify_price_change\r\n\t\t\t\t\t\t: true,\r\n\t\t\t\tnotify_promotion:\r\n\t\t\t\t\tnotificationPreferences?.notify_promotion !== undefined\r\n\t\t\t\t\t\t? notificationPreferences.notify_promotion\r\n\t\t\t\t\t\t: true,\r\n\t\t\t\tnotify_low_stock:\r\n\t\t\t\t\tnotificationPreferences?.notify_low_stock !== undefined\r\n\t\t\t\t\t\t? notificationPreferences.notify_low_stock\r\n\t\t\t\t\t\t: true,\r\n\t\t\t};\r\n\r\n\t\t\tconst response = await ApiClient.post<ApiResponse<FavoriteApiResponse>>(\r\n\t\t\t\tAPI_ENDPOINTS.FAVORITES.TOGGLE,\r\n\t\t\t\t{\r\n\t\t\t\t\tproduct_id: productId,\r\n\t\t\t\t\tnotification_preferences: preferences,\r\n\t\t\t\t}\r\n\t\t\t);\r\n\r\n\t\t\treturn {\r\n\t\t\t\tis_favorite: response?.data?.is_favorite || false,\r\n\t\t\t\tfavorite_id: response?.data?.favorite_id || null,\r\n\t\t\t\tmessage: response?.message || \"Favorite status updated\",\r\n\t\t\t};\r\n\t\t} catch (err) {\r\n\t\t\tconst errorMessage =\r\n\t\t\t\terr instanceof Error ? err.message : \"Failed to toggle favorite\";\r\n\t\t\tsetError(errorMessage);\r\n\t\t\tthrow new Error(errorMessage);\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t};\r\n\r\n\tconst checkIsFavorite = async (productId: number) => {\r\n\t\ttry {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\tif (!isAuthenticated) {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tis_favorite: false,\r\n\t\t\t\t\tfavorite_id: null,\r\n\t\t\t\t\tnotification_preferences: null,\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t\tconst response = await ApiClient.get<ApiResponse<FavoriteApiResponse>>(\r\n\t\t\t\tAPI_ENDPOINTS.FAVORITES.CHECK(productId)\r\n\t\t\t);\r\n\r\n\t\t\treturn {\r\n\t\t\t\tis_favorite: response?.data?.is_favorite || false,\r\n\t\t\t\tfavorite_id: response?.data?.favorite_id || null,\r\n\t\t\t\tnotification_preferences:\r\n\t\t\t\t\tresponse?.data?.notification_preferences || null,\r\n\t\t\t};\r\n\t\t} catch (err) {\r\n\t\t\tconst errorMessage =\r\n\t\t\t\terr instanceof Error ? err.message : \"Failed to check favorite status\";\r\n\t\t\tsetError(errorMessage);\r\n\t\t\tconsole.error(errorMessage);\r\n\r\n\t\t\t// Return a default response on error rather than throwing\r\n\t\t\treturn {\r\n\t\t\t\tis_favorite: false,\r\n\t\t\t\tfavorite_id: null,\r\n\t\t\t\tnotification_preferences: null,\r\n\t\t\t};\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t};\r\n\r\n\tconst updateNotificationPreferences = async (\r\n\t\tfavoriteId: number,\r\n\t\tpreferences: {\r\n\t\t\tnotify_price_change: boolean;\r\n\t\t\tnotify_promotion: boolean;\r\n\t\t\tnotify_low_stock: boolean;\r\n\t\t}\r\n\t) => {\r\n\t\ttry {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\tif (!isAuthenticated) {\r\n\t\t\t\tthrow new Error(\r\n\t\t\t\t\t\"User must be authenticated to update notification preferences\"\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\tconst response = await ApiClient.put<ApiResponse<any>>(\r\n\t\t\t\tAPI_ENDPOINTS.FAVORITES.UPDATE_NOTIFICATIONS(favoriteId),\r\n\t\t\t\tpreferences\r\n\t\t\t);\r\n\r\n\t\t\treturn {\r\n\t\t\t\tsuccess: true,\r\n\t\t\t\tmessage: response?.message || \"Notification preferences updated\",\r\n\t\t\t\tfavorite: response?.data,\r\n\t\t\t};\r\n\t\t} catch (err) {\r\n\t\t\tconst errorMessage =\r\n\t\t\t\terr instanceof Error\r\n\t\t\t\t\t? err.message\r\n\t\t\t\t\t: \"Failed to update notification preferences\";\r\n\t\t\tsetError(errorMessage);\r\n\t\t\tthrow new Error(errorMessage);\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t};\r\n\r\n\treturn {\r\n\t\tloading,\r\n\t\terror,\r\n\t\tgetUserFavorites,\r\n\t\ttoggleFavorite,\r\n\t\tcheckIsFavorite,\r\n\t\tupdateNotificationPreferences,\r\n\t};\r\n};\r\n\r\nexport default useFavoriteApi;\r\n","import React, {useState, useEffect} from \"react\";\r\nimport {Link, useNavigate} from \"react-router-dom\";\r\nimport {\r\n\tHeart,\r\n\tTrash2,\r\n\tShoppingCart,\r\n\tStar,\r\n\tCheck,\r\n\tAlertTriangle,\r\n\tSettings,\r\n} from \"lucide-react\";\r\nimport {useFavoriteApi} from \"../hooks/useFavoriteApi\";\r\nimport {useAuth} from \"../hooks/useAuth\";\r\nimport {useCart} from \"../hooks/useCart\";\r\nimport {formatCurrency} from \"../../utils/formatters/formatCurrency\";\r\n// IMPORTAR EL HELPER DE IMÁGENES CORREGIDO\r\nimport { getImageUrl } from \"../../utils/imageUtils\";\r\n\r\n// Tipo para los datos del producto favorito\r\ninterface FavoriteProduct {\r\n\tid: number;\r\n\tname: string;\r\n\tprice: number | string; // Puede venir como string o number\r\n\tdiscount?: number | string;\r\n\tdiscount_percentage?: number | string;\r\n\trating?: number | string;\r\n\trating_count?: number | string;\r\n\timage?: string;\r\n\timages?: {\r\n\t\toriginal: string;\r\n\t\tthumbnail: string;\r\n\t\tmedium: string;\r\n\t\tlarge: string;\r\n\t}[];\r\n\tcategory?: string;\r\n\tisNew?: boolean;\r\n\tstock: number;\r\n\tslug: string;\r\n\tcategory_id?: number;\r\n\tis_in_stock?: boolean;\r\n}\r\n\r\n// Tipo para el elemento favorito completo\r\ninterface FavoriteItem {\r\n\tfavorite: {\r\n\t\tid: number;\r\n\t\tuserId: number;\r\n\t\tproductId: number;\r\n\t\tnotifyPriceChange: boolean;\r\n\t\tnotifyPromotion: boolean;\r\n\t\tnotifyLowStock: boolean;\r\n\t};\r\n\tproduct?: FavoriteProduct;\r\n}\r\n\r\n// Componente de preferencias de notificación\r\ninterface NotificationPreferencesProps {\r\n\tfavoriteId: number;\r\n\tinitialPreferences: {\r\n\t\tnotifyPriceChange: boolean;\r\n\t\tnotifyPromotion: boolean;\r\n\t\tnotifyLowStock: boolean;\r\n\t};\r\n\tonClose: () => void;\r\n}\r\n\r\nconst NotificationPreferences: React.FC<NotificationPreferencesProps> = ({\r\n\tfavoriteId,\r\n\tinitialPreferences,\r\n\tonClose,\r\n}) => {\r\n\tconst [preferences, setPreferences] = useState({\r\n\t\tnotify_price_change: initialPreferences.notifyPriceChange,\r\n\t\tnotify_promotion: initialPreferences.notifyPromotion,\r\n\t\tnotify_low_stock: initialPreferences.notifyLowStock,\r\n\t});\r\n\tconst [isSaving, setIsSaving] = useState(false);\r\n\tconst {updateNotificationPreferences} = useFavoriteApi();\r\n\r\n\tconst handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n\t\tconst {name, checked} = e.target;\r\n\t\tsetPreferences((prev) => ({...prev, [name]: checked}));\r\n\t};\r\n\r\n\tconst handleSave = async () => {\r\n\t\ttry {\r\n\t\t\tsetIsSaving(true);\r\n\t\t\tawait updateNotificationPreferences(favoriteId, preferences);\r\n\t\t\tonClose();\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error saving preferences:\", error);\r\n\t\t} finally {\r\n\t\t\tsetIsSaving(false);\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\r\n\t\t\t<div className=\"bg-white rounded-lg p-6 max-w-md w-full shadow-xl\">\r\n\t\t\t\t<div className=\"flex justify-between items-center mb-4\">\r\n\t\t\t\t\t<h3 className=\"text-lg font-semibold\">\r\n\t\t\t\t\t\tPreferencias de notificación\r\n\t\t\t\t\t</h3>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={onClose}\r\n\t\t\t\t\t\tclassName=\"text-gray-500 hover:text-gray-700\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<span className=\"sr-only\">Cerrar</span>\r\n\t\t\t\t\t\t<svg\r\n\t\t\t\t\t\t\tclassName=\"h-6 w-6\"\r\n\t\t\t\t\t\t\tfill=\"none\"\r\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\"\r\n\t\t\t\t\t\t\tstroke=\"currentColor\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<path\r\n\t\t\t\t\t\t\t\tstrokeLinecap=\"round\"\r\n\t\t\t\t\t\t\t\tstrokeLinejoin=\"round\"\r\n\t\t\t\t\t\t\t\tstrokeWidth={2}\r\n\t\t\t\t\t\t\t\td=\"M6 18L18 6M6 6l12 12\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div className=\"space-y-4\">\r\n\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\tid=\"notify_price_change\"\r\n\t\t\t\t\t\t\tname=\"notify_price_change\"\r\n\t\t\t\t\t\t\tchecked={preferences.notify_price_change}\r\n\t\t\t\t\t\t\tonChange={handleChange}\r\n\t\t\t\t\t\t\tclassName=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\thtmlFor=\"notify_price_change\"\r\n\t\t\t\t\t\t\tclassName=\"ml-2 block text-sm text-gray-700\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tNotificarme cambios de precio\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\tid=\"notify_promotion\"\r\n\t\t\t\t\t\t\tname=\"notify_promotion\"\r\n\t\t\t\t\t\t\tchecked={preferences.notify_promotion}\r\n\t\t\t\t\t\t\tonChange={handleChange}\r\n\t\t\t\t\t\t\tclassName=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\thtmlFor=\"notify_promotion\"\r\n\t\t\t\t\t\t\tclassName=\"ml-2 block text-sm text-gray-700\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tNotificarme promociones\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\tid=\"notify_low_stock\"\r\n\t\t\t\t\t\t\tname=\"notify_low_stock\"\r\n\t\t\t\t\t\t\tchecked={preferences.notify_low_stock}\r\n\t\t\t\t\t\t\tonChange={handleChange}\r\n\t\t\t\t\t\t\tclassName=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\thtmlFor=\"notify_low_stock\"\r\n\t\t\t\t\t\t\tclassName=\"ml-2 block text-sm text-gray-700\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tNotificarme cuando haya poco stock\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div className=\"mt-6 flex justify-end space-x-3\">\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={onClose}\r\n\t\t\t\t\t\tclassName=\"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tCancelar\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={handleSave}\r\n\t\t\t\t\t\tdisabled={isSaving}\r\n\t\t\t\t\t\tclassName=\"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{isSaving ? \"Guardando...\" : \"Guardar\"}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nconst FavoritePage: React.FC = () => {\r\n\tconst [favorites, setFavorites] = useState<FavoriteItem[]>([]);\r\n\tconst [isLoading, setIsLoading] = useState(true);\r\n\tconst [isEmpty, setIsEmpty] = useState(false);\r\n\tconst [error, setError] = useState<string | null>(null);\r\n\tconst [activePreferences, setActivePreferences] = useState<number | null>(\r\n\t\tnull\r\n\t);\r\n\tconst [currentPage, setCurrentPage] = useState(1);\r\n\tconst [hasMore, setHasMore] = useState(false);\r\n\tconst [total, setTotal] = useState(0);\r\n\r\n\tconst limit = 10;\r\n\tconst {getUserFavorites, toggleFavorite} = useFavoriteApi();\r\n\tconst {isAuthenticated} = useAuth();\r\n\tconst {addToCart} = useCart();\r\n\tconst navigate = useNavigate();\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!isAuthenticated) {\r\n\t\t\tnavigate(\"/login\", {state: {from: \"/favorites\"}});\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tfetchFavorites();\r\n\t}, [isAuthenticated, currentPage]);\r\n\r\n\tconst fetchFavorites = async () => {\r\n\t\ttry {\r\n\t\t\tsetIsLoading(true);\r\n\t\t\tconst offset = (currentPage - 1) * limit;\r\n\t\t\tconst result = await getUserFavorites(limit, offset);\r\n\r\n\t\t\t// Asegúrate de que los datos tengan el formato correcto\r\n\t\t\tconst formattedFavorites = result.favorites.map((item) => ({\r\n\t\t\t\tfavorite: {\r\n\t\t\t\t\tid: item.favorite.id || 0, // Asigna un valor por defecto si es undefined\r\n\t\t\t\t\tuserId: item.favorite.userId,\r\n\t\t\t\t\tproductId: item.favorite.productId,\r\n\t\t\t\t\tnotifyPriceChange: item.favorite.notifyPriceChange || false,\r\n\t\t\t\t\tnotifyPromotion: item.favorite.notifyPromotion || false,\r\n\t\t\t\t\tnotifyLowStock: item.favorite.notifyLowStock || false,\r\n\t\t\t\t},\r\n\t\t\t\tproduct: item.product,\r\n\t\t\t}));\r\n\r\n\t\t\tsetFavorites(formattedFavorites);\r\n\t\t\tsetTotal(result.meta.total);\r\n\t\t\tsetHasMore(result.meta.has_more);\r\n\t\t\tsetIsEmpty(formattedFavorites.length === 0 && currentPage === 1);\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error(\"Error fetching favorites:\", err);\r\n\t\t\tsetError(\r\n\t\t\t\t\"No se pudieron cargar los favoritos. Por favor, inténtalo de nuevo.\"\r\n\t\t\t);\r\n\t\t} finally {\r\n\t\t\tsetIsLoading(false);\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleRemoveFromWishlist = async (productId: number) => {\r\n\t\ttry {\r\n\t\t\tawait toggleFavorite(productId);\r\n\t\t\t// Actualizar la lista de favoritos después de eliminar\r\n\t\t\tfetchFavorites();\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error removing from favorites:\", error);\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleAddToCart = async (product: FavoriteProduct) => {\r\n\t\ttry {\r\n\t\t\tif (!product.stock || product.stock <= 0) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tawait addToCart({\r\n\t\t\t\tproductId: product.id,\r\n\t\t\t\tquantity: 1,\r\n\t\t\t});\r\n\r\n\t\t\t// Opcional: Mostrar un mensaje de éxito\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(`Error adding product ${product.id} to cart:`, error);\r\n\t\t}\r\n\t};\r\n\r\n\t// FUNCIÓN CORREGIDA PARA OBTENER IMAGEN DEL PRODUCTO\r\n\tconst getProductImage = (product: FavoriteProduct): string => {\r\n\t\tconsole.log(\"🎨 FavoritePage - getProductImage:\", product);\r\n\t\t\r\n\t\tlet imagePath = \"\";\r\n\r\n\t\t// Prioridad 1: image\r\n\t\tif (product?.image) {\r\n\t\t\timagePath = product.image;\r\n\t\t}\r\n\t\t// Prioridad 2: primer elemento de images array\r\n\t\telse if (product?.images && Array.isArray(product.images) && product.images.length > 0) {\r\n\t\t\tconst firstImage = product.images[0];\r\n\t\t\tif (typeof firstImage === 'string') {\r\n\t\t\t\timagePath = firstImage;\r\n\t\t\t} else if (typeof firstImage === 'object' && firstImage !== null) {\r\n\t\t\t\timagePath = firstImage.original || firstImage.medium || firstImage.thumbnail || \"\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconsole.log(\"🖼️ FavoritePage - Path extraído:\", imagePath);\r\n\t\t\r\n\t\t// USAR EL HELPER CORREGIDO\r\n\t\tconst finalUrl = getImageUrl(imagePath);\r\n\t\tconsole.log(\"🔗 FavoritePage - URL final:\", finalUrl);\r\n\t\t\r\n\t\treturn finalUrl;\r\n\t};\r\n\r\n\t// FUNCIÓN CORREGIDA PARA CALCULAR PRECIO CON DESCUENTO - CONVIERTE STRINGS A NUMBERS\r\n\tconst calculateDiscountedPrice = (product: FavoriteProduct): { original: number, discounted: number, discount: number } => {\r\n\t\tconsole.log(\"💰 FavoritePage - Datos del producto completo:\", product);\r\n\t\t\r\n\t\t// CONVERTIR STRINGS A NÚMEROS - ESTA ERA LA PARTE QUE FALTABA\r\n\t\tconst originalPrice = parseFloat(product.price?.toString() || \"0\");\r\n\t\tconst discountPercentage = parseFloat((product.discount_percentage || product.discount)?.toString() || \"0\");\r\n\t\t\r\n\t\tconsole.log(\"💰 FavoritePage - Precio original (convertido):\", originalPrice);\r\n\t\tconsole.log(\"💰 FavoritePage - Descuento % (convertido):\", discountPercentage);\r\n\t\t\r\n\t\t// Calcular precio con descuento\r\n\t\tlet discountedPrice = originalPrice;\r\n\t\tif (discountPercentage > 0) {\r\n\t\t\tdiscountedPrice = originalPrice - (originalPrice * (discountPercentage / 100));\r\n\t\t}\r\n\t\t\r\n\t\tconsole.log(\"💰 FavoritePage - Precio con descuento:\", discountedPrice);\r\n\t\t\r\n\t\treturn {\r\n\t\t\toriginal: originalPrice,\r\n\t\t\tdiscounted: discountedPrice,\r\n\t\t\tdiscount: discountPercentage\r\n\t\t};\r\n\t};\r\n\r\n\t// FUNCIÓN CORREGIDA PARA RENDERIZAR ESTRELLAS - CONVIERTE STRINGS A NUMBERS\r\n\tconst renderRatingStars = (rating: number | string = 0, ratingCount: number | string = 0) => {\r\n\t\t// CONVERTIR STRINGS A NÚMEROS\r\n\t\tconst safeRating = parseFloat(rating?.toString() || \"0\");\r\n\t\tconst safeRatingCount = parseInt(ratingCount?.toString() || \"0\");\r\n\r\n\t\tconsole.log(\"⭐ renderRatingStars:\", { rating, safeRating, ratingCount, safeRatingCount });\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t{[1, 2, 3, 4, 5].map((star) => (\r\n\t\t\t\t\t<Star\r\n\t\t\t\t\t\tkey={star}\r\n\t\t\t\t\t\tsize={14}\r\n\t\t\t\t\t\tclassName={`${\r\n\t\t\t\t\t\t\tstar <= Math.round(safeRating)\r\n\t\t\t\t\t\t\t\t? \"text-yellow-400 fill-current\"\r\n\t\t\t\t\t\t\t\t: \"text-gray-300\"\r\n\t\t\t\t\t\t}`}\r\n\t\t\t\t\t/>\r\n\t\t\t\t))}\r\n\t\t\t\t<span className=\"ml-2 text-sm text-gray-600\">\r\n\t\t\t\t\t{safeRating.toFixed(1)} ({safeRatingCount})\r\n\t\t\t\t</span>\r\n\t\t\t</div>\r\n\t\t);\r\n\t};\r\n\r\n\tconst openPreferences = (favoriteId: number) => {\r\n\t\tif (favoriteId) {\r\n\t\t\tsetActivePreferences(favoriteId);\r\n\t\t}\r\n\t};\r\n\r\n\tconst closePreferences = () => {\r\n\t\tsetActivePreferences(null);\r\n\t};\r\n\r\n\tconst loadMore = () => {\r\n\t\tif (hasMore) {\r\n\t\t\tsetCurrentPage((prev) => prev + 1);\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"container mx-auto px-10 lg:px-20 py-10\">\r\n\t\t\t<div className=\"flex flex-wrap justify-between items-center mb-8\">\r\n\t\t\t\t<h1 className=\"text-3xl font-bold\">Mis Favoritos</h1>\r\n\r\n\t\t\t\t{!isEmpty && !isLoading && (\r\n\t\t\t\t\t<div className=\"text-sm text-gray-500 mt-2 md:mt-0 px-3 py-1.5 bg-gray-100 rounded-full\">\r\n\t\t\t\t\t\t{total} {total === 1 ? \"producto\" : \"productos\"} en tu lista\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\r\n\t\t\t{error && (\r\n\t\t\t\t<div className=\"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6\">\r\n\t\t\t\t\t{error}\r\n\t\t\t\t\t<button className=\"ml-2 underline\" onClick={fetchFavorites}>\r\n\t\t\t\t\t\tReintentar\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{isLoading ? (\r\n\t\t\t\t<div className=\"flex justify-center items-center h-64\">\r\n\t\t\t\t\t<div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600\"></div>\r\n\t\t\t\t</div>\r\n\t\t\t) : isEmpty ? (\r\n\t\t\t\t<div className=\"text-center py-20 bg-gradient-to-b from-gray-50 to-white rounded-xl shadow-md\">\r\n\t\t\t\t\t<Heart className=\"mx-auto h-16 w-16 text-red-100 mb-6\" />\r\n\t\t\t\t\t<h2 className=\"text-2xl font-semibold text-gray-700 mb-3\">\r\n\t\t\t\t\t\tTu lista de favoritos está vacía\r\n\t\t\t\t\t</h2>\r\n\t\t\t\t\t<p className=\"text-gray-500 mb-8 max-w-md mx-auto\">\r\n\t\t\t\t\t\tGuarda los productos que te gusten para verlos más tarde.\r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t<Link\r\n\t\t\t\t\t\tto=\"/products\"\r\n\t\t\t\t\t\tclassName=\"inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-lg text-white bg-primary-600 hover:bg-primary-700 shadow-sm hover:shadow transition-all\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tExplorar productos\r\n\t\t\t\t\t</Link>\r\n\t\t\t\t</div>\r\n\t\t\t) : (\r\n\t\t\t\t<div className=\"bg-white rounded-xl shadow-lg overflow-hidden\">\r\n\t\t\t\t\t{favorites.map((item, index) => {\r\n\t\t\t\t\t\tconst product = item.product;\r\n\t\t\t\t\t\tif (!product) return null;\r\n\r\n\t\t\t\t\t\tconst isInStock =\r\n\t\t\t\t\t\t\tproduct.is_in_stock !== undefined\r\n\t\t\t\t\t\t\t\t? product.is_in_stock\r\n\t\t\t\t\t\t\t\t: product.stock > 0;\r\n\r\n\t\t\t\t\t\t// USAR LA FUNCIÓN CORREGIDA QUE CONVIERTE STRINGS\r\n\t\t\t\t\t\tconst prices = calculateDiscountedPrice(product);\r\n\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\tkey={item.favorite.id}\r\n\t\t\t\t\t\t\t\tclassName={`flex flex-col sm:flex-row p-6 ${\r\n\t\t\t\t\t\t\t\t\tindex !== favorites.length - 1\r\n\t\t\t\t\t\t\t\t\t\t? \"border-b border-gray-200\"\r\n\t\t\t\t\t\t\t\t\t\t: \"\"\r\n\t\t\t\t\t\t\t\t} hover:bg-gray-50 transition-colors`}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{/* Imagen del producto con badges - NAVEGACIÓN CORREGIDA */}\r\n\t\t\t\t\t\t\t\t<div className=\"sm:w-40 sm:h-40 h-60 w-full flex-shrink-0 mx-auto sm:mx-0 relative\">\r\n\t\t\t\t\t\t\t\t\t<Link to={`/products/${product.id}`}>\r\n\t\t\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\t\t\tsrc={getProductImage(product)}\r\n\t\t\t\t\t\t\t\t\t\t\talt={product.name}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full h-full object-contain sm:object-cover rounded-lg shadow-sm\"\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</Link>\r\n\r\n\t\t\t\t\t\t\t\t\t{/* Badges */}\r\n\t\t\t\t\t\t\t\t\t<div className=\"absolute top-2 left-2 flex flex-col space-y-1\">\r\n\t\t\t\t\t\t\t\t\t\t{prices.discount > 0 && (\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-md shadow-sm\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{prices.discount}% OFF\r\n\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t{product.isNew && (\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"bg-green-500 text-white text-xs font-bold px-2 py-1 rounded-md shadow-sm\">\r\n\t\t\t\t\t\t\t\t\t\t\t\tNUEVO\r\n\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t{/* Información del producto */}\r\n\t\t\t\t\t\t\t\t<div className=\"flex-1 sm:ml-6 mt-4 sm:mt-0 flex flex-col\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex justify-between\">\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t{/* Categoría */}\r\n\t\t\t\t\t\t\t\t\t\t\t{product.category && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"inline-block text-xs font-medium text-gray-500 bg-gray-100 px-2 py-1 rounded-md mb-2 uppercase tracking-wide\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{product.category}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t{/* Nombre del producto - NAVEGACIÓN CORREGIDA */}\r\n\t\t\t\t\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\t\t\t\t\tto={`/products/${product.id}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"block\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<h3 className=\"text-xl font-medium text-gray-800 hover:text-primary-600 transition-colors mb-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{product.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t\t\t\t\t\t</Link>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t{/* Valoración - FUNCIÓN CORREGIDA QUE CONVIERTE STRINGS */}\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"mb-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{renderRatingStars(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tproduct.rating || 0,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tproduct.rating_count || 0\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t{/* Disponibilidad */}\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"mb-3\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{isInStock ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"inline-flex items-center text-sm text-green-600\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Check size={14} className=\"mr-1\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tEn stock\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"inline-flex items-center text-sm text-amber-600\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AlertTriangle size={14} className=\"mr-1\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tAgotado\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t{/* Botones de acciones */}\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex space-x-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => openPreferences(item.favorite.id)}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"cursor-pointer text-gray-400 hover:text-blue-500 transition-colors\"\r\n\t\t\t\t\t\t\t\t\t\t\t\taria-label=\"Configurar notificaciones\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Settings\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize={20}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"stroke-current\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => handleRemoveFromWishlist(product.id)}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"cursor-pointer text-gray-400 hover:text-red-500 transition-colors\"\r\n\t\t\t\t\t\t\t\t\t\t\t\taria-label=\"Eliminar de favoritos\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Trash2\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsize={20}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"stroke-current\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t{/* Precio y botón de añadir al carrito - USANDO PRICES CALCULADOS CORRECTAMENTE */}\r\n\t\t\t\t\t\t\t\t\t<div className=\"mt-auto pt-4 flex flex-wrap sm:flex-nowrap items-center justify-between\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center mb-3 sm:mb-0\">\r\n\t\t\t\t\t\t\t\t\t\t\t{prices.discount > 0 ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"font-bold text-primary-600 text-xl\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatCurrency(prices.discounted)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm text-gray-500 line-through ml-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatCurrency(prices.original)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"ml-3 px-2 py-1 text-xs font-semibold text-white bg-red-500 rounded\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{prices.discount}% DESCUENTO\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"font-bold text-primary-600 text-xl\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{formatCurrency(prices.original)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => handleAddToCart(product)}\r\n\t\t\t\t\t\t\t\t\t\t\tdisabled={!isInStock}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName={`cursor-pointer inline-flex items-center px-5 py-2.5 rounded-lg text-white font-medium transition-all ${\r\n\t\t\t\t\t\t\t\t\t\t\t\tisInStock\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? \"bg-primary-600 hover:bg-primary-700 shadow-sm hover:shadow\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: \"bg-gray-400 cursor-not-allowed\"\r\n\t\t\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t<ShoppingCart size={18} className=\"mr-2\" />\r\n\t\t\t\t\t\t\t\t\t\t\t{isInStock ? \"Añadir al carrito\" : \"Agotado\"}\r\n\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t})}\r\n\r\n\t\t\t\t\t{/* Paginación o botón \"cargar más\" */}\r\n\t\t\t\t\t{hasMore && (\r\n\t\t\t\t\t\t<div className=\"flex justify-center py-4\">\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tonClick={loadMore}\r\n\t\t\t\t\t\t\t\tclassName=\"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tCargar más favoritos\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{/* Modal para las preferencias de notificación */}\r\n\t\t\t{activePreferences !== null && (\r\n\t\t\t\t<NotificationPreferences\r\n\t\t\t\t\tfavoriteId={activePreferences}\r\n\t\t\t\t\tinitialPreferences={{\r\n\t\t\t\t\t\tnotifyPriceChange:\r\n\t\t\t\t\t\t\tfavorites.find((f) => f.favorite.id === activePreferences)\r\n\t\t\t\t\t\t\t\t?.favorite.notifyPriceChange || true,\r\n\t\t\t\t\t\tnotifyPromotion:\r\n\t\t\t\t\t\t\tfavorites.find((f) => f.favorite.id === activePreferences)\r\n\t\t\t\t\t\t\t\t?.favorite.notifyPromotion || true,\r\n\t\t\t\t\t\tnotifyLowStock:\r\n\t\t\t\t\t\t\tfavorites.find((f) => f.favorite.id === activePreferences)\r\n\t\t\t\t\t\t\t\t?.favorite.notifyLowStock || true,\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tonClose={closePreferences}\r\n\t\t\t\t/>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default FavoritePage;"],"names":["useFavoriteApi","loading","setLoading","useState","error","setError","isAuthenticated","useAuth","limit","offset","response","ApiClient","API_ENDPOINTS","favorites","item","index","err","errorMessage","productId","notificationPreferences","preferences","favoriteId","NotificationPreferences","initialPreferences","onClose","setPreferences","isSaving","setIsSaving","updateNotificationPreferences","handleChange","e","name","checked","prev","handleSave","jsxs","jsx","FavoritePage","setFavorites","isLoading","setIsLoading","isEmpty","setIsEmpty","activePreferences","setActivePreferences","currentPage","setCurrentPage","hasMore","setHasMore","total","setTotal","getUserFavorites","toggleFavorite","addToCart","useCart","navigate","useNavigate","useEffect","fetchFavorites","result","formattedFavorites","handleRemoveFromWishlist","handleAddToCart","product","getProductImage","imagePath","firstImage","finalUrl","getImageUrl","calculateDiscountedPrice","originalPrice","discountPercentage","discountedPrice","renderRatingStars","rating","ratingCount","safeRating","safeRatingCount","star","Star","openPreferences","closePreferences","loadMore","Heart","Link","isInStock","prices","Check","AlertTriangle","Settings","Trash2","Fragment","formatCurrency","ShoppingCart","f"],"mappings":"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"}