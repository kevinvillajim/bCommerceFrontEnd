{"version":3,"file":"PendingRatingsPage-4eXLevHM.js","sources":["../../src/core/adapters/PendingRatingsAdapter.ts","../../src/presentation/components/rating/RatingModal.tsx","../../src/presentation/hooks/useRatings.ts","../../src/presentation/components/rating/PendingRatingsList.tsx","../../src/presentation/pages/account/PendingRatingsPage.tsx"],"sourcesContent":["import type {\r\n\tPendingRatingItem,\r\n\tPendingSellerItem,\r\n\tPendingRatingsResponse,\r\n} from \"../services/RatingService\";\r\n\r\n/**\r\n * Interfaz para los grupos de órdenes procesados\r\n */\r\nexport interface OrderGroup {\r\n\torderId: number;\r\n\torderNumber: string;\r\n\torderDate: string;\r\n\tproducts: PendingRatingItem[];\r\n\tsellers: PendingRatingItem[];\r\n}\r\n\r\n/**\r\n * Adaptador para transformar la respuesta de la API de valoraciones pendientes\r\n * al formato requerido por el componente PendingRatingsList\r\n */\r\nexport class PendingRatingsAdapter {\r\n\t/**\r\n\t * Adapta la respuesta de la API al formato esperado por los componentes de UI\r\n\t * @param apiResponse Respuesta de la API con valoraciones pendientes\r\n\t * @returns Lista de grupos de órdenes con sus productos y vendedores pendientes de valorar\r\n\t */\r\n\tstatic adaptPendingRatings(\r\n\t\tapiResponse: PendingRatingsResponse\r\n\t): OrderGroup[] {\r\n\t\t// Si no hay respuesta o es inválida, devolver un array vacío\r\n\t\tif (!apiResponse || !apiResponse.data) {\r\n\t\t\treturn [];\r\n\t\t}\r\n\r\n\t\tconst {products, sellers} = apiResponse.data;\r\n\r\n\t\t// Mapa para agrupar por orden\r\n\t\tconst orderGroupsMap = new Map<number, OrderGroup>();\r\n\r\n\t\t// Procesar productos\r\n\t\t(products || []).forEach((product) => {\r\n\t\t\tconst orderId = product.order_id;\r\n\r\n\t\t\t// Si no existe el grupo para esta orden, crearlo\r\n\t\t\tif (!orderGroupsMap.has(orderId)) {\r\n\t\t\t\torderGroupsMap.set(orderId, {\r\n\t\t\t\t\torderId,\r\n\t\t\t\t\torderNumber: product.order_number,\r\n\t\t\t\t\torderDate: product.order_date,\r\n\t\t\t\t\tproducts: [],\r\n\t\t\t\t\tsellers: [],\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// Añadir el producto al grupo\r\n\t\t\torderGroupsMap.get(orderId)?.products.push(product);\r\n\t\t});\r\n\r\n\t\t// Procesar vendedores\r\n\t\t(sellers || []).forEach((seller: PendingSellerItem) => {\r\n\t\t\tconst orderId = seller.order_id;\r\n\r\n\t\t\t// Si no existe el grupo para esta orden, crearlo\r\n\t\t\tif (!orderGroupsMap.has(orderId)) {\r\n\t\t\t\torderGroupsMap.set(orderId, {\r\n\t\t\t\t\torderId,\r\n\t\t\t\t\torderNumber: seller.order_number,\r\n\t\t\t\t\torderDate: seller.date, // Campo diferente para sellers\r\n\t\t\t\t\tproducts: [],\r\n\t\t\t\t\tsellers: [],\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// Adaptamos el objeto seller al formato PendingRatingItem\r\n\t\t\tconst adaptedSeller: PendingRatingItem = {\r\n\t\t\t\tid: seller.id || seller.seller_id,\r\n\t\t\t\tname: seller.name || `Vendedor #${seller.seller_id}`,\r\n\t\t\t\torder_id: seller.order_id,\r\n\t\t\t\torder_number: seller.order_number,\r\n\t\t\t\torder_date: seller.date,\r\n\t\t\t\timage: seller.image,\r\n\t\t\t};\r\n\r\n\t\t\t// Añadir el vendedor al grupo\r\n\t\t\torderGroupsMap.get(orderId)?.sellers.push(adaptedSeller);\r\n\t\t});\r\n\r\n\t\t// Convertir el mapa a array y ordenar por fecha (más reciente primero)\r\n\t\treturn Array.from(orderGroupsMap.values()).sort(\r\n\t\t\t(a, b) =>\r\n\t\t\t\tnew Date(b.orderDate).getTime() - new Date(a.orderDate).getTime()\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default PendingRatingsAdapter;\r\n","import React, {useState} from \"react\";\r\nimport {X, AlertTriangle, Package, Store} from \"lucide-react\";\r\nimport StarRating from \"./StarRating\";\r\n\r\ninterface RatingModalProps {\r\n\ttype: \"product\" | \"seller\";\r\n\tentityId: number;\r\n\tentityName: string;\r\n\tentityImage?: string;\r\n\torderId: number;\r\n\tisOpen: boolean;\r\n\tonClose: () => void;\r\n\tonSubmit: (data: {\r\n\t\trating: number;\r\n\t\ttitle?: string;\r\n\t\tcomment?: string;\r\n\t\tentityId: number;\r\n\t\torderId: number;\r\n\t}) => Promise<void>;\r\n\tonReport?: (data: {\r\n\t\ttype: \"product\" | \"seller\";\r\n\t\tentityId: number;\r\n\t\torderId: number;\r\n\t\tproblemType: string;\r\n\t\tdescription: string;\r\n\t}) => Promise<void>;\r\n}\r\n\r\n/**\r\n * Modal para valorar productos o vendedores\r\n */\r\nconst RatingModal: React.FC<RatingModalProps> = ({\r\n\ttype,\r\n\tentityId,\r\n\tentityName,\r\n\tentityImage,\r\n\torderId,\r\n\tisOpen,\r\n\tonClose,\r\n\tonSubmit,\r\n\tonReport,\r\n}) => {\r\n\t// Estados del formulario de valoración\r\n\tconst [rating, setRating] = useState<number>(0);\r\n\tconst [title, setTitle] = useState<string>(\"\");\r\n\tconst [comment, setComment] = useState<string>(\"\");\r\n\tconst [isSubmitting, setIsSubmitting] = useState<boolean>(false);\r\n\r\n\t// Estados para el modo reporte\r\n\tconst [isReportMode, setIsReportMode] = useState<boolean>(false);\r\n\tconst [problemType, setProblemType] = useState<string>(\"\");\r\n\tconst [problemDescription, setProblemDescription] = useState<string>(\"\");\r\n\r\n\t// Estado para confirmación de valoración negativa\r\n\tconst [showConfirmation, setShowConfirmation] = useState<boolean>(false);\r\n\r\n\t// Si el modal no está abierto, no lo renderizamos\r\n\tif (!isOpen) return null;\r\n\r\n\t// Reset de los formularios\r\n\tconst resetForm = () => {\r\n\t\tsetRating(0);\r\n\t\tsetTitle(\"\");\r\n\t\tsetComment(\"\");\r\n\t\tsetIsReportMode(false);\r\n\t\tsetProblemType(\"\");\r\n\t\tsetProblemDescription(\"\");\r\n\t\tsetShowConfirmation(false);\r\n\t};\r\n\r\n\t// Manejar cierre del modal\r\n\tconst handleClose = () => {\r\n\t\tresetForm();\r\n\t\tonClose();\r\n\t};\r\n\r\n\t// Manejar envío de valoración\r\n\tconst handleSubmit = async () => {\r\n\t\t// Validación: Asegurarse de que haya una calificación seleccionada\r\n\t\tif (rating === 0) {\r\n\t\t\talert(\"Por favor selecciona una calificación de 1 a 5 estrellas\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Si la valoración es baja (1-2 estrellas) y no estamos en modo confirmación\r\n\t\tif (rating <= 2 && !showConfirmation) {\r\n\t\t\tsetShowConfirmation(true);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tsetIsSubmitting(true);\r\n\r\n\t\t\tawait onSubmit({\r\n\t\t\t\trating,\r\n\t\t\t\ttitle: title.trim() || undefined,\r\n\t\t\t\tcomment: comment.trim() || undefined,\r\n\t\t\t\tentityId,\r\n\t\t\t\torderId,\r\n\t\t\t});\r\n\r\n\t\t\tresetForm();\r\n\t\t\tonClose();\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al enviar valoración:\", error);\r\n\t\t} finally {\r\n\t\t\tsetIsSubmitting(false);\r\n\t\t}\r\n\t};\r\n\r\n\t// Manejar envío de reporte\r\n\tconst handleReportSubmit = async () => {\r\n\t\tif (!onReport) return;\r\n\r\n\t\t// Validación: Asegurarse de que haya un tipo de problema y descripción\r\n\t\tif (!problemType) {\r\n\t\t\talert(\"Por favor selecciona el tipo de problema\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (!problemDescription.trim()) {\r\n\t\t\talert(\"Por favor describe el problema\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\tsetIsSubmitting(true);\r\n\r\n\t\t\tawait onReport({\r\n\t\t\t\ttype,\r\n\t\t\t\tentityId,\r\n\t\t\t\torderId,\r\n\t\t\t\tproblemType,\r\n\t\t\t\tdescription: problemDescription,\r\n\t\t\t});\r\n\r\n\t\t\tresetForm();\r\n\t\t\tonClose();\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al enviar reporte:\", error);\r\n\t\t} finally {\r\n\t\t\tsetIsSubmitting(false);\r\n\t\t}\r\n\t};\r\n\r\n\t// Alternar entre modos de valoración y reporte\r\n\tconst toggleReportMode = () => {\r\n\t\tsetIsReportMode(!isReportMode);\r\n\t\tsetShowConfirmation(false);\r\n\t};\r\n\r\n\t// Log para depuración\r\n\tconsole.log(\"Estado actual de rating:\", rating);\r\n\r\n\treturn (\r\n\t\t<div className=\"fixed inset-0 z-50 overflow-y-auto\">\r\n\t\t\t{/* Overlay oscuro */}\r\n\t\t\t<div\r\n\t\t\t\tclassName=\"fixed inset-0 bg-black bg-opacity-50 transition-opacity\"\r\n\t\t\t\tonClick={handleClose}\r\n\t\t\t></div>\r\n\r\n\t\t\t{/* Contenido del modal */}\r\n\t\t\t<div className=\"flex min-h-screen items-center justify-center p-4\">\r\n\t\t\t\t<div className=\"relative bg-white rounded-lg shadow-xl w-full max-w-md mx-auto\">\r\n\t\t\t\t\t{/* Botón de cierre */}\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={handleClose}\r\n\t\t\t\t\t\tclassName=\"absolute top-3 right-3 text-gray-400 hover:text-gray-500\"\r\n\t\t\t\t\t\tdisabled={isSubmitting}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<X size={24} />\r\n\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t{/* Título del modal */}\r\n\t\t\t\t\t<div className=\"px-6 py-4 border-b border-gray-200\">\r\n\t\t\t\t\t\t<h3 className=\"text-lg font-medium text-gray-900 flex items-center\">\r\n\t\t\t\t\t\t\t{isReportMode ? (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t<AlertTriangle className=\"mr-2 text-orange-500\" size={20} />\r\n\t\t\t\t\t\t\t\t\tReportar problema\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t{type === \"product\" ? (\r\n\t\t\t\t\t\t\t\t\t\t<Package className=\"mr-2 text-blue-500\" size={20} />\r\n\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t<Store className=\"mr-2 text-green-500\" size={20} />\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\tValorar {type === \"product\" ? \"producto\" : \"vendedor\"}\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className=\"px-6 py-4\">\r\n\t\t\t\t\t\t{/* Información del producto/vendedor */}\r\n\t\t\t\t\t\t<div className=\"flex items-center mb-4\">\r\n\t\t\t\t\t\t\t{entityImage ? (\r\n\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\tsrc={entityImage}\r\n\t\t\t\t\t\t\t\t\talt={entityName}\r\n\t\t\t\t\t\t\t\t\tclassName=\"w-16 h-16 object-cover rounded-md mr-4\"\r\n\t\t\t\t\t\t\t\t\tonError={(e) => {\r\n\t\t\t\t\t\t\t\t\t\tconst target = e.target as HTMLImageElement;\r\n\t\t\t\t\t\t\t\t\t\ttarget.onerror = null;\r\n\t\t\t\t\t\t\t\t\t\ttarget.src = \"https://via.placeholder.com/64?text=Imagen\";\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t<div className=\"w-16 h-16 bg-gray-200 rounded-md flex items-center justify-center mr-4\">\r\n\t\t\t\t\t\t\t\t\t{type === \"product\" ? (\r\n\t\t\t\t\t\t\t\t\t\t<Package size={24} className=\"text-gray-400\" />\r\n\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t<Store size={24} className=\"text-gray-400\" />\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<h4 className=\"font-medium text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t{entityName}\r\n\t\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t\t<p className=\"text-sm text-gray-500\">\r\n\t\t\t\t\t\t\t\t\tPedido: #{orderId}\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{/* Formulario de Valoración */}\r\n\t\t\t\t\t\t{!isReportMode && !showConfirmation && (\r\n\t\t\t\t\t\t\t<div className=\"space-y-4\">\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n\t\t\t\t\t\t\t\t\t\tTu valoración\r\n\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t<StarRating\r\n\t\t\t\t\t\t\t\t\t\tvalue={rating}\r\n\t\t\t\t\t\t\t\t\t\tonChange={(value) => {\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"Valor de StarRating seleccionado:\", value);\r\n\t\t\t\t\t\t\t\t\t\t\tsetRating(value);\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\tsize=\"large\"\r\n\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\t\t\t\thtmlFor=\"rating-title\"\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"block text-sm font-medium text-gray-700 mb-1\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\tTítulo (opcional)\r\n\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\tid=\"rating-title\"\r\n\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"Resume tu experiencia\"\r\n\t\t\t\t\t\t\t\t\t\tvalue={title}\r\n\t\t\t\t\t\t\t\t\t\tonChange={(e) => setTitle(e.target.value)}\r\n\t\t\t\t\t\t\t\t\t\tmaxLength={100}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\t\t\t\thtmlFor=\"rating-comment\"\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"block text-sm font-medium text-gray-700 mb-1\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\tComentario (opcional)\r\n\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t<textarea\r\n\t\t\t\t\t\t\t\t\t\tid=\"rating-comment\"\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"Comparte tu experiencia con este producto\"\r\n\t\t\t\t\t\t\t\t\t\tvalue={comment}\r\n\t\t\t\t\t\t\t\t\t\tonChange={(e) => setComment(e.target.value)}\r\n\t\t\t\t\t\t\t\t\t\tmaxLength={500}\r\n\t\t\t\t\t\t\t\t\t\trows={4}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t{/* Formulario de Reporte de Problema */}\r\n\t\t\t\t\t\t{isReportMode && !showConfirmation && (\r\n\t\t\t\t\t\t\t<div className=\"space-y-4\">\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\t\t\t\thtmlFor=\"problem-type\"\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"block text-sm font-medium text-gray-700 mb-1\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\tTipo de problema\r\n\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t<select\r\n\t\t\t\t\t\t\t\t\t\tid=\"problem-type\"\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500 bg-white\"\r\n\t\t\t\t\t\t\t\t\t\tvalue={problemType}\r\n\t\t\t\t\t\t\t\t\t\tonChange={(e) => setProblemType(e.target.value)}\r\n\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<option value=\"\">Selecciona el tipo de problema</option>\r\n\t\t\t\t\t\t\t\t\t\t{type === \"product\" ? (\r\n\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"not_received\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tProducto no recibido\r\n\t\t\t\t\t\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"damaged\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tProducto dañado/defectuoso\r\n\t\t\t\t\t\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"different\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tProducto diferente al descrito\r\n\t\t\t\t\t\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"incomplete\">Producto incompleto</option>\r\n\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"communication\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tProblemas de comunicación\r\n\t\t\t\t\t\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"shipping\">Problemas de envío</option>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<option value=\"customer_service\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tMala atención al cliente\r\n\t\t\t\t\t\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t<option value=\"other\">Otro problema</option>\r\n\t\t\t\t\t\t\t\t\t</select>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\t\t\t\thtmlFor=\"problem-description\"\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"block text-sm font-medium text-gray-700 mb-1\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\tDescripción del problema\r\n\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t<textarea\r\n\t\t\t\t\t\t\t\t\t\tid=\"problem-description\"\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-primary-500 focus:border-primary-500\"\r\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"Describe el problema en detalle\"\r\n\t\t\t\t\t\t\t\t\t\tvalue={problemDescription}\r\n\t\t\t\t\t\t\t\t\t\tonChange={(e) => setProblemDescription(e.target.value)}\r\n\t\t\t\t\t\t\t\t\t\trows={4}\r\n\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t{/* Confirmación de valoración negativa */}\r\n\t\t\t\t\t\t{showConfirmation && (\r\n\t\t\t\t\t\t\t<div className=\"bg-yellow-50 p-4 rounded-md\">\r\n\t\t\t\t\t\t\t\t<div className=\"flex items-start\">\r\n\t\t\t\t\t\t\t\t\t<AlertTriangle\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"text-yellow-600 mt-0.5 mr-3\"\r\n\t\t\t\t\t\t\t\t\t\tsize={20}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t<h4 className=\"font-medium text-yellow-800\">\r\n\t\t\t\t\t\t\t\t\t\t\t¿Estás seguro de enviar una valoración baja?\r\n\t\t\t\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-yellow-700 mt-1\">\r\n\t\t\t\t\t\t\t\t\t\t\tHas calificado este{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t\t{type === \"product\" ? \"producto\" : \"vendedor\"} con{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t\t{rating} {rating === 1 ? \"estrella\" : \"estrellas\"}.\r\n\t\t\t\t\t\t\t\t\t\t\t¿Quieres continuar o prefieres reportar un problema\r\n\t\t\t\t\t\t\t\t\t\t\tespecífico?\r\n\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Pie del modal con botones de acción */}\r\n\t\t\t\t\t<div className=\"px-6 py-4 border-t border-gray-200 flex justify-between\">\r\n\t\t\t\t\t\t{/* Botón izquierdo (varía según el contexto) */}\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t{!showConfirmation && (\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\tonClick={toggleReportMode}\r\n\t\t\t\t\t\t\t\t\tclassName=\"text-sm text-gray-600 hover:text-gray-800 flex items-center\"\r\n\t\t\t\t\t\t\t\t\tdisabled={isSubmitting}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{isReportMode ? (\r\n\t\t\t\t\t\t\t\t\t\t<>Volver a valoración</>\r\n\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t<AlertTriangle size={14} className=\"mr-1\" />\r\n\t\t\t\t\t\t\t\t\t\t\tReportar problema\r\n\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{/* Botones principales */}\r\n\t\t\t\t\t\t<div className=\"space-x-3\">\r\n\t\t\t\t\t\t\t{/* Botón de cancelar */}\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\tonClick={handleClose}\r\n\t\t\t\t\t\t\t\tclassName=\"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300\"\r\n\t\t\t\t\t\t\t\tdisabled={isSubmitting}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tCancelar\r\n\t\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t\t{/* Botón de acción principal */}\r\n\t\t\t\t\t\t\t{showConfirmation ? (\r\n\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => setShowConfirmation(false)}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 focus:outline-none focus:ring-2 focus:ring-yellow-500\"\r\n\t\t\t\t\t\t\t\t\t\tdisabled={isSubmitting}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\tModificar valoración\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\t\tonClick={handleSubmit}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n\t\t\t\t\t\t\t\t\t\tdisabled={isSubmitting}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{isSubmitting ? \"Enviando...\" : \"Enviar valoración\"}\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\tonClick={isReportMode ? handleReportSubmit : handleSubmit}\r\n\t\t\t\t\t\t\t\t\tclassName={`px-4 py-2 text-white rounded-lg focus:outline-none focus:ring-2 ${\r\n\t\t\t\t\t\t\t\t\t\tisReportMode\r\n\t\t\t\t\t\t\t\t\t\t\t? \"bg-orange-600 hover:bg-orange-700 focus:ring-orange-500\"\r\n\t\t\t\t\t\t\t\t\t\t\t: \"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500\"\r\n\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t\tdisabled={\r\n\t\t\t\t\t\t\t\t\t\tisSubmitting ||\r\n\t\t\t\t\t\t\t\t\t\t(isReportMode &&\r\n\t\t\t\t\t\t\t\t\t\t\t(!problemType || !problemDescription.trim())) ||\r\n\t\t\t\t\t\t\t\t\t\t(!isReportMode && rating === 0)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{isSubmitting\r\n\t\t\t\t\t\t\t\t\t\t? \"Enviando...\"\r\n\t\t\t\t\t\t\t\t\t\t: isReportMode\r\n\t\t\t\t\t\t\t\t\t\t\t? \"Enviar reporte\"\r\n\t\t\t\t\t\t\t\t\t\t\t: \"Enviar valoración\"}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default RatingModal;\r\n","// src/presentation/hooks/useRatings.ts\r\nimport {useState, useCallback} from \"react\";\r\nimport RatingService from \"../../core/services/RatingService\";\r\nimport type {\r\n\tProductRatingRequest,\r\n\tSellerRatingRequest,\r\n\tProblemReportRequest,\r\n\tRatingReplyRequest,\r\n\tRatingReportRequest,\r\n} from \"../../core/services/RatingService\";\r\nimport {extractErrorMessage} from \"../../utils/errorHandler\";\r\n\r\nexport const useRatings = () => {\r\n\tconst [loading, setLoading] = useState(false);\r\n\tconst [error, setError] = useState<string | null>(null);\r\n\tconst ratingService = new RatingService();\r\n\r\n\t// Función para obtener valoraciones pendientes\r\n\tconst getPendingRatings = useCallback(async () => {\r\n\t\tsetLoading(true);\r\n\t\tsetError(null);\r\n\t\ttry {\r\n\t\t\tconsole.log(\"Solicitando valoraciones pendientes...\");\r\n\t\t\tconst response = await ratingService.getPendingRatings();\r\n\t\t\tconsole.log(\"Respuesta de valoraciones pendientes:\", response);\r\n\t\t\treturn response;\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error(\"Error al obtener valoraciones pendientes:\", err);\r\n\t\t\tconst errorMessage = extractErrorMessage(\r\n\t\t\t\terr,\r\n\t\t\t\t\"Error al obtener valoraciones pendientes\"\r\n\t\t\t);\r\n\t\t\tsetError(errorMessage);\r\n\t\t\treturn {\r\n\t\t\t\tstatus: \"error\",\r\n\t\t\t\tmessage: errorMessage,\r\n\t\t\t\tdata: {products: [], sellers: []},\r\n\t\t\t};\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t}, [ratingService]);\r\n\r\n\t// Función para valorar un producto\r\n\tconst rateProduct = useCallback(\r\n\t\tasync (data: ProductRatingRequest) => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\t\t\ttry {\r\n\t\t\t\tconsole.log(\"Enviando valoración de producto:\", data);\r\n\t\t\t\tconst response = await ratingService.rateProduct(data);\r\n\t\t\t\tconsole.log(\"Respuesta al valorar producto:\", response);\r\n\t\t\t\treturn response;\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error(\"Error al valorar producto:\", err);\r\n\t\t\t\tconst errorMessage = extractErrorMessage(\r\n\t\t\t\t\terr,\r\n\t\t\t\t\t\"Error al valorar producto\"\r\n\t\t\t\t);\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\tthrow new Error(errorMessage);\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[ratingService]\r\n\t);\r\n\r\n\t// Función para valorar un vendedor\r\n\tconst rateSeller = useCallback(\r\n\t\tasync (data: SellerRatingRequest) => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\t\t\ttry {\r\n\t\t\t\tconsole.log(\"Enviando valoración de vendedor:\", data);\r\n\t\t\t\tconst response = await ratingService.rateSeller(data);\r\n\t\t\t\tconsole.log(\"Respuesta al valorar vendedor:\", response);\r\n\t\t\t\treturn response;\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error(\"Error al valorar vendedor:\", err);\r\n\t\t\t\tconst errorMessage = extractErrorMessage(\r\n\t\t\t\t\terr,\r\n\t\t\t\t\t\"Error al valorar vendedor\"\r\n\t\t\t\t);\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\tthrow new Error(errorMessage);\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[ratingService]\r\n\t);\r\n\r\n\t// Función para reportar un problema\r\n\tconst reportProblem = useCallback(\r\n\t\tasync (data: ProblemReportRequest) => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\t\t\ttry {\r\n\t\t\t\tconsole.log(\"Enviando reporte de problema:\", data);\r\n\t\t\t\tconst response = await ratingService.reportProblem(data);\r\n\t\t\t\tconsole.log(\"Respuesta al reportar problema:\", response);\r\n\t\t\t\treturn response;\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error(\"Error al reportar problema:\", err);\r\n\t\t\t\tconst errorMessage = extractErrorMessage(\r\n\t\t\t\t\terr,\r\n\t\t\t\t\t\"Error al reportar problema\"\r\n\t\t\t\t);\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\tthrow new Error(errorMessage);\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[ratingService]\r\n\t);\r\n\r\n\t// Función para responder a una valoración\r\n\tconst replyToRating = useCallback(\r\n\t\tasync (ratingId: number, replyText: string) => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\t\t\ttry {\r\n\t\t\t\tconsole.log(\"Enviando respuesta a valoración:\", {ratingId, replyText});\r\n\t\t\t\tconst request: RatingReplyRequest = {\r\n\t\t\t\t\trating_id: ratingId,\r\n\t\t\t\t\treply_text: replyText,\r\n\t\t\t\t};\r\n\t\t\t\tconst response = await ratingService.replyToRating(request);\r\n\t\t\t\tconsole.log(\"Respuesta al responder valoración:\", response);\r\n\t\t\t\treturn response;\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error(\"Error al responder valoración:\", err);\r\n\t\t\t\tconst errorMessage = extractErrorMessage(\r\n\t\t\t\t\terr,\r\n\t\t\t\t\t\"Error al responder valoración\"\r\n\t\t\t\t);\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\tthrow new Error(errorMessage);\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[ratingService]\r\n\t);\r\n\r\n\t// Función para reportar una valoración inapropiada\r\n\tconst reportRating = useCallback(\r\n\t\tasync (ratingId: number, reason: string) => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\t\t\ttry {\r\n\t\t\t\tconsole.log(\"Enviando reporte de valoración:\", {ratingId, reason});\r\n\t\t\t\tconst request: RatingReportRequest = {\r\n\t\t\t\t\trating_id: ratingId,\r\n\t\t\t\t\treason: reason,\r\n\t\t\t\t};\r\n\t\t\t\tconst response = await ratingService.reportRating(request);\r\n\t\t\t\tconsole.log(\"Respuesta al reportar valoración:\", response);\r\n\t\t\t\treturn response;\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error(\"Error al reportar valoración:\", err);\r\n\t\t\t\tconst errorMessage = extractErrorMessage(\r\n\t\t\t\t\terr,\r\n\t\t\t\t\t\"Error al reportar valoración\"\r\n\t\t\t\t);\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\tthrow new Error(errorMessage);\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[ratingService]\r\n\t);\r\n\r\n\t// Función para obtener valoraciones de un producto\r\n\tconst getProductRatings = useCallback(\r\n\t\tasync (productId: number, page: number = 1, perPage: number = 10) => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\t\t\ttry {\r\n\t\t\t\tconsole.log(`Obteniendo valoraciones del producto ${productId}...`);\r\n\t\t\t\tconst response = await ratingService.getProductRatings(\r\n\t\t\t\t\tproductId,\r\n\t\t\t\t\tpage,\r\n\t\t\t\t\tperPage\r\n\t\t\t\t);\r\n\t\t\t\tconsole.log(`Valoraciones del producto ${productId}:`, response);\r\n\t\t\t\treturn response;\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error(\r\n\t\t\t\t\t`Error al obtener valoraciones del producto ${productId}:`,\r\n\t\t\t\t\terr\r\n\t\t\t\t);\r\n\t\t\t\tconst errorMessage = extractErrorMessage(\r\n\t\t\t\t\terr,\r\n\t\t\t\t\t\"Error al obtener valoraciones del producto\"\r\n\t\t\t\t);\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\tthrow new Error(errorMessage);\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[ratingService]\r\n\t);\r\n\r\n\t// Función para obtener valoraciones de un vendedor\r\n\tconst getSellerRatings = useCallback(\r\n\t\tasync (sellerId: number, page: number = 1, perPage: number = 10) => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\t\t\ttry {\r\n\t\t\t\tconsole.log(`Obteniendo valoraciones del vendedor ${sellerId}...`);\r\n\t\t\t\tconst response = await ratingService.getSellerRatings(\r\n\t\t\t\t\tsellerId,\r\n\t\t\t\t\tpage,\r\n\t\t\t\t\tperPage\r\n\t\t\t\t);\r\n\t\t\t\tconsole.log(`Valoraciones del vendedor ${sellerId}:`, response);\r\n\t\t\t\treturn response;\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error(\r\n\t\t\t\t\t`Error al obtener valoraciones del vendedor ${sellerId}:`,\r\n\t\t\t\t\terr\r\n\t\t\t\t);\r\n\t\t\t\tconst errorMessage = extractErrorMessage(\r\n\t\t\t\t\terr,\r\n\t\t\t\t\t\"Error al obtener valoraciones del vendedor\"\r\n\t\t\t\t);\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\tthrow new Error(errorMessage);\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[ratingService]\r\n\t);\r\n\r\n\t// Función para obtener mis valoraciones recibidas\r\n\tconst getMyReceivedRatings = useCallback(\r\n\t\tasync (page: number = 1, perPage: number = 10, status?: string) => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\t\t\ttry {\r\n\t\t\t\tconsole.log(\"Obteniendo mis valoraciones recibidas...\");\r\n\t\t\t\tconst response = await ratingService.getMyReceivedRatings(\r\n\t\t\t\t\tpage,\r\n\t\t\t\t\tperPage,\r\n\t\t\t\t\tstatus\r\n\t\t\t\t);\r\n\t\t\t\tconsole.log(\"Mis valoraciones recibidas:\", response);\r\n\t\t\t\treturn response;\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconsole.error(\"Error al obtener mis valoraciones recibidas:\", err);\r\n\t\t\t\tconst errorMessage = extractErrorMessage(\r\n\t\t\t\t\terr,\r\n\t\t\t\t\t\"Error al obtener mis valoraciones recibidas\"\r\n\t\t\t\t);\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\tthrow new Error(errorMessage);\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[ratingService]\r\n\t);\r\n\r\n\treturn {\r\n\t\tloading,\r\n\t\terror,\r\n\t\tgetPendingRatings,\r\n\t\trateProduct,\r\n\t\trateSeller,\r\n\t\treportProblem,\r\n\t\treplyToRating,\r\n\t\treportRating,\r\n\t\tgetProductRatings,\r\n\t\tgetSellerRatings,\r\n\t\tgetMyReceivedRatings,\r\n\t};\r\n};\r\n","// src/presentation/components/rating/PendingRatingsList.tsx\r\nimport React from \"react\";\r\nimport {Link} from \"react-router-dom\";\r\nimport {Package, Store, Clock, Star} from \"lucide-react\";\r\nimport {formatDate} from \"../../../utils/formatters/formatDate\";\r\nimport type {PendingRatingItem} from \"../../../core/services/RatingService\";\r\n\r\ninterface PendingRatingsListProps {\r\n\torderGroups: Array<{\r\n\t\torderId: number;\r\n\t\torderNumber: string;\r\n\t\torderDate: string;\r\n\t\tproducts: PendingRatingItem[];\r\n\t\tsellers: PendingRatingItem[];\r\n\t}>;\r\n\tonRateProduct: (product: PendingRatingItem) => void;\r\n\tonRateSeller: (seller: PendingRatingItem) => void;\r\n}\r\n\r\nconst PendingRatingsList: React.FC<PendingRatingsListProps> = ({\r\n\torderGroups,\r\n\tonRateProduct,\r\n\tonRateSeller,\r\n}) => {\r\n\treturn (\r\n\t\t<div className=\"space-y-6\">\r\n\t\t\t{orderGroups.map((group) => (\r\n\t\t\t\t<div\r\n\t\t\t\t\tkey={`order-${group.orderId}`}\r\n\t\t\t\t\tclassName=\"bg-white rounded-lg shadow-sm overflow-hidden\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{/* Cabecera de la orden */}\r\n\t\t\t\t\t<div className=\"bg-gray-50 px-6 py-4 border-b border-gray-200\">\r\n\t\t\t\t\t\t<div className=\"flex flex-col md:flex-row md:justify-between md:items-center\">\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<h3 className=\"text-lg font-medium text-gray-900\">\r\n\t\t\t\t\t\t\t\t\tPedido #{group.orderNumber}\r\n\t\t\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t\t\t<p className=\"text-sm text-gray-500\">\r\n\t\t\t\t\t\t\t\t\tFecha: {formatDate(group.orderDate)}\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\tto={`/orders/${group.orderId}`}\r\n\t\t\t\t\t\t\t\tclassName=\"text-primary-600 hover:text-primary-800 flex items-center mt-2 md:mt-0\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<Clock className=\"w-4 h-4 mr-1\" />\r\n\t\t\t\t\t\t\t\tVer detalles del pedido\r\n\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Lista de productos pendientes */}\r\n\t\t\t\t\t{group.products.length > 0 && (\r\n\t\t\t\t\t\t<div className=\"px-6 py-4\">\r\n\t\t\t\t\t\t\t<h4 className=\"text-md font-medium text-gray-900 mb-3 flex items-center\">\r\n\t\t\t\t\t\t\t\t<Package className=\"w-5 h-5 mr-2 text-primary-600\" />\r\n\t\t\t\t\t\t\t\tProductos\r\n\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t<div className=\"space-y-4\">\r\n\t\t\t\t\t\t\t\t{group.products.map((product) => (\r\n\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\tkey={`product-${product.id}-order-${group.orderId}`}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"flex flex-col sm:flex-row sm:items-center p-3 border border-gray-200 rounded-lg\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{/* Imagen y detalles del producto */}\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center flex-grow mb-3 sm:mb-0\">\r\n\t\t\t\t\t\t\t\t\t\t\t{product.image ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={product.image}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\talt={product.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-16 h-16 object-cover rounded-md mr-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonError={(e) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst target = e.target as HTMLImageElement;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttarget.onerror = null;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttarget.src =\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"https://via.placeholder.com/64?text=Producto\";\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-16 h-16 bg-gray-200 rounded-md flex items-center justify-center mr-4\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Package className=\"h-8 w-8 text-gray-400\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<h5 className=\"font-medium text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{product.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</h5>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tto={`/products/${product.id}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"text-sm text-primary-600 hover:text-primary-800\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tVer producto\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t{/* Botón de valorar */}\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => onRateProduct(product)}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full sm:w-auto px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 flex items-center justify-center\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Star className=\"h-4 w-4 mr-2\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\tValorar producto\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{/* Lista de vendedores pendientes */}\r\n\t\t\t\t\t{group.sellers.length > 0 && (\r\n\t\t\t\t\t\t<div className=\"px-6 py-4 border-t border-gray-200\">\r\n\t\t\t\t\t\t\t<h4 className=\"text-md font-medium text-gray-900 mb-3 flex items-center\">\r\n\t\t\t\t\t\t\t\t<Store className=\"w-5 h-5 mr-2 text-green-600\" />\r\n\t\t\t\t\t\t\t\tVendedores\r\n\t\t\t\t\t\t\t</h4>\r\n\t\t\t\t\t\t\t<div className=\"space-y-4\">\r\n\t\t\t\t\t\t\t\t{group.sellers.map((seller) => (\r\n\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\tkey={`seller-${seller.id || seller.seller_id}-order-${group.orderId}`}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"flex flex-col sm:flex-row sm:items-center p-3 border border-gray-200 rounded-lg\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{/* Imagen y detalles del vendedor */}\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center flex-grow mb-3 sm:mb-0\">\r\n\t\t\t\t\t\t\t\t\t\t\t{seller.image ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={seller.image}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\talt={seller.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-16 h-16 object-cover rounded-md mr-4\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonError={(e) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst target = e.target as HTMLImageElement;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttarget.onerror = null;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttarget.src =\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"https://via.placeholder.com/64?text=Tienda\";\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-16 h-16 bg-gray-200 rounded-md flex items-center justify-center mr-4\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Store className=\"h-8 w-8 text-gray-400\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<h5 className=\"font-medium text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{seller.name ||\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`Vendedor #${seller.seller_id || seller.id}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</h5>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm text-gray-500\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tTienda\r\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t{/* Botón de valorar */}\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => onRateSeller(seller)}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full sm:w-auto px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center justify-center\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Star className=\"h-4 w-4 mr-2\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\tValorar vendedor\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t))}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default PendingRatingsList;\r\n","// src/presentation/pages/account/PendingRatingsPage.tsx\r\nimport React, {useEffect, useState} from \"react\";\r\nimport {Link} from \"react-router-dom\";\r\nimport {ShoppingBag, Search} from \"lucide-react\";\r\n\r\nimport PendingRatingsAdapter from \"../../../core/adapters/PendingRatingsAdapter\";\r\nimport type {PendingRatingItem} from \"../../../core/services/RatingService\";\r\nimport type {OrderGroup} from \"../../../core/adapters/PendingRatingsAdapter\";\r\nimport RatingModal from \"../../components/rating/RatingModal\";\r\nimport {useRatings} from \"../../hooks/useRatings\";\r\nimport PendingRatingsList from \"../../components/rating/PendingRatingsList\";\r\nimport {extractErrorMessage} from \"../../../utils/errorHandler\";\r\n\r\nconst PendingRatingsPage: React.FC = () => {\r\n\t// Estados para filtros y búsqueda\r\n\tconst [searchTerm, setSearchTerm] = useState<string>(\"\");\r\n\tconst [showRated, setShowRated] = useState<boolean>(false);\r\n\r\n\t// Estados para el modal de valoración\r\n\tconst [isModalOpen, setIsModalOpen] = useState<boolean>(false);\r\n\tconst [modalType, setModalType] = useState<\"product\" | \"seller\">(\"product\");\r\n\tconst [selectedEntity, setSelectedEntity] =\r\n\t\tuseState<PendingRatingItem | null>(null);\r\n\r\n\t// Usar nuestro hook de valoraciones\r\n\tconst {\r\n\t\tloading,\r\n\t\terror,\r\n\t\tgetPendingRatings,\r\n\t\trateProduct,\r\n\t\trateSeller,\r\n\t\treportProblem,\r\n\t} = useRatings();\r\n\r\n\t// Estado para almacenar los grupos de órdenes\r\n\tconst [orderGroups, setOrderGroups] = useState<OrderGroup[]>([]);\r\n\r\n\t// Cargar datos al montar el componente\r\n\tuseEffect(() => {\r\n\t\tfetchPendingRatings();\r\n\t}, []);\r\n\r\n\t// Función para obtener valoraciones pendientes\r\n\tconst fetchPendingRatings = async () => {\r\n\t\ttry {\r\n\t\t\t// Usar el hook para obtener los datos\r\n\t\t\tconst response = await getPendingRatings();\r\n\r\n\t\t\tif (response.status !== \"success\") {\r\n\t\t\t\tthrow new Error(\"Error al obtener las valoraciones pendientes\");\r\n\t\t\t}\r\n\r\n\t\t\t// Usar el adaptador para transformar los datos al formato esperado\r\n\t\t\tconst groups = PendingRatingsAdapter.adaptPendingRatings(response);\r\n\t\t\tsetOrderGroups(groups);\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error(\"Error al cargar valoraciones pendientes:\", err);\r\n\t\t}\r\n\t};\r\n\r\n\t// Función para abrir el modal de valoración\r\n\tconst openRatingModal = (\r\n\t\ttype: \"product\" | \"seller\",\r\n\t\tentity: PendingRatingItem\r\n\t) => {\r\n\t\tsetModalType(type);\r\n\t\tsetSelectedEntity(entity);\r\n\t\tsetIsModalOpen(true);\r\n\t};\r\n\r\n\t// Función para cerrar el modal\r\n\tconst closeModal = () => {\r\n\t\tsetIsModalOpen(false);\r\n\t\tsetSelectedEntity(null);\r\n\t};\r\n\r\n\t// Función para enviar una valoración\r\n\tconst handleSubmitRating = async (data: {\r\n\t\trating: number;\r\n\t\ttitle?: string;\r\n\t\tcomment?: string;\r\n\t\tentityId: number;\r\n\t\torderId: number;\r\n\t}) => {\r\n\t\ttry {\r\n\t\t\tif (modalType === \"product\") {\r\n\t\t\t\tawait rateProduct({\r\n\t\t\t\t\tproduct_id: data.entityId,\r\n\t\t\t\t\torder_id: data.orderId,\r\n\t\t\t\t\trating: data.rating,\r\n\t\t\t\t\ttitle: data.title,\r\n\t\t\t\t\tcomment: data.comment,\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tawait rateSeller({\r\n\t\t\t\t\tseller_id: data.entityId,\r\n\t\t\t\t\torder_id: data.orderId,\r\n\t\t\t\t\trating: data.rating,\r\n\t\t\t\t\ttitle: data.title,\r\n\t\t\t\t\tcomment: data.comment,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// Actualizar datos\r\n\t\t\tawait fetchPendingRatings();\r\n\r\n\t\t\t// Mostrar mensaje de éxito\r\n\t\t\talert(\"Valoración enviada con éxito\");\r\n\r\n\t\t\t// Cerrar el modal\r\n\t\t\tcloseModal();\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al enviar valoración:\", error);\r\n\t\t\talert(extractErrorMessage(error, \"Error al enviar la valoración\"));\r\n\t\t}\r\n\t};\r\n\r\n\t// Función para reportar un problema\r\n\tconst handleReportProblem = async (data: {\r\n\t\ttype: \"product\" | \"seller\";\r\n\t\tentityId: number;\r\n\t\torderId: number;\r\n\t\tproblemType: string;\r\n\t\tdescription: string;\r\n\t}) => {\r\n\t\ttry {\r\n\t\t\tawait reportProblem({\r\n\t\t\t\ttype: data.type,\r\n\t\t\t\tentity_id: data.entityId,\r\n\t\t\t\torder_id: data.orderId,\r\n\t\t\t\tproblem_type: data.problemType,\r\n\t\t\t\tdescription: data.description,\r\n\t\t\t});\r\n\r\n\t\t\t// Actualizar datos\r\n\t\t\tawait fetchPendingRatings();\r\n\r\n\t\t\t// Mostrar mensaje de éxito\r\n\t\t\talert(\"Problema reportado con éxito\");\r\n\r\n\t\t\t// Cerrar el modal\r\n\t\t\tcloseModal();\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al reportar problema:\", error);\r\n\t\t\talert(extractErrorMessage(error, \"Error al reportar el problema\"));\r\n\t\t}\r\n\t};\r\n\r\n\t// Filtrar órdenes por término de búsqueda\r\n\tconst filteredGroups = orderGroups.filter((group) => {\r\n\t\tif (searchTerm === \"\") return true;\r\n\r\n\t\tconst searchLower = searchTerm.toLowerCase();\r\n\r\n\t\t// Buscar en número de orden\r\n\t\tif (group.orderNumber.toLowerCase().includes(searchLower)) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t// Buscar en productos\r\n\t\tif (\r\n\t\t\tgroup.products.some((product) =>\r\n\t\t\t\tproduct.name.toLowerCase().includes(searchLower)\r\n\t\t\t)\r\n\t\t) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t// Buscar en vendedores\r\n\t\tif (\r\n\t\t\tgroup.sellers.some((seller) =>\r\n\t\t\t\t(seller.name || \"\").toLowerCase().includes(searchLower)\r\n\t\t\t)\r\n\t\t) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\t});\r\n\r\n\t// Verificar si hay elementos pendientes\r\n\tconst hasPendingItems = orderGroups.some(\r\n\t\t(group) => group.products.length > 0 || group.sellers.length > 0\r\n\t);\r\n\r\n\treturn (\r\n\t\t<div className=\"container mx-auto p-4\">\r\n\t\t\t<h1 className=\"text-2xl font-bold text-gray-900\">\r\n\t\t\t\tValoraciones pendientes\r\n\t\t\t</h1>\r\n\r\n\t\t\t{/* Filtros y búsqueda */}\r\n\t\t\t<div className=\"flex flex-col md:flex-row gap-4 mb-6\">\r\n\t\t\t\t<div className=\"relative flex-grow\">\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tplaceholder=\"Buscar por pedido o producto...\"\r\n\t\t\t\t\t\tclassName=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500\"\r\n\t\t\t\t\t\tvalue={searchTerm}\r\n\t\t\t\t\t\tonChange={(e) => setSearchTerm(e.target.value)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Search className=\"absolute left-3 top-2.5 h-5 w-5 text-gray-400\" />\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t<label className=\"inline-flex items-center\">\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\tclassName=\"form-checkbox h-5 w-5 text-primary-600\"\r\n\t\t\t\t\t\t\tchecked={showRated}\r\n\t\t\t\t\t\t\tonChange={(e) => setShowRated(e.target.checked)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<span className=\"ml-2 text-gray-700\">\r\n\t\t\t\t\t\t\tMostrar también valorados\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</label>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Estado de carga */}\r\n\t\t\t{loading && (\r\n\t\t\t\t<div className=\"flex justify-center my-12\">\r\n\t\t\t\t\t<div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600\"></div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{/* Mensaje de error */}\r\n\t\t\t{error && (\r\n\t\t\t\t<div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-6\">\r\n\t\t\t\t\t<strong className=\"font-bold\">Error: </strong>\r\n\t\t\t\t\t<span className=\"block sm:inline\">{error}</span>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{/* Sin valoraciones pendientes */}\r\n\t\t\t{!loading && !error && !hasPendingItems && (\r\n\t\t\t\t<div className=\"bg-white rounded-lg shadow-sm p-8 text-center\">\r\n\t\t\t\t\t<ShoppingBag className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\r\n\t\t\t\t\t<h2 className=\"text-xl font-semibold text-gray-900 mb-2\">\r\n\t\t\t\t\t\tNo tienes valoraciones pendientes\r\n\t\t\t\t\t</h2>\r\n\t\t\t\t\t<p className=\"text-gray-600 max-w-md mx-auto\">\r\n\t\t\t\t\t\tTodas tus compras recientes han sido valoradas. ¡Gracias por\r\n\t\t\t\t\t\tcompartir tu opinión!\r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t<Link\r\n\t\t\t\t\t\tto=\"/orders\"\r\n\t\t\t\t\t\tclassName=\"mt-4 inline-block px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tVer mis pedidos\r\n\t\t\t\t\t</Link>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{/* Lista de órdenes con valoraciones pendientes */}\r\n\t\t\t{!loading && !error && filteredGroups.length > 0 && (\r\n\t\t\t\t<PendingRatingsList\r\n\t\t\t\t\torderGroups={filteredGroups}\r\n\t\t\t\t\tonRateProduct={(product) => openRatingModal(\"product\", product)}\r\n\t\t\t\t\tonRateSeller={(seller) => openRatingModal(\"seller\", seller)}\r\n\t\t\t\t/>\r\n\t\t\t)}\r\n\r\n\t\t\t{/* Modal de valoración */}\r\n\t\t\t{selectedEntity && (\r\n\t\t\t\t<RatingModal\r\n\t\t\t\t\ttype={modalType}\r\n\t\t\t\t\tentityId={(selectedEntity.id ?? selectedEntity.seller_id) ?? 0}\r\n\t\t\t\t\tentityName={\r\n\t\t\t\t\t\tselectedEntity.name ||\r\n\t\t\t\t\t\t`Vendedor #${selectedEntity.seller_id || selectedEntity.id}`\r\n\t\t\t\t\t}\r\n\t\t\t\t\tentityImage={selectedEntity.image}\r\n\t\t\t\t\torderId={selectedEntity.order_id}\r\n\t\t\t\t\tisOpen={isModalOpen}\r\n\t\t\t\t\tonClose={closeModal}\r\n\t\t\t\t\tonSubmit={handleSubmitRating}\r\n\t\t\t\t\tonReport={handleReportProblem}\r\n\t\t\t\t/>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default PendingRatingsPage;\r\n"],"names":["PendingRatingsAdapter","apiResponse","products","sellers","orderGroupsMap","product","orderId","seller","adaptedSeller","a","b","RatingModal","type","entityId","entityName","entityImage","isOpen","onClose","onSubmit","onReport","rating","setRating","useState","title","setTitle","comment","setComment","isSubmitting","setIsSubmitting","isReportMode","setIsReportMode","problemType","setProblemType","problemDescription","setProblemDescription","showConfirmation","setShowConfirmation","resetForm","handleClose","handleSubmit","error","handleReportSubmit","toggleReportMode","jsxs","jsx","X","Fragment","AlertTriangle","Package","Store","e","target","StarRating","value","useRatings","loading","setLoading","setError","ratingService","RatingService","getPendingRatings","useCallback","response","err","errorMessage","extractErrorMessage","rateProduct","data","rateSeller","reportProblem","replyToRating","ratingId","replyText","request","reportRating","reason","getProductRatings","productId","page","perPage","getSellerRatings","sellerId","getMyReceivedRatings","status","PendingRatingsList","orderGroups","onRateProduct","onRateSeller","group","formatDate","Link","Clock","Star","PendingRatingsPage","searchTerm","setSearchTerm","showRated","setShowRated","isModalOpen","setIsModalOpen","modalType","setModalType","selectedEntity","setSelectedEntity","setOrderGroups","useEffect","fetchPendingRatings","groups","openRatingModal","entity","closeModal","handleSubmitRating","handleReportProblem","filteredGroups","searchLower","hasPendingItems","Search","ShoppingBag"],"mappings":"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"}