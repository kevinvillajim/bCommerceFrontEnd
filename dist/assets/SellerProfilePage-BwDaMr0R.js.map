{"version":3,"file":"SellerProfilePage-BwDaMr0R.js","sources":["../../src/presentation/hooks/useSellerProfile.ts","../../src/presentation/components/seller/SellerFeedbackSection.tsx","../../src/presentation/pages/seller/SellerProfilePage.tsx"],"sourcesContent":["import { useState, useCallback, useMemo, useEffect } from \"react\";\r\nimport { useAuth } from \"../contexts/AuthContext\";\r\nimport ApiClient from \"../../infrastructure/api/apiClient\";\r\nimport { API_ENDPOINTS } from \"../../constants/apiEndpoints\";\r\nimport { usePasswordValidation } from \"./usePasswordValidation\";\r\n\r\ninterface SellerProfileData {\r\n\tname: string;\r\n\temail: string;\r\n\tphone?: string;\r\n\tlocation?: string;\r\n\tstoreName?: string;\r\n\tstoreDescription?: string;\r\n\tavatar?: string;\r\n}\r\n\r\ninterface PasswordChangeData {\r\n\tcurrentPassword: string;\r\n\tnewPassword: string;\r\n\tconfirmPassword: string;\r\n}\r\n\r\ninterface SellerInfo {\r\n\tseller: {\r\n\t\tid: number;\r\n\t\tstore_name: string;\r\n\t\tdescription: string;\r\n\t\tstatus: string;\r\n\t\tverification_level: string;\r\n\t\tavatar?: string;\r\n\t};\r\n\tdata?: any;\r\n}\r\n\r\nexport const useSellerProfile = () => {\r\n\tconst { user, updateUser } = useAuth();\r\n\tconst [loading, setLoading] = useState(false);\r\n\tconst [error, setError] = useState<string | null>(null);\r\n\tconst [success, setSuccess] = useState<string | null>(null);\r\n\tconst [sellerInfo, setSellerInfo] = useState<SellerInfo | null>(null);\r\n\t\r\n\t// Hook para validaci√≥n din√°mica de contrase√±as\r\n\tconst { validatePassword } = usePasswordValidation();\r\n\tconst [sellerInfoLoaded, setSellerInfoLoaded] = useState(false);\r\n\r\n\t// ‚úÖ NUEVO: Obtener informaci√≥n del seller al cargar el hook\r\n\tuseEffect(() => {\r\n\t\tconsole.log('üîÑ useEffect fetchSellerInfo - Conditions:', {\r\n\t\t\thasUser: !!user,\r\n\t\t\tsellerInfoLoaded,\r\n\t\t\tuserId: user?.id\r\n\t\t});\r\n\t\t\r\n\t\tif (user && !sellerInfoLoaded) {\r\n\t\t\tconsole.log('‚úÖ Conditions met, calling fetchSellerInfo...');\r\n\t\t\tfetchSellerInfo();\r\n\t\t}\r\n\t}, [user, sellerInfoLoaded]);\r\n\r\n\t// ‚úÖ NUEVO: Funci√≥n para obtener informaci√≥n del seller\r\n\tconst fetchSellerInfo = async () => {\r\n\t\ttry {\r\n\t\t\tconsole.log('üîç fetchSellerInfo started - calling API_ENDPOINTS.SELLER.INFO:', API_ENDPOINTS.SELLER.INFO);\r\n\t\t\t\r\n\t\t\tconst response = await ApiClient.get<SellerInfo>(API_ENDPOINTS.SELLER.INFO);\r\n\t\t\t\r\n\t\t\tconsole.log('üì• RAW API Response:', response);\r\n\t\t\tconsole.log('üì• Response type:', typeof response);\r\n\t\t\tconsole.log('üì• Response.data:', response?.data);\r\n\t\t\tconsole.log('üì• Response.seller:', response?.seller);\r\n\t\t\t\r\n\t\t\t// ‚úÖ DEBUGGING: Verificar diferentes estructuras de respuesta\r\n\t\t\tif (response) {\r\n\t\t\t\t// Caso 1: response.seller directamente\r\n\t\t\t\tif (response.seller) {\r\n\t\t\t\t\tconsole.log('‚úÖ Case 1: response.seller found:', response.seller);\r\n\t\t\t\t\tsetSellerInfo(response);\r\n\t\t\t\t}\r\n\t\t\t\t// Caso 2: response.data.seller\r\n\t\t\t\telse if (response.data && response.data.seller) {\r\n\t\t\t\t\tconsole.log('‚úÖ Case 2: response.data.seller found:', response.data.seller);\r\n\t\t\t\t\tsetSellerInfo(response.data);\r\n\t\t\t\t}\r\n\t\t\t\t// Caso 3: response.data directly (sin nested seller)\r\n\t\t\t\telse if (response.data) {\r\n\t\t\t\t\tconsole.log('‚úÖ Case 3: response.data found:', response.data);\r\n\t\t\t\t\t// Crear estructura compatible\r\n\t\t\t\t\tsetSellerInfo({\r\n\t\t\t\t\t\tseller: response.data\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t// Caso 4: response directamente es el seller data\r\n\t\t\t\t// ‚úÖ CORREGIDO: Cast de tipo para acceder a propiedades\r\n\t\t\t\telse if ((response as any).store_name) {\r\n\t\t\t\t\tconsole.log('‚úÖ Case 4: response is seller data directly:', response);\r\n\t\t\t\t\tconst responseData = response as any;\r\n\t\t\t\t\tsetSellerInfo({\r\n\t\t\t\t\t\tseller: {\r\n\t\t\t\t\t\t\tid: responseData.id || 0,\r\n\t\t\t\t\t\t\tstore_name: responseData.store_name || \"\",\r\n\t\t\t\t\t\t\tdescription: responseData.description || \"\",\r\n\t\t\t\t\t\t\tstatus: responseData.status || \"active\",\r\n\t\t\t\t\t\t\tverification_level: responseData.verification_level || \"none\"\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} as SellerInfo);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tconsole.log('‚ö†Ô∏è Unknown response structure:', response);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tconsole.log('‚ùå No response received');\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error('‚ùå Error obteniendo informaci√≥n del seller:', err);\r\n\t\t\t// ‚úÖ CORREGIDO: Manejo seguro de errores usando 'err' en lugar de 'error'\r\n\t\t\tconst errorObj = err as any;\r\n\t\t\tconsole.error('‚ùå Error details:', {\r\n\t\t\t\tmessage: errorObj?.message,\r\n\t\t\t\tstatus: errorObj?.response?.status,\r\n\t\t\t\tdata: errorObj?.response?.data\r\n\t\t\t});\r\n\t\t} finally {\r\n\t\t\tconsole.log('üèÅ fetchSellerInfo finished, setting sellerInfoLoaded = true');\r\n\t\t\tsetSellerInfoLoaded(true);\r\n\t\t}\r\n\t};\r\n\r\n\t// ‚úÖ CORREGIDO: Ahora usa tanto datos del user como del seller\r\n\tconst profileData = useMemo((): SellerProfileData => {\r\n\t\tconsole.log('üéØ profileData useMemo calculating with:', {\r\n\t\t\tuser: user ? {\r\n\t\t\t\tname: user.name,\r\n\t\t\t\temail: user.email,\r\n\t\t\t\tlocation: user.location,\r\n\t\t\t\tavatar: user.avatar\r\n\t\t\t} : 'NO USER',\r\n\t\t\tsellerInfo: sellerInfo ? {\r\n\t\t\t\tseller: sellerInfo.seller\r\n\t\t\t} : 'NO SELLER INFO',\r\n\t\t\tsellerInfoLoaded\r\n\t\t});\r\n\r\n\t\tconst data = {\r\n\t\t\tname: user?.name || \"\",\r\n\t\t\temail: user?.email || \"\",\r\n\t\t\tphone: user?.phone || \"\",\r\n\t\t\tlocation: user?.location || \"\",\r\n\t\t\tstoreName: sellerInfo?.seller?.store_name || \"\",           // ‚úÖ AHORA desde sellerInfo\r\n\t\t\tstoreDescription: sellerInfo?.seller?.description || \"\",   // ‚úÖ AHORA desde sellerInfo\r\n\t\t\tavatar: user?.avatar || \"\",\r\n\t\t};\r\n\t\t\r\n\t\tconsole.log('üîç ProfileData calculado con seller info:', data);\r\n\t\tconsole.log('üîç storeName source value:', sellerInfo?.seller?.store_name);\r\n\t\tconsole.log('üîç storeDescription source value:', sellerInfo?.seller?.description);\r\n\t\t\r\n\t\treturn data;\r\n\t}, [\r\n\t\tuser?.name, \r\n\t\tuser?.email, \r\n\t\tuser?.phone, \r\n\t\tuser?.location, \r\n\t\tuser?.avatar,\r\n\t\tsellerInfo?.seller?.store_name,    // ‚úÖ CORREGIDO: Ahora desde sellerInfo\r\n\t\tsellerInfo?.seller?.description,   // ‚úÖ CORREGIDO: Ahora desde sellerInfo\r\n\t]);\r\n\r\n\t// Actualizar perfil del usuario (tabla users)\r\n\tconst updateUserProfile = useCallback(async (userData: { name?: string; location?: string }) => {\r\n\t\tsetLoading(true);\r\n\t\tsetError(null);\r\n\t\tsetSuccess(null);\r\n\r\n\t\ttry {\r\n\t\t\tconsole.log('üì§ Actualizando datos de usuario:', userData);\r\n\t\t\t\r\n\t\t\t// Limpiar campos undefined\r\n\t\t\tconst cleanData = Object.fromEntries(\r\n\t\t\t\tObject.entries(userData).filter(([_, value]) => \r\n\t\t\t\t\tvalue !== undefined && value !== null && value !== \"\"\r\n\t\t\t\t)\r\n\t\t\t);\r\n\r\n\t\t\tif (Object.keys(cleanData).length === 0) {\r\n\t\t\t\tconsole.log('‚ö†Ô∏è No hay datos de usuario para actualizar');\r\n\t\t\t\treturn true; // No hay nada que actualizar, considerarlo √©xito\r\n\t\t\t}\r\n\r\n\t\t\tconst response = await ApiClient.put(API_ENDPOINTS.PROFILE.UPDATE, cleanData);\r\n\t\t\t\r\n\t\t\tconsole.log('üì• Respuesta actualizaci√≥n usuario:', response);\r\n\t\t\t\r\n\t\t\tif (response) {\r\n\t\t\t\t// ‚úÖ CORREGIDO: Verificar que updateUser existe antes de usarlo\r\n\t\t\t\tif (updateUser) {\r\n\t\t\t\t\tupdateUser(response);\r\n\t\t\t\t}\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthrow new Error(\"No se pudo actualizar el perfil del usuario\");\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error('‚ùå Error al actualizar perfil de usuario:', err);\r\n\t\t\tconst errorMessage = err instanceof Error ? err.message : \"Error al actualizar perfil\";\r\n\t\t\tsetError(errorMessage);\r\n\t\t\treturn false;\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t}, [updateUser]);\r\n\r\n\t// Actualizar informaci√≥n de la tienda (tabla sellers)\r\n\tconst updateStoreInfo = useCallback(async (storeData: { storeName?: string; storeDescription?: string }) => {\r\n\t\tsetLoading(true);\r\n\t\tsetError(null);\r\n\t\tsetSuccess(null);\r\n\r\n\t\ttry {\r\n\t\t\tconsole.log('üì§ Actualizando datos de tienda:', storeData);\r\n\r\n\t\t\tconst updateData = {\r\n\t\t\t\tstore_name: storeData.storeName,\r\n\t\t\t\tdescription: storeData.storeDescription,\r\n\t\t\t};\r\n\r\n\t\t\t// Limpiar campos undefined\r\n\t\t\tconst cleanData = Object.fromEntries(\r\n\t\t\t\tObject.entries(updateData).filter(([_, value]) => \r\n\t\t\t\t\tvalue !== undefined && value !== null && value !== \"\"\r\n\t\t\t\t)\r\n\t\t\t);\r\n\r\n\t\t\tif (Object.keys(cleanData).length === 0) {\r\n\t\t\t\tconsole.log('‚ö†Ô∏è No hay datos de tienda para actualizar');\r\n\t\t\t\treturn true; // No hay nada que actualizar, considerarlo √©xito\r\n\t\t\t}\r\n\r\n\t\t\tconsole.log('üì§ Enviando datos limpios de tienda:', cleanData);\r\n\r\n\t\t\tconst response = await ApiClient.put(API_ENDPOINTS.SELLER.UPDATE_STORE_INFO, cleanData);\r\n\t\t\t\r\n\t\t\tconsole.log('üì• Respuesta actualizaci√≥n tienda:', response);\r\n\t\t\t\r\n\t\t\t// ‚úÖ CORREGIDO: Cast de tipo para acceder a response.data\r\n\t\t\tconst responseData = response as any;\r\n\t\t\tif (responseData && responseData.data) {\r\n\t\t\t\t// ‚úÖ CORREGIDO: Actualizar la informaci√≥n del seller localmente con tipos seguros\r\n\t\t\t\tsetSellerInfo(prev => {\r\n\t\t\t\t\tif (!prev) return null;\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\t...prev,\r\n\t\t\t\t\t\tseller: {\r\n\t\t\t\t\t\t\t...prev.seller,\r\n\t\t\t\t\t\t\tid: prev.seller.id, // ‚úÖ CORREGIDO: Mantener id requerido\r\n\t\t\t\t\t\t\tstore_name: responseData.data.store_name || prev.seller.store_name || \"\",\r\n\t\t\t\t\t\t\tdescription: responseData.data.description || prev.seller.description || \"\",\r\n\t\t\t\t\t\t\tstatus: prev.seller.status,\r\n\t\t\t\t\t\t\tverification_level: prev.seller.verification_level,\r\n\t\t\t\t\t\t\tavatar: prev.seller.avatar,\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t});\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthrow new Error(\"No se pudo actualizar la informaci√≥n de la tienda\");\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error('‚ùå Error al actualizar informaci√≥n de tienda:', err);\r\n\t\t\tconst errorMessage = err instanceof Error ? err.message : \"Error al actualizar informaci√≥n de tienda\";\r\n\t\t\tsetError(errorMessage);\r\n\t\t\treturn false;\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t}, []);\r\n\r\n\t// ‚úÖ CORREGIDO: Funci√≥n combinada para actualizar ambos\r\n\tconst updateProfile = useCallback(async (profileDataUpdate: Partial<SellerProfileData>) => {\r\n\t\tconsole.log('üîÑ Iniciando actualizaci√≥n de perfil completo:', profileDataUpdate);\r\n\t\t\r\n\t\tsetLoading(true);\r\n\t\tsetError(null);\r\n\t\tsetSuccess(null);\r\n\t\t\r\n\t\tlet allSuccess = true;\r\n\t\tlet hasAnyChanges = false;\r\n\r\n\t\t// Separar datos de usuario y tienda\r\n\t\tconst userData = {\r\n\t\t\tname: profileDataUpdate.name,\r\n\t\t\tlocation: profileDataUpdate.location,\r\n\t\t};\r\n\r\n\t\tconst storeData = {\r\n\t\t\tstoreName: profileDataUpdate.storeName,\r\n\t\t\tstoreDescription: profileDataUpdate.storeDescription,\r\n\t\t};\r\n\r\n\t\t// Verificar si hay cambios en datos de usuario\r\n\t\tconst hasUserChanges = Object.values(userData).some(value => \r\n\t\t\tvalue !== undefined && value !== null && value !== \"\"\r\n\t\t);\r\n\t\t\r\n\t\t// Verificar si hay cambios en datos de tienda\r\n\t\tconst hasStoreChanges = Object.values(storeData).some(value => \r\n\t\t\tvalue !== undefined && value !== null && value !== \"\"\r\n\t\t);\r\n\r\n\t\t// Actualizar datos de usuario si hay cambios\r\n\t\tif (hasUserChanges) {\r\n\t\t\tconsole.log('üë§ Actualizando datos de usuario...');\r\n\t\t\thasAnyChanges = true;\r\n\t\t\tconst userSuccess = await updateUserProfile(userData);\r\n\t\t\tallSuccess = allSuccess && userSuccess;\r\n\t\t}\r\n\r\n\t\t// Actualizar datos de tienda si hay cambios\r\n\t\tif (hasStoreChanges) {\r\n\t\t\tconsole.log('üè™ Actualizando datos de tienda...');\r\n\t\t\thasAnyChanges = true;\r\n\t\t\tconst storeSuccess = await updateStoreInfo(storeData);\r\n\t\t\tallSuccess = allSuccess && storeSuccess;\r\n\t\t}\r\n\r\n\t\tif (!hasAnyChanges) {\r\n\t\t\tconsole.log('‚ö†Ô∏è No hay cambios para actualizar');\r\n\t\t\tsetError(\"No hay cambios para actualizar\");\r\n\t\t\tsetLoading(false);\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif (allSuccess) {\r\n\t\t\tconsole.log('‚úÖ Perfil actualizado exitosamente');\r\n\t\t\tsetSuccess(\"Perfil actualizado correctamente\");\r\n\t\t} else {\r\n\t\t\tconsole.log('‚ùå Error en la actualizaci√≥n del perfil');\r\n\t\t}\r\n\r\n\t\tsetLoading(false);\r\n\t\treturn allSuccess;\r\n\t}, [updateUserProfile, updateStoreInfo]);\r\n\r\n\t// Subir avatar\r\n\tconst uploadAvatar = useCallback(async (file: File) => {\r\n\t\tsetLoading(true);\r\n\t\tsetError(null);\r\n\t\tsetSuccess(null);\r\n\r\n\t\ttry {\r\n\t\t\tconsole.log('üì§ Subiendo avatar:', file.name, 'Tama√±o:', file.size, 'Tipo:', file.type);\r\n\r\n\t\t\tconst formData = new FormData();\r\n\t\t\tformData.append('avatar', file);\r\n\r\n\t\t\tconsole.log('üì§ Enviando a:', API_ENDPOINTS.PROFILE.UPLOAD_AVATAR);\r\n\r\n\t\t\tconst response = await ApiClient.uploadFile(API_ENDPOINTS.PROFILE.UPLOAD_AVATAR, formData);\r\n\r\n\t\t\tconsole.log('üì• Respuesta del avatar:', response);\r\n\r\n\t\t\tif (response) {\r\n\t\t\t\t// ‚úÖ CORREGIDO: Verificar que updateUser existe antes de usarlo\r\n\t\t\t\tif (updateUser) {\r\n\t\t\t\t\tupdateUser(response);\r\n\t\t\t\t}\r\n\t\t\t\tsetSuccess(\"Avatar actualizado correctamente\");\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\tthrow new Error(\"No se pudo subir el avatar\");\r\n\t\t} catch (err: any) {\r\n\t\t\tconsole.error('‚ùå Error completo al subir avatar:', err);\r\n\t\t\t\r\n\t\t\t// Manejo espec√≠fico de errores de validaci√≥n\r\n\t\t\tif (err.response?.status === 422) {\r\n\t\t\t\tconst errors = err.response?.data?.errors;\r\n\t\t\t\tif (errors?.avatar) {\r\n\t\t\t\t\tsetError(`Error de validaci√≥n: ${errors.avatar[0]}`);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetError('Error de validaci√≥n en el archivo de imagen');\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tconst errorMessage = err instanceof Error ? err.message : \"Error al subir avatar\";\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t}, [updateUser]);\r\n\r\n\t// Cambiar contrase√±a\r\n\tconst changePassword = useCallback(async (passwordData: PasswordChangeData) => {\r\n\t\tsetLoading(true);\r\n\t\tsetError(null);\r\n\t\tsetSuccess(null);\r\n\r\n\t\ttry {\r\n\t\t\t// Validar que las contrase√±as coincidan\r\n\t\t\tif (passwordData.newPassword !== passwordData.confirmPassword) {\r\n\t\t\t\tthrow new Error(\"Las contrase√±as no coinciden\");\r\n\t\t\t}\r\n\r\n\t\t\t// Usar validaci√≥n din√°mica basada en configuraci√≥n del admin\r\n\t\t\tconst passwordValidation = validatePassword(passwordData.newPassword);\r\n\t\t\tif (!passwordValidation.isValid) {\r\n\t\t\t\tthrow new Error(passwordValidation.errors[0]); // Mostrar el primer error\r\n\t\t\t}\r\n\r\n\t\t\tconsole.log('üì§ Cambiando contrase√±a...');\r\n\r\n\t\t\tconst response = await ApiClient.put(API_ENDPOINTS.PROFILE.CHANGE_PASSWORD, {\r\n\t\t\t\tcurrent_password: passwordData.currentPassword,\r\n\t\t\t\tpassword: passwordData.newPassword,\r\n\t\t\t\tpassword_confirmation: passwordData.confirmPassword,\r\n\t\t\t});\r\n\r\n\t\t\tconsole.log('üì• Respuesta del cambio de contrase√±a:', response);\r\n\r\n\t\t\tif (response) {\r\n\t\t\t\tsetSuccess(\"Contrase√±a actualizada correctamente\");\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\tthrow new Error(\"No se pudo actualizar la contrase√±a\");\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error('‚ùå Error al cambiar contrase√±a:', err);\r\n\t\t\tconst errorMessage = err instanceof Error ? err.message : \"Error al cambiar contrase√±a\";\r\n\t\t\tsetError(errorMessage);\r\n\t\t\treturn false;\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t}, []);\r\n\r\n\t// Limpiar mensajes\r\n\tconst clearMessages = useCallback(() => {\r\n\t\tsetError(null);\r\n\t\tsetSuccess(null);\r\n\t}, []);\r\n\r\n\treturn {\r\n\t\tprofileData,\r\n\t\tloading: loading || !sellerInfoLoaded, // ‚úÖ NUEVO: Tambi√©n considerar si est√° cargando seller info\r\n\t\terror,\r\n\t\tsuccess,\r\n\t\tupdateProfile,\r\n\t\tupdateUserProfile,\r\n\t\tupdateStoreInfo, \r\n\t\tuploadAvatar,\r\n\t\tchangePassword,\r\n\t\tclearMessages,\r\n\t\tsellerInfo, \r\n\t\trefetchSellerInfo: fetchSellerInfo, \r\n\t};\r\n};","import React, { useState, useEffect } from 'react';\r\nimport { Send, MessageSquare, Clock, CheckCircle, XCircle, Star, AlertCircle, Gift, Sparkles, Crown } from 'lucide-react';\r\nimport ApiClient from '../../../infrastructure/api/apiClient';\r\nimport { API_ENDPOINTS } from '../../../constants/apiEndpoints';\r\n\r\ninterface Feedback {\r\n  id: number;\r\n  title: string;\r\n  description: string;\r\n  type: 'bug' | 'improvement' | 'other';\r\n  status: 'pending' | 'approved' | 'rejected';\r\n  admin_notes?: string;\r\n  created_at: string;\r\n  seller_featured?: {\r\n    featured_at: string;\r\n    featured_expires_at: string;\r\n    featured_days: number;\r\n    is_active: boolean;\r\n  };\r\n}\r\n\r\nconst SellerFeedbackSection: React.FC = () => {\r\n  const [feedbacks, setFeedbacks] = useState<Feedback[]>([]);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [showForm, setShowForm] = useState(false);\r\n  \r\n  // Form state\r\n  const [formData, setFormData] = useState({\r\n    title: '',\r\n    description: '',\r\n    type: 'improvement' as Feedback['type']\r\n  });\r\n\r\n  // Validation errors state\r\n  const [validationErrors, setValidationErrors] = useState<{[key: string]: string[]}>({});\r\n\r\n  useEffect(() => {\r\n    fetchFeedbacks();\r\n  }, []);\r\n\r\n  // ‚úÖ NUEVO: Actualizar countdown cada minuto para featured status activos\r\n  useEffect(() => {\r\n    const hasActiveFeatured = feedbacks.some(feedback => \r\n      feedback.seller_featured?.is_active && \r\n      !calculateTimeRemaining(feedback.seller_featured.featured_expires_at).expired\r\n    );\r\n\r\n    if (hasActiveFeatured) {\r\n      const interval = setInterval(() => {\r\n        // Forzar re-render cada minuto para actualizar countdown\r\n        setFeedbacks(prevFeedbacks => [...prevFeedbacks]);\r\n      }, 60000); // 60 segundos\r\n\r\n      return () => clearInterval(interval);\r\n    }\r\n  }, [feedbacks]);\r\n\r\n  const fetchFeedbacks = async () => {\r\n    try {\r\n      setIsLoading(true);\r\n      const response = await ApiClient.get(`${API_ENDPOINTS.FEEDBACK.LIST}?limit=20`) as { data: Feedback[] };\r\n      setFeedbacks(response.data || []);\r\n    } catch (error) {\r\n      console.error('Error fetching feedbacks:', error);\r\n    } finally {\r\n      setIsLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    \r\n    // Clear previous validation errors\r\n    setValidationErrors({});\r\n    \r\n    // Basic client-side validation\r\n    if (!formData.title.trim()) {\r\n      setValidationErrors({ title: ['El t√≠tulo es obligatorio'] });\r\n      return;\r\n    }\r\n    \r\n    if (formData.title.length < 5) {\r\n      setValidationErrors({ title: ['El t√≠tulo debe tener al menos 5 caracteres'] });\r\n      return;\r\n    }\r\n    \r\n    if (!formData.description.trim()) {\r\n      setValidationErrors({ description: ['La descripci√≥n es obligatoria'] });\r\n      return;\r\n    }\r\n    \r\n    if (formData.description.length < 20) {\r\n      setValidationErrors({ description: ['La descripci√≥n debe tener al menos 20 caracteres'] });\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setIsSubmitting(true);\r\n      await ApiClient.post(API_ENDPOINTS.FEEDBACK.CREATE, formData);\r\n      \r\n      // Reset form and refresh list\r\n      setFormData({ title: '', description: '', type: 'improvement' });\r\n      setValidationErrors({});\r\n      setShowForm(false);\r\n      await fetchFeedbacks();\r\n    } catch (error: any) {\r\n      console.error('Error submitting feedback:', error);\r\n      \r\n      // Handle validation errors from backend\r\n      if (error.response?.status === 422) {\r\n        // Laravel validation errors - try multiple possible locations\r\n        const errorData = error.response.data;\r\n        let validationErrors = {};\r\n        \r\n        if (errorData?.errors) {\r\n          validationErrors = errorData.errors;\r\n        } else if (errorData?.data) {\r\n          validationErrors = errorData.data;\r\n        } else if (errorData && typeof errorData === 'object' && !errorData.message) {\r\n          // If errorData is directly the errors object (like {description: [...], type: [...]})\r\n          validationErrors = errorData;\r\n        }\r\n        \r\n        console.log('Validation errors received:', validationErrors);\r\n        setValidationErrors(validationErrors);\r\n      } else {\r\n        // Handle other types of errors\r\n        const errorMessage = error.response?.data?.message || error.message || 'Error al enviar feedback';\r\n        setValidationErrors({ general: [errorMessage] });\r\n      }\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const getStatusIcon = (status: Feedback['status']) => {\r\n    switch (status) {\r\n      case 'pending':\r\n        return <Clock className=\"w-4 h-4 text-yellow-500\" />;\r\n      case 'approved':\r\n        return <CheckCircle className=\"w-4 h-4 text-green-500\" />;\r\n      case 'rejected':\r\n        return <XCircle className=\"w-4 h-4 text-red-500\" />;\r\n    }\r\n  };\r\n\r\n  const getStatusText = (status: Feedback['status']) => {\r\n    switch (status) {\r\n      case 'pending':\r\n        return 'Pendiente';\r\n      case 'approved':\r\n        return 'Aprobado';\r\n      case 'rejected':\r\n        return 'Rechazado';\r\n    }\r\n  };\r\n\r\n  const getTypeText = (type: Feedback['type']) => {\r\n    switch (type) {\r\n      case 'bug':\r\n        return 'Error/Bug';\r\n      case 'improvement':\r\n        return 'Mejora';\r\n      case 'other':\r\n        return 'Otro';\r\n    }\r\n  };\r\n\r\n  const formatDate = (dateString: string) => {\r\n    return new Date(dateString).toLocaleDateString('es-ES', {\r\n      year: 'numeric',\r\n      month: 'short',\r\n      day: 'numeric'\r\n    });\r\n  };\r\n\r\n  // ‚úÖ NUEVA: Funci√≥n para calcular tiempo restante de featured status\r\n  const calculateTimeRemaining = (expiresAt: string) => {\r\n    const now = new Date();\r\n    const expiry = new Date(expiresAt);\r\n    const diffMs = expiry.getTime() - now.getTime();\r\n    \r\n    if (diffMs <= 0) {\r\n      return { expired: true, days: 0, hours: 0, minutes: 0 };\r\n    }\r\n    \r\n    const days = Math.floor(diffMs / (1000 * 60 * 60 * 24));\r\n    const hours = Math.floor((diffMs % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\r\n    const minutes = Math.floor((diffMs % (1000 * 60 * 60)) / (1000 * 60));\r\n    \r\n    return { expired: false, days, hours, minutes };\r\n  };\r\n\r\n  if (isLoading) {\r\n    return (\r\n      <div className=\"bg-white rounded-lg shadow-sm p-6\">\r\n        <div className=\"flex justify-center items-center h-32\">\r\n          <div className=\"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary-600\"></div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-lg shadow-sm p-6 space-y-6\">\r\n      <div className=\"flex items-center justify-between\">\r\n        <div className=\"flex items-center\">\r\n          <MessageSquare size={20} className=\"mr-3 text-blue-600\" />\r\n          <div>\r\n            <h3 className=\"text-lg font-medium text-gray-900\">Feedback y Sugerencias</h3>\r\n            <p className=\"text-sm text-gray-600\">\r\n              Comparte tus ideas para mejorar la plataforma y obt√©n tienda destacada por 15 d√≠as\r\n            </p>\r\n          </div>\r\n        </div>\r\n        <button\r\n          onClick={() => setShowForm(!showForm)}\r\n          className=\"bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 transition-colors flex items-center gap-2 text-sm\"\r\n        >\r\n          <MessageSquare className=\"w-4 h-4\" />\r\n          Nuevo Feedback\r\n        </button>\r\n      </div>\r\n\r\n      {/* Formulario para nuevo feedback */}\r\n      {showForm && (\r\n        <div className=\"bg-gray-50 rounded-lg p-4 space-y-4\">\r\n          <h4 className=\"font-medium text-gray-900\">Enviar Nuevo Feedback</h4>\r\n          \r\n          {/* Errores generales */}\r\n          {validationErrors.general && (\r\n            <div className=\"bg-red-50 border border-red-200 rounded-lg p-3\">\r\n              <div className=\"flex items-center gap-2\">\r\n                <AlertCircle className=\"w-4 h-4 text-red-600\" />\r\n                <div>\r\n                  {validationErrors.general.map((error, index) => (\r\n                    <p key={index} className=\"text-red-700 text-sm\">{error}</p>\r\n                  ))}\r\n                </div>\r\n              </div>\r\n            </div>\r\n          )}\r\n          \r\n          <form onSubmit={handleSubmit} className=\"space-y-4\">\r\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                  Tipo de Feedback\r\n                </label>\r\n                <select\r\n                  value={formData.type}\r\n                  onChange={(e) => setFormData({ ...formData, type: e.target.value as Feedback['type'] })}\r\n                  className={`w-full p-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-sm ${\r\n                    validationErrors.type ? 'border-red-300 bg-red-50' : 'border-gray-300'\r\n                  }`}\r\n                >\r\n                  <option value=\"improvement\">Mejora</option>\r\n                  <option value=\"bug\">Error/Bug</option>\r\n                  <option value=\"other\">Otro</option>\r\n                </select>\r\n                {validationErrors.type && (\r\n                  <div className=\"mt-1\">\r\n                    {validationErrors.type.map((error, index) => (\r\n                      <p key={index} className=\"text-red-600 text-xs\">{error}</p>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </div>\r\n\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                  T√≠tulo <span className=\"text-gray-500\">(min. 5 chars)</span>\r\n                </label>\r\n                <input\r\n                  type=\"text\"\r\n                  value={formData.title}\r\n                  onChange={(e) => setFormData({ ...formData, title: e.target.value })}\r\n                  placeholder=\"Describe brevemente tu feedback\"\r\n                  className={`w-full p-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-sm ${\r\n                    validationErrors.title ? 'border-red-300 bg-red-50' : 'border-gray-300'\r\n                  }`}\r\n                  required\r\n                />\r\n                <div className=\"mt-1 text-xs text-gray-500\">\r\n                  {formData.title.length}/100 caracteres\r\n                </div>\r\n                {validationErrors.title && (\r\n                  <div className=\"mt-1\">\r\n                    {validationErrors.title.map((error, index) => (\r\n                      <p key={index} className=\"text-red-600 text-xs\">{error}</p>\r\n                    ))}\r\n                  </div>\r\n                )}\r\n              </div>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                Descripci√≥n <span className=\"text-gray-500\">(min. 20 chars)</span>\r\n              </label>\r\n              <textarea\r\n                value={formData.description}\r\n                onChange={(e) => setFormData({ ...formData, description: e.target.value })}\r\n                placeholder=\"Describe detalladamente tu feedback, sugerencia o el error encontrado\"\r\n                rows={3}\r\n                className={`w-full p-2 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent text-sm ${\r\n                  validationErrors.description ? 'border-red-300 bg-red-50' : 'border-gray-300'\r\n                }`}\r\n                required\r\n              />\r\n              <div className=\"mt-1 text-xs text-gray-500\">\r\n                {formData.description.length}/1000 caracteres\r\n              </div>\r\n              {validationErrors.description && (\r\n                <div className=\"mt-1\">\r\n                  {validationErrors.description.map((error, index) => (\r\n                    <p key={index} className=\"text-red-600 text-xs\">{error}</p>\r\n                  ))}\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            <div className=\"flex gap-2\">\r\n              <button\r\n                type=\"submit\"\r\n                disabled={isSubmitting}\r\n                className=\"bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 transition-colors flex items-center gap-2 disabled:opacity-50 text-sm\"\r\n              >\r\n                <Send className=\"w-4 h-4\" />\r\n                {isSubmitting ? 'Enviando...' : 'Enviar Feedback'}\r\n              </button>\r\n              <button\r\n                type=\"button\"\r\n                onClick={() => setShowForm(false)}\r\n                className=\"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-400 transition-colors text-sm\"\r\n              >\r\n                Cancelar\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      )}\r\n\r\n      {/* Lista de feedback */}\r\n      <div>\r\n        <h4 className=\"font-medium text-gray-900 mb-3\">Mi Historial de Feedback</h4>\r\n        {feedbacks.length === 0 ? (\r\n          <div className=\"text-center py-8\">\r\n            <MessageSquare className=\"w-12 h-12 text-gray-300 mx-auto mb-3\" />\r\n            <h3 className=\"text-sm font-medium text-gray-900 mb-1\">No has enviado feedback a√∫n</h3>\r\n            <p className=\"text-sm text-gray-500\">\r\n              ¬°Comparte tus ideas para mejorar la plataforma!\r\n            </p>\r\n          </div>\r\n        ) : (\r\n          <div className=\"space-y-4 max-h-96 overflow-y-auto\">\r\n            {feedbacks.map((feedback) => (\r\n              <div\r\n                key={feedback.id}\r\n                className=\"border border-gray-200 rounded-lg p-4 hover:shadow-sm transition-shadow\"\r\n              >\r\n                <div className=\"flex items-start justify-between mb-2\">\r\n                  <div className=\"flex-1\">\r\n                    <h5 className=\"font-medium text-gray-900 text-sm\">{feedback.title}</h5>\r\n                    <div className=\"flex items-center gap-2 mt-1\">\r\n                      <span className=\"text-xs text-gray-500\">{getTypeText(feedback.type)}</span>\r\n                      <span className=\"text-gray-300\">‚Ä¢</span>\r\n                      <span className=\"text-xs text-gray-500\">{formatDate(feedback.created_at)}</span>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"flex items-center gap-1\">\r\n                    {getStatusIcon(feedback.status)}\r\n                    <span className={`text-xs font-medium ${\r\n                      feedback.status === 'approved' ? 'text-green-600' :\r\n                      feedback.status === 'rejected' ? 'text-red-600' :\r\n                      'text-yellow-600'\r\n                    }`}>\r\n                      {getStatusText(feedback.status)}\r\n                    </span>\r\n                  </div>\r\n                </div>\r\n\r\n                <p className=\"text-sm text-gray-700 mb-3\">{feedback.description}</p>\r\n\r\n                {feedback.admin_notes && (\r\n                  <div className=\"bg-blue-50 rounded-lg p-3 mb-3\">\r\n                    <h6 className=\"font-medium text-blue-900 text-sm mb-1\">Respuesta del equipo:</h6>\r\n                    <p className=\"text-blue-800 text-sm\">{feedback.admin_notes}</p>\r\n                  </div>\r\n                )}\r\n\r\n                {feedback.seller_featured && (() => {\r\n                  const timeRemaining = calculateTimeRemaining(feedback.seller_featured.featured_expires_at);\r\n                  const isActive = feedback.seller_featured.is_active && !timeRemaining.expired;\r\n                  \r\n                  return (\r\n                    <div className={`rounded-lg p-4 border-2 ${\r\n                      isActive \r\n                        ? 'bg-gradient-to-br from-blue-50 to-purple-50 border-blue-200 shadow-sm' \r\n                        : 'bg-gray-50 border-gray-200'\r\n                    }`}>\r\n                      <div className=\"flex items-center gap-3 mb-3\">\r\n                        {isActive ? (\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <div className=\"relative\">\r\n                              <Crown className=\"w-6 h-6 text-blue-600\" />\r\n                              <Sparkles className=\"w-3 h-3 text-purple-500 absolute -top-1 -right-1 animate-pulse\" />\r\n                            </div>\r\n                            <div>\r\n                              <h6 className=\"font-bold text-blue-900 text-sm flex items-center gap-1\">\r\n                                ¬°Gracias por ayudarnos a mejorar! \r\n                                <Gift className=\"w-4 h-4 text-purple-600\" />\r\n                              </h6>\r\n                              <p className=\"text-blue-700 text-xs font-medium\">\r\n                                Has obtenido visibilidad premium gratuita\r\n                              </p>\r\n                            </div>\r\n                          </div>\r\n                        ) : (\r\n                          <div className=\"flex items-center gap-2\">\r\n                            <Star className=\"w-5 h-5 text-gray-500\" />\r\n                            <h6 className=\"font-medium text-gray-700 text-sm\">\r\n                              Recompensa de visibilidad otorgada\r\n                            </h6>\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n\r\n                      {isActive ? (\r\n                        <div className=\"space-y-3\">\r\n                          {/* Contador de tiempo restante */}\r\n                          <div className=\"bg-white/60 backdrop-blur-sm rounded-lg p-3 border border-blue-100\">\r\n                            <p className=\"text-blue-800 text-xs font-medium mb-2 text-center\">\r\n                              ‚è∞ Tiempo restante de tu regalo\r\n                            </p>\r\n                            <div className=\"grid grid-cols-3 gap-3 text-center\">\r\n                              <div className=\"bg-blue-100 rounded-lg py-2 px-1\">\r\n                                <div className=\"text-lg font-bold text-blue-900\">{timeRemaining.days}</div>\r\n                                <div className=\"text-xs text-blue-700 font-medium\">\r\n                                  {timeRemaining.days === 1 ? 'd√≠a' : 'd√≠as'}\r\n                                </div>\r\n                              </div>\r\n                              <div className=\"bg-purple-100 rounded-lg py-2 px-1\">\r\n                                <div className=\"text-lg font-bold text-purple-900\">{timeRemaining.hours}</div>\r\n                                <div className=\"text-xs text-purple-700 font-medium\">\r\n                                  {timeRemaining.hours === 1 ? 'hora' : 'horas'}\r\n                                </div>\r\n                              </div>\r\n                              <div className=\"bg-indigo-100 rounded-lg py-2 px-1\">\r\n                                <div className=\"text-lg font-bold text-indigo-900\">{timeRemaining.minutes}</div>\r\n                                <div className=\"text-xs text-indigo-700 font-medium\">\r\n                                  {timeRemaining.minutes === 1 ? 'minuto' : 'minutos'}\r\n                                </div>\r\n                              </div>\r\n                            </div>\r\n                          </div>\r\n                          \r\n                          {/* Mensaje motivacional */}\r\n                          <div className=\"text-center\">\r\n                            <p className=\"text-blue-800 text-sm font-medium\">\r\n                              üåü ¬°Esperamos que disfrutes tu regalo! üåü\r\n                            </p>\r\n                            <p className=\"text-blue-600 text-xs mt-1\">\r\n                              Tu tienda aparece destacada en las b√∫squedas\r\n                            </p>\r\n                          </div>\r\n                        </div>\r\n                      ) : (\r\n                        <div className=\"grid grid-cols-2 gap-3 text-xs\">\r\n                          <div>\r\n                            <span className=\"text-gray-600 font-medium\">Duraci√≥n otorgada:</span>\r\n                            <p className=\"font-bold text-gray-800\">{feedback.seller_featured.featured_days} d√≠as</p>\r\n                          </div>\r\n                          <div>\r\n                            <span className=\"text-gray-600 font-medium\">Expir√≥ el:</span>\r\n                            <p className=\"text-gray-700\">{formatDate(feedback.seller_featured.featured_expires_at)}</p>\r\n                          </div>\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n                  );\r\n                })()}\r\n              </div>\r\n            ))}\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SellerFeedbackSection;","import React, { useState, useRef, useEffect } from \"react\";\r\nimport {\r\n\tUser,\r\n\tStore,\r\n\tLock,\r\n\tMail,\r\n\tMapPin,\r\n\tChevronRight,\r\n\tSave,\r\n\tAlertCircle,\r\n\tCheckCircle,\r\n\tEye,\r\n\tEyeOff,\r\n\tCamera,\r\n} from \"lucide-react\";\r\nimport { useSellerProfile } from \"../../hooks/useSellerProfile\";\r\nimport SellerFeedbackSection from \"../../components/seller/SellerFeedbackSection\";\r\n\r\nconst SellerProfilePage: React.FC = () => {\r\n\tconst {\r\n\t\tprofileData,\r\n\t\tloading,\r\n\t\terror,\r\n\t\tsuccess,\r\n\t\tupdateProfile,\r\n\t\tuploadAvatar,\r\n\t\tchangePassword,\r\n\t\tclearMessages,\r\n\t} = useSellerProfile();\r\n\r\n\t// Estados para los formularios\r\n\tconst [personalData, setPersonalData] = useState({\r\n\t\tname: \"\",\r\n\t\tlocation: \"\",\r\n\t});\r\n\r\n\tconst [storeData, setStoreData] = useState({\r\n\t\tstoreName: \"\",\r\n\t\tstoreDescription: \"\",\r\n\t});\r\n\r\n\tconst [passwordData, setPasswordData] = useState({\r\n\t\tcurrentPassword: \"\",\r\n\t\tnewPassword: \"\",\r\n\t\tconfirmPassword: \"\",\r\n\t});\r\n\r\n\tconst [showPasswords, setShowPasswords] = useState({\r\n\t\tcurrent: false,\r\n\t\tnew: false,\r\n\t\tconfirm: false,\r\n\t});\r\n\r\n\tconst [hasChanges, setHasChanges] = useState(false);\r\n\tconst [avatarFile, setAvatarFile] = useState<File | null>(null);\r\n\tconst [avatarPreview, setAvatarPreview] = useState<string | null>(null);\r\n\tconst [isInitialized, setIsInitialized] = useState(false);\r\n\tconst [imageLoadError, setImageLoadError] = useState(false);\r\n\t\r\n\tconst fileInputRef = useRef<HTMLInputElement>(null);\r\n\r\n\t// ‚úÖ ARREGLADO: Usar useEffect espec√≠fico para inicializaci√≥n una sola vez\r\n\tuseEffect(() => {\r\n\t\tif (profileData.name && !isInitialized) {\r\n\t\t\tconsole.log('üîÑ Inicializando datos del perfil por primera vez:', profileData);\r\n\t\t\t\r\n\t\t\tsetPersonalData({\r\n\t\t\t\tname: profileData.name || \"\",\r\n\t\t\t\tlocation: profileData.location || \"\",\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tsetStoreData({\r\n\t\t\t\tstoreName: profileData.storeName || \"\",\r\n\t\t\t\tstoreDescription: profileData.storeDescription || \"\",\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tsetIsInitialized(true);\r\n\t\t}\r\n\t}, [profileData.name, profileData.location, profileData.storeName, profileData.storeDescription, isInitialized]);\r\n\r\n\t// ‚úÖ ARREGLADO: Usar useEffect separado para actualizar datos despu√©s de guardado exitoso\r\n\tuseEffect(() => {\r\n\t\tif (success && isInitialized) {\r\n\t\t\tconsole.log('‚úÖ Datos guardados exitosamente, actualizando formulario');\r\n\t\t\t\r\n\t\t\tsetPersonalData({\r\n\t\t\t\tname: profileData.name || \"\",\r\n\t\t\t\tlocation: profileData.location || \"\",\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tsetStoreData({\r\n\t\t\t\tstoreName: profileData.storeName || \"\",\r\n\t\t\t\tstoreDescription: profileData.storeDescription || \"\",\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tsetHasChanges(false);\r\n\t\t}\r\n\t}, [success, profileData.name, profileData.location, profileData.storeName, profileData.storeDescription, isInitialized]);\r\n\r\n\t// Limpiar mensajes despu√©s de unos segundos\r\n\tuseEffect(() => {\r\n\t\tif (error || success) {\r\n\t\t\tconst timer = setTimeout(() => {\r\n\t\t\t\tclearMessages();\r\n\t\t\t}, 5000);\r\n\t\t\treturn () => clearTimeout(timer);\r\n\t\t}\r\n\t}, [error, success, clearMessages]);\r\n\r\n\t// ‚úÖ Debug: mostrar datos en consola (solo cuando cambian realmente)\r\n\tuseEffect(() => {\r\n\t\tif (isInitialized) {\r\n\t\t\tconsole.log('üéØ Estados actualizados:', {\r\n\t\t\t\tpersonalData,\r\n\t\t\t\tstoreData,\r\n\t\t\t\thasChanges\r\n\t\t\t});\r\n\t\t}\r\n\t}, [personalData.name, personalData.location, storeData.storeName, storeData.storeDescription, hasChanges, isInitialized]);\r\n\r\n\tconst handlePersonalDataChange = (field: string, value: string) => {\r\n\t\tconsole.log(`üìù Cambiando ${field}:`, value);\r\n\t\tsetPersonalData(prev => ({ ...prev, [field]: value }));\r\n\t\tsetHasChanges(true);\r\n\t};\r\n\r\n\tconst handleStoreDataChange = (field: string, value: string) => {\r\n\t\tconsole.log(`üè™ Cambiando ${field}:`, value);\r\n\t\tsetStoreData(prev => ({ ...prev, [field]: value }));\r\n\t\tsetHasChanges(true);\r\n\t};\r\n\r\n\tconst handlePasswordChange = (field: string, value: string) => {\r\n\t\tsetPasswordData(prev => ({ ...prev, [field]: value }));\r\n\t};\r\n\r\n\tconst handleAvatarChange = (event: React.ChangeEvent<HTMLInputElement>) => {\r\n\t\tconst file = event.target.files?.[0];\r\n\t\tif (file) {\r\n\t\t\t// Validar tipo de archivo\r\n\t\t\tif (!file.type.startsWith('image/')) {\r\n\t\t\t\talert('Por favor selecciona una imagen v√°lida.');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t// Validar tama√±o (m√°ximo 2MB)\r\n\t\t\tif (file.size > 2 * 1024 * 1024) {\r\n\t\t\t\talert('La imagen debe ser menor a 2MB.');\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconsole.log('üì∑ Avatar seleccionado:', file.name, file.size);\r\n\t\t\tsetAvatarFile(file);\r\n\t\t\tsetHasChanges(true);\r\n\t\t\tsetImageLoadError(false); // Resetear error de imagen\r\n\r\n\t\t\t// Mostrar preview\r\n\t\t\tconst reader = new FileReader();\r\n\t\t\treader.onload = (e) => {\r\n\t\t\t\tsetAvatarPreview(e.target?.result as string);\r\n\t\t\t};\r\n\t\t\treader.readAsDataURL(file);\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleSaveProfile = async () => {\r\n\t\tconsole.log('üíæ Iniciando guardado del perfil...');\r\n\t\t\r\n\t\t// Subir avatar si hay uno nuevo\r\n\t\tif (avatarFile) {\r\n\t\t\tconsole.log('üì∑ Subiendo avatar primero...');\r\n\t\t\tconst avatarSuccess = await uploadAvatar(avatarFile);\r\n\t\t\tif (!avatarSuccess) {\r\n\t\t\t\tconsole.error('‚ùå Fall√≥ la subida del avatar');\r\n\t\t\t\treturn; // Si falla el avatar, no continuar\r\n\t\t\t}\r\n\t\t\tsetAvatarFile(null);\r\n\t\t\tsetAvatarPreview(null);\r\n\t\t\tsetImageLoadError(false); // Resetear error de imagen tras √©xito\r\n\t\t\tconsole.log('‚úÖ Avatar subido exitosamente');\r\n\t\t}\r\n\r\n\t\t// Actualizar perfil con todos los datos\r\n\t\tconst profileUpdates = {\r\n\t\t\tname: personalData.name,\r\n\t\t\tlocation: personalData.location,\r\n\t\t\tstoreName: storeData.storeName,\r\n\t\t\tstoreDescription: storeData.storeDescription,\r\n\t\t};\r\n\r\n\t\tconsole.log('üì§ Actualizando perfil con datos:', profileUpdates);\r\n\t\tconst success = await updateProfile(profileUpdates);\r\n\t\t\r\n\t\tif (success) {\r\n\t\t\tconsole.log('‚úÖ Perfil actualizado exitosamente');\r\n\t\t\tsetImageLoadError(false); // Resetear error de imagen tras √©xito\r\n\t\t\t// No cambiar hasChanges aqu√≠, lo har√° el useEffect cuando reciba success\r\n\t\t} else {\r\n\t\t\tconsole.error('‚ùå Fall√≥ la actualizaci√≥n del perfil');\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleChangePassword = async () => {\r\n\t\tif (!passwordData.currentPassword || !passwordData.newPassword || !passwordData.confirmPassword) {\r\n\t\t\talert(\"Por favor completa todos los campos de contrase√±a.\");\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconsole.log('üîê Cambiando contrase√±a...');\r\n\t\tconst success = await changePassword(passwordData);\r\n\t\tif (success) {\r\n\t\t\tconsole.log('‚úÖ Contrase√±a cambiada exitosamente');\r\n\t\t\tsetPasswordData({\r\n\t\t\t\tcurrentPassword: \"\",\r\n\t\t\t\tnewPassword: \"\",\r\n\t\t\t\tconfirmPassword: \"\",\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tconst togglePasswordVisibility = (field: keyof typeof showPasswords) => {\r\n\t\tsetShowPasswords(prev => ({ ...prev, [field]: !prev[field] }));\r\n\t};\r\n\r\n\tconst handleCancelChanges = () => {\r\n\t\tconsole.log('‚ùå Cancelando cambios...');\r\n\t\tsetPersonalData({\r\n\t\t\tname: profileData.name || \"\",\r\n\t\t\tlocation: profileData.location || \"\",\r\n\t\t});\r\n\t\tsetStoreData({\r\n\t\t\tstoreName: profileData.storeName || \"\",\r\n\t\t\tstoreDescription: profileData.storeDescription || \"\",\r\n\t\t});\r\n\t\tsetAvatarFile(null);\r\n\t\tsetAvatarPreview(null);\r\n\t\tsetImageLoadError(false); // Resetear error de imagen\r\n\t\tsetHasChanges(false);\r\n\t};\r\n\r\n\t// Funci√≥n para obtener la URL del avatar\r\n\tconst getAvatarUrl = (): string | undefined => {\r\n\t\tif (avatarPreview) return avatarPreview;\r\n\t\tif (profileData.avatar && !imageLoadError) {\r\n\t\t\t// Si la URL ya incluye el dominio, usarla tal como est√°\r\n\t\t\tif (profileData.avatar.startsWith('http')) {\r\n\t\t\t\treturn profileData.avatar;\r\n\t\t\t}\r\n\t\t\t// Si es una ruta relativa, construir la URL completa\r\n\t\t\treturn `${import.meta.env.VITE_URL_BASE || 'http://127.0.0.1:8000'}/storage/${profileData.avatar}`;\r\n\t\t}\r\n\t\treturn undefined; // Sin imagen, mostrar inicial\r\n\t};\r\n\r\n\t// Funci√≥n para obtener la inicial del usuario\r\n\tconst getUserInitial = () => {\r\n\t\tif (profileData.name) {\r\n\t\t\treturn profileData.name.charAt(0).toUpperCase();\r\n\t\t}\r\n\t\treturn 'U';\r\n\t};\r\n\r\n\t// ‚úÖ ARREGLADO: No mostrar nada hasta que est√© inicializado\r\n\tif (!isInitialized) {\r\n\t\treturn (\r\n\t\t\t<div className=\"flex justify-center items-center h-64\">\r\n\t\t\t\t<div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600\"></div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"space-y-6\">\r\n\t\t\t{/* Debug Info - Solo mostrar en desarrollo */}\r\n\t\t\t{import.meta.env.NODE_ENV === 'development' && (\r\n\t\t\t\t<div className=\"bg-blue-50 border border-blue-200 rounded-lg p-4 text-xs\">\r\n\t\t\t\t\t<details>\r\n\t\t\t\t\t\t<summary className=\"cursor-pointer font-medium\">üîç Debug Info</summary>\r\n\t\t\t\t\t\t<pre className=\"mt-2 text-xs bg-white p-2 rounded border overflow-x-auto\">\r\n\t\t\t\t\t\t\t{JSON.stringify({ \r\n\t\t\t\t\t\t\t\tprofileData: {\r\n\t\t\t\t\t\t\t\t\tname: profileData.name,\r\n\t\t\t\t\t\t\t\t\tlocation: profileData.location,\r\n\t\t\t\t\t\t\t\t\tstoreName: profileData.storeName,\r\n\t\t\t\t\t\t\t\t\tstoreDescription: profileData.storeDescription,\r\n\t\t\t\t\t\t\t\t\tavatar: profileData.avatar\r\n\t\t\t\t\t\t\t\t}, \r\n\t\t\t\t\t\t\t\tpersonalData, \r\n\t\t\t\t\t\t\t\tstoreData, \r\n\t\t\t\t\t\t\t\thasChanges,\r\n\t\t\t\t\t\t\t\tisInitialized,\r\n\t\t\t\t\t\t\t\timageLoadError,\r\n\t\t\t\t\t\t\t\tavatarPreview: avatarPreview ? 'preview-set' : null\r\n\t\t\t\t\t\t\t}, null, 2)}\r\n\t\t\t\t\t\t</pre>\r\n\t\t\t\t\t</details>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{/* Mensajes de estado */}\r\n\t\t\t{error && (\r\n\t\t\t\t<div className=\"bg-red-50 border-l-4 border-red-500 p-4 rounded-r-lg\">\r\n\t\t\t\t\t<div className=\"flex\">\r\n\t\t\t\t\t\t<AlertCircle className=\"h-5 w-5 text-red-500\" />\r\n\t\t\t\t\t\t<div className=\"ml-3\">\r\n\t\t\t\t\t\t\t<p className=\"text-sm text-red-700\">{error}</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{success && (\r\n\t\t\t\t<div className=\"bg-green-50 border-l-4 border-green-500 p-4 rounded-r-lg\">\r\n\t\t\t\t\t<div className=\"flex\">\r\n\t\t\t\t\t\t<CheckCircle className=\"h-5 w-5 text-green-500\" />\r\n\t\t\t\t\t\t<div className=\"ml-3\">\r\n\t\t\t\t\t\t\t<p className=\"text-sm text-green-700\">{success}</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{/* Header Section */}\r\n\t\t\t<div className=\"bg-white rounded-lg shadow-sm p-6\">\r\n\t\t\t\t<div className=\"flex flex-col md:flex-row items-center space-y-4 md:space-y-0 md:space-x-6\">\r\n\t\t\t\t\t<div className=\"relative\">\r\n\t\t\t\t\t\t{getAvatarUrl() ? (\r\n\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\tsrc={getAvatarUrl()}\r\n\t\t\t\t\t\t\t\talt=\"Seller profile\"\r\n\t\t\t\t\t\t\t\tclassName=\"w-24 h-24 rounded-full object-cover border-4 border-white shadow-md\"\r\n\t\t\t\t\t\t\t\tonError={() => {\r\n\t\t\t\t\t\t\t\t\tconsole.error('‚ùå Error cargando imagen:', getAvatarUrl());\r\n\t\t\t\t\t\t\t\t\t// Marcar que hay error de carga para mostrar la inicial\r\n\t\t\t\t\t\t\t\t\tsetImageLoadError(true);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\tonLoad={() => {\r\n\t\t\t\t\t\t\t\t\t// Si la imagen se carga correctamente, resetear el error\r\n\t\t\t\t\t\t\t\t\tsetImageLoadError(false);\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<div className=\"w-24 h-24 rounded-full bg-gradient-to-r from-primary-500 to-primary-600 flex items-center justify-center border-4 border-white shadow-md\">\r\n\t\t\t\t\t\t\t\t<span className=\"text-white text-2xl font-bold\">\r\n\t\t\t\t\t\t\t\t\t{getUserInitial()}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\tonClick={() => fileInputRef.current?.click()}\r\n\t\t\t\t\t\t\tclassName=\"absolute bottom-0 right-0 bg-primary-600 text-white rounded-full p-2 hover:bg-primary-700 transition-colors shadow-lg\"\r\n\t\t\t\t\t\t\ttitle=\"Cambiar imagen de perfil\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Camera size={16} />\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\tref={fileInputRef}\r\n\t\t\t\t\t\t\ttype=\"file\"\r\n\t\t\t\t\t\t\taccept=\"image/*\"\r\n\t\t\t\t\t\t\tonChange={handleAvatarChange}\r\n\t\t\t\t\t\t\tclassName=\"hidden\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div className=\"flex-1 text-center md:text-left\">\r\n\t\t\t\t\t\t<h1 className=\"text-2xl font-bold text-gray-900\">\r\n\t\t\t\t\t\t\t{profileData.name || \"Nombre del Vendedor\"}\r\n\t\t\t\t\t\t</h1>\r\n\t\t\t\t\t\t<p className=\"text-gray-500\">\r\n\t\t\t\t\t\t\t{profileData.email}\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t<div className=\"mt-4 flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4\">\r\n\t\t\t\t\t\t\t<button className=\"flex items-center justify-center text-primary-600 hover:underline\">\r\n\t\t\t\t\t\t\t\t<Store size={16} className=\"mr-1\" />\r\n\t\t\t\t\t\t\t\tVer tienda \r\n\t\t\t\t\t\t\t\t<ChevronRight size={16} className=\"ml-1\" />\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Profile Sections */}\r\n\t\t\t<div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\r\n\t\t\t\t{/* Personal Information */}\r\n\t\t\t\t<div className=\"bg-white rounded-lg shadow-sm p-6 space-y-4\">\r\n\t\t\t\t\t<h3 className=\"flex items-center text-lg font-medium text-gray-900\">\r\n\t\t\t\t\t\t<User size={20} className=\"mr-3 text-primary-600\" />\r\n\t\t\t\t\t\tInformaci√≥n Personal\r\n\t\t\t\t\t</h3>\r\n\t\t\t\t\t<div className=\"space-y-4\">\r\n\t\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t\t<User size={18} className=\"text-gray-500 mr-3 flex-shrink-0\" />\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\tvalue={personalData.name}\r\n\t\t\t\t\t\t\t\tonChange={(e) => handlePersonalDataChange(\"name\", e.target.value)}\r\n\t\t\t\t\t\t\t\tplaceholder={profileData.name || \"Nombre completo\"}\r\n\t\t\t\t\t\t\t\tclassName=\"w-full bg-transparent focus:outline-none text-gray-700 border-b border-gray-300 pb-1 focus:border-primary-500\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t\t<Mail size={18} className=\"text-gray-500 mr-3 flex-shrink-0\" />\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype=\"email\"\r\n\t\t\t\t\t\t\t\tvalue={profileData.email}\r\n\t\t\t\t\t\t\t\tdisabled\r\n\t\t\t\t\t\t\t\tclassName=\"w-full bg-gray-50 text-gray-500 cursor-not-allowed border-b border-gray-300 pb-1\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t\t<MapPin size={18} className=\"text-gray-500 mr-3 flex-shrink-0\" />\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\tvalue={personalData.location}\r\n\t\t\t\t\t\t\t\tonChange={(e) => handlePersonalDataChange(\"location\", e.target.value)}\r\n\t\t\t\t\t\t\t\tplaceholder={profileData.location || \"Ciudad, Pa√≠s\"}\r\n\t\t\t\t\t\t\t\tclassName=\"w-full bg-transparent focus:outline-none text-gray-700 border-b border-gray-300 pb-1 focus:border-primary-500\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{/* Store Information */}\r\n\t\t\t\t<div className=\"bg-white rounded-lg shadow-sm p-6 space-y-4\">\r\n\t\t\t\t\t<h3 className=\"flex items-center text-lg font-medium text-gray-900\">\r\n\t\t\t\t\t\t<Store size={20} className=\"mr-3 text-blue-600\" />\r\n\t\t\t\t\t\tInformaci√≥n de la Tienda\r\n\t\t\t\t\t</h3>\r\n\t\t\t\t\t<div className=\"space-y-4\">\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<label className=\"block text-sm text-gray-500 mb-1\">\r\n\t\t\t\t\t\t\t\tNombre de tienda\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\tvalue={storeData.storeName}\r\n\t\t\t\t\t\t\t\tonChange={(e) => handleStoreDataChange(\"storeName\", e.target.value)}\r\n\t\t\t\t\t\t\t\tplaceholder={profileData.storeName || \"Mi Tienda Online\"}\r\n\t\t\t\t\t\t\t\tclassName=\"w-full bg-transparent focus:outline-none text-gray-700 border-b border-gray-300 pb-1 focus:border-primary-500\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t{profileData.storeName && (\r\n\t\t\t\t\t\t\t\t<p className=\"text-xs text-gray-400 mt-1\">Actual: {profileData.storeName}</p>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<label className=\"block text-sm text-gray-500 mb-1\">\r\n\t\t\t\t\t\t\t\tDescripci√≥n\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<textarea\r\n\t\t\t\t\t\t\t\tvalue={storeData.storeDescription}\r\n\t\t\t\t\t\t\t\tonChange={(e) => handleStoreDataChange(\"storeDescription\", e.target.value)}\r\n\t\t\t\t\t\t\t\tplaceholder={profileData.storeDescription || \"Descripci√≥n de la tienda...\"}\r\n\t\t\t\t\t\t\t\tclassName=\"w-full bg-transparent focus:outline-none text-gray-700 border-b border-gray-300 pb-1 focus:border-primary-500 resize-none\"\r\n\t\t\t\t\t\t\t\trows={3}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t{profileData.storeDescription && (\r\n\t\t\t\t\t\t\t\t<p className=\"text-xs text-gray-400 mt-1\">Actual: {profileData.storeDescription}</p>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{/* Security */}\r\n\t\t\t\t<div className=\"bg-white rounded-lg shadow-sm p-6 space-y-4 md:col-span-2\">\r\n\t\t\t\t\t<h3 className=\"flex items-center text-lg font-medium text-gray-900\">\r\n\t\t\t\t\t\t<Lock size={20} className=\"mr-3 text-red-600\" />\r\n\t\t\t\t\t\tCambiar Contrase√±a\r\n\t\t\t\t\t</h3>\r\n\t\t\t\t\t<form onSubmit={(e) => { e.preventDefault(); handleChangePassword(); }} className=\"space-y-4\">\r\n\t\t\t\t\t\t<div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n\t\t\t\t\t\t<div className=\"space-y-2\">\r\n\t\t\t\t\t\t\t<label className=\"text-sm text-gray-500\">\r\n\t\t\t\t\t\t\t\tContrase√±a actual\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<div className=\"relative\">\r\n\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\ttype={showPasswords.current ? \"text\" : \"password\"}\r\n\t\t\t\t\t\t\t\t\tvalue={passwordData.currentPassword}\r\n\t\t\t\t\t\t\t\t\tonChange={(e) => handlePasswordChange(\"currentPassword\", e.target.value)}\r\n\t\t\t\t\t\t\t\t\tclassName=\"w-full bg-gray-50 rounded-lg px-4 py-2 pr-10 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\tonClick={() => togglePasswordVisibility(\"current\")}\r\n\t\t\t\t\t\t\t\t\tclassName=\"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{showPasswords.current ? <EyeOff size={16} /> : <Eye size={16} />}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"space-y-2\">\r\n\t\t\t\t\t\t\t<label className=\"text-sm text-gray-500\">\r\n\t\t\t\t\t\t\t\tNueva contrase√±a\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<div className=\"relative\">\r\n\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\ttype={showPasswords.new ? \"text\" : \"password\"}\r\n\t\t\t\t\t\t\t\t\tvalue={passwordData.newPassword}\r\n\t\t\t\t\t\t\t\t\tonChange={(e) => handlePasswordChange(\"newPassword\", e.target.value)}\r\n\t\t\t\t\t\t\t\t\tclassName=\"w-full bg-gray-50 rounded-lg px-4 py-2 pr-10 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\tonClick={() => togglePasswordVisibility(\"new\")}\r\n\t\t\t\t\t\t\t\t\tclassName=\"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{showPasswords.new ? <EyeOff size={16} /> : <Eye size={16} />}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"space-y-2\">\r\n\t\t\t\t\t\t\t<label className=\"text-sm text-gray-500\">\r\n\t\t\t\t\t\t\t\tConfirmar contrase√±a\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<div className=\"relative\">\r\n\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\ttype={showPasswords.confirm ? \"text\" : \"password\"}\r\n\t\t\t\t\t\t\t\t\tvalue={passwordData.confirmPassword}\r\n\t\t\t\t\t\t\t\t\tonChange={(e) => handlePasswordChange(\"confirmPassword\", e.target.value)}\r\n\t\t\t\t\t\t\t\t\tclassName=\"w-full bg-gray-50 rounded-lg px-4 py-2 pr-10 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\t\t\tonClick={() => togglePasswordVisibility(\"confirm\")}\r\n\t\t\t\t\t\t\t\t\tclassName=\"absolute right-3 top-2.5 text-gray-400 hover:text-gray-600\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{showPasswords.confirm ? <EyeOff size={16} /> : <Eye size={16} />}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"flex justify-end\">\r\n\t\t\t\t\t\t\t<button \r\n\t\t\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\t\t\tdisabled={loading || !passwordData.currentPassword || !passwordData.newPassword || !passwordData.confirmPassword}\r\n\t\t\t\t\t\t\t\tclassName=\"px-4 py-2 bg-red-600 rounded-lg text-white hover:bg-red-700 transition disabled:opacity-50 disabled:cursor-not-allowed\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{loading ? \"Cambiando...\" : \"Cambiar Contrase√±a\"}\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</form>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t\r\n\t\t\t</div>\r\n{/* Feedback Section */}\r\n\t\t\t\t<SellerFeedbackSection />\r\n\t\t\t{/* Action Buttons */}\r\n\t\t\t<div className=\"flex justify-end space-x-4\">\r\n\t\t\t\t<button \r\n\t\t\t\t\tonClick={handleCancelChanges}\r\n\t\t\t\t\tdisabled={loading || !hasChanges}\r\n\t\t\t\t\tclassName=\"px-6 py-2 bg-gray-200 rounded-lg text-gray-700 hover:bg-gray-300 transition disabled:opacity-50 disabled:cursor-not-allowed\"\r\n\t\t\t\t>\r\n\t\t\t\t\tCancelar\r\n\t\t\t\t</button>\r\n\t\t\t\t<button \r\n\t\t\t\t\tonClick={handleSaveProfile}\r\n\t\t\t\t\tdisabled={loading || !hasChanges}\r\n\t\t\t\t\tclassName=\"px-6 py-2 bg-primary-600 rounded-lg text-white hover:bg-primary-700 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{loading ? (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<span className=\"inline-block animate-spin mr-1\">‚ü≥</span>\r\n\t\t\t\t\t\t\tGuardando...\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<Save size={18} className=\"mr-2\" />\r\n\t\t\t\t\t\t\tGuardar cambios\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default SellerProfilePage;"],"names":["useSellerProfile","user","updateUser","useAuth","loading","setLoading","useState","error","setError","success","setSuccess","sellerInfo","setSellerInfo","validatePassword","usePasswordValidation","sellerInfoLoaded","setSellerInfoLoaded","useEffect","fetchSellerInfo","API_ENDPOINTS","response","ApiClient","responseData","err","errorObj","profileData","useMemo","data","updateUserProfile","useCallback","userData","cleanData","_","value","errorMessage","updateStoreInfo","storeData","updateData","prev","updateProfile","profileDataUpdate","allSuccess","hasAnyChanges","hasUserChanges","hasStoreChanges","userSuccess","storeSuccess","uploadAvatar","file","formData","errors","changePassword","passwordData","passwordValidation","clearMessages","SellerFeedbackSection","feedbacks","setFeedbacks","isLoading","setIsLoading","isSubmitting","setIsSubmitting","showForm","setShowForm","setFormData","validationErrors","setValidationErrors","fetchFeedbacks","feedback","calculateTimeRemaining","interval","prevFeedbacks","handleSubmit","e","errorData","getStatusIcon","status","jsx","Clock","CheckCircle","XCircle","getStatusText","getTypeText","type","formatDate","dateString","expiresAt","now","diffMs","days","hours","minutes","jsxs","MessageSquare","AlertCircle","index","Send","timeRemaining","isActive","Crown","Sparkles","Gift","Star","SellerProfilePage","personalData","setPersonalData","setStoreData","setPasswordData","showPasswords","setShowPasswords","hasChanges","setHasChanges","avatarFile","setAvatarFile","avatarPreview","setAvatarPreview","isInitialized","setIsInitialized","imageLoadError","setImageLoadError","fileInputRef","useRef","timer","handlePersonalDataChange","field","handleStoreDataChange","handlePasswordChange","handleAvatarChange","event","reader","handleSaveProfile","profileUpdates","handleChangePassword","togglePasswordVisibility","handleCancelChanges","getAvatarUrl","getUserInitial","Camera","Store","ChevronRight","User","Mail","MapPin","Lock","EyeOff","Eye","Fragment","Save"],"mappings":"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"}