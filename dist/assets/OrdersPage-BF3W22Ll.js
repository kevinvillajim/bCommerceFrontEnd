import{u as S,r as a,j as e,L as n}from"./index-DmNDOrWy.js";import{f as C}from"./formatCurrency-CXuiUHwQ.js";import{f as E}from"./formatDate-DOKfBcN0.js";import{O as f}from"./OrderStatusBadge-CE0y32qI.js";import{T as k}from"./Table-BdEePeKQ.js";import{O as F}from"./OrderServiceAdapter-DWn3IDlZ.js";import{R as O}from"./refresh-cw-BOPCg90x.js";import{S as L}from"./search-CbEKe7UQ.js";import{F as A}from"./funnel-CAFb7hhq.js";import{S as T}from"./shopping-bag-BMmsUIy8.js";import{E as z}from"./eye-CldZNoIz.js";import{F as $}from"./file-text-DT6_O-Nw.js";import"./chevron-left-Dl3DF2OO.js";import"./arrow-up-DQySjn32.js";import"./Order-YtLC4nUV.js";const Y=()=>{const{isAuthenticated:c}=S(),j=new F,[y,l]=a.useState([]),[b,d]=a.useState(!0),[m,u]=a.useState(null),[o,p]=a.useState("all"),[i,x]=a.useState(""),[t,h]=a.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:10});a.useEffect(()=>{c&&g()},[c,o,i,t.currentPage]);const g=async()=>{d(!0);try{const r={page:t.currentPage,limit:t.itemsPerPage};o!=="all"&&(r.status=o);const s=await j.getUserOrders(r);s&&s.orders?(console.log("Órdenes recibidas:",s.orders),l(s.orders),h(s.pagination)):(console.error("No se recibieron órdenes en la respuesta"),l([]),u("No se pudieron cargar las órdenes"))}catch(r){console.error("Error al cargar órdenes:",r),u("Error al cargar órdenes"),l([])}finally{d(!1)}},v=r=>{h(s=>({...s,currentPage:r}))},N=()=>{d(!0),g()},P=y.filter(r=>{if(!i)return!0;const s=i.toLowerCase();return r.orderNumber?.toLowerCase().includes(s)||r.shippingAddress?.toLowerCase().includes(s)||!1}),w=[{key:"orderNumber",header:"Número de Pedido",sortable:!0,render:r=>e.jsx(n,{to:`/orders/${r.id}`,className:"font-medium text-primary-600 hover:underline",children:r.orderNumber})},{key:"date",header:"Fecha",sortable:!0,render:r=>r.date?E(r.date):"Fecha no disponible"},{key:"total",header:"Total",sortable:!0,render:r=>e.jsx("span",{className:"font-medium",children:C(r.total||0)})},{key:"items",header:"Productos",render:r=>e.jsx("div",{className:"flex items-center justify-center",children:r.items&&r.items.length>0?e.jsx("span",{className:"text-center",children:r.items.length}):e.jsxs(n,{to:`/orders/${r.id}`,className:"flex items-center text-primary-600 hover:text-primary-800",children:[e.jsx(T,{size:16,className:"mr-1"}),e.jsx("span",{children:"Ver detalle"})]})})},{key:"status",header:"Estado",sortable:!0,render:r=>e.jsx(f,{status:r.status})},{key:"payment",header:"Pago",sortable:!0,render:r=>e.jsx(f,{status:r.paymentStatus,type:"payment"})},{key:"actions",header:"Acciones",render:r=>e.jsxs("div",{className:"flex justify-end space-x-2",children:[e.jsx(n,{to:`/orders/${r.id}`,className:"p-1 text-blue-600 hover:bg-blue-100 rounded-md",title:"Ver detalles",children:e.jsx(z,{size:18})}),["completed","delivered"].includes(r.status)&&e.jsx(n,{to:`/invoices/${r.id}`,className:"p-1 text-indigo-600 hover:bg-indigo-100 rounded-md",title:"Ver factura",children:e.jsx($,{size:18})})]})}];return e.jsx("div",{className:"py-8 px-4 md:px-8 max-w-7xl mx-auto",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Mis Pedidos"}),e.jsx("div",{className:"flex space-x-2",children:e.jsxs("button",{onClick:N,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[e.jsx(O,{size:18,className:"inline mr-2"}),"Actualizar"]})})]}),m&&e.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",role:"alert",children:e.jsx("span",{className:"block sm:inline",children:m})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx("input",{type:"text",placeholder:"Buscar por número de pedido...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",value:i,onChange:r=>x(r.target.value)}),e.jsx(L,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(A,{className:"h-5 w-5 text-gray-500"}),e.jsxs("select",{name:"status",className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",value:o,onChange:r=>p(r.target.value),children:[e.jsx("option",{value:"all",children:"Todos los estados"}),e.jsx("option",{value:"pending",children:"Pendientes"}),e.jsx("option",{value:"processing",children:"En Proceso"}),e.jsx("option",{value:"paid",children:"Pagados"}),e.jsx("option",{value:"shipped",children:"Enviados"}),e.jsx("option",{value:"delivered",children:"Entregados"}),e.jsx("option",{value:"completed",children:"Completados"}),e.jsx("option",{value:"cancelled",children:"Cancelados"})]})]}),e.jsx("button",{onClick:()=>{p("all"),x("")},className:"cursor-pointer bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700",children:"Limpiar filtros"})]})}),e.jsx(k,{data:P,columns:w,searchFields:["orderNumber"],loading:b,emptyMessage:"No se encontraron pedidos",pagination:{currentPage:t.currentPage,totalPages:t.totalPages,totalItems:t.totalItems,itemsPerPage:t.itemsPerPage,onPageChange:v}})]})})};export{Y as default};
//# sourceMappingURL=OrdersPage-BF3W22Ll.js.map
