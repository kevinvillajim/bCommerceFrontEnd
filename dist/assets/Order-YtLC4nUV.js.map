{"version":3,"file":"Order-YtLC4nUV.js","sources":["../../src/core/domain/entities/Order.ts"],"sourcesContent":["/**\r\n * Archivo: src/core/domain/entities/Order.ts\r\n * Entidades relacionadas con órdenes de compra y sus tipos - CORREGIDO\r\n */\r\nexport interface Order {\r\n\tid?: number;\r\n\tuserId: number;\r\n\tsellerId?: number;\r\n\titems: OrderItem[];\r\n\ttotal: number;\r\n\tstatus: OrderStatus;\r\n\tpaymentId?: string;\r\n\tpaymentMethod?: PaymentMethod;\r\n\tpaymentStatus?: PaymentStatus;\r\n\tpaymentDetails?: Record<string, any>;\r\n\tshippingData?: ShippingData;\r\n\torderNumber: string;\r\n\tcreatedAt?: string;\r\n\tupdatedAt?: string;\r\n\tuser_name?: string; // Añadido para compatibilidad con API\r\n\tuser_email?: string; // Añadido para compatibilidad con API\r\n}\r\n\r\n/**\r\n * Order item entity\r\n */\r\nexport interface OrderItem {\r\n\tid?: number;\r\n\torderId?: number;\r\n\tproductId: number;\r\n\tquantity: number;\r\n\tprice: number;\r\n\tsubtotal: number;\r\n\tproduct?: {\r\n\t\tname: string;\r\n\t\timage?: string;\r\n\t\tslug?: string;\r\n\t\tsku?: string;\r\n\t};\r\n\tcreatedAt?: string;\r\n\tupdatedAt?: string;\r\n\tproduct_name?: string; // Para compatibilidad con API\r\n\tproduct_sku?: string; // Para compatibilidad con API\r\n\tproduct_image?: string; // Para compatibilidad con API\r\n}\r\n\r\n/**\r\n * Order detail entity - Versión extendida con información adicional\r\n */\r\nexport interface OrderDetail extends Order {\r\n\titems: (OrderItem & {\r\n\t\tproduct_name?: string;\r\n\t\tproduct_sku?: string;\r\n\t\tproduct_image?: string;\r\n\t})[];\r\n}\r\n\r\n/**\r\n * Order creation data\r\n */\r\nexport interface OrderCreationData {\r\n\tsellerId?: number;\r\n\titems: OrderItemCreationData[];\r\n\tshippingData?: ShippingData;\r\n}\r\n\r\n/**\r\n * Order item creation data\r\n */\r\nexport interface OrderItemCreationData {\r\n\tproductId: number;\r\n\tquantity: number;\r\n\tprice?: number;\r\n}\r\n\r\n/**\r\n * Order status update data\r\n */\r\nexport interface OrderStatusUpdateData {\r\n\tstatus: OrderStatus;\r\n}\r\n\r\n/**\r\n * Order payment info update data\r\n */\r\nexport interface OrderPaymentUpdateData {\r\n\tpaymentId: string;\r\n\tpaymentMethod: PaymentMethod;\r\n\tpaymentStatus: PaymentStatus;\r\n\tpaymentDetails?: Record<string, any>;\r\n}\r\n\r\n/**\r\n * Order shipping data update\r\n */\r\nexport interface OrderShippingUpdateData {\r\n\tshippingData: ShippingData;\r\n}\r\n\r\n/**\r\n * Order list response\r\n */\r\nexport interface OrderListResponse {\r\n\tdata: Order[];\r\n\tmeta: {\r\n\t\ttotal: number;\r\n\t\tper_page: number;\r\n\t\tcurrent_page: number;\r\n\t\tlast_page: number;\r\n\t};\r\n}\r\n\r\n/**\r\n * Order detail response\r\n */\r\nexport interface OrderDetailResponse {\r\n\tdata: OrderDetail;\r\n}\r\n\r\n/**\r\n * Order filter params\r\n */\r\nexport interface OrderFilterParams {\r\n\tuserId?: number;\r\n\tsellerId?: number;\r\n\tstatus?: string;\r\n\tpaymentStatus?: string;\r\n\torderNumber?: string;\r\n\tdateFrom?: string;\r\n\tdateTo?: string;\r\n\tsearch?: string;\r\n\tpage?: number;\r\n\tperPage?: number;\r\n\tsortBy?: string;\r\n\tsortDir?: \"asc\" | \"desc\";\r\n}\r\n\r\n/**\r\n * Order statistics\r\n */\r\nexport interface OrderStats {\r\n\ttotalOrders: number;\r\n\tpendingOrders: number;\r\n\tprocessingOrders: number;\r\n\tshippedOrders: number;\r\n\tdeliveredOrders: number;\r\n\tcompletedOrders: number;\r\n\tcancelledOrders: number;\r\n\ttotalSales: number;\r\n}\r\n\r\n/**\r\n * Order status type - ✅ CORREGIDO para incluir 'rejected'\r\n */\r\nexport type OrderStatus =\r\n\t| \"pending\"\r\n\t| \"processing\"\r\n\t| \"paid\"\r\n\t| \"shipped\"\r\n\t| \"delivered\"\r\n\t| \"completed\"\r\n\t| \"cancelled\"\r\n\t| \"rejected\";\r\n\r\nexport const isValidOrderStatus = (status: string): status is OrderStatus => {\r\n\tconst validStatuses: OrderStatus[] = [\r\n\t\t\"pending\",\r\n\t\t\"processing\",\r\n\t\t\"paid\",\r\n\t\t\"shipped\",\r\n\t\t\"delivered\",\r\n\t\t\"completed\",\r\n\t\t\"cancelled\",\r\n\t\t\"rejected\",\r\n\t];\r\n\treturn validStatuses.includes(status as OrderStatus);\r\n};\r\n\r\nexport const getValidTransitions = (\r\n\tcurrentStatus: OrderStatus\r\n): OrderStatus[] => {\r\n\tconst transitions: Record<OrderStatus, OrderStatus[]> = {\r\n\t\tpending: [\"processing\", \"cancelled\", \"rejected\"],\r\n\t\tprocessing: [\"shipped\", \"cancelled\", \"rejected\"],\r\n\t\tpaid: [\"processing\", \"shipped\", \"cancelled\", \"rejected\"],\r\n\t\tshipped: [\"delivered\", \"cancelled\"],\r\n\t\tdelivered: [\"completed\"],\r\n\t\tcompleted: [],\r\n\t\tcancelled: [],\r\n\t\trejected: [],\r\n\t};\r\n\r\n\treturn transitions[currentStatus] || [];\r\n};\r\n\r\n// ✅ FUNCIÓN HELPER PARA VERIFICAR SI UNA TRANSICIÓN ES VÁLIDA\r\nexport const canTransitionTo = (\r\n\tcurrentStatus: OrderStatus,\r\n\tnewStatus: OrderStatus\r\n): boolean => {\r\n\treturn getValidTransitions(currentStatus).includes(newStatus);\r\n};\r\n\r\n/**\r\n * Payment method type\r\n */\r\nexport type PaymentMethod =\r\n\t| \"credit_card\"\r\n\t| \"paypal\"\r\n\t| \"transfer\"\r\n\t| \"other\"\r\n\t| null;\r\n\r\n/**\r\n * Payment status type\r\n */\r\nexport type PaymentStatus =\r\n\t| \"pending\"\r\n\t| \"completed\"\r\n\t| \"failed\"\r\n\t| \"rejected\"\r\n\t| null;\r\n\r\n/**\r\n * Shipping data type\r\n */\r\nexport interface ShippingData {\r\n\taddress: string;\r\n\tcity: string;\r\n\tstate: string;\r\n\tcountry: string;\r\n\tpostalCode: string;\r\n\tphone?: string;\r\n\tname?: string;\r\n\ttracking_number?: string;\r\n\tshipping_company?: string;\r\n\testimated_delivery?: string;\r\n\tnotes?: string;\r\n\tcancel_reason?: string;\r\n}\r\n"],"names":["isValidOrderStatus","status","getValidTransitions","currentStatus","canTransitionTo","newStatus"],"mappings":"AAoKa,MAAAA,EAAsBC,GACG,CACpC,UACA,aACA,OACA,UACA,YACA,YACA,YACA,UACD,EACqB,SAASA,CAAqB,EAGvCC,EACZC,IAEwD,CACvD,QAAS,CAAC,aAAc,YAAa,UAAU,EAC/C,WAAY,CAAC,UAAW,YAAa,UAAU,EAC/C,KAAM,CAAC,aAAc,UAAW,YAAa,UAAU,EACvD,QAAS,CAAC,YAAa,WAAW,EAClC,UAAW,CAAC,WAAW,EACvB,UAAW,CAAC,EACZ,UAAW,CAAC,EACZ,SAAU,CAAA,CACX,GAEmBA,CAAa,GAAK,CAAC,EAI1BC,EAAkB,CAC9BD,EACAE,IAEOH,EAAoBC,CAAa,EAAE,SAASE,CAAS"}