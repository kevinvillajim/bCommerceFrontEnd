import{r as o}from"./react-vendor-Cy458wKG.js";import{h as p}from"./admin-chunk-bhOJ3jtA.js";const l=(e=!0)=>{const[n,u]=o.useState(null),[t,a]=o.useState(!0),r=o.useRef(p.getInstance()),i=o.useRef(null),c=o.useCallback(async(d=!1)=>{try{a(!0);const s=await r.current.getUnifiedConfig(d);u(s),console.log("âœ… JORDAN useUnifiedConfig - ConfiguraciÃ³n cargada:",{source:s.source,isStale:s.is_stale,errors:s.errors.length,warnings:s.warnings.length})}catch(s){console.error("âŒ JORDAN useUnifiedConfig - Error:",s),u({config:r.current.getConfigSync()||r.current.getSecureFallbackConfig(),source:"fallback",is_stale:!0,errors:[s instanceof Error?s.message:"Error desconocido"],warnings:["Hook usando configuraciÃ³n de emergencia"]})}finally{a(!1)}},[]),f=o.useCallback(async()=>{await c(!0)},[c]),g=o.useCallback(()=>r.current.getStats(),[]);return o.useEffect(()=>(c(),e&&(i.current=setInterval(()=>{console.log("ðŸ”„ JORDAN - Auto-refresh de configuraciÃ³n"),c()},5*60*1e3)),()=>{i.current&&clearInterval(i.current)}),[c,e]),{config:n?.config||null,loading:t,error:n?.errors?.[0]||null,warnings:n?.warnings||[],source:n?.source||"fallback",isStale:n?.is_stale||!1,refetch:f,stats:g}},C=()=>{const{config:e,loading:n,error:u}=l();return{config:e?.shipping||null,loading:n,error:u,calculateShipping:t=>e?.shipping?t>=e.shipping.free_threshold?0:e.shipping.default_cost:0,isFreeShipping:t=>e?.shipping?t>=e.shipping.free_threshold:!1}},y=()=>{const{config:e,loading:n,error:u}=l();return{tiers:e?.volume_discounts||[],loading:n,error:u,getDiscountForQuantity:t=>{if(!e?.volume_discounts)return 0;const a=[...e.volume_discounts].sort((r,i)=>i.quantity-r.quantity);for(const r of a)if(t>=r.quantity)return r.discount/100;return 0},getApplicableTier:t=>{if(!e?.volume_discounts)return null;const a=[...e.volume_discounts].sort((r,i)=>i.quantity-r.quantity);for(const r of a)if(t>=r.quantity)return r;return null}}};export{y as a,C as u};
//# sourceMappingURL=useUnifiedConfig-CzuaHAQm.js.map
