import{j as e,H as X,a as M,am as se,e as z,ak as ae,aj as re,R as te,l as q,h as oe,D as ne,N as le,K as ce,T as H}from"./ui-vendor-DEBjJ4HS.js";import{r as n,R as K,d as ie,u as de}from"./react-vendor-Cy458wKG.js";import{g as G,N as x,c as A,A as B}from"./admin-chunk-C7Ad4l4I.js";const me=({widgetUrl:h,amount:u,customerName:o,onSuccess:a,onError:S,onCancel:C})=>{const{showToast:p}=G(),[f,y]=n.useState(!1),[l,i]=n.useState(!1),[D,v]=n.useState(null),w=n.useRef(!1),j=n.useRef(!1);n.useEffect(()=>(E(),()=>{const c=document.getElementById("datafast-external-script");c&&c.remove()}),[]);const E=()=>{try{console.log("🎯 Cargando widget externo de Datafast...");const c=document.getElementById("datafast-external-script");c&&c.remove(),window.wpwlOptions={onReady:function(){console.log("✅ Widget externo Datafast listo!"),y(!0),p(x.SUCCESS,"Formulario de pago cargado")},onBeforeSubmitCard:function(r){return console.log("🔄 Procesando pago externo...",r),i(!0),p(x.INFO,"Procesando pago..."),!0},onAfterSubmitCard:function(r){console.log("📤 Pago enviado, esperando respuesta...",r)},onBeforeRedirectToResult:function(r){if(console.log("🔄 Redirigiendo al resultado...",r),r&&r.resourcePath){localStorage.setItem("external_datafast_resource_path",r.resourcePath);const b=r.sessionId||`external_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return localStorage.setItem("external_datafast_session_id",b),console.log("   ✅ SessionId externo guardado para backend:",b),setTimeout(()=>{T(r.resourcePath)},1e3),!1}return!0},onError:function(r){console.error("❌ Error en widget externo:",r);const b=r.message||r.code||"Error desconocido";v(b),i(!1),p(x.ERROR,`Error: ${b}`),S?.(b)},style:"card",locale:"es",labels:{cvv:"CVV",cardHolder:"Nombre (igual que en la tarjeta)"}};const d=document.createElement("script");d.id="datafast-external-script",d.src=h,d.async=!0,d.onload=()=>{console.log("✅ Script de widget externo cargado exitosamente")},d.onerror=r=>{console.error("❌ Error cargando script de widget externo:",r),v("Error cargando formulario de pago"),p(x.ERROR,"Error cargando formulario de pago")},document.head.appendChild(d)}catch(c){console.error("Error configurando widget externo:",c),v("Error configurando formulario de pago")}},T=async c=>{if(w.current){console.log("⚠️ Verificación ya en progreso, ignorando llamada duplicada");return}if(j.current){console.log("✅ Verificación ya completada previamente, ignorando llamada duplicada");return}w.current=!0;try{console.log("🔍 Verificando resultado del pago externo..."),i(!0);const r=await(await fetch(`/api/pay/${R()}/verify/datafast`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({resource_path:c,transaction_id:`ext_${Date.now()}`})})).json();if(r.success)console.log("✅ Pago externo verificado exitosamente"),j.current=!0,p(x.SUCCESS,"Pago procesado exitosamente"),a?.(r.data);else{if(r.validation_data?.result?.code==="200.300.404"){console.log("⚠️ Error 200.300.404 detectado - sesión ya consumida, verificando pagos previos...");const m=await g();if(m.wasSuccessful){console.log("✅ Pago ya fue procesado exitosamente anteriormente"),j.current=!0,p(x.SUCCESS,"Pago procesado exitosamente"),a?.(m.data);return}}throw new Error(r.message||"Error verificando pago")}}catch(d){if(console.error("❌ Error verificando pago externo:",d),j.current)return;const r=d instanceof Error?d.message:"Error verificando pago";v(r),S?.(r)}finally{w.current=!1,i(!1)}},g=async()=>{try{console.log("🔍 Verificando si existe pago exitoso previo...");const c=R();if(!c)return{wasSuccessful:!1};const d=await fetch(`/api/external/checkout/${c}/status`,{method:"GET",headers:{"Content-Type":"application/json"}});if(d.ok){const r=await d.json();if(r.success&&r.data?.status==="completed")return console.log("✅ Encontrado pago exitoso previo en sistema externo"),{wasSuccessful:!0,data:r.data}}return console.log("ℹ️ No se encontró pago exitoso previo"),{wasSuccessful:!1}}catch(c){return console.error("❌ Error verificando pago previo:",c),{wasSuccessful:!1}}},R=()=>new URL(h).searchParams.get("checkoutId")||"";return D?e.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(X,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Error en el Pago"}),e.jsx("p",{className:"text-gray-600 mb-6",children:D}),e.jsxs("div",{className:"flex justify-center space-x-4",children:[e.jsx("button",{onClick:()=>{v(null),E()},className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Reintentar"}),e.jsx("button",{onClick:C,className:"bg-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancelar"})]})]})}):e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Pagar con Datafast"}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between text-sm text-blue-800",children:[e.jsxs("span",{children:["Cliente: ",o]}),e.jsxs("span",{children:["Monto: $",u.toFixed(2)," USD"]})]})})]}),e.jsx("div",{className:"min-h-[400px] border border-gray-200 rounded-lg p-4 mb-6",children:e.jsxs("form",{className:"paymentWidgets","data-brands":"VISA MASTER AMEX DINERS DISCOVER",children:[!f&&!l&&e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600",children:"Cargando formulario de pago..."})]})}),l&&e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-600 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-600",children:"Procesando pago..."})]})})]})}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:[e.jsx("h4",{className:"font-semibold text-yellow-800 mb-2",children:"Datos de prueba:"}),e.jsxs("div",{className:"text-sm text-yellow-700 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Tarjeta VISA:"})," 4200 0000 0000 0000"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Fecha:"})," 07/26 | ",e.jsx("strong",{children:"CVV:"})," 246"]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Titular:"})," ",o]})]})]}),e.jsx("div",{className:"text-center",children:e.jsx("button",{onClick:C,disabled:l,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancelar Pago"})})]})};class Y{static async createExternalPayment(u,o){try{console.log("ExternalDeunaService: Creating external payment",{linkCode:u,customerData:o});const a=await A.post(`/pay/${u}/deuna`,o);return console.log("ExternalDeunaService: Payment created successfully",a),a}catch(a){throw console.error("ExternalDeunaService: Error creating payment",a),new Error(a.response?.data?.message||a.message||"Error creating external payment")}}static async simulateWebhook(u,o){try{console.log("ExternalDeunaService: Simulating webhook",{linkCode:u,paymentId:o});const a=await A.post(`/pay/${u}/deuna/webhook`,{status:"SUCCESS",idTransaction:o,transferNumber:`TXN_${Date.now()}`,internalTransactionReference:o,amount:0,timestamp:new Date().toISOString()});return console.log("ExternalDeunaService: Webhook simulated successfully",a),{success:!0}}catch(a){throw console.error("ExternalDeunaService: Error simulating webhook",a),new Error(a.response?.data?.message||a.message||"Error simulating webhook")}}static async checkPaymentStatus(u){try{console.log("ExternalDeunaService: Checking payment status",{linkCode:u});const o=await A.get(`/pay/${u}`);console.log("ExternalDeunaService: Status checked successfully",o);const a=o.data;return{success:!0,status:a?.status||"pending",paid_at:a?.paid_at}}catch(o){return console.error("ExternalDeunaService: Error checking status",o),{success:!1,status:"error"}}}static pollExternalPaymentStatus(u,o={}){const{maxAttempts:a=40,interval:S=15e3,onStatusChange:C}=o;let p=0,f=!1;const y=async()=>{if(!(f||p>=a)){p++;try{const l=await this.checkPaymentStatus(u);if(l.success&&l.status==="paid"){C?.("completed");return}if(l.status==="cancelled"||l.status==="expired"){C?.(l.status);return}setTimeout(y,S)}catch(l){console.error("Error polling external payment status:",l),setTimeout(y,S)}}};return setTimeout(y,S),{cancel:()=>{f=!0},promise:new Promise(l=>{const i=()=>{f||p>=a?l():setTimeout(i,1e3)};i()})}}}const ue=({linkCode:h,amount:u,customerName:o,customerData:a,onSuccess:S,onError:C,onCancel:p})=>{const{showToast:f}=G(),[y,l]=n.useState(!1),[i,D]=n.useState(null),[v,w]=n.useState(null),[j,E]=n.useState(!1),[T,g]=n.useState("pending"),[R,c]=n.useState(600),[d,r]=n.useState(!1),b=K.useRef(null),m=K.useRef(null);n.useEffect(()=>(I(),()=>{b.current&&b.current.cancel(),m.current&&clearInterval(m.current)}),[]),n.useEffect(()=>{if(i&&j&&R>0){const t=setInterval(()=>{c(s=>s<=1?(E(!1),w("El tiempo de pago ha expirado. El pago ha sido cancelado automáticamente."),0):s-1)},1e3);m.current=t}return()=>{m.current&&(clearInterval(m.current),m.current=null)}},[i,j,R]);const I=async()=>{l(!0),w(null);try{console.log("🔄 Generando QR externo para Deuna...");const t=await Y.createExternalPayment(h,a);if(t.success&&t.data)console.log("✅ QR externo generado exitosamente"),D(t.data),E(!0),Q(),f(x.SUCCESS,"Código QR generado");else throw new Error(t.message||"Error generando código QR")}catch(t){console.error("❌ Error generando QR externo:",t);const s=t instanceof Error?t.message:"Error generando código QR";w(s),C?.(s)}finally{l(!1)}},Q=()=>{const t=Y.pollExternalPaymentStatus(h,{maxAttempts:40,interval:15e3,onStatusChange:W});b.current=t,t.promise.catch(s=>{console.error("Error en polling:",s),j&&w("Error monitoreando el estado del pago")})},W=t=>{switch(console.log("📊 Estado del pago cambió:",t),g(t),t){case"completed":E(!1),f(x.SUCCESS,"¡Pago completado exitosamente!"),S?.(i);break;case"failed":case"cancelled":E(!1);const s=`Pago ${t==="failed"?"fallido":"cancelado"}`;w(s),C?.(s);break}},F=async(t="Usuario canceló")=>{try{console.log("🚫 Cancelando pago externo:",t),E(!1),b.current&&b.current.cancel(),f(x.INFO,"Pago cancelado"),p?.()}catch(s){console.error("Error cancelando pago:",s)}},$=async t=>{try{await navigator.clipboard.writeText(t),r(!0),f(x.SUCCESS,"Enlace copiado"),setTimeout(()=>r(!1),2e3)}catch(s){console.error("Error copiando al portapapeles:",s),f(x.ERROR,"Error copiando enlace")}},L=t=>{const s=Math.floor(t/60),P=t%60;return`${s.toString().padStart(2,"0")}:${P.toString().padStart(2,"0")}`};return v?e.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(X,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Error en el Pago"}),e.jsx("p",{className:"text-gray-600 mb-6",children:v}),e.jsxs("div",{className:"flex justify-center space-x-4",children:[e.jsx("button",{onClick:()=>{w(null),I()},className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors",children:"Reintentar"}),e.jsx("button",{onClick:p,className:"bg-gray-300 text-gray-700 px-6 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancelar"})]})]})}):y?e.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-green-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Generando Código QR"}),e.jsx("p",{className:"text-gray-600",children:"Preparando tu pago con Deuna..."})]})}):T==="completed"?e.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(M,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"¡Pago Completado!"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Tu pago ha sido procesado exitosamente"}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsxs("p",{className:"text-green-800 font-semibold",children:["Monto: $",u.toFixed(2)," USD"]}),e.jsxs("p",{className:"text-green-700",children:["Cliente: ",o]})]})]})}):e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsxs("div",{className:"flex items-center justify-center mb-4",children:[e.jsx(se,{className:"h-8 w-8 text-green-600 mr-2"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Pagar con Deuna"})]}),e.jsx("div",{className:"bg-green-50 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex justify-between text-sm text-green-800",children:[e.jsxs("span",{children:["Cliente: ",o]}),e.jsxs("span",{children:["Monto: $",u.toFixed(2)," USD"]})]})}),e.jsxs("div",{className:"flex items-center justify-center text-orange-600 mb-4",children:[e.jsx(z,{className:"h-5 w-5 mr-2"}),e.jsx("span",{className:"font-mono text-lg font-bold",children:L(R)})]})]}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"bg-white border-2 border-gray-200 rounded-lg p-4 inline-block mb-4",children:i?.qr_code_base64?e.jsx("img",{src:i.qr_code_base64,alt:"Código QR de pago",className:"w-48 h-48"}):e.jsx("div",{className:"w-48 h-48 bg-gray-100 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500",children:"Generando QR..."})})}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Escanea el código QR con tu aplicación bancaria móvil"})]}),i?.payment_url&&e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsx("button",{onClick:()=>$(i.payment_url),className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center",children:d?e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"h-5 w-5 mr-2"}),"¡Copiado!"]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"h-5 w-5 mr-2"}),"Copiar Enlace de Pago"]})}),e.jsxs("button",{onClick:()=>window.open(i.payment_url,"_blank"),className:"w-full bg-green-600 text-white py-3 px-4 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center",children:[e.jsx(re,{className:"h-5 w-5 mr-2"}),"Abrir en Móvil"]})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-4",children:e.jsx("div",{className:"flex items-center",children:j?e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"h-5 w-5 text-yellow-600 mr-3 animate-spin"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-yellow-800",children:"Esperando Pago"}),e.jsx("p",{className:"text-yellow-700 text-sm",children:"Verifica tu app móvil para completar el pago"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"h-5 w-5 text-yellow-600 mr-3"}),e.jsx("p",{className:"font-semibold text-yellow-800",children:"Pago Inactivo"})]})})}),!1,e.jsx("div",{className:"text-center",children:e.jsx("button",{onClick:()=>F("Usuario canceló"),className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 transition-colors",children:"Cancelar Pago"})})]})},he=()=>{const{linkCode:h}=ie(),u=de(),{showToast:o}=G(),[a,S]=n.useState(null),[C,p]=n.useState(!0),[f,y]=n.useState(null),[l,i]=n.useState(!1),[D,v]=n.useState(!1),[w,j]=n.useState(!1),[E,T]=n.useState(null),[g,R]=n.useState({given_name:"",surname:"",identification:"",middle_name:"",email:"",phone:"",address:"",city:"",postal_code:""}),[c,d]=n.useState(!1);n.useEffect(()=>{if(!h){u("/");return}r()},[h]);const r=async()=>{try{p(!0);const s=await A.get(B.EXTERNAL_PAYMENT.PUBLIC.SHOW(h));s.success&&s.data?(S(s.data),y(null)):y(s.message||"Link de pago no encontrado")}catch(s){console.error("Error loading payment link:",s),s.response?.status===404?y("Link de pago no encontrado"):s.response?.data?.error_code==="LINK_EXPIRED"?y("Este link de pago ha expirado"):s.response?.data?.error_code==="LINK_NOT_AVAILABLE"?y("Este link de pago ya no está disponible"):y(s.response?.data?.message||"Error cargando información del pago")}finally{p(!1)}},b=()=>{const{given_name:s,surname:P,identification:N,email:_,phone:k,address:U,city:O}=g,V=s.trim()!==""&&P.trim()!==""&&N.trim()!==""&&/^\d{10}$/.test(N)&&_.trim()!==""&&k.trim()!==""&&U.trim()!==""&&O.trim()!==""&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(_);return d(V),V},m=(s,P)=>{const N={...g,[s]:P};R(N),setTimeout(()=>{const{given_name:_,surname:k,identification:U,email:O,phone:V,address:J,city:Z}=N,ee=_.trim()!==""&&k.trim()!==""&&U.trim()!==""&&/^\d{10}$/.test(U)&&O.trim()!==""&&V.trim()!==""&&J.trim()!==""&&Z.trim()!==""&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(O);d(ee)},100)},I=async s=>{if(!(!a||!h)){if(!b()){o(x.ERROR,"Por favor completa todos los campos obligatorios");return}try{i(!0);const P=s==="datafast"?B.EXTERNAL_PAYMENT.PUBLIC.DATAFAST(h):B.EXTERNAL_PAYMENT.PUBLIC.DEUNA(h),N=await A.post(P,g);if(N.success&&N.data){const _=N.data.checkout_id||N.data.order_id||`external_${h}_${Date.now()}`;if(localStorage.setItem("datafast_transaction_id",_),console.log("🔧 Transaction ID guardado para external payment:",_),s==="datafast"){const k=N.data.widget_url||N.data.redirect_url;k?(T(k),v(!0)):o(x.ERROR,"Error: No se recibió URL del widget")}else j(!0)}else o(x.ERROR,N.message||"Error iniciando el pago")}catch(P){console.error("Error initiating payment:",P),o(P.response?.data?.message||"Error procesando el pago",x.ERROR)}finally{i(!1)}}},Q=s=>new Date(s).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),W=s=>new Date(s)<new Date;if(C)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Cargando información del pago..."})]})});if(f)return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8 text-center",children:[e.jsx(X,{className:"h-16 w-16 text-red-500 mx-auto mb-4"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Error"}),e.jsx("p",{className:"text-gray-600 mb-6",children:f}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:r,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors",children:"Reintentar"}),e.jsx("button",{onClick:()=>u("/"),className:"w-full bg-gray-200 text-gray-800 py-2 px-4 rounded-lg hover:bg-gray-300 transition-colors",children:"Ir al inicio"})]})]})});const F=s=>{console.log("✅ Pago completado:",s),o(x.SUCCESS,"¡Pago procesado exitosamente!")},$=s=>{console.error("❌ Error en pago:",s),o(x.ERROR,`Error: ${s}`),v(!1),j(!1)},L=()=>{v(!1),j(!1),o(x.INFO,"Pago cancelado")};if(!a)return null;const t=W(a.expires_at);return D&&E?e.jsx("div",{className:"min-h-screen bg-gray-50 py-8 px-4",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsx(me,{widgetUrl:E,amount:a.amount,customerName:a.customer_name,onSuccess:F,onError:$,onCancel:L})})}):w?e.jsx("div",{className:"min-h-screen bg-gray-50 py-8 px-4",children:e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsx(ue,{linkCode:h,amount:a.amount,customerName:a.customer_name,customerData:g,onSuccess:F,onError:$,onCancel:L})})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8 px-4",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"bg-white rounded-full p-4 w-20 h-20 mx-auto mb-4 shadow-sm",children:e.jsx(q,{className:"h-12 w-12 text-blue-600 mx-auto"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Realizar Pago"}),e.jsx("p",{className:"text-gray-600",children:"Procesa tu pago de forma segura"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Detalles del Pago"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(oe,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsx("span",{className:"text-gray-600",children:"Para:"})]}),e.jsx("span",{className:"font-medium text-gray-900",children:a.customer_name})]}),e.jsxs("div",{className:"flex items-center justify-between py-3 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ne,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsx("span",{className:"text-gray-600",children:"Monto:"})]}),e.jsxs("span",{className:"text-2xl font-bold text-green-600",children:["$",a.amount.toFixed(2)," USD"]})]}),a.description&&e.jsxs("div",{className:"flex items-start justify-between py-3 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(le,{className:"h-5 w-5 text-gray-400 mr-3 mt-0.5"}),e.jsx("span",{className:"text-gray-600",children:"Concepto:"})]}),e.jsx("span",{className:"font-medium text-gray-900 text-right max-w-xs",children:a.description})]}),e.jsxs("div",{className:"flex items-center justify-between py-3",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{className:"h-5 w-5 text-gray-400 mr-3"}),e.jsx("span",{className:"text-gray-600",children:"Válido hasta:"})]}),e.jsx("span",{className:`font-medium ${t?"text-red-600":"text-gray-900"}`,children:Q(a.expires_at)})]})]})]}),t?e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 mb-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{className:"h-8 w-8 text-red-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-red-800",children:"Link Expirado"}),e.jsx("p",{className:"text-red-600",children:"Este link de pago ha expirado y ya no está disponible."})]})]})}):a.status!=="pending"?e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6 mb-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{className:"h-8 w-8 text-gray-600 mr-3"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Pago No Disponible"}),e.jsx("p",{className:"text-gray-600",children:"Este link de pago ya no está disponible para procesar."})]})]})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Tus Datos"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Por favor completa los siguientes datos para procesar tu pago de forma segura."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"given_name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre *"}),e.jsx("input",{type:"text",id:"given_name",required:!0,value:g.given_name,onChange:s=>m("given_name",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Juan"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"surname",className:"block text-sm font-medium text-gray-700 mb-2",children:"Apellido *"}),e.jsx("input",{type:"text",id:"surname",required:!0,value:g.surname,onChange:s=>m("surname",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Pérez"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"middle_name",className:"block text-sm font-medium text-gray-700 mb-2",children:"Segundo Nombre (opcional)"}),e.jsx("input",{type:"text",id:"middle_name",value:g.middle_name||"",onChange:s=>m("middle_name",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Carlos"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"identification",className:"block text-sm font-medium text-gray-700 mb-2",children:"Cédula * (10 dígitos)"}),e.jsx("input",{type:"text",id:"identification",required:!0,pattern:"[0-9]{10}",maxLength:10,value:g.identification,onChange:s=>m("identification",s.target.value.replace(/\D/g,"")),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"1234567890"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Ingresa tu número de cédula de 10 dígitos"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),e.jsx("input",{type:"email",id:"email",required:!0,value:g.email,onChange:s=>m("email",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"tu@email.com"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-2",children:"Teléfono *"}),e.jsx("input",{type:"tel",id:"phone",required:!0,pattern:"[0-9+\\s()-]+",value:g.phone,onChange:s=>m("phone",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"0987654321"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"address",className:"block text-sm font-medium text-gray-700 mb-2",children:"Dirección *"}),e.jsx("input",{type:"text",id:"address",required:!0,value:g.address,onChange:s=>m("address",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Av. Principal 123, Sector Norte"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"city",className:"block text-sm font-medium text-gray-700 mb-2",children:"Ciudad *"}),e.jsx("input",{type:"text",id:"city",required:!0,value:g.city,onChange:s=>m("city",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Quito"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"postal_code",className:"block text-sm font-medium text-gray-700 mb-2",children:"Código Postal (opcional)"}),e.jsx("input",{type:"text",id:"postal_code",pattern:"[0-9A-Za-z\\-\\s]+",value:g.postal_code,onChange:s=>m("postal_code",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"170135"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Selecciona tu método de pago"}),!c&&e.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(H,{className:"h-5 w-5 text-amber-600 mr-3"}),e.jsx("p",{className:"text-amber-800 text-sm",children:"Por favor completa todos los campos de datos personales para habilitar los métodos de pago."})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("button",{onClick:()=>I("datafast"),disabled:l||!c,className:"w-full bg-blue-600 text-white p-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:[l?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-3"}):e.jsx(q,{className:"h-5 w-5 mr-3"}),e.jsx("span",{className:"font-medium",children:"Pagar con Datafast"})]}),e.jsxs("button",{onClick:()=>I("deuna"),disabled:l||!c,className:"w-full bg-green-600 text-white p-4 rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:[l?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-3"}):e.jsx(q,{className:"h-5 w-5 mr-3"}),e.jsx("span",{className:"font-medium",children:"Pagar con Deuna"})]})]})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(M,{className:"h-5 w-5 text-blue-600 mr-3 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"Pago Seguro"}),e.jsx("p",{className:"text-sm text-blue-600 mt-1",children:"Tus datos están protegidos con encriptación SSL. Nunca almacenamos información de tarjetas de crédito."})]})]})})]}),e.jsx("div",{className:"text-center mt-8 text-sm text-gray-500",children:e.jsx("p",{children:"¿Tienes problemas con tu pago? Contacta al emisor de este link"})})]})})};export{he as default};
//# sourceMappingURL=PaymentPage-BeuQJhA9.js.map
