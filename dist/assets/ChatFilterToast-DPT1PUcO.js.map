{"version":3,"file":"ChatFilterToast-DPT1PUcO.js","sources":["../../node_modules/lucide-react/dist/esm/icons/circle.js","../../node_modules/lucide-react/dist/esm/icons/smile.js","../../node_modules/lucide-react/dist/esm/icons/wifi-off.js","../../node_modules/lucide-react/dist/esm/icons/wifi.js","../../node_modules/date-fns/constants.js","../../node_modules/date-fns/constructFrom.js","../../node_modules/date-fns/toDate.js","../../node_modules/date-fns/_lib/defaultOptions.js","../../node_modules/date-fns/_lib/getTimezoneOffsetInMilliseconds.js","../../node_modules/date-fns/_lib/normalizeDates.js","../../node_modules/date-fns/compareAsc.js","../../node_modules/date-fns/constructNow.js","../../node_modules/date-fns/differenceInCalendarMonths.js","../../node_modules/date-fns/_lib/getRoundingMethod.js","../../node_modules/date-fns/differenceInMilliseconds.js","../../node_modules/date-fns/endOfDay.js","../../node_modules/date-fns/endOfMonth.js","../../node_modules/date-fns/isLastDayOfMonth.js","../../node_modules/date-fns/differenceInMonths.js","../../node_modules/date-fns/differenceInSeconds.js","../../node_modules/date-fns/locale/en-US/_lib/formatDistance.js","../../node_modules/date-fns/locale/_lib/buildFormatLongFn.js","../../node_modules/date-fns/locale/en-US/_lib/formatLong.js","../../node_modules/date-fns/locale/en-US/_lib/formatRelative.js","../../node_modules/date-fns/locale/_lib/buildLocalizeFn.js","../../node_modules/date-fns/locale/en-US/_lib/localize.js","../../node_modules/date-fns/locale/_lib/buildMatchFn.js","../../node_modules/date-fns/locale/_lib/buildMatchPatternFn.js","../../node_modules/date-fns/locale/en-US/_lib/match.js","../../node_modules/date-fns/locale/en-US.js","../../node_modules/date-fns/formatDistance.js","../../node_modules/date-fns/formatDistanceToNow.js","../../node_modules/date-fns/locale/es/_lib/formatDistance.js","../../node_modules/date-fns/locale/es/_lib/formatLong.js","../../node_modules/date-fns/locale/es/_lib/formatRelative.js","../../node_modules/date-fns/locale/es/_lib/localize.js","../../node_modules/date-fns/locale/es/_lib/match.js","../../node_modules/date-fns/locale/es.js","../../src/presentation/components/chat/ChatList.tsx","../../src/presentation/components/chat/ChatMessages.tsx","../../src/presentation/hooks/useRealTimeChat.ts","../../src/presentation/components/chat/ChatHeader.tsx","../../src/presentation/components/chat/MessageForm.tsx","../../src/presentation/components/notifications/ChatFilterToast.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.484.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [[\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }]];\nconst Circle = createLucideIcon(\"circle\", __iconNode);\n\nexport { __iconNode, Circle as default };\n//# sourceMappingURL=circle.js.map\n","/**\n * @license lucide-react v0.484.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"path\", { d: \"M8 14s1.5 2 4 2 4-2 4-2\", key: \"1y1vjs\" }],\n  [\"line\", { x1: \"9\", x2: \"9.01\", y1: \"9\", y2: \"9\", key: \"yxxnd0\" }],\n  [\"line\", { x1: \"15\", x2: \"15.01\", y1: \"9\", y2: \"9\", key: \"1p4y9e\" }]\n];\nconst Smile = createLucideIcon(\"smile\", __iconNode);\n\nexport { __iconNode, Smile as default };\n//# sourceMappingURL=smile.js.map\n","/**\n * @license lucide-react v0.484.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M12 20h.01\", key: \"zekei9\" }],\n  [\"path\", { d: \"M8.5 16.429a5 5 0 0 1 7 0\", key: \"1bycff\" }],\n  [\"path\", { d: \"M5 12.859a10 10 0 0 1 5.17-2.69\", key: \"1dl1wf\" }],\n  [\"path\", { d: \"M19 12.859a10 10 0 0 0-2.007-1.523\", key: \"4k23kn\" }],\n  [\"path\", { d: \"M2 8.82a15 15 0 0 1 4.177-2.643\", key: \"1grhjp\" }],\n  [\"path\", { d: \"M22 8.82a15 15 0 0 0-11.288-3.764\", key: \"z3jwby\" }],\n  [\"path\", { d: \"m2 2 20 20\", key: \"1ooewy\" }]\n];\nconst WifiOff = createLucideIcon(\"wifi-off\", __iconNode);\n\nexport { __iconNode, WifiOff as default };\n//# sourceMappingURL=wifi-off.js.map\n","/**\n * @license lucide-react v0.484.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\"path\", { d: \"M12 20h.01\", key: \"zekei9\" }],\n  [\"path\", { d: \"M2 8.82a15 15 0 0 1 20 0\", key: \"dnpr2z\" }],\n  [\"path\", { d: \"M5 12.859a10 10 0 0 1 14 0\", key: \"1x1e6c\" }],\n  [\"path\", { d: \"M8.5 16.429a5 5 0 0 1 7 0\", key: \"1bycff\" }]\n];\nconst Wifi = createLucideIcon(\"wifi\", __iconNode);\n\nexport { __iconNode, Wifi as default };\n//# sourceMappingURL=wifi.js.map\n","/**\n * @module constants\n * @summary Useful constants\n * @description\n * Collection of useful date constants.\n *\n * The constants could be imported from `date-fns/constants`:\n *\n * ```ts\n * import { maxTime, minTime } from \"./constants/date-fns/constants\";\n *\n * function isAllowedTime(time) {\n *   return time <= maxTime && time >= minTime;\n * }\n * ```\n */\n\n/**\n * @constant\n * @name daysInWeek\n * @summary Days in 1 week.\n */\nexport const daysInWeek = 7;\n\n/**\n * @constant\n * @name daysInYear\n * @summary Days in 1 year.\n *\n * @description\n * How many days in a year.\n *\n * One years equals 365.2425 days according to the formula:\n *\n * > Leap year occurs every 4 years, except for years that are divisible by 100 and not divisible by 400.\n * > 1 mean year = (365+1/4-1/100+1/400) days = 365.2425 days\n */\nexport const daysInYear = 365.2425;\n\n/**\n * @constant\n * @name maxTime\n * @summary Maximum allowed time.\n *\n * @example\n * import { maxTime } from \"./constants/date-fns/constants\";\n *\n * const isValid = 8640000000000001 <= maxTime;\n * //=> false\n *\n * new Date(8640000000000001);\n * //=> Invalid Date\n */\nexport const maxTime = Math.pow(10, 8) * 24 * 60 * 60 * 1000;\n\n/**\n * @constant\n * @name minTime\n * @summary Minimum allowed time.\n *\n * @example\n * import { minTime } from \"./constants/date-fns/constants\";\n *\n * const isValid = -8640000000000001 >= minTime;\n * //=> false\n *\n * new Date(-8640000000000001)\n * //=> Invalid Date\n */\nexport const minTime = -maxTime;\n\n/**\n * @constant\n * @name millisecondsInWeek\n * @summary Milliseconds in 1 week.\n */\nexport const millisecondsInWeek = 604800000;\n\n/**\n * @constant\n * @name millisecondsInDay\n * @summary Milliseconds in 1 day.\n */\nexport const millisecondsInDay = 86400000;\n\n/**\n * @constant\n * @name millisecondsInMinute\n * @summary Milliseconds in 1 minute\n */\nexport const millisecondsInMinute = 60000;\n\n/**\n * @constant\n * @name millisecondsInHour\n * @summary Milliseconds in 1 hour\n */\nexport const millisecondsInHour = 3600000;\n\n/**\n * @constant\n * @name millisecondsInSecond\n * @summary Milliseconds in 1 second\n */\nexport const millisecondsInSecond = 1000;\n\n/**\n * @constant\n * @name minutesInYear\n * @summary Minutes in 1 year.\n */\nexport const minutesInYear = 525600;\n\n/**\n * @constant\n * @name minutesInMonth\n * @summary Minutes in 1 month.\n */\nexport const minutesInMonth = 43200;\n\n/**\n * @constant\n * @name minutesInDay\n * @summary Minutes in 1 day.\n */\nexport const minutesInDay = 1440;\n\n/**\n * @constant\n * @name minutesInHour\n * @summary Minutes in 1 hour.\n */\nexport const minutesInHour = 60;\n\n/**\n * @constant\n * @name monthsInQuarter\n * @summary Months in 1 quarter.\n */\nexport const monthsInQuarter = 3;\n\n/**\n * @constant\n * @name monthsInYear\n * @summary Months in 1 year.\n */\nexport const monthsInYear = 12;\n\n/**\n * @constant\n * @name quartersInYear\n * @summary Quarters in 1 year\n */\nexport const quartersInYear = 4;\n\n/**\n * @constant\n * @name secondsInHour\n * @summary Seconds in 1 hour.\n */\nexport const secondsInHour = 3600;\n\n/**\n * @constant\n * @name secondsInMinute\n * @summary Seconds in 1 minute.\n */\nexport const secondsInMinute = 60;\n\n/**\n * @constant\n * @name secondsInDay\n * @summary Seconds in 1 day.\n */\nexport const secondsInDay = secondsInHour * 24;\n\n/**\n * @constant\n * @name secondsInWeek\n * @summary Seconds in 1 week.\n */\nexport const secondsInWeek = secondsInDay * 7;\n\n/**\n * @constant\n * @name secondsInYear\n * @summary Seconds in 1 year.\n */\nexport const secondsInYear = secondsInDay * daysInYear;\n\n/**\n * @constant\n * @name secondsInMonth\n * @summary Seconds in 1 month\n */\nexport const secondsInMonth = secondsInYear / 12;\n\n/**\n * @constant\n * @name secondsInQuarter\n * @summary Seconds in 1 quarter.\n */\nexport const secondsInQuarter = secondsInMonth * 3;\n\n/**\n * @constant\n * @name constructFromSymbol\n * @summary Symbol enabling Date extensions to inherit properties from the reference date.\n *\n * The symbol is used to enable the `constructFrom` function to construct a date\n * using a reference date and a value. It allows to transfer extra properties\n * from the reference date to the new date. It's useful for extensions like\n * [`TZDate`](https://github.com/date-fns/tz) that accept a time zone as\n * a constructor argument.\n */\nexport const constructFromSymbol = Symbol.for(\"constructDateFrom\");\n","import { constructFromSymbol } from \"./constants.js\";\n\n/**\n * @name constructFrom\n * @category Generic Helpers\n * @summary Constructs a date using the reference date and the value\n *\n * @description\n * The function constructs a new date using the constructor from the reference\n * date and the given value. It helps to build generic functions that accept\n * date extensions.\n *\n * It defaults to `Date` if the passed reference date is a number or a string.\n *\n * Starting from v3.7.0, it allows to construct a date using `[Symbol.for(\"constructDateFrom\")]`\n * enabling to transfer extra properties from the reference date to the new date.\n * It's useful for extensions like [`TZDate`](https://github.com/date-fns/tz)\n * that accept a time zone as a constructor argument.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n *\n * @param date - The reference date to take constructor from\n * @param value - The value to create the date\n *\n * @returns Date initialized using the given date and value\n *\n * @example\n * import { constructFrom } from \"./constructFrom/date-fns\";\n *\n * // A function that clones a date preserving the original type\n * function cloneDate<DateType extends Date>(date: DateType): DateType {\n *   return constructFrom(\n *     date, // Use constructor from the given date\n *     date.getTime() // Use the date value to create a new date\n *   );\n * }\n */\nexport function constructFrom(date, value) {\n  if (typeof date === \"function\") return date(value);\n\n  if (date && typeof date === \"object\" && constructFromSymbol in date)\n    return date[constructFromSymbol](value);\n\n  if (date instanceof Date) return new date.constructor(value);\n\n  return new Date(value);\n}\n\n// Fallback for modularized imports:\nexport default constructFrom;\n","import { constructFrom } from \"./constructFrom.js\";\n\n/**\n * @name toDate\n * @category Common Helpers\n * @summary Convert the given argument to an instance of Date.\n *\n * @description\n * Convert the given argument to an instance of Date.\n *\n * If the argument is an instance of Date, the function returns its clone.\n *\n * If the argument is a number, it is treated as a timestamp.\n *\n * If the argument is none of the above, the function returns Invalid Date.\n *\n * Starting from v3.7.0, it clones a date using `[Symbol.for(\"constructDateFrom\")]`\n * enabling to transfer extra properties from the reference date to the new date.\n * It's useful for extensions like [`TZDate`](https://github.com/date-fns/tz)\n * that accept a time zone as a constructor argument.\n *\n * **Note**: *all* Date arguments passed to any *date-fns* function is processed by `toDate`.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param argument - The value to convert\n *\n * @returns The parsed date in the local time zone\n *\n * @example\n * // Clone the date:\n * const result = toDate(new Date(2014, 1, 11, 11, 30, 30))\n * //=> Tue Feb 11 2014 11:30:30\n *\n * @example\n * // Convert the timestamp to date:\n * const result = toDate(1392098430000)\n * //=> Tue Feb 11 2014 11:30:30\n */\nexport function toDate(argument, context) {\n  // [TODO] Get rid of `toDate` or `constructFrom`?\n  return constructFrom(context || argument, argument);\n}\n\n// Fallback for modularized imports:\nexport default toDate;\n","let defaultOptions = {};\n\nexport function getDefaultOptions() {\n  return defaultOptions;\n}\n\nexport function setDefaultOptions(newOptions) {\n  defaultOptions = newOptions;\n}\n","import { toDate } from \"../toDate.js\";\n\n/**\n * Google Chrome as of 67.0.3396.87 introduced timezones with offset that includes seconds.\n * They usually appear for dates that denote time before the timezones were introduced\n * (e.g. for 'Europe/Prague' timezone the offset is GMT+00:57:44 before 1 October 1891\n * and GMT+01:00:00 after that date)\n *\n * Date#getTimezoneOffset returns the offset in minutes and would return 57 for the example above,\n * which would lead to incorrect calculations.\n *\n * This function returns the timezone offset in milliseconds that takes seconds in account.\n */\nexport function getTimezoneOffsetInMilliseconds(date) {\n  const _date = toDate(date);\n  const utcDate = new Date(\n    Date.UTC(\n      _date.getFullYear(),\n      _date.getMonth(),\n      _date.getDate(),\n      _date.getHours(),\n      _date.getMinutes(),\n      _date.getSeconds(),\n      _date.getMilliseconds(),\n    ),\n  );\n  utcDate.setUTCFullYear(_date.getFullYear());\n  return +date - +utcDate;\n}\n","import { constructFrom } from \"../constructFrom.js\";\n\nexport function normalizeDates(context, ...dates) {\n  const normalize = constructFrom.bind(\n    null,\n    context || dates.find((date) => typeof date === \"object\"),\n  );\n  return dates.map(normalize);\n}\n","import { toDate } from \"./toDate.js\";\n\n/**\n * @name compareAsc\n * @category Common Helpers\n * @summary Compare the two dates and return -1, 0 or 1.\n *\n * @description\n * Compare the two dates and return 1 if the first date is after the second,\n * -1 if the first date is before the second or 0 if dates are equal.\n *\n * @param dateLeft - The first date to compare\n * @param dateRight - The second date to compare\n *\n * @returns The result of the comparison\n *\n * @example\n * // Compare 11 February 1987 and 10 July 1989:\n * const result = compareAsc(new Date(1987, 1, 11), new Date(1989, 6, 10))\n * //=> -1\n *\n * @example\n * // Sort the array of dates:\n * const result = [\n *   new Date(1995, 6, 2),\n *   new Date(1987, 1, 11),\n *   new Date(1989, 6, 10)\n * ].sort(compareAsc)\n * //=> [\n * //   Wed Feb 11 1987 00:00:00,\n * //   Mon Jul 10 1989 00:00:00,\n * //   Sun Jul 02 1995 00:00:00\n * // ]\n */\nexport function compareAsc(dateLeft, dateRight) {\n  const diff = +toDate(dateLeft) - +toDate(dateRight);\n\n  if (diff < 0) return -1;\n  else if (diff > 0) return 1;\n\n  // Return 0 if diff is 0; return NaN if diff is NaN\n  return diff;\n}\n\n// Fallback for modularized imports:\nexport default compareAsc;\n","import { constructFrom } from \"./constructFrom.js\";\n\n/**\n * @name constructNow\n * @category Generic Helpers\n * @summary Constructs a new current date using the passed value constructor.\n * @pure false\n *\n * @description\n * The function constructs a new current date using the constructor from\n * the reference date. It helps to build generic functions that accept date\n * extensions and use the current date.\n *\n * It defaults to `Date` if the passed reference date is a number or a string.\n *\n * @param date - The reference date to take constructor from\n *\n * @returns Current date initialized using the given date constructor\n *\n * @example\n * import { constructNow, isSameDay } from 'date-fns'\n *\n * function isToday<DateType extends Date>(\n *   date: DateArg<DateType>,\n * ): boolean {\n *   // If we were to use `new Date()` directly, the function would  behave\n *   // differently in different timezones and return false for the same date.\n *   return isSameDay(date, constructNow(date));\n * }\n */\nexport function constructNow(date) {\n  return constructFrom(date, Date.now());\n}\n\n// Fallback for modularized imports:\nexport default constructNow;\n","import { normalizeDates } from \"./_lib/normalizeDates.js\";\n\n/**\n * The {@link differenceInCalendarMonths} function options.\n */\n\n/**\n * @name differenceInCalendarMonths\n * @category Month Helpers\n * @summary Get the number of calendar months between the given dates.\n *\n * @description\n * Get the number of calendar months between the given dates.\n *\n * @param laterDate - The later date\n * @param earlierDate - The earlier date\n * @param options - An object with options\n *\n * @returns The number of calendar months\n *\n * @example\n * // How many calendar months are between 31 January 2014 and 1 September 2014?\n * const result = differenceInCalendarMonths(\n *   new Date(2014, 8, 1),\n *   new Date(2014, 0, 31)\n * )\n * //=> 8\n */\nexport function differenceInCalendarMonths(laterDate, earlierDate, options) {\n  const [laterDate_, earlierDate_] = normalizeDates(\n    options?.in,\n    laterDate,\n    earlierDate,\n  );\n\n  const yearsDiff = laterDate_.getFullYear() - earlierDate_.getFullYear();\n  const monthsDiff = laterDate_.getMonth() - earlierDate_.getMonth();\n\n  return yearsDiff * 12 + monthsDiff;\n}\n\n// Fallback for modularized imports:\nexport default differenceInCalendarMonths;\n","export function getRoundingMethod(method) {\n  return (number) => {\n    const round = method ? Math[method] : Math.trunc;\n    const result = round(number);\n    // Prevent negative zero\n    return result === 0 ? 0 : result;\n  };\n}\n","import { toDate } from \"./toDate.js\";\n\n/**\n * @name differenceInMilliseconds\n * @category Millisecond Helpers\n * @summary Get the number of milliseconds between the given dates.\n *\n * @description\n * Get the number of milliseconds between the given dates.\n *\n * @param laterDate - The later date\n * @param earlierDate - The earlier date\n *\n * @returns The number of milliseconds\n *\n * @example\n * // How many milliseconds are between\n * // 2 July 2014 12:30:20.600 and 2 July 2014 12:30:21.700?\n * const result = differenceInMilliseconds(\n *   new Date(2014, 6, 2, 12, 30, 21, 700),\n *   new Date(2014, 6, 2, 12, 30, 20, 600)\n * )\n * //=> 1100\n */\nexport function differenceInMilliseconds(laterDate, earlierDate) {\n  return +toDate(laterDate) - +toDate(earlierDate);\n}\n\n// Fallback for modularized imports:\nexport default differenceInMilliseconds;\n","import { toDate } from \"./toDate.js\";\n\n/**\n * The {@link endOfDay} function options.\n */\n\n/**\n * @name endOfDay\n * @category Day Helpers\n * @summary Return the end of a day for the given date.\n *\n * @description\n * Return the end of a day for the given date.\n * The result will be in the local timezone.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param date - The original date\n * @param options - An object with options\n *\n * @returns The end of a day\n *\n * @example\n * // The end of a day for 2 September 2014 11:55:00:\n * const result = endOfDay(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Tue Sep 02 2014 23:59:59.999\n */\nexport function endOfDay(date, options) {\n  const _date = toDate(date, options?.in);\n  _date.setHours(23, 59, 59, 999);\n  return _date;\n}\n\n// Fallback for modularized imports:\nexport default endOfDay;\n","import { toDate } from \"./toDate.js\";\n\n/**\n * The {@link endOfMonth} function options.\n */\n\n/**\n * @name endOfMonth\n * @category Month Helpers\n * @summary Return the end of a month for the given date.\n *\n * @description\n * Return the end of a month for the given date.\n * The result will be in the local timezone.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param date - The original date\n * @param options - An object with options\n *\n * @returns The end of a month\n *\n * @example\n * // The end of a month for 2 September 2014 11:55:00:\n * const result = endOfMonth(new Date(2014, 8, 2, 11, 55, 0))\n * //=> Tue Sep 30 2014 23:59:59.999\n */\nexport function endOfMonth(date, options) {\n  const _date = toDate(date, options?.in);\n  const month = _date.getMonth();\n  _date.setFullYear(_date.getFullYear(), month + 1, 0);\n  _date.setHours(23, 59, 59, 999);\n  return _date;\n}\n\n// Fallback for modularized imports:\nexport default endOfMonth;\n","import { endOfDay } from \"./endOfDay.js\";\nimport { endOfMonth } from \"./endOfMonth.js\";\nimport { toDate } from \"./toDate.js\";\n\n/**\n * @name isLastDayOfMonth\n * @category Month Helpers\n * @summary Is the given date the last day of a month?\n *\n * @description\n * Is the given date the last day of a month?\n *\n * @param date - The date to check\n * @param options - An object with options\n *\n * @returns The date is the last day of a month\n *\n * @example\n * // Is 28 February 2014 the last day of a month?\n * const result = isLastDayOfMonth(new Date(2014, 1, 28))\n * //=> true\n */\nexport function isLastDayOfMonth(date, options) {\n  const _date = toDate(date, options?.in);\n  return +endOfDay(_date, options) === +endOfMonth(_date, options);\n}\n\n// Fallback for modularized imports:\nexport default isLastDayOfMonth;\n","import { normalizeDates } from \"./_lib/normalizeDates.js\";\nimport { compareAsc } from \"./compareAsc.js\";\nimport { differenceInCalendarMonths } from \"./differenceInCalendarMonths.js\";\nimport { isLastDayOfMonth } from \"./isLastDayOfMonth.js\";\n\n/**\n * The {@link differenceInMonths} function options.\n */\n\n/**\n * @name differenceInMonths\n * @category Month Helpers\n * @summary Get the number of full months between the given dates.\n *\n * @param laterDate - The later date\n * @param earlierDate - The earlier date\n * @param options - An object with options\n *\n * @returns The number of full months\n *\n * @example\n * // How many full months are between 31 January 2014 and 1 September 2014?\n * const result = differenceInMonths(new Date(2014, 8, 1), new Date(2014, 0, 31))\n * //=> 7\n */\nexport function differenceInMonths(laterDate, earlierDate, options) {\n  const [laterDate_, workingLaterDate, earlierDate_] = normalizeDates(\n    options?.in,\n    laterDate,\n    laterDate,\n    earlierDate,\n  );\n\n  const sign = compareAsc(workingLaterDate, earlierDate_);\n  const difference = Math.abs(\n    differenceInCalendarMonths(workingLaterDate, earlierDate_),\n  );\n\n  if (difference < 1) return 0;\n\n  if (workingLaterDate.getMonth() === 1 && workingLaterDate.getDate() > 27)\n    workingLaterDate.setDate(30);\n\n  workingLaterDate.setMonth(workingLaterDate.getMonth() - sign * difference);\n\n  let isLastMonthNotFull = compareAsc(workingLaterDate, earlierDate_) === -sign;\n\n  if (\n    isLastDayOfMonth(laterDate_) &&\n    difference === 1 &&\n    compareAsc(laterDate_, earlierDate_) === 1\n  ) {\n    isLastMonthNotFull = false;\n  }\n\n  const result = sign * (difference - +isLastMonthNotFull);\n  return result === 0 ? 0 : result;\n}\n\n// Fallback for modularized imports:\nexport default differenceInMonths;\n","import { getRoundingMethod } from \"./_lib/getRoundingMethod.js\";\nimport { differenceInMilliseconds } from \"./differenceInMilliseconds.js\";\n\n/**\n * The {@link differenceInSeconds} function options.\n */\n\n/**\n * @name differenceInSeconds\n * @category Second Helpers\n * @summary Get the number of seconds between the given dates.\n *\n * @description\n * Get the number of seconds between the given dates.\n *\n * @param laterDate - The later date\n * @param earlierDate - The earlier date\n * @param options - An object with options.\n *\n * @returns The number of seconds\n *\n * @example\n * // How many seconds are between\n * // 2 July 2014 12:30:07.999 and 2 July 2014 12:30:20.000?\n * const result = differenceInSeconds(\n *   new Date(2014, 6, 2, 12, 30, 20, 0),\n *   new Date(2014, 6, 2, 12, 30, 7, 999)\n * )\n * //=> 12\n */\nexport function differenceInSeconds(laterDate, earlierDate, options) {\n  const diff = differenceInMilliseconds(laterDate, earlierDate) / 1000;\n  return getRoundingMethod(options?.roundingMethod)(diff);\n}\n\n// Fallback for modularized imports:\nexport default differenceInSeconds;\n","const formatDistanceLocale = {\n  lessThanXSeconds: {\n    one: \"less than a second\",\n    other: \"less than {{count}} seconds\",\n  },\n\n  xSeconds: {\n    one: \"1 second\",\n    other: \"{{count}} seconds\",\n  },\n\n  halfAMinute: \"half a minute\",\n\n  lessThanXMinutes: {\n    one: \"less than a minute\",\n    other: \"less than {{count}} minutes\",\n  },\n\n  xMinutes: {\n    one: \"1 minute\",\n    other: \"{{count}} minutes\",\n  },\n\n  aboutXHours: {\n    one: \"about 1 hour\",\n    other: \"about {{count}} hours\",\n  },\n\n  xHours: {\n    one: \"1 hour\",\n    other: \"{{count}} hours\",\n  },\n\n  xDays: {\n    one: \"1 day\",\n    other: \"{{count}} days\",\n  },\n\n  aboutXWeeks: {\n    one: \"about 1 week\",\n    other: \"about {{count}} weeks\",\n  },\n\n  xWeeks: {\n    one: \"1 week\",\n    other: \"{{count}} weeks\",\n  },\n\n  aboutXMonths: {\n    one: \"about 1 month\",\n    other: \"about {{count}} months\",\n  },\n\n  xMonths: {\n    one: \"1 month\",\n    other: \"{{count}} months\",\n  },\n\n  aboutXYears: {\n    one: \"about 1 year\",\n    other: \"about {{count}} years\",\n  },\n\n  xYears: {\n    one: \"1 year\",\n    other: \"{{count}} years\",\n  },\n\n  overXYears: {\n    one: \"over 1 year\",\n    other: \"over {{count}} years\",\n  },\n\n  almostXYears: {\n    one: \"almost 1 year\",\n    other: \"almost {{count}} years\",\n  },\n};\n\nexport const formatDistance = (token, count, options) => {\n  let result;\n\n  const tokenValue = formatDistanceLocale[token];\n  if (typeof tokenValue === \"string\") {\n    result = tokenValue;\n  } else if (count === 1) {\n    result = tokenValue.one;\n  } else {\n    result = tokenValue.other.replace(\"{{count}}\", count.toString());\n  }\n\n  if (options?.addSuffix) {\n    if (options.comparison && options.comparison > 0) {\n      return \"in \" + result;\n    } else {\n      return result + \" ago\";\n    }\n  }\n\n  return result;\n};\n","export function buildFormatLongFn(args) {\n  return (options = {}) => {\n    // TODO: Remove String()\n    const width = options.width ? String(options.width) : args.defaultWidth;\n    const format = args.formats[width] || args.formats[args.defaultWidth];\n    return format;\n  };\n}\n","import { buildFormatLongFn } from \"../../_lib/buildFormatLongFn.js\";\n\nconst dateFormats = {\n  full: \"EEEE, MMMM do, y\",\n  long: \"MMMM do, y\",\n  medium: \"MMM d, y\",\n  short: \"MM/dd/yyyy\",\n};\n\nconst timeFormats = {\n  full: \"h:mm:ss a zzzz\",\n  long: \"h:mm:ss a z\",\n  medium: \"h:mm:ss a\",\n  short: \"h:mm a\",\n};\n\nconst dateTimeFormats = {\n  full: \"{{date}} 'at' {{time}}\",\n  long: \"{{date}} 'at' {{time}}\",\n  medium: \"{{date}}, {{time}}\",\n  short: \"{{date}}, {{time}}\",\n};\n\nexport const formatLong = {\n  date: buildFormatLongFn({\n    formats: dateFormats,\n    defaultWidth: \"full\",\n  }),\n\n  time: buildFormatLongFn({\n    formats: timeFormats,\n    defaultWidth: \"full\",\n  }),\n\n  dateTime: buildFormatLongFn({\n    formats: dateTimeFormats,\n    defaultWidth: \"full\",\n  }),\n};\n","const formatRelativeLocale = {\n  lastWeek: \"'last' eeee 'at' p\",\n  yesterday: \"'yesterday at' p\",\n  today: \"'today at' p\",\n  tomorrow: \"'tomorrow at' p\",\n  nextWeek: \"eeee 'at' p\",\n  other: \"P\",\n};\n\nexport const formatRelative = (token, _date, _baseDate, _options) =>\n  formatRelativeLocale[token];\n","/**\n * The localize function argument callback which allows to convert raw value to\n * the actual type.\n *\n * @param value - The value to convert\n *\n * @returns The converted value\n */\n\n/**\n * The map of localized values for each width.\n */\n\n/**\n * The index type of the locale unit value. It types conversion of units of\n * values that don't start at 0 (i.e. quarters).\n */\n\n/**\n * Converts the unit value to the tuple of values.\n */\n\n/**\n * The tuple of localized era values. The first element represents BC,\n * the second element represents AD.\n */\n\n/**\n * The tuple of localized quarter values. The first element represents Q1.\n */\n\n/**\n * The tuple of localized day values. The first element represents Sunday.\n */\n\n/**\n * The tuple of localized month values. The first element represents January.\n */\n\nexport function buildLocalizeFn(args) {\n  return (value, options) => {\n    const context = options?.context ? String(options.context) : \"standalone\";\n\n    let valuesArray;\n    if (context === \"formatting\" && args.formattingValues) {\n      const defaultWidth = args.defaultFormattingWidth || args.defaultWidth;\n      const width = options?.width ? String(options.width) : defaultWidth;\n\n      valuesArray =\n        args.formattingValues[width] || args.formattingValues[defaultWidth];\n    } else {\n      const defaultWidth = args.defaultWidth;\n      const width = options?.width ? String(options.width) : args.defaultWidth;\n\n      valuesArray = args.values[width] || args.values[defaultWidth];\n    }\n    const index = args.argumentCallback ? args.argumentCallback(value) : value;\n\n    // @ts-expect-error - For some reason TypeScript just don't want to match it, no matter how hard we try. I challenge you to try to remove it!\n    return valuesArray[index];\n  };\n}\n","import { buildLocalizeFn } from \"../../_lib/buildLocalizeFn.js\";\n\nconst eraValues = {\n  narrow: [\"B\", \"A\"],\n  abbreviated: [\"BC\", \"AD\"],\n  wide: [\"Before Christ\", \"Anno Domini\"],\n};\n\nconst quarterValues = {\n  narrow: [\"1\", \"2\", \"3\", \"4\"],\n  abbreviated: [\"Q1\", \"Q2\", \"Q3\", \"Q4\"],\n  wide: [\"1st quarter\", \"2nd quarter\", \"3rd quarter\", \"4th quarter\"],\n};\n\n// Note: in English, the names of days of the week and months are capitalized.\n// If you are making a new locale based on this one, check if the same is true for the language you're working on.\n// Generally, formatted dates should look like they are in the middle of a sentence,\n// e.g. in Spanish language the weekdays and months should be in the lowercase.\nconst monthValues = {\n  narrow: [\"J\", \"F\", \"M\", \"A\", \"M\", \"J\", \"J\", \"A\", \"S\", \"O\", \"N\", \"D\"],\n  abbreviated: [\n    \"Jan\",\n    \"Feb\",\n    \"Mar\",\n    \"Apr\",\n    \"May\",\n    \"Jun\",\n    \"Jul\",\n    \"Aug\",\n    \"Sep\",\n    \"Oct\",\n    \"Nov\",\n    \"Dec\",\n  ],\n\n  wide: [\n    \"January\",\n    \"February\",\n    \"March\",\n    \"April\",\n    \"May\",\n    \"June\",\n    \"July\",\n    \"August\",\n    \"September\",\n    \"October\",\n    \"November\",\n    \"December\",\n  ],\n};\n\nconst dayValues = {\n  narrow: [\"S\", \"M\", \"T\", \"W\", \"T\", \"F\", \"S\"],\n  short: [\"Su\", \"Mo\", \"Tu\", \"We\", \"Th\", \"Fr\", \"Sa\"],\n  abbreviated: [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"],\n  wide: [\n    \"Sunday\",\n    \"Monday\",\n    \"Tuesday\",\n    \"Wednesday\",\n    \"Thursday\",\n    \"Friday\",\n    \"Saturday\",\n  ],\n};\n\nconst dayPeriodValues = {\n  narrow: {\n    am: \"a\",\n    pm: \"p\",\n    midnight: \"mi\",\n    noon: \"n\",\n    morning: \"morning\",\n    afternoon: \"afternoon\",\n    evening: \"evening\",\n    night: \"night\",\n  },\n  abbreviated: {\n    am: \"AM\",\n    pm: \"PM\",\n    midnight: \"midnight\",\n    noon: \"noon\",\n    morning: \"morning\",\n    afternoon: \"afternoon\",\n    evening: \"evening\",\n    night: \"night\",\n  },\n  wide: {\n    am: \"a.m.\",\n    pm: \"p.m.\",\n    midnight: \"midnight\",\n    noon: \"noon\",\n    morning: \"morning\",\n    afternoon: \"afternoon\",\n    evening: \"evening\",\n    night: \"night\",\n  },\n};\n\nconst formattingDayPeriodValues = {\n  narrow: {\n    am: \"a\",\n    pm: \"p\",\n    midnight: \"mi\",\n    noon: \"n\",\n    morning: \"in the morning\",\n    afternoon: \"in the afternoon\",\n    evening: \"in the evening\",\n    night: \"at night\",\n  },\n  abbreviated: {\n    am: \"AM\",\n    pm: \"PM\",\n    midnight: \"midnight\",\n    noon: \"noon\",\n    morning: \"in the morning\",\n    afternoon: \"in the afternoon\",\n    evening: \"in the evening\",\n    night: \"at night\",\n  },\n  wide: {\n    am: \"a.m.\",\n    pm: \"p.m.\",\n    midnight: \"midnight\",\n    noon: \"noon\",\n    morning: \"in the morning\",\n    afternoon: \"in the afternoon\",\n    evening: \"in the evening\",\n    night: \"at night\",\n  },\n};\n\nconst ordinalNumber = (dirtyNumber, _options) => {\n  const number = Number(dirtyNumber);\n\n  // If ordinal numbers depend on context, for example,\n  // if they are different for different grammatical genders,\n  // use `options.unit`.\n  //\n  // `unit` can be 'year', 'quarter', 'month', 'week', 'date', 'dayOfYear',\n  // 'day', 'hour', 'minute', 'second'.\n\n  const rem100 = number % 100;\n  if (rem100 > 20 || rem100 < 10) {\n    switch (rem100 % 10) {\n      case 1:\n        return number + \"st\";\n      case 2:\n        return number + \"nd\";\n      case 3:\n        return number + \"rd\";\n    }\n  }\n  return number + \"th\";\n};\n\nexport const localize = {\n  ordinalNumber,\n\n  era: buildLocalizeFn({\n    values: eraValues,\n    defaultWidth: \"wide\",\n  }),\n\n  quarter: buildLocalizeFn({\n    values: quarterValues,\n    defaultWidth: \"wide\",\n    argumentCallback: (quarter) => quarter - 1,\n  }),\n\n  month: buildLocalizeFn({\n    values: monthValues,\n    defaultWidth: \"wide\",\n  }),\n\n  day: buildLocalizeFn({\n    values: dayValues,\n    defaultWidth: \"wide\",\n  }),\n\n  dayPeriod: buildLocalizeFn({\n    values: dayPeriodValues,\n    defaultWidth: \"wide\",\n    formattingValues: formattingDayPeriodValues,\n    defaultFormattingWidth: \"wide\",\n  }),\n};\n","export function buildMatchFn(args) {\n  return (string, options = {}) => {\n    const width = options.width;\n\n    const matchPattern =\n      (width && args.matchPatterns[width]) ||\n      args.matchPatterns[args.defaultMatchWidth];\n    const matchResult = string.match(matchPattern);\n\n    if (!matchResult) {\n      return null;\n    }\n    const matchedString = matchResult[0];\n\n    const parsePatterns =\n      (width && args.parsePatterns[width]) ||\n      args.parsePatterns[args.defaultParseWidth];\n\n    const key = Array.isArray(parsePatterns)\n      ? findIndex(parsePatterns, (pattern) => pattern.test(matchedString))\n      : // [TODO] -- I challenge you to fix the type\n        findKey(parsePatterns, (pattern) => pattern.test(matchedString));\n\n    let value;\n\n    value = args.valueCallback ? args.valueCallback(key) : key;\n    value = options.valueCallback\n      ? // [TODO] -- I challenge you to fix the type\n        options.valueCallback(value)\n      : value;\n\n    const rest = string.slice(matchedString.length);\n\n    return { value, rest };\n  };\n}\n\nfunction findKey(object, predicate) {\n  for (const key in object) {\n    if (\n      Object.prototype.hasOwnProperty.call(object, key) &&\n      predicate(object[key])\n    ) {\n      return key;\n    }\n  }\n  return undefined;\n}\n\nfunction findIndex(array, predicate) {\n  for (let key = 0; key < array.length; key++) {\n    if (predicate(array[key])) {\n      return key;\n    }\n  }\n  return undefined;\n}\n","export function buildMatchPatternFn(args) {\n  return (string, options = {}) => {\n    const matchResult = string.match(args.matchPattern);\n    if (!matchResult) return null;\n    const matchedString = matchResult[0];\n\n    const parseResult = string.match(args.parsePattern);\n    if (!parseResult) return null;\n    let value = args.valueCallback\n      ? args.valueCallback(parseResult[0])\n      : parseResult[0];\n\n    // [TODO] I challenge you to fix the type\n    value = options.valueCallback ? options.valueCallback(value) : value;\n\n    const rest = string.slice(matchedString.length);\n\n    return { value, rest };\n  };\n}\n","import { buildMatchFn } from \"../../_lib/buildMatchFn.js\";\nimport { buildMatchPatternFn } from \"../../_lib/buildMatchPatternFn.js\";\n\nconst matchOrdinalNumberPattern = /^(\\d+)(th|st|nd|rd)?/i;\nconst parseOrdinalNumberPattern = /\\d+/i;\n\nconst matchEraPatterns = {\n  narrow: /^(b|a)/i,\n  abbreviated: /^(b\\.?\\s?c\\.?|b\\.?\\s?c\\.?\\s?e\\.?|a\\.?\\s?d\\.?|c\\.?\\s?e\\.?)/i,\n  wide: /^(before christ|before common era|anno domini|common era)/i,\n};\nconst parseEraPatterns = {\n  any: [/^b/i, /^(a|c)/i],\n};\n\nconst matchQuarterPatterns = {\n  narrow: /^[1234]/i,\n  abbreviated: /^q[1234]/i,\n  wide: /^[1234](th|st|nd|rd)? quarter/i,\n};\nconst parseQuarterPatterns = {\n  any: [/1/i, /2/i, /3/i, /4/i],\n};\n\nconst matchMonthPatterns = {\n  narrow: /^[jfmasond]/i,\n  abbreviated: /^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,\n  wide: /^(january|february|march|april|may|june|july|august|september|october|november|december)/i,\n};\nconst parseMonthPatterns = {\n  narrow: [\n    /^j/i,\n    /^f/i,\n    /^m/i,\n    /^a/i,\n    /^m/i,\n    /^j/i,\n    /^j/i,\n    /^a/i,\n    /^s/i,\n    /^o/i,\n    /^n/i,\n    /^d/i,\n  ],\n\n  any: [\n    /^ja/i,\n    /^f/i,\n    /^mar/i,\n    /^ap/i,\n    /^may/i,\n    /^jun/i,\n    /^jul/i,\n    /^au/i,\n    /^s/i,\n    /^o/i,\n    /^n/i,\n    /^d/i,\n  ],\n};\n\nconst matchDayPatterns = {\n  narrow: /^[smtwf]/i,\n  short: /^(su|mo|tu|we|th|fr|sa)/i,\n  abbreviated: /^(sun|mon|tue|wed|thu|fri|sat)/i,\n  wide: /^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i,\n};\nconst parseDayPatterns = {\n  narrow: [/^s/i, /^m/i, /^t/i, /^w/i, /^t/i, /^f/i, /^s/i],\n  any: [/^su/i, /^m/i, /^tu/i, /^w/i, /^th/i, /^f/i, /^sa/i],\n};\n\nconst matchDayPeriodPatterns = {\n  narrow: /^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,\n  any: /^([ap]\\.?\\s?m\\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i,\n};\nconst parseDayPeriodPatterns = {\n  any: {\n    am: /^a/i,\n    pm: /^p/i,\n    midnight: /^mi/i,\n    noon: /^no/i,\n    morning: /morning/i,\n    afternoon: /afternoon/i,\n    evening: /evening/i,\n    night: /night/i,\n  },\n};\n\nexport const match = {\n  ordinalNumber: buildMatchPatternFn({\n    matchPattern: matchOrdinalNumberPattern,\n    parsePattern: parseOrdinalNumberPattern,\n    valueCallback: (value) => parseInt(value, 10),\n  }),\n\n  era: buildMatchFn({\n    matchPatterns: matchEraPatterns,\n    defaultMatchWidth: \"wide\",\n    parsePatterns: parseEraPatterns,\n    defaultParseWidth: \"any\",\n  }),\n\n  quarter: buildMatchFn({\n    matchPatterns: matchQuarterPatterns,\n    defaultMatchWidth: \"wide\",\n    parsePatterns: parseQuarterPatterns,\n    defaultParseWidth: \"any\",\n    valueCallback: (index) => index + 1,\n  }),\n\n  month: buildMatchFn({\n    matchPatterns: matchMonthPatterns,\n    defaultMatchWidth: \"wide\",\n    parsePatterns: parseMonthPatterns,\n    defaultParseWidth: \"any\",\n  }),\n\n  day: buildMatchFn({\n    matchPatterns: matchDayPatterns,\n    defaultMatchWidth: \"wide\",\n    parsePatterns: parseDayPatterns,\n    defaultParseWidth: \"any\",\n  }),\n\n  dayPeriod: buildMatchFn({\n    matchPatterns: matchDayPeriodPatterns,\n    defaultMatchWidth: \"any\",\n    parsePatterns: parseDayPeriodPatterns,\n    defaultParseWidth: \"any\",\n  }),\n};\n","import { formatDistance } from \"./en-US/_lib/formatDistance.js\";\nimport { formatLong } from \"./en-US/_lib/formatLong.js\";\nimport { formatRelative } from \"./en-US/_lib/formatRelative.js\";\nimport { localize } from \"./en-US/_lib/localize.js\";\nimport { match } from \"./en-US/_lib/match.js\";\n\n/**\n * @category Locales\n * @summary English locale (United States).\n * @language English\n * @iso-639-2 eng\n * @author Sasha Koss [@kossnocorp](https://github.com/kossnocorp)\n * @author Lesha Koss [@leshakoss](https://github.com/leshakoss)\n */\nexport const enUS = {\n  code: \"en-US\",\n  formatDistance: formatDistance,\n  formatLong: formatLong,\n  formatRelative: formatRelative,\n  localize: localize,\n  match: match,\n  options: {\n    weekStartsOn: 0 /* Sunday */,\n    firstWeekContainsDate: 1,\n  },\n};\n\n// Fallback for modularized imports:\nexport default enUS;\n","import { defaultLocale } from \"./_lib/defaultLocale.js\";\nimport { getDefaultOptions } from \"./_lib/defaultOptions.js\";\nimport { getTimezoneOffsetInMilliseconds } from \"./_lib/getTimezoneOffsetInMilliseconds.js\";\nimport { normalizeDates } from \"./_lib/normalizeDates.js\";\nimport { compareAsc } from \"./compareAsc.js\";\nimport { minutesInDay, minutesInMonth } from \"./constants.js\";\nimport { differenceInMonths } from \"./differenceInMonths.js\";\nimport { differenceInSeconds } from \"./differenceInSeconds.js\";\n\n/**\n * The {@link formatDistance} function options.\n */\n\n/**\n * @name formatDistance\n * @category Common Helpers\n * @summary Return the distance between the given dates in words.\n *\n * @description\n * Return the distance between the given dates in words.\n *\n * | Distance between dates                                            | Result              |\n * |-------------------------------------------------------------------|---------------------|\n * | 0 ... 30 secs                                                     | less than a minute  |\n * | 30 secs ... 1 min 30 secs                                         | 1 minute            |\n * | 1 min 30 secs ... 44 mins 30 secs                                 | [2..44] minutes     |\n * | 44 mins ... 30 secs ... 89 mins 30 secs                           | about 1 hour        |\n * | 89 mins 30 secs ... 23 hrs 59 mins 30 secs                        | about [2..24] hours |\n * | 23 hrs 59 mins 30 secs ... 41 hrs 59 mins 30 secs                 | 1 day               |\n * | 41 hrs 59 mins 30 secs ... 29 days 23 hrs 59 mins 30 secs         | [2..30] days        |\n * | 29 days 23 hrs 59 mins 30 secs ... 44 days 23 hrs 59 mins 30 secs | about 1 month       |\n * | 44 days 23 hrs 59 mins 30 secs ... 59 days 23 hrs 59 mins 30 secs | about 2 months      |\n * | 59 days 23 hrs 59 mins 30 secs ... 1 yr                           | [2..12] months      |\n * | 1 yr ... 1 yr 3 months                                            | about 1 year        |\n * | 1 yr 3 months ... 1 yr 9 month s                                  | over 1 year         |\n * | 1 yr 9 months ... 2 yrs                                           | almost 2 years      |\n * | N yrs ... N yrs 3 months                                          | about N years       |\n * | N yrs 3 months ... N yrs 9 months                                 | over N years        |\n * | N yrs 9 months ... N+1 yrs                                        | almost N+1 years    |\n *\n * With `options.includeSeconds == true`:\n * | Distance between dates | Result               |\n * |------------------------|----------------------|\n * | 0 secs ... 5 secs      | less than 5 seconds  |\n * | 5 secs ... 10 secs     | less than 10 seconds |\n * | 10 secs ... 20 secs    | less than 20 seconds |\n * | 20 secs ... 40 secs    | half a minute        |\n * | 40 secs ... 60 secs    | less than a minute   |\n * | 60 secs ... 90 secs    | 1 minute             |\n *\n * @param laterDate - The date\n * @param earlierDate - The date to compare with\n * @param options - An object with options\n *\n * @returns The distance in words\n *\n * @throws `date` must not be Invalid Date\n * @throws `baseDate` must not be Invalid Date\n * @throws `options.locale` must contain `formatDistance` property\n *\n * @example\n * // What is the distance between 2 July 2014 and 1 January 2015?\n * const result = formatDistance(new Date(2014, 6, 2), new Date(2015, 0, 1))\n * //=> '6 months'\n *\n * @example\n * // What is the distance between 1 January 2015 00:00:15\n * // and 1 January 2015 00:00:00, including seconds?\n * const result = formatDistance(\n *   new Date(2015, 0, 1, 0, 0, 15),\n *   new Date(2015, 0, 1, 0, 0, 0),\n *   { includeSeconds: true }\n * )\n * //=> 'less than 20 seconds'\n *\n * @example\n * // What is the distance from 1 January 2016\n * // to 1 January 2015, with a suffix?\n * const result = formatDistance(new Date(2015, 0, 1), new Date(2016, 0, 1), {\n *   addSuffix: true\n * })\n * //=> 'about 1 year ago'\n *\n * @example\n * // What is the distance between 1 August 2016 and 1 January 2015 in Esperanto?\n * import { eoLocale } from 'date-fns/locale/eo'\n * const result = formatDistance(new Date(2016, 7, 1), new Date(2015, 0, 1), {\n *   locale: eoLocale\n * })\n * //=> 'pli ol 1 jaro'\n */\nexport function formatDistance(laterDate, earlierDate, options) {\n  const defaultOptions = getDefaultOptions();\n  const locale = options?.locale ?? defaultOptions.locale ?? defaultLocale;\n  const minutesInAlmostTwoDays = 2520;\n\n  const comparison = compareAsc(laterDate, earlierDate);\n\n  if (isNaN(comparison)) throw new RangeError(\"Invalid time value\");\n\n  const localizeOptions = Object.assign({}, options, {\n    addSuffix: options?.addSuffix,\n    comparison: comparison,\n  });\n\n  const [laterDate_, earlierDate_] = normalizeDates(\n    options?.in,\n    ...(comparison > 0 ? [earlierDate, laterDate] : [laterDate, earlierDate]),\n  );\n\n  const seconds = differenceInSeconds(earlierDate_, laterDate_);\n  const offsetInSeconds =\n    (getTimezoneOffsetInMilliseconds(earlierDate_) -\n      getTimezoneOffsetInMilliseconds(laterDate_)) /\n    1000;\n  const minutes = Math.round((seconds - offsetInSeconds) / 60);\n  let months;\n\n  // 0 up to 2 mins\n  if (minutes < 2) {\n    if (options?.includeSeconds) {\n      if (seconds < 5) {\n        return locale.formatDistance(\"lessThanXSeconds\", 5, localizeOptions);\n      } else if (seconds < 10) {\n        return locale.formatDistance(\"lessThanXSeconds\", 10, localizeOptions);\n      } else if (seconds < 20) {\n        return locale.formatDistance(\"lessThanXSeconds\", 20, localizeOptions);\n      } else if (seconds < 40) {\n        return locale.formatDistance(\"halfAMinute\", 0, localizeOptions);\n      } else if (seconds < 60) {\n        return locale.formatDistance(\"lessThanXMinutes\", 1, localizeOptions);\n      } else {\n        return locale.formatDistance(\"xMinutes\", 1, localizeOptions);\n      }\n    } else {\n      if (minutes === 0) {\n        return locale.formatDistance(\"lessThanXMinutes\", 1, localizeOptions);\n      } else {\n        return locale.formatDistance(\"xMinutes\", minutes, localizeOptions);\n      }\n    }\n\n    // 2 mins up to 0.75 hrs\n  } else if (minutes < 45) {\n    return locale.formatDistance(\"xMinutes\", minutes, localizeOptions);\n\n    // 0.75 hrs up to 1.5 hrs\n  } else if (minutes < 90) {\n    return locale.formatDistance(\"aboutXHours\", 1, localizeOptions);\n\n    // 1.5 hrs up to 24 hrs\n  } else if (minutes < minutesInDay) {\n    const hours = Math.round(minutes / 60);\n    return locale.formatDistance(\"aboutXHours\", hours, localizeOptions);\n\n    // 1 day up to 1.75 days\n  } else if (minutes < minutesInAlmostTwoDays) {\n    return locale.formatDistance(\"xDays\", 1, localizeOptions);\n\n    // 1.75 days up to 30 days\n  } else if (minutes < minutesInMonth) {\n    const days = Math.round(minutes / minutesInDay);\n    return locale.formatDistance(\"xDays\", days, localizeOptions);\n\n    // 1 month up to 2 months\n  } else if (minutes < minutesInMonth * 2) {\n    months = Math.round(minutes / minutesInMonth);\n    return locale.formatDistance(\"aboutXMonths\", months, localizeOptions);\n  }\n\n  months = differenceInMonths(earlierDate_, laterDate_);\n\n  // 2 months up to 12 months\n  if (months < 12) {\n    const nearestMonth = Math.round(minutes / minutesInMonth);\n    return locale.formatDistance(\"xMonths\", nearestMonth, localizeOptions);\n\n    // 1 year up to max Date\n  } else {\n    const monthsSinceStartOfYear = months % 12;\n    const years = Math.trunc(months / 12);\n\n    // N years up to 1 years 3 months\n    if (monthsSinceStartOfYear < 3) {\n      return locale.formatDistance(\"aboutXYears\", years, localizeOptions);\n\n      // N years 3 months up to N years 9 months\n    } else if (monthsSinceStartOfYear < 9) {\n      return locale.formatDistance(\"overXYears\", years, localizeOptions);\n\n      // N years 9 months up to N year 12 months\n    } else {\n      return locale.formatDistance(\"almostXYears\", years + 1, localizeOptions);\n    }\n  }\n}\n\n// Fallback for modularized imports:\nexport default formatDistance;\n","import { constructNow } from \"./constructNow.js\";\n\nimport { formatDistance } from \"./formatDistance.js\";\n\n/**\n * The {@link formatDistanceToNow} function options.\n */\n\n/**\n * @name formatDistanceToNow\n * @category Common Helpers\n * @summary Return the distance between the given date and now in words.\n * @pure false\n *\n * @description\n * Return the distance between the given date and now in words.\n *\n * | Distance to now                                                   | Result              |\n * |-------------------------------------------------------------------|---------------------|\n * | 0 ... 30 secs                                                     | less than a minute  |\n * | 30 secs ... 1 min 30 secs                                         | 1 minute            |\n * | 1 min 30 secs ... 44 mins 30 secs                                 | [2..44] minutes     |\n * | 44 mins ... 30 secs ... 89 mins 30 secs                           | about 1 hour        |\n * | 89 mins 30 secs ... 23 hrs 59 mins 30 secs                        | about [2..24] hours |\n * | 23 hrs 59 mins 30 secs ... 41 hrs 59 mins 30 secs                 | 1 day               |\n * | 41 hrs 59 mins 30 secs ... 29 days 23 hrs 59 mins 30 secs         | [2..30] days        |\n * | 29 days 23 hrs 59 mins 30 secs ... 44 days 23 hrs 59 mins 30 secs | about 1 month       |\n * | 44 days 23 hrs 59 mins 30 secs ... 59 days 23 hrs 59 mins 30 secs | about 2 months      |\n * | 59 days 23 hrs 59 mins 30 secs ... 1 yr                           | [2..12] months      |\n * | 1 yr ... 1 yr 3 months                                            | about 1 year        |\n * | 1 yr 3 months ... 1 yr 9 month s                                  | over 1 year         |\n * | 1 yr 9 months ... 2 yrs                                           | almost 2 years      |\n * | N yrs ... N yrs 3 months                                          | about N years       |\n * | N yrs 3 months ... N yrs 9 months                                 | over N years        |\n * | N yrs 9 months ... N+1 yrs                                        | almost N+1 years    |\n *\n * With `options.includeSeconds == true`:\n * | Distance to now     | Result               |\n * |---------------------|----------------------|\n * | 0 secs ... 5 secs   | less than 5 seconds  |\n * | 5 secs ... 10 secs  | less than 10 seconds |\n * | 10 secs ... 20 secs | less than 20 seconds |\n * | 20 secs ... 40 secs | half a minute        |\n * | 40 secs ... 60 secs | less than a minute   |\n * | 60 secs ... 90 secs | 1 minute             |\n *\n * @param date - The given date\n * @param options - The object with options\n *\n * @returns The distance in words\n *\n * @throws `date` must not be Invalid Date\n * @throws `options.locale` must contain `formatDistance` property\n *\n * @example\n * // If today is 1 January 2015, what is the distance to 2 July 2014?\n * const result = formatDistanceToNow(\n *   new Date(2014, 6, 2)\n * )\n * //=> '6 months'\n *\n * @example\n * // If now is 1 January 2015 00:00:00,\n * // what is the distance to 1 January 2015 00:00:15, including seconds?\n * const result = formatDistanceToNow(\n *   new Date(2015, 0, 1, 0, 0, 15),\n *   {includeSeconds: true}\n * )\n * //=> 'less than 20 seconds'\n *\n * @example\n * // If today is 1 January 2015,\n * // what is the distance to 1 January 2016, with a suffix?\n * const result = formatDistanceToNow(\n *   new Date(2016, 0, 1),\n *   {addSuffix: true}\n * )\n * //=> 'in about 1 year'\n *\n * @example\n * // If today is 1 January 2015,\n * // what is the distance to 1 August 2016 in Esperanto?\n * const eoLocale = require('date-fns/locale/eo')\n * const result = formatDistanceToNow(\n *   new Date(2016, 7, 1),\n *   {locale: eoLocale}\n * )\n * //=> 'pli ol 1 jaro'\n */\nexport function formatDistanceToNow(date, options) {\n  return formatDistance(date, constructNow(date), options);\n}\n\n// Fallback for modularized imports:\nexport default formatDistanceToNow;\n","const formatDistanceLocale = {\n  lessThanXSeconds: {\n    one: \"menos de un segundo\",\n    other: \"menos de {{count}} segundos\",\n  },\n\n  xSeconds: {\n    one: \"1 segundo\",\n    other: \"{{count}} segundos\",\n  },\n\n  halfAMinute: \"medio minuto\",\n\n  lessThanXMinutes: {\n    one: \"menos de un minuto\",\n    other: \"menos de {{count}} minutos\",\n  },\n\n  xMinutes: {\n    one: \"1 minuto\",\n    other: \"{{count}} minutos\",\n  },\n\n  aboutXHours: {\n    one: \"alrededor de 1 hora\",\n    other: \"alrededor de {{count}} horas\",\n  },\n\n  xHours: {\n    one: \"1 hora\",\n    other: \"{{count}} horas\",\n  },\n\n  xDays: {\n    one: \"1 día\",\n    other: \"{{count}} días\",\n  },\n\n  aboutXWeeks: {\n    one: \"alrededor de 1 semana\",\n    other: \"alrededor de {{count}} semanas\",\n  },\n\n  xWeeks: {\n    one: \"1 semana\",\n    other: \"{{count}} semanas\",\n  },\n\n  aboutXMonths: {\n    one: \"alrededor de 1 mes\",\n    other: \"alrededor de {{count}} meses\",\n  },\n\n  xMonths: {\n    one: \"1 mes\",\n    other: \"{{count}} meses\",\n  },\n\n  aboutXYears: {\n    one: \"alrededor de 1 año\",\n    other: \"alrededor de {{count}} años\",\n  },\n\n  xYears: {\n    one: \"1 año\",\n    other: \"{{count}} años\",\n  },\n\n  overXYears: {\n    one: \"más de 1 año\",\n    other: \"más de {{count}} años\",\n  },\n\n  almostXYears: {\n    one: \"casi 1 año\",\n    other: \"casi {{count}} años\",\n  },\n};\n\nexport const formatDistance = (token, count, options) => {\n  let result;\n\n  const tokenValue = formatDistanceLocale[token];\n  if (typeof tokenValue === \"string\") {\n    result = tokenValue;\n  } else if (count === 1) {\n    result = tokenValue.one;\n  } else {\n    result = tokenValue.other.replace(\"{{count}}\", count.toString());\n  }\n\n  if (options?.addSuffix) {\n    if (options.comparison && options.comparison > 0) {\n      return \"en \" + result;\n    } else {\n      return \"hace \" + result;\n    }\n  }\n\n  return result;\n};\n","import { buildFormatLongFn } from \"../../_lib/buildFormatLongFn.js\";\n\nconst dateFormats = {\n  full: \"EEEE, d 'de' MMMM 'de' y\",\n  long: \"d 'de' MMMM 'de' y\",\n  medium: \"d MMM y\",\n  short: \"dd/MM/y\",\n};\n\nconst timeFormats = {\n  full: \"HH:mm:ss zzzz\",\n  long: \"HH:mm:ss z\",\n  medium: \"HH:mm:ss\",\n  short: \"HH:mm\",\n};\n\nconst dateTimeFormats = {\n  full: \"{{date}} 'a las' {{time}}\",\n  long: \"{{date}} 'a las' {{time}}\",\n  medium: \"{{date}}, {{time}}\",\n  short: \"{{date}}, {{time}}\",\n};\n\nexport const formatLong = {\n  date: buildFormatLongFn({\n    formats: dateFormats,\n    defaultWidth: \"full\",\n  }),\n\n  time: buildFormatLongFn({\n    formats: timeFormats,\n    defaultWidth: \"full\",\n  }),\n\n  dateTime: buildFormatLongFn({\n    formats: dateTimeFormats,\n    defaultWidth: \"full\",\n  }),\n};\n","const formatRelativeLocale = {\n  lastWeek: \"'el' eeee 'pasado a la' p\",\n  yesterday: \"'ayer a la' p\",\n  today: \"'hoy a la' p\",\n  tomorrow: \"'mañana a la' p\",\n  nextWeek: \"eeee 'a la' p\",\n  other: \"P\",\n};\n\nconst formatRelativeLocalePlural = {\n  lastWeek: \"'el' eeee 'pasado a las' p\",\n  yesterday: \"'ayer a las' p\",\n  today: \"'hoy a las' p\",\n  tomorrow: \"'mañana a las' p\",\n  nextWeek: \"eeee 'a las' p\",\n  other: \"P\",\n};\n\nexport const formatRelative = (token, date, _baseDate, _options) => {\n  if (date.getHours() !== 1) {\n    return formatRelativeLocalePlural[token];\n  } else {\n    return formatRelativeLocale[token];\n  }\n};\n","import { buildLocalizeFn } from \"../../_lib/buildLocalizeFn.js\";\n\nconst eraValues = {\n  narrow: [\"AC\", \"DC\"],\n  abbreviated: [\"AC\", \"DC\"],\n  wide: [\"antes de cristo\", \"después de cristo\"],\n};\n\nconst quarterValues = {\n  narrow: [\"1\", \"2\", \"3\", \"4\"],\n  abbreviated: [\"T1\", \"T2\", \"T3\", \"T4\"],\n  wide: [\"1º trimestre\", \"2º trimestre\", \"3º trimestre\", \"4º trimestre\"],\n};\n\nconst monthValues = {\n  narrow: [\"e\", \"f\", \"m\", \"a\", \"m\", \"j\", \"j\", \"a\", \"s\", \"o\", \"n\", \"d\"],\n  abbreviated: [\n    \"ene\",\n    \"feb\",\n    \"mar\",\n    \"abr\",\n    \"may\",\n    \"jun\",\n    \"jul\",\n    \"ago\",\n    \"sep\",\n    \"oct\",\n    \"nov\",\n    \"dic\",\n  ],\n\n  wide: [\n    \"enero\",\n    \"febrero\",\n    \"marzo\",\n    \"abril\",\n    \"mayo\",\n    \"junio\",\n    \"julio\",\n    \"agosto\",\n    \"septiembre\",\n    \"octubre\",\n    \"noviembre\",\n    \"diciembre\",\n  ],\n};\n\nconst dayValues = {\n  narrow: [\"d\", \"l\", \"m\", \"m\", \"j\", \"v\", \"s\"],\n  short: [\"do\", \"lu\", \"ma\", \"mi\", \"ju\", \"vi\", \"sá\"],\n  abbreviated: [\"dom\", \"lun\", \"mar\", \"mié\", \"jue\", \"vie\", \"sáb\"],\n  wide: [\n    \"domingo\",\n    \"lunes\",\n    \"martes\",\n    \"miércoles\",\n    \"jueves\",\n    \"viernes\",\n    \"sábado\",\n  ],\n};\n\nconst dayPeriodValues = {\n  narrow: {\n    am: \"a\",\n    pm: \"p\",\n    midnight: \"mn\",\n    noon: \"md\",\n    morning: \"mañana\",\n    afternoon: \"tarde\",\n    evening: \"tarde\",\n    night: \"noche\",\n  },\n  abbreviated: {\n    am: \"AM\",\n    pm: \"PM\",\n    midnight: \"medianoche\",\n    noon: \"mediodia\",\n    morning: \"mañana\",\n    afternoon: \"tarde\",\n    evening: \"tarde\",\n    night: \"noche\",\n  },\n  wide: {\n    am: \"a.m.\",\n    pm: \"p.m.\",\n    midnight: \"medianoche\",\n    noon: \"mediodia\",\n    morning: \"mañana\",\n    afternoon: \"tarde\",\n    evening: \"tarde\",\n    night: \"noche\",\n  },\n};\n\nconst formattingDayPeriodValues = {\n  narrow: {\n    am: \"a\",\n    pm: \"p\",\n    midnight: \"mn\",\n    noon: \"md\",\n    morning: \"de la mañana\",\n    afternoon: \"de la tarde\",\n    evening: \"de la tarde\",\n    night: \"de la noche\",\n  },\n  abbreviated: {\n    am: \"AM\",\n    pm: \"PM\",\n    midnight: \"medianoche\",\n    noon: \"mediodia\",\n    morning: \"de la mañana\",\n    afternoon: \"de la tarde\",\n    evening: \"de la tarde\",\n    night: \"de la noche\",\n  },\n  wide: {\n    am: \"a.m.\",\n    pm: \"p.m.\",\n    midnight: \"medianoche\",\n    noon: \"mediodia\",\n    morning: \"de la mañana\",\n    afternoon: \"de la tarde\",\n    evening: \"de la tarde\",\n    night: \"de la noche\",\n  },\n};\n\nconst ordinalNumber = (dirtyNumber, _options) => {\n  const number = Number(dirtyNumber);\n  return number + \"º\";\n};\n\nexport const localize = {\n  ordinalNumber: ordinalNumber,\n\n  era: buildLocalizeFn({\n    values: eraValues,\n    defaultWidth: \"wide\",\n  }),\n\n  quarter: buildLocalizeFn({\n    values: quarterValues,\n    defaultWidth: \"wide\",\n    argumentCallback: (quarter) => Number(quarter) - 1,\n  }),\n\n  month: buildLocalizeFn({\n    values: monthValues,\n    defaultWidth: \"wide\",\n  }),\n\n  day: buildLocalizeFn({\n    values: dayValues,\n    defaultWidth: \"wide\",\n  }),\n\n  dayPeriod: buildLocalizeFn({\n    values: dayPeriodValues,\n    defaultWidth: \"wide\",\n    formattingValues: formattingDayPeriodValues,\n    defaultFormattingWidth: \"wide\",\n  }),\n};\n","import { buildMatchPatternFn } from \"../../_lib/buildMatchPatternFn.js\";\nimport { buildMatchFn } from \"../../_lib/buildMatchFn.js\";\n\nconst matchOrdinalNumberPattern = /^(\\d+)(º)?/i;\nconst parseOrdinalNumberPattern = /\\d+/i;\n\nconst matchEraPatterns = {\n  narrow: /^(ac|dc|a|d)/i,\n  abbreviated: /^(a\\.?\\s?c\\.?|a\\.?\\s?e\\.?\\s?c\\.?|d\\.?\\s?c\\.?|e\\.?\\s?c\\.?)/i,\n  wide: /^(antes de cristo|antes de la era com[uú]n|despu[eé]s de cristo|era com[uú]n)/i,\n};\nconst parseEraPatterns = {\n  any: [/^ac/i, /^dc/i],\n  wide: [\n    /^(antes de cristo|antes de la era com[uú]n)/i,\n    /^(despu[eé]s de cristo|era com[uú]n)/i,\n  ],\n};\n\nconst matchQuarterPatterns = {\n  narrow: /^[1234]/i,\n  abbreviated: /^T[1234]/i,\n  wide: /^[1234](º)? trimestre/i,\n};\nconst parseQuarterPatterns = {\n  any: [/1/i, /2/i, /3/i, /4/i],\n};\n\nconst matchMonthPatterns = {\n  narrow: /^[efmajsond]/i,\n  abbreviated: /^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,\n  wide: /^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i,\n};\nconst parseMonthPatterns = {\n  narrow: [\n    /^e/i,\n    /^f/i,\n    /^m/i,\n    /^a/i,\n    /^m/i,\n    /^j/i,\n    /^j/i,\n    /^a/i,\n    /^s/i,\n    /^o/i,\n    /^n/i,\n    /^d/i,\n  ],\n\n  any: [\n    /^en/i,\n    /^feb/i,\n    /^mar/i,\n    /^abr/i,\n    /^may/i,\n    /^jun/i,\n    /^jul/i,\n    /^ago/i,\n    /^sep/i,\n    /^oct/i,\n    /^nov/i,\n    /^dic/i,\n  ],\n};\n\nconst matchDayPatterns = {\n  narrow: /^[dlmjvs]/i,\n  short: /^(do|lu|ma|mi|ju|vi|s[áa])/i,\n  abbreviated: /^(dom|lun|mar|mi[ée]|jue|vie|s[áa]b)/i,\n  wide: /^(domingo|lunes|martes|mi[ée]rcoles|jueves|viernes|s[áa]bado)/i,\n};\nconst parseDayPatterns = {\n  narrow: [/^d/i, /^l/i, /^m/i, /^m/i, /^j/i, /^v/i, /^s/i],\n  any: [/^do/i, /^lu/i, /^ma/i, /^mi/i, /^ju/i, /^vi/i, /^sa/i],\n};\n\nconst matchDayPeriodPatterns = {\n  narrow: /^(a|p|mn|md|(de la|a las) (mañana|tarde|noche))/i,\n  any: /^([ap]\\.?\\s?m\\.?|medianoche|mediodia|(de la|a las) (mañana|tarde|noche))/i,\n};\nconst parseDayPeriodPatterns = {\n  any: {\n    am: /^a/i,\n    pm: /^p/i,\n    midnight: /^mn/i,\n    noon: /^md/i,\n    morning: /mañana/i,\n    afternoon: /tarde/i,\n    evening: /tarde/i,\n    night: /noche/i,\n  },\n};\n\nexport const match = {\n  ordinalNumber: buildMatchPatternFn({\n    matchPattern: matchOrdinalNumberPattern,\n    parsePattern: parseOrdinalNumberPattern,\n    valueCallback: function (value) {\n      return parseInt(value, 10);\n    },\n  }),\n\n  era: buildMatchFn({\n    matchPatterns: matchEraPatterns,\n    defaultMatchWidth: \"wide\",\n    parsePatterns: parseEraPatterns,\n    defaultParseWidth: \"any\",\n  }),\n\n  quarter: buildMatchFn({\n    matchPatterns: matchQuarterPatterns,\n    defaultMatchWidth: \"wide\",\n    parsePatterns: parseQuarterPatterns,\n    defaultParseWidth: \"any\",\n    valueCallback: (index) => index + 1,\n  }),\n\n  month: buildMatchFn({\n    matchPatterns: matchMonthPatterns,\n    defaultMatchWidth: \"wide\",\n    parsePatterns: parseMonthPatterns,\n    defaultParseWidth: \"any\",\n  }),\n\n  day: buildMatchFn({\n    matchPatterns: matchDayPatterns,\n    defaultMatchWidth: \"wide\",\n    parsePatterns: parseDayPatterns,\n    defaultParseWidth: \"any\",\n  }),\n\n  dayPeriod: buildMatchFn({\n    matchPatterns: matchDayPeriodPatterns,\n    defaultMatchWidth: \"any\",\n    parsePatterns: parseDayPeriodPatterns,\n    defaultParseWidth: \"any\",\n  }),\n};\n","import { formatDistance } from \"./es/_lib/formatDistance.js\";\nimport { formatLong } from \"./es/_lib/formatLong.js\";\nimport { formatRelative } from \"./es/_lib/formatRelative.js\";\nimport { localize } from \"./es/_lib/localize.js\";\nimport { match } from \"./es/_lib/match.js\";\n\n/**\n * @category Locales\n * @summary Spanish locale.\n * @language Spanish\n * @iso-639-2 spa\n * @author Juan Angosto [@juanangosto](https://github.com/juanangosto)\n * @author Guillermo Grau [@guigrpa](https://github.com/guigrpa)\n * @author Fernando Agüero [@fjaguero](https://github.com/fjaguero)\n * @author Gastón Haro [@harogaston](https://github.com/harogaston)\n * @author Yago Carballo [@YagoCarballo](https://github.com/YagoCarballo)\n */\nexport const es = {\n  code: \"es\",\n  formatDistance: formatDistance,\n  formatLong: formatLong,\n  formatRelative: formatRelative,\n  localize: localize,\n  match: match,\n  options: {\n    weekStartsOn: 1 /* Monday */,\n    firstWeekContainsDate: 1,\n  },\n};\n\n// Fallback for modularized imports:\nexport default es;\n","import React from \"react\";\r\nimport {User, Package, Store, Circle, Search, Filter} from \"lucide-react\";\r\nimport type {Chat} from \"../../../core/domain/entities/Chat\";\r\nimport {formatDistanceToNow} from \"date-fns\";\r\nimport {es} from \"date-fns/locale\";\r\n\r\ninterface ChatListProps {\r\n\tchats: Chat[];\r\n\tselectedChatId?: number;\r\n\tonSelectChat: (chat: Chat) => void;\r\n\tloading: boolean;\r\n\tsearchTerm: string;\r\n\tonSearchChange: (value: string) => void;\r\n\tstatusFilter: string;\r\n\tonStatusFilterChange: (value: string) => void;\r\n\tunreadFilter: boolean;\r\n\tonUnreadFilterChange: (value: boolean) => void;\r\n\tisSeller?: boolean;\r\n}\r\n\r\nconst ChatList: React.FC<ChatListProps> = ({\r\n\tchats,\r\n\tselectedChatId,\r\n\tonSelectChat,\r\n\tloading,\r\n\tsearchTerm,\r\n\tonSearchChange,\r\n\tstatusFilter,\r\n\tonStatusFilterChange,\r\n\tunreadFilter,\r\n\tonUnreadFilterChange,\r\n\tisSeller = false,\r\n}) => {\r\n\t// Formatear fecha relativa\r\n\tconst formatDate = (dateString: string | undefined) => {\r\n\t\tif (!dateString) return \"fecha desconocida\";\r\n\r\n\t\ttry {\r\n\t\t\treturn formatDistanceToNow(new Date(dateString), {\r\n\t\t\t\taddSuffix: true,\r\n\t\t\t\tlocale: es,\r\n\t\t\t});\r\n\t\t} catch (error) {\r\n\t\t\treturn \"fecha desconocida\";\r\n\t\t}\r\n\t};\r\n\r\n\t// Obtener el nombre y avatar del interlocutor según el rol\r\n\tconst getChatParticipant = (chat: Chat) => {\r\n\t\tif (isSeller) {\r\n\t\t\treturn {\r\n\t\t\t\tname: chat.user?.name || `Cliente #${chat.userId}`,\r\n\t\t\t\tavatar: chat.user?.avatar,\r\n\t\t\t\tid: chat.userId,\r\n\t\t\t\ticon: <User className=\"h-6 w-6 text-gray-500\" />,\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\t// En este caso, el usuario está viendo sus propios chats con vendedores\r\n\t\t\treturn {\r\n\t\t\t\tname: chat.seller?.storeName || `Vendedor #${chat.sellerId}`,\r\n\t\t\t\tavatar: chat.seller?.avatar,\r\n\t\t\t\tid: chat.sellerId,\r\n\t\t\t\ticon: <Store className=\"h-6 w-6 text-gray-500\" />,\r\n\t\t\t};\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"flex flex-col h-full\">\r\n\t\t\t{/* Filtros y búsqueda */}\r\n\t\t\t<div className=\"p-4 border-b border-gray-200 bg-white flex-shrink-0\">\r\n\t\t\t\t<div className=\"mb-2 relative\">\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tplaceholder=\"Buscar conversaciones...\"\r\n\t\t\t\t\t\tclassName=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n\t\t\t\t\t\tvalue={searchTerm}\r\n\t\t\t\t\t\tonChange={(e) => onSearchChange(e.target.value)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Search className=\"absolute left-3 top-2.5 h-5 w-5 text-gray-400\" />\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"flex items-center justify-between mt-3\">\r\n\t\t\t\t\t<div className=\"flex items-center space-x-2\">\r\n\t\t\t\t\t\t<Filter className=\"h-5 w-5 text-gray-500\" />\r\n\t\t\t\t\t\t<select\r\n\t\t\t\t\t\t\tclassName=\"border border-gray-300 rounded-lg px-3 py-1.5 text-sm focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n\t\t\t\t\t\t\tvalue={statusFilter}\r\n\t\t\t\t\t\t\tonChange={(e) => onStatusFilterChange(e.target.value)}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<option value=\"all\">Todos</option>\r\n\t\t\t\t\t\t\t<option value=\"active\">Activos</option>\r\n\t\t\t\t\t\t\t<option value=\"closed\">Cerrados</option>\r\n\t\t\t\t\t\t\t<option value=\"archived\">Archivados</option>\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\tid=\"unreadOnly\"\r\n\t\t\t\t\t\t\tclassName=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"\r\n\t\t\t\t\t\t\tchecked={unreadFilter}\r\n\t\t\t\t\t\t\tonChange={(e) => onUnreadFilterChange(e.target.checked)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\thtmlFor=\"unreadOnly\"\r\n\t\t\t\t\t\t\tclassName=\"ml-2 text-sm text-gray-700\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tSolo no leídos\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Lista de conversaciones con scroll personalizado */}\r\n\t\t\t<div className=\"flex-1 overflow-y-auto custom-scrollbar\">\r\n\t\t\t\t{loading ? (\r\n\t\t\t\t\t<div className=\"flex justify-center items-center h-full\">\r\n\t\t\t\t\t\t<div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600\"></div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t) : chats.length === 0 ? (\r\n\t\t\t\t\t<div className=\"flex flex-col items-center justify-center h-full p-6 text-center\">\r\n\t\t\t\t\t\t<div className=\"w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center mb-4\">\r\n\t\t\t\t\t\t\t{isSeller ? (\r\n\t\t\t\t\t\t\t\t<User className=\"h-8 w-8 text-gray-500\" />\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t<Store className=\"h-8 w-8 text-gray-500\" />\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<h3 className=\"text-lg font-medium text-gray-900\">\r\n\t\t\t\t\t\t\tNo hay conversaciones\r\n\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t<p className=\"text-gray-500 mt-2\">\r\n\t\t\t\t\t\t\t{searchTerm || statusFilter !== \"all\" || unreadFilter\r\n\t\t\t\t\t\t\t\t? \"No se encontraron resultados con los filtros actuales\"\r\n\t\t\t\t\t\t\t\t: isSeller\r\n\t\t\t\t\t\t\t\t\t? \"Cuando los clientes inicien conversaciones, aparecerán aquí\"\r\n\t\t\t\t\t\t\t\t\t: \"Inicia una conversación con un vendedor desde la página de un producto\"}\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t) : (\r\n\t\t\t\t\t<div className=\"divide-y divide-gray-200\">\r\n\t\t\t\t\t\t{chats.map((chat) => {\r\n\t\t\t\t\t\t\tconst participant = getChatParticipant(chat);\r\n\t\t\t\t\t\t\t// Asegurar que cada chat tiene un id válido\r\n\t\t\t\t\t\t\tconst chatId = chat.id || 0;\r\n\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\tkey={`chat-${chatId}`}\r\n\t\t\t\t\t\t\t\t\tclassName={`p-4 hover:bg-gray-50 cursor-pointer transition-colors border-l-4 ${\r\n\t\t\t\t\t\t\t\t\t\tselectedChatId === chatId\r\n\t\t\t\t\t\t\t\t\t\t\t? \"bg-primary-50 border-l-primary-500\"\r\n\t\t\t\t\t\t\t\t\t\t\t: \"border-l-transparent hover:border-l-gray-300\"\r\n\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t\tonClick={() => onSelectChat(chat)}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-start\">\r\n\t\t\t\t\t\t\t\t\t\t{/* Avatar */}\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex-shrink-0 mr-3\">\r\n\t\t\t\t\t\t\t\t\t\t\t{participant.avatar ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={participant.avatar}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\talt={participant.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"h-12 w-12 rounded-full border-2 border-white shadow-sm\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tonError={(e) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst target = e.target as HTMLImageElement;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttarget.onerror = null;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttarget.src =\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"https://via.placeholder.com/48?text=U\";\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"h-12 w-12 rounded-full bg-gray-200 flex items-center justify-center border-2 border-white shadow-sm\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{participant.icon}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t\t{/* Contenido del chat */}\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex-1 min-w-0\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex justify-between items-start mb-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<h3 className={`text-sm font-medium truncate pr-2 ${\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tselectedChatId === chatId ? 'text-primary-700' : 'text-gray-900'\r\n\t\t\t\t\t\t\t\t\t\t\t\t}`}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{participant.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center space-x-2 flex-shrink-0\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-gray-500\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatDate(chat.updatedAt)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{/* Indicador de no leídos */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{chat.unreadCount && chat.unreadCount > 0 && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"inline-flex items-center justify-center h-5 w-5 rounded-full bg-primary-600 text-white text-xs font-medium\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{chat.unreadCount > 99 ? '99+' : chat.unreadCount}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t{/* Información del producto */}\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center text-xs text-gray-500 mb-2\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Package className=\"h-3 w-3 mr-1 flex-shrink-0\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"truncate\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{chat.product?.name || `Producto #${chat.productId}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t{/* Último mensaje y estado */}\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-between\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center min-w-0 flex-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium mr-2 flex-shrink-0 ${\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tchat.status === \"active\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"bg-green-100 text-green-800\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: chat.status === \"closed\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"bg-blue-100 text-blue-800\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"bg-gray-100 text-gray-800\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Circle\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-1.5 h-1.5 mr-1\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfill=\"currentColor\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{chat.status === \"active\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"Activo\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: chat.status === \"closed\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"Cerrado\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"Archivado\"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t{/* Último mensaje */}\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"mt-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-gray-600 truncate\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{chat.lastMessage?.content || \"Sin mensajes\"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Indicador de scroll */}\r\n\t\t\t{chats.length > 10 && (\r\n\t\t\t\t<div className=\"p-2 border-t border-gray-200 bg-gray-50 text-center\">\r\n\t\t\t\t\t<span className=\"text-xs text-gray-500\">\r\n\t\t\t\t\t\t{chats.length} conversaciones • Desliza para ver más\r\n\t\t\t\t\t</span>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default ChatList;","import React, {useRef, useEffect, useState} from \"react\";\r\nimport {User, Clock, Check, CheckCheck, AlertCircle} from \"lucide-react\";\r\nimport type {Message} from \"../../../core/domain/entities/Chat\";\r\nimport {parseBackendDate, isToday, isYesterday} from \"../../../utils/dateUtils\";\r\n\r\ninterface ChatMessagesProps {\r\n\tmessages: Message[];\r\n\tloading: boolean;\r\n\tnoMessagesText?: string;\r\n\tcurrentUserId?: number;\r\n}\r\n\r\n// Enum para estados de mensaje mejorado\r\nenum MessageStatus {\r\n\tSENDING = 'sending',\r\n\tSENT = 'sent',\r\n\tDELIVERED = 'delivered', \r\n\tREAD = 'read',\r\n\tERROR = 'error'\r\n}\r\n\r\n// Función mejorada para obtener el estado del mensaje\r\nconst getMessageStatus = (message: Message, isFromCurrentUser: boolean): MessageStatus => {\r\n\t// Si no es del usuario actual, no evaluar estado\r\n\tif (!isFromCurrentUser) {\r\n\t\treturn MessageStatus.DELIVERED;\r\n\t}\r\n\r\n\t// Verificar si hay error en el envío\r\n\tif (message.content && message.content.includes('[ERROR]')) {\r\n\t\treturn MessageStatus.ERROR;\r\n\t}\r\n\r\n\t// Si el mensaje no tiene ID, se está enviando\r\n\tif (!message.id || message.id < 0) {\r\n\t\treturn MessageStatus.SENDING;\r\n\t}\r\n\r\n\t// Si está marcado como leído por el receptor\r\n\tif (message.isRead) {\r\n\t\treturn MessageStatus.READ;\r\n\t}\r\n\r\n\t// Si tiene fecha de creación, fue enviado y entregado\r\n\tif (message.createdAt) {\r\n\t\treturn MessageStatus.DELIVERED;\r\n\t}\r\n\r\n\t// Por defecto, está enviado\r\n\treturn MessageStatus.SENT;\r\n};\r\n\r\n// Componente mejorado para el icono de estado\r\nconst MessageStatusIcon: React.FC<{status: MessageStatus}> = ({status}) => {\r\n\tconst getIcon = () => {\r\n\t\tswitch (status) {\r\n\t\t\tcase MessageStatus.SENDING:\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t<Clock className=\"h-3 w-3 text-gray-400 animate-pulse\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t);\r\n\t\t\tcase MessageStatus.SENT:\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t<Check className=\"h-3 w-3 text-gray-400\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t);\r\n\t\t\tcase MessageStatus.DELIVERED:\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t<CheckCheck className=\"h-3 w-3 text-gray-400\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t);\r\n\t\t\tcase MessageStatus.READ:\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t<CheckCheck className=\"h-3 w-3 text-primary-500\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t);\r\n\t\t\tcase MessageStatus.ERROR:\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div className=\"flex items-center\" title=\"Error al enviar mensaje\">\r\n\t\t\t\t\t\t<AlertCircle className=\"h-3 w-3 text-red-500\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t);\r\n\t\t\tdefault:\r\n\t\t\t\treturn null;\r\n\t\t}\r\n\t};\r\n\r\n\treturn <span className=\"ml-1 flex-shrink-0\">{getIcon()}</span>;\r\n};\r\n\r\n// Función mejorada para formatear fecha para separadores\r\nconst formatDateSeparator = (dateString: string): string => {\r\n\ttry {\r\n\t\tconst date = parseBackendDate(dateString);\r\n\t\tif (!date) return '';\r\n\r\n\t\tif (isToday(dateString)) {\r\n\t\t\treturn 'Hoy';\r\n\t\t} else if (isYesterday(dateString)) {\r\n\t\t\treturn 'Ayer';\r\n\t\t} else {\r\n\t\t\tconst now = new Date();\r\n\t\t\tconst diffInDays = Math.floor((now.getTime() - date.getTime()) / (1000 * 60 * 60 * 24));\r\n\t\t\t\r\n\t\t\tif (diffInDays < 7) {\r\n\t\t\t\t// Mostrar día de la semana para la semana pasada\r\n\t\t\t\treturn date.toLocaleDateString('es-EC', { weekday: 'long' });\r\n\t\t\t} else {\r\n\t\t\t\t// Fecha completa para fechas más antiguas\r\n\t\t\t\treturn date.toLocaleDateString('es-EC', { \r\n\t\t\t\t\tday: 'numeric',\r\n\t\t\t\t\tmonth: 'long',\r\n\t\t\t\t\tyear: date.getFullYear() !== now.getFullYear() ? 'numeric' : undefined\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\t} catch (error) {\r\n\t\tconsole.error('Error formateando fecha separador:', error);\r\n\t\treturn '';\r\n\t}\r\n};\r\n\r\n// Función mejorada para formatear hora del mensaje\r\nconst formatMessageTime = (dateString: string): string => {\r\n\ttry {\r\n\t\tif (!dateString) return '';\r\n\t\t\r\n\t\tconst date = parseBackendDate(dateString);\r\n\t\tif (!date) return '';\r\n\r\n\t\treturn date.toLocaleTimeString('es-EC', { \r\n\t\t\thour: '2-digit', \r\n\t\t\tminute: '2-digit',\r\n\t\t\thour12: false \r\n\t\t});\r\n\t} catch (error) {\r\n\t\tconsole.error('Error formateando hora:', error);\r\n\t\treturn '';\r\n\t}\r\n};\r\n\r\n// Función mejorada para agrupar mensajes por fecha\r\nconst groupMessagesByDate = (messages: Message[]) => {\r\n\tconst groups: { date: string; messages: Message[]; dateKey: string }[] = [];\r\n\t\r\n\t// Ordenar mensajes por fecha de creación (más antiguos primero)\r\n\tconst sortedMessages = [...messages].sort((a, b) => {\r\n\t\tconst dateA = a.createdAt ? parseBackendDate(a.createdAt)?.getTime() || 0 : 0;\r\n\t\tconst dateB = b.createdAt ? parseBackendDate(b.createdAt)?.getTime() || 0 : 0;\r\n\t\treturn dateA - dateB;\r\n\t});\r\n\t\r\n\tsortedMessages.forEach((message) => {\r\n\t\tif (!message.createdAt) return;\r\n\t\t\r\n\t\tconst messageDate = parseBackendDate(message.createdAt);\r\n\t\tif (!messageDate) return;\r\n\t\t\r\n\t\t// Usar solo la fecha (sin hora) como clave\r\n\t\tconst dateKey = messageDate.toDateString();\r\n\t\tlet group = groups.find(g => g.dateKey === dateKey);\r\n\t\t\r\n\t\tif (!group) {\r\n\t\t\tgroup = { \r\n\t\t\t\tdate: formatDateSeparator(message.createdAt), \r\n\t\t\t\tmessages: [], \r\n\t\t\t\tdateKey \r\n\t\t\t};\r\n\t\t\tgroups.push(group);\r\n\t\t}\r\n\t\t\r\n\t\tgroup.messages.push(message);\r\n\t});\r\n\t\r\n\t// Los grupos ya están ordenados por fecha (más antiguos primero)\r\n\treturn groups;\r\n};\r\n\r\n// Función para determinar si dos mensajes consecutivos son del mismo usuario (para agrupar visualmente)\r\nconst shouldGroupWithPrevious = (currentMessage: Message, previousMessage: Message): boolean => {\r\n\tif (!previousMessage) return false;\r\n\t\r\n\t// Mismo remitente\r\n\tif (currentMessage.senderId !== previousMessage.senderId) return false;\r\n\t\r\n\t// Diferencia de tiempo menor a 5 minutos\r\n\tconst currentTime = currentMessage.createdAt ? parseBackendDate(currentMessage.createdAt)?.getTime() : 0;\r\n\tconst previousTime = previousMessage.createdAt ? parseBackendDate(previousMessage.createdAt)?.getTime() : 0;\r\n\t\r\n\tif (!currentTime || !previousTime) return false;\r\n\t\r\n\tconst diffInMinutes = (currentTime - previousTime) / (1000 * 60);\r\n\treturn diffInMinutes < 5;\r\n};\r\n\r\nconst ChatMessages: React.FC<ChatMessagesProps> = ({\r\n\tmessages,\r\n\tloading,\r\n\tnoMessagesText = \"No hay mensajes\",\r\n\tcurrentUserId\r\n}) => {\r\n\tconst messagesEndRef = useRef<HTMLDivElement>(null);\r\n\tconst messagesContainerRef = useRef<HTMLDivElement>(null);\r\n\tconst [prevMessagesLength, setPrevMessagesLength] = useState(0);\r\n\tconst [autoScroll, setAutoScroll] = useState(true);\r\n\r\n\t// Detectar si el usuario está al final del chat\r\n\tconst handleScroll = () => {\r\n\t\tif (messagesContainerRef.current) {\r\n\t\t\tconst { scrollTop, scrollHeight, clientHeight } = messagesContainerRef.current;\r\n\t\t\tconst isAtBottom = scrollHeight - scrollTop - clientHeight < 100;\r\n\t\t\tsetAutoScroll(isAtBottom);\r\n\t\t}\r\n\t};\r\n\r\n\t// Scroll automático mejorado\r\n\tuseEffect(() => {\r\n\t\tif (messages.length > 0) {\r\n\t\t\tconsole.log(`📱 Mostrando ${messages.length} mensajes en estilo WhatsApp`);\r\n\t\t}\r\n\r\n\t\t// Scroll automático solo si hay nuevos mensajes y el usuario está al final\r\n\t\tif (messages.length > prevMessagesLength && autoScroll) {\r\n\t\t\tif (messagesEndRef.current) {\r\n\t\t\t\tmessagesEndRef.current.scrollIntoView({ behavior: \"smooth\" });\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tsetPrevMessagesLength(messages.length);\r\n\t}, [messages.length, prevMessagesLength, autoScroll]);\r\n\r\n\t// Scroll inicial\r\n\tuseEffect(() => {\r\n\t\tif (messagesEndRef.current && messages.length > 0) {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tmessagesEndRef.current?.scrollIntoView({ behavior: \"auto\" });\r\n\t\t\t}, 100);\r\n\t\t}\r\n\t}, []);\r\n\r\n\t// Mostrar estado de carga inicial\r\n\tif (loading && messages.length === 0) {\r\n\t\treturn (\r\n\t\t\t<div className=\"flex justify-center items-center h-full p-8\">\r\n\t\t\t\t<div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600\"></div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\t// Mostrar estado vacío\r\n\tif (!messages.length) {\r\n\t\treturn (\r\n\t\t\t<div className=\"flex flex-col items-center justify-center h-full text-center p-8\">\r\n\t\t\t\t<div className=\"w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center mb-4\">\r\n\t\t\t\t\t<User className=\"h-8 w-8 text-gray-500\" />\r\n\t\t\t\t</div>\r\n\t\t\t\t<h3 className=\"text-lg font-medium text-gray-900 mb-2\">\r\n\t\t\t\t\t{noMessagesText}\r\n\t\t\t\t</h3>\r\n\t\t\t\t<p className=\"text-sm text-gray-500\">\r\n\t\t\t\t\tEnvía un mensaje para iniciar la conversación\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\t// Agrupar mensajes por fecha\r\n\tconst messageGroups = groupMessagesByDate(messages);\r\n\r\n\treturn (\r\n\t\t<div className=\"flex flex-col h-full bg-gray-50 relative\">\r\n\t\t\t<div\r\n\t\t\t\tclassName=\"flex-1 overflow-y-auto px-4 py-2 space-y-1 messages-scroll smooth-scroll\"\r\n\t\t\t\tstyle={{ height: \"calc(70vh - 180px)\" }}\r\n\t\t\t\tref={messagesContainerRef}\r\n\t\t\t\tonScroll={handleScroll}\r\n\t\t\t>\r\n\t\t\t\t{messageGroups.map((group, groupIndex) => (\r\n\t\t\t\t\t<div key={`${group.dateKey}-${groupIndex}`} className=\"space-y-1\">\r\n\t\t\t\t\t\t{/* Separador de fecha estilo WhatsApp */}\r\n\t\t\t\t\t\t<div className=\"flex justify-center my-4\">\r\n\t\t\t\t\t\t\t<div className=\"bg-white/80 backdrop-blur-sm px-3 py-1 rounded-full shadow-sm border border-gray-200\">\r\n\t\t\t\t\t\t\t\t<span className=\"text-xs text-gray-600 font-medium\">\r\n\t\t\t\t\t\t\t\t\t{group.date}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{/* Mensajes del día */}\r\n\t\t\t\t\t\t{group.messages.map((message, index) => {\r\n\t\t\t\t\t\t\tconst isFromCurrentUser = message.isMine || (currentUserId !== undefined && message.senderId === currentUserId);\r\n\t\t\t\t\t\t\tconst messageStatus = getMessageStatus(message, Boolean(isFromCurrentUser));\r\n\t\t\t\t\t\t\tconst previousMessage = index > 0 ? group.messages[index - 1] : null;\r\n\t\t\t\t\t\t\tconst nextMessage = index < group.messages.length - 1 ? group.messages[index + 1] : null;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tconst shouldGroup = previousMessage ? shouldGroupWithPrevious(message, previousMessage) : false;\r\n\t\t\t\t\t\t\tconst shouldGroupNext = nextMessage ? shouldGroupWithPrevious(nextMessage, message) : false;\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t// Determinar el radio de la burbuja\r\n\t\t\t\t\t\t\tconst getBubbleRadius = () => {\r\n\t\t\t\t\t\t\t\tif (isFromCurrentUser) {\r\n\t\t\t\t\t\t\t\t\t// Mensajes propios (derecha)\r\n\t\t\t\t\t\t\t\t\tif (shouldGroup && shouldGroupNext) return \"rounded-l-2xl rounded-r-md rounded-tr-2xl\"; // Medio\r\n\t\t\t\t\t\t\t\t\tif (shouldGroup) return \"rounded-l-2xl rounded-r-2xl rounded-tr-md\"; // Último\r\n\t\t\t\t\t\t\t\t\tif (shouldGroupNext) return \"rounded-2xl rounded-br-md\"; // Primero\r\n\t\t\t\t\t\t\t\t\treturn \"rounded-2xl\"; // Solo\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t// Mensajes de otros (izquierda)\r\n\t\t\t\t\t\t\t\t\tif (shouldGroup && shouldGroupNext) return \"rounded-r-2xl rounded-l-md rounded-tl-2xl\"; // Medio\r\n\t\t\t\t\t\t\t\t\tif (shouldGroup) return \"rounded-r-2xl rounded-l-2xl rounded-tl-md\"; // Último\r\n\t\t\t\t\t\t\t\t\tif (shouldGroupNext) return \"rounded-2xl rounded-bl-md\"; // Primero\r\n\t\t\t\t\t\t\t\t\treturn \"rounded-2xl\"; // Solo\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t};\r\n\r\n\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\tkey={message.id || `temp-${groupIndex}-${index}`}\r\n\t\t\t\t\t\t\t\t\tclassName={`flex ${isFromCurrentUser ? \"justify-end\" : \"justify-start\"} ${shouldGroup ? 'mt-0.5' : 'mt-3'}`}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<div className={`flex max-w-xs lg:max-w-md items-end ${isFromCurrentUser ? 'flex-row-reverse' : 'flex-row'}`}>\r\n\t\t\t\t\t\t\t\t\t\t{/* Avatar solo para mensajes de otros y cuando no está agrupado */}\r\n\t\t\t\t\t\t\t\t\t\t{!isFromCurrentUser && !shouldGroupNext && (\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex-shrink-0 mr-2 mb-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{message.sender?.avatar ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={message.sender.avatar}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\talt={message.sender?.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"h-6 w-6 rounded-full\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonError={(e) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst target = e.target as HTMLImageElement;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttarget.onerror = null;\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttarget.src = \"https://via.placeholder.com/24?text=U\";\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"h-6 w-6 rounded-full bg-gray-300 flex items-center justify-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<User className=\"h-3 w-3 text-gray-600\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t\t{/* Espaciador cuando está agrupado */}\r\n\t\t\t\t\t\t\t\t\t\t{!isFromCurrentUser && shouldGroupNext && (\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-8 flex-shrink-0\" />\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t\t{/* Burbuja del mensaje */}\r\n\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\tclassName={`\r\n\t\t\t\t\t\t\t\t\t\t\t\trelative px-3 py-2 max-w-full break-words shadow-sm\r\n\t\t\t\t\t\t\t\t\t\t\t\t${getBubbleRadius()}\r\n\t\t\t\t\t\t\t\t\t\t\t\t${isFromCurrentUser\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t? \"bg-primary-500 text-white\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t: \"bg-white text-gray-800 border border-gray-200\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t`}\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{/* Nombre del remitente (solo para mensajes de otros y cuando no está agrupado) */}\r\n\t\t\t\t\t\t\t\t\t\t\t{!isFromCurrentUser && !shouldGroup && message.sender?.name && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs font-medium text-primary-600 mb-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{message.sender.name}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t{/* Contenido del mensaje */}\r\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm whitespace-pre-wrap break-words leading-relaxed\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t{message.content}\r\n\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t{/* Información de hora y estado */}\r\n\t\t\t\t\t\t\t\t\t\t\t<div \r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={`\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tflex items-center justify-end mt-1 space-x-1\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t${isFromCurrentUser ? \"text-primary-100\" : \"text-gray-500\"}\r\n\t\t\t\t\t\t\t\t\t\t\t\t`}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{formatMessageTime(message.createdAt || '')}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t\t\t\t\t{/* Icono de estado solo para mensajes propios */}\r\n\t\t\t\t\t\t\t\t\t\t\t\t{isFromCurrentUser && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<MessageStatusIcon status={messageStatus} />\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t})}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t))}\r\n\r\n\t\t\t\t{/* Elemento para scroll automático */}\r\n\t\t\t\t<div ref={messagesEndRef} className=\"h-1\" />\r\n\r\n\t\t\t\t{/* Indicador de carga para nuevos mensajes */}\r\n\t\t\t\t{loading && messages.length > 0 && (\r\n\t\t\t\t\t<div className=\"flex justify-center py-2\">\r\n\t\t\t\t\t\t<div className=\"bg-white/80 backdrop-blur-sm px-3 py-1 rounded-full shadow-sm\">\r\n\t\t\t\t\t\t\t<div className=\"flex items-center space-x-2\">\r\n\t\t\t\t\t\t\t\t<div className=\"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-primary-600\"></div>\r\n\t\t\t\t\t\t\t\t<span className=\"text-xs text-gray-600\">Cargando mensajes...</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Botón para volver al final cuando no está en auto-scroll */}\r\n\t\t\t{!autoScroll && (\r\n\t\t\t\t<div className=\"absolute bottom-20 right-4 z-10\">\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\tsetAutoScroll(true);\r\n\t\t\t\t\t\t\tmessagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tclassName=\"bg-primary-500 text-white p-3 rounded-full shadow-lg hover:bg-primary-600 transition-all transform hover:scale-105 active:scale-95\"\r\n\t\t\t\t\t\ttitle=\"Ir al final\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<svg \r\n\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\" \r\n\t\t\t\t\t\t\twidth=\"20\" \r\n\t\t\t\t\t\t\theight=\"20\" \r\n\t\t\t\t\t\t\tviewBox=\"0 0 24 24\" \r\n\t\t\t\t\t\t\tfill=\"none\" \r\n\t\t\t\t\t\t\tstroke=\"currentColor\" \r\n\t\t\t\t\t\t\tstrokeWidth=\"2\" \r\n\t\t\t\t\t\t\tstrokeLinecap=\"round\" \r\n\t\t\t\t\t\t\tstrokeLinejoin=\"round\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<path d=\"m6 9 6 6 6-6\"/>\r\n\t\t\t\t\t\t</svg>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{/* Indicador de scroll */}\r\n\t\t\t<div className={`scroll-indicator ${messages.length > 10 ? 'visible' : ''}`}></div>\r\n\r\n\t\t\t{/* Hint de scroll para nuevos usuarios */}\r\n\t\t\t{messages.length > 10 && (\r\n\t\t\t\t<div className=\"scroll-hint\">\r\n\t\t\t\t\tDesliza para ver más mensajes\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default ChatMessages;","// src/presentation/hooks/useRealTimeChat.ts - Estados de chat en tiempo real\r\n\r\nimport { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { useAuth } from './useAuth';\r\nimport ApiClient from '../../infrastructure/api/apiClient';\r\n\r\ninterface OnlineStatus {\r\n  isOnline: boolean;\r\n  lastSeen: Date | null;\r\n  isTyping: boolean;\r\n}\r\n\r\ninterface UseRealTimeChatOptions {\r\n  chatId?: number;\r\n  participantId?: number;\r\n  pollInterval?: number;\r\n  enableTypingIndicator?: boolean;\r\n}\r\n\r\n// Interfaces para respuestas del API\r\ninterface UserStatusResponse {\r\n  data?: {\r\n    is_online?: boolean;\r\n    last_seen?: string;\r\n    is_typing?: boolean;\r\n  };\r\n}\r\n\r\ninterface UseRealTimeChatReturn {\r\n  onlineStatus: OnlineStatus;\r\n  sendTypingIndicator: (isTyping: boolean) => void;\r\n  refreshOnlineStatus: () => Promise<void>;\r\n  isConnected: boolean;\r\n}\r\n\r\n/**\r\n * Hook personalizado para manejar estados de chat en tiempo real\r\n * Incluye: estado online/offline, indicador de escritura, último visto\r\n */\r\nexport const useRealTimeChat = ({\r\n  chatId,\r\n  participantId,\r\n  pollInterval = 30000, // 30 segundos\r\n  enableTypingIndicator = true\r\n}: UseRealTimeChatOptions): UseRealTimeChatReturn => {\r\n  \r\n  const { user } = useAuth();\r\n  const [onlineStatus, setOnlineStatus] = useState<OnlineStatus>({\r\n    isOnline: false,\r\n    lastSeen: null,\r\n    isTyping: false\r\n  });\r\n  const [isConnected, setIsConnected] = useState<boolean>(navigator.onLine);\r\n  \r\n  // Referencias para controlar intervalos y timeouts\r\n  const pollIntervalRef = useRef<NodeJS.Timeout | null>(null);\r\n  const typingTimeoutRef = useRef<NodeJS.Timeout | null>(null);\r\n  const lastActivityRef = useRef<Date>(new Date());\r\n  const isPollingRef = useRef<boolean>(false);\r\n\r\n  // Actualizar estado de conexión a internet\r\n  useEffect(() => {\r\n    const handleOnline = () => setIsConnected(true);\r\n    const handleOffline = () => setIsConnected(false);\r\n\r\n    window.addEventListener('online', handleOnline);\r\n    window.addEventListener('offline', handleOffline);\r\n\r\n    return () => {\r\n      window.removeEventListener('online', handleOnline);\r\n      window.removeEventListener('offline', handleOffline);\r\n    };\r\n  }, []);\r\n\r\n  /**\r\n   * Obtiene el estado online del participante desde el backend\r\n   */\r\n  const fetchOnlineStatus = useCallback(async (): Promise<OnlineStatus | null> => {\r\n    if (!participantId || !isConnected || isPollingRef.current) {\r\n      return null;\r\n    }\r\n\r\n    try {\r\n      isPollingRef.current = true;\r\n      \r\n      // TODO: Reemplazar con tu endpoint real\r\n      const response = await ApiClient.get<UserStatusResponse>(`/api/users/${participantId}/status`);\r\n      \r\n      if (response?.data) {\r\n        const { is_online, last_seen, is_typing } = response.data;\r\n        \r\n        return {\r\n          isOnline: Boolean(is_online),\r\n          lastSeen: last_seen ? new Date(last_seen) : null,\r\n          isTyping: Boolean(is_typing)\r\n        };\r\n      }\r\n    } catch (error) {\r\n      console.warn('Error fetching online status:', error);\r\n      \r\n      // Fallback: simular estado basado en patrones realistas\r\n      return simulateOnlineStatus();\r\n    } finally {\r\n      isPollingRef.current = false;\r\n    }\r\n\r\n    return null;\r\n  }, [participantId, isConnected]);\r\n\r\n  /**\r\n   * Simula estado online cuando no hay conexión al backend\r\n   */\r\n  const simulateOnlineStatus = useCallback((): OnlineStatus => {\r\n    const now = new Date();\r\n    const randomFactor = Math.random();\r\n    \r\n    // 25% probabilidad de estar online\r\n    const isOnline = randomFactor > 0.75;\r\n    \r\n    let lastSeen: Date | null = null;\r\n    if (!isOnline) {\r\n      // Simular última actividad entre 5 min y 4 horas\r\n      const minutesAgo = Math.floor(Math.random() * 240) + 5;\r\n      lastSeen = new Date(now.getTime() - (minutesAgo * 60 * 1000));\r\n    }\r\n\r\n    // 5% probabilidad de estar escribiendo si está online\r\n    const isTyping = isOnline && Math.random() > 0.95;\r\n\r\n    return {\r\n      isOnline,\r\n      lastSeen,\r\n      isTyping\r\n    };\r\n  }, []);\r\n\r\n  /**\r\n   * Refresca el estado online del participante\r\n   */\r\n  const refreshOnlineStatus = useCallback(async (): Promise<void> => {\r\n    if (!participantId) return;\r\n\r\n    const status = await fetchOnlineStatus();\r\n    if (status) {\r\n      setOnlineStatus(status);\r\n    }\r\n  }, [fetchOnlineStatus, participantId]);\r\n\r\n  /**\r\n   * Envía indicador de escritura al backend\r\n   */\r\n  const sendTypingIndicator = useCallback(async (isTyping: boolean): Promise<void> => {\r\n    if (!enableTypingIndicator || !chatId || !user?.id || !isConnected) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Limpiar timeout anterior\r\n      if (typingTimeoutRef.current) {\r\n        clearTimeout(typingTimeoutRef.current);\r\n      }\r\n\r\n      if (isTyping) {\r\n        // Enviar indicador de \"escribiendo\"\r\n        await ApiClient.post(`/api/chats/${chatId}/typing`, {\r\n          user_id: user.id,\r\n          is_typing: true\r\n        });\r\n\r\n        // Auto-limpiar después de 3 segundos si no se actualiza\r\n        typingTimeoutRef.current = setTimeout(() => {\r\n          sendTypingIndicator(false);\r\n        }, 3000);\r\n      } else {\r\n        // Enviar indicador de \"dejó de escribir\"\r\n        await ApiClient.post(`/api/chats/${chatId}/typing`, {\r\n          user_id: user.id,\r\n          is_typing: false\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.warn('Error sending typing indicator:', error);\r\n    }\r\n  }, [enableTypingIndicator, chatId, user?.id, isConnected]);\r\n\r\n  /**\r\n   * Detecta actividad del usuario para mantener estado \"online\"\r\n   */\r\n  const updateLastActivity = useCallback(() => {\r\n    lastActivityRef.current = new Date();\r\n  }, []);\r\n\r\n  // Configurar polling del estado online\r\n  useEffect(() => {\r\n    if (!participantId || !isConnected) {\r\n      setOnlineStatus({\r\n        isOnline: false,\r\n        lastSeen: null,\r\n        isTyping: false\r\n      });\r\n      return;\r\n    }\r\n\r\n    // Primera carga\r\n    refreshOnlineStatus();\r\n\r\n    // Configurar polling\r\n    pollIntervalRef.current = setInterval(() => {\r\n      refreshOnlineStatus();\r\n    }, pollInterval);\r\n\r\n    return () => {\r\n      if (pollIntervalRef.current) {\r\n        clearInterval(pollIntervalRef.current);\r\n      }\r\n    };\r\n  }, [participantId, isConnected, pollInterval, refreshOnlineStatus]);\r\n\r\n  // Detectar actividad del usuario\r\n  useEffect(() => {\r\n    if (!enableTypingIndicator) return;\r\n\r\n    const events = ['mousemove', 'keypress', 'click', 'scroll', 'touchstart'];\r\n    \r\n    events.forEach(event => {\r\n      window.addEventListener(event, updateLastActivity, { passive: true });\r\n    });\r\n\r\n    return () => {\r\n      events.forEach(event => {\r\n        window.removeEventListener(event, updateLastActivity);\r\n      });\r\n    };\r\n  }, [enableTypingIndicator, updateLastActivity]);\r\n\r\n  // Limpiar timeouts al desmontar\r\n  useEffect(() => {\r\n    return () => {\r\n      if (pollIntervalRef.current) {\r\n        clearInterval(pollIntervalRef.current);\r\n      }\r\n      if (typingTimeoutRef.current) {\r\n        clearTimeout(typingTimeoutRef.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  // Enviar estado \"offline\" al salir de la página\r\n  useEffect(() => {\r\n    if (!user?.id || !isConnected) return;\r\n\r\n    const handleBeforeUnload = () => {\r\n      // Enviar última actividad al backend\r\n      navigator.sendBeacon(`/api/users/${user.id}/activity`, \r\n        JSON.stringify({ last_seen: new Date().toISOString() })\r\n      );\r\n    };\r\n\r\n    const handleVisibilityChange = () => {\r\n      if (document.visibilityState === 'hidden') {\r\n        handleBeforeUnload();\r\n      }\r\n    };\r\n\r\n    window.addEventListener('beforeunload', handleBeforeUnload);\r\n    document.addEventListener('visibilitychange', handleVisibilityChange);\r\n\r\n    return () => {\r\n      window.removeEventListener('beforeunload', handleBeforeUnload);\r\n      document.removeEventListener('visibilitychange', handleVisibilityChange);\r\n    };\r\n  }, [user?.id, isConnected]);\r\n\r\n  return {\r\n    onlineStatus,\r\n    sendTypingIndicator,\r\n    refreshOnlineStatus,\r\n    isConnected\r\n  };\r\n};\r\n\r\n/**\r\n * Hook para manejar el indicador de escritura del usuario actual\r\n */\r\nexport const useTypingIndicator = (chatId?: number) => {\r\n  const { sendTypingIndicator } = useRealTimeChat({ \r\n    chatId, \r\n    enableTypingIndicator: true \r\n  });\r\n  \r\n  const [isTyping, setIsTyping] = useState<boolean>(false);\r\n  const typingTimeoutRef = useRef<NodeJS.Timeout | null>(null);\r\n\r\n  const startTyping = useCallback(() => {\r\n    if (!isTyping) {\r\n      setIsTyping(true);\r\n      sendTypingIndicator(true);\r\n    }\r\n\r\n    // Resetear timeout\r\n    if (typingTimeoutRef.current) {\r\n      clearTimeout(typingTimeoutRef.current);\r\n    }\r\n\r\n    // Parar automáticamente después de 3 segundos sin actividad\r\n    typingTimeoutRef.current = setTimeout(() => {\r\n      setIsTyping(false);\r\n      sendTypingIndicator(false);\r\n    }, 3000);\r\n  }, [isTyping, sendTypingIndicator]);\r\n\r\n  const stopTyping = useCallback(() => {\r\n    if (isTyping) {\r\n      setIsTyping(false);\r\n      sendTypingIndicator(false);\r\n    }\r\n\r\n    if (typingTimeoutRef.current) {\r\n      clearTimeout(typingTimeoutRef.current);\r\n    }\r\n  }, [isTyping, sendTypingIndicator]);\r\n\r\n  // Limpiar timeout al desmontar\r\n  useEffect(() => {\r\n    return () => {\r\n      if (typingTimeoutRef.current) {\r\n        clearTimeout(typingTimeoutRef.current);\r\n      }\r\n    };\r\n  }, []);\r\n\r\n  return {\r\n    isTyping,\r\n    startTyping,\r\n    stopTyping\r\n  };\r\n};\r\n\r\nexport default useRealTimeChat;","// src/presentation/components/chat/ChatHeader.tsx - ESTADO DE CONEXIÓN REAL\r\n\r\nimport React, {useState, useRef, useEffect} from \"react\";\r\nimport {Link} from \"react-router-dom\";\r\nimport {\r\n\tUser,\r\n\tStore,\r\n\tPackage,\r\n\tChevronRight,\r\n\tCircle,\r\n\tMoreVertical,\r\n\tWifi,\r\n\tWifiOff,\r\n\tClock,\r\n} from \"lucide-react\";\r\nimport type {Chat} from \"../../../core/domain/entities/Chat\";\r\nimport { useRealTimeChat } from \"../../hooks/useRealTimeChat\";\r\n\r\ninterface ChatHeaderProps {\r\n\tchat: Chat;\r\n\tisSeller?: boolean;\r\n\tonUpdateStatus: (\r\n\t\tchatId: number,\r\n\t\tstatus: \"active\" | \"closed\" | \"archived\"\r\n\t) => Promise<boolean>;\r\n\tloading: boolean;\r\n}\r\n\r\nconst ChatHeader: React.FC<ChatHeaderProps> = ({\r\n\tchat,\r\n\tisSeller = false,\r\n\tonUpdateStatus,\r\n\tloading,\r\n}) => {\r\n\tconst [isMenuOpen, setIsMenuOpen] = useState(false);\r\n\tconst [isUpdating, setIsUpdating] = useState(false);\r\n\tconst menuRef = useRef<HTMLDivElement>(null);\r\n\r\n\t// Determinar el participante según el rol\r\n\tconst participant = isSeller\r\n\t\t? {\r\n\t\t\t\tname: chat.user?.name || `Cliente #${chat.userId}`,\r\n\t\t\t\tavatar: chat.user?.avatar,\r\n\t\t\t\tid: chat.userId,\r\n\t\t\t\ticon: <User className=\"h-6 w-6 text-gray-500\" />,\r\n\t\t\t\troute: `/admin/users/${chat.userId}`,\r\n\t\t\t}\r\n\t\t: {\r\n\t\t\t\tname: chat.seller?.storeName || `Vendedor #${chat.sellerId}`,\r\n\t\t\t\tavatar: chat.seller?.avatar,\r\n\t\t\t\tid: chat.sellerId,\r\n\t\t\t\ticon: <Store className=\"h-6 w-6 text-gray-500\" />,\r\n\t\t\t\troute: `/sellers/${chat.sellerId}`,\r\n\t\t\t};\r\n\r\n\t// Estados de conexión y escritura usando el hook real\r\n\tconst { onlineStatus } = useRealTimeChat({\r\n\t\tchatId: chat.id,\r\n\t\tparticipantId: participant.id,\r\n\t\tpollInterval: 30000,\r\n\t\tenableTypingIndicator: true\r\n\t});\r\n\r\n\tconst { isOnline, lastSeen, isTyping } = onlineStatus;\r\n\r\n\t// Ruta al producto\r\n\tconst productRoute = isSeller\r\n\t\t? `/seller/products/edit/${chat.productId}`\r\n\t\t: `/products/${chat.productId}`;\r\n\r\n\t// Cerrar menú al hacer clic fuera\r\n\tuseEffect(() => {\r\n\t\tconst handleClickOutside = (event: MouseEvent) => {\r\n\t\t\tif (menuRef.current && !menuRef.current.contains(event.target as Node)) {\r\n\t\t\t\tsetIsMenuOpen(false);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tdocument.addEventListener(\"mousedown\", handleClickOutside);\r\n\t\treturn () => {\r\n\t\t\tdocument.removeEventListener(\"mousedown\", handleClickOutside);\r\n\t\t};\r\n\t}, []);\r\n\r\n\t// Cerrar menú\r\n\tconst closeMenu = () => {\r\n\t\tsetIsMenuOpen(false);\r\n\t};\r\n\r\n\t// Cambiar estado del chat\r\n\tconst handleStatusChange = async (\r\n\t\tstatus: \"active\" | \"closed\" | \"archived\"\r\n\t) => {\r\n\t\tif (loading || isUpdating || !chat.id) return;\r\n\r\n\t\tsetIsUpdating(true);\r\n\t\tcloseMenu();\r\n\r\n\t\ttry {\r\n\t\t\tconsole.log(`Cambiando estado de chat ${chat.id} a ${status}`);\r\n\t\t\tconst success = await onUpdateStatus(chat.id, status);\r\n\r\n\t\t\tif (!success) {\r\n\t\t\t\tconsole.error(`Error al cambiar estado a ${status}`);\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(`Error al actualizar estado a ${status}:`, error);\r\n\t\t} finally {\r\n\t\t\tsetIsUpdating(false);\r\n\t\t}\r\n\t};\r\n\r\n\t// Formatear última vez visto\r\n\tconst formatLastSeen = (date: Date): string => {\r\n\t\tconst now = new Date();\r\n\t\tconst diffInMinutes = Math.floor((now.getTime() - date.getTime()) / (1000 * 60));\r\n\t\t\r\n\t\tif (diffInMinutes < 1) {\r\n\t\t\treturn 'hace un momento';\r\n\t\t} else if (diffInMinutes < 60) {\r\n\t\t\treturn `hace ${diffInMinutes} min`;\r\n\t\t} else if (diffInMinutes < 1440) {\r\n\t\t\tconst hours = Math.floor(diffInMinutes / 60);\r\n\t\t\treturn `hace ${hours} h`;\r\n\t\t} else {\r\n\t\t\tconst days = Math.floor(diffInMinutes / 1440);\r\n\t\t\tif (days === 1) return 'ayer';\r\n\t\t\tif (days < 7) return `hace ${days} días`;\r\n\t\t\treturn date.toLocaleDateString('es-EC', { day: 'numeric', month: 'short' });\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"p-4 border-b border-gray-200 bg-white shadow-sm\">\r\n\t\t\t<div className=\"flex items-center justify-between\">\r\n\t\t\t\t{/* Información del participante */}\r\n\t\t\t\t<div className=\"flex items-center flex-1 min-w-0\">\r\n\t\t\t\t\t{/* Avatar con indicador de estado mejorado */}\r\n\t\t\t\t\t<div className=\"flex-shrink-0 mr-3 relative\">\r\n\t\t\t\t\t\t{participant.avatar ? (\r\n\t\t\t\t\t\t\t<img\r\n\t\t\t\t\t\t\t\tsrc={participant.avatar}\r\n\t\t\t\t\t\t\t\talt={participant.name}\r\n\t\t\t\t\t\t\t\tclassName=\"h-12 w-12 rounded-full border-2 border-white shadow-sm\"\r\n\t\t\t\t\t\t\t\tonError={(e) => {\r\n\t\t\t\t\t\t\t\t\tconst target = e.target as HTMLImageElement;\r\n\t\t\t\t\t\t\t\t\ttarget.onerror = null;\r\n\t\t\t\t\t\t\t\t\ttarget.src = \"https://via.placeholder.com/48?text=U\";\r\n\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<div className=\"h-12 w-12 rounded-full bg-gray-200 flex items-center justify-center border-2 border-white shadow-sm\">\r\n\t\t\t\t\t\t\t\t{participant.icon}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t{/* Indicador de estado online/offline mejorado */}\r\n\t\t\t\t\t\t<div className={`absolute -bottom-1 -right-1 ${isOnline ? 'connection-indicator' : 'connection-indicator offline'}`}>\r\n\t\t\t\t\t\t\t<div className={`w-4 h-4 rounded-full border-2 border-white shadow-sm flex items-center justify-center ${\r\n\t\t\t\t\t\t\t\tisOnline ? 'bg-green-500' : 'bg-gray-400'\r\n\t\t\t\t\t\t\t}`}>\r\n\t\t\t\t\t\t\t\t{isOnline ? (\r\n\t\t\t\t\t\t\t\t\t<Wifi size={8} className=\"text-white\" />\r\n\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t<WifiOff size={8} className=\"text-white\" />\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Información del chat */}\r\n\t\t\t\t\t<div className=\"flex-1 min-w-0\">\r\n\t\t\t\t\t\t<div className=\"flex items-center space-x-2 mb-1\">\r\n\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\tto={participant.route}\r\n\t\t\t\t\t\t\t\tclassName=\"text-lg font-semibold text-gray-900 hover:text-primary-600 truncate transition-colors\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{participant.name}\r\n\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t{/* Badge de estado del chat */}\r\n\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\tclassName={`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${\r\n\t\t\t\t\t\t\t\t\tchat.status === \"active\"\r\n\t\t\t\t\t\t\t\t\t\t? \"bg-green-100 text-green-800\"\r\n\t\t\t\t\t\t\t\t\t\t: chat.status === \"closed\"\r\n\t\t\t\t\t\t\t\t\t\t\t? \"bg-blue-100 text-blue-800\"\r\n\t\t\t\t\t\t\t\t\t\t\t: \"bg-gray-100 text-gray-800\"\r\n\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<Circle className=\"w-1.5 h-1.5 mr-1\" fill=\"currentColor\" />\r\n\t\t\t\t\t\t\t\t{chat.status === \"active\"\r\n\t\t\t\t\t\t\t\t\t? \"Activo\"\r\n\t\t\t\t\t\t\t\t\t: chat.status === \"closed\"\r\n\t\t\t\t\t\t\t\t\t\t? \"Cerrado\"\r\n\t\t\t\t\t\t\t\t\t\t: \"Archivado\"}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t{/* Estado de conexión y escritura */}\r\n\t\t\t\t\t\t<div className=\"flex items-center text-sm mb-1\">\r\n\t\t\t\t\t\t\t{isTyping ? (\r\n\t\t\t\t\t\t\t\t<div className=\"flex items-center text-primary-600 font-medium\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"typing-indicator flex space-x-1 mr-2\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"w-1 h-1 bg-current rounded-full\"></div>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"w-1 h-1 bg-current rounded-full\"></div>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"w-1 h-1 bg-current rounded-full\"></div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<span>escribiendo...</span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t<div className=\"flex items-center text-gray-500\">\r\n\t\t\t\t\t\t\t\t\t{isOnline ? (\r\n\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t<Circle className=\"w-2 h-2 mr-2 fill-green-500 text-green-500\" />\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-green-600 font-medium\">En línea</span>\r\n\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t<Circle className=\"w-2 h-2 mr-2 fill-gray-400 text-gray-400\" />\r\n\t\t\t\t\t\t\t\t\t\t\t<span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{lastSeen ? `Visto ${formatLastSeen(lastSeen)}` : 'Desconectado'}\r\n\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t{/* Información del producto */}\r\n\t\t\t\t\t\t<div className=\"flex items-center text-sm text-gray-500\">\r\n\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\tto={productRoute}\r\n\t\t\t\t\t\t\t\tclassName=\"text-primary-600 hover:text-primary-700 hover:underline flex items-center truncate\"\r\n\t\t\t\t\t\t\t\ttitle={chat.product?.name || `Producto #${chat.productId}`}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<Package className=\"h-3.5 w-3.5 mr-1 flex-shrink-0\" />\r\n\t\t\t\t\t\t\t\t<span className=\"truncate max-w-xs\">\r\n\t\t\t\t\t\t\t\t\t{chat.product?.name || `Producto #${chat.productId}`}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t<ChevronRight size={14} className=\"ml-1 flex-shrink-0\" />\r\n\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{/* Menú de acciones */}\r\n\t\t\t\t<div className=\"flex items-center space-x-2\">\r\n\t\t\t\t\t{/* Indicador de carga */}\r\n\t\t\t\t\t{(loading || isUpdating) && (\r\n\t\t\t\t\t\t<div className=\"flex items-center text-gray-500\">\r\n\t\t\t\t\t\t\t<div className=\"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-gray-400 mr-2\"></div>\r\n\t\t\t\t\t\t\t<span className=\"text-sm\">\r\n\t\t\t\t\t\t\t\t{isUpdating ? 'Actualizando...' : 'Cargando...'}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{/* Menú desplegable */}\r\n\t\t\t\t\t<div className=\"relative\" ref={menuRef}>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={() => setIsMenuOpen(!isMenuOpen)}\r\n\t\t\t\t\t\t\tclassName=\"p-2 rounded-full hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-primary-500 transition-colors\"\r\n\t\t\t\t\t\t\tdisabled={loading || isUpdating}\r\n\t\t\t\t\t\t\ttitle=\"Más opciones\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<MoreVertical className=\"h-5 w-5 text-gray-600\" />\r\n\t\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t\t{/* Menú desplegable */}\r\n\t\t\t\t\t\t{isMenuOpen && (\r\n\t\t\t\t\t\t\t<div className=\"absolute right-0 z-20 mt-2 w-56 bg-white rounded-lg shadow-lg border border-gray-200 py-1\">\r\n\t\t\t\t\t\t\t\t{/* Información adicional */}\r\n\t\t\t\t\t\t\t\t<div className=\"px-4 py-2 border-b border-gray-100\">\r\n\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-gray-500\">Chat ID: {chat.id}</p>\r\n\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-gray-500\">\r\n\t\t\t\t\t\t\t\t\t\tCreado: {chat.createdAt ? new Date(chat.createdAt).toLocaleDateString('es-EC') : 'N/A'}\r\n\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t{/* Acciones de estado */}\r\n\t\t\t\t\t\t\t\t{chat.status === \"active\" && (\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => handleStatusChange(\"closed\")}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors\"\r\n\t\t\t\t\t\t\t\t\t\tdisabled={loading || isUpdating}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<Clock className=\"inline h-4 w-4 mr-2\" />\r\n\t\t\t\t\t\t\t\t\t\tCerrar conversación\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t{chat.status === \"closed\" && (\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => handleStatusChange(\"active\")}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors\"\r\n\t\t\t\t\t\t\t\t\t\tdisabled={loading || isUpdating}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t<Circle className=\"inline h-4 w-4 mr-2\" />\r\n\t\t\t\t\t\t\t\t\t\tReabrir conversación\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t{chat.status !== \"archived\" && (\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => handleStatusChange(\"archived\")}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors\"\r\n\t\t\t\t\t\t\t\t\t\tdisabled={loading || isUpdating}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t📦 Archivar conversación\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t{chat.status === \"archived\" && (\r\n\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\tonClick={() => handleStatusChange(\"active\")}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors\"\r\n\t\t\t\t\t\t\t\t\t\tdisabled={loading || isUpdating}\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t📤 Desarchivar conversación\r\n\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t\t{/* Enlaces adicionales */}\r\n\t\t\t\t\t\t\t\t<div className=\"border-t border-gray-100 mt-1\">\r\n\t\t\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\t\t\tto={participant.route}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t👤 Ver perfil\r\n\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\t\t\tto={productRoute}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t📦 Ver producto\r\n\t\t\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default ChatHeader;","import React, {useState, useRef, useEffect} from \"react\";\r\nimport type {FormEvent, KeyboardEvent} from \"react\";\r\nimport {Send, Loader2, Smile, Search, Clock} from \"lucide-react\";\r\nimport { useTypingIndicator } from \"../../hooks/useRealTimeChat\";\r\n\r\ninterface MessageFormProps {\r\n\tonSendMessage: (message: string) => Promise<boolean>;\r\n\tisDisabled?: boolean;\r\n\tdisabledText?: string;\r\n\tplaceholder?: string;\r\n\tisLoading?: boolean;\r\n\tchatId?: number; // Para el indicador de escritura\r\n}\r\n\r\n// Lista expandida de emojis organizados por categorías\r\nconst EMOJI_CATEGORIES = {\r\n\t\"Frecuentes\": {\r\n\t\ticon: \"🕒\",\r\n\t\temojis: [\"😊\", \"😂\", \"❤️\", \"👍\", \"👌\", \"🙏\", \"😍\", \"🎉\", \"🤔\", \"😭\", \"🔥\", \"💪\"]\r\n\t},\r\n\t\"Emociones\": {\r\n\t\ticon: \"😊\",\r\n\t\temojis: [\r\n\t\t\t\"😀\", \"😃\", \"😄\", \"😁\", \"😆\", \"😅\", \"😂\", \"🤣\", \"😊\", \"😇\", \"🙂\", \"🙃\", \r\n\t\t\t\"😉\", \"😌\", \"😍\", \"🥰\", \"😘\", \"😗\", \"😙\", \"😚\", \"😋\", \"😛\", \"😝\", \"😜\", \r\n\t\t\t\"🤪\", \"🤨\", \"🧐\", \"🤓\", \"😎\", \"🤩\", \"🥳\", \"😏\", \"😒\", \"😞\", \"😔\", \"😟\", \r\n\t\t\t\"😕\", \"🙁\", \"☹️\", \"😣\", \"😖\", \"😫\", \"😩\", \"🥺\", \"😢\", \"😭\", \"😤\", \"😠\", \r\n\t\t\t\"😡\", \"🤬\", \"🤯\", \"😳\", \"🥵\", \"🥶\", \"😱\", \"😨\", \"😰\", \"😥\", \"😓\", \"🤗\", \r\n\t\t\t\"🤔\", \"🤭\", \"🤫\", \"🤥\", \"😶\", \"😐\", \"😑\", \"😬\", \"🙄\", \"😯\", \"😦\", \"😧\", \r\n\t\t\t\"😮\", \"😲\", \"🥱\", \"😴\", \"🤤\", \"😪\", \"😵\", \"🤐\", \"🥴\", \"🤢\", \"🤮\", \"🤧\", \r\n\t\t\t\"😷\", \"🤒\", \"🤕\"\r\n\t\t]\r\n\t},\r\n\t\"Gestos\": {\r\n\t\ticon: \"👍\",\r\n\t\temojis: [\r\n\t\t\t\"👍\", \"👎\", \"👌\", \"🤌\", \"🤏\", \"✌️\", \"🤞\", \"🤟\", \"🤘\", \"🤙\", \"👈\", \"👉\", \r\n\t\t\t\"👆\", \"🖕\", \"👇\", \"☝️\", \"👏\", \"🙌\", \"👐\", \"🤲\", \"🤝\", \"🙏\", \"✍️\", \"💅\", \r\n\t\t\t\"🤳\", \"💪\", \"🦾\", \"🦿\", \"🦵\", \"🦶\", \"👂\", \"🦻\", \"👃\", \"🧠\", \"🫀\", \"🫁\", \r\n\t\t\t\"🦷\", \"🦴\", \"👀\", \"👁️\", \"👅\", \"👄\", \"💋\"\r\n\t\t]\r\n\t},\r\n\t\"Objetos\": {\r\n\t\ticon: \"❤️\",\r\n\t\temojis: [\r\n\t\t\t\"❤️\", \"🧡\", \"💛\", \"💚\", \"💙\", \"💜\", \"🖤\", \"🤍\", \"🤎\", \"💔\", \"❣️\", \"💕\", \r\n\t\t\t\"💞\", \"💓\", \"💗\", \"💖\", \"💘\", \"💝\", \"💟\", \"☮️\", \"✝️\", \"☪️\", \"🕉️\", \"☸️\", \r\n\t\t\t\"✡️\", \"🔯\", \"🕎\", \"☯️\", \"☦️\", \"🛐\", \"⛎\", \"♈\", \"♉\", \"♊\", \"♋\", \"♌\", \"♍\", \r\n\t\t\t\"♎\", \"♏\", \"♐\", \"♑\", \"♒\", \"♓\", \"🔥\", \"💯\", \"💢\", \"💦\", \"💨\", \"🎉\", \"🎊\", \r\n\t\t\t\"🎈\", \"🎁\", \"🏆\", \"🥇\", \"🥈\", \"🥉\", \"⭐\", \"🌟\", \"💫\", \"✨\"\r\n\t\t]\r\n\t},\r\n\t\"Animales\": {\r\n\t\ticon: \"🐶\",\r\n\t\temojis: [\r\n\t\t\t\"🐶\", \"🐱\", \"🐭\", \"🐹\", \"🐰\", \"🦊\", \"🐻\", \"🐼\", \"🐻‍❄️\", \"🐨\", \"🐯\", \"🦁\", \r\n\t\t\t\"🐮\", \"🐷\", \"🐽\", \"🐸\", \"🐵\", \"🙈\", \"🙉\", \"🙊\", \"🐒\", \"🐔\", \"🐧\", \"🐦\", \r\n\t\t\t\"🐤\", \"🐣\", \"🐥\", \"🦆\", \"🦅\", \"🦉\", \"🦇\", \"🐺\", \"🐗\", \"🐴\", \"🦄\", \"🐝\", \r\n\t\t\t\"🐛\", \"🦋\", \"🐌\", \"🐞\", \"🐜\", \"🦟\", \"🦗\", \"🕷️\", \"🦂\", \"🐢\", \"🐍\", \"🦎\", \r\n\t\t\t\"🦖\", \"🦕\", \"🐙\", \"🦑\", \"🦐\", \"🦞\", \"🦀\", \"🐡\", \"🐠\", \"🐟\", \"🐬\", \"🐳\", \r\n\t\t\t\"🐋\", \"🦈\", \"🐊\", \"🐅\", \"🐆\", \"🦓\", \"🦍\", \"🦧\", \"🐘\", \"🦣\", \"🦏\", \"🦛\", \r\n\t\t\t\"🐪\", \"🐫\", \"🦒\", \"🦘\", \"🐃\", \"🐂\", \"🐄\", \"🐎\", \"🐖\", \"🐏\", \"🐑\", \"🦙\", \r\n\t\t\t\"🐐\", \"🦌\", \"🐕\", \"🐩\", \"🦮\", \"🐕‍🦺\", \"🐈\", \"🐈‍⬛\", \"🐓\", \"🦃\", \"🦚\", \"🦜\", \r\n\t\t\t\"🦢\", \"🦩\", \"🕊️\", \"🐇\", \"🦝\", \"🦨\", \"🦡\", \"🦦\", \"🦥\", \"🐁\", \"🐀\", \"🐿️\"\r\n\t\t]\r\n\t},\r\n\t\"Comida\": {\r\n\t\ticon: \"🍕\",\r\n\t\temojis: [\r\n\t\t\t\"🍎\", \"🍏\", \"🍐\", \"🍊\", \"🍋\", \"🍌\", \"🍉\", \"🍇\", \"🍓\", \"🫐\", \"🍈\", \"🍒\", \r\n\t\t\t\"🍑\", \"🥭\", \"🍍\", \"🥥\", \"🥝\", \"🍅\", \"🍆\", \"🥑\", \"🥦\", \"🥬\", \"🥒\", \"🌶️\", \r\n\t\t\t\"🫑\", \"🌽\", \"🥕\", \"🫒\", \"🧄\", \"🧅\", \"🥔\", \"🍠\", \"🥐\", \"🥯\", \"🍞\", \"🥖\", \r\n\t\t\t\"🥨\", \"🧀\", \"🥚\", \"🍳\", \"🧈\", \"🥞\", \"🧇\", \"🥓\", \"🥩\", \"🍗\", \"🍖\", \"🦴\", \r\n\t\t\t\"🌭\", \"🍔\", \"🍟\", \"🍕\", \"🫓\", \"🥪\", \"🥙\", \"🧆\", \"🌮\", \"🌯\", \"🫔\", \"🥗\", \r\n\t\t\t\"🥘\", \"🫕\", \"🥫\", \"🍝\", \"🍜\", \"🍲\", \"🍛\", \"🍣\", \"🍱\", \"🥟\", \"🦪\", \"🍤\", \r\n\t\t\t\"🍙\", \"🍚\", \"🍘\", \"🍥\", \"🥠\", \"🥮\", \"🍢\", \"🍡\", \"🍧\", \"🍨\", \"🍦\", \"🥧\", \r\n\t\t\t\"🧁\", \"🍰\", \"🎂\", \"🍮\", \"🍭\", \"🍬\", \"🍫\", \"🍿\", \"🍩\", \"🍪\", \"🌰\", \"🥜\"\r\n\t\t]\r\n\t},\r\n\t\"Actividades\": {\r\n\t\ticon: \"⚽\",\r\n\t\temojis: [\r\n\t\t\t\"⚽\", \"🏀\", \"🏈\", \"⚾\", \"🥎\", \"🎾\", \"🏐\", \"🏉\", \"🥏\", \"🎱\", \"🪀\", \"🏓\", \r\n\t\t\t\"🏸\", \"🏑\", \"🏒\", \"🥍\", \"🏏\", \"🪃\", \"🥅\", \"⛳\", \"🪁\", \"🏹\", \"🎣\", \"🤿\", \r\n\t\t\t\"🥊\", \"🥋\", \"🎽\", \"🛹\", \"🛷\", \"⛸️\", \"🥌\", \"🎿\", \"⛷️\", \"🏂\", \"🪂\", \"🏋️\", \r\n\t\t\t\"🤼\", \"🤸\", \"⛹️\", \"🤺\", \"🏌️\", \"🏇\", \"🧘\", \"🏄\", \"🏊\", \"🤽\", \"🚣\", \"🧗\", \r\n\t\t\t\"🚵\", \"🚴\", \"🏆\", \"🥇\", \"🥈\", \"🥉\", \"🏅\", \"🎖️\", \"🏵️\", \"🎗️\", \"🎫\", \"🎟️\", \r\n\t\t\t\"🎪\", \"🤹\", \"🎭\", \"🩰\", \"🎨\", \"🎬\", \"🎤\", \"🎧\", \"🎼\", \"🎵\", \"🎶\", \"🎹\", \r\n\t\t\t\"🥁\", \"🎷\", \"🎺\", \"🎸\", \"🪕\", \"🎻\", \"🎲\", \"♠️\", \"♥️\", \"♦️\", \"♣️\", \"♟️\", \r\n\t\t\t\"🃏\", \"🀄\", \"🎴\", \"🎮\", \"🕹️\", \"🎯\"\r\n\t\t]\r\n\t},\r\n\t\"Viajes\": {\r\n\t\ticon: \"✈️\",\r\n\t\temojis: [\r\n\t\t\t\"🚗\", \"🚕\", \"🚙\", \"🚌\", \"🚎\", \"🏎️\", \"🚓\", \"🚑\", \"🚒\", \"🚐\", \"🛻\", \"🚚\", \r\n\t\t\t\"🚛\", \"🚜\", \"🏍️\", \"🛵\", \"🚲\", \"🛴\", \"🛹\", \"🛼\", \"🚁\", \"🛸\", \"✈️\", \"🛩️\", \r\n\t\t\t\"🛫\", \"🛬\", \"🪂\", \"⛵\", \"🚤\", \"🛥️\", \"🛳️\", \"⛴️\", \"🚢\", \"⚓\", \"⛽\", \"🚧\", \r\n\t\t\t\"🚦\", \"🚥\", \"🚏\", \"🗺️\", \"🎡\", \"🎢\", \"🎠\", \"⛲\", \"⛱️\", \"🏖️\", \"🏝️\", \"🏜️\", \r\n\t\t\t\"🌋\", \"⛰️\", \"🏔️\", \"🗻\", \"🏕️\", \"⛺\", \"🏠\", \"🏡\", \"🏘️\", \"🏚️\", \"🏗️\", \"🏭\", \r\n\t\t\t\"🏢\", \"🏬\", \"🏣\", \"🏤\", \"🏥\", \"🏦\", \"🏨\", \"🏪\", \"🏫\", \"🏩\", \"💒\", \"🏛️\", \r\n\t\t\t\"⛪\", \"🕌\", \"🛕\", \"🕍\", \"🕋\", \"⛩️\", \"🛤️\", \"🛣️\", \"🗾\", \"🎑\", \"🏞️\", \"🌅\", \r\n\t\t\t\"🌄\", \"🌠\", \"🎇\", \"🎆\", \"🌇\", \"🌆\", \"🏙️\", \"🌃\", \"🌌\", \"🌉\", \"🌁\"\r\n\t\t]\r\n\t}\r\n};\r\n\r\n// Lista de emojis frecuentes que se actualiza dinámicamente\r\nconst getFrequentEmojis = () => {\r\n\ttry {\r\n\t\tconst stored = localStorage.getItem('frequent-emojis');\r\n\t\tif (stored) {\r\n\t\t\tconst frequent = JSON.parse(stored);\r\n\t\t\treturn frequent.slice(0, 12); // Solo los 12 más frecuentes\r\n\t\t}\r\n\t} catch (error) {\r\n\t\tconsole.error('Error loading frequent emojis:', error);\r\n\t}\r\n\treturn EMOJI_CATEGORIES[\"Frecuentes\"].emojis;\r\n};\r\n\r\n// Función para guardar uso de emoji\r\nconst saveEmojiUsage = (emoji: string) => {\r\n\ttry {\r\n\t\tconst stored = localStorage.getItem('frequent-emojis');\r\n\t\tlet frequent: string[] = stored ? JSON.parse(stored) : [];\r\n\t\t\r\n\t\t// Remover si ya existe y agregarlo al principio\r\n\t\tfrequent = frequent.filter(e => e !== emoji);\r\n\t\tfrequent.unshift(emoji);\r\n\t\t\r\n\t\t// Mantener solo los 20 más frecuentes\r\n\t\tfrequent = frequent.slice(0, 20);\r\n\t\t\r\n\t\tlocalStorage.setItem('frequent-emojis', JSON.stringify(frequent));\r\n\t} catch (error) {\r\n\t\tconsole.error('Error saving emoji usage:', error);\r\n\t}\r\n};\r\n\r\nconst MessageForm: React.FC<MessageFormProps> = ({\r\n\tonSendMessage,\r\n\tisDisabled = false,\r\n\tdisabledText = \"Esta conversación está cerrada\",\r\n\tplaceholder = \"Escribe un mensaje...\",\r\n\tisLoading = false,\r\n\tchatId,\r\n}) => {\r\n\tconst [message, setMessage] = useState(\"\");\r\n\tconst [error, setError] = useState<string | null>(null);\r\n\tconst [showEmojiPicker, setShowEmojiPicker] = useState(false);\r\n\tconst [selectedCategory, setSelectedCategory] = useState(\"Frecuentes\");\r\n\tconst [emojiSearch, setEmojiSearch] = useState(\"\");\r\n\tconst [recentEmojis, setRecentEmojis] = useState<string[]>(() => getFrequentEmojis());\r\n\t\r\n\tconst textareaRef = useRef<HTMLTextAreaElement>(null);\r\n\tconst emojiPickerRef = useRef<HTMLDivElement>(null);\r\n\tconst emojiSearchRef = useRef<HTMLInputElement>(null);\r\n\tconst isMounted = useRef(true);\r\n\r\n\t// Hook para indicador de escritura\r\n\tconst { startTyping, stopTyping } = useTypingIndicator(chatId);\r\n\r\n\tuseEffect(() => {\r\n\t\treturn () => {\r\n\t\t\tisMounted.current = false;\r\n\t\t\t// Detener indicador de escritura al desmontar\r\n\t\t\tstopTyping();\r\n\t\t};\r\n\t}, [stopTyping]);\r\n\r\n\t// Actualizar emojis frecuentes cuando se abre el picker\r\n\tuseEffect(() => {\r\n\t\tif (showEmojiPicker) {\r\n\t\t\tsetRecentEmojis(getFrequentEmojis());\r\n\t\t}\r\n\t}, [showEmojiPicker]);\r\n\r\n\t// Al montar el componente, enfocar el textarea\r\n\tuseEffect(() => {\r\n\t\tif (textareaRef.current && !isDisabled) {\r\n\t\t\ttextareaRef.current.focus();\r\n\t\t}\r\n\t}, [isDisabled]);\r\n\r\n\t// Cerrar emoji picker cuando se hace clic fuera\r\n\tuseEffect(() => {\r\n\t\tconst handleClickOutside = (event: MouseEvent) => {\r\n\t\t\tif (emojiPickerRef.current && !emojiPickerRef.current.contains(event.target as Node)) {\r\n\t\t\t\tsetShowEmojiPicker(false);\r\n\t\t\t\tsetEmojiSearch(\"\");\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tif (showEmojiPicker) {\r\n\t\t\tdocument.addEventListener(\"mousedown\", handleClickOutside);\r\n\t\t}\r\n\r\n\t\treturn () => {\r\n\t\t\tdocument.removeEventListener(\"mousedown\", handleClickOutside);\r\n\t\t};\r\n\t}, [showEmojiPicker]);\r\n\r\n\t// Focus en búsqueda cuando se abre el picker\r\n\tuseEffect(() => {\r\n\t\tif (showEmojiPicker && emojiSearchRef.current) {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\temojiSearchRef.current?.focus();\r\n\t\t\t}, 100);\r\n\t\t}\r\n\t}, [showEmojiPicker]);\r\n\r\n\tconst handleSubmit = async (e: FormEvent) => {\r\n\t\te.preventDefault();\r\n\r\n\t\tsetError(null);\r\n\r\n\t\tif (isDisabled || isLoading || !message.trim()) {\r\n\t\t\tconsole.log(\"Envío bloqueado:\", {\r\n\t\t\t\tisDisabled,\r\n\t\t\t\tisLoading,\r\n\t\t\t\tmessageEmpty: !message.trim(),\r\n\t\t\t});\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst messageToSend = message.trim();\r\n\r\n\t\t// Detener indicador de escritura\r\n\t\tstopTyping();\r\n\r\n\t\ttry {\r\n\t\t\tconsole.log(\"Enviando mensaje:\", messageToSend);\r\n\t\t\tconst success = await onSendMessage(messageToSend);\r\n\r\n\t\t\tif (isMounted.current) {\r\n\t\t\t\tif (success) {\r\n\t\t\t\t\tconsole.log(\"Mensaje enviado correctamente\");\r\n\t\t\t\t\tsetMessage(\"\");\r\n\t\t\t\t\t// Reset altura del textarea\r\n\t\t\t\t\tif (textareaRef.current) {\r\n\t\t\t\t\t\ttextareaRef.current.style.height = \"auto\";\r\n\t\t\t\t\t\ttextareaRef.current.focus();\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.error(\"Error al enviar mensaje\");\r\n\t\t\t\t\tsetError(\"No se pudo enviar el mensaje. Inténtalo de nuevo.\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al enviar mensaje:\", error);\r\n\t\t\tif (isMounted.current) {\r\n\t\t\t\tsetError(\"Error al enviar mensaje. Por favor, inténtalo de nuevo.\");\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleKeyDown = (e: KeyboardEvent<HTMLTextAreaElement>) => {\r\n\t\tif (error) {\r\n\t\t\tsetError(null);\r\n\t\t}\r\n\r\n\t\t// Enviar con Ctrl+Enter o Cmd+Enter (Mac)\r\n\t\tif ((e.ctrlKey || e.metaKey) && e.key === \"Enter\") {\r\n\t\t\te.preventDefault();\r\n\t\t\thandleSubmit(e);\r\n\t\t}\r\n\t};\r\n\r\n\t// Ajustar altura automáticamente y activar indicador de escritura\r\n\tconst autoAdjustHeight = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n\t\tconst textarea = e.target;\r\n\t\tconst newValue = textarea.value;\r\n\r\n\t\ttextarea.style.height = \"auto\";\r\n\r\n\t\tconst newHeight = Math.min(Math.max(textarea.scrollHeight, 40), 150);\r\n\t\ttextarea.style.height = `${newHeight}px`;\r\n\r\n\t\tsetMessage(newValue);\r\n\r\n\t\t// Manejar indicador de escritura\r\n\t\tif (newValue.trim() && !isDisabled && !isLoading) {\r\n\t\t\tstartTyping();\r\n\t\t} else if (!newValue.trim()) {\r\n\t\t\tstopTyping();\r\n\t\t}\r\n\t};\r\n\r\n\t// Insertar emoji en el mensaje\r\n\tconst insertEmoji = (emoji: string) => {\r\n\t\tconst textarea = textareaRef.current;\r\n\t\tif (!textarea) return;\r\n\r\n\t\tconst start = textarea.selectionStart;\r\n\t\tconst end = textarea.selectionEnd;\r\n\t\tconst newMessage = message.slice(0, start) + emoji + message.slice(end);\r\n\t\t\r\n\t\tsetMessage(newMessage);\r\n\t\t\r\n\t\t// Guardar uso del emoji\r\n\t\tsaveEmojiUsage(emoji);\r\n\t\t\r\n\t\t// Restaurar la posición del cursor después del emoji\r\n\t\tsetTimeout(() => {\r\n\t\t\tif (textarea) {\r\n\t\t\t\ttextarea.focus();\r\n\t\t\t\ttextarea.setSelectionRange(start + emoji.length, start + emoji.length);\r\n\t\t\t\t// Reajustar altura\r\n\t\t\t\ttextarea.style.height = \"auto\";\r\n\t\t\t\tconst newHeight = Math.min(Math.max(textarea.scrollHeight, 40), 150);\r\n\t\t\t\ttextarea.style.height = `${newHeight}px`;\r\n\t\t\t}\r\n\t\t}, 0);\r\n\t};\r\n\r\n\t// Filtrar emojis por búsqueda\r\n\tconst getFilteredEmojis = (categoryEmojis: string[]) => {\r\n\t\tif (!emojiSearch.trim()) return categoryEmojis;\r\n\t\t\r\n\t\t// Buscar por el texto del emoji (muy básico)\r\n\t\treturn categoryEmojis.filter(emoji => {\r\n\t\t\t// Aquí podrías implementar una búsqueda más sofisticada con nombres de emojis\r\n\t\t\treturn emoji.includes(emojiSearch.trim());\r\n\t\t});\r\n\t};\r\n\r\n\t// Obtener emojis de la categoría actual\r\n\tconst getCurrentEmojis = () => {\r\n\t\tif (selectedCategory === \"Frecuentes\") {\r\n\t\t\treturn getFilteredEmojis(recentEmojis);\r\n\t\t}\r\n\t\treturn getFilteredEmojis(EMOJI_CATEGORIES[selectedCategory as keyof typeof EMOJI_CATEGORIES].emojis);\r\n\t};\r\n\r\n\t// Si el chat está deshabilitado, mostrar mensaje informativo\r\n\tif (isDisabled) {\r\n\t\treturn (\r\n\t\t\t<div className=\"p-4 border-t border-gray-200 bg-gray-50\">\r\n\t\t\t\t<div className=\"flex items-center justify-center space-x-2 text-gray-500\">\r\n\t\t\t\t\t<Clock size={16} />\r\n\t\t\t\t\t<p className=\"text-sm\">{disabledText}</p>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"p-4 border-t border-gray-200 bg-white relative\">\r\n\t\t\t{error && (\r\n\t\t\t\t<div className=\"mb-3 p-3 bg-red-50 border border-red-200 text-red-600 text-sm rounded-lg flex items-start space-x-2\">\r\n\t\t\t\t\t<div className=\"flex-shrink-0 mt-0.5\">\r\n\t\t\t\t\t\t⚠️\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"flex-1\">\r\n\t\t\t\t\t\t{error}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<button \r\n\t\t\t\t\t\tonClick={() => setError(null)}\r\n\t\t\t\t\t\tclassName=\"flex-shrink-0 text-red-400 hover:text-red-600\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t×\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{/* Emoji Picker Mejorado */}\r\n\t\t\t{showEmojiPicker && (\r\n\t\t\t\t<div \r\n\t\t\t\t\tref={emojiPickerRef}\r\n\t\t\t\t\tclassName=\"absolute bottom-full left-4 right-4 mb-2 bg-white border border-gray-300 rounded-xl shadow-xl z-50 overflow-hidden\"\r\n\t\t\t\t\tstyle={{ maxHeight: '320px' }}\r\n\t\t\t\t>\r\n\t\t\t\t\t{/* Header con búsqueda */}\r\n\t\t\t\t\t<div className=\"p-3 border-b border-gray-200 bg-gray-50\">\r\n\t\t\t\t\t\t<div className=\"relative\">\r\n\t\t\t\t\t\t\t<Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\" size={16} />\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\tref={emojiSearchRef}\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\tplaceholder=\"Buscar emojis...\"\r\n\t\t\t\t\t\t\t\tvalue={emojiSearch}\r\n\t\t\t\t\t\t\t\tonChange={(e) => setEmojiSearch(e.target.value)}\r\n\t\t\t\t\t\t\t\tclassName=\"w-full pl-10 pr-4 py-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Pestañas de categorías */}\r\n\t\t\t\t\t<div className=\"border-b border-gray-200 bg-gray-50\">\r\n\t\t\t\t\t\t<div className=\"flex overflow-x-auto scrollbar-hide\">\r\n\t\t\t\t\t\t\t{Object.entries(EMOJI_CATEGORIES).map(([categoryName, categoryData]) => (\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tkey={categoryName}\r\n\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\tsetSelectedCategory(categoryName);\r\n\t\t\t\t\t\t\t\t\t\tsetEmojiSearch(\"\");\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\tclassName={`flex-shrink-0 px-3 py-2 text-lg hover:bg-gray-100 transition-colors ${\r\n\t\t\t\t\t\t\t\t\t\tselectedCategory === categoryName\r\n\t\t\t\t\t\t\t\t\t\t\t? \"bg-primary-100 border-b-2 border-primary-500\"\r\n\t\t\t\t\t\t\t\t\t\t\t: \"\"\r\n\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t\ttitle={categoryName}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{categoryName === \"Frecuentes\" ? \"🕒\" : categoryData.icon}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Grid de emojis con scroll personalizado */}\r\n\t\t\t\t\t<div className=\"p-2 max-h-48 overflow-y-auto emoji-scroll\">\r\n\t\t\t\t\t\t<div className=\"grid grid-cols-8 gap-1\">\r\n\t\t\t\t\t\t\t{getCurrentEmojis().map((emoji, index) => (\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tkey={`${emoji}-${index}`}\r\n\t\t\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t\t\tinsertEmoji(emoji);\r\n\t\t\t\t\t\t\t\t\t\t// No cerrar el picker automáticamente para permitir múltiples selecciones\r\n\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\tclassName=\"p-2 text-lg hover:bg-gray-100 rounded-lg transition-colors transform hover:scale-110 active:scale-95\"\r\n\t\t\t\t\t\t\t\t\ttitle={emoji}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{emoji}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t{getCurrentEmojis().length === 0 && (\r\n\t\t\t\t\t\t\t<div className=\"text-center py-8 text-gray-500\">\r\n\t\t\t\t\t\t\t\t<div className=\"text-2xl mb-2\">🔍</div>\r\n\t\t\t\t\t\t\t\t<p className=\"text-sm\">No se encontraron emojis</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Footer */}\r\n\t\t\t\t\t<div className=\"p-2 border-t border-gray-200 bg-gray-50 text-center\">\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={() => setShowEmojiPicker(false)}\r\n\t\t\t\t\t\t\tclassName=\"text-xs text-gray-500 hover:text-gray-700\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tPresiona ESC para cerrar\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t<form onSubmit={handleSubmit} className=\"flex items-end space-x-3\">\r\n\t\t\t\t{/* Botón de emojis */}\r\n\t\t\t\t<button\r\n\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\tonClick={() => setShowEmojiPicker(!showEmojiPicker)}\r\n\t\t\t\t\tclassName={`flex-shrink-0 p-2 rounded-full transition-colors ${\r\n\t\t\t\t\t\tshowEmojiPicker \r\n\t\t\t\t\t\t\t? \"bg-primary-100 text-primary-600\" \r\n\t\t\t\t\t\t\t: \"text-gray-500 hover:text-gray-700 hover:bg-gray-100\"\r\n\t\t\t\t\t}`}\r\n\t\t\t\t\tdisabled={isLoading}\r\n\t\t\t\t\ttitle=\"Insertar emoji\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<Smile size={20} />\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t{/* Campo de texto */}\r\n\t\t\t\t<div className=\"flex-1\">\r\n\t\t\t\t\t<textarea\r\n\t\t\t\t\t\tref={textareaRef}\r\n\t\t\t\t\t\tvalue={message}\r\n\t\t\t\t\t\tonChange={autoAdjustHeight}\r\n\t\t\t\t\t\tonKeyDown={handleKeyDown}\r\n\t\t\t\t\t\tplaceholder={placeholder}\r\n\t\t\t\t\t\tclassName=\"w-full border border-gray-300 rounded-2xl px-4 py-3 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 resize-none scrollbar-thin scrollbar-thumb-gray-300 scrollbar-track-transparent\"\r\n\t\t\t\t\t\trows={1}\r\n\t\t\t\t\t\tstyle={{minHeight: \"44px\", maxHeight: \"150px\"}}\r\n\t\t\t\t\t\tdisabled={isLoading}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<div className=\"flex items-center justify-between mt-1 px-1\">\r\n\t\t\t\t\t\t<p className=\"text-xs text-gray-500\">\r\n\t\t\t\t\t\t\t{isLoading ? \"Enviando...\" : \"Ctrl+Enter para enviar\"}\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t{message.length > 0 && (\r\n\t\t\t\t\t\t\t<p className=\"text-xs text-gray-400\">\r\n\t\t\t\t\t\t\t\t{message.length}/2000\r\n\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{/* Botón de envío */}\r\n\t\t\t\t<button\r\n\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\tclassName={`flex-shrink-0 h-11 w-11 rounded-full flex items-center justify-center transition-all transform ${\r\n\t\t\t\t\t\tmessage.trim() && !isLoading\r\n\t\t\t\t\t\t\t? \"bg-primary-600 text-white hover:bg-primary-700 hover:scale-105 active:scale-95 shadow-lg\"\r\n\t\t\t\t\t\t\t: \"bg-gray-300 text-gray-600 cursor-not-allowed\"\r\n\t\t\t\t\t}`}\r\n\t\t\t\t\tdisabled={!message.trim() || isLoading}\r\n\t\t\t\t\ttitle={isLoading ? \"Enviando...\" : \"Enviar mensaje\"}\r\n\t\t\t\t>\r\n\t\t\t\t\t{isLoading ? (\r\n\t\t\t\t\t\t<Loader2 className=\"h-5 w-5 animate-spin\" />\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<Send size={18} />\r\n\t\t\t\t\t)}\r\n\t\t\t\t</button>\r\n\t\t\t</form>\r\n\r\n\t\t\t{/* Atajos de teclado */}\r\n\t\t\t{showEmojiPicker && (\r\n\t\t\t\t<div \r\n\t\t\t\t\tclassName=\"fixed inset-0 z-40\" \r\n\t\t\t\t\tonClick={() => setShowEmojiPicker(false)}\r\n\t\t\t\t\tonKeyDown={(e) => {\r\n\t\t\t\t\t\tif (e.key === 'Escape') {\r\n\t\t\t\t\t\t\tsetShowEmojiPicker(false);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}}\r\n\t\t\t\t\ttabIndex={-1}\r\n\t\t\t\t/>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default MessageForm;","// src/presentation/components/notifications/ChatFilterToast.tsx\r\nimport React, { useState, useEffect } from 'react';\r\nimport { X, AlertTriangle, Shield, Ban } from 'lucide-react';\r\n\r\ninterface ChatFilterToastProps {\r\n  isVisible: boolean;\r\n  onClose: () => void;\r\n  type: 'user_warning' | 'seller_strike' | 'seller_blocked';\r\n  message: string;\r\n  censoredContent?: string;\r\n  strikeCount?: number;\r\n  autoClose?: boolean;\r\n  autoCloseTime?: number;\r\n}\r\n\r\nconst ChatFilterToast: React.FC<ChatFilterToastProps> = ({\r\n  isVisible,\r\n  onClose,\r\n  type,\r\n  message,\r\n  censoredContent,\r\n  strikeCount,\r\n  autoClose = true,\r\n  autoCloseTime = 8000\r\n}) => {\r\n  const [progress, setProgress] = useState(100);\r\n\r\n  // Auto-cerrar y barra de progreso\r\n  useEffect(() => {\r\n    if (autoClose && isVisible) {\r\n      const progressInterval = setInterval(() => {\r\n        setProgress((prev) => {\r\n          const newProgress = prev - (100 / (autoCloseTime / 100));\r\n          if (newProgress <= 0) {\r\n            onClose();\r\n            return 0;\r\n          }\r\n          return newProgress;\r\n        });\r\n      }, 100);\r\n\r\n      return () => clearInterval(progressInterval);\r\n    }\r\n  }, [autoClose, autoCloseTime, isVisible, onClose]);\r\n\r\n  // Obtener configuración según el tipo\r\n  const getToastConfig = () => {\r\n    switch (type) {\r\n      case 'user_warning':\r\n        return {\r\n          icon: <AlertTriangle className=\"text-yellow-500\" size={24} />,\r\n          bgColor: 'bg-yellow-50',\r\n          borderColor: 'border-yellow-200',\r\n          titleColor: 'text-yellow-800',\r\n          textColor: 'text-yellow-700',\r\n          progressColor: 'bg-yellow-500',\r\n          title: 'Mensaje no permitido'\r\n        };\r\n      case 'seller_strike':\r\n        return {\r\n          icon: <Shield className=\"text-orange-500\" size={24} />,\r\n          bgColor: 'bg-orange-50',\r\n          borderColor: 'border-orange-200',\r\n          titleColor: 'text-orange-800',\r\n          textColor: 'text-orange-700',\r\n          progressColor: 'bg-orange-500',\r\n          title: 'Strike aplicado'\r\n        };\r\n      case 'seller_blocked':\r\n        return {\r\n          icon: <Ban className=\"text-red-500\" size={24} />,\r\n          bgColor: 'bg-red-50',\r\n          borderColor: 'border-red-200',\r\n          titleColor: 'text-red-800',\r\n          textColor: 'text-red-700',\r\n          progressColor: 'bg-red-500',\r\n          title: 'Cuenta bloqueada'\r\n        };\r\n      default:\r\n        return {\r\n          icon: <AlertTriangle className=\"text-gray-500\" size={24} />,\r\n          bgColor: 'bg-gray-50',\r\n          borderColor: 'border-gray-200',\r\n          titleColor: 'text-gray-800',\r\n          textColor: 'text-gray-700',\r\n          progressColor: 'bg-gray-500',\r\n          title: 'Notificación'\r\n        };\r\n    }\r\n  };\r\n\r\n  if (!isVisible) return null;\r\n\r\n  const config = getToastConfig();\r\n\r\n  return (\r\n    <div className=\"fixed top-4 right-4 z-50 max-w-sm w-full\">\r\n      <div className={`\r\n        ${config.bgColor} ${config.borderColor} border rounded-lg shadow-lg\r\n        transform transition-all duration-300 animate-slide-in-right\r\n      `}>\r\n        {/* Barra de progreso */}\r\n        {autoClose && (\r\n          <div className=\"h-1 bg-gray-200 rounded-t-lg overflow-hidden\">\r\n            <div \r\n              className={`h-full ${config.progressColor} transition-all duration-100 ease-linear`}\r\n              style={{ width: `${progress}%` }}\r\n            />\r\n          </div>\r\n        )}\r\n\r\n        <div className=\"p-4\">\r\n          <div className=\"flex items-start\">\r\n            <div className=\"flex-shrink-0 mr-3\">\r\n              {config.icon}\r\n            </div>\r\n            \r\n            <div className=\"flex-1 min-w-0\">\r\n              <div className=\"flex items-start justify-between\">\r\n                <div className=\"flex-1\">\r\n                  <h4 className={`text-sm font-medium ${config.titleColor} mb-1`}>\r\n                    {config.title}\r\n                  </h4>\r\n                  <p className={`text-sm ${config.textColor} mb-2`}>\r\n                    {message}\r\n                  </p>\r\n                  \r\n                  {/* Mostrar contenido censurado si existe */}\r\n                  {censoredContent && (\r\n                    <div className=\"mt-2 p-2 bg-white bg-opacity-50 rounded border\">\r\n                      <p className=\"text-xs text-gray-600 mb-1\">Mensaje filtrado:</p>\r\n                      <p className=\"text-sm font-mono text-gray-800\">{censoredContent}</p>\r\n                    </div>\r\n                  )}\r\n                  \r\n                  {/* Mostrar contador de strikes */}\r\n                  {typeof strikeCount === 'number' && strikeCount > 0 && (\r\n                    <div className=\"mt-2\">\r\n                      <div className=\"flex items-center space-x-2\">\r\n                        <div className=\"flex space-x-1\">\r\n                          {[1, 2, 3].map((strike) => (\r\n                            <div\r\n                              key={strike}\r\n                              className={`w-3 h-3 rounded-full ${\r\n                                strike <= strikeCount \r\n                                  ? 'bg-red-500' \r\n                                  : 'bg-gray-300'\r\n                              }`}\r\n                            />\r\n                          ))}\r\n                        </div>\r\n                        <span className=\"text-xs text-gray-600\">\r\n                          {strikeCount}/3 strikes\r\n                        </span>\r\n                      </div>\r\n                      {strikeCount >= 3 && (\r\n                        <p className=\"text-xs text-red-600 mt-1 font-medium\">\r\n                          Tu cuenta ha sido bloqueada por acumular 3 strikes.\r\n                        </p>\r\n                      )}\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                \r\n                <button\r\n                  onClick={onClose}\r\n                  className=\"ml-2 flex-shrink-0 text-gray-400 hover:text-gray-600 transition-colors\"\r\n                >\r\n                  <X size={16} />\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\n// Hook para manejar notificaciones de filtro de chat\r\nexport const useChatFilterNotifications = () => {\r\n  const [notification, setNotification] = useState<{\r\n    isVisible: boolean;\r\n    type: 'user_warning' | 'seller_strike' | 'seller_blocked';\r\n    message: string;\r\n    censoredContent?: string;\r\n    strikeCount?: number;\r\n  } | null>(null);\r\n\r\n  const showNotification = (\r\n    type: 'user_warning' | 'seller_strike' | 'seller_blocked',\r\n    message: string,\r\n    censoredContent?: string,\r\n    strikeCount?: number\r\n  ) => {\r\n    setNotification({\r\n      isVisible: true,\r\n      type,\r\n      message,\r\n      censoredContent,\r\n      strikeCount\r\n    });\r\n  };\r\n\r\n  const hideNotification = () => {\r\n    setNotification(prev => prev ? { ...prev, isVisible: false } : null);\r\n    // Limpiar completamente después de la animación\r\n    setTimeout(() => setNotification(null), 300);\r\n  };\r\n\r\n  const showUserWarning = (message: string, censoredContent?: string) => {\r\n    showNotification('user_warning', message, censoredContent);\r\n  };\r\n\r\n  const showSellerStrike = (message: string, strikeCount: number, censoredContent?: string) => {\r\n    showNotification('seller_strike', message, censoredContent, strikeCount);\r\n  };\r\n\r\n  const showSellerBlocked = (message: string) => {\r\n    showNotification('seller_blocked', message);\r\n  };\r\n\r\n  const NotificationComponent = () => {\r\n    if (!notification) return null;\r\n\r\n    return (\r\n      <ChatFilterToast\r\n        isVisible={notification.isVisible}\r\n        onClose={hideNotification}\r\n        type={notification.type}\r\n        message={notification.message}\r\n        censoredContent={notification.censoredContent}\r\n        strikeCount={notification.strikeCount}\r\n      />\r\n    );\r\n  };\r\n\r\n  return {\r\n    showUserWarning,\r\n    showSellerStrike,\r\n    showSellerBlocked,\r\n    hideNotification,\r\n    NotificationComponent\r\n  };\r\n};\r\n\r\nexport default ChatFilterToast;"],"names":["__iconNode","Circle","createLucideIcon","Smile","WifiOff","Wifi","minutesInMonth","minutesInDay","constructFromSymbol","constructFrom","date","value","toDate","argument","context","defaultOptions","getDefaultOptions","getTimezoneOffsetInMilliseconds","_date","utcDate","normalizeDates","dates","normalize","compareAsc","dateLeft","dateRight","diff","constructNow","differenceInCalendarMonths","laterDate","earlierDate","options","laterDate_","earlierDate_","yearsDiff","monthsDiff","getRoundingMethod","method","number","result","differenceInMilliseconds","endOfDay","endOfMonth","month","isLastDayOfMonth","differenceInMonths","workingLaterDate","sign","difference","isLastMonthNotFull","differenceInSeconds","formatDistanceLocale","formatDistance","token","count","tokenValue","buildFormatLongFn","args","width","dateFormats","timeFormats","dateTimeFormats","formatLong","formatRelativeLocale","formatRelative","_baseDate","_options","buildLocalizeFn","valuesArray","defaultWidth","index","eraValues","quarterValues","monthValues","dayValues","dayPeriodValues","formattingDayPeriodValues","ordinalNumber","dirtyNumber","rem100","localize","quarter","buildMatchFn","string","matchPattern","matchResult","matchedString","parsePatterns","key","findIndex","pattern","findKey","rest","object","predicate","array","buildMatchPatternFn","parseResult","matchOrdinalNumberPattern","parseOrdinalNumberPattern","matchEraPatterns","parseEraPatterns","matchQuarterPatterns","parseQuarterPatterns","matchMonthPatterns","parseMonthPatterns","matchDayPatterns","parseDayPatterns","matchDayPeriodPatterns","parseDayPeriodPatterns","match","enUS","locale","defaultLocale","minutesInAlmostTwoDays","comparison","localizeOptions","seconds","offsetInSeconds","minutes","months","hours","days","nearestMonth","monthsSinceStartOfYear","years","formatDistanceToNow","formatRelativeLocalePlural","es","ChatList","chats","selectedChatId","onSelectChat","loading","searchTerm","onSearchChange","statusFilter","onStatusFilterChange","unreadFilter","onUnreadFilterChange","isSeller","formatDate","dateString","getChatParticipant","chat","jsx","User","Store","jsxs","e","Search","Filter","participant","chatId","target","Package","getMessageStatus","message","isFromCurrentUser","MessageStatusIcon","status","getIcon","Clock","Check","CheckCheck","AlertCircle","formatDateSeparator","parseBackendDate","isToday","isYesterday","now","error","formatMessageTime","groupMessagesByDate","messages","groups","b","dateA","dateB","messageDate","dateKey","group","g","shouldGroupWithPrevious","currentMessage","previousMessage","currentTime","previousTime","ChatMessages","noMessagesText","currentUserId","messagesEndRef","useRef","messagesContainerRef","prevMessagesLength","setPrevMessagesLength","useState","autoScroll","setAutoScroll","handleScroll","scrollTop","scrollHeight","clientHeight","isAtBottom","useEffect","messageGroups","groupIndex","messageStatus","nextMessage","shouldGroup","shouldGroupNext","getBubbleRadius","useRealTimeChat","participantId","pollInterval","enableTypingIndicator","user","useAuth","onlineStatus","setOnlineStatus","isConnected","setIsConnected","pollIntervalRef","typingTimeoutRef","lastActivityRef","isPollingRef","handleOnline","handleOffline","fetchOnlineStatus","useCallback","response","ApiClient","is_online","last_seen","is_typing","simulateOnlineStatus","isOnline","lastSeen","minutesAgo","isTyping","refreshOnlineStatus","sendTypingIndicator","updateLastActivity","events","event","handleBeforeUnload","handleVisibilityChange","useTypingIndicator","setIsTyping","startTyping","stopTyping","ChatHeader","onUpdateStatus","isMenuOpen","setIsMenuOpen","isUpdating","setIsUpdating","menuRef","productRoute","handleClickOutside","closeMenu","handleStatusChange","formatLastSeen","diffInMinutes","Link","Fragment","ChevronRight","MoreVertical","EMOJI_CATEGORIES","getFrequentEmojis","stored","saveEmojiUsage","emoji","frequent","MessageForm","onSendMessage","isDisabled","disabledText","placeholder","isLoading","setMessage","setError","showEmojiPicker","setShowEmojiPicker","selectedCategory","setSelectedCategory","emojiSearch","setEmojiSearch","recentEmojis","setRecentEmojis","textareaRef","emojiPickerRef","emojiSearchRef","isMounted","handleSubmit","messageToSend","success","handleKeyDown","autoAdjustHeight","textarea","newValue","newHeight","insertEmoji","start","end","newMessage","getFilteredEmojis","categoryEmojis","getCurrentEmojis","categoryName","categoryData","Loader2","Send","ChatFilterToast","isVisible","onClose","type","censoredContent","strikeCount","autoClose","autoCloseTime","progress","setProgress","progressInterval","prev","newProgress","getToastConfig","AlertTriangle","Shield","Ban","config","strike","X","useChatFilterNotifications","notification","setNotification","showNotification","hideNotification"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37]}