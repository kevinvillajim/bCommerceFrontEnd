import{j as e,aI as ae,X as b,O as oe,J as ie,D as ne,q as ce,p as v,aQ as le,aR as $,aS as de,n as me,aT as ue,aU as ge,k as K,aO as pe,aA as he}from"./ui-vendor-BUNMIuFe.js";import{u as xe,d as ye,r as p}from"./react-vendor-Cy458wKG.js";import{c as be}from"./seller-chunk-6swISJwY.js";import{u as fe}from"./useCategoriesSelect-DJGkSPcx.js";import{b as U}from"./admin-chunk-BNcFjXlJ.js";import"./utils-vendor-DeGC_a19.js";const Ie=()=>{const x=xe(),{id:w}=ye(),y=w?parseInt(w):0,[N,C]=p.useState(!0),[f,k]=p.useState(!1),{updateProduct:V,fetchProductById:I}=be(),{parentCategoryOptions:R,subcategoryOptions:S,selectedParentId:j,setSelectedParentId:z,loading:O}=fe(),[g,B]=p.useState({basic:!0,pricing:!0,categorization:!0,physical:!1,variations:!1,media:!0,seo:!1,advanced:!1}),[s,c]=p.useState({name:"",description:"",short_description:"",parentCategory:"",category:"",tags:[],currentTag:"",price:"",stock:"",discount_percentage:"",weight:"",width:"",height:"",depth:"",dimensions:"",colors:[],currentColor:"",sizes:[],currentSize:"",attributes:[],currentAttributeKey:"",currentAttributeValue:"",images:[],existingImages:[],previewImages:[],imagesToRemove:[],status:"active",featured:!1,published:!0}),q=["name","description","price","stock","category"],[o,A]=p.useState({});p.useEffect(()=>{(async()=>{if(!y){x("/seller/products");return}try{C(!0);const r=await I(y);if(!r)throw new Error("No se pudo obtener la información del producto");console.log("Producto recibido:",r),console.log("Category ID:",r.category_id),console.log("Category:",r.category);let a=r.category?.parent_id,n=r.category_id;a||(a=n),console.log("⭐ Valores de categoría actualizados:",{parentCategoryId:a,categoryId:n,categoryIdType:typeof n,parentCategoryIdType:typeof a}),a&&z(Number(a)),await new Promise(l=>setTimeout(l,10));const m=l=>!Array.isArray(l)||l.length===0?[]:l.some(i=>typeof i=="string"&&i.includes('"'))?(l.join("").match(/\"([^\"]+)\"/g)||[]).map(u=>u.replace(/"/g,"")):l.map(i=>typeof i=="string"?i.replace(/[\[\]"\\]/g,"").trim():String(i)).filter(Boolean);c(l=>(console.log("Actualizando formData con valores:",{parentCategory:String(a),category:String(n)}),{...l,name:r.name||"",description:r.description||"",short_description:r.shortDescription||"",price:r.price?r.price.toString():"",stock:r.stock?r.stock.toString():"",discount_percentage:r.discount_percentage?r.discount_percentage.toString():"",weight:r.weight?r.weight.toString():"",width:r.width?r.width.toString():"",height:r.height?r.height.toString():"",depth:r.depth?r.depth.toString():"",dimensions:r.dimensions||"",status:r.status||"active",featured:!!r.featured,published:!!r.published,parentCategory:a?String(a):"",category:n?String(n):"",tags:m(r.tags||[]),colors:m(r.colors||[]),sizes:m(r.sizes||[]),attributes:Array.isArray(r.attributes)?r.attributes:typeof r.attributes=="string"&&r.attributes?(()=>{try{return JSON.parse(r.attributes)}catch(i){return console.error("Error al parsear atributos:",i),[]}})():[],existingImages:Array.isArray(r.images)?r.images.map(i=>typeof i=="string"?{original:i,thumbnail:i,medium:i,large:i}:{id:i.id,original:i.original||"",thumbnail:i.thumbnail||i.original||"",medium:i.medium||i.original||"",large:i.large||i.original||"",alt:i.alt,position:i.position}):[],images:[],previewImages:Array.isArray(r.images)?r.images.map(i=>{const T=U.imageBaseUrl;let u;return typeof i=="string"?u=i:u=i.original||i.medium||i.thumbnail,u&&!u.startsWith("http")?`${T}${u}`:u||""}):[],imagesToRemove:[]}))}catch(r){console.error("Error al cargar los datos del producto:",r),alert("No se pudo cargar el producto. Inténtalo de nuevo más tarde."),x("/seller/products")}finally{C(!1)}})()},[y,x,I]),p.useEffect(()=>{!N&&s.category&&(console.log("selectedParentId cambió a:",j),j&&c(t=>({...t,parentCategory:String(j)})))},[j,N]);const L=t=>{B(r=>({...r,[t]:!r[t]}))},d=t=>{const{name:r,value:a,type:n}=t.target;if(n==="checkbox"){const m=t.target.checked;c(l=>{const i={...l,[r]:m};return console.log("handleInputChange - Checkbox actualizado:",i),i});return}c(m=>{const l={...m,[r]:a};return console.log("handleInputChange - Input actualizado:",l),l}),r==="parentCategory"&&a&&(z(parseInt(a)),c(m=>{const l={...m,category:""};return console.log("handleInputChange - parentCategory cambiado, subcategoría reseteada:",l),l})),o[r]&&A(m=>{const l={...m};return delete l[r],console.log("handleInputChange - Error de validación eliminado para:",r),l})},G=t=>{if(t.target.files&&t.target.files.length>0){const r=Array.from(t.target.files),a=r.map(n=>URL.createObjectURL(n));c(n=>({...n,images:[...n.images,...r],previewImages:[...n.previewImages,...a]}))}},J=t=>{const r=[...s.images],a=[...s.previewImages];URL.revokeObjectURL(a[t]),r.splice(t,1),a.splice(t,1),c(n=>({...n,images:r,previewImages:a}))},W=t=>{const r=[...s.existingImages],a=r[t];a.id&&c(n=>({...n,imagesToRemove:[...n.imagesToRemove,a.id]})),r.splice(t,1),c(n=>({...n,existingImages:r}))},E=()=>{s.currentTag.trim()&&!s.tags.includes(s.currentTag.trim())&&c(t=>({...t,tags:[...t.tags,t.currentTag.trim()],currentTag:""}))},M=t=>{c(r=>({...r,tags:r.tags.filter(a=>a!==t)}))},H=t=>{t.key==="Enter"&&(t.preventDefault(),E())},P=()=>{s.currentColor.trim()&&!s.colors.includes(s.currentColor.trim())&&c(t=>({...t,colors:[...t.colors,s.currentColor.trim()],currentColor:""}))},Q=t=>{c(r=>({...r,colors:r.colors.filter(a=>a!==t)}))},X=t=>{t.key==="Enter"&&(t.preventDefault(),P())},D=()=>{s.currentSize.trim()&&!s.sizes.includes(s.currentSize.trim())&&c(t=>({...t,sizes:[...t.sizes,s.currentSize.trim()],currentSize:""}))},Y=t=>{c(r=>({...r,sizes:r.sizes.filter(a=>a!==t)}))},Z=t=>{t.key==="Enter"&&(t.preventDefault(),D())},_=()=>{const t=s.currentAttributeKey.trim(),r=s.currentAttributeValue.trim();t&&r&&c(a=>({...a,attributes:[...a.attributes,{key:t,value:r}],currentAttributeKey:"",currentAttributeValue:""}))},ee=t=>{c(r=>{const a=[...r.attributes];return a.splice(t,1),{...r,attributes:a}})},re=t=>{if(t.key==="Enter"){t.preventDefault();const r=document.getElementById("attributeValue");r&&r.focus()}},te=t=>{t.key==="Enter"&&(t.preventDefault(),_())},se=()=>{const t={};return q.forEach(r=>{s[r]||(t[r]=`El campo ${r} es obligatorio`)}),s.price&&(isNaN(Number(s.price))||Number(s.price)<=0)&&(t.price="El precio debe ser un número mayor que cero"),s.stock&&(isNaN(Number(s.stock))||Number(s.stock)<0)&&(t.stock="El stock debe ser un número no negativo"),s.discount_percentage&&(isNaN(Number(s.discount_percentage))||Number(s.discount_percentage)<0||Number(s.discount_percentage)>100)&&(t.discount_percentage="El descuento debe ser un porcentaje entre 0 y 100"),["weight","width","height","depth"].forEach(r=>{const a=s[r];a&&isNaN(Number(a))&&(t[r]=`El campo ${r} debe ser un número`)}),A(t),Object.keys(t).length===0},F=async t=>{if(t.preventDefault(),!se()){const r=Object.keys(o)[0],a=document.getElementById(r);a&&(a.scrollIntoView({behavior:"smooth",block:"center"}),a.focus());return}k(!0);try{const r={id:y,name:s.name,description:s.description,short_description:s.short_description||void 0,price:parseFloat(s.price),stock:parseInt(s.stock),category_id:parseInt(s.category),status:s.status,tags:s.tags,discount_percentage:s.discount_percentage?parseFloat(s.discount_percentage):void 0,weight:s.weight?parseFloat(s.weight):void 0,width:s.width?parseFloat(s.width):void 0,height:s.height?parseFloat(s.height):void 0,depth:s.depth?parseFloat(s.depth):void 0,colors:s.colors,sizes:s.sizes,featured:s.featured,published:s.published,replace_images:!1};console.log("Datos enviados al backend:",r);const a=await V(r);if(a)console.log("Respuesta del servidor después de la actualización:",a),console.log("✅ Producto actualizado, navegando en 1 segundo..."),setTimeout(()=>{x("/seller/products",{state:{updatedProduct:!0,productId:y,timestamp:Date.now()}})},1e3);else throw new Error("No se pudo actualizar el producto")}catch(r){console.error("❌ Error al actualizar producto:",r),alert(r instanceof Error?r.message:"Error al actualizar producto")}finally{k(!1)}},h=({title:t,section:r,icon:a})=>e.jsxs("div",{className:"flex items-center justify-between cursor-pointer py-3 border-b border-gray-200",onClick:()=>L(r),children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(a,{className:"w-5 h-5 text-primary-600 mr-2"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:t})]}),g[r]?e.jsx(pe,{className:"w-5 h-5 text-gray-500"}):e.jsx(he,{className:"w-5 h-5 text-gray-500"})]});return N?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[e.jsx(ae,{className:"w-12 h-12 text-primary-600 animate-spin mb-4"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Cargando datos del producto..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Editar Producto: ",s.name]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{type:"button",onClick:()=>x("/seller/products"),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(b,{size:18,className:"inline mr-1"})," Cancelar"]}),e.jsx("button",{type:"button",onClick:F,disabled:f,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:f?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"inline-block animate-spin mr-1",children:"⟳"})," ","Guardando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(oe,{size:18,className:"inline mr-1"})," Guardar Cambios"]})})]})]}),e.jsxs("form",{onSubmit:F,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx(h,{title:"Información Básica",section:"basic",icon:ie}),g.basic&&e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:["Nombre del Producto ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",id:"name",name:"name",value:s.name,onChange:d,className:`w-full px-3 py-2 border ${o.name?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500`}),o.name&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.name})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"short_description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripción Corta"}),e.jsx("input",{type:"text",id:"short_description",name:"short_description",value:s.short_description,onChange:d,placeholder:"Resumen breve del producto (para listados y búsquedas)",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:["Descripción Completa ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{id:"description",name:"description",rows:4,value:s.description,onChange:d,className:`w-full px-3 py-2 border ${o.description?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500`}),o.description&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.description})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx(h,{title:"Precios y Stock",section:"pricing",icon:ne}),g.pricing&&e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"price",className:"block text-sm font-medium text-gray-700 mb-1",children:["Precio ($) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",id:"price",name:"price",min:"0",step:"0.01",value:s.price,onChange:d,className:`w-full px-3 py-2 border ${o.price?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500`}),o.price&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.price})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"discount_percentage",className:"block text-sm font-medium text-gray-700 mb-1",children:"Descuento (%)"}),e.jsx("input",{type:"number",id:"discount_percentage",name:"discount_percentage",min:"0",max:"100",step:"0.1",value:s.discount_percentage,onChange:d,className:`w-full px-3 py-2 border ${o.discount_percentage?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500`}),o.discount_percentage&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.discount_percentage})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"stock",className:"block text-sm font-medium text-gray-700 mb-1",children:["Cantidad en Stock ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",id:"stock",name:"stock",min:"0",value:s.stock,onChange:d,className:`w-full px-3 py-2 border ${o.stock?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500`}),o.stock&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.stock})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado del Producto"}),e.jsxs("select",{id:"status",name:"status",value:s.status,onChange:d,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"active",children:"Activo"}),e.jsx("option",{value:"inactive",children:"Inactivo"}),e.jsx("option",{value:"draft",children:"Borrador"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx(h,{title:"Categorización",section:"categorization",icon:ce}),g.categorization&&e.jsxs("div",{className:"mt-4 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"parentCategory",className:"block text-sm font-medium text-gray-700 mb-1",children:["Categoría Principal ",e.jsx("span",{className:"text-red-500",children:"*"})]}),O?e.jsx("div",{className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-100 text-gray-400",children:"Cargando categorías..."}):e.jsxs("select",{id:"parentCategory",name:"parentCategory",value:s.parentCategory,onChange:d,className:`w-full px-3 py-2 border ${o.parentCategory?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500`,children:[e.jsx("option",{value:"",children:"Seleccionar Categoría Principal"}),R.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]}),o.parentCategory&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.parentCategory})]}),e.jsxs("div",{className:s.parentCategory?"":"opacity-50",children:[e.jsxs("label",{htmlFor:"category",className:"block text-sm font-medium text-gray-700 mb-1",children:["Subcategoría ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{id:"category",name:"category",value:s.category,onChange:d,disabled:!s.parentCategory,className:`w-full px-3 py-2 border ${o.category?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500 disabled:bg-gray-100 disabled:cursor-not-allowed`,children:[!s.category&&e.jsx("option",{value:"",children:s.parentCategory?S.length>0?"Seleccionar Subcategoría":"No hay subcategorías disponibles":"Primero selecciona una categoría principal"}),S.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value)),s.parentCategory&&e.jsx("option",{value:s.parentCategory,children:"Usar categoría principal"})]}),o.category&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.category})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Etiquetas (Tags)"}),e.jsxs("div",{className:"flex",children:[e.jsx("input",{type:"text",placeholder:"Añade una etiqueta y presiona Enter",value:s.currentTag,onChange:t=>c(r=>({...r,currentTag:t.target.value})),onKeyDown:H,className:"flex-grow px-3 py-2 border border-gray-300 rounded-l-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"}),e.jsx("button",{type:"button",onClick:E,className:"px-4 py-2 bg-primary-600 text-white rounded-r-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:e.jsx(v,{size:18})})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[s.tags.map(t=>e.jsxs("div",{className:"bg-gray-100 text-gray-800 px-2 py-1 rounded-md flex items-center",children:[e.jsx("span",{children:t}),e.jsx("button",{type:"button",onClick:()=>M(t),className:"ml-1 text-gray-500 hover:text-gray-700",children:e.jsx(b,{size:14})})]},t)),s.tags.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"Aún no se han añadido etiquetas"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx(h,{title:"Características Físicas",section:"physical",icon:le}),g.physical&&e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"weight",className:"block text-sm font-medium text-gray-700 mb-1",children:"Peso (kg)"}),e.jsx("input",{type:"number",id:"weight",name:"weight",min:"0",step:"0.001",value:s.weight,onChange:d,className:`w-full px-3 py-2 border ${o.weight?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500`}),o.weight&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.weight})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"width",className:"block text-sm font-medium text-gray-700 mb-1",children:"Ancho (cm)"}),e.jsx("input",{type:"number",id:"width",name:"width",min:"0",step:"0.1",value:s.width,onChange:d,className:`w-full px-3 py-2 border ${o.width?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500`}),o.width&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.width})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"height",className:"block text-sm font-medium text-gray-700 mb-1",children:"Alto (cm)"}),e.jsx("input",{type:"number",id:"height",name:"height",min:"0",step:"0.1",value:s.height,onChange:d,className:`w-full px-3 py-2 border ${o.height?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500`}),o.height&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.height})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"depth",className:"block text-sm font-medium text-gray-700 mb-1",children:"Profundidad (cm)"}),e.jsx("input",{type:"number",id:"depth",name:"depth",min:"0",step:"0.1",value:s.depth,onChange:d,className:`w-full px-3 py-2 border ${o.depth?"border-red-500":"border-gray-300"} rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500`}),o.depth&&e.jsx("p",{className:"mt-1 text-sm text-red-500",children:o.depth})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx(h,{title:"Variaciones y Atributos",section:"variations",icon:$}),g.variations&&e.jsxs("div",{className:"mt-4 space-y-8",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-md font-medium text-gray-800 mb-2 flex items-center",children:[e.jsx($,{className:"w-4 h-4 mr-1"})," Colores Disponibles"]}),e.jsxs("div",{className:"flex",children:[e.jsx("input",{type:"text",placeholder:"Añade un color y presiona Enter",value:s.currentColor,onChange:t=>c(r=>({...r,currentColor:t.target.value})),onKeyDown:X,className:"flex-grow px-3 py-2 border border-gray-300 rounded-l-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"}),e.jsx("button",{type:"button",onClick:P,className:"px-4 py-2 bg-primary-600 text-white rounded-r-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:e.jsx(v,{size:18})})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[s.colors.map(t=>e.jsxs("div",{className:"bg-gray-100 text-gray-800 px-2 py-1 rounded-md flex items-center",children:[e.jsx("span",{children:t}),e.jsx("button",{type:"button",onClick:()=>Q(t),className:"ml-1 text-gray-500 hover:text-gray-700",children:e.jsx(b,{size:14})})]},t)),s.colors.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"Aún no se han añadido colores"})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-md font-medium text-gray-800 mb-2 flex items-center",children:[e.jsx(de,{className:"w-4 h-4 mr-1"})," Tallas Disponibles"]}),e.jsxs("div",{className:"flex",children:[e.jsx("input",{type:"text",placeholder:"Añade una talla y presiona Enter",value:s.currentSize,onChange:t=>c(r=>({...r,currentSize:t.target.value})),onKeyDown:Z,className:"flex-grow px-3 py-2 border border-gray-300 rounded-l-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"}),e.jsx("button",{type:"button",onClick:D,className:"px-4 py-2 bg-primary-600 text-white rounded-r-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:e.jsx(v,{size:18})})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[s.sizes.map(t=>e.jsxs("div",{className:"bg-gray-100 text-gray-800 px-2 py-1 rounded-md flex items-center",children:[e.jsx("span",{children:t}),e.jsx("button",{type:"button",onClick:()=>Y(t),className:"ml-1 text-gray-500 hover:text-gray-700",children:e.jsx(b,{size:14})})]},t)),s.sizes.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"Aún no se han añadido tallas"})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-md font-medium text-gray-800 mb-2 flex items-center",children:[e.jsx(me,{className:"w-4 h-4 mr-1"})," Atributos Personalizados"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsx("input",{type:"text",id:"attributeKey",placeholder:"Nombre del atributo (ej: Material)",value:s.currentAttributeKey,onChange:t=>c(r=>({...r,currentAttributeKey:t.target.value})),onKeyDown:re,className:"px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"}),e.jsxs("div",{className:"flex",children:[e.jsx("input",{type:"text",id:"attributeValue",placeholder:"Valor (ej: Algodón)",value:s.currentAttributeValue,onChange:t=>c(r=>({...r,currentAttributeValue:t.target.value})),onKeyDown:te,className:"flex-grow px-3 py-2 border border-gray-300 rounded-l-md shadow-sm focus:outline-none focus:ring-primary-500 focus:border-primary-500"}),e.jsx("button",{type:"button",onClick:_,className:"px-4 py-2 bg-primary-600 text-white rounded-r-md hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:e.jsx(v,{size:18})})]})]}),e.jsx("div",{className:"mt-4",children:s.attributes.length>0?e.jsx("div",{className:"bg-gray-50 p-4 rounded-md",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Atributo"}),e.jsx("th",{className:"px-3 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Valor"}),e.jsx("th",{className:"px-3 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acción"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:s.attributes.map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-3 py-2 text-sm text-gray-800",children:t.key}),e.jsx("td",{className:"px-3 py-2 text-sm text-gray-600",children:t.value}),e.jsx("td",{className:"px-3 py-2 text-right",children:e.jsx("button",{type:"button",onClick:()=>ee(r),className:"text-red-600 hover:text-red-800",children:e.jsx(b,{size:16})})})]},r))})]})}):e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Aún no se han añadido atributos personalizados"})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[e.jsx(h,{title:"Imágenes del Producto",section:"media",icon:ue}),g.media&&e.jsxs("div",{className:"mt-4 space-y-4",children:[e.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-6 text-center",children:[e.jsx("input",{type:"file",id:"images",accept:"image/*",multiple:!0,onChange:G,className:"hidden"}),e.jsxs("label",{htmlFor:"images",className:"cursor-pointer flex flex-col items-center justify-center",children:[e.jsx(ge,{className:"h-12 w-12 text-gray-400 mb-2"}),e.jsx("p",{className:"text-gray-600 mb-1",children:"Arrastra y suelta imágenes aquí o haz clic para subir"}),e.jsx("p",{className:"text-xs text-gray-500",children:"JPEG, PNG, WebP hasta 2MB"})]})]}),s.existingImages.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium text-gray-800 mb-3",children:"Imágenes actuales"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:s.existingImages.map((t,r)=>{const a=U.imageBaseUrl;let n=t.original||t.medium||t.thumbnail;const m=n&&n.startsWith("http")?n:`${a}${n}`;return e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"aspect-w-1 aspect-h-1 w-full overflow-hidden rounded-lg bg-gray-100",children:e.jsx("img",{src:m,alt:s.name||`Imagen existente ${r+1}`,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"})}),e.jsx("button",{type:"button",onClick:()=>W(r),className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(K,{size:14})}),r===0&&e.jsx("div",{className:"absolute bottom-2 left-2 bg-primary-500 text-white text-xs py-1 px-2 rounded-md",children:"Principal"})]},`existing-${r}`)})})]}),s.images.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium text-gray-800 mb-3",children:"Nuevas imágenes a agregar"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:s.images.map((t,r)=>e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"aspect-w-1 aspect-h-1 w-full overflow-hidden rounded-lg bg-gray-100",children:e.jsx("img",{src:s.previewImages[r],alt:s.name||`Nueva imagen ${r+1}`,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"})}),e.jsx("button",{type:"button",onClick:()=>J(r),className:"absolute top-2 right-2 bg-red-500 text-white rounded-full p-1 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(K,{size:14})})]},`new-${r}`))})]}),s.existingImages.length===0&&s.images.length===0&&e.jsx("p",{className:"text-sm text-gray-500 text-center mt-4",children:"No hay imágenes para este producto. Agrega al menos una imagen."})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",disabled:f,className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 disabled:opacity-50 disabled:cursor-not-allowed",children:f?"Guardando...":"Guardar Producto"})})]})]})};export{Ie as default};
//# sourceMappingURL=SellerProductEditPage-D4lub8-T.js.map
