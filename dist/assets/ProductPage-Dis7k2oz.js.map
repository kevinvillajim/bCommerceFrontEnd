{"version":3,"file":"ProductPage-Dis7k2oz.js","sources":["../../src/presentation/hooks/useProductFilters.ts","../../src/presentation/hooks/useProductSearch.ts","../../src/presentation/components/product/SearchBar.tsx","../../src/presentation/components/product/CategoriesCarousel.tsx","../../src/presentation/components/product/ProductFilters.tsx","../../src/utils/productAdapter.ts","../../src/presentation/components/product/ProductGrid.tsx","../../src/presentation/components/product/SortDropdown.tsx","../../src/presentation/components/product/MobileFilterPanel.tsx","../../src/presentation/components/product/ActiveFilters.tsx","../../src/presentation/components/product/Pagination.tsx","../../src/presentation/components/product/MobilePagination.tsx","../../src/utils/categoryUtils.ts","../../src/presentation/pages/ProductPage.tsx"],"sourcesContent":["import {useState, useEffect, useCallback, useRef} from \"react\";\r\nimport {useSearchParams} from \"react-router-dom\";\r\nimport type {ExtendedProductFilterParams} from \"../types/ProductFilterParams\";\r\nimport type {Category} from \"../../core/domain/entities/Category\";\r\nimport appConfig from \"../../config/appConfig\";\r\n\r\ninterface ProductFiltersState {\r\n\tcategories: string[];\r\n\tpriceRange: {min: number; max: number} | null;\r\n\trating: number | null;\r\n\tdiscount: boolean;\r\n\tsortBy: string;\r\n\tpage: number;\r\n\tsearchTerm: string;\r\n}\r\n\r\nexport const useProductFilters = (\r\n\tallCategories: Category[],\r\n\tdefaultPageSize: number = appConfig.pagination.defaultPageSize\r\n) => {\r\n\tconst [searchParams, setSearchParams] = useSearchParams();\r\n\r\n\t// Estado para evitar bucles infinitos\r\n\tconst isUpdatingUrl = useRef(false);\r\n\tconst lastProcessedParams = useRef<string>(\"\");\r\n\r\n\t// Inicializar estado desde URL al momento de crear el estado\r\n\tconst [filtersState, setFiltersState] = useState<ProductFiltersState>(() => {\r\n\t\tconst categoryParam = searchParams.get(\"category\");\r\n\t\tconst minPriceParam = searchParams.get(\"minPrice\");\r\n\t\tconst maxPriceParam = searchParams.get(\"maxPrice\");\r\n\t\tconst ratingParam = searchParams.get(\"rating\");\r\n\t\tconst discountParam = searchParams.get(\"discount\");\r\n\t\tconst sortParam = searchParams.get(\"sort\");\r\n\t\tconst pageParam = searchParams.get(\"page\");\r\n\t\tconst searchParam = searchParams.get(\"search\");\r\n\r\n\t\tconsole.log(\"useProductFilters: Inicializando desde URL:\", {\r\n\t\t\tcategoryParam,\r\n\t\t\tminPriceParam,\r\n\t\t\tmaxPriceParam,\r\n\t\t\tratingParam,\r\n\t\t\tdiscountParam,\r\n\t\t\tsortParam,\r\n\t\t\tpageParam,\r\n\t\t\tsearchParam\r\n\t\t});\r\n\r\n\t\treturn {\r\n\t\t\tcategories: categoryParam ? categoryParam.split(\",\").map(c => decodeURIComponent(c)) : [],\r\n\t\t\tpriceRange:\r\n\t\t\t\tminPriceParam && maxPriceParam\r\n\t\t\t\t\t? {min: parseInt(minPriceParam), max: parseInt(maxPriceParam)}\r\n\t\t\t\t\t: null,\r\n\t\t\trating: ratingParam ? parseInt(ratingParam) : null,\r\n\t\t\tdiscount: discountParam === \"true\",\r\n\t\t\tsortBy: sortParam || \"featured\",\r\n\t\t\tpage: pageParam ? parseInt(pageParam) : 1,\r\n\t\t\tsearchTerm: searchParam || \"\",\r\n\t\t};\r\n\t});\r\n\r\n\t// Este useEffect actualiza la URL cuando cambia el estado\r\n\tuseEffect(() => {\r\n\t\t// Solo actualizar URL si estamos actualizando desde el estado\r\n\t\tif (!isUpdatingUrl.current) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst newParams = new URLSearchParams();\r\n\r\n\t\t// Gestionar categor√≠as\r\n\t\tif (filtersState.categories.length > 0) {\r\n\t\t\tnewParams.set(\"category\", filtersState.categories.map(c => encodeURIComponent(c)).join(\",\"));\r\n\t\t}\r\n\r\n\t\t// Gestionar rango de precio\r\n\t\tif (filtersState.priceRange) {\r\n\t\t\tnewParams.set(\"minPrice\", filtersState.priceRange.min.toString());\r\n\t\t\tnewParams.set(\"maxPrice\", filtersState.priceRange.max.toString());\r\n\t\t}\r\n\r\n\t\t// Gestionar rating\r\n\t\tif (filtersState.rating) {\r\n\t\t\tnewParams.set(\"rating\", filtersState.rating.toString());\r\n\t\t}\r\n\r\n\t\t// Gestionar descuento\r\n\t\tif (filtersState.discount) {\r\n\t\t\tnewParams.set(\"discount\", \"true\");\r\n\t\t}\r\n\r\n\t\t// Gestionar ordenamiento\r\n\t\tif (filtersState.sortBy !== \"featured\") {\r\n\t\t\tnewParams.set(\"sort\", filtersState.sortBy);\r\n\t\t}\r\n\r\n\t\t// Gestionar p√°gina\r\n\t\tif (filtersState.page > 1) {\r\n\t\t\tnewParams.set(\"page\", filtersState.page.toString());\r\n\t\t}\r\n\r\n\t\t// Gestionar t√©rmino de b√∫squeda\r\n\t\tif (filtersState.searchTerm) {\r\n\t\t\tnewParams.set(\"search\", filtersState.searchTerm);\r\n\t\t}\r\n\r\n\t\tconst newParamsString = newParams.toString();\r\n\t\tconsole.log(\"useProductFilters: Actualizando URL:\", newParamsString);\r\n\r\n\t\tsetSearchParams(newParams, {replace: true});\r\n\t\t\r\n\t\t// Resetear el flag despu√©s de un peque√±o delay\r\n\t\tsetTimeout(() => {\r\n\t\t\tisUpdatingUrl.current = false;\r\n\t\t}, 100);\r\n\t}, [filtersState, setSearchParams]);\r\n\r\n\t// Este useEffect actualiza el estado cuando cambia la URL\r\n\tuseEffect(() => {\r\n\t\tconst currentParams = searchParams.toString();\r\n\t\t\r\n\t\t// Si ya procesamos estos par√°metros, no hacer nada\r\n\t\tif (currentParams === lastProcessedParams.current) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tlastProcessedParams.current = currentParams;\r\n\r\n\t\tconsole.log(\"useProductFilters: URL cambi√≥, actualizando estado:\", currentParams);\r\n\r\n\t\tconst categoryParam = searchParams.get(\"category\");\r\n\t\tconst minPriceParam = searchParams.get(\"minPrice\");\r\n\t\tconst maxPriceParam = searchParams.get(\"maxPrice\");\r\n\t\tconst ratingParam = searchParams.get(\"rating\");\r\n\t\tconst discountParam = searchParams.get(\"discount\");\r\n\t\tconst sortParam = searchParams.get(\"sort\");\r\n\t\tconst pageParam = searchParams.get(\"page\");\r\n\t\tconst searchParam = searchParams.get(\"search\");\r\n\r\n\t\tsetFiltersState({\r\n\t\t\tcategories: categoryParam ? categoryParam.split(\",\").map(c => decodeURIComponent(c)) : [],\r\n\t\t\tpriceRange:\r\n\t\t\t\tminPriceParam && maxPriceParam\r\n\t\t\t\t\t? {min: parseInt(minPriceParam), max: parseInt(maxPriceParam)}\r\n\t\t\t\t\t: null,\r\n\t\t\trating: ratingParam ? parseInt(ratingParam) : null,\r\n\t\t\tdiscount: discountParam === \"true\",\r\n\t\t\tsortBy: sortParam || \"featured\",\r\n\t\t\tpage: pageParam ? parseInt(pageParam) : 1,\r\n\t\t\tsearchTerm: searchParam || \"\",\r\n\t\t});\r\n\t}, [searchParams]);\r\n\r\n\t// Funci√≥n helper para actualizar estado y URL\r\n\tconst updateFiltersAndUrl = useCallback((updates: Partial<ProductFiltersState>) => {\r\n\t\tisUpdatingUrl.current = true;\r\n\t\tsetFiltersState((prev) => ({\r\n\t\t\t...prev,\r\n\t\t\t...updates,\r\n\t\t\tpage: updates.page !== undefined ? updates.page : 1, // Resetear p√°gina excepto si se especifica\r\n\t\t}));\r\n\t}, []);\r\n\r\n\t// Funciones para actualizar filtros\r\n\tconst setCategories = useCallback((categories: string[]) => {\r\n\t\tconsole.log(\"useProductFilters: Actualizando categor√≠as:\", categories);\r\n\t\tupdateFiltersAndUrl({ categories });\r\n\t}, [updateFiltersAndUrl]);\r\n\r\n\tconst setPriceRange = useCallback(\r\n\t\t(priceRange: {min: number; max: number} | null) => {\r\n\t\t\tconsole.log(\"useProductFilters: Actualizando rango de precio:\", priceRange);\r\n\t\t\tupdateFiltersAndUrl({ priceRange });\r\n\t\t},\r\n\t\t[updateFiltersAndUrl]\r\n\t);\r\n\r\n\tconst setRating = useCallback((rating: number | null) => {\r\n\t\tconsole.log(\"useProductFilters: Actualizando rating:\", rating);\r\n\t\tupdateFiltersAndUrl({ rating });\r\n\t}, [updateFiltersAndUrl]);\r\n\r\n\tconst setDiscount = useCallback((discount: boolean) => {\r\n\t\tconsole.log(\"useProductFilters: Actualizando descuento:\", discount);\r\n\t\tupdateFiltersAndUrl({ discount });\r\n\t}, [updateFiltersAndUrl]);\r\n\r\n\tconst setSortBy = useCallback((sortBy: string) => {\r\n\t\tconsole.log(\"useProductFilters: Actualizando ordenamiento:\", sortBy);\r\n\t\tupdateFiltersAndUrl({ sortBy });\r\n\t}, [updateFiltersAndUrl]);\r\n\r\n\tconst setPage = useCallback((page: number) => {\r\n\t\tconsole.log(\"useProductFilters: Actualizando p√°gina:\", page);\r\n\t\tupdateFiltersAndUrl({ page });\r\n\t}, [updateFiltersAndUrl]);\r\n\r\n\tconst setSearchTerm = useCallback((searchTerm: string) => {\r\n\t\tconsole.log(\"useProductFilters: Actualizando t√©rmino de b√∫squeda:\", searchTerm);\r\n\t\tupdateFiltersAndUrl({ searchTerm });\r\n\t}, [updateFiltersAndUrl]);\r\n\r\n\tconst clearFilters = useCallback(() => {\r\n\t\tconsole.log(\"useProductFilters: Limpiando todos los filtros\");\r\n\t\tupdateFiltersAndUrl({\r\n\t\t\tcategories: [],\r\n\t\t\tpriceRange: null,\r\n\t\t\trating: null,\r\n\t\t\tdiscount: false,\r\n\t\t\tsortBy: \"featured\",\r\n\t\t\tpage: 1,\r\n\t\t\tsearchTerm: \"\",\r\n\t\t});\r\n\t}, [updateFiltersAndUrl]);\r\n\r\n\t// Funci√≥n para alternar una categor√≠a\r\n\tconst toggleCategory = useCallback((category: string) => {\r\n\t\tconsole.log(\"useProductFilters: Alternando categor√≠a:\", category);\r\n\t\tsetFiltersState((prev) => {\r\n\t\t\tconst isSelected = prev.categories.includes(category);\r\n\t\t\tconst newCategories = isSelected\r\n\t\t\t\t? prev.categories.filter((c) => c !== category)\r\n\t\t\t\t: [...prev.categories, category];\r\n\r\n\t\t\t// Actualizar estado y URL\r\n\t\t\tisUpdatingUrl.current = true;\r\n\t\t\treturn {\r\n\t\t\t\t...prev,\r\n\t\t\t\tcategories: newCategories,\r\n\t\t\t\tpage: 1,\r\n\t\t\t};\r\n\t\t});\r\n\t}, []);\r\n\r\n\t// Construir los par√°metros para la API - FUNCI√ìN CORREGIDA Y MEJORADA\r\n\tconst buildFilterParams = useCallback((): ExtendedProductFilterParams => {\r\n\t\tconsole.log(\"üîß useProductFilters: Construyendo par√°metros desde estado:\", filtersState);\r\n\r\n\t\t// Par√°metros base SIEMPRE requeridos\r\n\t\tconst params: ExtendedProductFilterParams = {\r\n\t\t\tlimit: defaultPageSize,\r\n\t\t\toffset: (filtersState.page - 1) * defaultPageSize,\r\n\t\t\tpublished: true,\r\n\t\t\tstatus: 'active',\r\n\t\t\t// Ordenamiento por defecto cuando no hay filtros\r\n\t\t\tsortBy: 'featured',\r\n\t\t\tsortDir: 'desc'\r\n\t\t};\r\n\t\t\r\n\t\tconsole.log(\"‚öôÔ∏è useProductFilters: Par√°metros base:\", params);\r\n\r\n\t\t// Manejar t√©rmino de b√∫squeda\r\n\t\tif (filtersState.searchTerm) {\r\n\t\t\tparams.term = filtersState.searchTerm;\r\n\t\t}\r\n\r\n\t\t// Manejar selecci√≥n m√∫ltiple de categor√≠as - CORREGIDO\r\n\t\tif (filtersState.categories.length > 0) {\r\n\t\t\t// Encontrar IDs de categor√≠as por nombre\r\n\t\t\tconst categoryIds: number[] = [];\r\n\t\t\t\r\n\t\t\tfiltersState.categories.forEach((catName) => {\r\n\t\t\t\tconst category = allCategories.find(\r\n\t\t\t\t\t(c) => c.name.toLowerCase().trim() === catName.toLowerCase().trim()\r\n\t\t\t\t);\r\n\t\t\t\tif (category?.id) {\r\n\t\t\t\t\tcategoryIds.push(category.id);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.warn(`useProductFilters: No se encontr√≥ categor√≠a: \"${catName}\"`);\r\n\t\t\t\t\tconsole.log(\"useProductFilters: Categor√≠as disponibles:\", allCategories.map(c => c.name));\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tconsole.log(\"useProductFilters: IDs de categor√≠as encontrados:\", categoryIds, \"para nombres:\", filtersState.categories);\r\n\r\n\t\t\tif (categoryIds.length > 0) {\r\n\t\t\t\tparams.categoryIds = categoryIds;\r\n\t\t\t\tparams.categoryOperator = \"or\"; // OR para mostrar productos de cualquiera de las categor√≠as\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// A√±adir rango de precio si est√° seleccionado\r\n\t\tif (filtersState.priceRange) {\r\n\t\t\tparams.minPrice = filtersState.priceRange.min;\r\n\t\t\tparams.maxPrice = filtersState.priceRange.max;\r\n\t\t}\r\n\r\n\t\t// A√±adir filtro de rating\r\n\t\tif (filtersState.rating) {\r\n\t\t\tparams.rating = filtersState.rating;\r\n\t\t}\r\n\r\n\t\t// A√±adir filtro de descuento\r\n\t\tif (filtersState.discount) {\r\n\t\t\tparams.minDiscount = 5; // Productos con al menos 5% de descuento\r\n\t\t}\r\n\r\n\t\t// A√±adir ordenamiento - SOLO sobrescribir si es diferente al por defecto\r\n\t\tif (filtersState.sortBy && filtersState.sortBy !== 'featured') {\r\n\t\t\tconsole.log(\"üîÑ useProductFilters: Aplicando ordenamiento personalizado:\", filtersState.sortBy);\r\n\t\t\t\r\n\t\t\tswitch (filtersState.sortBy) {\r\n\t\t\t\tcase \"price-asc\":\r\n\t\t\t\t\tparams.sortBy = \"price\";\r\n\t\t\t\t\tparams.sortDir = \"asc\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"price-desc\":\r\n\t\t\t\t\tparams.sortBy = \"price\";\r\n\t\t\t\t\tparams.sortDir = \"desc\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"name-asc\":\r\n\t\t\t\t\tparams.sortBy = \"name\";\r\n\t\t\t\t\tparams.sortDir = \"asc\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"name-desc\":\r\n\t\t\t\t\tparams.sortBy = \"name\";\r\n\t\t\t\t\tparams.sortDir = \"desc\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"newest\":\r\n\t\t\t\t\tparams.sortBy = \"created_at\";\r\n\t\t\t\t\tparams.sortDir = \"desc\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"rating\":\r\n\t\t\t\t\tparams.sortBy = \"rating\";\r\n\t\t\t\t\tparams.sortDir = \"desc\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t// No incluir el caso \"featured\" aqu√≠ ya que est√° por defecto\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconsole.log(\"‚≠ê useProductFilters: Usando ordenamiento por defecto (featured)\");\r\n\t\t}\r\n\t\t\r\n\t\t// ‚úÖ NUEVA FUNCIONALIDAD: Habilitar c√°lculo de ratings desde tabla ratings\r\n\t\t// Esto es opcional y solo se activa para mejorar la experiencia de productos sin rating calculado\r\n\t\tparams.calculateRatingsFromTable = true;\r\n\r\n\t\tconsole.log(\"‚úÖ useProductFilters: Par√°metros finales para API:\", params);\r\n\t\t\r\n\t\t// Validaci√≥n final - asegurar que siempre tengamos par√°metros m√≠nimos v√°lidos\r\n\t\tif (!params.limit || params.limit <= 0) {\r\n\t\t\tparams.limit = defaultPageSize;\r\n\t\t\tconsole.warn(\"‚ö†Ô∏è useProductFilters: Corrigiendo limit inv√°lido\");\r\n\t\t}\r\n\t\t\r\n\t\tif (!params.sortBy) {\r\n\t\t\tparams.sortBy = 'featured';\r\n\t\t\tparams.sortDir = 'desc';\r\n\t\t\tconsole.warn(\"‚ö†Ô∏è useProductFilters: Corrigiendo sortBy faltante\");\r\n\t\t}\r\n\t\t\r\n\t\tconsole.log(\"üöÄ useProductFilters: Par√°metros VALIDADOS:\", params);\r\n\t\treturn params;\r\n\t}, [filtersState, allCategories, defaultPageSize]);\r\n\r\n\treturn {\r\n\t\tfilters: filtersState,\r\n\t\tbuildFilterParams,\r\n\t\tsetCategories,\r\n\t\tsetPriceRange,\r\n\t\tsetRating,\r\n\t\tsetDiscount,\r\n\t\tsetSortBy,\r\n\t\tsetPage,\r\n\t\tsetSearchTerm,\r\n\t\tclearFilters,\r\n\t\ttoggleCategory,\r\n\t};\r\n};\r\n\r\nexport default useProductFilters;","import {useState, useCallback} from \"react\";\r\n\r\nexport const useProductSearch = () => {\r\n\tconst [searchTerm, setSearchTerm] = useState(\"\");\r\n\tconst [isSearching, setIsSearching] = useState(false);\r\n\r\n\t// Manejar cambios en el campo de b√∫squeda (sin actualizar URL autom√°ticamente)\r\n\tconst handleSearchChange = useCallback(\r\n\t\t(e: React.ChangeEvent<HTMLInputElement>) => {\r\n\t\t\tconst value = e.target.value;\r\n\t\t\tsetSearchTerm(value);\r\n\t\t},\r\n\t\t[]\r\n\t);\r\n\r\n\t// Funci√≥n para establecer el t√©rmino de b√∫squeda externamente (desde URL)\r\n\tconst setSearchTermExternal = useCallback((term: string) => {\r\n\t\tsetSearchTerm(term);\r\n\t}, []);\r\n\r\n\t// Funci√≥n para manejar env√≠o del formulario\r\n\tconst handleSearchSubmit = useCallback(\r\n\t\t(onSearchSubmit: (searchTerm: string) => void) => (e: React.FormEvent) => {\r\n\t\t\te.preventDefault();\r\n\t\t\tsetIsSearching(true);\r\n\t\t\t\r\n\t\t\t// Llamar a la funci√≥n proporcionada para manejar la b√∫squeda\r\n\t\t\tonSearchSubmit(searchTerm);\r\n\t\t\t\r\n\t\t\t// Dar tiempo para que la b√∫squeda se procese\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tsetIsSearching(false);\r\n\t\t\t}, 300);\r\n\t\t},\r\n\t\t[searchTerm]\r\n\t);\r\n\r\n\t// Limpiar la b√∫squeda\r\n\tconst clearSearch = useCallback((onClearSearch: () => void) => {\r\n\t\tsetSearchTerm(\"\");\r\n\t\tonClearSearch();\r\n\t}, []);\r\n\r\n\treturn {\r\n\t\tsearchTerm,\r\n\t\tisSearching,\r\n\t\thandleSearchChange,\r\n\t\thandleSearchSubmit,\r\n\t\tclearSearch,\r\n\t\tsetSearchTermExternal,\r\n\t};\r\n};\r\n\r\nexport default useProductSearch;","import React, {useRef} from \"react\";\r\nimport {Search, X} from \"lucide-react\";\r\n\r\ninterface SearchBarProps {\r\n\tsearchTerm: string;\r\n\tonSearchChange: (e: React.ChangeEvent<HTMLInputElement>) => void;\r\n\tonSearch: (e: React.FormEvent) => void;\r\n\tonClear?: () => void;\r\n\tisLoading?: boolean;\r\n}\r\n\r\nconst SearchBar: React.FC<SearchBarProps> = ({\r\n\tsearchTerm,\r\n\tonSearchChange,\r\n\tonSearch,\r\n\tonClear,\r\n\tisLoading = false,\r\n}) => {\r\n\t// Ref para mantener el foco despu√©s de limpiar\r\n\tconst inputRef = useRef<HTMLInputElement>(null);\r\n\r\n\t// Manejar limpieza de la b√∫squeda y restaurar el foco\r\n\tconst handleClear = () => {\r\n\t\tif (onClear) {\r\n\t\t\tonClear();\r\n\t\t\t// Restaurar el foco al input despu√©s de limpiar\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tif (inputRef.current) {\r\n\t\t\t\t\tinputRef.current.focus();\r\n\t\t\t\t}\r\n\t\t\t}, 0);\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"mb-8\">\r\n\t\t\t<form onSubmit={onSearch} className=\"relative\">\r\n\t\t\t\t<input\r\n\t\t\t\t\tref={inputRef}\r\n\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\tplaceholder=\"Buscar productos...\"\r\n\t\t\t\t\tclassName=\"w-full py-3 px-4 pr-16 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-300 focus:border-transparent\"\r\n\t\t\t\t\tvalue={searchTerm}\r\n\t\t\t\t\tonChange={onSearchChange}\r\n\t\t\t\t\tdisabled={isLoading}\r\n\t\t\t\t\tautoComplete=\"off\"\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t{/* Bot√≥n para limpiar la b√∫squeda, solo visible si hay texto */}\r\n\t\t\t\t{searchTerm && (\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\tonClick={handleClear}\r\n\t\t\t\t\t\tclassName=\"absolute right-12 top-3 text-gray-400 hover:text-gray-600 focus:outline-none\"\r\n\t\t\t\t\t\taria-label=\"Limpiar b√∫squeda\"\r\n\t\t\t\t\t\tdisabled={isLoading}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<X size={20} />\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t<button\r\n\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\tclassName=\"absolute right-3 top-3 text-gray-400 hover:text-primary-600 focus:outline-none flex items-center justify-center h-6 w-6\"\r\n\t\t\t\t\taria-label=\"Buscar\"\r\n\t\t\t\t\tdisabled={isLoading}\r\n\t\t\t\t>\r\n\t\t\t\t\t{isLoading ? (\r\n\t\t\t\t\t\t<div className=\"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-primary-600\"></div>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<Search size={20} className=\"hover:text-primary-600\" />\r\n\t\t\t\t\t)}\r\n\t\t\t\t</button>\r\n\t\t\t</form>\r\n\r\n\t\t\t{/* Texto instructivo para indicar al usuario que debe presionar Enter o hacer clic en la lupa */}\r\n\t\t\t<p className=\"mt-1 text-xs text-gray-500 text-right\">\r\n\t\t\t\tPresiona Enter o haz clic en la lupa para buscar\r\n\t\t\t</p>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default React.memo(SearchBar);\r\n","import React, {useState} from \"react\";\r\nimport {\r\n\tChevronLeft,\r\n\tChevronRight,\r\n\tChevronRight as ChevronRightIcon,\r\n\tSmartphone,\r\n\tTv,\r\n\tLaptop,\r\n\tMonitor,\r\n\tHeadphones,\r\n\tCamera,\r\n\tWatch,\r\n\tSpeaker,\r\n\tPackage,\r\n} from \"lucide-react\";\r\nimport type {Category} from \"../../../core/domain/entities/Category\";\r\n\r\n// Diccionario de iconos\r\nconst CATEGORY_ICONS: {[key: string]: React.ElementType} = {\r\n\tsmartphone: Smartphone,\r\n\tsmartphones: Smartphone,\r\n\ttel√©fono: Smartphone,\r\n\ttelefono: Smartphone,\r\n\tm√≥vil: Smartphone,\r\n\tmovil: Smartphone,\r\n\ttv: Tv,\r\n\ttvs: Tv,\r\n\ttelevisor: Tv,\r\n\ttelevisi√≥n: Tv,\r\n\ttelevision: Tv,\r\n\tlaptop: Laptop,\r\n\tlaptops: Laptop,\r\n\tport√°til: Laptop,\r\n\tportatil: Laptop,\r\n\tordenador: Laptop,\r\n\tcomputadora: Laptop,\r\n\tmonitor: Monitor,\r\n\tmonitores: Monitor,\r\n\tpantalla: Monitor,\r\n\tauricular: Headphones,\r\n\tauriculares: Headphones,\r\n\theadphone: Headphones,\r\n\taudio: Headphones,\r\n\tc√°mara: Camera,\r\n\tcamara: Camera,\r\n\tfoto: Camera,\r\n\treloj: Watch,\r\n\trelojes: Watch,\r\n\twatch: Watch,\r\n\taltavoz: Speaker,\r\n\taltavoces: Speaker,\r\n\tspeaker: Speaker,\r\n\telectr√≥nica: Package,\r\n\telectronica: Package,\r\n\tinform√°tica: Laptop,\r\n\tinformatica: Laptop,\r\n\ttecnolog√≠a: Package,\r\n\ttecnologia: Package,\r\n\tmoda: Package,\r\n\tropa: Package,\r\n\taccesorios: Package,\r\n};\r\n\r\ninterface CategoriesCarouselProps {\r\n\tcategories: Category[];\r\n\tisLoading?: boolean;\r\n\tonCategoryClick?: (category: Category) => void;\r\n}\r\n\r\nconst CategoriesCarousel: React.FC<CategoriesCarouselProps> = ({\r\n\tcategories,\r\n\tisLoading = false,\r\n\tonCategoryClick,\r\n}) => {\r\n\t// Estado para controlar la p√°gina actual\r\n\tconst [currentPage, setCurrentPage] = useState(0);\r\n\r\n\t// Configuraci√≥n responsiva de elementos por p√°gina\r\n\tconst getItemsPerPage = () => {\r\n\t\tif (typeof window === 'undefined') return 8;\r\n\t\t\r\n\t\tconst width = window.innerWidth;\r\n\t\tif (width < 640) return 4; // sm: 2x2\r\n\t\tif (width < 768) return 6; // md: 2x3  \r\n\t\tif (width < 1024) return 8; // lg: 2x4\r\n\t\treturn 12; // xl: 3x4\r\n\t};\r\n\r\n\tconst [itemsPerPage, setItemsPerPage] = useState(getItemsPerPage);\r\n\r\n\t// Escuchar cambios de tama√±o de pantalla\r\n\tReact.useEffect(() => {\r\n\t\tconst handleResize = () => {\r\n\t\t\tsetItemsPerPage(getItemsPerPage());\r\n\t\t\t// Ajustar p√°gina actual si es necesario\r\n\t\t\tconst newTotalPages = Math.ceil(categories.length / getItemsPerPage());\r\n\t\t\tif (currentPage >= newTotalPages && newTotalPages > 0) {\r\n\t\t\t\tsetCurrentPage(newTotalPages - 1);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\twindow.addEventListener('resize', handleResize);\r\n\t\treturn () => window.removeEventListener('resize', handleResize);\r\n\t}, [categories.length, currentPage]);\r\n\r\n\t// Calcular el n√∫mero de p√°ginas\r\n\tconst totalPages = Math.ceil(categories.length / itemsPerPage);\r\n\r\n\t// Obtener las categor√≠as para la p√°gina actual\r\n\tconst getCurrentPageCategories = () => {\r\n\t\tconst start = currentPage * itemsPerPage;\r\n\t\tconst end = start + itemsPerPage;\r\n\t\treturn categories.slice(start, end);\r\n\t};\r\n\r\n\t// Navegar a la p√°gina anterior\r\n\tconst goToPreviousPage = () => {\r\n\t\tif (currentPage > 0) {\r\n\t\t\tsetCurrentPage(currentPage - 1);\r\n\t\t}\r\n\t};\r\n\r\n\t// Navegar a la p√°gina siguiente\r\n\tconst goToNextPage = () => {\r\n\t\tif (currentPage < totalPages - 1) {\r\n\t\t\tsetCurrentPage(currentPage + 1);\r\n\t\t}\r\n\t};\r\n\r\n\t// Manejar clic en categor√≠a\r\n\tconst handleCategoryClick = (category: Category, event: React.MouseEvent) => {\r\n\t\tevent.preventDefault();\r\n\t\tif (onCategoryClick) {\r\n\t\t\tonCategoryClick(category);\r\n\t\t}\r\n\t};\r\n\r\n\t// Funci√≥n para determinar qu√© √≠cono mostrar basado en el nombre de la categor√≠a\r\n\tconst renderIcon = (category: Category) => {\r\n\t\t// Si hay un emoji en el campo icon, usarlo\r\n\t\tif (category.icon && category.icon.match(/\\p{Emoji}/u)) {\r\n\t\t\treturn <span className=\"text-xl\">{category.icon}</span>;\r\n\t\t}\r\n\r\n\t\t// Buscar el nombre de la categor√≠a en el diccionario de iconos\r\n\t\tconst lowerName = category.name.toLowerCase();\r\n\t\tconst categoryKey = Object.keys(CATEGORY_ICONS).find(\r\n\t\t\t(key) => lowerName.includes(key) || key.includes(lowerName)\r\n\t\t);\r\n\r\n\t\t// Si se encuentra una coincidencia, usar el √≠cono correspondiente\r\n\t\tif (categoryKey) {\r\n\t\t\tconst IconComponent = CATEGORY_ICONS[categoryKey];\r\n\t\t\treturn <IconComponent size={20} className=\"text-gray-600\" />;\r\n\t\t}\r\n\r\n\t\t// Si no hay coincidencia, usar un √≠cono gen√©rico\r\n\t\treturn <Package size={20} className=\"text-gray-600\" />;\r\n\t};\r\n\r\n\t// Renderizar spinner durante la carga\r\n\tif (isLoading) {\r\n\t\treturn (\r\n\t\t\t<div className=\"flex justify-center py-8\">\r\n\t\t\t\t<div className=\"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary-600\"></div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\t// Si no hay categor√≠as, mostrar mensaje\r\n\tif (categories.length === 0) {\r\n\t\treturn (\r\n\t\t\t<div className=\"p-6 bg-gray-50 text-gray-500 rounded-lg text-center\">\r\n\t\t\t\t<Package size={32} className=\"mx-auto mb-2 text-gray-400\" />\r\n\t\t\t\t<p>No hay categor√≠as disponibles</p>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"space-y-4\">\r\n\t\t\t{/* Controles de navegaci√≥n - Solo mostrar si hay m√∫ltiples p√°ginas */}\r\n\t\t\t{totalPages > 1 && (\r\n\t\t\t\t<div className=\"flex items-center justify-between\">\r\n\t\t\t\t\t<div className=\"text-sm text-gray-500\">\r\n\t\t\t\t\t\t{categories.length} categor√≠as\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"flex gap-2\">\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={goToPreviousPage}\r\n\t\t\t\t\t\t\tdisabled={currentPage === 0}\r\n\t\t\t\t\t\t\tclassName={`p-2 rounded-full border transition-colors ${\r\n\t\t\t\t\t\t\t\tcurrentPage > 0\r\n\t\t\t\t\t\t\t\t\t? \"cursor-pointer text-gray-700 border-gray-300 hover:bg-gray-100 hover:border-gray-400\"\r\n\t\t\t\t\t\t\t\t\t: \"text-gray-400 border-gray-200 cursor-not-allowed\"\r\n\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\taria-label=\"P√°gina anterior\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<ChevronLeft size={18} />\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t{/* Indicadores de p√°gina */}\r\n\t\t\t\t\t\t<div className=\"flex items-center space-x-1\">\r\n\t\t\t\t\t\t\t{Array.from({length: totalPages}).map((_, index) => (\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\t\t\tonClick={() => setCurrentPage(index)}\r\n\t\t\t\t\t\t\t\t\tclassName={`w-2 h-2 rounded-full transition-colors ${\r\n\t\t\t\t\t\t\t\t\t\tindex === currentPage\r\n\t\t\t\t\t\t\t\t\t\t\t? \"bg-primary-600\"\r\n\t\t\t\t\t\t\t\t\t\t\t: \"bg-gray-300 hover:bg-gray-400\"\r\n\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t\taria-label={`Ir a p√°gina ${index + 1}`}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={goToNextPage}\r\n\t\t\t\t\t\t\tdisabled={currentPage === totalPages - 1}\r\n\t\t\t\t\t\t\tclassName={`p-2 rounded-full border transition-colors ${\r\n\t\t\t\t\t\t\t\tcurrentPage < totalPages - 1\r\n\t\t\t\t\t\t\t\t\t? \"cursor-pointer text-gray-700 border-gray-300 hover:bg-gray-100 hover:border-gray-400\"\r\n\t\t\t\t\t\t\t\t\t: \"text-gray-400 border-gray-200 cursor-not-allowed\"\r\n\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\taria-label=\"P√°gina siguiente\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<ChevronRight size={18} />\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{/* Grid de categor√≠as - Responsivo */}\r\n\t\t\t<div className=\"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-4 xl:grid-cols-6 gap-3\">\r\n\t\t\t\t{getCurrentPageCategories().map((category) => (\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tkey={category.id}\r\n\t\t\t\t\t\tclassName=\"group block no-underline text-gray-800 cursor-pointer\"\r\n\t\t\t\t\t\tonClick={(e) => handleCategoryClick(category, e)}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<div className=\"flex flex-col items-center gap-3 p-4 rounded-lg border border-gray-100 hover:border-primary-200 hover:bg-primary-50 transition-all duration-200 hover:shadow-sm\">\r\n\t\t\t\t\t\t\t<div className=\"flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 group-hover:bg-white group-hover:shadow-sm transition-all duration-200\">\r\n\t\t\t\t\t\t\t\t{renderIcon(category)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"text-center\">\r\n\t\t\t\t\t\t\t\t<span className=\"text-sm font-medium text-gray-800 group-hover:text-primary-700 transition-colors duration-200 line-clamp-2\">\r\n\t\t\t\t\t\t\t\t\t{category.name}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t{category.product_count !== undefined && category.product_count > 0 && (\r\n\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-gray-500 mt-1 block\">\r\n\t\t\t\t\t\t\t\t\t\t{category.product_count} productos\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<ChevronRightIcon className=\"w-4 h-4 text-gray-400 group-hover:text-primary-600 transition-colors duration-200 opacity-0 group-hover:opacity-100\" />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t))}\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Informaci√≥n adicional */}\r\n\t\t\t{totalPages > 1 && (\r\n\t\t\t\t<div className=\"text-center text-sm text-gray-500\">\r\n\t\t\t\t\tP√°gina {currentPage + 1} de {totalPages}\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default CategoriesCarousel;","import React, {useState} from \"react\";\r\nimport {ChevronUp, ChevronDown, Star, X} from \"lucide-react\";\r\n\r\n// Interfaces para los props\r\ninterface ProductFiltersProps {\r\n\tcategories: string[];\r\n\tpriceRange: {min: number; max: number};\r\n\tonCategoryChange: (categories: string[]) => void;\r\n\tonPriceRangeChange: (range: {min: number; max: number} | null) => void;\r\n\tonRatingChange: (rating: number | null) => void;\r\n\tonDiscountChange: (showDiscount: boolean) => void;\r\n\tonClearFilters: () => void;\r\n\tselectedCategories: string[];\r\n\tselectedPriceRange: {min: number; max: number} | null;\r\n\tselectedRating: number | null;\r\n\tselectedDiscount: boolean;\r\n\tproductCountByCategory: Record<string, number>;\r\n}\r\n\r\n// Interfaz para las secciones de filtro\r\ninterface FilterSectionProps {\r\n\ttitle: string;\r\n\tisExpanded: boolean;\r\n\tonToggle: () => void;\r\n\tchildren: React.ReactNode;\r\n}\r\n\r\n// Secci√≥n de categor√≠as\r\ninterface CategoryFilterSectionProps {\r\n\tcategories: string[];\r\n\tselectedCategories: string[];\r\n\tonCategoryChange: (categories: string[]) => void;\r\n\tisExpanded: boolean;\r\n\tonToggle: () => void;\r\n\tproductCountByCategory: Record<string, number>;\r\n}\r\n\r\n// Secci√≥n de precio\r\ninterface PriceFilterSectionProps {\r\n\tinitialMin: number;\r\n\tinitialMax: number;\r\n\tselectedRange: {min: number; max: number} | null;\r\n\tisExpanded: boolean;\r\n\tonToggle: () => void;\r\n\tonApply: (min: number, max: number) => void;\r\n\tonClear: () => void;\r\n}\r\n\r\n// Secci√≥n de valoraci√≥n\r\ninterface RatingFilterSectionProps {\r\n\tselectedRating: number | null;\r\n\tonRatingChange: (rating: number | null) => void;\r\n\tisExpanded: boolean;\r\n\tonToggle: () => void;\r\n}\r\n\r\n// Secci√≥n de descuento\r\ninterface DiscountFilterSectionProps {\r\n\tselectedDiscount: boolean;\r\n\tonDiscountChange: (showDiscount: boolean) => void;\r\n\tisExpanded: boolean;\r\n\tonToggle: () => void;\r\n}\r\n\r\n// Componente de secci√≥n de filtro gen√©rico\r\nconst FilterSection: React.FC<FilterSectionProps> = ({\r\n\ttitle,\r\n\tisExpanded,\r\n\tonToggle,\r\n\tchildren,\r\n}) => {\r\n\treturn (\r\n\t\t<div className=\"border-b border-gray-200 pb-4\">\r\n\t\t\t<button\r\n\t\t\t\tclassName=\"cursor-pointer flex justify-between items-center w-full py-2 text-left font-medium text-gray-700 hover:text-gray-900\"\r\n\t\t\t\tonClick={onToggle}\r\n\t\t\t>\r\n\t\t\t\t{title}\r\n\t\t\t\t{isExpanded ? <ChevronUp size={16} /> : <ChevronDown size={16} />}\r\n\t\t\t</button>\r\n\r\n\t\t\t{isExpanded && <div className=\"mt-2 space-y-2\">{children}</div>}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\n// Componente para filtro de categor√≠as\r\nconst CategoryFilterSection: React.FC<CategoryFilterSectionProps> = ({\r\n\tcategories,\r\n\tselectedCategories,\r\n\tonCategoryChange,\r\n\tisExpanded,\r\n\tonToggle,\r\n\tproductCountByCategory,\r\n}) => {\r\n\t// Funci√≥n para manejar cambios de categor√≠a\r\n\tconst handleCategoryToggle = (category: string) => {\r\n\t\t// Normalizar categor√≠a para evitar problemas de espacios/case sensitivity\r\n\t\tconst normalizedCategory = category.trim();\r\n\t\tconst normalizedSelectedCategories = selectedCategories.map(c => c.trim());\r\n\t\t\r\n\t\tif (normalizedSelectedCategories.includes(normalizedCategory)) {\r\n\t\t\t// Remover la categor√≠a - usar la categor√≠a original, no normalizada\r\n\t\t\tconst newCategories = selectedCategories.filter((c) => c.trim() !== normalizedCategory);\r\n\t\t\tonCategoryChange(newCategories);\r\n\t\t} else {\r\n\t\t\t// Agregar la categor√≠a\r\n\t\t\tonCategoryChange([...selectedCategories, normalizedCategory]);\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<FilterSection\r\n\t\t\ttitle=\"Categor√≠as\"\r\n\t\t\tisExpanded={isExpanded}\r\n\t\t\tonToggle={onToggle}\r\n\t\t>\r\n\t\t\t<div className=\"space-y-1 max-h-60 overflow-y-auto pr-2 scrollbar-thin\">\r\n\t\t\t\t{categories.map((category, index) => {\r\n\t\t\t\t\t// ‚úÖ CLAVE √öNICA: usar index + category para evitar duplicados\r\n\t\t\t\t\tconst uniqueKey = `category-${category}-${index}`;\r\n\t\t\t\t\tconst uniqueId = `category-input-${category}-${index}`;\r\n\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<div key={uniqueKey} className=\"flex items-center\">\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\t\tid={uniqueId}\r\n\t\t\t\t\t\t\t\tchecked={selectedCategories.map(c => c.trim()).includes(category.trim())}\r\n\t\t\t\t\t\t\t\tonChange={() => handleCategoryToggle(category)}\r\n\t\t\t\t\t\t\t\tclassName=\"cursor-pointer h-4 w-4 text-primary-600 focus:ring-primary-500 rounded border-gray-300\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\t\thtmlFor={uniqueId}\r\n\t\t\t\t\t\t\t\tclassName=\"cursor-pointer ml-2 block text-sm text-gray-700\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{category}\r\n\t\t\t\t\t\t\t\t<span className=\"ml-1 text-gray-400 text-xs\">\r\n\t\t\t\t\t\t\t\t\t({productCountByCategory[category] || 0})\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t);\r\n\t\t\t\t})}\r\n\t\t\t</div>\r\n\t\t</FilterSection>\r\n\t);\r\n};\r\n\r\n// Componente para filtro de precio\r\nconst PriceFilterSection: React.FC<PriceFilterSectionProps> = ({\r\n\tinitialMin,\r\n\tinitialMax,\r\n\tselectedRange,\r\n\tisExpanded,\r\n\tonToggle,\r\n\tonApply,\r\n\tonClear,\r\n}) => {\r\n\tconst [minPrice, setMinPrice] = useState<number>(\r\n\t\tselectedRange?.min || initialMin\r\n\t);\r\n\tconst [maxPrice, setMaxPrice] = useState<number>(\r\n\t\tselectedRange?.max || initialMax\r\n\t);\r\n\t\r\n\t// Estados para inputs de texto que permiten edici√≥n libre\r\n\tconst [minPriceText, setMinPriceText] = useState<string>(\r\n\t\t(selectedRange?.min || initialMin).toString()\r\n\t);\r\n\tconst [maxPriceText, setMaxPriceText] = useState<string>(\r\n\t\t(selectedRange?.max || initialMax).toString()\r\n\t);\r\n\tconst [minError, setMinError] = useState<string>(\"\");\r\n\tconst [maxError, setMaxError] = useState<string>(\"\");\r\n\r\n\t// Funci√≥n para validar y convertir texto a n√∫mero\r\n\tconst validateAndSetPrice = (value: string, type: 'min' | 'max') => {\r\n\t\tif (value === \"\") {\r\n\t\t\t// Permitir campo vac√≠o temporalmente\r\n\t\t\tif (type === 'min') {\r\n\t\t\t\tsetMinError(\"\");\r\n\t\t\t\tsetMinPriceText(value);\r\n\t\t\t} else {\r\n\t\t\t\tsetMaxError(\"\");\r\n\t\t\t\tsetMaxPriceText(value);\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tconst numValue = parseInt(value);\r\n\t\t\r\n\t\tif (isNaN(numValue) || numValue < 0) {\r\n\t\t\tconst error = \"Solo se permiten n√∫meros v√°lidos\";\r\n\t\t\tif (type === 'min') {\r\n\t\t\t\tsetMinError(error);\r\n\t\t\t} else {\r\n\t\t\t\tsetMaxError(error);\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\t// Validaci√≥n exitosa\r\n\t\tif (type === 'min') {\r\n\t\t\tsetMinError(\"\");\r\n\t\t\tsetMinPrice(numValue);\r\n\t\t\tsetMinPriceText(value);\r\n\t\t} else {\r\n\t\t\tsetMaxError(\"\");\r\n\t\t\tsetMaxPrice(numValue);\r\n\t\t\tsetMaxPriceText(value);\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleMinChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n\t\tvalidateAndSetPrice(e.target.value, 'min');\r\n\t};\r\n\r\n\tconst handleMaxChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n\t\tvalidateAndSetPrice(e.target.value, 'max');\r\n\t};\r\n\t\r\n\t// Manejar cuando se enfoca en el campo (focus)\r\n\tconst handleMinFocus = () => {\r\n\t\tif (minPriceText === \"0\" || minPriceText === initialMin.toString()) {\r\n\t\t\tsetMinPriceText(\"\");\r\n\t\t}\r\n\t};\r\n\t\r\n\tconst handleMaxFocus = () => {\r\n\t\tif (maxPriceText === \"0\" || maxPriceText === initialMax.toString()) {\r\n\t\t\tsetMaxPriceText(\"\");\r\n\t\t}\r\n\t};\r\n\t\r\n\t// Manejar cuando pierde el foco (blur)\r\n\tconst handleMinBlur = () => {\r\n\t\tif (minPriceText === \"\") {\r\n\t\t\tsetMinPriceText(initialMin.toString());\r\n\t\t\tsetMinPrice(initialMin);\r\n\t\t\tsetMinError(\"\");\r\n\t\t}\r\n\t};\r\n\t\r\n\tconst handleMaxBlur = () => {\r\n\t\tif (maxPriceText === \"\") {\r\n\t\t\tsetMaxPriceText(initialMax.toString());\r\n\t\t\tsetMaxPrice(initialMax);\r\n\t\t\tsetMaxError(\"\");\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleApply = () => {\r\n\t// Verificar si hay errores antes de aplicar\r\n\tif (minError || maxError) {\r\n\t return;\r\n\t}\r\n\t \r\n\t\t\t// Asegurarse de que min no es mayor que max\r\n\t\t\tconst validMin = Math.min(minPrice, maxPrice);\r\n\t\t\tconst validMax = Math.max(minPrice, maxPrice);\r\n\t\t\tonApply(validMin, validMax);\r\n\t\t};\r\n\r\n\treturn (\r\n\t\t<FilterSection title=\"Precio\" isExpanded={isExpanded} onToggle={onToggle}>\r\n\t\t\t<div className=\"space-y-4\">\r\n\t\t\t\t<div className=\"grid grid-cols-2 gap-4\">\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\thtmlFor=\"min-price\"\r\n\t\t\t\t\t\t\tclassName=\"block text-sm text-gray-500 mb-1\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tM√≠nimo\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\tid=\"min-price\"\r\n\t\t\t\t\t\t\tvalue={minPriceText}\r\n\t\t\t\t\t\t\tonChange={handleMinChange}\r\n\t\t\t\t\t\t\tonFocus={handleMinFocus}\r\n\t\t\t\t\t\t\tonBlur={handleMinBlur}\r\n\t\t\t\t\t\t\tplaceholder=\"Precio m√≠nimo\"\r\n\t\t\t\t\t\t\tclassName={`w-full p-2 border rounded ${\r\n\t\t\t\t\t\t\t\tminError ? 'border-red-300 bg-red-50' : 'border-gray-300'\r\n\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{minError && (\r\n\t\t\t\t\t\t\t<p className=\"text-xs text-red-500 mt-1\">{minError}</p>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\thtmlFor=\"max-price\"\r\n\t\t\t\t\t\t\tclassName=\"block text-sm text-gray-500 mb-1\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tM√°ximo\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\tid=\"max-price\"\r\n\t\t\t\t\t\t\tvalue={maxPriceText}\r\n\t\t\t\t\t\t\tonChange={handleMaxChange}\r\n\t\t\t\t\t\t\tonFocus={handleMaxFocus}\r\n\t\t\t\t\t\t\tonBlur={handleMaxBlur}\r\n\t\t\t\t\t\t\tplaceholder=\"Precio m√°ximo\"\r\n\t\t\t\t\t\t\tclassName={`w-full p-2 border rounded ${\r\n\t\t\t\t\t\t\t\tmaxError ? 'border-red-300 bg-red-50' : 'border-gray-300'\r\n\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{maxError && (\r\n\t\t\t\t\t\t\t<p className=\"text-xs text-red-500 mt-1\">{maxError}</p>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div className=\"flex space-x-2\">\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={handleApply}\r\n\t\t\t\t\t\tdisabled={Boolean(minError || maxError)}\r\n\t\t\t\t\t\tclassName={`flex-1 py-2 px-4 rounded text-sm ${\r\n\t\t\t\t\t\t\tminError || maxError\r\n\t\t\t\t\t\t\t\t? 'bg-gray-300 text-gray-500 cursor-not-allowed'\r\n\t\t\t\t\t\t\t\t: 'bg-primary-600 text-white hover:bg-primary-700'\r\n\t\t\t\t\t\t}`}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tAplicar\r\n\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t{selectedRange && (\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={onClear}\r\n\t\t\t\t\t\t\tclassName=\"bg-gray-200 text-gray-700 py-2 px-3 rounded hover:bg-gray-300 text-sm\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<X size={18} />\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</FilterSection>\r\n\t);\r\n};\r\n\r\n// Componente para filtro de valoraci√≥n\r\nconst RatingFilterSection: React.FC<RatingFilterSectionProps> = ({\r\n\tselectedRating,\r\n\tonRatingChange,\r\n\tisExpanded,\r\n\tonToggle,\r\n}) => {\r\n\t// Array de posibles valoraciones\r\n\tconst ratings = [5, 4, 3, 2, 1];\r\n\r\n\treturn (\r\n\t\t<FilterSection\r\n\t\t\ttitle=\"Valoraci√≥n\"\r\n\t\t\tisExpanded={isExpanded}\r\n\t\t\tonToggle={onToggle}\r\n\t\t>\r\n\t\t\t<div className=\"space-y-2\">\r\n\t\t\t\t{ratings.map((rating) => {\r\n\t\t\t\t\t// Convertir a n√∫meros para comparaci√≥n correcta\r\n\t\t\t\t\tconst isSelected = selectedRating !== null && Number(selectedRating) === Number(rating);\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tkey={`rating-${rating}`}\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\t// Si ya est√° seleccionado, deseleccionar, sino seleccionar\r\n\t\t\t\t\t\t\t\tconst newRating = isSelected ? null : rating;\r\n\t\t\t\t\t\t\t\tonRatingChange(newRating);\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tclassName={`cursor-pointer flex items-center w-full p-2 rounded-md transition ${\r\n\t\t\t\t\t\t\t\tisSelected\r\n\t\t\t\t\t\t\t\t\t? \"bg-primary-50 text-primary-700 border border-primary-200\"\r\n\t\t\t\t\t\t\t\t\t: \"hover:bg-gray-100 text-gray-700 border border-transparent\"\r\n\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t<div className=\"flex\">\r\n\t\t\t\t\t\t\t{[...Array(5)].map((_, i) => (\r\n\t\t\t\t\t\t\t\t<Star\r\n\t\t\t\t\t\t\t\t\tkey={`star-${rating}-${i}`}\r\n\t\t\t\t\t\t\t\t\tsize={16}\r\n\t\t\t\t\t\t\t\t\tfill={i < rating ? \"currentColor\" : \"none\"}\r\n\t\t\t\t\t\t\t\t\tclassName={i < rating ? \"text-yellow-400\" : \"text-gray-300\"}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<span className=\"ml-2 text-sm\">{rating}+ estrellas</span>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t);\r\n\t\t\t\t})}\r\n\t\t\t</div>\r\n\t\t</FilterSection>\r\n\t);\r\n};\r\n\r\n// Componente para filtro de descuento\r\nconst DiscountFilterSection: React.FC<DiscountFilterSectionProps> = ({\r\n\tselectedDiscount,\r\n\tonDiscountChange,\r\n\tisExpanded,\r\n\tonToggle,\r\n}) => {\r\n\treturn (\r\n\t\t<FilterSection title=\"Ofertas\" isExpanded={isExpanded} onToggle={onToggle}>\r\n\t\t\t<div className=\"space-y-2\">\r\n\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\tid=\"discount-filter\"\r\n\t\t\t\t\t\tchecked={selectedDiscount}\r\n\t\t\t\t\t\tonChange={() => onDiscountChange(!selectedDiscount)}\r\n\t\t\t\t\t\tclassName=\"cursor-pointer h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<label\r\n\t\t\t\t\t\thtmlFor=\"discount-filter\"\r\n\t\t\t\t\t\tclassName=\"cursor-pointer ml-2 block text-sm text-gray-700\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tProductos con descuento\r\n\t\t\t\t\t</label>\r\n\t\t\t\t</div>\r\n\t\t\t\t<p className=\"text-xs text-gray-500\">\r\n\t\t\t\t\tMostrar solo productos con ofertas especiales y descuentos\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t</FilterSection>\r\n\t);\r\n};\r\n\r\n// Componente principal de filtros\r\nconst ProductFilters: React.FC<ProductFiltersProps> = ({\r\n\tcategories,\r\n\tpriceRange,\r\n\tonCategoryChange,\r\n\tonPriceRangeChange,\r\n\tonRatingChange,\r\n\tonDiscountChange,\r\n\tonClearFilters,\r\n\tselectedCategories,\r\n\tselectedPriceRange,\r\n\tselectedRating,\r\n\tselectedDiscount,\r\n\tproductCountByCategory,\r\n}) => {\r\n\t// Estado para controlar qu√© secciones est√°n expandidas\r\n\tconst [expandedSections, setExpandedSections] = useState({\r\n\t\tcategories: true,\r\n\t\tprice: true,\r\n\t\trating: false,\r\n\t\tdiscount: false,\r\n\t});\r\n\r\n\t// Funci√≥n para alternar la expansi√≥n de una secci√≥n\r\n\tconst toggleSection = (section: keyof typeof expandedSections) => {\r\n\t\tsetExpandedSections((prev) => ({\r\n\t\t\t...prev,\r\n\t\t\t[section]: !prev[section],\r\n\t\t}));\r\n\t};\r\n\r\n\t// Determinar si hay filtros activos\r\n\tconst hasActiveFilters =\r\n\t\tselectedCategories.length > 0 ||\r\n\t\tselectedPriceRange !== null ||\r\n\t\tselectedRating !== null ||\r\n\t\tselectedDiscount;\r\n\r\n\treturn (\r\n\t\t<div className=\"bg-white rounded-lg shadow p-4\">\r\n\t\t\t<div className=\"flex justify-between items-center mb-4\">\r\n\t\t\t\t<h2 className=\"text-lg font-medium text-gray-800\">Filtros</h2>\r\n\r\n\t\t\t\t{hasActiveFilters && (\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={onClearFilters}\r\n\t\t\t\t\t\tclassName=\"text-sm text-primary-600 hover:text-primary-700\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tLimpiar filtros\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\r\n\t\t\t<div className=\"space-y-4\">\r\n\t\t\t\t{/* Secci√≥n de Categor√≠as */}\r\n\t\t\t\t<CategoryFilterSection\r\n\t\t\t\t\tcategories={categories}\r\n\t\t\t\t\tselectedCategories={selectedCategories}\r\n\t\t\t\t\tonCategoryChange={onCategoryChange}\r\n\t\t\t\t\tisExpanded={expandedSections.categories}\r\n\t\t\t\t\tonToggle={() => toggleSection(\"categories\")}\r\n\t\t\t\t\tproductCountByCategory={productCountByCategory}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t{/* Secci√≥n de Precio */}\r\n\t\t\t\t<PriceFilterSection\r\n\t\t\t\t\tinitialMin={priceRange.min}\r\n\t\t\t\t\tinitialMax={priceRange.max}\r\n\t\t\t\t\tselectedRange={selectedPriceRange}\r\n\t\t\t\t\tisExpanded={expandedSections.price}\r\n\t\t\t\t\tonToggle={() => toggleSection(\"price\")}\r\n\t\t\t\t\tonApply={(min, max) => onPriceRangeChange({min, max})}\r\n\t\t\t\t\tonClear={() => onPriceRangeChange(null)}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t{/* Secci√≥n de Valoraci√≥n */}\r\n\t\t\t\t<RatingFilterSection\r\n\t\t\t\t\tselectedRating={selectedRating}\r\n\t\t\t\t\tonRatingChange={onRatingChange}\r\n\t\t\t\t\tisExpanded={expandedSections.rating}\r\n\t\t\t\t\tonToggle={() => toggleSection(\"rating\")}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t{/* Secci√≥n de Descuentos */}\r\n\t\t\t\t<DiscountFilterSection\r\n\t\t\t\t\tselectedDiscount={selectedDiscount}\r\n\t\t\t\t\tonDiscountChange={onDiscountChange}\r\n\t\t\t\t\tisExpanded={expandedSections.discount}\r\n\t\t\t\t\tonToggle={() => toggleSection(\"discount\")}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default ProductFilters;\r\n","import type {Product} from \"../core/domain/entities/Product\";\r\n\r\n/**\r\n * Adapta un producto de la API para su uso en la aplicaci√≥n\r\n * Normaliza campos entre camelCase y snake_case, y maneja valores faltantes\r\n */\r\nexport const adaptProduct = (apiProduct: any): Product => {\r\n\tif (!apiProduct || typeof apiProduct !== \"object\") {\r\n\t\tconsole.error(\"Producto inv√°lido para adaptar:\", apiProduct);\r\n\t\treturn {} as Product;\r\n\t}\r\n\r\n\t// Extraer las calificaciones correctamente\r\n\t// Usando todas las posibles propiedades donde podr√≠a estar el rating\r\n\tconst rating =\r\n\t\tapiProduct.ratingAvg ||\r\n\t\tapiProduct.rating_avg ||\r\n\t\tapiProduct.rating ||\r\n\t\tapiProduct.rating_data?.average_rating ||\r\n\t\t0;\r\n\r\n    const rating_count =\r\n\t\t\tapiProduct.ratingAvg_count ||\r\n\t\t\tapiProduct.rating_avg_count ||\r\n\t\t\tapiProduct.rating_count ||\r\n\t\t\tapiProduct.rating_data?.average_rating_count ||\r\n\t\t\t0;\r\n\r\n    \r\n\t// Adaptar im√°genes seg√∫n el formato de la API\r\n\tlet images: string[] = [];\r\n\r\n\tif (Array.isArray(apiProduct.images)) {\r\n\t\t// Si images es un array de objetos con URLs\r\n\t\tif (typeof apiProduct.images[0] === \"object\") {\r\n\t\t\timages = apiProduct.images\r\n\t\t\t\t.map((img: any) => {\r\n\t\t\t\t\t// Buscar la URL original o cualquier otra propiedad disponible\r\n\t\t\t\t\treturn img.original || img.url || img.medium || img.thumbnail || \"\";\r\n\t\t\t\t})\r\n\t\t\t\t.filter(Boolean);\r\n\t\t}\r\n\t\t// Si images es un array de strings (URLs)\r\n\t\telse if (typeof apiProduct.images[0] === \"string\") {\r\n\t\t\timages = apiProduct.images;\r\n\t\t}\r\n\t}\r\n\t// Si solo hay una imagen como string\r\n\telse if (typeof apiProduct.image === \"string\") {\r\n\t\timages = [apiProduct.image];\r\n\t}\r\n\t// Si hay una propiedad imageUrl\r\n\telse if (\r\n\t\ttypeof apiProduct.imageUrl === \"string\" ||\r\n\t\ttypeof apiProduct.image_url === \"string\"\r\n\t) {\r\n\t\timages = [apiProduct.imageUrl || apiProduct.image_url];\r\n\t}\r\n\r\n\t// Calcular el descuento y precio final\r\n\tconst discountPercentage =\r\n\t\tapiProduct.discountPercentage || apiProduct.discount_percentage || 0;\r\n\tconst price = parseFloat(apiProduct.price) || 0;\r\n\tconst finalPrice =\r\n\t\tapiProduct.finalPrice ||\r\n\t\tapiProduct.final_price ||\r\n\t\t(discountPercentage > 0 ? price * (1 - discountPercentage / 100) : price);\r\n\r\n\treturn {\r\n\tid: apiProduct.id,\r\n\tuserId: apiProduct.userId || apiProduct.user_id,\r\n\tcategoryId: apiProduct.categoryId || apiProduct.category_id,\r\n\tname: apiProduct.name || \"Producto sin nombre\",\r\n\tslug: apiProduct.slug || \"\",\r\n\tdescription: apiProduct.description || \"\",\r\n\tprice: price,\r\n\tstock: parseInt(apiProduct.stock) || 0,\r\n\tweight: apiProduct.weight,\r\n\twidth: apiProduct.width,\r\n\theight: apiProduct.height,\r\n\tdepth: apiProduct.depth,\r\n\tdimensions: apiProduct.dimensions,\r\n\tcolors: apiProduct.colors,\r\n\tsizes: apiProduct.sizes,\r\n\ttags: apiProduct.tags,\r\n\tsku: apiProduct.sku,\r\n\tattributes: apiProduct.attributes,\r\n\timages: images,\r\n\tfeatured: Boolean(apiProduct.featured),\r\n\tpublished: Boolean(apiProduct.published),\r\n\tstatus: apiProduct.status || \"active\",\r\n\tviewCount: apiProduct.viewCount || apiProduct.view_count || 0,\r\n\tsalesCount: apiProduct.salesCount || apiProduct.sales_count || 0,\r\n\tdiscountPercentage: discountPercentage,\r\n\tfinalPrice: finalPrice,\r\n\tisInStock: apiProduct.isInStock || apiProduct.is_in_stock || apiProduct.stock > 0,\r\n\trating: parseFloat(rating) || 0,\r\n\tratingCount: parseFloat(rating_count) || 0, // CORREGIDO: usar ratingCount en lugar de rating_count\r\n\tcreatedAt: apiProduct.createdAt || apiProduct.created_at,\r\n\tupdatedAt: apiProduct.updatedAt || apiProduct.updated_at,\r\n\tcreated_at: apiProduct.created_at || apiProduct.createdAt || new Date().toISOString(),\r\n\tcategory_name: apiProduct.category?.name || apiProduct.category_name || \"Sin categor√≠a\",\r\n\tisNew: undefined,\r\n};\r\n};\r\n\r\n/**\r\n * Adapta una lista de productos de la API\r\n */\r\nexport const adaptProductList = (products: any[]): Product[] => {\r\n\tif (!Array.isArray(products)) {\r\n\t\tconsole.error(\"Lista de productos inv√°lida:\", products);\r\n\t\treturn [];\r\n\t}\r\n\r\n\treturn products.map((product) => adaptProduct(product));\r\n};\r\n\r\nexport default {\r\n\tadaptProduct,\r\n\tadaptProductList,\r\n};\r\n","import React, {memo} from \"react\";\r\nimport ProductCardCompact from \"./ProductCardCompact\";\r\nimport type {Product} from \"../../../core/domain/entities/Product\";\r\nimport type {Category} from \"../../../core/domain/entities/Category\";\r\nimport {adaptProduct} from \"../../../utils/productAdapter\";\r\nimport {getProductMainImage} from \"../../../utils/imageManager\";\r\n\r\ninterface ProductGridProps {\r\n\tproducts: Product[];\r\n\tcategories: Category[];\r\n\tisLoading: boolean;\r\n\terror: string | null;\r\n\tonRetry: () => void;\r\n\tonAddToCart: (productId: number) => void;\r\n\tonAddToWishlist: (productId: number) => void;\r\n\tgetImageUrl: (imagePath: string | undefined) => string;\r\n\tselectedCategories: string[];\r\n\ttotalItems: number;\r\n\tcurrentPage: number;\r\n\titemsPerPage: number;\r\n\tonResetFilters: () => void;\r\n}\r\n\r\nconst ProductGrid: React.FC<ProductGridProps> = memo(({\r\n\tproducts,\r\n\tcategories,\r\n\tisLoading,\r\n\terror,\r\n\tonRetry,\r\n\tonAddToCart,\r\n\tonAddToWishlist,\r\n\tselectedCategories,\r\n\ttotalItems,\r\n\tcurrentPage,\r\n\titemsPerPage,\r\n\tonResetFilters,\r\n}) => {\r\n\t// Si est√° cargando, mostrar spinner\r\n\tif (isLoading) {\r\n\t\treturn (\r\n\t\t\t<div className=\"flex justify-center items-center py-12\">\r\n\t\t\t\t<div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600\"></div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\t// Si hay error, mostrar mensaje\r\n\tif (error) {\r\n\t\treturn (\r\n\t\t\t<div className=\"bg-red-50 border-l-4 border-red-500 p-4 rounded\">\r\n\t\t\t\t<p className=\"text-red-700\">Error al cargar productos: {error}</p>\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={onRetry}\r\n\t\t\t\t\tclassName=\"mt-3 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700\"\r\n\t\t\t\t>\r\n\t\t\t\t\tReintentar\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\t// Si no hay productos, mostrar mensaje\r\n\tif (products.length === 0) {\r\n\t\treturn (\r\n\t\t\t<div className=\"bg-white rounded-lg shadow-sm p-8 text-center\">\r\n\t\t\t\t<h3 className=\"text-xl font-medium mb-2\">\r\n\t\t\t\t\tNo se encontraron productos\r\n\t\t\t\t</h3>\r\n\t\t\t\t<p className=\"text-gray-600 mb-4\">\r\n\t\t\t\t\tNo hay productos que coincidan con los filtros actuales.\r\n\t\t\t\t</p>\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={onResetFilters}\r\n\t\t\t\t\tclassName=\"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors\"\r\n\t\t\t\t>\r\n\t\t\t\t\tLimpiar filtros\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\t// Calcular el rango de productos mostrados\r\n\tconst start = (currentPage - 1) * itemsPerPage + 1;\r\n\tconst end = Math.min(currentPage * itemsPerPage, totalItems);\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<h2 className=\"text-2xl font-bold mb-6\">\r\n\t\t\t\t{selectedCategories.length > 0\r\n\t\t\t\t\t? selectedCategories.join(\", \")\r\n\t\t\t\t\t: \"Todos los productos\"}\r\n\t\t\t</h2>\r\n\r\n\t\t\t{/* Informaci√≥n de resultados */}\r\n\t\t\t<div className=\"flex justify-between items-center mb-6\">\r\n\t\t\t\t<p className=\"text-gray-600\">\r\n\t\t\t\t\tMostrando {start}-{end} de {totalItems} productos\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Grid de productos */}\r\n\t\t\t<div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4\">\r\n\t\t\t\t{products.map((product) => {\r\n\t\t\t\t\tconst adaptedProduct = adaptProduct(product);\r\n\t\t\t\t\r\n\t\t\t\t// L√≥gica de rating simplificada - el backend ya maneja las prioridades\r\n\t\t\t\tconst finalRating = product.calculated_rating ?? product.rating ?? adaptedProduct.rating ?? null;\r\n\t\t\t\tconst finalRatingCount = product.calculated_rating_count ?? product.rating_count ?? product.ratingCount ?? null;\r\n\t\t\t\t\r\n\t\t\t\t// Solo mostrar rating si es mayor a 0\r\n\t\t\t\tconst displayRating = (finalRating && finalRating > 0) ? finalRating : null;\r\n\t\t\t\tconst displayRatingCount = (displayRating && finalRatingCount !== null && finalRatingCount >= 0) ? finalRatingCount : null;\r\n\t\t\t\t\r\n\t\t\t\tconst imageUrl = getProductMainImage(product);\r\n\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\t<ProductCardCompact\r\n\t\t\t\t\t\t\tkey={adaptedProduct.id}\r\n\t\t\t\t\t\t\tid={adaptedProduct.id || 0}\r\n\t\t\t\t\t\t\tname={adaptedProduct.name}\r\n\t\t\t\t\t\t\tprice={adaptedProduct.price}\r\n\t\t\t\t\t\t\tdiscount={product.discountPercentage}\r\n\t\t\t\t\t\t\trating={displayRating}\r\n\t\t\t\t\t\t\treviews={displayRatingCount}\r\n\t\t\t\t\t\t\timage={imageUrl}\r\n\t\t\t\t\t\t\tcategory={\r\n\t\t\t\t\t\t\t\tcategories.find((cat) => cat.id === adaptedProduct.categoryId)\r\n\t\t\t\t\t\t\t\t\t?.name\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tisNew={\r\n\t\t\t\t\t\t\t\tnew Date(adaptedProduct.createdAt || \"\").getTime() >\r\n\t\t\t\t\t\t\t\tDate.now() - 30 * 24 * 60 * 60 * 1000\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tonAddToCart={onAddToCart}\r\n\t\t\t\t\t\t\tonAddToWishlist={onAddToWishlist}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t);\r\n\t\t\t\t})}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n});\r\n\r\nexport default ProductGrid;\r\n","import React, {useState, useRef, useEffect} from \"react\";\r\nimport {ChevronDown} from \"lucide-react\";\r\n\r\ninterface SortOption {\r\n\tid: string;\r\n\tlabel: string;\r\n}\r\n\r\ninterface SortDropdownProps {\r\n\toptions: SortOption[];\r\n\tselectedOption: string;\r\n\tonSortChange: (option: string) => void;\r\n}\r\n\r\nconst SortDropdown: React.FC<SortDropdownProps> = ({\r\n\toptions,\r\n\tselectedOption,\r\n\tonSortChange,\r\n}) => {\r\n\tconst [isOpen, setIsOpen] = useState(false);\r\n\tconst dropdownRef = useRef<HTMLDivElement>(null);\r\n\r\n\t// Cerrar dropdown al hacer clic fuera\r\n\tuseEffect(() => {\r\n\t\tconst handleClickOutside = (event: MouseEvent) => {\r\n\t\t\tif (\r\n\t\t\t\tdropdownRef.current &&\r\n\t\t\t\t!dropdownRef.current.contains(event.target as Node)\r\n\t\t\t) {\r\n\t\t\t\tsetIsOpen(false);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tdocument.addEventListener(\"mousedown\", handleClickOutside);\r\n\t\treturn () => {\r\n\t\t\tdocument.removeEventListener(\"mousedown\", handleClickOutside);\r\n\t\t};\r\n\t}, []);\r\n\r\n\t// Obtener etiqueta de la opci√≥n seleccionada\r\n\tconst getSelectedLabel = () => {\r\n\t\tconst option = options.find((opt) => opt.id === selectedOption);\r\n\t\treturn option ? option.label : \"Ordenar por\";\r\n\t};\r\n\r\n\t// Manejar selecci√≥n de opci√≥n\r\n\tconst handleSelect = (optionId: string) => {\r\n\t\tonSortChange(optionId);\r\n\t\tsetIsOpen(false);\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"relative\" ref={dropdownRef}>\r\n\t\t\t<button\r\n\t\t\t\tonClick={() => setIsOpen(!isOpen)}\r\n\t\t\t\tclassName=\"cursor-pointer flex items-center px-4 py-2 bg-white rounded-lg shadow border border-gray-200 text-gray-700 hover:bg-gray-50\"\r\n\t\t\t>\r\n\t\t\t\t<span className=\"mr-2\">{getSelectedLabel()}</span>\r\n\t\t\t\t<ChevronDown\r\n\t\t\t\t\tsize={16}\r\n\t\t\t\t\tclassName={`transition-transform ${isOpen ? \"transform rotate-180\" : \"\"}`}\r\n\t\t\t\t/>\r\n\t\t\t</button>\r\n\r\n\t\t\t{isOpen && (\r\n\t\t\t\t<div className=\"absolute right-0 mt-2 z-10 w-56 bg-white rounded-lg shadow-lg border border-gray-200 py-1\">\r\n\t\t\t\t\t{options.map((option) => (\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tkey={option.id}\r\n\t\t\t\t\t\t\tonClick={() => handleSelect(option.id)}\r\n\t\t\t\t\t\t\tclassName={`block w-full text-left px-4 py-2 text-sm ${\r\n\t\t\t\t\t\t\t\tselectedOption === option.id\r\n\t\t\t\t\t\t\t\t\t? \"bg-primary-50 text-primary-700 font-medium\"\r\n\t\t\t\t\t\t\t\t\t: \"text-gray-700 hover:bg-gray-50\"\r\n\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{option.label}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t))}\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default SortDropdown;\r\n","import React, { useState } from \"react\";\r\nimport {X} from \"lucide-react\";\r\nimport type {Category} from \"../../../core/domain/entities/Category\";\r\nimport RatingStars from \"../common/RatingStars\";\r\n\r\ninterface PriceRange {\r\n\tid: string;\r\n\tlabel: string;\r\n}\r\n\r\ninterface CustomPriceRangeMobileProps {\r\n\tonApply: (min: number, max: number) => void;\r\n\tselectedRangeId: string | null;\r\n}\r\n\r\ninterface MobileFilterPanelProps {\r\n\tisOpen: boolean;\r\n\tonClose: () => void;\r\n\tcategories: Category[];\r\n\tselectedCategories: string[];\r\n\tpriceRanges: PriceRange[];\r\n\tselectedRangeId: string | null;\r\n\tselectedRating: number | null;\r\n\tshowingDiscounted: boolean;\r\n\tonCategoryChange: (category: string, isSelected: boolean) => void;\r\n\tonPriceRangeChange: (min: number, max: number) => void;\r\n\tonRatingChange: (rating: number | null) => void;\r\n\tonDiscountToggle: () => void;\r\n\tonClearFilters: () => void;\r\n\tproductCountByCategory: Record<string, number>;\r\n}\r\n\r\n// Componente para rango de precio personalizado en m√≥vil\r\nconst CustomPriceRangeMobile: React.FC<CustomPriceRangeMobileProps> = ({ onApply, selectedRangeId: _selectedRangeId }) => {\r\n\tconst [showCustom, setShowCustom] = useState(false);\r\n\tconst [minText, setMinText] = useState(\"\");\r\n\tconst [maxText, setMaxText] = useState(\"\");\r\n\tconst [error, setError] = useState(\"\");\r\n\r\n\tconst handleApply = () => {\r\n\t\tconst min = parseInt(minText);\r\n\t\tconst max = parseInt(maxText);\r\n\t\t\r\n\t\tif (isNaN(min) || isNaN(max) || min < 0 || max < 0) {\r\n\t\t\tsetError(\"Ingrese n√∫meros v√°lidos\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tif (min > max) {\r\n\t\t\tsetError(\"El precio m√≠nimo debe ser menor al m√°ximo\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tsetError(\"\");\r\n\t\tonApply(min, max);\r\n\t\tsetShowCustom(false);\r\n\t\tsetMinText(\"\");\r\n\t\tsetMaxText(\"\");\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"border-t border-gray-200 pt-2 mt-2\">\r\n\t\t\t{!showCustom ? (\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={() => setShowCustom(true)}\r\n\t\t\t\t\tclassName=\"w-full text-left px-3 py-2 rounded-md text-sm text-primary-600 hover:bg-primary-50 font-medium\"\r\n\t\t\t\t>\r\n\t\t\t\t\t+ Rango personalizado\r\n\t\t\t\t</button>\r\n\t\t\t) : (\r\n\t\t\t\t<div className=\"space-y-3 px-3 py-2 bg-gray-50 rounded-md\">\r\n\t\t\t\t\t<div className=\"flex justify-between items-center\">\r\n\t\t\t\t\t\t<span className=\"text-sm font-medium text-gray-700\">Rango personalizado</span>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={() => {\r\n\t\t\t\t\t\t\t\tsetShowCustom(false);\r\n\t\t\t\t\t\t\t\tsetError(\"\");\r\n\t\t\t\t\t\t\t\tsetMinText(\"\");\r\n\t\t\t\t\t\t\t\tsetMaxText(\"\");\r\n\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\tclassName=\"text-gray-400 hover:text-gray-600\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<X size={16} />\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t\r\n\t\t\t\t\t<div className=\"grid grid-cols-2 gap-2\">\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\tplaceholder=\"M√≠n\"\r\n\t\t\t\t\t\t\tvalue={minText}\r\n\t\t\t\t\t\t\tonChange={(e) => setMinText(e.target.value)}\r\n\t\t\t\t\t\t\tclassName=\"px-2 py-1 border border-gray-300 rounded text-sm\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\tplaceholder=\"M√°x\"\r\n\t\t\t\t\t\t\tvalue={maxText}\r\n\t\t\t\t\t\t\tonChange={(e) => setMaxText(e.target.value)}\r\n\t\t\t\t\t\t\tclassName=\"px-2 py-1 border border-gray-300 rounded text-sm\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t\r\n\t\t\t\t\t{error && (\r\n\t\t\t\t\t\t<p className=\"text-xs text-red-500\">{error}</p>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={handleApply}\r\n\t\t\t\t\t\tclassName=\"w-full bg-primary-600 text-white py-1 px-3 rounded text-sm hover:bg-primary-700\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tAplicar\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nconst MobileFilterPanel: React.FC<MobileFilterPanelProps> = ({\r\n\tisOpen,\r\n\tonClose,\r\n\tcategories,\r\n\tselectedCategories,\r\n\tpriceRanges,\r\n\tselectedRangeId,\r\n\tselectedRating,\r\n\tshowingDiscounted,\r\n\tonCategoryChange,\r\n\tonPriceRangeChange,\r\n\tonRatingChange,\r\n\tonDiscountToggle,\r\n\tonClearFilters,\r\n\tproductCountByCategory,\r\n}) => {\r\n\t// No renderizar si no est√° abierto\r\n\tif (!isOpen) return null;\r\n\r\n\t// Procesar rango de precio\r\n\tconst handlePriceRangeSelect = (rangeId: string) => {\r\n\t\tconst [min, max] = rangeId.split(\"-\").map(Number);\r\n\t\tonPriceRangeChange(min, max);\r\n\t};\r\n\r\n\t// Calcular si hay filtros activos\r\n\tconst hasActiveFilters =\r\n\t\tselectedCategories.length > 0 ||\r\n\t\tselectedRangeId !== null ||\r\n\t\tselectedRating !== null ||\r\n\t\tshowingDiscounted;\r\n\r\n\treturn (\r\n\t\t<div className=\"fixed inset-0 bg-black bg-opacity-50 z-50 flex md:hidden\">\r\n\t\t\t<div className=\"absolute inset-y-0 right-0 w-4/5 max-w-md bg-white overflow-y-auto flex flex-col\">\r\n\t\t\t\t{/* Header */}\r\n\t\t\t\t<div className=\"flex justify-between items-center p-4 border-b border-gray-200\">\r\n\t\t\t\t\t<h2 className=\"text-lg font-medium text-gray-800\">Filtros</h2>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={onClose}\r\n\t\t\t\t\t\tclassName=\"text-gray-500 hover:text-gray-700\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<X size={24} />\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{/* Content */}\r\n\t\t\t\t<div className=\"flex-1 overflow-y-auto p-4 space-y-6\">\r\n\t\t\t\t\t{/* Categor√≠as */}\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<h3 className=\"font-medium text-gray-800 mb-3\">Categor√≠as</h3>\r\n\t\t\t\t\t\t<div className=\"space-y-2 max-h-60 overflow-y-auto\">\r\n\t\t\t\t\t\t\t{categories.map((category) => (\r\n\t\t\t\t\t\t\t\t<div key={category.id} className=\"flex items-center\">\r\n\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\t\t\t\tid={`mobile-category-${category.id}`}\r\n\t\t\t\t\t\t\t\t\t\tchecked={selectedCategories.includes(category.name)}\r\n\t\t\t\t\t\t\t\t\t\tonChange={() =>\r\n\t\t\t\t\t\t\t\t\t\t\tonCategoryChange(\r\n\t\t\t\t\t\t\t\t\t\t\t\tcategory.name,\r\n\t\t\t\t\t\t\t\t\t\t\t\t!selectedCategories.includes(category.name)\r\n\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"h-4 w-4 text-primary-600 focus:ring-primary-500 rounded border-gray-300\"\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\t\t\t\thtmlFor={`mobile-category-${category.id}`}\r\n\t\t\t\t\t\t\t\t\t\tclassName=\"ml-2 block text-sm text-gray-700\"\r\n\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t{category.name}\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"ml-1 text-gray-400 text-xs\">\r\n\t\t\t\t\t\t\t\t\t\t\t({productCountByCategory[category.name] || 0})\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Precio */}\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<h3 className=\"font-medium text-gray-800 mb-3\">Precio</h3>\r\n\t\t\t\t\t\t<div className=\"space-y-2\">\r\n\t\t\t\t\t\t\t{priceRanges.map((range) => (\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tkey={range.id}\r\n\t\t\t\t\t\t\t\t\tonClick={() => handlePriceRangeSelect(range.id)}\r\n\t\t\t\t\t\t\t\t\tclassName={`block w-full text-left px-3 py-2 rounded-md text-sm ${\r\n\t\t\t\t\t\t\t\t\t\tselectedRangeId === range.id\r\n\t\t\t\t\t\t\t\t\t\t\t? \"bg-primary-50 text-primary-700 font-medium\"\r\n\t\t\t\t\t\t\t\t\t\t\t: \"text-gray-700 hover:bg-gray-50\"\r\n\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{range.label}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t{/* Rango personalizado */}\r\n\t\t\t\t\t\t\t<CustomPriceRangeMobile \r\n\t\t\t\t\t\t\t\tonApply={(min, max) => onPriceRangeChange(min, max)}\r\n\t\t\t\t\t\t\t\tselectedRangeId={selectedRangeId}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Valoraci√≥n */}\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<h3 className=\"font-medium text-gray-800 mb-3\">Valoraci√≥n</h3>\r\n\t\t\t\t\t\t<div className=\"space-y-2\">\r\n\t\t\t\t\t\t\t{[5, 4, 3, 2, 1].map((rating) => (\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tkey={rating}\r\n\t\t\t\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\t\t\t\tonRatingChange(selectedRating === rating ? null : rating)\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tclassName={`flex items-center w-full px-3 py-2 rounded-md text-sm ${\r\n\t\t\t\t\t\t\t\t\t\tselectedRating === rating\r\n\t\t\t\t\t\t\t\t\t\t\t? \"bg-primary-50 text-primary-700 font-medium\"\r\n\t\t\t\t\t\t\t\t\t\t\t: \"text-gray-700 hover:bg-gray-50\"\r\n\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<RatingStars rating={rating} />\r\n\t\t\t\t\t\t\t\t\t<span className=\"ml-2\">{rating}+ estrellas</span>\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Descuento */}\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\t\tid=\"mobile-discount-filter\"\r\n\t\t\t\t\t\t\t\tchecked={showingDiscounted}\r\n\t\t\t\t\t\t\t\tonChange={onDiscountToggle}\r\n\t\t\t\t\t\t\t\tclassName=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\t\thtmlFor=\"mobile-discount-filter\"\r\n\t\t\t\t\t\t\t\tclassName=\"ml-2 block text-sm text-gray-700\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tProductos con descuento\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{/* Footer */}\r\n\t\t\t\t<div className=\"p-4 border-t border-gray-200 space-y-3\">\r\n\t\t\t\t\t{hasActiveFilters && (\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={onClearFilters}\r\n\t\t\t\t\t\t\tclassName=\"w-full py-2 px-4 border border-gray-300 rounded-md text-gray-700 bg-white hover:bg-gray-50 text-sm\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tLimpiar filtros\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={onClose}\r\n\t\t\t\t\t\tclassName=\"w-full py-2 px-4 bg-primary-600 hover:bg-primary-700 text-white rounded-md text-sm\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tVer resultados\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default MobileFilterPanel;\r\n","import React from \"react\";\r\nimport {X, Filter} from \"lucide-react\";\r\n\r\ninterface ActiveFiltersProps {\r\n\tselectedCategories: string[];\r\n\tselectedPriceRange: {min: number; max: number} | null;\r\n\tselectedRating: number | null;\r\n\tsearchTerm: string;\r\n\tshowingDiscounted: boolean;\r\n\tonRemoveCategory: (category: string) => void;\r\n\tonClearPriceRange: () => void;\r\n\tonClearRating: () => void;\r\n\tonClearSearch: () => void;\r\n\tonToggleDiscount: () => void;\r\n\tonClearAllFilters: () => void;\r\n\tonToggleFilters: () => void;\r\n}\r\n\r\nconst ActiveFilters: React.FC<ActiveFiltersProps> = ({\r\n\tselectedCategories,\r\n\tselectedPriceRange,\r\n\tselectedRating,\r\n\tsearchTerm,\r\n\tshowingDiscounted,\r\n\tonRemoveCategory,\r\n\tonClearPriceRange,\r\n\tonClearRating,\r\n\tonClearSearch,\r\n\tonToggleDiscount,\r\n\tonClearAllFilters,\r\n\tonToggleFilters,\r\n}) => {\r\n\t// Verificar si hay filtros activos\r\n\tconst hasActiveFilters =\r\n\t\tselectedCategories.length > 0 ||\r\n\t\tselectedPriceRange !== null ||\r\n\t\tselectedRating !== null ||\r\n\t\tshowingDiscounted ||\r\n\t\tsearchTerm !== \"\";\r\n\r\n\t// No mostrar si no hay filtros activos\r\n\tif (!hasActiveFilters) {\r\n\t\treturn (\r\n\t\t\t<button\r\n\t\t\t\tonClick={onToggleFilters}\r\n\t\t\t\tclassName=\"md:hidden flex items-center px-4 py-2 bg-white rounded-lg shadow border border-gray-200 text-gray-700\"\r\n\t\t\t>\r\n\t\t\t\t<Filter size={18} className=\"mr-2\" />\r\n\t\t\t\t<span>Filtros</span>\r\n\t\t\t</button>\r\n\t\t);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"w-full md:w-auto\">\r\n\t\t\t<div className=\"flex items-center justify-between mb-2\">\r\n\t\t\t\t<h3 className=\"text-sm font-medium text-gray-700 mr-3\">Filtros Activos</h3>\r\n\t\t\t\t{hasActiveFilters && (\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={onClearAllFilters}\r\n\t\t\t\t\t\tclassName=\"text-xs text-primary-600 hover:text-primary-700\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tLimpiar todos\r\n\t\t\t\t\t</button>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\r\n\t\t\t<div className=\"flex flex-wrap gap-2\">\r\n\t\t\t\t{/* Filtro m√≥vil - Solo visible en m√≥vil */}\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={onToggleFilters}\r\n\t\t\t\t\tclassName=\"md:hidden flex items-center px-3 py-1 bg-primary-50 text-primary-700 rounded-full text-sm\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<Filter size={14} className=\"mr-1\" />\r\n\t\t\t\t\t<span>Filtrar</span>\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t{/* T√©rmino de b√∫squeda */}\r\n\t\t\t\t{searchTerm && (\r\n\t\t\t\t\t<div className=\"flex items-center px-3 py-1 bg-blue-50 text-blue-700 rounded-full text-sm\">\r\n\t\t\t\t\t\t<span className=\"mr-1\">B√∫squeda: {searchTerm}</span>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={onClearSearch}\r\n\t\t\t\t\t\t\tclassName=\"ml-1 text-blue-500 hover:text-blue-700\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<X size={14} />\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{/* Categor√≠as seleccionadas */}\r\n\t\t\t\t{selectedCategories.map((category, key) => (\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tkey={`Active Filter - ${category} - ${key}`}\r\n\t\t\t\t\t\tclassName=\"flex items-center px-3 py-1 bg-primary-100 text-primary-700 rounded-full text-sm\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<span className=\"mr-1\">Categor√≠a: {category}</span>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={() => onRemoveCategory(category)}\r\n\t\t\t\t\t\t\tclassName=\"ml-1 text-primary-500 hover:text-primary-700\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<X size={14} />\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t))}\r\n\r\n\t\t\t\t{/* Rango de precio */}\r\n\t\t\t\t{selectedPriceRange && (\r\n\t\t\t\t\t<div className=\"flex items-center px-3 py-1 bg-green-50 text-green-700 rounded-full text-sm\">\r\n\t\t\t\t\t\t<span className=\"mr-1\">\r\n\t\t\t\t\t\t\tPrecio: ${selectedPriceRange.min} - ${selectedPriceRange.max}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={onClearPriceRange}\r\n\t\t\t\t\t\t\tclassName=\"ml-1 text-green-500 hover:text-green-700\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<X size={14} />\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{/* Valoraci√≥n */}\r\n\t\t\t\t{selectedRating !== null && (\r\n\t\t\t\t\t<div className=\"flex items-center px-3 py-1 bg-yellow-50 text-yellow-700 rounded-full text-sm\">\r\n\t\t\t\t\t\t<span className=\"mr-1\">\r\n\t\t\t\t\t\t\tValoraci√≥n: {selectedRating}+ estrellas\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={onClearRating}\r\n\t\t\t\t\t\t\tclassName=\"ml-1 text-yellow-500 hover:text-yellow-700\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<X size={14} />\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{/* Descuento */}\r\n\t\t\t\t{showingDiscounted && (\r\n\t\t\t\t\t<div className=\"flex items-center px-3 py-1 bg-red-50 text-red-700 rounded-full text-sm\">\r\n\t\t\t\t\t\t<span className=\"mr-1\">Con descuento</span>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={onToggleDiscount}\r\n\t\t\t\t\t\t\tclassName=\"ml-1 text-red-500 hover:text-red-700\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<X size={14} />\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default ActiveFilters;\r\n","import React from \"react\";\r\nimport {ChevronLeft, ChevronRight} from \"lucide-react\";\r\n\r\ninterface PaginationProps {\r\n\tcurrentPage: number;\r\n\ttotalPages: number;\r\n\tonPageChange: (page: number) => void;\r\n}\r\n\r\nconst Pagination: React.FC<PaginationProps> = ({\r\n\tcurrentPage,\r\n\ttotalPages,\r\n\tonPageChange,\r\n}) => {\r\n\t// No mostrar paginaci√≥n si solo hay una p√°gina\r\n\tif (totalPages <= 1) return null;\r\n\r\n\t// Determinar qu√© p√°ginas mostrar\r\n\tconst getPageNumbers = () => {\r\n\t\tconst pages: (number | string)[] = [];\r\n\r\n\t\t// Siempre incluir la primera p√°gina\r\n\t\tpages.push(1);\r\n\r\n\t\t// Mostrar puntos suspensivos si no estamos cerca del principio\r\n\t\tif (currentPage > 3) {\r\n\t\t\tpages.push(\"...\");\r\n\t\t}\r\n\r\n\t\t// P√°ginas adyacentes a la actual\r\n\t\tfor (\r\n\t\t\tlet i = Math.max(2, currentPage - 1);\r\n\t\t\ti <= Math.min(totalPages - 1, currentPage + 1);\r\n\t\t\ti++\r\n\t\t) {\r\n\t\t\tif (i > 1 && i < totalPages) {\r\n\t\t\t\tpages.push(i);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Mostrar puntos suspensivos si no estamos cerca del final\r\n\t\tif (currentPage < totalPages - 2) {\r\n\t\t\tpages.push(\"...\");\r\n\t\t}\r\n\r\n\t\t// Siempre incluir la √∫ltima p√°gina si hay m√°s de una\r\n\t\tif (totalPages > 1) {\r\n\t\t\tpages.push(totalPages);\r\n\t\t}\r\n\r\n\t\treturn pages;\r\n\t};\r\n\r\n\tconst pages = getPageNumbers();\r\n\r\n\treturn (\r\n\t\t<div className=\"hidden md:flex justify-center mt-6\">\r\n\t\t\t<nav\r\n\t\t\t\tclassName=\"inline-flex items-center rounded-md shadow-sm\"\r\n\t\t\t\taria-label=\"Paginaci√≥n\"\r\n\t\t\t>\r\n\t\t\t\t{/* Bot√≥n de p√°gina anterior */}\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={() => onPageChange(currentPage - 1)}\r\n\t\t\t\t\tdisabled={currentPage === 1}\r\n\t\t\t\t\tclassName={`relative inline-flex items-center rounded-l-md border border-gray-300 bg-white px-2 py-2 text-sm ${\r\n\t\t\t\t\t\tcurrentPage === 1\r\n\t\t\t\t\t\t\t? \"text-gray-300 cursor-not-allowed\"\r\n\t\t\t\t\t\t\t: \"text-gray-500 hover:bg-gray-50\"\r\n\t\t\t\t\t}`}\r\n\t\t\t\t>\r\n\t\t\t\t\t<span className=\"sr-only\">Anterior</span>\r\n\t\t\t\t\t<ChevronLeft size={16} />\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t{/* N√∫meros de p√°gina */}\r\n\t\t\t\t{pages.map((page, index) => (\r\n\t\t\t\t\t<React.Fragment key={index}>\r\n\t\t\t\t\t\t{typeof page === \"number\" ? (\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tonClick={() => onPageChange(page)}\r\n\t\t\t\t\t\t\t\tclassName={`relative inline-flex items-center border border-gray-300 px-4 py-2 text-sm font-medium ${\r\n\t\t\t\t\t\t\t\t\tcurrentPage === page\r\n\t\t\t\t\t\t\t\t\t\t? \"bg-primary-50 border-primary-500 text-primary-600 z-10\"\r\n\t\t\t\t\t\t\t\t\t\t: \"bg-white text-gray-500 hover:bg-gray-50\"\r\n\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{page}\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<span className=\"relative inline-flex items-center border border-gray-300 bg-white px-4 py-2 text-sm text-gray-700\">\r\n\t\t\t\t\t\t\t\t{page}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</React.Fragment>\r\n\t\t\t\t))}\r\n\r\n\t\t\t\t{/* Bot√≥n de p√°gina siguiente */}\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={() => onPageChange(currentPage + 1)}\r\n\t\t\t\t\tdisabled={currentPage === totalPages}\r\n\t\t\t\t\tclassName={`relative inline-flex items-center rounded-r-md border border-gray-300 bg-white px-2 py-2 text-sm ${\r\n\t\t\t\t\t\tcurrentPage === totalPages\r\n\t\t\t\t\t\t\t? \"text-gray-300 cursor-not-allowed\"\r\n\t\t\t\t\t\t\t: \"text-gray-500 hover:bg-gray-50\"\r\n\t\t\t\t\t}`}\r\n\t\t\t\t>\r\n\t\t\t\t\t<span className=\"sr-only\">Siguiente</span>\r\n\t\t\t\t\t<ChevronRight size={16} />\r\n\t\t\t\t</button>\r\n\t\t\t</nav>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Pagination;\r\n","import React from \"react\";\r\nimport {ChevronLeft, ChevronRight} from \"lucide-react\";\r\n\r\ninterface MobilePaginationProps {\r\n\tcurrentPage: number;\r\n\ttotalPages: number;\r\n\tonPageChange: (page: number) => void;\r\n}\r\n\r\n/**\r\n * Componente de paginaci√≥n optimizado para dispositivos m√≥viles\r\n * Dise√±o intuitivo con indicadores visibles para la p√°gina actual\r\n */\r\nconst MobilePagination: React.FC<MobilePaginationProps> = ({\r\n\tcurrentPage,\r\n\ttotalPages,\r\n\tonPageChange,\r\n}) => {\r\n\t// Si no hay m√∫ltiples p√°ginas, no mostrar paginaci√≥n\r\n\tif (totalPages <= 1) return null;\r\n\r\n\t// Determinar qu√© p√°ginas mostrar (m√°ximo 5)\r\n\tconst getPageNumbers = () => {\r\n\t\tconst pageNumbers = [];\r\n\r\n\t\tif (totalPages <= 5) {\r\n\t\t\t// Si hay 5 o menos p√°ginas, mostrar todas\r\n\t\t\tfor (let i = 1; i <= totalPages; i++) {\r\n\t\t\t\tpageNumbers.push(i);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// Para m√°s p√°ginas, mostrar un rango centrado en la p√°gina actual\r\n\t\t\tlet startPage;\r\n\r\n\t\t\tif (currentPage <= 3) {\r\n\t\t\t\t// Cerca del inicio\r\n\t\t\t\tstartPage = 1;\r\n\t\t\t} else if (currentPage >= totalPages - 2) {\r\n\t\t\t\t// Cerca del final\r\n\t\t\t\tstartPage = totalPages - 4;\r\n\t\t\t} else {\r\n\t\t\t\t// En medio\r\n\t\t\t\tstartPage = currentPage - 2;\r\n\t\t\t}\r\n\r\n\t\t\tfor (let i = 0; i < 5; i++) {\r\n\t\t\t\tpageNumbers.push(startPage + i);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn pageNumbers;\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"flex flex-col items-center mt-6 space-y-4\">\r\n\t\t\t{/* Indicador de p√°gina */}\r\n\t\t\t<div className=\"text-sm text-gray-500\">\r\n\t\t\t\tP√°gina <span className=\"font-medium text-gray-900\">{currentPage}</span>{\" \"}\r\n\t\t\t\tde <span className=\"font-medium text-gray-900\">{totalPages}</span>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Botones de paginaci√≥n */}\r\n\t\t\t<div className=\"flex justify-center items-center space-x-1\">\r\n\t\t\t\t{/* Bot√≥n Anterior */}\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={() => onPageChange(currentPage - 1)}\r\n\t\t\t\t\tdisabled={currentPage === 1}\r\n\t\t\t\t\tclassName={`flex items-center justify-center w-10 h-10 rounded-lg border ${\r\n\t\t\t\t\t\tcurrentPage > 1\r\n\t\t\t\t\t\t\t? \"border-gray-300 text-gray-700 hover:bg-gray-50\"\r\n\t\t\t\t\t\t\t: \"border-gray-200 text-gray-400 cursor-not-allowed\"\r\n\t\t\t\t\t}`}\r\n\t\t\t\t\taria-label=\"P√°gina anterior\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<ChevronLeft size={20} />\r\n\t\t\t\t</button>\r\n\r\n\t\t\t\t{/* Botones de n√∫mero de p√°gina */}\r\n\t\t\t\t{getPageNumbers().map((pageNum) => (\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tkey={pageNum}\r\n\t\t\t\t\t\tonClick={() => onPageChange(pageNum)}\r\n\t\t\t\t\t\tclassName={`flex items-center justify-center w-10 h-10 rounded-lg text-sm ${\r\n\t\t\t\t\t\t\tcurrentPage === pageNum\r\n\t\t\t\t\t\t\t\t? \"bg-primary-600 text-white font-medium shadow-sm\"\r\n\t\t\t\t\t\t\t\t: \"border border-gray-300 text-gray-700 hover:bg-gray-50\"\r\n\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\taria-label={`P√°gina ${pageNum}`}\r\n\t\t\t\t\t\taria-current={currentPage === pageNum ? \"page\" : undefined}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{pageNum}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t))}\r\n\r\n\t\t\t\t{/* Bot√≥n Siguiente */}\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={() => onPageChange(currentPage + 1)}\r\n\t\t\t\t\tdisabled={currentPage === totalPages}\r\n\t\t\t\t\tclassName={`flex items-center justify-center w-10 h-10 rounded-lg border ${\r\n\t\t\t\t\t\tcurrentPage < totalPages\r\n\t\t\t\t\t\t\t? \"border-gray-300 text-gray-700 hover:bg-gray-50\"\r\n\t\t\t\t\t\t\t: \"border-gray-200 text-gray-400 cursor-not-allowed\"\r\n\t\t\t\t\t}`}\r\n\t\t\t\t\taria-label=\"P√°gina siguiente\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<ChevronRight size={20} />\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default MobilePagination;\r\n","import type { Category } from '../core/domain/entities/Category';\r\nimport type { Product } from '../core/domain/entities/Product';\r\n\r\n/**\r\n * Calcula el n√∫mero de productos por categor√≠a\r\n * @param categories Lista de categor√≠as\r\n * @param products Lista de productos (opcional, si est√° disponible)\r\n * @returns Un objeto con el nombre de la categor√≠a como clave y la cantidad de productos como valor\r\n */\r\nexport const calculateProductCountByCategory = (\r\n  categories: Category[],\r\n  products?: Product[]\r\n): Record<string, number> => {\r\n  const productCountMap: Record<string, number> = {};\r\n  \r\n  // Inicializar contador para todas las categor√≠as\r\n  categories.forEach(category => {\r\n    productCountMap[category.name] = category.product_count || 0;\r\n  });\r\n  \r\n  // Si tenemos productos, actualizar contadores basados en ellos\r\n  if (products && products.length > 0) {\r\n    products.forEach(product => {\r\n      const categoryId = product.categoryId;\r\n      const category = categories.find(c => c.id === categoryId);\r\n      \r\n      if (category) {\r\n        productCountMap[category.name] = (productCountMap[category.name] || 0) + 1;\r\n      }\r\n    });\r\n  }\r\n  \r\n  return productCountMap;\r\n};\r\n\r\n/**\r\n * Ordena las categor√≠as por cantidad de productos\r\n * @param categories Lista de categor√≠as\r\n * @param productCountMap Mapa de conteo de productos por categor√≠a\r\n * @returns Lista ordenada de categor√≠as (de mayor a menor cantidad)\r\n */\r\nexport const sortCategoriesByProductCount = (\r\n  categories: Category[],\r\n  productCountMap: Record<string, number>\r\n): Category[] => {\r\n  return [...categories].sort((a, b) => {\r\n    const countA = productCountMap[a.name] || 0;\r\n    const countB = productCountMap[b.name] || 0;\r\n    return countB - countA; // Ordenar de mayor a menor\r\n  });\r\n};","import React, {useEffect, useState, useCallback, useMemo} from \"react\";\r\n\r\n// Importamos los hooks personalizados a trav√©s del archivo index\r\nimport {\r\n\tuseProductFilters,\r\n\tuseProductSearch,\r\n\tuseProducts,\r\n\tuseCategories,\r\n\tuseCart,\r\n\tuseFavorites,\r\n} from \"../hooks\";\r\n\r\n// ‚úÖ Hook para actualizaciones optimistas\r\nimport {useInvalidateCounters} from \"../hooks/useHeaderCounters\";\r\nimport CacheService from \"../../infrastructure/services/CacheService\"; // ‚úÖ A√ëADIDO\r\n\r\n// Componentes mejorados\r\nimport SearchBar from \"../components/product/SearchBar\";\r\nimport CategoriesCarousel from \"../components/product/CategoriesCarousel\";\r\nimport ProductFilters from \"../components/product/ProductFilters\";\r\nimport ProductGrid from \"../components/product/ProductGrid\";\r\nimport SortDropdown from \"../components/product/SortDropdown\";\r\nimport MobileFilterPanel from \"../components/product/MobileFilterPanel\";\r\nimport ActiveFilters from \"../components/product/ActiveFilters\";\r\nimport Pagination from \"../components/product/Pagination\";\r\nimport MobilePagination from \"../components/product/MobilePagination\";\r\n\r\n// Utilidades y configuraci√≥n\r\nimport {calculateProductCountByCategory} from \"../../utils/categoryUtils\";\r\nimport appConfig from \"../../config/appConfig\";\r\n\r\n// IMPORTAR LA FUNCI√ìN DE IMAGEN CORRECTA (la que funcionaba)\r\nimport { getImageUrl} from \"../../utils/imageManager\";\r\n\r\nimport type {Category} from \"../../core/domain/entities/Category\";\r\n\r\n// Constantes para filtros\r\nconst priceRanges = [\r\n\t{id: \"0-100\", label: \"Menos de $100\"},\r\n\t{id: \"100-300\", label: \"$100 - $300\"},\r\n\t{id: \"300-500\", label: \"$300 - $500\"},\r\n\t{id: \"500-1000\", label: \"$500 - $1000\"},\r\n\t{id: \"1000-2000\", label: \"$1000 - $2000\"},\r\n\t{id: \"2000-999999\", label: \"M√°s de $2000\"},\r\n];\r\n\r\nconst sortOptions = [\r\n\t{id: \"featured\", label: \"Destacados\"},\r\n\t{id: \"price-asc\", label: \"Precio: Menor a Mayor\"},\r\n\t{id: \"price-desc\", label: \"Precio: Mayor a Menor\"},\r\n\t{id: \"name-asc\", label: \"Nombre: A-Z\"},\r\n\t{id: \"name-desc\", label: \"Nombre: Z-A\"},\r\n\t{id: \"newest\", label: \"M√°s recientes\"},\r\n\t{id: \"rating\", label: \"Mejor valorados\"},\r\n];\r\n\r\nconst ProductPage: React.FC = () => {\r\n\t// Estado para UI\r\n\tconst [showMobileFilters, setShowMobileFilters] = useState(false);\r\n\tconst [isMobile, setIsMobile] = useState(false);\r\n\tconst [isUpdating, setIsUpdating] = useState(false); // ‚úÖ A√ëADIDO para prevenir dobles clicks\r\n\r\n\t// Hooks para datos y funcionalidad\r\n\tconst {\r\n\t\tloading: categoriesLoading,\r\n\t\terror: categoriesError,\r\n\t\tcategories: categoriesData,\r\n\t\tfetchCategories,\r\n\t} = useCategories();\r\n\r\n\tconst {\r\n\t\tsearchTerm,\r\n\t\tisSearching,\r\n\t\thandleSearchChange,\r\n\t\thandleSearchSubmit,\r\n\t\tclearSearch,\r\n\t\tsetSearchTermExternal,\r\n\t} = useProductSearch();\r\n\r\n\tconst {\r\n\t\tfilters,\r\n\t\tbuildFilterParams,\r\n\t\tsetCategories,\r\n\t\tsetPriceRange,\r\n\t\tsetRating,\r\n\t\tsetDiscount,\r\n\t\tsetSortBy,\r\n\t\tsetPage,\r\n\t\tsetSearchTerm,\r\n\t\tclearFilters,\r\n\t\ttoggleCategory,\r\n\t} = useProductFilters(categoriesData);\r\n\r\n\tconst {\r\n\t\tloading: productsLoading,\r\n\t\terror: productsError,\r\n\t\tproducts: productsData,\r\n\t\tmeta: productsMeta,\r\n\t\tfetchProducts,\r\n\t} = useProducts();\r\n\r\n\tconst {addToCart} = useCart();\r\n\tconst {toggleFavorite, checkIsFavorite} = useFavorites();\r\n\t\r\n\t// ‚úÖ Hook para actualizaciones optimistas\r\n\tconst {\r\n\t\toptimisticCartAdd,\r\n\t\toptimisticFavoriteAdd,\r\n\t\toptimisticFavoriteRemove\r\n\t} = useInvalidateCounters();\r\n\r\n\t// ‚úÖ FUNCI√ìN PARA INVALIDAR CACHE DE P√ÅGINAS ESPEC√çFICAS\r\n\tconst invalidateRelatedPages = useCallback(() => {\r\n\t\t// Invalidar cache de p√°ginas de carrito y favoritos\r\n\t\tCacheService.removeItem(\"cart_user_data\");\r\n\t\tCacheService.removeItem(\"cart_guest_data\");\r\n\t\tCacheService.removeItem(\"header_counters\");\r\n\t\t\r\n\t\t// Invalidar cache de favoritos (todas las p√°ginas)\r\n\t\tfor (let page = 1; page <= 10; page++) {\r\n\t\t\tCacheService.removeItem(`user_favorites_${page}_10`);\r\n\t\t}\r\n\t\t\r\n\t\tconsole.log(\"üîÑ Cache de p√°ginas relacionadas invalidado desde ProductPage\");\r\n\t}, []);\r\n\r\n\t// Sincronizar t√©rmino de b√∫squeda entre hooks\r\n\tuseEffect(() => {\r\n\t\tsetSearchTermExternal(filters.searchTerm);\r\n\t}, [filters.searchTerm, setSearchTermExternal]);\r\n\r\n\t// Calcular contador de productos por categor√≠a\r\n\tconst productCountByCategory = useMemo(() => {\r\n\t\treturn calculateProductCountByCategory(categoriesData, productsData);\r\n\t}, [categoriesData, productsData]);\r\n\r\n\t// Detectar si es dispositivo m√≥vil\r\n\tuseEffect(() => {\r\n\t\tconst handleResize = () => {\r\n\t\t\tsetIsMobile(window.innerWidth < 768);\r\n\t\t};\r\n\r\n\t\thandleResize(); // Check initially\r\n\t\twindow.addEventListener(\"resize\", handleResize);\r\n\r\n\t\treturn () => {\r\n\t\t\twindow.removeEventListener(\"resize\", handleResize);\r\n\t\t};\r\n\t}, []);\r\n\r\n\t// Cargar categor√≠as al iniciar\r\n\tuseEffect(() => {\r\n\t\tconsole.log(\"Cargando categor√≠as...\");\r\n\t\tfetchCategories(true, false); // withCounts = true, forceRefresh = false\r\n\t}, [fetchCategories]);\r\n\r\n\t// NUEVO: Cargar productos iniciales como respaldo\r\n\tuseEffect(() => {\r\n\t\t// Solo ejecutar una vez al montar el componente\r\n\t\tconsole.log(\"üéÜ ProductPage: Cargando productos iniciales como respaldo...\");\r\n\t\t\r\n\t\t// Par√°metros m√≠nimos para obtener productos\r\n\t\tconst initialParams = {\r\n\t\t\tlimit: appConfig.pagination.defaultPageSize,\r\n\t\t\toffset: 0,\r\n\t\t\tpublished: true,\r\n\t\t\tstatus: 'active' as const,\r\n\t\t\tsortBy: 'featured' as const,\r\n\t\t\tsortDir: 'desc' as const\r\n\t\t};\r\n\t\t\r\n\t\tconsole.log(\"üöÄ ProductPage: Cargando productos con par√°metros iniciales:\", initialParams);\r\n\t\t\r\n\t\tfetchProducts(initialParams).then((result) => {\r\n\t\t\tconsole.log(\"üéÜ ProductPage: Productos iniciales cargados:\", result);\r\n\t\t}).catch((error) => {\r\n\t\t\tconsole.error(\"‚ùå ProductPage: Error cargando productos iniciales:\", error);\r\n\t\t});\r\n\t}, []); // Array vac√≠o para ejecutar solo una vez\r\n\r\n\t// Cargar productos cuando cambian los filtros - CORREGIDO\r\n\tuseEffect(() => {\r\n\t\tconsole.log(\"üîÑ ProductPage: useEffect triggered\", {\r\n\t\t\tcategoriesCount: categoriesData.length,\r\n\t\t\tfilters: filters,\r\n\t\t\tcomponent: \"ProductPage\"\r\n\t\t});\r\n\t\t\r\n\t\tif (categoriesData.length > 0) {\r\n\t\t\tconsole.log(\"‚úÖ ProductPage: Categor√≠as disponibles, construyendo par√°metros...\");\r\n\t\t\tconst params = buildFilterParams();\r\n\t\t\tconsole.log(\"üì§ ProductPage: Par√°metros construidos:\", params);\r\n\t\t\tconsole.log(\"üöÄ ProductPage: Llamando fetchProducts...\");\r\n\t\t\tfetchProducts(params).then((result) => {\r\n\t\t\t\tconsole.log(\"üì• ProductPage: Resultado de fetchProducts:\", result);\r\n\t\t\t}).catch((error) => {\r\n\t\t\t\tconsole.error(\"‚ùå ProductPage: Error en fetchProducts:\", error);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tconsole.log(\"‚è≥ ProductPage: Esperando categor√≠as...\", categoriesData.length);\r\n\t\t}\r\n\t}, [\r\n\t\t// Solo dependencias primitivas para evitar loops infinitos\r\n\t\tcategoriesData.length,\r\n\t\tfilters.categories.join(','), // Convertir array a string\r\n\t\tfilters.priceRange ? `${filters.priceRange.min}-${filters.priceRange.max}` : '',\r\n\t\tfilters.rating,\r\n\t\tfilters.discount,\r\n\t\tfilters.sortBy,\r\n\t\tfilters.page,\r\n\t\tfilters.searchTerm\r\n\t\t// NO incluir buildFilterParams y fetchProducts para evitar loops infinitos\r\n\t]);\r\n\r\n\t// Manejadores para interacciones de usuario\r\n\tconst handlePriceRangeChange = useCallback(\r\n\t\t(range: {min: number; max: number} | null) => {\r\n\t\t\tsetPriceRange(range);\r\n\t\t},\r\n\t\t[setPriceRange]\r\n\t);\r\n\r\n\tconst handleSearchSubmitInternal = useCallback(\r\n\t\t(searchTerm: string) => {\r\n\t\t\tconsole.log(\"Manejando b√∫squeda:\", searchTerm);\r\n\t\t\tsetSearchTerm(searchTerm);\r\n\t\t},\r\n\t\t[setSearchTerm]\r\n\t);\r\n\r\n\tconst handleClearSearch = useCallback(() => {\r\n\t\tconsole.log(\"Limpiando b√∫squeda\");\r\n\t\tsetSearchTerm(\"\");\r\n\t}, [setSearchTerm]);\r\n\r\n\tconst handleCategoryClick = useCallback(\r\n\t\t(category: Category) => {\r\n\t\t\tconsole.log(\"Clic en categor√≠a:\", category.name);\r\n\t\t\ttoggleCategory(category.name);\r\n\t\t},\r\n\t\t[toggleCategory]\r\n\t);\r\n\r\n\tconst handleAddToCart = useCallback(\r\n\t\tasync (productId: number) => {\r\n\t\t\tconsole.log(\"üè™ ProductPage.handleAddToCart INICIADO\", {\r\n\t\t\t\tproductId,\r\n\t\t\t\tisUpdating,\r\n\t\t\t\tcomponent: \"ProductPage\"\r\n\t\t\t});\r\n\t\r\n\t\t\t// ‚úÖ PREVENIR DOBLES CLICKS\r\n\t\t\tif (isUpdating) {\r\n\t\t\t\tconsole.log(\"‚ùå ProductPage: Click ignorado - ya se est√° procesando\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\r\n\t\t\ttry {\r\n\t\t\t\tsetIsUpdating(true);\r\n\t\t\t\tconsole.log(\"üîí ProductPage: Estado isUpdating = true\");\r\n\t\r\n\t\t\t\t// ‚úÖ ACTUALIZACI√ìN OPTIMISTA INMEDIATA\r\n\t\t\t\tconsole.log(\"üìà ProductPage: Aplicando optimisticCartAdd...\");\r\n\t\t\t\toptimisticCartAdd();\r\n\t\r\n\t\t\t\tconsole.log(\"üìû ProductPage: Llamando addToCart API...\");\r\n\t\t\t\tawait addToCart({\r\n\t\t\t\t\tproductId,\r\n\t\t\t\t\tquantity: 1,\r\n\t\t\t\t});\r\n\t\r\n\t\t\t\t// ‚úÖ INVALIDAR CACHE DE P√ÅGINAS RELACIONADAS\r\n\t\t\t\tconsole.log(\"üîÑ ProductPage: Invalidando cache...\");\r\n\t\t\t\tinvalidateRelatedPages();\r\n\t\r\n\t\t\t\tconsole.log(`‚úÖ ProductPage: Producto ${productId} a√±adido al carrito correctamente`);\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error(\"‚ùå ProductPage: Error al a√±adir al carrito:\", error);\r\n\t\t\t} finally {\r\n\t\t\t\t// ‚úÖ TIMEOUT PARA PREVENIR SPAM\r\n\t\t\t\tconsole.log(\"üîö ProductPage: Limpiando estado isUpdating...\");\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tsetIsUpdating(false);\r\n\t\t\t\t\tconsole.log(\"‚úÖ ProductPage: Estado limpio\");\r\n\t\t\t\t}, 1000);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[addToCart, optimisticCartAdd, invalidateRelatedPages, isUpdating]\r\n\t);\r\n\r\n\tconst handleAddToWishlist = useCallback(\r\n\t\tasync (productId: number) => {\r\n\t\t\tconst isCurrentlyFavorite = checkIsFavorite(productId);\r\n\t\t\t\r\n\t\t\tconsole.log(\"üíñ ProductPage.handleAddToWishlist INICIADO\", {\r\n\t\t\t\tproductId,\r\n\t\t\t\tisCurrentlyFavorite,\r\n\t\t\t\tisUpdating,\r\n\t\t\t\tcomponent: \"ProductPage\"\r\n\t\t\t});\r\n\t\r\n\t\t\t// ‚úÖ PREVENIR DOBLES CLICKS\r\n\t\t\tif (isUpdating) {\r\n\t\t\t\tconsole.log(\"‚ùå ProductPage: Click ignorado - ya se est√° procesando\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\r\n\t\t\ttry {\r\n\t\t\t\tsetIsUpdating(true);\r\n\t\t\t\tconsole.log(\"üîí ProductPage: Estado isUpdating = true\");\r\n\t\r\n\t\t\t\t// ‚úÖ VERIFICAR ESTADO ACTUAL Y ACTUALIZACI√ìN OPTIMISTA\r\n\t\t\t\tconsole.log(`üìà ProductPage: Aplicando optimistic${isCurrentlyFavorite ? 'Remove' : 'Add'}...`);\r\n\t\t\t\t\r\n\t\t\t\tif (isCurrentlyFavorite) {\r\n\t\t\t\t\toptimisticFavoriteRemove();\r\n\t\t\t\t} else {\r\n\t\t\t\t\toptimisticFavoriteAdd();\r\n\t\t\t\t}\r\n\t\r\n\t\t\t\tconsole.log(\"üìû ProductPage: Llamando toggleFavorite API...\");\r\n\t\t\t\tawait toggleFavorite(productId);\r\n\t\r\n\t\t\t\t// ‚úÖ INVALIDAR CACHE DE P√ÅGINAS RELACIONADAS\r\n\t\t\t\tconsole.log(\"üîÑ ProductPage: Invalidando cache...\");\r\n\t\t\t\tinvalidateRelatedPages();\r\n\t\r\n\t\t\t\tconsole.log(`‚úÖ ProductPage: Favorito ${productId} gestionado correctamente`);\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error(\"‚ùå ProductPage: Error al a√±adir a favoritos:\", error);\r\n\t\t\t} finally {\r\n\t\t\t\t// ‚úÖ TIMEOUT PARA PREVENIR SPAM\r\n\t\t\t\tconsole.log(\"üîö ProductPage: Limpiando estado isUpdating...\");\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tsetIsUpdating(false);\r\n\t\t\t\t\tconsole.log(\"‚úÖ ProductPage: Estado limpio\");\r\n\t\t\t\t}, 1000);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[toggleFavorite, checkIsFavorite, optimisticFavoriteAdd, optimisticFavoriteRemove, invalidateRelatedPages, isUpdating]\r\n\t);\r\n\r\n\t// FUNCI√ìN HELPER PARA OBTENER IMAGEN DEL PRODUCTO\r\n\t// Esta funci√≥n no causa recursi√≥n porque usa la importaci√≥n directa\r\n\tconst getProductImageUrl = useCallback((imagePath: string | undefined) => {\r\n\t\treturn getImageUrl(imagePath);\r\n\t}, []);\r\n\r\n\t// Calcular el n√∫mero total de p√°ginas\r\n\tconst totalPages = productsMeta\r\n\t\t? Math.ceil(\r\n\t\t\t\tproductsMeta.total /\r\n\t\t\t\t\t(productsMeta.limit || appConfig.pagination.defaultPageSize)\r\n\t\t\t)\r\n\t\t: 0;\r\n\r\n\t// Determinar si hay filtros activos\r\n\tconst hasActiveFilters =\r\n\t\tfilters.categories.length > 0 ||\r\n\t\tfilters.priceRange !== null ||\r\n\t\tfilters.rating !== null ||\r\n\t\tfilters.discount ||\r\n\t\tfilters.sortBy !== \"featured\" ||\r\n\t\tfilters.searchTerm !== \"\";\r\n\r\n\t// Determinar si est√° cargando\r\n\tconst isLoading = productsLoading || categoriesLoading || isSearching;\r\n\r\n\t// Preparar categor√≠as para el carrusel\r\n\tconst categoriesForCarousel = useMemo(() => {\r\n\t\treturn categoriesData.filter(cat => cat.is_active).slice(0, 24); // M√°ximo 24 categor√≠as\r\n\t}, [categoriesData]);\r\n\r\n\tconsole.log(\"Estado actual:\", {\r\n\t\tcategoriesData: categoriesData.length,\r\n\t\tproductsData: productsData.length,\r\n\t\tfilters,\r\n\t\tisLoading,\r\n\t\thasActiveFilters,\r\n\t\tisUpdating, // ‚úÖ INCLUIR EN LOGS\r\n\t});\r\n\r\n\treturn (\r\n\t\t<div className=\"container mx-auto px-9 py-8\">\r\n\t\t\t<h1 className=\"text-3xl font-bold mb-6\">Productos</h1>\r\n\t\t\t{/* Search Bar Component */}\r\n\t\t\t<SearchBar\r\n\t\t\t\tsearchTerm={searchTerm}\r\n\t\t\t\tonSearchChange={handleSearchChange}\r\n\t\t\t\tonSearch={handleSearchSubmit(handleSearchSubmitInternal)}\r\n\t\t\t\tonClear={() => clearSearch(handleClearSearch)}\r\n\t\t\t\tisLoading={isSearching}\r\n\t\t\t/>\r\n\r\n\t\t\t{/* Categories Section */}\r\n\t\t\t<section className=\"mb-8\">\r\n\t\t\t\t<h2 className=\"text-xl font-bold mb-4\">Categor√≠as</h2>\r\n\t\t\t\t{categoriesLoading ? (\r\n\t\t\t\t\t<div className=\"flex justify-center py-8\">\r\n\t\t\t\t\t\t<div className=\"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary-600\"></div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t) : categoriesError ? (\r\n\t\t\t\t\t<div className=\"p-4 bg-red-50 text-red-700 rounded-lg\">\r\n\t\t\t\t\t\t<p>Error al cargar categor√≠as: {categoriesError}</p>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={() => fetchCategories(true, true)}\r\n\t\t\t\t\t\t\tclassName=\"mt-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tReintentar\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t) : categoriesForCarousel.length > 0 ? (\r\n\t\t\t\t\t<CategoriesCarousel \r\n\t\t\t\t\t\tcategories={categoriesForCarousel} \r\n\t\t\t\t\t\tonCategoryClick={handleCategoryClick}\r\n\t\t\t\t\t/>\r\n\t\t\t\t) : (\r\n\t\t\t\t\t<div className=\"p-4 bg-gray-50 text-gray-500 rounded-lg text-center\">\r\n\t\t\t\t\t\tNo hay categor√≠as disponibles\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\t\t\t</section>\r\n\r\n\t\t\t{/* Filter and Sort Section */}\r\n\t\t\t<div className=\"flex md:justify-end justify-between mb-6 space-x-4\">\r\n\t\t\t\t{/* Active Filters Component */}\r\n\t\t\t\t<ActiveFilters\r\n\t\t\t\t\tselectedCategories={filters.categories}\r\n\t\t\t\t\tselectedPriceRange={filters.priceRange}\r\n\t\t\t\t\tselectedRating={filters.rating}\r\n\t\t\t\t\tsearchTerm={filters.searchTerm}\r\n\t\t\t\t\tshowingDiscounted={filters.discount}\r\n\t\t\t\t\tonRemoveCategory={(category) => {\r\n\t\t\t\t\t\tsetCategories(filters.categories.filter((c) => c !== category));\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tonClearPriceRange={() => setPriceRange(null)}\r\n\t\t\t\t\tonClearRating={() => setRating(null)}\r\n\t\t\t\t\tonClearSearch={handleClearSearch}\r\n\t\t\t\t\tonToggleDiscount={() => setDiscount(!filters.discount)}\r\n\t\t\t\t\tonClearAllFilters={clearFilters}\r\n\t\t\t\t\tonToggleFilters={() => setShowMobileFilters(true)}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t{/* Sort Dropdown Component */}\r\n\t\t\t\t<div className=\"\">\r\n\t\t\t\t\t<SortDropdown\r\n\t\t\t\t\t\toptions={sortOptions}\r\n\t\t\t\t\t\tselectedOption={filters.sortBy}\r\n\t\t\t\t\t\tonSortChange={setSortBy}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Main Content */}\r\n\t\t\t<div className=\"flex flex-col md:flex-row gap-6\">\r\n\t\t\t\t{/* Filters Sidebar - Desktop */}\r\n\t\t\t\t<div className=\"hidden md:block md:w-72 flex-shrink-0\">\r\n\t\t\t\t\t<ProductFilters\r\n\t\t\t\t\tcategories={categoriesData.map((cat) => cat.name)}\r\n\t\t\t\t\tpriceRange={{min: 0, max: 3000}}\r\n\t\t\t\t\tonCategoryChange={setCategories}\r\n\t\t\t\t\t\tonPriceRangeChange={handlePriceRangeChange}\r\n\t\t\t\t\t\tonRatingChange={setRating}\r\n\t\t\t\t\t\tonDiscountChange={(showDiscount) => setDiscount(showDiscount)}\r\n\t\t\t\t\t\tonClearFilters={clearFilters}\r\n\t\t\t\t\t\tselectedCategories={filters.categories}\r\n\t\t\t\t\t\tselectedPriceRange={filters.priceRange}\r\n\t\t\t\t\t\tselectedRating={filters.rating}\r\n\t\t\t\t\t\tselectedDiscount={filters.discount}\r\n\t\t\t\t\t\tproductCountByCategory={productCountByCategory}\r\n\t\t\t\t\t/>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{/* Mobile Filters Panel */}\r\n\t\t\t\t<MobileFilterPanel\r\n\t\t\t\t\tisOpen={showMobileFilters}\r\n\t\t\t\t\tonClose={() => setShowMobileFilters(false)}\r\n\t\t\t\t\tcategories={categoriesData}\r\n\t\t\t\t\tselectedCategories={filters.categories}\r\n\t\t\t\t\tpriceRanges={priceRanges}\r\n\t\t\t\t\tselectedRangeId={\r\n\t\t\t\t\t\tfilters.priceRange\r\n\t\t\t\t\t\t\t? `${filters.priceRange.min}-${filters.priceRange.max}`\r\n\t\t\t\t\t\t\t: null\r\n\t\t\t\t\t}\r\n\t\t\t\t\tselectedRating={filters.rating}\r\n\t\t\t\t\tshowingDiscounted={filters.discount}\r\n\t\t\t\t\tonCategoryChange={(category, isSelected) => {\r\n\t\t\t\t\t\tif (isSelected) {\r\n\t\t\t\t\t\t\tsetCategories([...filters.categories, category]);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tsetCategories(filters.categories.filter((c) => c !== category));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tonPriceRangeChange={(min, max) => {\r\n\t\t\t\t\t\thandlePriceRangeChange({min, max});\r\n\t\t\t\t\t}}\r\n\t\t\t\t\tonRatingChange={setRating}\r\n\t\t\t\t\tonDiscountToggle={() => setDiscount(!filters.discount)}\r\n\t\t\t\t\tonClearFilters={clearFilters}\r\n\t\t\t\t\tproductCountByCategory={productCountByCategory}\r\n\t\t\t\t/>\r\n\r\n\t\t\t\t{/* Products Grid */}\r\n\t\t\t\t<div className=\"flex-1\">\r\n\t\t\t\t\t<ProductGrid\r\n\t\t\t\t\t\tproducts={productsData}\r\n\t\t\t\t\t\tcategories={categoriesData}\r\n\t\t\t\t\t\tisLoading={isLoading}\r\n\t\t\t\t\t\terror={productsError || null}\r\n\t\t\t\t\t\tonRetry={() => {\r\n\t\t\t\t\t\t\tconst params = buildFilterParams();\r\n\t\t\t\t\t\t\tfetchProducts(params);\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tonAddToCart={handleAddToCart}\r\n\t\t\t\t\t\tonAddToWishlist={handleAddToWishlist}\r\n\t\t\t\t\t\tgetImageUrl={getProductImageUrl}\r\n\t\t\t\t\t\tselectedCategories={filters.categories}\r\n\t\t\t\t\t\ttotalItems={productsMeta?.total || 0}\r\n\t\t\t\t\t\tcurrentPage={filters.page}\r\n\t\t\t\t\t\titemsPerPage={\r\n\t\t\t\t\t\t\tproductsMeta?.limit || appConfig.pagination.defaultPageSize\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tonResetFilters={clearFilters}\r\n\t\t\t\t\t/>\r\n\r\n\t\t\t\t\t{/* Paginaci√≥n */}\r\n\t\t\t\t\t{productsMeta && (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t{/* Paginaci√≥n para m√≥viles */}\r\n\t\t\t\t\t\t\t{isMobile && (\r\n\t\t\t\t\t\t\t\t<MobilePagination\r\n\t\t\t\t\t\t\t\t\tcurrentPage={filters.page}\r\n\t\t\t\t\t\t\t\t\ttotalPages={totalPages || 1}\r\n\t\t\t\t\t\t\t\t\tonPageChange={setPage}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t\t{/* Paginaci√≥n para desktop */}\r\n\t\t\t\t\t\t\t{!isMobile && (\r\n\t\t\t\t\t\t\t\t<Pagination\r\n\t\t\t\t\t\t\t\t\tcurrentPage={filters.page}\r\n\t\t\t\t\t\t\t\t\ttotalPages={totalPages || 1}\r\n\t\t\t\t\t\t\t\t\tonPageChange={setPage}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{/* Mensaje cuando no hay productos con los filtros actuales */}\r\n\t\t\t\t\t{!isLoading &&\r\n\t\t\t\t\t\t!productsError &&\r\n\t\t\t\t\t\tproductsData.length === 0 &&\r\n\t\t\t\t\t\thasActiveFilters && (\r\n\t\t\t\t\t\t\t<div className=\"mt-8 p-6 bg-yellow-50 border border-yellow-200 text-yellow-800 rounded-lg text-center\">\r\n\t\t\t\t\t\t\t\t<h3 className=\"text-lg font-medium mb-2\">\r\n\t\t\t\t\t\t\t\t\tNo se encontraron productos\r\n\t\t\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t\t\t<p className=\"mb-4\">\r\n\t\t\t\t\t\t\t\t\tNo hay productos que coincidan con los filtros seleccionados.\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tonClick={clearFilters}\r\n\t\t\t\t\t\t\t\t\tclassName=\"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\tLimpiar todos los filtros\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{/* Mensaje cuando no hay productos sin filtros */}\r\n\t\t\t\t\t{!isLoading &&\r\n\t\t\t\t\t\t!productsError &&\r\n\t\t\t\t\t\tproductsData.length === 0 &&\r\n\t\t\t\t\t\t!hasActiveFilters && (\r\n\t\t\t\t\t\t\t<div className=\"mt-8 p-6 bg-gray-50 border border-gray-200 text-gray-600 rounded-lg text-center\">\r\n\t\t\t\t\t\t\t\t<h3 className=\"text-lg font-medium mb-2\">\r\n\t\t\t\t\t\t\t\t\tNo hay productos disponibles\r\n\t\t\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t\t\t<p>\r\n\t\t\t\t\t\t\t\t\tActualmente no hay productos en el cat√°logo. Por favor, int√©ntalo m√°s tarde.\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default ProductPage;"],"names":["useProductFilters","allCategories","defaultPageSize","appConfig","searchParams","setSearchParams","useSearchParams","isUpdatingUrl","useRef","lastProcessedParams","filtersState","setFiltersState","useState","categoryParam","minPriceParam","maxPriceParam","ratingParam","discountParam","sortParam","pageParam","searchParam","c","useEffect","newParams","newParamsString","currentParams","updateFiltersAndUrl","useCallback","updates","prev","setCategories","categories","setPriceRange","priceRange","setRating","rating","setDiscount","discount","setSortBy","sortBy","setPage","page","setSearchTerm","searchTerm","clearFilters","toggleCategory","category","newCategories","buildFilterParams","params","categoryIds","catName","useProductSearch","isSearching","setIsSearching","handleSearchChange","e","value","setSearchTermExternal","term","handleSearchSubmit","onSearchSubmit","clearSearch","onClearSearch","SearchBar","onSearchChange","onSearch","onClear","isLoading","inputRef","handleClear","jsxs","jsx","X","Search","SearchBar$1","React","CATEGORY_ICONS","Smartphone","Tv","Laptop","Monitor","Headphones","Camera","Watch","Speaker","Package","CategoriesCarousel","onCategoryClick","currentPage","setCurrentPage","getItemsPerPage","width","itemsPerPage","setItemsPerPage","handleResize","newTotalPages","totalPages","getCurrentPageCategories","start","end","goToPreviousPage","goToNextPage","handleCategoryClick","event","renderIcon","lowerName","categoryKey","key","IconComponent","ChevronLeft","_","index","ChevronRight","ChevronRightIcon","FilterSection","title","isExpanded","onToggle","children","ChevronUp","ChevronDown","CategoryFilterSection","selectedCategories","onCategoryChange","productCountByCategory","handleCategoryToggle","normalizedCategory","uniqueKey","uniqueId","PriceFilterSection","initialMin","initialMax","selectedRange","onApply","minPrice","setMinPrice","maxPrice","setMaxPrice","minPriceText","setMinPriceText","maxPriceText","setMaxPriceText","minError","setMinError","maxError","setMaxError","validateAndSetPrice","type","numValue","error","handleMinChange","handleMaxChange","handleMinFocus","handleMaxFocus","handleMinBlur","handleMaxBlur","handleApply","validMin","validMax","RatingFilterSection","selectedRating","onRatingChange","ratings","isSelected","i","Star","DiscountFilterSection","selectedDiscount","onDiscountChange","ProductFilters","onPriceRangeChange","onClearFilters","selectedPriceRange","expandedSections","setExpandedSections","toggleSection","section","hasActiveFilters","min","max","adaptProduct","apiProduct","rating_count","images","img","discountPercentage","price","finalPrice","ProductGrid","memo","products","onRetry","onAddToCart","onAddToWishlist","totalItems","onResetFilters","product","adaptedProduct","finalRating","finalRatingCount","displayRating","displayRatingCount","imageUrl","getProductMainImage","ProductCardCompact","cat","SortDropdown","options","selectedOption","onSortChange","isOpen","setIsOpen","dropdownRef","handleClickOutside","getSelectedLabel","option","opt","handleSelect","optionId","CustomPriceRangeMobile","_selectedRangeId","showCustom","setShowCustom","minText","setMinText","maxText","setMaxText","setError","MobileFilterPanel","onClose","priceRanges","selectedRangeId","showingDiscounted","onDiscountToggle","handlePriceRangeSelect","rangeId","range","RatingStars","ActiveFilters","onRemoveCategory","onClearPriceRange","onClearRating","onToggleDiscount","onClearAllFilters","onToggleFilters","Filter","Pagination","onPageChange","pages","MobilePagination","getPageNumbers","pageNumbers","startPage","pageNum","calculateProductCountByCategory","productCountMap","categoryId","sortOptions","ProductPage","showMobileFilters","setShowMobileFilters","isMobile","setIsMobile","isUpdating","setIsUpdating","categoriesLoading","categoriesError","categoriesData","fetchCategories","useCategories","filters","productsLoading","productsError","productsData","productsMeta","fetchProducts","useProducts","addToCart","useCart","toggleFavorite","checkIsFavorite","useFavorites","optimisticCartAdd","optimisticFavoriteAdd","optimisticFavoriteRemove","useInvalidateCounters","invalidateRelatedPages","CacheService","useMemo","initialParams","result","handlePriceRangeChange","handleSearchSubmitInternal","handleClearSearch","handleAddToCart","productId","handleAddToWishlist","isCurrentlyFavorite","getProductImageUrl","imagePath","getImageUrl","categoriesForCarousel","showDiscount","Fragment"],"mappings":"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"}