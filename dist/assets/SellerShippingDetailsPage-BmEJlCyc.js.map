{"version":3,"file":"SellerShippingDetailsPage-BmEJlCyc.js","sources":["../../src/presentation/pages/seller/SellerShippingDetailsPage.tsx"],"sourcesContent":["import React, {useState, useEffect} from \"react\";\r\nimport {useParams, useNavigate, Link} from \"react-router-dom\";\r\nimport {\r\n\tArrowLeft,\r\n\tTruck,\r\n\tPackage,\r\n\tPackageCheck,\r\n\tPrinter,\r\n\tAlertTriangle,\r\n\tMapPin,\r\n\tRefreshCw,\r\n\tCalendar,\r\n\tCheck,\r\n\tX,\r\n\tClock,\r\n\tExternalLink,\r\n} from \"lucide-react\";\r\nimport ShippingServiceAdapter from \"../../../core/adapters/ShippingServiceAdapter\";\r\nimport type {\r\n\tShippingItem,\r\n\tShippingHistoryItem,\r\n\tShippingRouteItem,\r\n} from \"../../../core/adapters/ShippingServiceAdapter\";\r\n\r\nconst SellerShippingDetailsPage: React.FC = () => {\r\n\tconst {id} = useParams<{id: string}>();\r\n\tconst navigate = useNavigate();\r\n\tconst [shipping, setShipping] = useState<ShippingItem | null>(null);\r\n\tconst [shippingHistory, setShippingHistory] = useState<ShippingHistoryItem[]>(\r\n\t\t[]\r\n\t);\r\n\tconst [shippingRoute, setShippingRoute] = useState<ShippingRouteItem[]>([]);\r\n\tconst [loading, setLoading] = useState(true);\r\n\tconst [error, setError] = useState<string | null>(null);\r\n\tconst [isUpdating, setIsUpdating] = useState(false);\r\n\tconst [updateSuccess, setUpdateSuccess] = useState<boolean | null>(null);\r\n\tconst [updateMessage, setUpdateMessage] = useState<string>(\"\");\r\n\r\n\t// Instanciar el adaptador de servicio\r\n\tconst shippingAdapter = new ShippingServiceAdapter();\r\n\r\n\t// Cargar detalles del envío\r\n\tuseEffect(() => {\r\n\t\tif (!id) return;\r\n\t\tfetchShippingDetails();\r\n\t}, [id]);\r\n\r\n\t// Función para obtener detalles del envío\r\n\tconst fetchShippingDetails = async () => {\r\n\t\tsetLoading(true);\r\n\t\tsetError(null);\r\n\t\ttry {\r\n\t\t\t// Obtener detalles del envío\r\n\t\t\tconst shipment = await shippingAdapter.getShippingDetails(id || \"\");\r\n\r\n\t\t\tif (!shipment) {\r\n\t\t\t\tthrow new Error(\"No se pudo obtener la información del envío\");\r\n\t\t\t}\r\n\r\n\t\t\tsetShipping(shipment);\r\n\r\n\t\t\t// Si hay número de seguimiento, obtener también el historial y la ruta\r\n\t\t\tif (shipment.trackingNumber) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\t// Obtener historial\r\n\t\t\t\t\tconst history = await shippingAdapter.getShippingHistory(\r\n\t\t\t\t\t\tshipment.trackingNumber\r\n\t\t\t\t\t);\r\n\t\t\t\t\tsetShippingHistory(history);\r\n\r\n\t\t\t\t\t// Obtener ruta (si está disponible)\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tconst route = await shippingAdapter.getShippingRoute(\r\n\t\t\t\t\t\t\tshipment.trackingNumber\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tsetShippingRoute(route);\r\n\t\t\t\t\t} catch (routeError) {\r\n\t\t\t\t\t\tconsole.warn(\"No se pudo obtener la ruta del envío:\", routeError);\r\n\t\t\t\t\t\t// No establecemos error para no interrumpir la visualización de los detalles\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (historyError) {\r\n\t\t\t\t\tconsole.warn(\"No se pudo obtener historial de envío:\", historyError);\r\n\t\t\t\t\t// También añadimos un historial básico para mostrar al menos el estado actual\r\n\t\t\t\t\tsetShippingHistory([\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tdate: new Date().toISOString(),\r\n\t\t\t\t\t\t\tstatus: shipment.status,\r\n\t\t\t\t\t\t\tdescription: `Estado actual: ${getStatusText(shipment.status)}`,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t]);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\t// Si no hay número de seguimiento, añadir un elemento al historial con el estado actual\r\n\t\t\t\tsetShippingHistory([\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tdate: new Date().toISOString(),\r\n\t\t\t\t\t\tstatus: shipment.status,\r\n\t\t\t\t\t\tdescription: `Estado actual: ${getStatusText(shipment.status)}`,\r\n\t\t\t\t\t},\r\n\t\t\t\t]);\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error(\"Error al cargar detalles del envío:\", err);\r\n\t\t\tsetError(\r\n\t\t\t\t\"No se pudo cargar la información del envío. Intenta de nuevo más tarde.\"\r\n\t\t\t);\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t};\r\n\r\n\t// Función para actualizar el estado del envío\r\n\tconst updateShippingStatus = async (newStatus: ShippingItem[\"status\"]) => {\r\n\t\tif (!shipping) return;\r\n\r\n\t\tsetIsUpdating(true);\r\n\t\tsetUpdateSuccess(null);\r\n\t\tsetUpdateMessage(\"\");\r\n\r\n\t\ttry {\r\n\t\t\tconst success = await shippingAdapter.updateShippingStatus(\r\n\t\t\t\tshipping.id,\r\n\t\t\t\tnewStatus\r\n\t\t\t);\r\n\r\n\t\t\tif (success) {\r\n\t\t\t\tsetUpdateSuccess(true);\r\n\t\t\t\tsetUpdateMessage(`Estado actualizado a ${getStatusText(newStatus)}`);\r\n\r\n\t\t\t\t// Actualizar el estado local\r\n\t\t\t\tsetShipping((prev) => {\r\n\t\t\t\t\tif (!prev) return null;\r\n\t\t\t\t\treturn {...prev, status: newStatus};\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Agregar nueva entrada al historial local\r\n\t\t\t\tconst newHistoryEntry: ShippingHistoryItem = {\r\n\t\t\t\t\tdate: new Date().toISOString(),\r\n\t\t\t\t\tstatus: newStatus,\r\n\t\t\t\t\tdescription: `Actualización de estado a: ${getStatusText(newStatus)}`,\r\n\t\t\t\t};\r\n\r\n\t\t\t\tsetShippingHistory((prevHistory) => [newHistoryEntry, ...prevHistory]);\r\n\r\n\t\t\t\t// Recargar detalles después de un breve retraso\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tfetchShippingDetails();\r\n\t\t\t\t\tsetUpdateSuccess(null);\r\n\t\t\t\t}, 3000);\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(\"No se pudo actualizar el estado\");\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(`Error al actualizar estado a ${newStatus}:`, error);\r\n\t\t\tsetUpdateSuccess(false);\r\n\t\t\tsetUpdateMessage(\"Error al actualizar estado. Intenta de nuevo.\");\r\n\t\t} finally {\r\n\t\t\tsetIsUpdating(false);\r\n\t\t}\r\n\t};\r\n\r\n\t// Función para imprimir etiqueta\r\n\tconst printShippingLabel = () => {\r\n\t\tif (!shipping || !shipping.trackingNumber) return;\r\n\r\n\t\t// Aquí iría la lógica real para imprimir la etiqueta\r\n\t\t// Por ahora, solo mostraremos un mensaje\r\n\t\talert(`Imprimiendo etiqueta para envío ${shipping.trackingNumber}`);\r\n\t};\r\n\r\n\t// Obtener texto según el estado\r\n\tconst getStatusText = (status: ShippingItem[\"status\"]): string => {\r\n\t\tswitch (status) {\r\n\t\t\tcase \"pending\":\r\n\t\t\t\treturn \"Pendiente\";\r\n\t\t\tcase \"ready_to_ship\":\r\n\t\t\t\treturn \"Listo para enviar\";\r\n\t\t\tcase \"in_transit\":\r\n\t\t\tcase \"shipped\": // Añadido para compatibilidad\r\n\t\t\t\treturn \"En tránsito\";\r\n\t\t\tcase \"delivered\":\r\n\t\t\t\treturn \"Entregado\";\r\n\t\t\tcase \"failed\":\r\n\t\t\t\treturn \"Fallido\";\r\n\t\t\tcase \"returned\":\r\n\t\t\t\treturn \"Devuelto\";\r\n\t\t\tdefault:\r\n\t\t\t\treturn \"Desconocido\";\r\n\t\t}\r\n\t};\r\n\r\n\t// Obtener clase CSS según el estado\r\n\tconst getStatusClass = (status: ShippingItem[\"status\"]): string => {\r\n\t\tswitch (status) {\r\n\t\t\tcase \"pending\":\r\n\t\t\t\treturn \"bg-yellow-100 text-yellow-800\";\r\n\t\t\tcase \"ready_to_ship\":\r\n\t\t\t\treturn \"bg-blue-100 text-blue-800\";\r\n\t\t\tcase \"in_transit\":\r\n\t\t\tcase \"shipped\": // Añadido para compatibilidad\r\n\t\t\t\treturn \"bg-indigo-100 text-indigo-800\";\r\n\t\t\tcase \"delivered\":\r\n\t\t\t\treturn \"bg-green-100 text-green-800\";\r\n\t\t\tcase \"failed\":\r\n\t\t\t\treturn \"bg-red-100 text-red-800\";\r\n\t\t\tcase \"returned\":\r\n\t\t\t\treturn \"bg-orange-100 text-orange-800\";\r\n\t\t\tdefault:\r\n\t\t\t\treturn \"bg-gray-100 text-gray-800\";\r\n\t\t}\r\n\t};\r\n\r\n\t// Obtener icono según el estado\r\n\tconst getStatusIcon = (status: string) => {\r\n\t\tswitch (status) {\r\n\t\t\tcase \"pending\":\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<Package className=\"h-5 w-5 text-yellow-600\" />\r\n\t\t\t\t);\r\n\t\t\tcase \"ready_to_ship\":\r\n\t\t\t\treturn <Package className=\"h-5 w-5 text-blue-600\" />;\r\n\t\t\tcase \"in_transit\":\r\n\t\t\tcase \"shipped\": // Añadido para compatibilidad\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<Truck className=\"h-5 w-5 text-indigo-600\" />\r\n\t\t\t\t);\r\n\t\t\tcase \"delivered\":\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<PackageCheck className=\"h-5 w-5 text-green-600\" />\r\n\t\t\t\t);\r\n\t\t\tcase \"failed\":\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<AlertTriangle className=\"h-5 w-5 text-red-600\" />\r\n\t\t\t\t);\r\n\t\t\tcase \"returned\":\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<MapPin className=\"h-5 w-5 text-orange-600\" />\r\n\t\t\t\t);\r\n\t\t\tdefault:\r\n\t\t\t\treturn <Clock className=\"h-5 w-5 text-gray-500\" />;\r\n\t\t}\r\n\t};\r\n\r\n\t// Función para formatear fecha\r\n\tconst formatDate = (dateString: string): string => {\r\n\t\ttry {\r\n\t\t\tconst date = new Date(dateString);\r\n\t\t\treturn date.toLocaleDateString(\"es-ES\", {\r\n\t\t\t\tday: \"2-digit\",\r\n\t\t\t\tmonth: \"2-digit\",\r\n\t\t\t\tyear: \"numeric\",\r\n\t\t\t\thour: \"2-digit\",\r\n\t\t\t\tminute: \"2-digit\",\r\n\t\t\t});\r\n\t\t} catch (error) {\r\n\t\t\treturn dateString;\r\n\t\t}\r\n\t};\r\n\r\n\tif (loading) {\r\n\t\treturn (\r\n\t\t\t<div className=\"flex flex-col items-center justify-center min-h-screen p-4\">\r\n\t\t\t\t<div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500\"></div>\r\n\t\t\t\t<p className=\"mt-4 text-gray-700\">\r\n\t\t\t\t\tCargando detalles del envío...\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\tif (error || !shipping) {\r\n\t\treturn (\r\n\t\t\t<div className=\"bg-white rounded-lg shadow p-6 max-w-4xl mx-auto my-8\">\r\n\t\t\t\t<div className=\"text-center\">\r\n\t\t\t\t\t<div className=\"text-red-500 text-5xl mb-4\">\r\n\t\t\t\t\t\t<X className=\"h-16 w-16 mx-auto\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<h2 className=\"text-2xl font-bold text-gray-900 mb-2\">\r\n\t\t\t\t\t\tError al cargar el envío\r\n\t\t\t\t\t</h2>\r\n\t\t\t\t\t<p className=\"text-gray-600 mb-6\">\r\n\t\t\t\t\t\t{error || \"No se pudo encontrar el envío solicitado\"}\r\n\t\t\t\t\t</p>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={() => navigate(-1)}\r\n\t\t\t\t\t\tclassName=\"bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded-lg transition-colors\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tVolver\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"space-y-6\">\r\n\t\t\t{/* Encabezado y acciones */}\r\n\t\t\t<div className=\"flex flex-col md:flex-row justify-between items-start md:items-center gap-4\">\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={() => navigate(-1)}\r\n\t\t\t\t\t\tclassName=\"flex items-center text-gray-600 hover:text-primary-600 mb-2\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<ArrowLeft size={16} className=\"mr-1\" />\r\n\t\t\t\t\t\t<span>Volver a envíos</span>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<h1 className=\"text-2xl font-bold text-gray-900\">\r\n\t\t\t\t\t\tEnvío para Pedido #{shipping.orderNumber}\r\n\t\t\t\t\t</h1>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div className=\"flex flex-wrap gap-2\">\r\n\t\t\t\t\t{/* Botones de acción según el estado actual */}\r\n\t\t\t\t\t{shipping.status === \"pending\" && (\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={() => updateShippingStatus(\"ready_to_ship\")}\r\n\t\t\t\t\t\t\tdisabled={isUpdating}\r\n\t\t\t\t\t\t\tclassName=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center gap-2 disabled:opacity-50\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Package size={18} />\r\n\t\t\t\t\t\t\t<span>Preparar envío</span>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{shipping.status === \"ready_to_ship\" && shipping.trackingNumber && (\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={() => updateShippingStatus(\"shipped\")}\r\n\t\t\t\t\t\t\tdisabled={isUpdating}\r\n\t\t\t\t\t\t\tclassName=\"bg-indigo-600 text-white px-4 py-2 rounded-lg hover:bg-indigo-700 flex items-center gap-2 disabled:opacity-50\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Truck size={18} />\r\n\t\t\t\t\t\t\t<span>Marcar como enviado</span>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{(shipping.status === \"in_transit\" ||\r\n\t\t\t\t\t\tshipping.status === \"shipped\") && (\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={() => updateShippingStatus(\"delivered\")}\r\n\t\t\t\t\t\t\tdisabled={isUpdating}\r\n\t\t\t\t\t\t\tclassName=\"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center gap-2 disabled:opacity-50\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Check size={18} />\r\n\t\t\t\t\t\t\t<span>Marcar como entregado</span>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{(shipping.status === \"ready_to_ship\" ||\r\n\t\t\t\t\t\tshipping.status === \"in_transit\" ||\r\n\t\t\t\t\t\tshipping.status === \"shipped\") && (\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={() => updateShippingStatus(\"failed\")}\r\n\t\t\t\t\t\t\tdisabled={isUpdating}\r\n\t\t\t\t\t\t\tclassName=\"bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700 flex items-center gap-2 disabled:opacity-50\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<X size={18} />\r\n\t\t\t\t\t\t\t<span>Marcar como fallido</span>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{/* Imprimir etiqueta */}\r\n\t\t\t\t\t{shipping.trackingNumber && (\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={printShippingLabel}\r\n\t\t\t\t\t\t\tdisabled={isUpdating}\r\n\t\t\t\t\t\t\tclassName=\"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 flex items-center gap-2 disabled:opacity-50\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Printer size={18} />\r\n\t\t\t\t\t\t\t<span>Imprimir etiqueta</span>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t{/* Refrescar datos */}\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={fetchShippingDetails}\r\n\t\t\t\t\t\tdisabled={isUpdating}\r\n\t\t\t\t\t\tclassName=\"bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 flex items-center gap-2 disabled:opacity-50\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<RefreshCw size={18} />\r\n\t\t\t\t\t\t<span>Actualizar</span>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Mensajes de éxito/error */}\r\n\t\t\t{updateSuccess === true && (\r\n\t\t\t\t<div\r\n\t\t\t\t\tclassName=\"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative\"\r\n\t\t\t\t\trole=\"alert\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<span className=\"block sm:inline\">{updateMessage}</span>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{updateSuccess === false && (\r\n\t\t\t\t<div\r\n\t\t\t\t\tclassName=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative\"\r\n\t\t\t\t\trole=\"alert\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<span className=\"block sm:inline\">{updateMessage}</span>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{isUpdating && (\r\n\t\t\t\t<div\r\n\t\t\t\t\tclassName=\"bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded relative\"\r\n\t\t\t\t\trole=\"alert\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t<div className=\"animate-spin mr-2 h-4 w-4 border-t-2 border-blue-500\"></div>\r\n\t\t\t\t\t\t<span className=\"block sm:inline\">Actualizando estado...</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{/* Contenido principal */}\r\n\t\t\t<div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n\t\t\t\t{/* Información general y estado */}\r\n\t\t\t\t<div className=\"col-span-3 md:col-span-1 space-y-6\">\r\n\t\t\t\t\t{/* Tarjeta de estado */}\r\n\t\t\t\t\t<div className=\"bg-white rounded-lg shadow p-6\">\r\n\t\t\t\t\t\t<h2 className=\"text-lg font-medium text-gray-900 mb-4\">\r\n\t\t\t\t\t\t\tEstado del envío\r\n\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t\t<div className=\"space-y-3\">\r\n\t\t\t\t\t\t\t<div className=\"flex justify-between items-center\">\r\n\t\t\t\t\t\t\t\t<span className=\"text-gray-600\">\r\n\t\t\t\t\t\t\t\t\tEstado:\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\tclassName={`px-2.5 py-0.5 rounded-full text-xs font-medium ${getStatusClass(shipping.status)}`}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{getStatusText(shipping.status)}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"flex justify-between items-center\">\r\n\t\t\t\t\t\t\t\t<span className=\"text-gray-600\">\r\n\t\t\t\t\t\t\t\t\tTransportista:\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t<span className=\"text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t{shipping.carrier || \"No asignado\"}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{shipping.trackingNumber && (\r\n\t\t\t\t\t\t\t\t<div className=\"flex justify-between items-center\">\r\n\t\t\t\t\t\t\t\t\t<span className=\"text-gray-600\">\r\n\t\t\t\t\t\t\t\t\t\tNº Seguimiento:\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-gray-900 font-mono\">\r\n\t\t\t\t\t\t\t\t\t\t\t{shipping.trackingNumber}\r\n\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t{shipping.carrier && (\r\n\t\t\t\t\t\t\t\t\t\t\t<a\r\n\t\t\t\t\t\t\t\t\t\t\t\thref=\"#\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"ml-2 text-blue-600 hover:text-blue-800\"\r\n\t\t\t\t\t\t\t\t\t\t\t\ttitle={`Rastrear con ${shipping.carrier}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={(e) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t// Aquí iría la lógica para abrir el sitio de rastreo del transportista\r\n\t\t\t\t\t\t\t\t\t\t\t\t\talert(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`Redirigiendo al sitio de ${shipping.carrier} para rastrear ${shipping.trackingNumber}`\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<ExternalLink size={14} />\r\n\t\t\t\t\t\t\t\t\t\t\t</a>\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t{shipping.estimatedDelivery && (\r\n\t\t\t\t\t\t\t\t<div className=\"flex justify-between items-center\">\r\n\t\t\t\t\t\t\t\t\t<span className=\"text-gray-600\">\r\n\t\t\t\t\t\t\t\t\t\tEntrega estimada:\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t<span className=\"text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t\t{new Date(shipping.estimatedDelivery).toLocaleDateString(\r\n\t\t\t\t\t\t\t\t\t\t\t\"es-ES\"\r\n\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t<div className=\"flex justify-between items-center\">\r\n\t\t\t\t\t\t\t\t<span className=\"text-gray-600\">\r\n\t\t\t\t\t\t\t\t\tFecha de pedido:\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t<span className=\"text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t{new Date(shipping.date).toLocaleDateString(\"es-ES\")}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{shipping.lastUpdate && (\r\n\t\t\t\t\t\t\t\t<div className=\"flex justify-between items-center\">\r\n\t\t\t\t\t\t\t\t\t<span className=\"text-gray-600\">\r\n\t\t\t\t\t\t\t\t\t\tÚltima actualización:\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t<span className=\"text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t\t{formatDate(shipping.lastUpdate)}\r\n\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Información del cliente */}\r\n\t\t\t\t\t<div className=\"bg-white rounded-lg shadow p-6\">\r\n\t\t\t\t\t\t<div className=\"flex justify-between items-center mb-4\">\r\n\t\t\t\t\t\t\t<h2 className=\"text-lg font-medium text-gray-900\">\r\n\t\t\t\t\t\t\t\tCliente\r\n\t\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"space-y-3\">\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<label className=\"block text-sm font-medium text-gray-600\">\r\n\t\t\t\t\t\t\t\t\tNombre:\r\n\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t<div className=\"mt-1 text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t{shipping.customer.name}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<label className=\"block text-sm font-medium text-gray-600\">\r\n\t\t\t\t\t\t\t\t\tEmail:\r\n\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t<div className=\"mt-1 text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t{shipping.customer.email}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t{shipping.customer.phone && (\r\n\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t<label className=\"block text-sm font-medium text-gray-600\">\r\n\t\t\t\t\t\t\t\t\t\t\tTeléfono:\r\n\t\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"mt-1 text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t\t\t{shipping.customer.phone}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<label className=\"block text-sm font-medium text-gray-600\">\r\n\t\t\t\t\t\t\t\t\t\tDirección de envío:\r\n\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t<div className=\"mt-1 text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t\t{shipping.shippingAddress || \"No disponible\"}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Información del pedido */}\r\n\t\t\t\t\t<div className=\"bg-white rounded-lg shadow p-6\">\r\n\t\t\t\t\t\t<div className=\"flex justify-between items-center mb-4\">\r\n\t\t\t\t\t\t\t<h2 className=\"text-lg font-medium text-gray-900\">\r\n\t\t\t\t\t\t\t\tPedido\r\n\t\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\tto={`/seller/orders/${shipping.orderId}`}\r\n\t\t\t\t\t\t\t\tclassName=\"text-sm text-primary-600 hover:underline\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tVer detalles\r\n\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"space-y-3\">\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<label className=\"block text-sm font-medium text-gray-600\">\r\n\t\t\t\t\t\t\t\t\tNúmero de pedido:\r\n\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t<div className=\"mt-1 text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t{shipping.orderNumber}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<label className=\"block text-sm font-medium text-gray-600\">\r\n\t\t\t\t\t\t\t\t\tMétodo de envío:\r\n\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t<div className=\"mt-1 text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t{shipping.shippingMethod || \"Estándar\"}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{shipping.weight && (\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<label className=\"block text-sm font-medium text-gray-600\">\r\n\t\t\t\t\t\t\t\t\t\tPeso:\r\n\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t<div className=\"mt-1 text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t\t{shipping.weight} kg\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t{shipping.shippingCost !== undefined && (\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<label className=\"block text-sm font-medium text-gray-600\">\r\n\t\t\t\t\t\t\t\t\t\tCoste de envío:\r\n\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t<div className=\"mt-1 text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t\t{new Intl.NumberFormat(\"es-ES\", {\r\n\t\t\t\t\t\t\t\t\t\t\tstyle: \"currency\",\r\n\t\t\t\t\t\t\t\t\t\t\tcurrency: \"EUR\",\r\n\t\t\t\t\t\t\t\t\t\t}).format(shipping.shippingCost)}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{/* Historial y seguimiento */}\r\n\t\t\t\t<div className=\"col-span-3 md:col-span-2 space-y-6\">\r\n\t\t\t\t\t{/* Historial de estados */}\r\n\t\t\t\t\t<div className=\"bg-white rounded-lg shadow p-6\">\r\n\t\t\t\t\t\t<h2 className=\"text-lg font-medium text-gray-900 mb-4\">\r\n\t\t\t\t\t\t\tHistorial de envío\r\n\t\t\t\t\t\t</h2>\r\n\r\n\t\t\t\t\t\t{shippingHistory.length === 0 ? (\r\n\t\t\t\t\t\t\t<div className=\"text-center py-6\">\r\n\t\t\t\t\t\t\t\t<p className=\"text-gray-500\">\r\n\t\t\t\t\t\t\t\t\tNo hay historial disponible para este envío.\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<div className=\"relative\">\r\n\t\t\t\t\t\t\t\t{/* Línea de tiempo */}\r\n\t\t\t\t\t\t\t\t<div className=\"absolute left-9 top-0 bottom-0 w-0.5 bg-gray-200\"></div>\r\n\r\n\t\t\t\t\t\t\t\t{/* Eventos */}\r\n\t\t\t\t\t\t\t\t<ul className=\"space-y-6\">\r\n\t\t\t\t\t\t\t\t\t{shippingHistory.map((event, index) => (\r\n\t\t\t\t\t\t\t\t\t\t<li key={index} className=\"relative\">\r\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-start\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-center h-9 w-9 rounded-full bg-white border-2 border-primary-500 z-10\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{getStatusIcon(event.status)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"ml-4\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<h3 className=\"text-md font-medium text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{getStatusText(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tevent.status as ShippingItem[\"status\"]\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"ml-2 text-sm text-gray-500 flex items-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Calendar size={14} className=\"mr-1\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatDate(event.date)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"mt-1 text-sm text-gray-600\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{event.description}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{event.location && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"mt-1 text-xs text-gray-500 flex items-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<MapPin size={12} className=\"mr-1\" />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{event.location}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Mapa de ruta (opcional) */}\r\n\t\t\t\t\t{shippingRoute.length > 0 && (\r\n\t\t\t\t\t\t<div className=\"bg-white rounded-lg shadow p-6\">\r\n\t\t\t\t\t\t\t<h2 className=\"text-lg font-medium text-gray-900 mb-4\">\r\n\t\t\t\t\t\t\t\tRuta de envío\r\n\t\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t\t\t<div className=\"h-64 bg-gray-100 rounded-lg overflow-hidden flex items-center justify-center\">\r\n\t\t\t\t\t\t\t\t{/* Aquí iría el componente de mapa */}\r\n\t\t\t\t\t\t\t\t<div className=\"text-center\">\r\n\t\t\t\t\t\t\t\t\t<MapPin size={32} className=\"mx-auto mb-2 text-primary-500\" />\r\n\t\t\t\t\t\t\t\t\t<p className=\"text-gray-600\">\r\n\t\t\t\t\t\t\t\t\t\tMapa de seguimiento disponible\r\n\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-gray-500 mt-1\">\r\n\t\t\t\t\t\t\t\t\t\t{shippingRoute.length} puntos de seguimiento disponibles\r\n\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{/* Lista de ubicaciones */}\r\n\t\t\t\t\t\t\t<div className=\"mt-4\">\r\n\t\t\t\t\t\t\t\t<h3 className=\"text-md font-medium text-gray-900 mb-2\">\r\n\t\t\t\t\t\t\t\t\tPuntos de seguimiento:\r\n\t\t\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t\t\t<ul className=\"space-y-2\">\r\n\t\t\t\t\t\t\t\t\t{shippingRoute.map((point, index) => (\r\n\t\t\t\t\t\t\t\t\t\t<li key={index} className=\"flex items-start\">\r\n\t\t\t\t\t\t\t\t\t\t\t<MapPin\r\n\t\t\t\t\t\t\t\t\t\t\t\tsize={16}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"mt-0.5 mr-2 text-primary-500\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm font-medium text-gray-900\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{point.location}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"ml-2 text-xs text-gray-500\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{new Date(point.date).toLocaleDateString(\"es-ES\")}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-gray-600\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{getStatusText(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tpoint.status as ShippingItem[\"status\"]\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default SellerShippingDetailsPage;\r\n"],"names":["SellerShippingDetailsPage","id","useParams","navigate","useNavigate","shipping","setShipping","useState","shippingHistory","setShippingHistory","shippingRoute","setShippingRoute","loading","setLoading","error","setError","isUpdating","setIsUpdating","updateSuccess","setUpdateSuccess","updateMessage","setUpdateMessage","shippingAdapter","ShippingServiceAdapter","useEffect","fetchShippingDetails","shipment","history","route","routeError","historyError","getStatusText","err","updateShippingStatus","newStatus","prev","newHistoryEntry","prevHistory","printShippingLabel","status","getStatusClass","getStatusIcon","jsx","Package","Truck","PackageCheck","AlertTriangle","MapPin","Clock","formatDate","dateString","jsxs","X","ArrowLeft","Check","Printer","RefreshCw","e","ExternalLink","Link","event","index","Calendar","point"],"mappings":"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"}