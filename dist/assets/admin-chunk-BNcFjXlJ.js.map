{"version":3,"file":"admin-chunk-BNcFjXlJ.js","sources":["../../src/config/environment.ts","../../src/config/appConfig.ts","../../node_modules/axios/lib/helpers/bind.js","../../node_modules/axios/lib/utils.js","../../node_modules/axios/lib/core/AxiosError.js","../../node_modules/axios/lib/helpers/null.js","../../node_modules/axios/lib/helpers/toFormData.js","../../node_modules/axios/lib/helpers/AxiosURLSearchParams.js","../../node_modules/axios/lib/helpers/buildURL.js","../../node_modules/axios/lib/core/InterceptorManager.js","../../node_modules/axios/lib/defaults/transitional.js","../../node_modules/axios/lib/platform/browser/classes/URLSearchParams.js","../../node_modules/axios/lib/platform/browser/classes/FormData.js","../../node_modules/axios/lib/platform/browser/classes/Blob.js","../../node_modules/axios/lib/platform/browser/index.js","../../node_modules/axios/lib/platform/common/utils.js","../../node_modules/axios/lib/platform/index.js","../../node_modules/axios/lib/helpers/toURLEncodedForm.js","../../node_modules/axios/lib/helpers/formDataToJSON.js","../../node_modules/axios/lib/defaults/index.js","../../node_modules/axios/lib/helpers/parseHeaders.js","../../node_modules/axios/lib/core/AxiosHeaders.js","../../node_modules/axios/lib/core/transformData.js","../../node_modules/axios/lib/cancel/isCancel.js","../../node_modules/axios/lib/cancel/CanceledError.js","../../node_modules/axios/lib/core/settle.js","../../node_modules/axios/lib/helpers/parseProtocol.js","../../node_modules/axios/lib/helpers/speedometer.js","../../node_modules/axios/lib/helpers/throttle.js","../../node_modules/axios/lib/helpers/progressEventReducer.js","../../node_modules/axios/lib/helpers/isURLSameOrigin.js","../../node_modules/axios/lib/helpers/cookies.js","../../node_modules/axios/lib/helpers/isAbsoluteURL.js","../../node_modules/axios/lib/helpers/combineURLs.js","../../node_modules/axios/lib/core/buildFullPath.js","../../node_modules/axios/lib/core/mergeConfig.js","../../node_modules/axios/lib/helpers/resolveConfig.js","../../node_modules/axios/lib/adapters/xhr.js","../../node_modules/axios/lib/helpers/composeSignals.js","../../node_modules/axios/lib/helpers/trackStream.js","../../node_modules/axios/lib/adapters/fetch.js","../../node_modules/axios/lib/adapters/adapters.js","../../node_modules/axios/lib/core/dispatchRequest.js","../../node_modules/axios/lib/env/data.js","../../node_modules/axios/lib/helpers/validator.js","../../node_modules/axios/lib/core/Axios.js","../../node_modules/axios/lib/cancel/CancelToken.js","../../node_modules/axios/lib/helpers/spread.js","../../node_modules/axios/lib/helpers/isAxiosError.js","../../node_modules/axios/lib/helpers/HttpStatusCode.js","../../node_modules/axios/lib/axios.js","../../node_modules/axios/index.js","../../src/infrastructure/api/axiosConfig.ts","../../src/infrastructure/services/CacheService.ts","../../src/constants/apiEndpoints.ts","../../src/infrastructure/api/apiClient.ts","../../src/core/services/ConfigurationManager.ts","../../src/utils/formatters/formatCurrency.ts","../../src/utils/imageManager.ts","../../src/utils/errorHandler.ts","../../src/presentation/hooks/useReactiveCache.ts","../../src/presentation/components/dashboard/DashboardPagination.tsx","../../src/presentation/components/dashboard/Table.tsx","../../src/presentation/components/dashboard/DashboardCard.tsx","../../src/presentation/components/dashboard/DashboardCardList.tsx","../../src/presentation/components/dashboard/PendingCard.tsx","../../src/presentation/components/dashboard/PendingCardList.tsx","../../src/presentation/components/dashboard/dataTable/EmptyState.tsx","../../src/presentation/components/dashboard/dataTable/TableHeader.tsx","../../src/presentation/components/dashboard/dataTable/StandardTable.tsx","../../src/presentation/components/dashboard/dataTable/CompactTable.tsx","../../src/presentation/components/dashboard/dataTable/DataTable.tsx","../../src/presentation/components/dashboard/AlertCard.tsx","../../src/presentation/components/dashboard/AlertCardList.tsx","../../src/presentation/components/dashboard/OrdersSimpleTable.tsx","../../src/presentation/components/dashboard/SellersSimpleTable.tsx","../../src/infrastructure/services/AdminDashboardService.ts","../../src/presentation/hooks/useAdminDashboard.ts","../../src/presentation/pages/admin/AdminDashboard.tsx","../../src/core/services/AdminUserService.ts","../../src/presentation/hooks/useAdminUsers.ts","../../src/presentation/pages/admin/AdminUsersPage.tsx","../../src/core/services/AdminProductService.ts","../../src/core/useCases/admin/product/GetAllProductsUseCase.ts","../../src/core/useCases/admin/product/CreateProductAsAdminUseCase.ts","../../src/core/useCases/admin/product/UpdateAnyProductUseCase.ts","../../src/core/useCases/admin/product/DeleteAnyProductUseCase.ts","../../src/core/useCases/admin/product/ToggleProductFeaturedUseCase.ts","../../src/core/useCases/admin/product/ToggleProductPublishedUseCase.ts","../../src/core/useCases/admin/product/UpdateProductStatusUseCase.ts","../../src/core/useCases/admin/product/GetProductsBySellerUseCase.ts","../../src/core/useCases/admin/product/GetProductStatsUseCase.ts","../../src/presentation/hooks/useAdminProducts.ts","../../src/core/services/AdminCategoryService.ts","../../src/core/useCases/admin/category/GetAllCategoriesUseCase.ts","../../src/core/useCases/admin/category/CreateCategoryAsAdminUseCase.ts","../../src/core/useCases/admin/category/UpdateAnyCategoryUseCase.ts","../../src/core/useCases/admin/category/DeleteAnyCategoryUseCase.ts","../../src/core/useCases/admin/category/ToggleCategoryActiveUseCase.ts","../../src/core/useCases/admin/category/ToggleCategoryFeaturedUseCase.ts","../../src/core/useCases/admin/category/GetCategoryByIdUseCase.ts","../../src/presentation/hooks/useAdminCategories.ts","../../src/presentation/pages/admin/AdminProductsPage.tsx","../../src/presentation/pages/admin/AdminCategoriesPage.tsx","../../src/core/services/AdminOrderService.ts","../../src/core/adapters/AdminOrderServiceAdapter.ts","../../src/presentation/pages/admin/AdminOrdersPage.tsx","../../src/core/services/ConfigurationService.ts","../../src/presentation/components/admin/SecurityConfiguration.tsx","../../src/presentation/components/admin/ModerationConfiguration.tsx","../../src/presentation/components/admin/RatingConfiguration.tsx","../../src/presentation/components/admin/VolumeDiscountManager.tsx","../../src/presentation/components/admin/ShippingConfiguration.tsx","../../src/presentation/components/admin/DevelopmentConfiguration.tsx","../../src/presentation/components/admin/FinancialConfiguration.tsx","../../src/presentation/pages/admin/AdminSettingsPage.tsx"],"sourcesContent":["const environments = {\r\n\tdevelopment: {\r\n\t\tapiBaseUrl: \"http://127.0.0.1:8000/api\",\r\n\t\timageBaseUrl: \"http://127.0.0.1:8000/storage/\",\r\n\t\tdebug: true,\r\n\t},\r\n\tstaging: {\r\n\t\tapiBaseUrl: \"https://api.comersia.app/api\",\r\n\t\timageBaseUrl: \"https://api.comersia.app/storage/\",\r\n\t\tdebug: true,\r\n\t},\r\n\tproduction: {\r\n\t\tapiBaseUrl: \"https://api.comersia.app/api\",\r\n\t\timageBaseUrl: \"https://api.comersia.app/storage/\",\r\n\t\tdebug: false,\r\n\t},\r\n};\r\n\r\n// Get current environment from build process or default to development\r\nconst currentEnv = import.meta.env.VITE_APP_ENV || 'development';\r\n\r\n// Export the environment configuration\r\nexport const environment = environments[currentEnv as keyof typeof environments];\r\n\r\nexport default environment;","/**\r\n * Ajustes de configuración\r\n */\r\nimport {environment} from './environment';\r\n\r\n// App configuration\r\nconst appConfig = {\r\n  appName: 'Comersia',\r\n  api: {\r\n    baseUrl: environment.apiBaseUrl,\r\n    timeout: 15000, // 15 segundos de espera maxima\r\n    retryAttempts: 1,\r\n  },\r\n  imageBaseUrl: environment.imageBaseUrl,\r\n  pagination: {\r\n    defaultPageSize: 12,\r\n    pageSizes: [12, 24, 48, 96]\r\n  },\r\n  cache: {\r\n    productCacheTime: 1000 * 60 * 15, // 15 minutos\r\n    categoryCacheTime: 1000 * 60 * 60, // 1 hora\r\n  },\r\n  storage: {\r\n    authTokenKey: 'auth_token',\r\n    refreshTokenKey: 'refresh_token',\r\n    cartKey: 'shopping_cart',\r\n    userKey: 'user_data',\r\n    themeKey: 'user_theme',\r\n    languageKey: 'app_language' //Futuro\r\n  },\r\n  routes: {\r\n    home: '/',\r\n    login: '/login',\r\n    register: '/register',\r\n    products: '/products',\r\n    productDetails: (id: string | number) => `/products/${id}`,\r\n    cart: '/cart',\r\n    checkout: '/checkout',\r\n    dashboard: '/dashboard',\r\n    notFound: '/404',\r\n    categories: '/categories',\r\n    contact: '/contact',\r\n    faq: '/faq',\r\n    favorites: '/favorites',\r\n  },\r\n  // Límites de carga de archivos (en bytes)\r\n  fileUpload: {\r\n    maxImageSize: 2097152, // 2MB (debe coincidir con backend)\r\n    allowedImageTypes: ['image/jpeg', 'image/png', 'image/webp'],\r\n    maxProductImages: 5\r\n  },\r\n  // Configuración de validación\r\n  validation: {\r\n    minPasswordLength: 8,\r\n    maxProductNameLength: 100,\r\n    maxDescriptionLength: 5000\r\n  },\r\n};\r\n\r\nexport default appConfig;","'use strict';\n\nexport default function bind(fn, thisArg) {\n  return function wrap() {\n    return fn.apply(thisArg, arguments);\n  };\n}\n","'use strict';\n\nimport bind from './helpers/bind.js';\n\n// utils is a library of generic helper functions non-specific to axios\n\nconst {toString} = Object.prototype;\nconst {getPrototypeOf} = Object;\nconst {iterator, toStringTag} = Symbol;\n\nconst kindOf = (cache => thing => {\n    const str = toString.call(thing);\n    return cache[str] || (cache[str] = str.slice(8, -1).toLowerCase());\n})(Object.create(null));\n\nconst kindOfTest = (type) => {\n  type = type.toLowerCase();\n  return (thing) => kindOf(thing) === type\n}\n\nconst typeOfTest = type => thing => typeof thing === type;\n\n/**\n * Determine if a value is an Array\n *\n * @param {Object} val The value to test\n *\n * @returns {boolean} True if value is an Array, otherwise false\n */\nconst {isArray} = Array;\n\n/**\n * Determine if a value is undefined\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if the value is undefined, otherwise false\n */\nconst isUndefined = typeOfTest('undefined');\n\n/**\n * Determine if a value is a Buffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Buffer, otherwise false\n */\nfunction isBuffer(val) {\n  return val !== null && !isUndefined(val) && val.constructor !== null && !isUndefined(val.constructor)\n    && isFunction(val.constructor.isBuffer) && val.constructor.isBuffer(val);\n}\n\n/**\n * Determine if a value is an ArrayBuffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is an ArrayBuffer, otherwise false\n */\nconst isArrayBuffer = kindOfTest('ArrayBuffer');\n\n\n/**\n * Determine if a value is a view on an ArrayBuffer\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a view on an ArrayBuffer, otherwise false\n */\nfunction isArrayBufferView(val) {\n  let result;\n  if ((typeof ArrayBuffer !== 'undefined') && (ArrayBuffer.isView)) {\n    result = ArrayBuffer.isView(val);\n  } else {\n    result = (val) && (val.buffer) && (isArrayBuffer(val.buffer));\n  }\n  return result;\n}\n\n/**\n * Determine if a value is a String\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a String, otherwise false\n */\nconst isString = typeOfTest('string');\n\n/**\n * Determine if a value is a Function\n *\n * @param {*} val The value to test\n * @returns {boolean} True if value is a Function, otherwise false\n */\nconst isFunction = typeOfTest('function');\n\n/**\n * Determine if a value is a Number\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Number, otherwise false\n */\nconst isNumber = typeOfTest('number');\n\n/**\n * Determine if a value is an Object\n *\n * @param {*} thing The value to test\n *\n * @returns {boolean} True if value is an Object, otherwise false\n */\nconst isObject = (thing) => thing !== null && typeof thing === 'object';\n\n/**\n * Determine if a value is a Boolean\n *\n * @param {*} thing The value to test\n * @returns {boolean} True if value is a Boolean, otherwise false\n */\nconst isBoolean = thing => thing === true || thing === false;\n\n/**\n * Determine if a value is a plain Object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a plain Object, otherwise false\n */\nconst isPlainObject = (val) => {\n  if (kindOf(val) !== 'object') {\n    return false;\n  }\n\n  const prototype = getPrototypeOf(val);\n  return (prototype === null || prototype === Object.prototype || Object.getPrototypeOf(prototype) === null) && !(toStringTag in val) && !(iterator in val);\n}\n\n/**\n * Determine if a value is a Date\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Date, otherwise false\n */\nconst isDate = kindOfTest('Date');\n\n/**\n * Determine if a value is a File\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a File, otherwise false\n */\nconst isFile = kindOfTest('File');\n\n/**\n * Determine if a value is a Blob\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Blob, otherwise false\n */\nconst isBlob = kindOfTest('Blob');\n\n/**\n * Determine if a value is a FileList\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a File, otherwise false\n */\nconst isFileList = kindOfTest('FileList');\n\n/**\n * Determine if a value is a Stream\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a Stream, otherwise false\n */\nconst isStream = (val) => isObject(val) && isFunction(val.pipe);\n\n/**\n * Determine if a value is a FormData\n *\n * @param {*} thing The value to test\n *\n * @returns {boolean} True if value is an FormData, otherwise false\n */\nconst isFormData = (thing) => {\n  let kind;\n  return thing && (\n    (typeof FormData === 'function' && thing instanceof FormData) || (\n      isFunction(thing.append) && (\n        (kind = kindOf(thing)) === 'formdata' ||\n        // detect form-data instance\n        (kind === 'object' && isFunction(thing.toString) && thing.toString() === '[object FormData]')\n      )\n    )\n  )\n}\n\n/**\n * Determine if a value is a URLSearchParams object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a URLSearchParams object, otherwise false\n */\nconst isURLSearchParams = kindOfTest('URLSearchParams');\n\nconst [isReadableStream, isRequest, isResponse, isHeaders] = ['ReadableStream', 'Request', 'Response', 'Headers'].map(kindOfTest);\n\n/**\n * Trim excess whitespace off the beginning and end of a string\n *\n * @param {String} str The String to trim\n *\n * @returns {String} The String freed of excess whitespace\n */\nconst trim = (str) => str.trim ?\n  str.trim() : str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, '');\n\n/**\n * Iterate over an Array or an Object invoking a function for each item.\n *\n * If `obj` is an Array callback will be called passing\n * the value, index, and complete array for each item.\n *\n * If 'obj' is an Object callback will be called passing\n * the value, key, and complete object for each property.\n *\n * @param {Object|Array} obj The object to iterate\n * @param {Function} fn The callback to invoke for each item\n *\n * @param {Boolean} [allOwnKeys = false]\n * @returns {any}\n */\nfunction forEach(obj, fn, {allOwnKeys = false} = {}) {\n  // Don't bother if no value provided\n  if (obj === null || typeof obj === 'undefined') {\n    return;\n  }\n\n  let i;\n  let l;\n\n  // Force an array if not already something iterable\n  if (typeof obj !== 'object') {\n    /*eslint no-param-reassign:0*/\n    obj = [obj];\n  }\n\n  if (isArray(obj)) {\n    // Iterate over array values\n    for (i = 0, l = obj.length; i < l; i++) {\n      fn.call(null, obj[i], i, obj);\n    }\n  } else {\n    // Iterate over object keys\n    const keys = allOwnKeys ? Object.getOwnPropertyNames(obj) : Object.keys(obj);\n    const len = keys.length;\n    let key;\n\n    for (i = 0; i < len; i++) {\n      key = keys[i];\n      fn.call(null, obj[key], key, obj);\n    }\n  }\n}\n\nfunction findKey(obj, key) {\n  key = key.toLowerCase();\n  const keys = Object.keys(obj);\n  let i = keys.length;\n  let _key;\n  while (i-- > 0) {\n    _key = keys[i];\n    if (key === _key.toLowerCase()) {\n      return _key;\n    }\n  }\n  return null;\n}\n\nconst _global = (() => {\n  /*eslint no-undef:0*/\n  if (typeof globalThis !== \"undefined\") return globalThis;\n  return typeof self !== \"undefined\" ? self : (typeof window !== 'undefined' ? window : global)\n})();\n\nconst isContextDefined = (context) => !isUndefined(context) && context !== _global;\n\n/**\n * Accepts varargs expecting each argument to be an object, then\n * immutably merges the properties of each object and returns result.\n *\n * When multiple objects contain the same key the later object in\n * the arguments list will take precedence.\n *\n * Example:\n *\n * ```js\n * var result = merge({foo: 123}, {foo: 456});\n * console.log(result.foo); // outputs 456\n * ```\n *\n * @param {Object} obj1 Object to merge\n *\n * @returns {Object} Result of all merge properties\n */\nfunction merge(/* obj1, obj2, obj3, ... */) {\n  const {caseless} = isContextDefined(this) && this || {};\n  const result = {};\n  const assignValue = (val, key) => {\n    const targetKey = caseless && findKey(result, key) || key;\n    if (isPlainObject(result[targetKey]) && isPlainObject(val)) {\n      result[targetKey] = merge(result[targetKey], val);\n    } else if (isPlainObject(val)) {\n      result[targetKey] = merge({}, val);\n    } else if (isArray(val)) {\n      result[targetKey] = val.slice();\n    } else {\n      result[targetKey] = val;\n    }\n  }\n\n  for (let i = 0, l = arguments.length; i < l; i++) {\n    arguments[i] && forEach(arguments[i], assignValue);\n  }\n  return result;\n}\n\n/**\n * Extends object a by mutably adding to it the properties of object b.\n *\n * @param {Object} a The object to be extended\n * @param {Object} b The object to copy properties from\n * @param {Object} thisArg The object to bind function to\n *\n * @param {Boolean} [allOwnKeys]\n * @returns {Object} The resulting value of object a\n */\nconst extend = (a, b, thisArg, {allOwnKeys}= {}) => {\n  forEach(b, (val, key) => {\n    if (thisArg && isFunction(val)) {\n      a[key] = bind(val, thisArg);\n    } else {\n      a[key] = val;\n    }\n  }, {allOwnKeys});\n  return a;\n}\n\n/**\n * Remove byte order marker. This catches EF BB BF (the UTF-8 BOM)\n *\n * @param {string} content with BOM\n *\n * @returns {string} content value without BOM\n */\nconst stripBOM = (content) => {\n  if (content.charCodeAt(0) === 0xFEFF) {\n    content = content.slice(1);\n  }\n  return content;\n}\n\n/**\n * Inherit the prototype methods from one constructor into another\n * @param {function} constructor\n * @param {function} superConstructor\n * @param {object} [props]\n * @param {object} [descriptors]\n *\n * @returns {void}\n */\nconst inherits = (constructor, superConstructor, props, descriptors) => {\n  constructor.prototype = Object.create(superConstructor.prototype, descriptors);\n  constructor.prototype.constructor = constructor;\n  Object.defineProperty(constructor, 'super', {\n    value: superConstructor.prototype\n  });\n  props && Object.assign(constructor.prototype, props);\n}\n\n/**\n * Resolve object with deep prototype chain to a flat object\n * @param {Object} sourceObj source object\n * @param {Object} [destObj]\n * @param {Function|Boolean} [filter]\n * @param {Function} [propFilter]\n *\n * @returns {Object}\n */\nconst toFlatObject = (sourceObj, destObj, filter, propFilter) => {\n  let props;\n  let i;\n  let prop;\n  const merged = {};\n\n  destObj = destObj || {};\n  // eslint-disable-next-line no-eq-null,eqeqeq\n  if (sourceObj == null) return destObj;\n\n  do {\n    props = Object.getOwnPropertyNames(sourceObj);\n    i = props.length;\n    while (i-- > 0) {\n      prop = props[i];\n      if ((!propFilter || propFilter(prop, sourceObj, destObj)) && !merged[prop]) {\n        destObj[prop] = sourceObj[prop];\n        merged[prop] = true;\n      }\n    }\n    sourceObj = filter !== false && getPrototypeOf(sourceObj);\n  } while (sourceObj && (!filter || filter(sourceObj, destObj)) && sourceObj !== Object.prototype);\n\n  return destObj;\n}\n\n/**\n * Determines whether a string ends with the characters of a specified string\n *\n * @param {String} str\n * @param {String} searchString\n * @param {Number} [position= 0]\n *\n * @returns {boolean}\n */\nconst endsWith = (str, searchString, position) => {\n  str = String(str);\n  if (position === undefined || position > str.length) {\n    position = str.length;\n  }\n  position -= searchString.length;\n  const lastIndex = str.indexOf(searchString, position);\n  return lastIndex !== -1 && lastIndex === position;\n}\n\n\n/**\n * Returns new array from array like object or null if failed\n *\n * @param {*} [thing]\n *\n * @returns {?Array}\n */\nconst toArray = (thing) => {\n  if (!thing) return null;\n  if (isArray(thing)) return thing;\n  let i = thing.length;\n  if (!isNumber(i)) return null;\n  const arr = new Array(i);\n  while (i-- > 0) {\n    arr[i] = thing[i];\n  }\n  return arr;\n}\n\n/**\n * Checking if the Uint8Array exists and if it does, it returns a function that checks if the\n * thing passed in is an instance of Uint8Array\n *\n * @param {TypedArray}\n *\n * @returns {Array}\n */\n// eslint-disable-next-line func-names\nconst isTypedArray = (TypedArray => {\n  // eslint-disable-next-line func-names\n  return thing => {\n    return TypedArray && thing instanceof TypedArray;\n  };\n})(typeof Uint8Array !== 'undefined' && getPrototypeOf(Uint8Array));\n\n/**\n * For each entry in the object, call the function with the key and value.\n *\n * @param {Object<any, any>} obj - The object to iterate over.\n * @param {Function} fn - The function to call for each entry.\n *\n * @returns {void}\n */\nconst forEachEntry = (obj, fn) => {\n  const generator = obj && obj[iterator];\n\n  const _iterator = generator.call(obj);\n\n  let result;\n\n  while ((result = _iterator.next()) && !result.done) {\n    const pair = result.value;\n    fn.call(obj, pair[0], pair[1]);\n  }\n}\n\n/**\n * It takes a regular expression and a string, and returns an array of all the matches\n *\n * @param {string} regExp - The regular expression to match against.\n * @param {string} str - The string to search.\n *\n * @returns {Array<boolean>}\n */\nconst matchAll = (regExp, str) => {\n  let matches;\n  const arr = [];\n\n  while ((matches = regExp.exec(str)) !== null) {\n    arr.push(matches);\n  }\n\n  return arr;\n}\n\n/* Checking if the kindOfTest function returns true when passed an HTMLFormElement. */\nconst isHTMLForm = kindOfTest('HTMLFormElement');\n\nconst toCamelCase = str => {\n  return str.toLowerCase().replace(/[-_\\s]([a-z\\d])(\\w*)/g,\n    function replacer(m, p1, p2) {\n      return p1.toUpperCase() + p2;\n    }\n  );\n};\n\n/* Creating a function that will check if an object has a property. */\nconst hasOwnProperty = (({hasOwnProperty}) => (obj, prop) => hasOwnProperty.call(obj, prop))(Object.prototype);\n\n/**\n * Determine if a value is a RegExp object\n *\n * @param {*} val The value to test\n *\n * @returns {boolean} True if value is a RegExp object, otherwise false\n */\nconst isRegExp = kindOfTest('RegExp');\n\nconst reduceDescriptors = (obj, reducer) => {\n  const descriptors = Object.getOwnPropertyDescriptors(obj);\n  const reducedDescriptors = {};\n\n  forEach(descriptors, (descriptor, name) => {\n    let ret;\n    if ((ret = reducer(descriptor, name, obj)) !== false) {\n      reducedDescriptors[name] = ret || descriptor;\n    }\n  });\n\n  Object.defineProperties(obj, reducedDescriptors);\n}\n\n/**\n * Makes all methods read-only\n * @param {Object} obj\n */\n\nconst freezeMethods = (obj) => {\n  reduceDescriptors(obj, (descriptor, name) => {\n    // skip restricted props in strict mode\n    if (isFunction(obj) && ['arguments', 'caller', 'callee'].indexOf(name) !== -1) {\n      return false;\n    }\n\n    const value = obj[name];\n\n    if (!isFunction(value)) return;\n\n    descriptor.enumerable = false;\n\n    if ('writable' in descriptor) {\n      descriptor.writable = false;\n      return;\n    }\n\n    if (!descriptor.set) {\n      descriptor.set = () => {\n        throw Error('Can not rewrite read-only method \\'' + name + '\\'');\n      };\n    }\n  });\n}\n\nconst toObjectSet = (arrayOrString, delimiter) => {\n  const obj = {};\n\n  const define = (arr) => {\n    arr.forEach(value => {\n      obj[value] = true;\n    });\n  }\n\n  isArray(arrayOrString) ? define(arrayOrString) : define(String(arrayOrString).split(delimiter));\n\n  return obj;\n}\n\nconst noop = () => {}\n\nconst toFiniteNumber = (value, defaultValue) => {\n  return value != null && Number.isFinite(value = +value) ? value : defaultValue;\n}\n\n/**\n * If the thing is a FormData object, return true, otherwise return false.\n *\n * @param {unknown} thing - The thing to check.\n *\n * @returns {boolean}\n */\nfunction isSpecCompliantForm(thing) {\n  return !!(thing && isFunction(thing.append) && thing[toStringTag] === 'FormData' && thing[iterator]);\n}\n\nconst toJSONObject = (obj) => {\n  const stack = new Array(10);\n\n  const visit = (source, i) => {\n\n    if (isObject(source)) {\n      if (stack.indexOf(source) >= 0) {\n        return;\n      }\n\n      if(!('toJSON' in source)) {\n        stack[i] = source;\n        const target = isArray(source) ? [] : {};\n\n        forEach(source, (value, key) => {\n          const reducedValue = visit(value, i + 1);\n          !isUndefined(reducedValue) && (target[key] = reducedValue);\n        });\n\n        stack[i] = undefined;\n\n        return target;\n      }\n    }\n\n    return source;\n  }\n\n  return visit(obj, 0);\n}\n\nconst isAsyncFn = kindOfTest('AsyncFunction');\n\nconst isThenable = (thing) =>\n  thing && (isObject(thing) || isFunction(thing)) && isFunction(thing.then) && isFunction(thing.catch);\n\n// original code\n// https://github.com/DigitalBrainJS/AxiosPromise/blob/16deab13710ec09779922131f3fa5954320f83ab/lib/utils.js#L11-L34\n\nconst _setImmediate = ((setImmediateSupported, postMessageSupported) => {\n  if (setImmediateSupported) {\n    return setImmediate;\n  }\n\n  return postMessageSupported ? ((token, callbacks) => {\n    _global.addEventListener(\"message\", ({source, data}) => {\n      if (source === _global && data === token) {\n        callbacks.length && callbacks.shift()();\n      }\n    }, false);\n\n    return (cb) => {\n      callbacks.push(cb);\n      _global.postMessage(token, \"*\");\n    }\n  })(`axios@${Math.random()}`, []) : (cb) => setTimeout(cb);\n})(\n  typeof setImmediate === 'function',\n  isFunction(_global.postMessage)\n);\n\nconst asap = typeof queueMicrotask !== 'undefined' ?\n  queueMicrotask.bind(_global) : ( typeof process !== 'undefined' && process.nextTick || _setImmediate);\n\n// *********************\n\n\nconst isIterable = (thing) => thing != null && isFunction(thing[iterator]);\n\n\nexport default {\n  isArray,\n  isArrayBuffer,\n  isBuffer,\n  isFormData,\n  isArrayBufferView,\n  isString,\n  isNumber,\n  isBoolean,\n  isObject,\n  isPlainObject,\n  isReadableStream,\n  isRequest,\n  isResponse,\n  isHeaders,\n  isUndefined,\n  isDate,\n  isFile,\n  isBlob,\n  isRegExp,\n  isFunction,\n  isStream,\n  isURLSearchParams,\n  isTypedArray,\n  isFileList,\n  forEach,\n  merge,\n  extend,\n  trim,\n  stripBOM,\n  inherits,\n  toFlatObject,\n  kindOf,\n  kindOfTest,\n  endsWith,\n  toArray,\n  forEachEntry,\n  matchAll,\n  isHTMLForm,\n  hasOwnProperty,\n  hasOwnProp: hasOwnProperty, // an alias to avoid ESLint no-prototype-builtins detection\n  reduceDescriptors,\n  freezeMethods,\n  toObjectSet,\n  toCamelCase,\n  noop,\n  toFiniteNumber,\n  findKey,\n  global: _global,\n  isContextDefined,\n  isSpecCompliantForm,\n  toJSONObject,\n  isAsyncFn,\n  isThenable,\n  setImmediate: _setImmediate,\n  asap,\n  isIterable\n};\n","'use strict';\n\nimport utils from '../utils.js';\n\n/**\n * Create an Error with the specified message, config, error code, request and response.\n *\n * @param {string} message The error message.\n * @param {string} [code] The error code (for example, 'ECONNABORTED').\n * @param {Object} [config] The config.\n * @param {Object} [request] The request.\n * @param {Object} [response] The response.\n *\n * @returns {Error} The created error.\n */\nfunction AxiosError(message, code, config, request, response) {\n  Error.call(this);\n\n  if (Error.captureStackTrace) {\n    Error.captureStackTrace(this, this.constructor);\n  } else {\n    this.stack = (new Error()).stack;\n  }\n\n  this.message = message;\n  this.name = 'AxiosError';\n  code && (this.code = code);\n  config && (this.config = config);\n  request && (this.request = request);\n  if (response) {\n    this.response = response;\n    this.status = response.status ? response.status : null;\n  }\n}\n\nutils.inherits(AxiosError, Error, {\n  toJSON: function toJSON() {\n    return {\n      // Standard\n      message: this.message,\n      name: this.name,\n      // Microsoft\n      description: this.description,\n      number: this.number,\n      // Mozilla\n      fileName: this.fileName,\n      lineNumber: this.lineNumber,\n      columnNumber: this.columnNumber,\n      stack: this.stack,\n      // Axios\n      config: utils.toJSONObject(this.config),\n      code: this.code,\n      status: this.status\n    };\n  }\n});\n\nconst prototype = AxiosError.prototype;\nconst descriptors = {};\n\n[\n  'ERR_BAD_OPTION_VALUE',\n  'ERR_BAD_OPTION',\n  'ECONNABORTED',\n  'ETIMEDOUT',\n  'ERR_NETWORK',\n  'ERR_FR_TOO_MANY_REDIRECTS',\n  'ERR_DEPRECATED',\n  'ERR_BAD_RESPONSE',\n  'ERR_BAD_REQUEST',\n  'ERR_CANCELED',\n  'ERR_NOT_SUPPORT',\n  'ERR_INVALID_URL'\n// eslint-disable-next-line func-names\n].forEach(code => {\n  descriptors[code] = {value: code};\n});\n\nObject.defineProperties(AxiosError, descriptors);\nObject.defineProperty(prototype, 'isAxiosError', {value: true});\n\n// eslint-disable-next-line func-names\nAxiosError.from = (error, code, config, request, response, customProps) => {\n  const axiosError = Object.create(prototype);\n\n  utils.toFlatObject(error, axiosError, function filter(obj) {\n    return obj !== Error.prototype;\n  }, prop => {\n    return prop !== 'isAxiosError';\n  });\n\n  AxiosError.call(axiosError, error.message, code, config, request, response);\n\n  axiosError.cause = error;\n\n  axiosError.name = error.name;\n\n  customProps && Object.assign(axiosError, customProps);\n\n  return axiosError;\n};\n\nexport default AxiosError;\n","// eslint-disable-next-line strict\nexport default null;\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosError from '../core/AxiosError.js';\n// temporary hotfix to avoid circular references until AxiosURLSearchParams is refactored\nimport PlatformFormData from '../platform/node/classes/FormData.js';\n\n/**\n * Determines if the given thing is a array or js object.\n *\n * @param {string} thing - The object or array to be visited.\n *\n * @returns {boolean}\n */\nfunction isVisitable(thing) {\n  return utils.isPlainObject(thing) || utils.isArray(thing);\n}\n\n/**\n * It removes the brackets from the end of a string\n *\n * @param {string} key - The key of the parameter.\n *\n * @returns {string} the key without the brackets.\n */\nfunction removeBrackets(key) {\n  return utils.endsWith(key, '[]') ? key.slice(0, -2) : key;\n}\n\n/**\n * It takes a path, a key, and a boolean, and returns a string\n *\n * @param {string} path - The path to the current key.\n * @param {string} key - The key of the current object being iterated over.\n * @param {string} dots - If true, the key will be rendered with dots instead of brackets.\n *\n * @returns {string} The path to the current key.\n */\nfunction renderKey(path, key, dots) {\n  if (!path) return key;\n  return path.concat(key).map(function each(token, i) {\n    // eslint-disable-next-line no-param-reassign\n    token = removeBrackets(token);\n    return !dots && i ? '[' + token + ']' : token;\n  }).join(dots ? '.' : '');\n}\n\n/**\n * If the array is an array and none of its elements are visitable, then it's a flat array.\n *\n * @param {Array<any>} arr - The array to check\n *\n * @returns {boolean}\n */\nfunction isFlatArray(arr) {\n  return utils.isArray(arr) && !arr.some(isVisitable);\n}\n\nconst predicates = utils.toFlatObject(utils, {}, null, function filter(prop) {\n  return /^is[A-Z]/.test(prop);\n});\n\n/**\n * Convert a data object to FormData\n *\n * @param {Object} obj\n * @param {?Object} [formData]\n * @param {?Object} [options]\n * @param {Function} [options.visitor]\n * @param {Boolean} [options.metaTokens = true]\n * @param {Boolean} [options.dots = false]\n * @param {?Boolean} [options.indexes = false]\n *\n * @returns {Object}\n **/\n\n/**\n * It converts an object into a FormData object\n *\n * @param {Object<any, any>} obj - The object to convert to form data.\n * @param {string} formData - The FormData object to append to.\n * @param {Object<string, any>} options\n *\n * @returns\n */\nfunction toFormData(obj, formData, options) {\n  if (!utils.isObject(obj)) {\n    throw new TypeError('target must be an object');\n  }\n\n  // eslint-disable-next-line no-param-reassign\n  formData = formData || new (PlatformFormData || FormData)();\n\n  // eslint-disable-next-line no-param-reassign\n  options = utils.toFlatObject(options, {\n    metaTokens: true,\n    dots: false,\n    indexes: false\n  }, false, function defined(option, source) {\n    // eslint-disable-next-line no-eq-null,eqeqeq\n    return !utils.isUndefined(source[option]);\n  });\n\n  const metaTokens = options.metaTokens;\n  // eslint-disable-next-line no-use-before-define\n  const visitor = options.visitor || defaultVisitor;\n  const dots = options.dots;\n  const indexes = options.indexes;\n  const _Blob = options.Blob || typeof Blob !== 'undefined' && Blob;\n  const useBlob = _Blob && utils.isSpecCompliantForm(formData);\n\n  if (!utils.isFunction(visitor)) {\n    throw new TypeError('visitor must be a function');\n  }\n\n  function convertValue(value) {\n    if (value === null) return '';\n\n    if (utils.isDate(value)) {\n      return value.toISOString();\n    }\n\n    if (!useBlob && utils.isBlob(value)) {\n      throw new AxiosError('Blob is not supported. Use a Buffer instead.');\n    }\n\n    if (utils.isArrayBuffer(value) || utils.isTypedArray(value)) {\n      return useBlob && typeof Blob === 'function' ? new Blob([value]) : Buffer.from(value);\n    }\n\n    return value;\n  }\n\n  /**\n   * Default visitor.\n   *\n   * @param {*} value\n   * @param {String|Number} key\n   * @param {Array<String|Number>} path\n   * @this {FormData}\n   *\n   * @returns {boolean} return true to visit the each prop of the value recursively\n   */\n  function defaultVisitor(value, key, path) {\n    let arr = value;\n\n    if (value && !path && typeof value === 'object') {\n      if (utils.endsWith(key, '{}')) {\n        // eslint-disable-next-line no-param-reassign\n        key = metaTokens ? key : key.slice(0, -2);\n        // eslint-disable-next-line no-param-reassign\n        value = JSON.stringify(value);\n      } else if (\n        (utils.isArray(value) && isFlatArray(value)) ||\n        ((utils.isFileList(value) || utils.endsWith(key, '[]')) && (arr = utils.toArray(value))\n        )) {\n        // eslint-disable-next-line no-param-reassign\n        key = removeBrackets(key);\n\n        arr.forEach(function each(el, index) {\n          !(utils.isUndefined(el) || el === null) && formData.append(\n            // eslint-disable-next-line no-nested-ternary\n            indexes === true ? renderKey([key], index, dots) : (indexes === null ? key : key + '[]'),\n            convertValue(el)\n          );\n        });\n        return false;\n      }\n    }\n\n    if (isVisitable(value)) {\n      return true;\n    }\n\n    formData.append(renderKey(path, key, dots), convertValue(value));\n\n    return false;\n  }\n\n  const stack = [];\n\n  const exposedHelpers = Object.assign(predicates, {\n    defaultVisitor,\n    convertValue,\n    isVisitable\n  });\n\n  function build(value, path) {\n    if (utils.isUndefined(value)) return;\n\n    if (stack.indexOf(value) !== -1) {\n      throw Error('Circular reference detected in ' + path.join('.'));\n    }\n\n    stack.push(value);\n\n    utils.forEach(value, function each(el, key) {\n      const result = !(utils.isUndefined(el) || el === null) && visitor.call(\n        formData, el, utils.isString(key) ? key.trim() : key, path, exposedHelpers\n      );\n\n      if (result === true) {\n        build(el, path ? path.concat(key) : [key]);\n      }\n    });\n\n    stack.pop();\n  }\n\n  if (!utils.isObject(obj)) {\n    throw new TypeError('data must be an object');\n  }\n\n  build(obj);\n\n  return formData;\n}\n\nexport default toFormData;\n","'use strict';\n\nimport toFormData from './toFormData.js';\n\n/**\n * It encodes a string by replacing all characters that are not in the unreserved set with\n * their percent-encoded equivalents\n *\n * @param {string} str - The string to encode.\n *\n * @returns {string} The encoded string.\n */\nfunction encode(str) {\n  const charMap = {\n    '!': '%21',\n    \"'\": '%27',\n    '(': '%28',\n    ')': '%29',\n    '~': '%7E',\n    '%20': '+',\n    '%00': '\\x00'\n  };\n  return encodeURIComponent(str).replace(/[!'()~]|%20|%00/g, function replacer(match) {\n    return charMap[match];\n  });\n}\n\n/**\n * It takes a params object and converts it to a FormData object\n *\n * @param {Object<string, any>} params - The parameters to be converted to a FormData object.\n * @param {Object<string, any>} options - The options object passed to the Axios constructor.\n *\n * @returns {void}\n */\nfunction AxiosURLSearchParams(params, options) {\n  this._pairs = [];\n\n  params && toFormData(params, this, options);\n}\n\nconst prototype = AxiosURLSearchParams.prototype;\n\nprototype.append = function append(name, value) {\n  this._pairs.push([name, value]);\n};\n\nprototype.toString = function toString(encoder) {\n  const _encode = encoder ? function(value) {\n    return encoder.call(this, value, encode);\n  } : encode;\n\n  return this._pairs.map(function each(pair) {\n    return _encode(pair[0]) + '=' + _encode(pair[1]);\n  }, '').join('&');\n};\n\nexport default AxiosURLSearchParams;\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosURLSearchParams from '../helpers/AxiosURLSearchParams.js';\n\n/**\n * It replaces all instances of the characters `:`, `$`, `,`, `+`, `[`, and `]` with their\n * URI encoded counterparts\n *\n * @param {string} val The value to be encoded.\n *\n * @returns {string} The encoded value.\n */\nfunction encode(val) {\n  return encodeURIComponent(val).\n    replace(/%3A/gi, ':').\n    replace(/%24/g, '$').\n    replace(/%2C/gi, ',').\n    replace(/%20/g, '+').\n    replace(/%5B/gi, '[').\n    replace(/%5D/gi, ']');\n}\n\n/**\n * Build a URL by appending params to the end\n *\n * @param {string} url The base of the url (e.g., http://www.google.com)\n * @param {object} [params] The params to be appended\n * @param {?(object|Function)} options\n *\n * @returns {string} The formatted url\n */\nexport default function buildURL(url, params, options) {\n  /*eslint no-param-reassign:0*/\n  if (!params) {\n    return url;\n  }\n  \n  const _encode = options && options.encode || encode;\n\n  if (utils.isFunction(options)) {\n    options = {\n      serialize: options\n    };\n  } \n\n  const serializeFn = options && options.serialize;\n\n  let serializedParams;\n\n  if (serializeFn) {\n    serializedParams = serializeFn(params, options);\n  } else {\n    serializedParams = utils.isURLSearchParams(params) ?\n      params.toString() :\n      new AxiosURLSearchParams(params, options).toString(_encode);\n  }\n\n  if (serializedParams) {\n    const hashmarkIndex = url.indexOf(\"#\");\n\n    if (hashmarkIndex !== -1) {\n      url = url.slice(0, hashmarkIndex);\n    }\n    url += (url.indexOf('?') === -1 ? '?' : '&') + serializedParams;\n  }\n\n  return url;\n}\n","'use strict';\n\nimport utils from './../utils.js';\n\nclass InterceptorManager {\n  constructor() {\n    this.handlers = [];\n  }\n\n  /**\n   * Add a new interceptor to the stack\n   *\n   * @param {Function} fulfilled The function to handle `then` for a `Promise`\n   * @param {Function} rejected The function to handle `reject` for a `Promise`\n   *\n   * @return {Number} An ID used to remove interceptor later\n   */\n  use(fulfilled, rejected, options) {\n    this.handlers.push({\n      fulfilled,\n      rejected,\n      synchronous: options ? options.synchronous : false,\n      runWhen: options ? options.runWhen : null\n    });\n    return this.handlers.length - 1;\n  }\n\n  /**\n   * Remove an interceptor from the stack\n   *\n   * @param {Number} id The ID that was returned by `use`\n   *\n   * @returns {Boolean} `true` if the interceptor was removed, `false` otherwise\n   */\n  eject(id) {\n    if (this.handlers[id]) {\n      this.handlers[id] = null;\n    }\n  }\n\n  /**\n   * Clear all interceptors from the stack\n   *\n   * @returns {void}\n   */\n  clear() {\n    if (this.handlers) {\n      this.handlers = [];\n    }\n  }\n\n  /**\n   * Iterate over all the registered interceptors\n   *\n   * This method is particularly useful for skipping over any\n   * interceptors that may have become `null` calling `eject`.\n   *\n   * @param {Function} fn The function to call for each interceptor\n   *\n   * @returns {void}\n   */\n  forEach(fn) {\n    utils.forEach(this.handlers, function forEachHandler(h) {\n      if (h !== null) {\n        fn(h);\n      }\n    });\n  }\n}\n\nexport default InterceptorManager;\n","'use strict';\n\nexport default {\n  silentJSONParsing: true,\n  forcedJSONParsing: true,\n  clarifyTimeoutError: false\n};\n","'use strict';\n\nimport AxiosURLSearchParams from '../../../helpers/AxiosURLSearchParams.js';\nexport default typeof URLSearchParams !== 'undefined' ? URLSearchParams : AxiosURLSearchParams;\n","'use strict';\n\nexport default typeof FormData !== 'undefined' ? FormData : null;\n","'use strict'\n\nexport default typeof Blob !== 'undefined' ? Blob : null\n","import URLSearchParams from './classes/URLSearchParams.js'\nimport FormData from './classes/FormData.js'\nimport Blob from './classes/Blob.js'\n\nexport default {\n  isBrowser: true,\n  classes: {\n    URLSearchParams,\n    FormData,\n    Blob\n  },\n  protocols: ['http', 'https', 'file', 'blob', 'url', 'data']\n};\n","const hasBrowserEnv = typeof window !== 'undefined' && typeof document !== 'undefined';\n\nconst _navigator = typeof navigator === 'object' && navigator || undefined;\n\n/**\n * Determine if we're running in a standard browser environment\n *\n * This allows axios to run in a web worker, and react-native.\n * Both environments support XMLHttpRequest, but not fully standard globals.\n *\n * web workers:\n *  typeof window -> undefined\n *  typeof document -> undefined\n *\n * react-native:\n *  navigator.product -> 'ReactNative'\n * nativescript\n *  navigator.product -> 'NativeScript' or 'NS'\n *\n * @returns {boolean}\n */\nconst hasStandardBrowserEnv = hasBrowserEnv &&\n  (!_navigator || ['ReactNative', 'NativeScript', 'NS'].indexOf(_navigator.product) < 0);\n\n/**\n * Determine if we're running in a standard browser webWorker environment\n *\n * Although the `isStandardBrowserEnv` method indicates that\n * `allows axios to run in a web worker`, the WebWorker will still be\n * filtered out due to its judgment standard\n * `typeof window !== 'undefined' && typeof document !== 'undefined'`.\n * This leads to a problem when axios post `FormData` in webWorker\n */\nconst hasStandardBrowserWebWorkerEnv = (() => {\n  return (\n    typeof WorkerGlobalScope !== 'undefined' &&\n    // eslint-disable-next-line no-undef\n    self instanceof WorkerGlobalScope &&\n    typeof self.importScripts === 'function'\n  );\n})();\n\nconst origin = hasBrowserEnv && window.location.href || 'http://localhost';\n\nexport {\n  hasBrowserEnv,\n  hasStandardBrowserWebWorkerEnv,\n  hasStandardBrowserEnv,\n  _navigator as navigator,\n  origin\n}\n","import platform from './node/index.js';\nimport * as utils from './common/utils.js';\n\nexport default {\n  ...utils,\n  ...platform\n}\n","'use strict';\n\nimport utils from '../utils.js';\nimport toFormData from './toFormData.js';\nimport platform from '../platform/index.js';\n\nexport default function toURLEncodedForm(data, options) {\n  return toFormData(data, new platform.classes.URLSearchParams(), Object.assign({\n    visitor: function(value, key, path, helpers) {\n      if (platform.isNode && utils.isBuffer(value)) {\n        this.append(key, value.toString('base64'));\n        return false;\n      }\n\n      return helpers.defaultVisitor.apply(this, arguments);\n    }\n  }, options));\n}\n","'use strict';\n\nimport utils from '../utils.js';\n\n/**\n * It takes a string like `foo[x][y][z]` and returns an array like `['foo', 'x', 'y', 'z']\n *\n * @param {string} name - The name of the property to get.\n *\n * @returns An array of strings.\n */\nfunction parsePropPath(name) {\n  // foo[x][y][z]\n  // foo.x.y.z\n  // foo-x-y-z\n  // foo x y z\n  return utils.matchAll(/\\w+|\\[(\\w*)]/g, name).map(match => {\n    return match[0] === '[]' ? '' : match[1] || match[0];\n  });\n}\n\n/**\n * Convert an array to an object.\n *\n * @param {Array<any>} arr - The array to convert to an object.\n *\n * @returns An object with the same keys and values as the array.\n */\nfunction arrayToObject(arr) {\n  const obj = {};\n  const keys = Object.keys(arr);\n  let i;\n  const len = keys.length;\n  let key;\n  for (i = 0; i < len; i++) {\n    key = keys[i];\n    obj[key] = arr[key];\n  }\n  return obj;\n}\n\n/**\n * It takes a FormData object and returns a JavaScript object\n *\n * @param {string} formData The FormData object to convert to JSON.\n *\n * @returns {Object<string, any> | null} The converted object.\n */\nfunction formDataToJSON(formData) {\n  function buildPath(path, value, target, index) {\n    let name = path[index++];\n\n    if (name === '__proto__') return true;\n\n    const isNumericKey = Number.isFinite(+name);\n    const isLast = index >= path.length;\n    name = !name && utils.isArray(target) ? target.length : name;\n\n    if (isLast) {\n      if (utils.hasOwnProp(target, name)) {\n        target[name] = [target[name], value];\n      } else {\n        target[name] = value;\n      }\n\n      return !isNumericKey;\n    }\n\n    if (!target[name] || !utils.isObject(target[name])) {\n      target[name] = [];\n    }\n\n    const result = buildPath(path, value, target[name], index);\n\n    if (result && utils.isArray(target[name])) {\n      target[name] = arrayToObject(target[name]);\n    }\n\n    return !isNumericKey;\n  }\n\n  if (utils.isFormData(formData) && utils.isFunction(formData.entries)) {\n    const obj = {};\n\n    utils.forEachEntry(formData, (name, value) => {\n      buildPath(parsePropPath(name), value, obj, 0);\n    });\n\n    return obj;\n  }\n\n  return null;\n}\n\nexport default formDataToJSON;\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosError from '../core/AxiosError.js';\nimport transitionalDefaults from './transitional.js';\nimport toFormData from '../helpers/toFormData.js';\nimport toURLEncodedForm from '../helpers/toURLEncodedForm.js';\nimport platform from '../platform/index.js';\nimport formDataToJSON from '../helpers/formDataToJSON.js';\n\n/**\n * It takes a string, tries to parse it, and if it fails, it returns the stringified version\n * of the input\n *\n * @param {any} rawValue - The value to be stringified.\n * @param {Function} parser - A function that parses a string into a JavaScript object.\n * @param {Function} encoder - A function that takes a value and returns a string.\n *\n * @returns {string} A stringified version of the rawValue.\n */\nfunction stringifySafely(rawValue, parser, encoder) {\n  if (utils.isString(rawValue)) {\n    try {\n      (parser || JSON.parse)(rawValue);\n      return utils.trim(rawValue);\n    } catch (e) {\n      if (e.name !== 'SyntaxError') {\n        throw e;\n      }\n    }\n  }\n\n  return (encoder || JSON.stringify)(rawValue);\n}\n\nconst defaults = {\n\n  transitional: transitionalDefaults,\n\n  adapter: ['xhr', 'http', 'fetch'],\n\n  transformRequest: [function transformRequest(data, headers) {\n    const contentType = headers.getContentType() || '';\n    const hasJSONContentType = contentType.indexOf('application/json') > -1;\n    const isObjectPayload = utils.isObject(data);\n\n    if (isObjectPayload && utils.isHTMLForm(data)) {\n      data = new FormData(data);\n    }\n\n    const isFormData = utils.isFormData(data);\n\n    if (isFormData) {\n      return hasJSONContentType ? JSON.stringify(formDataToJSON(data)) : data;\n    }\n\n    if (utils.isArrayBuffer(data) ||\n      utils.isBuffer(data) ||\n      utils.isStream(data) ||\n      utils.isFile(data) ||\n      utils.isBlob(data) ||\n      utils.isReadableStream(data)\n    ) {\n      return data;\n    }\n    if (utils.isArrayBufferView(data)) {\n      return data.buffer;\n    }\n    if (utils.isURLSearchParams(data)) {\n      headers.setContentType('application/x-www-form-urlencoded;charset=utf-8', false);\n      return data.toString();\n    }\n\n    let isFileList;\n\n    if (isObjectPayload) {\n      if (contentType.indexOf('application/x-www-form-urlencoded') > -1) {\n        return toURLEncodedForm(data, this.formSerializer).toString();\n      }\n\n      if ((isFileList = utils.isFileList(data)) || contentType.indexOf('multipart/form-data') > -1) {\n        const _FormData = this.env && this.env.FormData;\n\n        return toFormData(\n          isFileList ? {'files[]': data} : data,\n          _FormData && new _FormData(),\n          this.formSerializer\n        );\n      }\n    }\n\n    if (isObjectPayload || hasJSONContentType ) {\n      headers.setContentType('application/json', false);\n      return stringifySafely(data);\n    }\n\n    return data;\n  }],\n\n  transformResponse: [function transformResponse(data) {\n    const transitional = this.transitional || defaults.transitional;\n    const forcedJSONParsing = transitional && transitional.forcedJSONParsing;\n    const JSONRequested = this.responseType === 'json';\n\n    if (utils.isResponse(data) || utils.isReadableStream(data)) {\n      return data;\n    }\n\n    if (data && utils.isString(data) && ((forcedJSONParsing && !this.responseType) || JSONRequested)) {\n      const silentJSONParsing = transitional && transitional.silentJSONParsing;\n      const strictJSONParsing = !silentJSONParsing && JSONRequested;\n\n      try {\n        return JSON.parse(data);\n      } catch (e) {\n        if (strictJSONParsing) {\n          if (e.name === 'SyntaxError') {\n            throw AxiosError.from(e, AxiosError.ERR_BAD_RESPONSE, this, null, this.response);\n          }\n          throw e;\n        }\n      }\n    }\n\n    return data;\n  }],\n\n  /**\n   * A timeout in milliseconds to abort a request. If set to 0 (default) a\n   * timeout is not created.\n   */\n  timeout: 0,\n\n  xsrfCookieName: 'XSRF-TOKEN',\n  xsrfHeaderName: 'X-XSRF-TOKEN',\n\n  maxContentLength: -1,\n  maxBodyLength: -1,\n\n  env: {\n    FormData: platform.classes.FormData,\n    Blob: platform.classes.Blob\n  },\n\n  validateStatus: function validateStatus(status) {\n    return status >= 200 && status < 300;\n  },\n\n  headers: {\n    common: {\n      'Accept': 'application/json, text/plain, */*',\n      'Content-Type': undefined\n    }\n  }\n};\n\nutils.forEach(['delete', 'get', 'head', 'post', 'put', 'patch'], (method) => {\n  defaults.headers[method] = {};\n});\n\nexport default defaults;\n","'use strict';\n\nimport utils from './../utils.js';\n\n// RawAxiosHeaders whose duplicates are ignored by node\n// c.f. https://nodejs.org/api/http.html#http_message_headers\nconst ignoreDuplicateOf = utils.toObjectSet([\n  'age', 'authorization', 'content-length', 'content-type', 'etag',\n  'expires', 'from', 'host', 'if-modified-since', 'if-unmodified-since',\n  'last-modified', 'location', 'max-forwards', 'proxy-authorization',\n  'referer', 'retry-after', 'user-agent'\n]);\n\n/**\n * Parse headers into an object\n *\n * ```\n * Date: Wed, 27 Aug 2014 08:58:49 GMT\n * Content-Type: application/json\n * Connection: keep-alive\n * Transfer-Encoding: chunked\n * ```\n *\n * @param {String} rawHeaders Headers needing to be parsed\n *\n * @returns {Object} Headers parsed into an object\n */\nexport default rawHeaders => {\n  const parsed = {};\n  let key;\n  let val;\n  let i;\n\n  rawHeaders && rawHeaders.split('\\n').forEach(function parser(line) {\n    i = line.indexOf(':');\n    key = line.substring(0, i).trim().toLowerCase();\n    val = line.substring(i + 1).trim();\n\n    if (!key || (parsed[key] && ignoreDuplicateOf[key])) {\n      return;\n    }\n\n    if (key === 'set-cookie') {\n      if (parsed[key]) {\n        parsed[key].push(val);\n      } else {\n        parsed[key] = [val];\n      }\n    } else {\n      parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;\n    }\n  });\n\n  return parsed;\n};\n","'use strict';\n\nimport utils from '../utils.js';\nimport parseHeaders from '../helpers/parseHeaders.js';\n\nconst $internals = Symbol('internals');\n\nfunction normalizeHeader(header) {\n  return header && String(header).trim().toLowerCase();\n}\n\nfunction normalizeValue(value) {\n  if (value === false || value == null) {\n    return value;\n  }\n\n  return utils.isArray(value) ? value.map(normalizeValue) : String(value);\n}\n\nfunction parseTokens(str) {\n  const tokens = Object.create(null);\n  const tokensRE = /([^\\s,;=]+)\\s*(?:=\\s*([^,;]+))?/g;\n  let match;\n\n  while ((match = tokensRE.exec(str))) {\n    tokens[match[1]] = match[2];\n  }\n\n  return tokens;\n}\n\nconst isValidHeaderName = (str) => /^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(str.trim());\n\nfunction matchHeaderValue(context, value, header, filter, isHeaderNameFilter) {\n  if (utils.isFunction(filter)) {\n    return filter.call(this, value, header);\n  }\n\n  if (isHeaderNameFilter) {\n    value = header;\n  }\n\n  if (!utils.isString(value)) return;\n\n  if (utils.isString(filter)) {\n    return value.indexOf(filter) !== -1;\n  }\n\n  if (utils.isRegExp(filter)) {\n    return filter.test(value);\n  }\n}\n\nfunction formatHeader(header) {\n  return header.trim()\n    .toLowerCase().replace(/([a-z\\d])(\\w*)/g, (w, char, str) => {\n      return char.toUpperCase() + str;\n    });\n}\n\nfunction buildAccessors(obj, header) {\n  const accessorName = utils.toCamelCase(' ' + header);\n\n  ['get', 'set', 'has'].forEach(methodName => {\n    Object.defineProperty(obj, methodName + accessorName, {\n      value: function(arg1, arg2, arg3) {\n        return this[methodName].call(this, header, arg1, arg2, arg3);\n      },\n      configurable: true\n    });\n  });\n}\n\nclass AxiosHeaders {\n  constructor(headers) {\n    headers && this.set(headers);\n  }\n\n  set(header, valueOrRewrite, rewrite) {\n    const self = this;\n\n    function setHeader(_value, _header, _rewrite) {\n      const lHeader = normalizeHeader(_header);\n\n      if (!lHeader) {\n        throw new Error('header name must be a non-empty string');\n      }\n\n      const key = utils.findKey(self, lHeader);\n\n      if(!key || self[key] === undefined || _rewrite === true || (_rewrite === undefined && self[key] !== false)) {\n        self[key || _header] = normalizeValue(_value);\n      }\n    }\n\n    const setHeaders = (headers, _rewrite) =>\n      utils.forEach(headers, (_value, _header) => setHeader(_value, _header, _rewrite));\n\n    if (utils.isPlainObject(header) || header instanceof this.constructor) {\n      setHeaders(header, valueOrRewrite)\n    } else if(utils.isString(header) && (header = header.trim()) && !isValidHeaderName(header)) {\n      setHeaders(parseHeaders(header), valueOrRewrite);\n    } else if (utils.isObject(header) && utils.isIterable(header)) {\n      let obj = {}, dest, key;\n      for (const entry of header) {\n        if (!utils.isArray(entry)) {\n          throw TypeError('Object iterator must return a key-value pair');\n        }\n\n        obj[key = entry[0]] = (dest = obj[key]) ?\n          (utils.isArray(dest) ? [...dest, entry[1]] : [dest, entry[1]]) : entry[1];\n      }\n\n      setHeaders(obj, valueOrRewrite)\n    } else {\n      header != null && setHeader(valueOrRewrite, header, rewrite);\n    }\n\n    return this;\n  }\n\n  get(header, parser) {\n    header = normalizeHeader(header);\n\n    if (header) {\n      const key = utils.findKey(this, header);\n\n      if (key) {\n        const value = this[key];\n\n        if (!parser) {\n          return value;\n        }\n\n        if (parser === true) {\n          return parseTokens(value);\n        }\n\n        if (utils.isFunction(parser)) {\n          return parser.call(this, value, key);\n        }\n\n        if (utils.isRegExp(parser)) {\n          return parser.exec(value);\n        }\n\n        throw new TypeError('parser must be boolean|regexp|function');\n      }\n    }\n  }\n\n  has(header, matcher) {\n    header = normalizeHeader(header);\n\n    if (header) {\n      const key = utils.findKey(this, header);\n\n      return !!(key && this[key] !== undefined && (!matcher || matchHeaderValue(this, this[key], key, matcher)));\n    }\n\n    return false;\n  }\n\n  delete(header, matcher) {\n    const self = this;\n    let deleted = false;\n\n    function deleteHeader(_header) {\n      _header = normalizeHeader(_header);\n\n      if (_header) {\n        const key = utils.findKey(self, _header);\n\n        if (key && (!matcher || matchHeaderValue(self, self[key], key, matcher))) {\n          delete self[key];\n\n          deleted = true;\n        }\n      }\n    }\n\n    if (utils.isArray(header)) {\n      header.forEach(deleteHeader);\n    } else {\n      deleteHeader(header);\n    }\n\n    return deleted;\n  }\n\n  clear(matcher) {\n    const keys = Object.keys(this);\n    let i = keys.length;\n    let deleted = false;\n\n    while (i--) {\n      const key = keys[i];\n      if(!matcher || matchHeaderValue(this, this[key], key, matcher, true)) {\n        delete this[key];\n        deleted = true;\n      }\n    }\n\n    return deleted;\n  }\n\n  normalize(format) {\n    const self = this;\n    const headers = {};\n\n    utils.forEach(this, (value, header) => {\n      const key = utils.findKey(headers, header);\n\n      if (key) {\n        self[key] = normalizeValue(value);\n        delete self[header];\n        return;\n      }\n\n      const normalized = format ? formatHeader(header) : String(header).trim();\n\n      if (normalized !== header) {\n        delete self[header];\n      }\n\n      self[normalized] = normalizeValue(value);\n\n      headers[normalized] = true;\n    });\n\n    return this;\n  }\n\n  concat(...targets) {\n    return this.constructor.concat(this, ...targets);\n  }\n\n  toJSON(asStrings) {\n    const obj = Object.create(null);\n\n    utils.forEach(this, (value, header) => {\n      value != null && value !== false && (obj[header] = asStrings && utils.isArray(value) ? value.join(', ') : value);\n    });\n\n    return obj;\n  }\n\n  [Symbol.iterator]() {\n    return Object.entries(this.toJSON())[Symbol.iterator]();\n  }\n\n  toString() {\n    return Object.entries(this.toJSON()).map(([header, value]) => header + ': ' + value).join('\\n');\n  }\n\n  getSetCookie() {\n    return this.get(\"set-cookie\") || [];\n  }\n\n  get [Symbol.toStringTag]() {\n    return 'AxiosHeaders';\n  }\n\n  static from(thing) {\n    return thing instanceof this ? thing : new this(thing);\n  }\n\n  static concat(first, ...targets) {\n    const computed = new this(first);\n\n    targets.forEach((target) => computed.set(target));\n\n    return computed;\n  }\n\n  static accessor(header) {\n    const internals = this[$internals] = (this[$internals] = {\n      accessors: {}\n    });\n\n    const accessors = internals.accessors;\n    const prototype = this.prototype;\n\n    function defineAccessor(_header) {\n      const lHeader = normalizeHeader(_header);\n\n      if (!accessors[lHeader]) {\n        buildAccessors(prototype, _header);\n        accessors[lHeader] = true;\n      }\n    }\n\n    utils.isArray(header) ? header.forEach(defineAccessor) : defineAccessor(header);\n\n    return this;\n  }\n}\n\nAxiosHeaders.accessor(['Content-Type', 'Content-Length', 'Accept', 'Accept-Encoding', 'User-Agent', 'Authorization']);\n\n// reserved names hotfix\nutils.reduceDescriptors(AxiosHeaders.prototype, ({value}, key) => {\n  let mapped = key[0].toUpperCase() + key.slice(1); // map `set` => `Set`\n  return {\n    get: () => value,\n    set(headerValue) {\n      this[mapped] = headerValue;\n    }\n  }\n});\n\nutils.freezeMethods(AxiosHeaders);\n\nexport default AxiosHeaders;\n","'use strict';\n\nimport utils from './../utils.js';\nimport defaults from '../defaults/index.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\n\n/**\n * Transform the data for a request or a response\n *\n * @param {Array|Function} fns A single function or Array of functions\n * @param {?Object} response The response object\n *\n * @returns {*} The resulting transformed data\n */\nexport default function transformData(fns, response) {\n  const config = this || defaults;\n  const context = response || config;\n  const headers = AxiosHeaders.from(context.headers);\n  let data = context.data;\n\n  utils.forEach(fns, function transform(fn) {\n    data = fn.call(config, data, headers.normalize(), response ? response.status : undefined);\n  });\n\n  headers.normalize();\n\n  return data;\n}\n","'use strict';\n\nexport default function isCancel(value) {\n  return !!(value && value.__CANCEL__);\n}\n","'use strict';\n\nimport AxiosError from '../core/AxiosError.js';\nimport utils from '../utils.js';\n\n/**\n * A `CanceledError` is an object that is thrown when an operation is canceled.\n *\n * @param {string=} message The message.\n * @param {Object=} config The config.\n * @param {Object=} request The request.\n *\n * @returns {CanceledError} The created error.\n */\nfunction CanceledError(message, config, request) {\n  // eslint-disable-next-line no-eq-null,eqeqeq\n  AxiosError.call(this, message == null ? 'canceled' : message, AxiosError.ERR_CANCELED, config, request);\n  this.name = 'CanceledError';\n}\n\nutils.inherits(CanceledError, AxiosError, {\n  __CANCEL__: true\n});\n\nexport default CanceledError;\n","'use strict';\n\nimport AxiosError from './AxiosError.js';\n\n/**\n * Resolve or reject a Promise based on response status.\n *\n * @param {Function} resolve A function that resolves the promise.\n * @param {Function} reject A function that rejects the promise.\n * @param {object} response The response.\n *\n * @returns {object} The response.\n */\nexport default function settle(resolve, reject, response) {\n  const validateStatus = response.config.validateStatus;\n  if (!response.status || !validateStatus || validateStatus(response.status)) {\n    resolve(response);\n  } else {\n    reject(new AxiosError(\n      'Request failed with status code ' + response.status,\n      [AxiosError.ERR_BAD_REQUEST, AxiosError.ERR_BAD_RESPONSE][Math.floor(response.status / 100) - 4],\n      response.config,\n      response.request,\n      response\n    ));\n  }\n}\n","'use strict';\n\nexport default function parseProtocol(url) {\n  const match = /^([-+\\w]{1,25})(:?\\/\\/|:)/.exec(url);\n  return match && match[1] || '';\n}\n","'use strict';\n\n/**\n * Calculate data maxRate\n * @param {Number} [samplesCount= 10]\n * @param {Number} [min= 1000]\n * @returns {Function}\n */\nfunction speedometer(samplesCount, min) {\n  samplesCount = samplesCount || 10;\n  const bytes = new Array(samplesCount);\n  const timestamps = new Array(samplesCount);\n  let head = 0;\n  let tail = 0;\n  let firstSampleTS;\n\n  min = min !== undefined ? min : 1000;\n\n  return function push(chunkLength) {\n    const now = Date.now();\n\n    const startedAt = timestamps[tail];\n\n    if (!firstSampleTS) {\n      firstSampleTS = now;\n    }\n\n    bytes[head] = chunkLength;\n    timestamps[head] = now;\n\n    let i = tail;\n    let bytesCount = 0;\n\n    while (i !== head) {\n      bytesCount += bytes[i++];\n      i = i % samplesCount;\n    }\n\n    head = (head + 1) % samplesCount;\n\n    if (head === tail) {\n      tail = (tail + 1) % samplesCount;\n    }\n\n    if (now - firstSampleTS < min) {\n      return;\n    }\n\n    const passed = startedAt && now - startedAt;\n\n    return passed ? Math.round(bytesCount * 1000 / passed) : undefined;\n  };\n}\n\nexport default speedometer;\n","/**\n * Throttle decorator\n * @param {Function} fn\n * @param {Number} freq\n * @return {Function}\n */\nfunction throttle(fn, freq) {\n  let timestamp = 0;\n  let threshold = 1000 / freq;\n  let lastArgs;\n  let timer;\n\n  const invoke = (args, now = Date.now()) => {\n    timestamp = now;\n    lastArgs = null;\n    if (timer) {\n      clearTimeout(timer);\n      timer = null;\n    }\n    fn.apply(null, args);\n  }\n\n  const throttled = (...args) => {\n    const now = Date.now();\n    const passed = now - timestamp;\n    if ( passed >= threshold) {\n      invoke(args, now);\n    } else {\n      lastArgs = args;\n      if (!timer) {\n        timer = setTimeout(() => {\n          timer = null;\n          invoke(lastArgs)\n        }, threshold - passed);\n      }\n    }\n  }\n\n  const flush = () => lastArgs && invoke(lastArgs);\n\n  return [throttled, flush];\n}\n\nexport default throttle;\n","import speedometer from \"./speedometer.js\";\nimport throttle from \"./throttle.js\";\nimport utils from \"../utils.js\";\n\nexport const progressEventReducer = (listener, isDownloadStream, freq = 3) => {\n  let bytesNotified = 0;\n  const _speedometer = speedometer(50, 250);\n\n  return throttle(e => {\n    const loaded = e.loaded;\n    const total = e.lengthComputable ? e.total : undefined;\n    const progressBytes = loaded - bytesNotified;\n    const rate = _speedometer(progressBytes);\n    const inRange = loaded <= total;\n\n    bytesNotified = loaded;\n\n    const data = {\n      loaded,\n      total,\n      progress: total ? (loaded / total) : undefined,\n      bytes: progressBytes,\n      rate: rate ? rate : undefined,\n      estimated: rate && total && inRange ? (total - loaded) / rate : undefined,\n      event: e,\n      lengthComputable: total != null,\n      [isDownloadStream ? 'download' : 'upload']: true\n    };\n\n    listener(data);\n  }, freq);\n}\n\nexport const progressEventDecorator = (total, throttled) => {\n  const lengthComputable = total != null;\n\n  return [(loaded) => throttled[0]({\n    lengthComputable,\n    total,\n    loaded\n  }), throttled[1]];\n}\n\nexport const asyncDecorator = (fn) => (...args) => utils.asap(() => fn(...args));\n","import platform from '../platform/index.js';\n\nexport default platform.hasStandardBrowserEnv ? ((origin, isMSIE) => (url) => {\n  url = new URL(url, platform.origin);\n\n  return (\n    origin.protocol === url.protocol &&\n    origin.host === url.host &&\n    (isMSIE || origin.port === url.port)\n  );\n})(\n  new URL(platform.origin),\n  platform.navigator && /(msie|trident)/i.test(platform.navigator.userAgent)\n) : () => true;\n","import utils from './../utils.js';\nimport platform from '../platform/index.js';\n\nexport default platform.hasStandardBrowserEnv ?\n\n  // Standard browser envs support document.cookie\n  {\n    write(name, value, expires, path, domain, secure) {\n      const cookie = [name + '=' + encodeURIComponent(value)];\n\n      utils.isNumber(expires) && cookie.push('expires=' + new Date(expires).toGMTString());\n\n      utils.isString(path) && cookie.push('path=' + path);\n\n      utils.isString(domain) && cookie.push('domain=' + domain);\n\n      secure === true && cookie.push('secure');\n\n      document.cookie = cookie.join('; ');\n    },\n\n    read(name) {\n      const match = document.cookie.match(new RegExp('(^|;\\\\s*)(' + name + ')=([^;]*)'));\n      return (match ? decodeURIComponent(match[3]) : null);\n    },\n\n    remove(name) {\n      this.write(name, '', Date.now() - 86400000);\n    }\n  }\n\n  :\n\n  // Non-standard browser env (web workers, react-native) lack needed support.\n  {\n    write() {},\n    read() {\n      return null;\n    },\n    remove() {}\n  };\n\n","'use strict';\n\n/**\n * Determines whether the specified URL is absolute\n *\n * @param {string} url The URL to test\n *\n * @returns {boolean} True if the specified URL is absolute, otherwise false\n */\nexport default function isAbsoluteURL(url) {\n  // A URL is considered absolute if it begins with \"<scheme>://\" or \"//\" (protocol-relative URL).\n  // RFC 3986 defines scheme name as a sequence of characters beginning with a letter and followed\n  // by any combination of letters, digits, plus, period, or hyphen.\n  return /^([a-z][a-z\\d+\\-.]*:)?\\/\\//i.test(url);\n}\n","'use strict';\n\n/**\n * Creates a new URL by combining the specified URLs\n *\n * @param {string} baseURL The base URL\n * @param {string} relativeURL The relative URL\n *\n * @returns {string} The combined URL\n */\nexport default function combineURLs(baseURL, relativeURL) {\n  return relativeURL\n    ? baseURL.replace(/\\/?\\/$/, '') + '/' + relativeURL.replace(/^\\/+/, '')\n    : baseURL;\n}\n","'use strict';\n\nimport isAbsoluteURL from '../helpers/isAbsoluteURL.js';\nimport combineURLs from '../helpers/combineURLs.js';\n\n/**\n * Creates a new URL by combining the baseURL with the requestedURL,\n * only when the requestedURL is not already an absolute URL.\n * If the requestURL is absolute, this function returns the requestedURL untouched.\n *\n * @param {string} baseURL The base URL\n * @param {string} requestedURL Absolute or relative URL to combine\n *\n * @returns {string} The combined full path\n */\nexport default function buildFullPath(baseURL, requestedURL, allowAbsoluteUrls) {\n  let isRelativeUrl = !isAbsoluteURL(requestedURL);\n  if (baseURL && (isRelativeUrl || allowAbsoluteUrls == false)) {\n    return combineURLs(baseURL, requestedURL);\n  }\n  return requestedURL;\n}\n","'use strict';\n\nimport utils from '../utils.js';\nimport AxiosHeaders from \"./AxiosHeaders.js\";\n\nconst headersToObject = (thing) => thing instanceof AxiosHeaders ? { ...thing } : thing;\n\n/**\n * Config-specific merge-function which creates a new config-object\n * by merging two configuration objects together.\n *\n * @param {Object} config1\n * @param {Object} config2\n *\n * @returns {Object} New object resulting from merging config2 to config1\n */\nexport default function mergeConfig(config1, config2) {\n  // eslint-disable-next-line no-param-reassign\n  config2 = config2 || {};\n  const config = {};\n\n  function getMergedValue(target, source, prop, caseless) {\n    if (utils.isPlainObject(target) && utils.isPlainObject(source)) {\n      return utils.merge.call({caseless}, target, source);\n    } else if (utils.isPlainObject(source)) {\n      return utils.merge({}, source);\n    } else if (utils.isArray(source)) {\n      return source.slice();\n    }\n    return source;\n  }\n\n  // eslint-disable-next-line consistent-return\n  function mergeDeepProperties(a, b, prop , caseless) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(a, b, prop , caseless);\n    } else if (!utils.isUndefined(a)) {\n      return getMergedValue(undefined, a, prop , caseless);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function valueFromConfig2(a, b) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(undefined, b);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function defaultToConfig2(a, b) {\n    if (!utils.isUndefined(b)) {\n      return getMergedValue(undefined, b);\n    } else if (!utils.isUndefined(a)) {\n      return getMergedValue(undefined, a);\n    }\n  }\n\n  // eslint-disable-next-line consistent-return\n  function mergeDirectKeys(a, b, prop) {\n    if (prop in config2) {\n      return getMergedValue(a, b);\n    } else if (prop in config1) {\n      return getMergedValue(undefined, a);\n    }\n  }\n\n  const mergeMap = {\n    url: valueFromConfig2,\n    method: valueFromConfig2,\n    data: valueFromConfig2,\n    baseURL: defaultToConfig2,\n    transformRequest: defaultToConfig2,\n    transformResponse: defaultToConfig2,\n    paramsSerializer: defaultToConfig2,\n    timeout: defaultToConfig2,\n    timeoutMessage: defaultToConfig2,\n    withCredentials: defaultToConfig2,\n    withXSRFToken: defaultToConfig2,\n    adapter: defaultToConfig2,\n    responseType: defaultToConfig2,\n    xsrfCookieName: defaultToConfig2,\n    xsrfHeaderName: defaultToConfig2,\n    onUploadProgress: defaultToConfig2,\n    onDownloadProgress: defaultToConfig2,\n    decompress: defaultToConfig2,\n    maxContentLength: defaultToConfig2,\n    maxBodyLength: defaultToConfig2,\n    beforeRedirect: defaultToConfig2,\n    transport: defaultToConfig2,\n    httpAgent: defaultToConfig2,\n    httpsAgent: defaultToConfig2,\n    cancelToken: defaultToConfig2,\n    socketPath: defaultToConfig2,\n    responseEncoding: defaultToConfig2,\n    validateStatus: mergeDirectKeys,\n    headers: (a, b , prop) => mergeDeepProperties(headersToObject(a), headersToObject(b),prop, true)\n  };\n\n  utils.forEach(Object.keys(Object.assign({}, config1, config2)), function computeConfigValue(prop) {\n    const merge = mergeMap[prop] || mergeDeepProperties;\n    const configValue = merge(config1[prop], config2[prop], prop);\n    (utils.isUndefined(configValue) && merge !== mergeDirectKeys) || (config[prop] = configValue);\n  });\n\n  return config;\n}\n","import platform from \"../platform/index.js\";\nimport utils from \"../utils.js\";\nimport isURLSameOrigin from \"./isURLSameOrigin.js\";\nimport cookies from \"./cookies.js\";\nimport buildFullPath from \"../core/buildFullPath.js\";\nimport mergeConfig from \"../core/mergeConfig.js\";\nimport AxiosHeaders from \"../core/AxiosHeaders.js\";\nimport buildURL from \"./buildURL.js\";\n\nexport default (config) => {\n  const newConfig = mergeConfig({}, config);\n\n  let {data, withXSRFToken, xsrfHeaderName, xsrfCookieName, headers, auth} = newConfig;\n\n  newConfig.headers = headers = AxiosHeaders.from(headers);\n\n  newConfig.url = buildURL(buildFullPath(newConfig.baseURL, newConfig.url, newConfig.allowAbsoluteUrls), config.params, config.paramsSerializer);\n\n  // HTTP basic authentication\n  if (auth) {\n    headers.set('Authorization', 'Basic ' +\n      btoa((auth.username || '') + ':' + (auth.password ? unescape(encodeURIComponent(auth.password)) : ''))\n    );\n  }\n\n  let contentType;\n\n  if (utils.isFormData(data)) {\n    if (platform.hasStandardBrowserEnv || platform.hasStandardBrowserWebWorkerEnv) {\n      headers.setContentType(undefined); // Let the browser set it\n    } else if ((contentType = headers.getContentType()) !== false) {\n      // fix semicolon duplication issue for ReactNative FormData implementation\n      const [type, ...tokens] = contentType ? contentType.split(';').map(token => token.trim()).filter(Boolean) : [];\n      headers.setContentType([type || 'multipart/form-data', ...tokens].join('; '));\n    }\n  }\n\n  // Add xsrf header\n  // This is only done if running in a standard browser environment.\n  // Specifically not if we're in a web worker, or react-native.\n\n  if (platform.hasStandardBrowserEnv) {\n    withXSRFToken && utils.isFunction(withXSRFToken) && (withXSRFToken = withXSRFToken(newConfig));\n\n    if (withXSRFToken || (withXSRFToken !== false && isURLSameOrigin(newConfig.url))) {\n      // Add xsrf header\n      const xsrfValue = xsrfHeaderName && xsrfCookieName && cookies.read(xsrfCookieName);\n\n      if (xsrfValue) {\n        headers.set(xsrfHeaderName, xsrfValue);\n      }\n    }\n  }\n\n  return newConfig;\n}\n\n","import utils from './../utils.js';\nimport settle from './../core/settle.js';\nimport transitionalDefaults from '../defaults/transitional.js';\nimport AxiosError from '../core/AxiosError.js';\nimport CanceledError from '../cancel/CanceledError.js';\nimport parseProtocol from '../helpers/parseProtocol.js';\nimport platform from '../platform/index.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\nimport {progressEventReducer} from '../helpers/progressEventReducer.js';\nimport resolveConfig from \"../helpers/resolveConfig.js\";\n\nconst isXHRAdapterSupported = typeof XMLHttpRequest !== 'undefined';\n\nexport default isXHRAdapterSupported && function (config) {\n  return new Promise(function dispatchXhrRequest(resolve, reject) {\n    const _config = resolveConfig(config);\n    let requestData = _config.data;\n    const requestHeaders = AxiosHeaders.from(_config.headers).normalize();\n    let {responseType, onUploadProgress, onDownloadProgress} = _config;\n    let onCanceled;\n    let uploadThrottled, downloadThrottled;\n    let flushUpload, flushDownload;\n\n    function done() {\n      flushUpload && flushUpload(); // flush events\n      flushDownload && flushDownload(); // flush events\n\n      _config.cancelToken && _config.cancelToken.unsubscribe(onCanceled);\n\n      _config.signal && _config.signal.removeEventListener('abort', onCanceled);\n    }\n\n    let request = new XMLHttpRequest();\n\n    request.open(_config.method.toUpperCase(), _config.url, true);\n\n    // Set the request timeout in MS\n    request.timeout = _config.timeout;\n\n    function onloadend() {\n      if (!request) {\n        return;\n      }\n      // Prepare the response\n      const responseHeaders = AxiosHeaders.from(\n        'getAllResponseHeaders' in request && request.getAllResponseHeaders()\n      );\n      const responseData = !responseType || responseType === 'text' || responseType === 'json' ?\n        request.responseText : request.response;\n      const response = {\n        data: responseData,\n        status: request.status,\n        statusText: request.statusText,\n        headers: responseHeaders,\n        config,\n        request\n      };\n\n      settle(function _resolve(value) {\n        resolve(value);\n        done();\n      }, function _reject(err) {\n        reject(err);\n        done();\n      }, response);\n\n      // Clean up request\n      request = null;\n    }\n\n    if ('onloadend' in request) {\n      // Use onloadend if available\n      request.onloadend = onloadend;\n    } else {\n      // Listen for ready state to emulate onloadend\n      request.onreadystatechange = function handleLoad() {\n        if (!request || request.readyState !== 4) {\n          return;\n        }\n\n        // The request errored out and we didn't get a response, this will be\n        // handled by onerror instead\n        // With one exception: request that using file: protocol, most browsers\n        // will return status as 0 even though it's a successful request\n        if (request.status === 0 && !(request.responseURL && request.responseURL.indexOf('file:') === 0)) {\n          return;\n        }\n        // readystate handler is calling before onerror or ontimeout handlers,\n        // so we should call onloadend on the next 'tick'\n        setTimeout(onloadend);\n      };\n    }\n\n    // Handle browser request cancellation (as opposed to a manual cancellation)\n    request.onabort = function handleAbort() {\n      if (!request) {\n        return;\n      }\n\n      reject(new AxiosError('Request aborted', AxiosError.ECONNABORTED, config, request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle low level network errors\n    request.onerror = function handleError() {\n      // Real errors are hidden from us by the browser\n      // onerror should only fire if it's a network error\n      reject(new AxiosError('Network Error', AxiosError.ERR_NETWORK, config, request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Handle timeout\n    request.ontimeout = function handleTimeout() {\n      let timeoutErrorMessage = _config.timeout ? 'timeout of ' + _config.timeout + 'ms exceeded' : 'timeout exceeded';\n      const transitional = _config.transitional || transitionalDefaults;\n      if (_config.timeoutErrorMessage) {\n        timeoutErrorMessage = _config.timeoutErrorMessage;\n      }\n      reject(new AxiosError(\n        timeoutErrorMessage,\n        transitional.clarifyTimeoutError ? AxiosError.ETIMEDOUT : AxiosError.ECONNABORTED,\n        config,\n        request));\n\n      // Clean up request\n      request = null;\n    };\n\n    // Remove Content-Type if data is undefined\n    requestData === undefined && requestHeaders.setContentType(null);\n\n    // Add headers to the request\n    if ('setRequestHeader' in request) {\n      utils.forEach(requestHeaders.toJSON(), function setRequestHeader(val, key) {\n        request.setRequestHeader(key, val);\n      });\n    }\n\n    // Add withCredentials to request if needed\n    if (!utils.isUndefined(_config.withCredentials)) {\n      request.withCredentials = !!_config.withCredentials;\n    }\n\n    // Add responseType to request if needed\n    if (responseType && responseType !== 'json') {\n      request.responseType = _config.responseType;\n    }\n\n    // Handle progress if needed\n    if (onDownloadProgress) {\n      ([downloadThrottled, flushDownload] = progressEventReducer(onDownloadProgress, true));\n      request.addEventListener('progress', downloadThrottled);\n    }\n\n    // Not all browsers support upload events\n    if (onUploadProgress && request.upload) {\n      ([uploadThrottled, flushUpload] = progressEventReducer(onUploadProgress));\n\n      request.upload.addEventListener('progress', uploadThrottled);\n\n      request.upload.addEventListener('loadend', flushUpload);\n    }\n\n    if (_config.cancelToken || _config.signal) {\n      // Handle cancellation\n      // eslint-disable-next-line func-names\n      onCanceled = cancel => {\n        if (!request) {\n          return;\n        }\n        reject(!cancel || cancel.type ? new CanceledError(null, config, request) : cancel);\n        request.abort();\n        request = null;\n      };\n\n      _config.cancelToken && _config.cancelToken.subscribe(onCanceled);\n      if (_config.signal) {\n        _config.signal.aborted ? onCanceled() : _config.signal.addEventListener('abort', onCanceled);\n      }\n    }\n\n    const protocol = parseProtocol(_config.url);\n\n    if (protocol && platform.protocols.indexOf(protocol) === -1) {\n      reject(new AxiosError('Unsupported protocol ' + protocol + ':', AxiosError.ERR_BAD_REQUEST, config));\n      return;\n    }\n\n\n    // Send the request\n    request.send(requestData || null);\n  });\n}\n","import CanceledError from \"../cancel/CanceledError.js\";\nimport AxiosError from \"../core/AxiosError.js\";\nimport utils from '../utils.js';\n\nconst composeSignals = (signals, timeout) => {\n  const {length} = (signals = signals ? signals.filter(Boolean) : []);\n\n  if (timeout || length) {\n    let controller = new AbortController();\n\n    let aborted;\n\n    const onabort = function (reason) {\n      if (!aborted) {\n        aborted = true;\n        unsubscribe();\n        const err = reason instanceof Error ? reason : this.reason;\n        controller.abort(err instanceof AxiosError ? err : new CanceledError(err instanceof Error ? err.message : err));\n      }\n    }\n\n    let timer = timeout && setTimeout(() => {\n      timer = null;\n      onabort(new AxiosError(`timeout ${timeout} of ms exceeded`, AxiosError.ETIMEDOUT))\n    }, timeout)\n\n    const unsubscribe = () => {\n      if (signals) {\n        timer && clearTimeout(timer);\n        timer = null;\n        signals.forEach(signal => {\n          signal.unsubscribe ? signal.unsubscribe(onabort) : signal.removeEventListener('abort', onabort);\n        });\n        signals = null;\n      }\n    }\n\n    signals.forEach((signal) => signal.addEventListener('abort', onabort));\n\n    const {signal} = controller;\n\n    signal.unsubscribe = () => utils.asap(unsubscribe);\n\n    return signal;\n  }\n}\n\nexport default composeSignals;\n","\nexport const streamChunk = function* (chunk, chunkSize) {\n  let len = chunk.byteLength;\n\n  if (!chunkSize || len < chunkSize) {\n    yield chunk;\n    return;\n  }\n\n  let pos = 0;\n  let end;\n\n  while (pos < len) {\n    end = pos + chunkSize;\n    yield chunk.slice(pos, end);\n    pos = end;\n  }\n}\n\nexport const readBytes = async function* (iterable, chunkSize) {\n  for await (const chunk of readStream(iterable)) {\n    yield* streamChunk(chunk, chunkSize);\n  }\n}\n\nconst readStream = async function* (stream) {\n  if (stream[Symbol.asyncIterator]) {\n    yield* stream;\n    return;\n  }\n\n  const reader = stream.getReader();\n  try {\n    for (;;) {\n      const {done, value} = await reader.read();\n      if (done) {\n        break;\n      }\n      yield value;\n    }\n  } finally {\n    await reader.cancel();\n  }\n}\n\nexport const trackStream = (stream, chunkSize, onProgress, onFinish) => {\n  const iterator = readBytes(stream, chunkSize);\n\n  let bytes = 0;\n  let done;\n  let _onFinish = (e) => {\n    if (!done) {\n      done = true;\n      onFinish && onFinish(e);\n    }\n  }\n\n  return new ReadableStream({\n    async pull(controller) {\n      try {\n        const {done, value} = await iterator.next();\n\n        if (done) {\n         _onFinish();\n          controller.close();\n          return;\n        }\n\n        let len = value.byteLength;\n        if (onProgress) {\n          let loadedBytes = bytes += len;\n          onProgress(loadedBytes);\n        }\n        controller.enqueue(new Uint8Array(value));\n      } catch (err) {\n        _onFinish(err);\n        throw err;\n      }\n    },\n    cancel(reason) {\n      _onFinish(reason);\n      return iterator.return();\n    }\n  }, {\n    highWaterMark: 2\n  })\n}\n","import platform from \"../platform/index.js\";\nimport utils from \"../utils.js\";\nimport AxiosError from \"../core/AxiosError.js\";\nimport composeSignals from \"../helpers/composeSignals.js\";\nimport {trackStream} from \"../helpers/trackStream.js\";\nimport AxiosHeaders from \"../core/AxiosHeaders.js\";\nimport {progressEventReducer, progressEventDecorator, asyncDecorator} from \"../helpers/progressEventReducer.js\";\nimport resolveConfig from \"../helpers/resolveConfig.js\";\nimport settle from \"../core/settle.js\";\n\nconst isFetchSupported = typeof fetch === 'function' && typeof Request === 'function' && typeof Response === 'function';\nconst isReadableStreamSupported = isFetchSupported && typeof ReadableStream === 'function';\n\n// used only inside the fetch adapter\nconst encodeText = isFetchSupported && (typeof TextEncoder === 'function' ?\n    ((encoder) => (str) => encoder.encode(str))(new TextEncoder()) :\n    async (str) => new Uint8Array(await new Response(str).arrayBuffer())\n);\n\nconst test = (fn, ...args) => {\n  try {\n    return !!fn(...args);\n  } catch (e) {\n    return false\n  }\n}\n\nconst supportsRequestStream = isReadableStreamSupported && test(() => {\n  let duplexAccessed = false;\n\n  const hasContentType = new Request(platform.origin, {\n    body: new ReadableStream(),\n    method: 'POST',\n    get duplex() {\n      duplexAccessed = true;\n      return 'half';\n    },\n  }).headers.has('Content-Type');\n\n  return duplexAccessed && !hasContentType;\n});\n\nconst DEFAULT_CHUNK_SIZE = 64 * 1024;\n\nconst supportsResponseStream = isReadableStreamSupported &&\n  test(() => utils.isReadableStream(new Response('').body));\n\n\nconst resolvers = {\n  stream: supportsResponseStream && ((res) => res.body)\n};\n\nisFetchSupported && (((res) => {\n  ['text', 'arrayBuffer', 'blob', 'formData', 'stream'].forEach(type => {\n    !resolvers[type] && (resolvers[type] = utils.isFunction(res[type]) ? (res) => res[type]() :\n      (_, config) => {\n        throw new AxiosError(`Response type '${type}' is not supported`, AxiosError.ERR_NOT_SUPPORT, config);\n      })\n  });\n})(new Response));\n\nconst getBodyLength = async (body) => {\n  if (body == null) {\n    return 0;\n  }\n\n  if(utils.isBlob(body)) {\n    return body.size;\n  }\n\n  if(utils.isSpecCompliantForm(body)) {\n    const _request = new Request(platform.origin, {\n      method: 'POST',\n      body,\n    });\n    return (await _request.arrayBuffer()).byteLength;\n  }\n\n  if(utils.isArrayBufferView(body) || utils.isArrayBuffer(body)) {\n    return body.byteLength;\n  }\n\n  if(utils.isURLSearchParams(body)) {\n    body = body + '';\n  }\n\n  if(utils.isString(body)) {\n    return (await encodeText(body)).byteLength;\n  }\n}\n\nconst resolveBodyLength = async (headers, body) => {\n  const length = utils.toFiniteNumber(headers.getContentLength());\n\n  return length == null ? getBodyLength(body) : length;\n}\n\nexport default isFetchSupported && (async (config) => {\n  let {\n    url,\n    method,\n    data,\n    signal,\n    cancelToken,\n    timeout,\n    onDownloadProgress,\n    onUploadProgress,\n    responseType,\n    headers,\n    withCredentials = 'same-origin',\n    fetchOptions\n  } = resolveConfig(config);\n\n  responseType = responseType ? (responseType + '').toLowerCase() : 'text';\n\n  let composedSignal = composeSignals([signal, cancelToken && cancelToken.toAbortSignal()], timeout);\n\n  let request;\n\n  const unsubscribe = composedSignal && composedSignal.unsubscribe && (() => {\n      composedSignal.unsubscribe();\n  });\n\n  let requestContentLength;\n\n  try {\n    if (\n      onUploadProgress && supportsRequestStream && method !== 'get' && method !== 'head' &&\n      (requestContentLength = await resolveBodyLength(headers, data)) !== 0\n    ) {\n      let _request = new Request(url, {\n        method: 'POST',\n        body: data,\n        duplex: \"half\"\n      });\n\n      let contentTypeHeader;\n\n      if (utils.isFormData(data) && (contentTypeHeader = _request.headers.get('content-type'))) {\n        headers.setContentType(contentTypeHeader)\n      }\n\n      if (_request.body) {\n        const [onProgress, flush] = progressEventDecorator(\n          requestContentLength,\n          progressEventReducer(asyncDecorator(onUploadProgress))\n        );\n\n        data = trackStream(_request.body, DEFAULT_CHUNK_SIZE, onProgress, flush);\n      }\n    }\n\n    if (!utils.isString(withCredentials)) {\n      withCredentials = withCredentials ? 'include' : 'omit';\n    }\n\n    // Cloudflare Workers throws when credentials are defined\n    // see https://github.com/cloudflare/workerd/issues/902\n    const isCredentialsSupported = \"credentials\" in Request.prototype;\n    request = new Request(url, {\n      ...fetchOptions,\n      signal: composedSignal,\n      method: method.toUpperCase(),\n      headers: headers.normalize().toJSON(),\n      body: data,\n      duplex: \"half\",\n      credentials: isCredentialsSupported ? withCredentials : undefined\n    });\n\n    let response = await fetch(request);\n\n    const isStreamResponse = supportsResponseStream && (responseType === 'stream' || responseType === 'response');\n\n    if (supportsResponseStream && (onDownloadProgress || (isStreamResponse && unsubscribe))) {\n      const options = {};\n\n      ['status', 'statusText', 'headers'].forEach(prop => {\n        options[prop] = response[prop];\n      });\n\n      const responseContentLength = utils.toFiniteNumber(response.headers.get('content-length'));\n\n      const [onProgress, flush] = onDownloadProgress && progressEventDecorator(\n        responseContentLength,\n        progressEventReducer(asyncDecorator(onDownloadProgress), true)\n      ) || [];\n\n      response = new Response(\n        trackStream(response.body, DEFAULT_CHUNK_SIZE, onProgress, () => {\n          flush && flush();\n          unsubscribe && unsubscribe();\n        }),\n        options\n      );\n    }\n\n    responseType = responseType || 'text';\n\n    let responseData = await resolvers[utils.findKey(resolvers, responseType) || 'text'](response, config);\n\n    !isStreamResponse && unsubscribe && unsubscribe();\n\n    return await new Promise((resolve, reject) => {\n      settle(resolve, reject, {\n        data: responseData,\n        headers: AxiosHeaders.from(response.headers),\n        status: response.status,\n        statusText: response.statusText,\n        config,\n        request\n      })\n    })\n  } catch (err) {\n    unsubscribe && unsubscribe();\n\n    if (err && err.name === 'TypeError' && /Load failed|fetch/i.test(err.message)) {\n      throw Object.assign(\n        new AxiosError('Network Error', AxiosError.ERR_NETWORK, config, request),\n        {\n          cause: err.cause || err\n        }\n      )\n    }\n\n    throw AxiosError.from(err, err && err.code, config, request);\n  }\n});\n\n\n","import utils from '../utils.js';\nimport httpAdapter from './http.js';\nimport xhrAdapter from './xhr.js';\nimport fetchAdapter from './fetch.js';\nimport AxiosError from \"../core/AxiosError.js\";\n\nconst knownAdapters = {\n  http: httpAdapter,\n  xhr: xhrAdapter,\n  fetch: fetchAdapter\n}\n\nutils.forEach(knownAdapters, (fn, value) => {\n  if (fn) {\n    try {\n      Object.defineProperty(fn, 'name', {value});\n    } catch (e) {\n      // eslint-disable-next-line no-empty\n    }\n    Object.defineProperty(fn, 'adapterName', {value});\n  }\n});\n\nconst renderReason = (reason) => `- ${reason}`;\n\nconst isResolvedHandle = (adapter) => utils.isFunction(adapter) || adapter === null || adapter === false;\n\nexport default {\n  getAdapter: (adapters) => {\n    adapters = utils.isArray(adapters) ? adapters : [adapters];\n\n    const {length} = adapters;\n    let nameOrAdapter;\n    let adapter;\n\n    const rejectedReasons = {};\n\n    for (let i = 0; i < length; i++) {\n      nameOrAdapter = adapters[i];\n      let id;\n\n      adapter = nameOrAdapter;\n\n      if (!isResolvedHandle(nameOrAdapter)) {\n        adapter = knownAdapters[(id = String(nameOrAdapter)).toLowerCase()];\n\n        if (adapter === undefined) {\n          throw new AxiosError(`Unknown adapter '${id}'`);\n        }\n      }\n\n      if (adapter) {\n        break;\n      }\n\n      rejectedReasons[id || '#' + i] = adapter;\n    }\n\n    if (!adapter) {\n\n      const reasons = Object.entries(rejectedReasons)\n        .map(([id, state]) => `adapter ${id} ` +\n          (state === false ? 'is not supported by the environment' : 'is not available in the build')\n        );\n\n      let s = length ?\n        (reasons.length > 1 ? 'since :\\n' + reasons.map(renderReason).join('\\n') : ' ' + renderReason(reasons[0])) :\n        'as no adapter specified';\n\n      throw new AxiosError(\n        `There is no suitable adapter to dispatch the request ` + s,\n        'ERR_NOT_SUPPORT'\n      );\n    }\n\n    return adapter;\n  },\n  adapters: knownAdapters\n}\n","'use strict';\n\nimport transformData from './transformData.js';\nimport isCancel from '../cancel/isCancel.js';\nimport defaults from '../defaults/index.js';\nimport CanceledError from '../cancel/CanceledError.js';\nimport AxiosHeaders from '../core/AxiosHeaders.js';\nimport adapters from \"../adapters/adapters.js\";\n\n/**\n * Throws a `CanceledError` if cancellation has been requested.\n *\n * @param {Object} config The config that is to be used for the request\n *\n * @returns {void}\n */\nfunction throwIfCancellationRequested(config) {\n  if (config.cancelToken) {\n    config.cancelToken.throwIfRequested();\n  }\n\n  if (config.signal && config.signal.aborted) {\n    throw new CanceledError(null, config);\n  }\n}\n\n/**\n * Dispatch a request to the server using the configured adapter.\n *\n * @param {object} config The config that is to be used for the request\n *\n * @returns {Promise} The Promise to be fulfilled\n */\nexport default function dispatchRequest(config) {\n  throwIfCancellationRequested(config);\n\n  config.headers = AxiosHeaders.from(config.headers);\n\n  // Transform request data\n  config.data = transformData.call(\n    config,\n    config.transformRequest\n  );\n\n  if (['post', 'put', 'patch'].indexOf(config.method) !== -1) {\n    config.headers.setContentType('application/x-www-form-urlencoded', false);\n  }\n\n  const adapter = adapters.getAdapter(config.adapter || defaults.adapter);\n\n  return adapter(config).then(function onAdapterResolution(response) {\n    throwIfCancellationRequested(config);\n\n    // Transform response data\n    response.data = transformData.call(\n      config,\n      config.transformResponse,\n      response\n    );\n\n    response.headers = AxiosHeaders.from(response.headers);\n\n    return response;\n  }, function onAdapterRejection(reason) {\n    if (!isCancel(reason)) {\n      throwIfCancellationRequested(config);\n\n      // Transform response data\n      if (reason && reason.response) {\n        reason.response.data = transformData.call(\n          config,\n          config.transformResponse,\n          reason.response\n        );\n        reason.response.headers = AxiosHeaders.from(reason.response.headers);\n      }\n    }\n\n    return Promise.reject(reason);\n  });\n}\n","export const VERSION = \"1.9.0\";","'use strict';\n\nimport {VERSION} from '../env/data.js';\nimport AxiosError from '../core/AxiosError.js';\n\nconst validators = {};\n\n// eslint-disable-next-line func-names\n['object', 'boolean', 'number', 'function', 'string', 'symbol'].forEach((type, i) => {\n  validators[type] = function validator(thing) {\n    return typeof thing === type || 'a' + (i < 1 ? 'n ' : ' ') + type;\n  };\n});\n\nconst deprecatedWarnings = {};\n\n/**\n * Transitional option validator\n *\n * @param {function|boolean?} validator - set to false if the transitional option has been removed\n * @param {string?} version - deprecated version / removed since version\n * @param {string?} message - some message with additional info\n *\n * @returns {function}\n */\nvalidators.transitional = function transitional(validator, version, message) {\n  function formatMessage(opt, desc) {\n    return '[Axios v' + VERSION + '] Transitional option \\'' + opt + '\\'' + desc + (message ? '. ' + message : '');\n  }\n\n  // eslint-disable-next-line func-names\n  return (value, opt, opts) => {\n    if (validator === false) {\n      throw new AxiosError(\n        formatMessage(opt, ' has been removed' + (version ? ' in ' + version : '')),\n        AxiosError.ERR_DEPRECATED\n      );\n    }\n\n    if (version && !deprecatedWarnings[opt]) {\n      deprecatedWarnings[opt] = true;\n      // eslint-disable-next-line no-console\n      console.warn(\n        formatMessage(\n          opt,\n          ' has been deprecated since v' + version + ' and will be removed in the near future'\n        )\n      );\n    }\n\n    return validator ? validator(value, opt, opts) : true;\n  };\n};\n\nvalidators.spelling = function spelling(correctSpelling) {\n  return (value, opt) => {\n    // eslint-disable-next-line no-console\n    console.warn(`${opt} is likely a misspelling of ${correctSpelling}`);\n    return true;\n  }\n};\n\n/**\n * Assert object's properties type\n *\n * @param {object} options\n * @param {object} schema\n * @param {boolean?} allowUnknown\n *\n * @returns {object}\n */\n\nfunction assertOptions(options, schema, allowUnknown) {\n  if (typeof options !== 'object') {\n    throw new AxiosError('options must be an object', AxiosError.ERR_BAD_OPTION_VALUE);\n  }\n  const keys = Object.keys(options);\n  let i = keys.length;\n  while (i-- > 0) {\n    const opt = keys[i];\n    const validator = schema[opt];\n    if (validator) {\n      const value = options[opt];\n      const result = value === undefined || validator(value, opt, options);\n      if (result !== true) {\n        throw new AxiosError('option ' + opt + ' must be ' + result, AxiosError.ERR_BAD_OPTION_VALUE);\n      }\n      continue;\n    }\n    if (allowUnknown !== true) {\n      throw new AxiosError('Unknown option ' + opt, AxiosError.ERR_BAD_OPTION);\n    }\n  }\n}\n\nexport default {\n  assertOptions,\n  validators\n};\n","'use strict';\n\nimport utils from './../utils.js';\nimport buildURL from '../helpers/buildURL.js';\nimport InterceptorManager from './InterceptorManager.js';\nimport dispatchRequest from './dispatchRequest.js';\nimport mergeConfig from './mergeConfig.js';\nimport buildFullPath from './buildFullPath.js';\nimport validator from '../helpers/validator.js';\nimport AxiosHeaders from './AxiosHeaders.js';\n\nconst validators = validator.validators;\n\n/**\n * Create a new instance of Axios\n *\n * @param {Object} instanceConfig The default config for the instance\n *\n * @return {Axios} A new instance of Axios\n */\nclass Axios {\n  constructor(instanceConfig) {\n    this.defaults = instanceConfig || {};\n    this.interceptors = {\n      request: new InterceptorManager(),\n      response: new InterceptorManager()\n    };\n  }\n\n  /**\n   * Dispatch a request\n   *\n   * @param {String|Object} configOrUrl The config specific for this request (merged with this.defaults)\n   * @param {?Object} config\n   *\n   * @returns {Promise} The Promise to be fulfilled\n   */\n  async request(configOrUrl, config) {\n    try {\n      return await this._request(configOrUrl, config);\n    } catch (err) {\n      if (err instanceof Error) {\n        let dummy = {};\n\n        Error.captureStackTrace ? Error.captureStackTrace(dummy) : (dummy = new Error());\n\n        // slice off the Error: ... line\n        const stack = dummy.stack ? dummy.stack.replace(/^.+\\n/, '') : '';\n        try {\n          if (!err.stack) {\n            err.stack = stack;\n            // match without the 2 top stack lines\n          } else if (stack && !String(err.stack).endsWith(stack.replace(/^.+\\n.+\\n/, ''))) {\n            err.stack += '\\n' + stack\n          }\n        } catch (e) {\n          // ignore the case where \"stack\" is an un-writable property\n        }\n      }\n\n      throw err;\n    }\n  }\n\n  _request(configOrUrl, config) {\n    /*eslint no-param-reassign:0*/\n    // Allow for axios('example/url'[, config]) a la fetch API\n    if (typeof configOrUrl === 'string') {\n      config = config || {};\n      config.url = configOrUrl;\n    } else {\n      config = configOrUrl || {};\n    }\n\n    config = mergeConfig(this.defaults, config);\n\n    const {transitional, paramsSerializer, headers} = config;\n\n    if (transitional !== undefined) {\n      validator.assertOptions(transitional, {\n        silentJSONParsing: validators.transitional(validators.boolean),\n        forcedJSONParsing: validators.transitional(validators.boolean),\n        clarifyTimeoutError: validators.transitional(validators.boolean)\n      }, false);\n    }\n\n    if (paramsSerializer != null) {\n      if (utils.isFunction(paramsSerializer)) {\n        config.paramsSerializer = {\n          serialize: paramsSerializer\n        }\n      } else {\n        validator.assertOptions(paramsSerializer, {\n          encode: validators.function,\n          serialize: validators.function\n        }, true);\n      }\n    }\n\n    // Set config.allowAbsoluteUrls\n    if (config.allowAbsoluteUrls !== undefined) {\n      // do nothing\n    } else if (this.defaults.allowAbsoluteUrls !== undefined) {\n      config.allowAbsoluteUrls = this.defaults.allowAbsoluteUrls;\n    } else {\n      config.allowAbsoluteUrls = true;\n    }\n\n    validator.assertOptions(config, {\n      baseUrl: validators.spelling('baseURL'),\n      withXsrfToken: validators.spelling('withXSRFToken')\n    }, true);\n\n    // Set config.method\n    config.method = (config.method || this.defaults.method || 'get').toLowerCase();\n\n    // Flatten headers\n    let contextHeaders = headers && utils.merge(\n      headers.common,\n      headers[config.method]\n    );\n\n    headers && utils.forEach(\n      ['delete', 'get', 'head', 'post', 'put', 'patch', 'common'],\n      (method) => {\n        delete headers[method];\n      }\n    );\n\n    config.headers = AxiosHeaders.concat(contextHeaders, headers);\n\n    // filter out skipped interceptors\n    const requestInterceptorChain = [];\n    let synchronousRequestInterceptors = true;\n    this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) {\n      if (typeof interceptor.runWhen === 'function' && interceptor.runWhen(config) === false) {\n        return;\n      }\n\n      synchronousRequestInterceptors = synchronousRequestInterceptors && interceptor.synchronous;\n\n      requestInterceptorChain.unshift(interceptor.fulfilled, interceptor.rejected);\n    });\n\n    const responseInterceptorChain = [];\n    this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) {\n      responseInterceptorChain.push(interceptor.fulfilled, interceptor.rejected);\n    });\n\n    let promise;\n    let i = 0;\n    let len;\n\n    if (!synchronousRequestInterceptors) {\n      const chain = [dispatchRequest.bind(this), undefined];\n      chain.unshift.apply(chain, requestInterceptorChain);\n      chain.push.apply(chain, responseInterceptorChain);\n      len = chain.length;\n\n      promise = Promise.resolve(config);\n\n      while (i < len) {\n        promise = promise.then(chain[i++], chain[i++]);\n      }\n\n      return promise;\n    }\n\n    len = requestInterceptorChain.length;\n\n    let newConfig = config;\n\n    i = 0;\n\n    while (i < len) {\n      const onFulfilled = requestInterceptorChain[i++];\n      const onRejected = requestInterceptorChain[i++];\n      try {\n        newConfig = onFulfilled(newConfig);\n      } catch (error) {\n        onRejected.call(this, error);\n        break;\n      }\n    }\n\n    try {\n      promise = dispatchRequest.call(this, newConfig);\n    } catch (error) {\n      return Promise.reject(error);\n    }\n\n    i = 0;\n    len = responseInterceptorChain.length;\n\n    while (i < len) {\n      promise = promise.then(responseInterceptorChain[i++], responseInterceptorChain[i++]);\n    }\n\n    return promise;\n  }\n\n  getUri(config) {\n    config = mergeConfig(this.defaults, config);\n    const fullPath = buildFullPath(config.baseURL, config.url, config.allowAbsoluteUrls);\n    return buildURL(fullPath, config.params, config.paramsSerializer);\n  }\n}\n\n// Provide aliases for supported request methods\nutils.forEach(['delete', 'get', 'head', 'options'], function forEachMethodNoData(method) {\n  /*eslint func-names:0*/\n  Axios.prototype[method] = function(url, config) {\n    return this.request(mergeConfig(config || {}, {\n      method,\n      url,\n      data: (config || {}).data\n    }));\n  };\n});\n\nutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n  /*eslint func-names:0*/\n\n  function generateHTTPMethod(isForm) {\n    return function httpMethod(url, data, config) {\n      return this.request(mergeConfig(config || {}, {\n        method,\n        headers: isForm ? {\n          'Content-Type': 'multipart/form-data'\n        } : {},\n        url,\n        data\n      }));\n    };\n  }\n\n  Axios.prototype[method] = generateHTTPMethod();\n\n  Axios.prototype[method + 'Form'] = generateHTTPMethod(true);\n});\n\nexport default Axios;\n","'use strict';\n\nimport CanceledError from './CanceledError.js';\n\n/**\n * A `CancelToken` is an object that can be used to request cancellation of an operation.\n *\n * @param {Function} executor The executor function.\n *\n * @returns {CancelToken}\n */\nclass CancelToken {\n  constructor(executor) {\n    if (typeof executor !== 'function') {\n      throw new TypeError('executor must be a function.');\n    }\n\n    let resolvePromise;\n\n    this.promise = new Promise(function promiseExecutor(resolve) {\n      resolvePromise = resolve;\n    });\n\n    const token = this;\n\n    // eslint-disable-next-line func-names\n    this.promise.then(cancel => {\n      if (!token._listeners) return;\n\n      let i = token._listeners.length;\n\n      while (i-- > 0) {\n        token._listeners[i](cancel);\n      }\n      token._listeners = null;\n    });\n\n    // eslint-disable-next-line func-names\n    this.promise.then = onfulfilled => {\n      let _resolve;\n      // eslint-disable-next-line func-names\n      const promise = new Promise(resolve => {\n        token.subscribe(resolve);\n        _resolve = resolve;\n      }).then(onfulfilled);\n\n      promise.cancel = function reject() {\n        token.unsubscribe(_resolve);\n      };\n\n      return promise;\n    };\n\n    executor(function cancel(message, config, request) {\n      if (token.reason) {\n        // Cancellation has already been requested\n        return;\n      }\n\n      token.reason = new CanceledError(message, config, request);\n      resolvePromise(token.reason);\n    });\n  }\n\n  /**\n   * Throws a `CanceledError` if cancellation has been requested.\n   */\n  throwIfRequested() {\n    if (this.reason) {\n      throw this.reason;\n    }\n  }\n\n  /**\n   * Subscribe to the cancel signal\n   */\n\n  subscribe(listener) {\n    if (this.reason) {\n      listener(this.reason);\n      return;\n    }\n\n    if (this._listeners) {\n      this._listeners.push(listener);\n    } else {\n      this._listeners = [listener];\n    }\n  }\n\n  /**\n   * Unsubscribe from the cancel signal\n   */\n\n  unsubscribe(listener) {\n    if (!this._listeners) {\n      return;\n    }\n    const index = this._listeners.indexOf(listener);\n    if (index !== -1) {\n      this._listeners.splice(index, 1);\n    }\n  }\n\n  toAbortSignal() {\n    const controller = new AbortController();\n\n    const abort = (err) => {\n      controller.abort(err);\n    };\n\n    this.subscribe(abort);\n\n    controller.signal.unsubscribe = () => this.unsubscribe(abort);\n\n    return controller.signal;\n  }\n\n  /**\n   * Returns an object that contains a new `CancelToken` and a function that, when called,\n   * cancels the `CancelToken`.\n   */\n  static source() {\n    let cancel;\n    const token = new CancelToken(function executor(c) {\n      cancel = c;\n    });\n    return {\n      token,\n      cancel\n    };\n  }\n}\n\nexport default CancelToken;\n","'use strict';\n\n/**\n * Syntactic sugar for invoking a function and expanding an array for arguments.\n *\n * Common use case would be to use `Function.prototype.apply`.\n *\n *  ```js\n *  function f(x, y, z) {}\n *  var args = [1, 2, 3];\n *  f.apply(null, args);\n *  ```\n *\n * With `spread` this example can be re-written.\n *\n *  ```js\n *  spread(function(x, y, z) {})([1, 2, 3]);\n *  ```\n *\n * @param {Function} callback\n *\n * @returns {Function}\n */\nexport default function spread(callback) {\n  return function wrap(arr) {\n    return callback.apply(null, arr);\n  };\n}\n","'use strict';\n\nimport utils from './../utils.js';\n\n/**\n * Determines whether the payload is an error thrown by Axios\n *\n * @param {*} payload The value to test\n *\n * @returns {boolean} True if the payload is an error thrown by Axios, otherwise false\n */\nexport default function isAxiosError(payload) {\n  return utils.isObject(payload) && (payload.isAxiosError === true);\n}\n","const HttpStatusCode = {\n  Continue: 100,\n  SwitchingProtocols: 101,\n  Processing: 102,\n  EarlyHints: 103,\n  Ok: 200,\n  Created: 201,\n  Accepted: 202,\n  NonAuthoritativeInformation: 203,\n  NoContent: 204,\n  ResetContent: 205,\n  PartialContent: 206,\n  MultiStatus: 207,\n  AlreadyReported: 208,\n  ImUsed: 226,\n  MultipleChoices: 300,\n  MovedPermanently: 301,\n  Found: 302,\n  SeeOther: 303,\n  NotModified: 304,\n  UseProxy: 305,\n  Unused: 306,\n  TemporaryRedirect: 307,\n  PermanentRedirect: 308,\n  BadRequest: 400,\n  Unauthorized: 401,\n  PaymentRequired: 402,\n  Forbidden: 403,\n  NotFound: 404,\n  MethodNotAllowed: 405,\n  NotAcceptable: 406,\n  ProxyAuthenticationRequired: 407,\n  RequestTimeout: 408,\n  Conflict: 409,\n  Gone: 410,\n  LengthRequired: 411,\n  PreconditionFailed: 412,\n  PayloadTooLarge: 413,\n  UriTooLong: 414,\n  UnsupportedMediaType: 415,\n  RangeNotSatisfiable: 416,\n  ExpectationFailed: 417,\n  ImATeapot: 418,\n  MisdirectedRequest: 421,\n  UnprocessableEntity: 422,\n  Locked: 423,\n  FailedDependency: 424,\n  TooEarly: 425,\n  UpgradeRequired: 426,\n  PreconditionRequired: 428,\n  TooManyRequests: 429,\n  RequestHeaderFieldsTooLarge: 431,\n  UnavailableForLegalReasons: 451,\n  InternalServerError: 500,\n  NotImplemented: 501,\n  BadGateway: 502,\n  ServiceUnavailable: 503,\n  GatewayTimeout: 504,\n  HttpVersionNotSupported: 505,\n  VariantAlsoNegotiates: 506,\n  InsufficientStorage: 507,\n  LoopDetected: 508,\n  NotExtended: 510,\n  NetworkAuthenticationRequired: 511,\n};\n\nObject.entries(HttpStatusCode).forEach(([key, value]) => {\n  HttpStatusCode[value] = key;\n});\n\nexport default HttpStatusCode;\n","'use strict';\n\nimport utils from './utils.js';\nimport bind from './helpers/bind.js';\nimport Axios from './core/Axios.js';\nimport mergeConfig from './core/mergeConfig.js';\nimport defaults from './defaults/index.js';\nimport formDataToJSON from './helpers/formDataToJSON.js';\nimport CanceledError from './cancel/CanceledError.js';\nimport CancelToken from './cancel/CancelToken.js';\nimport isCancel from './cancel/isCancel.js';\nimport {VERSION} from './env/data.js';\nimport toFormData from './helpers/toFormData.js';\nimport AxiosError from './core/AxiosError.js';\nimport spread from './helpers/spread.js';\nimport isAxiosError from './helpers/isAxiosError.js';\nimport AxiosHeaders from \"./core/AxiosHeaders.js\";\nimport adapters from './adapters/adapters.js';\nimport HttpStatusCode from './helpers/HttpStatusCode.js';\n\n/**\n * Create an instance of Axios\n *\n * @param {Object} defaultConfig The default config for the instance\n *\n * @returns {Axios} A new instance of Axios\n */\nfunction createInstance(defaultConfig) {\n  const context = new Axios(defaultConfig);\n  const instance = bind(Axios.prototype.request, context);\n\n  // Copy axios.prototype to instance\n  utils.extend(instance, Axios.prototype, context, {allOwnKeys: true});\n\n  // Copy context to instance\n  utils.extend(instance, context, null, {allOwnKeys: true});\n\n  // Factory for creating new instances\n  instance.create = function create(instanceConfig) {\n    return createInstance(mergeConfig(defaultConfig, instanceConfig));\n  };\n\n  return instance;\n}\n\n// Create the default instance to be exported\nconst axios = createInstance(defaults);\n\n// Expose Axios class to allow class inheritance\naxios.Axios = Axios;\n\n// Expose Cancel & CancelToken\naxios.CanceledError = CanceledError;\naxios.CancelToken = CancelToken;\naxios.isCancel = isCancel;\naxios.VERSION = VERSION;\naxios.toFormData = toFormData;\n\n// Expose AxiosError class\naxios.AxiosError = AxiosError;\n\n// alias for CanceledError for backward compatibility\naxios.Cancel = axios.CanceledError;\n\n// Expose all/spread\naxios.all = function all(promises) {\n  return Promise.all(promises);\n};\n\naxios.spread = spread;\n\n// Expose isAxiosError\naxios.isAxiosError = isAxiosError;\n\n// Expose mergeConfig\naxios.mergeConfig = mergeConfig;\n\naxios.AxiosHeaders = AxiosHeaders;\n\naxios.formToJSON = thing => formDataToJSON(utils.isHTMLForm(thing) ? new FormData(thing) : thing);\n\naxios.getAdapter = adapters.getAdapter;\n\naxios.HttpStatusCode = HttpStatusCode;\n\naxios.default = axios;\n\n// this module should only have a default export\nexport default axios\n","import axios from './lib/axios.js';\n\n// This module is intended to unwrap Axios default export as named.\n// Keep top-level export same with static properties\n// so that it can keep same with es module or cjs\nconst {\n  Axios,\n  AxiosError,\n  CanceledError,\n  isCancel,\n  CancelToken,\n  VERSION,\n  all,\n  Cancel,\n  isAxiosError,\n  spread,\n  toFormData,\n  AxiosHeaders,\n  HttpStatusCode,\n  formToJSON,\n  getAdapter,\n  mergeConfig\n} = axios;\n\nexport {\n  axios as default,\n  Axios,\n  AxiosError,\n  CanceledError,\n  isCancel,\n  CancelToken,\n  VERSION,\n  all,\n  Cancel,\n  isAxiosError,\n  spread,\n  toFormData,\n  AxiosHeaders,\n  HttpStatusCode,\n  formToJSON,\n  getAdapter,\n  mergeConfig\n}\n","// src/infrastructure/api/axiosConfig.ts - Versión optimizada\r\n\r\nimport axios from \"axios\";\r\nimport type {\r\n\tAxiosInstance,\r\n\tAxiosError,\r\n\tInternalAxiosRequestConfig,\r\n\tAxiosResponse,\r\n} from \"axios\";\r\nimport appConfig from \"../../config/appConfig\";\r\n\r\n// Para evitar múltiples intentos de refresh\r\nlet isRefreshing = false;\r\nlet refreshSubscribers: Array<(token: string) => void> = [];\r\n\r\n// Función para añadir callbacks a la cola\r\nconst subscribeTokenRefresh = (callback: (token: string) => void) => {\r\n\trefreshSubscribers.push(callback);\r\n};\r\n\r\n// Función para ejecutar callbacks con el nuevo token\r\nconst onTokenRefreshed = (token: string) => {\r\n\trefreshSubscribers.forEach((callback) => callback(token));\r\n\trefreshSubscribers = [];\r\n};\r\n\r\n// Create a custom axios instance\r\nconst axiosInstance: AxiosInstance = axios.create({\r\n\tbaseURL: appConfig.api.baseUrl,\r\n\ttimeout: appConfig.api.timeout,\r\n\theaders: {\r\n\t\t\"Content-Type\": \"application/json\",\r\n\t\tAccept: \"application/json\",\r\n\t},\r\n});\r\n\r\n// Request interceptor\r\naxiosInstance.interceptors.request.use(\r\n\t(config: InternalAxiosRequestConfig) => {\r\n\t\t// Evitar agregar token para solicitudes de refreshToken o login\r\n\t\tif (\r\n\t\t\tconfig.url?.includes(\"/auth/refresh\") ||\r\n\t\t\tconfig.url?.includes(\"/auth/login\")\r\n\t\t) {\r\n\t\t\treturn config;\r\n\t\t}\r\n\r\n\t\t// Get token from localStorage\r\n\t\tconst token = localStorage.getItem(appConfig.storage.authTokenKey);\r\n\r\n\t\t// If token exists, add it to the headers\r\n\t\tif (token && config.headers) {\r\n\t\t\tconfig.headers[\"Authorization\"] = `Bearer ${token}`;\r\n\t\t}\r\n\r\n\t\treturn config;\r\n\t},\r\n\t(error: AxiosError) => {\r\n\t\treturn Promise.reject(error);\r\n\t}\r\n);\r\n\r\n// Response interceptor\r\naxiosInstance.interceptors.response.use(\r\n\t(response: AxiosResponse) => {\r\n\t\treturn response;\r\n\t},\r\n\tasync (error: AxiosError) => {\r\n\t\tconst originalRequest = error.config as InternalAxiosRequestConfig & {\r\n\t\t\t_retry?: boolean;\r\n\t\t};\r\n\r\n\t\t// Handle 401 Unauthorized error (token expired)\r\n\t\tif (error.response?.status === 401 && !originalRequest._retry) {\r\n\t\t\t// Evitar múltiples solicitudes de refresh simultáneas\r\n\t\t\tif (isRefreshing) {\r\n\t\t\t\t// Esperar a que se complete el refresh actual\r\n\t\t\t\treturn new Promise((resolve) => {\r\n\t\t\t\t\tsubscribeTokenRefresh((token) => {\r\n\t\t\t\t\t\t// Reemplazar el token en la solicitud original\r\n\t\t\t\t\t\tif (originalRequest.headers) {\r\n\t\t\t\t\t\t\toriginalRequest.headers[\"Authorization\"] = `Bearer ${token}`;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tresolve(axiosInstance(originalRequest));\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\toriginalRequest._retry = true;\r\n\t\t\tisRefreshing = true;\r\n\r\n\t\t\ttry {\r\n\t\t\t\t// Attempt to refresh token\r\n\t\t\t\tconst refreshToken = localStorage.getItem(\r\n\t\t\t\t\tappConfig.storage.refreshTokenKey\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif (!refreshToken) {\r\n\t\t\t\t\tthrow new Error(\"No refresh token available\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst response = await axios.post(\r\n\t\t\t\t\t`${appConfig.api.baseUrl}/auth/refresh`,\r\n\t\t\t\t\t{},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\theaders: {\r\n\t\t\t\t\t\t\tAuthorization: `Bearer ${refreshToken}`,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif (response.data?.access_token) {\r\n\t\t\t\t\tconst newToken = response.data.access_token;\r\n\r\n\t\t\t\t\t// Save the new token\r\n\t\t\t\t\tlocalStorage.setItem(appConfig.storage.authTokenKey, newToken);\r\n\r\n\t\t\t\t\t// Update headers for future requests\r\n\t\t\t\t\taxiosInstance.defaults.headers.common[\"Authorization\"] =\r\n\t\t\t\t\t\t`Bearer ${newToken}`;\r\n\r\n\t\t\t\t\t// Notificar a todas las solicitudes pendientes\r\n\t\t\t\t\tonTokenRefreshed(newToken);\r\n\r\n\t\t\t\t\t// Update the header in the original request\r\n\t\t\t\t\tif (originalRequest.headers) {\r\n\t\t\t\t\t\toriginalRequest.headers[\"Authorization\"] = `Bearer ${newToken}`;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tisRefreshing = false;\r\n\r\n\t\t\t\t\t// Retry the original request\r\n\t\t\t\t\treturn axiosInstance(originalRequest);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow new Error(\"No access token in refresh response\");\r\n\t\t\t\t}\r\n\t\t\t} catch (refreshError) {\r\n\t\t\t\tisRefreshing = false;\r\n\r\n\t\t\t\t// Si falla el refresh, limpiar datos de sesión y redirigir a login\r\n\t\t\t\tlocalStorage.removeItem(appConfig.storage.authTokenKey);\r\n\t\t\t\tlocalStorage.removeItem(appConfig.storage.refreshTokenKey);\r\n\t\t\t\tlocalStorage.removeItem(appConfig.storage.userKey);\r\n\r\n\t\t\t\t// Usar window.location.replace para evitar entradas en el historial\r\n\t\t\t\twindow.location.replace(appConfig.routes.login);\r\n\r\n\t\t\t\treturn Promise.reject(refreshError);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Handle other errors\r\n\t\treturn Promise.reject(error);\r\n\t}\r\n);\r\n\r\nexport default axiosInstance;\r\n","// src/infrastructure/services/CacheService.ts (MEJORADO)\r\n\r\n/**\r\n * Servicio mejorado para gestionar caché en localStorage con expiración\r\n * y funcionalidades adicionales para evitar consultas repetitivas\r\n */\r\nexport class CacheService {\r\n\tprivate static readonly PREFIX = \"cache_\";\r\n\tprivate static readonly MAX_CACHE_SIZE = 50; // Máximo número de elementos en cache\r\n\r\n\t/**\r\n\t * Guarda un valor en cache con tiempo de expiración\r\n\t * @param key Clave para almacenar el valor\r\n\t * @param value Valor a almacenar\r\n\t * @param expirationMs Tiempo de expiración en milisegundos\r\n\t */\r\n\tstatic setItem(key: string, value: any, expirationMs: number): void {\r\n\t\ttry {\r\n\t\t\tconst item = {\r\n\t\t\t\tvalue,\r\n\t\t\t\texpiry: Date.now() + expirationMs,\r\n\t\t\t\tcreated: Date.now(),\r\n\t\t\t};\r\n\r\n\t\t\tconst fullKey = this.PREFIX + key;\r\n\t\t\tlocalStorage.setItem(fullKey, JSON.stringify(item));\r\n\r\n\t\t\t// Limpiar cache si está muy lleno\r\n\t\t\tthis.cleanupIfNeeded();\r\n\r\n\t\t\tconsole.log(\r\n\t\t\t\t`💾 Cache guardado: ${key} (expira en ${Math.round(expirationMs / 1000)}s)`\r\n\t\t\t);\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al guardar en caché:\", error);\r\n\t\t\t// Si hay error de espacio, limpiar cache antiguo e intentar de nuevo\r\n\t\t\tthis.clearExpired();\r\n\t\t\ttry {\r\n\t\t\t\tconst fullKey = this.PREFIX + key;\r\n\t\t\t\tlocalStorage.setItem(\r\n\t\t\t\t\tfullKey,\r\n\t\t\t\t\tJSON.stringify({\r\n\t\t\t\t\t\tvalue,\r\n\t\t\t\t\t\texpiry: Date.now() + expirationMs,\r\n\t\t\t\t\t\tcreated: Date.now(),\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t\t} catch (retryError) {\r\n\t\t\t\tconsole.error(\r\n\t\t\t\t\t\"Error al guardar en caché después de limpiar:\",\r\n\t\t\t\t\tretryError\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Recupera un valor de cache que no haya expirado\r\n\t * @param key Clave del valor a recuperar\r\n\t * @returns El valor almacenado o null si no existe o ha expirado\r\n\t */\r\n\tstatic getItem(key: string): any {\r\n\t\ttry {\r\n\t\t\tconst fullKey = this.PREFIX + key;\r\n\t\t\tconst itemStr = localStorage.getItem(fullKey);\r\n\r\n\t\t\tif (!itemStr) {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\tconst item = JSON.parse(itemStr);\r\n\r\n\t\t\t// Verificar si el ítem ha expirado\r\n\t\t\tif (Date.now() > item.expiry) {\r\n\t\t\t\tconsole.log(`🗑️ Cache expirado removido: ${key}`);\r\n\t\t\t\tlocalStorage.removeItem(fullKey);\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\tconsole.log(`✅ Cache hit: ${key}`);\r\n\t\t\treturn item.value;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al recuperar de caché:\", error);\r\n\t\t\t// Si hay error, remover el item corrupto\r\n\t\t\ttry {\r\n\t\t\t\tconst fullKey = this.PREFIX + key;\r\n\t\t\t\tlocalStorage.removeItem(fullKey);\r\n\t\t\t} catch (removeError) {\r\n\t\t\t\tconsole.error(\"Error al remover item corrupto:\", removeError);\r\n\t\t\t}\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Elimina un valor de caché\r\n\t * @param key Clave del valor a eliminar\r\n\t */\r\n\tstatic removeItem(key: string): void {\r\n\t\ttry {\r\n\t\t\tconst fullKey = this.PREFIX + key;\r\n\t\t\tlocalStorage.removeItem(fullKey);\r\n\t\t\tconsole.log(`🗑️ Cache removido: ${key}`);\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al eliminar de caché:\", error);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Verifica si una clave existe y no ha expirado\r\n\t * @param key Clave a verificar\r\n\t * @returns true si existe y no ha expirado, false en caso contrario\r\n\t */\r\n\tstatic hasValidItem(key: string): boolean {\r\n\t\treturn this.getItem(key) !== null;\r\n\t}\r\n\r\n\t/**\r\n\t * Obtiene múltiples elementos del cache de una vez\r\n\t * @param keys Array de claves a recuperar\r\n\t * @returns Objeto con las claves como propiedades y los valores como valores\r\n\t */\r\n\tstatic getMultiple(keys: string[]): Record<string, any> {\r\n\t\tconst result: Record<string, any> = {};\r\n\r\n\t\tkeys.forEach((key) => {\r\n\t\t\tconst value = this.getItem(key);\r\n\t\t\tif (value !== null) {\r\n\t\t\t\tresult[key] = value;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t}\r\n\r\n\t/**\r\n\t * Establece múltiples elementos en el cache de una vez\r\n\t * @param items Objeto con claves y valores a establecer\r\n\t * @param expirationMs Tiempo de expiración en milisegundos\r\n\t */\r\n\tstatic setMultiple(items: Record<string, any>, expirationMs: number): void {\r\n\t\tObject.entries(items).forEach(([key, value]) => {\r\n\t\t\tthis.setItem(key, value, expirationMs);\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Limpia todos los elementos expirados del cache\r\n\t */\r\n\tstatic clearExpired(): void {\r\n\t\ttry {\r\n\t\t\tconst now = Date.now();\r\n\t\t\tconst keysToRemove: string[] = [];\r\n\r\n\t\t\t// Buscar todas las claves de cache\r\n\t\t\tfor (let i = 0; i < localStorage.length; i++) {\r\n\t\t\t\tconst key = localStorage.key(i);\r\n\t\t\t\tif (key && key.startsWith(this.PREFIX)) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tconst itemStr = localStorage.getItem(key);\r\n\t\t\t\t\t\tif (itemStr) {\r\n\t\t\t\t\t\t\tconst item = JSON.parse(itemStr);\r\n\t\t\t\t\t\t\tif (now > item.expiry) {\r\n\t\t\t\t\t\t\t\tkeysToRemove.push(key);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\t// Si hay error al parsear, marcar para eliminar\r\n\t\t\t\t\t\tkeysToRemove.push(key);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Remover elementos expirados\r\n\t\t\tkeysToRemove.forEach((key) => {\r\n\t\t\t\tlocalStorage.removeItem(key);\r\n\t\t\t});\r\n\r\n\t\t\tif (keysToRemove.length > 0) {\r\n\t\t\t\tconsole.log(\r\n\t\t\t\t\t`🗑️ Cache: ${keysToRemove.length} elementos expirados eliminados`\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al limpiar cache expirado:\", error);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Limpia todo el cache (solo elementos de este servicio)\r\n\t */\r\n\tstatic clearAll(): void {\r\n\t\ttry {\r\n\t\t\tconst keysToRemove: string[] = [];\r\n\r\n\t\t\t// Buscar todas las claves de cache\r\n\t\t\tfor (let i = 0; i < localStorage.length; i++) {\r\n\t\t\t\tconst key = localStorage.key(i);\r\n\t\t\t\tif (key && key.startsWith(this.PREFIX)) {\r\n\t\t\t\t\tkeysToRemove.push(key);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Remover todos los elementos de cache\r\n\t\t\tkeysToRemove.forEach((key) => {\r\n\t\t\t\tlocalStorage.removeItem(key);\r\n\t\t\t});\r\n\r\n\t\t\tconsole.log(\r\n\t\t\t\t`🗑️ Cache: ${keysToRemove.length} elementos eliminados completamente`\r\n\t\t\t);\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al limpiar todo el cache:\", error);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Obtiene estadísticas del cache\r\n\t */\r\n\tstatic getStats(): {\r\n\t\ttotal: number;\r\n\t\texpired: number;\r\n\t\tactive: number;\r\n\t\ttotalSize: number; // en caracteres aproximados\r\n\t} {\r\n\t\ttry {\r\n\t\t\tconst now = Date.now();\r\n\t\t\tlet total = 0;\r\n\t\t\tlet expired = 0;\r\n\t\t\tlet active = 0;\r\n\t\t\tlet totalSize = 0;\r\n\r\n\t\t\tfor (let i = 0; i < localStorage.length; i++) {\r\n\t\t\t\tconst key = localStorage.key(i);\r\n\t\t\t\tif (key && key.startsWith(this.PREFIX)) {\r\n\t\t\t\t\ttotal++;\r\n\t\t\t\t\tconst itemStr = localStorage.getItem(key);\r\n\t\t\t\t\tif (itemStr) {\r\n\t\t\t\t\t\ttotalSize += itemStr.length;\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tconst item = JSON.parse(itemStr);\r\n\t\t\t\t\t\t\tif (now > item.expiry) {\r\n\t\t\t\t\t\t\t\texpired++;\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tactive++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\t\texpired++; // Considerar items corruptos como expirados\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn {total, expired, active, totalSize};\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al obtener estadísticas del cache:\", error);\r\n\t\t\treturn {total: 0, expired: 0, active: 0, totalSize: 0};\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Limpia el cache si está muy lleno (uso interno)\r\n\t */\r\n\tprivate static cleanupIfNeeded(): void {\r\n\t\ttry {\r\n\t\t\tconst stats = this.getStats();\r\n\r\n\t\t\t// Si hay demasiados elementos, limpiar expirados\r\n\t\t\tif (stats.total > this.MAX_CACHE_SIZE) {\r\n\t\t\t\tthis.clearExpired();\r\n\r\n\t\t\t\t// Si aún hay demasiados, eliminar los más antiguos\r\n\t\t\t\tconst newStats = this.getStats();\r\n\t\t\t\tif (newStats.active > this.MAX_CACHE_SIZE * 0.8) {\r\n\t\t\t\t\tthis.clearOldest(Math.floor(this.MAX_CACHE_SIZE * 0.2));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error en limpieza automática del cache:\", error);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Elimina los elementos más antiguos del cache\r\n\t * @param count Número de elementos a eliminar\r\n\t */\r\n\tprivate static clearOldest(count: number): void {\r\n\t\ttry {\r\n\t\t\tconst items: Array<{key: string; created: number}> = [];\r\n\r\n\t\t\t// Recopilar todos los elementos con sus fechas de creación\r\n\t\t\tfor (let i = 0; i < localStorage.length; i++) {\r\n\t\t\t\tconst key = localStorage.key(i);\r\n\t\t\t\tif (key && key.startsWith(this.PREFIX)) {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\tconst itemStr = localStorage.getItem(key);\r\n\t\t\t\t\t\tif (itemStr) {\r\n\t\t\t\t\t\t\tconst item = JSON.parse(itemStr);\r\n\t\t\t\t\t\t\titems.push({key, created: item.created || 0});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch (error) {\r\n\t\t\t\t\t\t// Items corruptos también se pueden eliminar\r\n\t\t\t\t\t\titems.push({key, created: 0});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Ordenar por fecha de creación (más antiguos primero)\r\n\t\t\titems.sort((a, b) => a.created - b.created);\r\n\r\n\t\t\t// Eliminar los más antiguos\r\n\t\t\tconst toRemove = items.slice(0, count);\r\n\t\t\ttoRemove.forEach((item) => {\r\n\t\t\t\tlocalStorage.removeItem(item.key);\r\n\t\t\t});\r\n\r\n\t\t\tif (toRemove.length > 0) {\r\n\t\t\t\tconsole.log(\r\n\t\t\t\t\t`🗑️ Cache: ${toRemove.length} elementos antiguos eliminados`\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al eliminar elementos antiguos del cache:\", error);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Función de utilidad para debug - muestra el contenido del cache\r\n\t */\r\n\tstatic debug(): void {\r\n\t\tconst stats = this.getStats();\r\n\t\tconsole.group(\"📊 Cache Debug Info\");\r\n\t\tconsole.log(\"Estadísticas:\", stats);\r\n\r\n\t\tconst items: Array<{key: string; expiry: number; size: number}> = [];\r\n\r\n\t\tfor (let i = 0; i < localStorage.length; i++) {\r\n\t\t\tconst key = localStorage.key(i);\r\n\t\t\tif (key && key.startsWith(this.PREFIX)) {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst itemStr = localStorage.getItem(key);\r\n\t\t\t\t\tif (itemStr) {\r\n\t\t\t\t\t\tconst item = JSON.parse(itemStr);\r\n\t\t\t\t\t\titems.push({\r\n\t\t\t\t\t\t\tkey: key.replace(this.PREFIX, \"\"),\r\n\t\t\t\t\t\t\texpiry: item.expiry,\r\n\t\t\t\t\t\t\tsize: itemStr.length,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\titems.push({\r\n\t\t\t\t\t\tkey: key.replace(this.PREFIX, \"\"),\r\n\t\t\t\t\t\texpiry: 0,\r\n\t\t\t\t\t\tsize: 0,\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconsole.table(items);\r\n\t\tconsole.groupEnd();\r\n\t}\r\n}\r\n\r\nexport default CacheService;\r\n","/**\r\n * API endpoints for Comersia Backend\r\n * Base URL configured in environment.ts\r\n */\r\n\r\nexport const API_ENDPOINTS = {\r\n  // Auth\r\n  AUTH: {\r\n    LOGIN: \"/auth/login\",\r\n    LOGOUT: \"/auth/logout\",\r\n    REFRESH: \"/auth/refresh\",\r\n    REGISTER: \"/auth/register\",\r\n    FORGOT_PASSWORD_EMAIL: \"/auth/forgot-password-email\",\r\n    FORGOT_PASSWORD_TOKEN: \"/auth/forgot-password-token\",\r\n    RESET_PASSWORD: \"/auth/reset-password\",\r\n    VALIDATE_RESET_TOKEN: \"/auth/reset-password/validate\",\r\n    ME: \"/auth/me\",\r\n    UPDATE_PASSWORD: \"/auth/password/update\",\r\n    VERIFY_EMAIL: (id: string | number, hash: string) =>\r\n      `/email/verify/${id}/${hash}`,\r\n    // New email verification system\r\n    VERIFY_EMAIL_TOKEN: \"/email-verification/verify\",\r\n    RESEND_VERIFICATION: \"/email-verification/resend\",\r\n    VERIFICATION_STATUS: \"/email-verification/status\",\r\n    CHECK_ROLE: \"/user/check-role\",\r\n    PASSWORD_VALIDATION_RULES: \"/auth/password-validation-rules\",\r\n  },\r\n\r\n  PROFILE: {\r\n    LIST: \"/profile\",\r\n    UPDATE: \"/profile\",\r\n    GET: '/profile',\r\n    CHANGE_PASSWORD: '/profile/change-password',\r\n    UPLOAD_AVATAR: '/profile/upload-avatar',\r\n  },\r\n\r\n  USER: {\r\n    ORDERS: \"/user/orders\",\r\n    ORDER_DETAILS: (id: number) => `/user/orders/${id}`,\r\n    ORDER_STATS: \"/user/orders/stats\",\r\n    REORDER: (id: number) => `/user/orders/${id}/reorder`,\r\n    CONFIRM_RECEPTION: (id: number) => `/user/orders/${id}/confirm-reception`,\r\n  },\r\n\r\n  HEADER_COUNTERS: \"/user/header-counters\",\r\n\r\n  // Products\r\n  PRODUCTS: {\r\n    LIST: \"/products\",\r\n    DETAILS: (id: string | number) => `/products/${id}`,\r\n    DETAILS_BY_SLUG: (slug: string) => `/products/slug/${slug}`,\r\n    FEATURED: \"/products/featured\",\r\n    FEATURED_RANDOM: \"/products/featured-random\",\r\n    TRENDING_OFFERS: \"/products/trending-offers\",\r\n    PERSONALIZED: \"/products/personalized\",\r\n    DISCOUNTED: \"/products/discounted\",\r\n    NEWEST: \"/products/newest\",\r\n    POPULAR: \"/products/popular\",\r\n    BY_CATEGORY: (categoryId: string | number) =>\r\n      `/products/category/${categoryId}`,\r\n    BY_TAGS: \"/products/tags\",\r\n    BY_SELLER: (sellerId: string | number) => `/products/seller/${sellerId}`,\r\n    SEARCH: (term?: string) => `/products/search/${term || \"\"}`,\r\n    CREATE: \"/products\",\r\n    UPDATE: (id: string | number) => `/products/${id}`,\r\n    DELETE: (id: string | number) => `/products/${id}`,\r\n    INCREMENT_VIEW: (id: string | number) => `/products/${id}/view`,\r\n  },\r\n\r\n  // Categories\r\n  CATEGORIES: {\r\n    LIST: \"/categories\",\r\n    MAIN: \"/categories/main\",\r\n    FEATURED: \"/categories/featured\",\r\n    SUBCATEGORIES: (id: string | number) => `/categories/${id}/subcategories`,\r\n    PRODUCTS: (id: string | number) => `/categories/${id}/products`,\r\n    SLUG: (slug: string) => `/categories/slug/${slug}`,\r\n    DETAILS: (id: string | number) => `/categories/${id}`,\r\n    CREATE: \"/admin/categories\",\r\n    UPDATE: (id: string | number) => `/admin/categories/${id}`,\r\n    DELETE: (id: string | number) => `/admin/categories/${id}`,\r\n  },\r\n\r\n  // Cart\r\n  CART: {\r\n    GET: \"/cart\",\r\n    ADD_ITEM: \"/cart/items\",\r\n    UPDATE_ITEM: (itemId: string | number) => `/cart/items/${itemId}`,\r\n    REMOVE_ITEM: (itemId: string | number) => `/cart/items/${itemId}`,\r\n    EMPTY: \"/cart/empty\",\r\n    VOLUME_DISCOUNT_INFO: (productId: string | number) =>\r\n      `/cart/volume-discount-info/${productId}`,\r\n    // ✅ NUEVO: Endpoints para códigos de descuento del carrito\r\n    DISCOUNT: {\r\n      VALIDATE: \"/cart/discount/validate\",\r\n      APPLY: \"/cart/discount/apply\", \r\n      REMOVE: \"/cart/discount/remove\",\r\n    },\r\n  },\r\n\r\n  // ✅ NUEVO: Volume Discounts\r\n  VOLUME_DISCOUNTS: {\r\n    PRODUCT_INFO: (productId: string | number) =>\r\n      `/volume-discounts/product/${productId}`,\r\n    ADMIN: {\r\n      CONFIGURATION: \"/admin/volume-discounts/configuration\",\r\n      STATS: \"/admin/volume-discounts/stats\",\r\n      PRODUCT_DISCOUNTS: (productId: string | number) =>\r\n        `/admin/volume-discounts/product/${productId}`,\r\n      APPLY_DEFAULTS: (productId: string | number) =>\r\n        `/admin/volume-discounts/product/${productId}/apply-defaults`,\r\n      REMOVE_PRODUCT: (productId: string | number) =>\r\n        `/admin/volume-discounts/product/${productId}`,\r\n      BULK_APPLY: \"/admin/volume-discounts/bulk/apply-defaults\",\r\n    },\r\n  },\r\n\r\n  // Checkout\r\n  CHECKOUT: {\r\n    PROCESS: \"/checkout\",\r\n  },\r\n\r\n  // Orders\r\n  ORDERS: {\r\n    LIST: \"/orders\",\r\n    DETAILS: (id: number) => `/orders/${id}`,\r\n    CREATE: `/orders`,\r\n    UPDATE: (id: number) => `/orders/${id}`,\r\n    SELLER_ORDERS: \"/seller/orders\",\r\n    SELLER_ORDER_DETAILS: (id: number) => `/seller/orders/${id}`,\r\n    SELLER_ORDER_ITEMS: (id: number) => `/seller/orders/${id}/items`,\r\n    STATS: \"/seller/orders/stats\",\r\n    UPDATE_STATUS: (id: number) => `/seller/orders/${id}/status`,\r\n    UPDATE_SHIPPING: (id: number) => `/seller/orders/${id}/shipping`,\r\n    CANCEL: (id: number) => `/seller/orders/${id}/cancel`,\r\n    COMPLETE: (id: number) => `/seller/orders/${id}/complete`,\r\n    AWAITING_SHIPMENT: \"/seller/orders/awaiting-shipment\",\r\n    CUSTOMERS: \"/seller/orders/customers\",\r\n    WITH_PRODUCT: (productId: number) => `/seller/orders/product/${productId}`,\r\n  },\r\n\r\n  // Payments\r\n  PAYMENTS: {\r\n    CREDIT_CARD: \"/payments/credit-card\",\r\n    PAYPAL: \"/payments/paypal\",\r\n    QR: \"/payments/qr\",\r\n  },\r\n\r\n  // Invoices\r\n  INVOICES: {\r\n    LIST: \"/invoices\",\r\n    DETAILS: (id: string | number) => `/invoices/${id}`,\r\n    GENERATE: \"/invoices/generate\",\r\n    CANCEL: (id: string | number) => `/invoices/${id}/cancel`,\r\n    DOWNLOAD: (id: string | number) => `/invoices/${id}/download`,\r\n  },\r\n\r\n  SELLER: {\r\n    REGISTER: \"/seller/register\",\r\n    INFO: \"/seller/info\",\r\n    UPDATE_STORE_INFO: \"/seller/store-info\",\r\n    DASHBOARD: \"/seller/dashboard\",\r\n    TOP_RATING: \"/sellers/top/rating\",\r\n    TOP_SALES: \"/sellers/top/sales\",\r\n    FEATURED: \"/sellers/featured\",\r\n  },\r\n\r\n  // Ratings\r\n  RATINGS: {\r\n    PRODUCT: (productId: string | number) => `/ratings/product/${productId}`,\r\n    SELLER: (sellerId: string | number) => `/ratings/seller/${sellerId}`,\r\n    RATE_PRODUCT: \"/ratings/product\",\r\n    RATE_SELLER: \"/ratings/seller\",\r\n    RATE_USER: \"/ratings/user\",\r\n    MY_GIVEN: \"/ratings/my/given\",\r\n    MY_RECEIVED: \"/ratings/my/received\",\r\n    PENDING: \"/ratings/pending\",\r\n    REPLY: \"/ratings/reply\",\r\n    REPORT: \"/ratings/report\",\r\n    REPORT_PROBLEM: \"/ratings/report-problem\",\r\n    DETAILS: (id: string | number) => `/ratings/${id}`,\r\n    ORDER_RATINGS: (orderId: string | number) => `/ratings/order/${orderId}`,\r\n  },\r\n\r\n  // Shipping\r\n  SHIPPING: {\r\n    TRACK: (trackingNumber: string) => `/shipping/track/${trackingNumber}`,\r\n    HISTORY: (trackingNumber: string) => `/shipping/${trackingNumber}/history`,\r\n    ROUTE: (trackingNumber: string) => `/shipping/${trackingNumber}/route`,\r\n    ESTIMATE: \"/shipping/estimate\",\r\n    UPDATE_STATUS: `/shipping/update-status`,\r\n    EXTERNAL_UPDATE: `/shipping/external-status-update`,\r\n\r\n    SELLER: {\r\n      LIST: \"/seller/shipping\",\r\n      DETAIL: (id: string | number) => `/seller/shipping/${id}`,\r\n      UPDATE_STATUS: (id: string | number) => `/seller/shipping/${id}/status`,\r\n\t  HISTORY: (trackingNumber: string) => `/api/shipping/track/${trackingNumber}/history`,\r\n    ROUTE: (trackingNumber: string) => `/api/shipping/track/${trackingNumber}/route`,\r\n    },\r\n\r\n    // Simulación (solo desarrollo)\r\n    SIMULATE_EVENTS: (trackingNumber: string) =>\r\n      `/shipping/${trackingNumber}/simulate`,\r\n    SIMULATE_API: `/shipping-api/status-update`,\r\n    SIMULATE_CYCLE: (trackingNumber: string) =>\r\n      `/shipping-api/${trackingNumber}/simulate-cycle`,\r\n  },\r\n\r\n  // Chat\r\n  CHAT: {\r\n    LIST: \"/chats\",\r\n    DETAILS: (id: number) => `/chats/${id}`,\r\n    CREATE: \"/chats\",\r\n    SEND_MESSAGE: (id: number) => `/chats/${id}/messages`,\r\n    UPDATE_STATUS: (id: number) => `/chats/${id}`,\r\n    DELETE: (id: number) => `/chats/${id}`,\r\n    GET_MESSAGES: (id: number) => `/chats/${id}/messages`,\r\n    MARK_ALL_READ: (id: number) => `/chats/${id}/mark-read`,\r\n    MARK_MESSAGE_READ: (id: number, messageId: number) =>\r\n      `/chats/${id}/messages/${messageId}/read`,\r\n    SELLER: {\r\n      LIST: \"/seller/chats\",\r\n      DETAILS: (id: number) => `/seller/chats/${id}`,\r\n      LIST_BY_SELLER: (id: number) => `/seller/chats/by-seller/${id}`,\r\n      SEND_MESSAGE: (id: number) => `/seller/chats/${id}/messages`,\r\n      UPDATE_STATUS: (id: number) => `/seller/chats/${id}`,\r\n      GET_MESSAGES: (id: number) => `/seller/chats/${id}/messages`,\r\n      MARK_ALL_READ: (id: number) => `/seller/chats/${id}/mark-read`,\r\n    },\r\n  },\r\n\r\n  // Recommendations\r\n  RECOMMENDATIONS: {\r\n    GET: \"/recommendations\",\r\n    TRACK_INTERACTION: \"/recommendations/track-interaction\",\r\n    USER_PROFILE: \"/recommendations/user-profile\",\r\n  },\r\n\r\n  // Favorites\r\n  FAVORITES: {\r\n    LIST: \"/favorites\",\r\n    TOGGLE: \"/favorites/toggle\",\r\n    CHECK: (productId: string | number) => `/favorites/product/${productId}`,\r\n    UPDATE_NOTIFICATIONS: (id: string | number) =>\r\n      `/favorites/${id}/notifications`,\r\n  },\r\n\r\n  // Feedback\r\n  FEEDBACK: {\r\n    LIST: \"/feedback\",\r\n    DETAILS: (id: string | number) => `/feedback/${id}`,\r\n    CREATE: \"/feedback\",\r\n  },\r\n\r\n  // Discounts\r\n  DISCOUNTS: {\r\n    VALIDATE: \"/discounts/validate\",\r\n    APPLY: \"/discounts/apply\",\r\n    MY_CODES: \"/discounts/my-codes\",\r\n  },\r\n\r\n  // Notifications\r\n  NOTIFICATIONS: {\r\n    LIST: \"/notifications\",\r\n    UNREAD: \"/notifications/unread\",\r\n    COUNT: \"/notifications/count\",\r\n    MARK_AS_READ: (id: string | number) => `/notifications/${id}/read`,\r\n    MARK_ALL_AS_READ: \"/notifications/read-all\",\r\n    DELETE: (id: string | number) => `/notifications/${id}`,\r\n  },\r\n\r\n  // Accounting (Admin only)\r\n  ACCOUNTING: {\r\n    BALANCE_SHEET: \"/accounting/balance-sheet\",\r\n    INCOME_STATEMENT: \"/accounting/income-statement\",\r\n    ACCOUNTS: \"/accounting/accounts\",\r\n    ACCOUNT_LEDGER: (id: string | number) =>\r\n      `/accounting/accounts/${id}/ledger`,\r\n  },\r\n\r\n  // Admin\r\n  ADMIN: {\r\n    // Users management\r\n    USERS: \"/admin/users\",\r\n    USER_DETAIL: (id: number) => `/admin/users/${id}`,\r\n    BLOCK_USER: (id: number) => `/admin/users/${id}/block`,\r\n    UNBLOCK_USER: (id: number) => `/admin/users/${id}/unblock`,\r\n    RESET_PASSWORD: (id: number) => `/admin/users/${id}/reset-password`,\r\n    MAKE_ADMIN: (id: number) => `/admin/users/${id}/make-admin`,\r\n    MAKE_SELLER: (id: number) => `/admin/users/${id}/make-seller`,\r\n    DELETE_USER: (id: number) => `/admin/users/${id}`,\r\n\r\n    DASHBOARD: \"/admin/dashboard\",\r\n    // Sellers management\r\n    SELLERS: \"/admin/sellers\",\r\n    SELLER_STATUS: (id: string | number) => `/admin/sellers/${id}/status`,\r\n    CREATE_SELLER: \"/admin/sellers\",\r\n    UPDATE_SELLER: (id: string | number) => `/admin/sellers/${id}`,\r\n    // Ratings moderation\r\n    PENDING_RATINGS: \"/admin/ratings/pending\",\r\n    MODERATE_RATING: (id: string | number) => `/admin/ratings/${id}/moderate`,\r\n    DELETE_RATING: (id: string | number) => `/admin/ratings/${id}`,\r\n    // Orders\r\n    ORDERS: \"/admin/orders\",\r\n    ORDER_DETAIL: (id: number) => `/admin/orders/${id}`,\r\n    ORDER_STATS: \"/admin/orders/stats\",\r\n    UPDATE_ORDER_STATUS: (id: number) => `/admin/orders/${id}/status`,\r\n    CANCEL_ORDER: (id: number) => `/admin/orders/${id}/cancel`,\r\n\r\n    // Shipping\r\n    SHIPPING_LIST: \"/admin/shippings\",\r\n    SHIPPING_DETAIL: (id: number) => `/admin/shippings/${id}`,\r\n    SHIPPING_HISTORY: (trackingNumber: string) =>\r\n      `/admin/shipping/${trackingNumber}/history`,\r\n    UPDATE_SHIPPING: (id: number) => `/admin/orders/${id}/shipping`,\r\n    UPDATE_SHIPPING_STATUS: (trackingNumber: string) =>\r\n      `/admin/shipping/${trackingNumber}/status`,\r\n    SIMULATE_SHIPPING: (trackingNumber: string) =>\r\n      `/admin/shipping/${trackingNumber}/simulate`,\r\n    SHIPPING_SEND_NOTIFICATION: (trackingNumber: string) =>\r\n      `/admin/shipping/${trackingNumber}/notify`,\r\n    // Admin management (super admin only)\r\n    ADMINS: \"/admin/admins\",\r\n    MANAGE_ADMIN: \"/admin/admins\",\r\n    REMOVE_ADMIN: (userId: string | number) => `/admin/admins/${userId}`,\r\n    // Feedback\r\n    PENDING_FEEDBACK: \"/admin/feedback/pending\",\r\n    REVIEW_FEEDBACK: (id: string | number) => `/admin/feedback/${id}/review`,\r\n    RATINGS: {\r\n      LIST: \"/admin/ratings\",\r\n      STATS: \"/admin/ratings/stats\",\r\n      PENDING: \"/admin/ratings/pending\",\r\n      MODERATE: (id: string | number) => `/admin/ratings/${id}/moderate`,\r\n      APPROVE: (id: number) => `/admin/ratings/${id}/approve`,\r\n      REJECT: (id: number) => `/admin/ratings/${id}/reject`,\r\n      FLAG: (id: number) => `/admin/ratings/${id}/flag`,\r\n      APPROVE_ALL: \"/admin/ratings/approve-all\",\r\n      DELETE: (id: string | number) => `/admin/ratings/${id}`,\r\n    },\r\n    CONFIGURATIONS: {\r\n      BASE: \"/admin/configurations\",\r\n      INDEX: \"/admin/configurations\",\r\n      SHOW: (key: string) => `/admin/configurations/${key}`,\r\n      UPDATE: \"/admin/configurations/update\",\r\n      RATINGS: \"/admin/configurations/ratings\",\r\n      SHIPPING: \"/admin/configurations/shipping\",\r\n      DEVELOPMENT: \"/admin/configurations/development\",\r\n      MAIL: \"/admin/configurations/mail\",\r\n      MAIL_TEST: \"/admin/configurations/mail/test\",\r\n      MAIL_SEND_CUSTOM: \"/admin/configurations/mail/send-custom\",\r\n      PASSWORD_VALIDATION_RULES: \"/admin/configurations/password-validation-rules\",\r\n      FINANCIAL: \"/admin/configurations/financial\", // ⚠️ Configuraciones financieras críticas\r\n    },\r\n    // 🔧 JORDAN FASE 1: Endpoints públicos de configuración (CORREGIDOS + TAX AGREGADO)\r\n    PUBLIC_CONFIGURATIONS: {\r\n      PLATFORM_COMMISSION: \"/configurations/platform-commission-public\", // ✅ Existe en backend\r\n      SHIPPING: \"/configurations/shipping-public\",          // ✅ Existe en backend (corregido)\r\n      VOLUME_DISCOUNTS: \"/configurations/volume-discounts-public\", // ✅ Existe en backend\r\n      SHIPPING_DISTRIBUTION: \"/configurations/shipping-distribution-public\", // ✅ Existe en backend\r\n      TAX: \"/configurations/tax-public\", // ✅ JORDAN: Tax rate dinámico agregado\r\n      \r\n      // 🎯 ENDPOINT UNIFICADO: Todas las configuraciones en una sola llamada (Optimización)\r\n      UNIFIED: \"/configurations/unified\", // ✅ NUEVO: Reemplaza 5 endpoints por 1\r\n    },\r\n    CATEGORIES: {\r\n      LIST: \"/categories\", // Admin usa la misma lista pública\r\n      DETAILS: (id: string | number) => `/categories/${id}`,\r\n      CREATE: \"/admin/categories\", // RUTA ADMIN ESPECÍFICA\r\n      UPDATE: (id: string | number) => `/admin/categories/${id}`, // RUTA ADMIN ESPECÍFICA\r\n      PARTIAL_UPDATE: (id: string | number) => `/admin/categories/${id}`, // PATCH\r\n      DELETE: (id: string | number) => `/admin/categories/${id}`, // RUTA ADMIN ESPECÍFICA\r\n    },\r\n    PRODUCTS: {\r\n      LIST: \"/admin/products\", // NUEVA RUTA: Admin con datos completos\r\n      DETAILS: (id: string | number) => `/products/${id}`,\r\n      CREATE: \"/admin/products\", // RUTA ADMIN ESPECÍFICA\r\n      UPDATE: (id: string | number) => `/admin/products/${id}`, // RUTA ADMIN ESPECÍFICA\r\n      PARTIAL_UPDATE: (id: string | number) => `/admin/products/${id}`, // PATCH\r\n      DELETE: (id: string | number) => `/admin/products/${id}`, // RUTA ADMIN ESPECÍFICA\r\n      STATS: \"/admin/products/stats\",\r\n    },\r\n    // ✅ NUEVO: Volume Discounts Administration\r\n    VOLUME_DISCOUNTS: {\r\n      CONFIGURATION: \"/admin/volume-discounts/configuration\",\r\n      STATS: \"/admin/volume-discounts/stats\",\r\n      PRODUCT_DISCOUNTS: (productId: string | number) =>\r\n        `/admin/volume-discounts/product/${productId}`,\r\n      UPDATE_PRODUCT: (productId: string | number) =>\r\n        `/admin/volume-discounts/product/${productId}`,\r\n      APPLY_DEFAULTS: (productId: string | number) =>\r\n        `/admin/volume-discounts/product/${productId}/apply-defaults`,\r\n      REMOVE_PRODUCT: (productId: string | number) =>\r\n        `/admin/volume-discounts/product/${productId}`,\r\n      BULK_APPLY: \"/admin/volume-discounts/bulk/apply-defaults\",\r\n    },\r\n    \r\n    // ✅ NUEVO: Admin Discount Codes Management\r\n    DISCOUNT_CODES: {\r\n      LIST: \"/admin/discount-codes\",\r\n      STATS: \"/admin/discount-codes/stats\",\r\n      GENERATE_CODE: \"/admin/discount-codes/generate-code\",\r\n      CREATE: \"/admin/discount-codes\",\r\n      DETAILS: (id: string | number) => `/admin/discount-codes/${id}`,\r\n      UPDATE: (id: string | number) => `/admin/discount-codes/${id}`,\r\n      DELETE: (id: string | number) => `/admin/discount-codes/${id}`,\r\n      VALIDATE: \"/admin/discount-codes/validate\",\r\n      APPLY: \"/admin/discount-codes/apply\",\r\n    },\r\n  },\r\n\r\n  // Development & Testing\r\n  DEV: {\r\n    SHIPPING_TRACK: (trackingNumber: string) =>\r\n      `/simulator/shipping/track/${trackingNumber}`,\r\n    SHIPPING_UPDATE: \"/simulator/shipping/simulate-update\",\r\n    SHIPPING_CYCLE: (trackingNumber: string) =>\r\n      `/simulator/shipping/simulate-cycle/${trackingNumber}`,\r\n  },\r\n\r\n  SELLERS: {\r\n    BY_USER_ID: (userId: number) => `/sellers/by-user/${userId}`,\r\n    ACTIVE: \"/sellers/active\",\r\n  },\r\n\r\n  DATAFAST: {\r\n    CREATE_CHECKOUT: \"/datafast/create-checkout\",\r\n    VERIFY_PAYMENT: \"/datafast/verify-payment\",\r\n    WEBHOOK: \"/datafast/webhook\",\r\n  },\r\n};\r\n\r\nexport default API_ENDPOINTS;","import axios from \"axios\";\r\nimport type {AxiosRequestConfig, AxiosResponse} from \"axios\";\r\nimport axiosInstance from \"./axiosConfig\";\r\n\r\n/**\r\n * Base API client para realizar peticiones HTTP\r\n * Con mejoras para manejar diferentes estructuras de respuesta\r\n */\r\nexport class ApiClient {\r\n\t/**\r\n\t * Realizar petición GET\r\n\t * @param url - URL del endpoint de la API\r\n\t * @param params - Parámetros de consulta\r\n\t * @param config - Configuración adicional de axios\r\n\t */\r\n\tpublic static async get<T>(\r\n\t\turl: string,\r\n\t\tparams?: any,\r\n\t\tconfig?: AxiosRequestConfig\r\n\t): Promise<T> {\r\n\t\ttry {\r\n\t\t\t// Transformar parámetros camelCase a snake_case para API\r\n\t\t\tconst transformedParams = this.transformParamsToSnakeCase(params);\r\n\r\n\t\t\tconst response: AxiosResponse = await axiosInstance.get(url, {\r\n\t\t\t\tparams: transformedParams,\r\n\t\t\t\t...config,\r\n\t\t\t});\r\n\r\n\t\t\t// Response received successfully\r\n\r\n\t\t\t// Validar y transformar la respuesta\r\n\t\t\treturn this.handleApiResponse<T>(response);\r\n\t\t} catch (error) {\r\n\t\t\tthis.handleApiError(error, url, \"GET\");\r\n\t\t\tthrow error;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Realizar petición POST\r\n\t * @param url - URL del endpoint de la API\r\n\t * @param data - Datos del cuerpo de la petición\r\n\t * @param config - Configuración adicional de axios\r\n\t */\r\n\tpublic static async post<T>(\r\n    url: string,\r\n    data?: any,\r\n    config?: AxiosRequestConfig\r\n): Promise<T> {\r\n    try {\r\n        // POST request\r\n\r\n        // ✅ ARREGLADO: NO transformar FormData\r\n        const transformedData = data instanceof FormData \r\n            ? data  // FormData se mantiene tal como está\r\n            : data ? this.transformDataToSnakeCase(data) : undefined;\r\n\r\n        // Debug: Log data transformation for Deuna payments\r\n        if (url.includes('/deuna/payments')) {\r\n            console.log('🔍 API CLIENT - DATA TRANSFORMATION:', {\r\n                original_data: data,\r\n                transformed_data: transformedData,\r\n                original_items: data?.items,\r\n                transformed_items: transformedData?.items,\r\n                original_first_item: data?.items?.[0],\r\n                transformed_first_item: transformedData?.items?.[0]\r\n            });\r\n        }\r\n\r\n        // FormData is sent without transformation\r\n\r\n        const response: AxiosResponse = await axiosInstance.post(\r\n            url,\r\n            transformedData,\r\n            config\r\n        );\r\n\r\n        // POST response received\r\n\r\n        // Validar y transformar la respuesta\r\n        return this.handleApiResponse<T>(response);\r\n    } catch (error) {\r\n        this.handleApiError(error, url, \"POST\");\r\n        throw error;\r\n    }\r\n}\r\n\r\n\t/**\r\n\t * Realizar petición PUT\r\n\t * @param url - URL del endpoint de la API\r\n\t * @param data - Datos del cuerpo de la petición\r\n\t * @param config - Configuración adicional de axios\r\n\t */\r\n\tpublic static async put<T>(\r\n\t\turl: string,\r\n\t\tdata?: any,\r\n\t\tconfig?: AxiosRequestConfig\r\n\t): Promise<T> {\r\n\t\ttry {\r\n\t\t\t// Transformar datos de camelCase a snake_case\r\n\t\t\tconst transformedData = data\r\n\t\t\t\t? this.transformDataToSnakeCase(data)\r\n\t\t\t\t: undefined;\r\n\r\n\t\t\tconst response: AxiosResponse = await axiosInstance.put(\r\n\t\t\t\turl,\r\n\t\t\t\ttransformedData,\r\n\t\t\t\tconfig\r\n\t\t\t);\r\n\r\n\t\t\t// Validar y transformar la respuesta\r\n\t\t\treturn this.handleApiResponse<T>(response);\r\n\t\t} catch (error) {\r\n\t\t\tthis.handleApiError(error, url, \"PUT\");\r\n\t\t\tthrow error;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Realizar petición PATCH\r\n\t * @param url - URL del endpoint de la API\r\n\t * @param data - Datos del cuerpo de la petición\r\n\t * @param config - Configuración adicional de axios\r\n\t */\r\n\tpublic static async patch<T>(\r\n\t\turl: string,\r\n\t\tdata?: any,\r\n\t\tconfig?: AxiosRequestConfig\r\n\t): Promise<T> {\r\n\t\ttry {\r\n\t\t\t// Transformar datos de camelCase a snake_case\r\n\t\t\tconst transformedData = data\r\n\t\t\t\t? this.transformDataToSnakeCase(data)\r\n\t\t\t\t: undefined;\r\n\r\n\t\t\tconst response: AxiosResponse = await axiosInstance.patch(\r\n\t\t\t\turl,\r\n\t\t\t\ttransformedData,\r\n\t\t\t\tconfig\r\n\t\t\t);\r\n\r\n\t\t\t// Validar y transformar la respuesta\r\n\t\t\treturn this.handleApiResponse<T>(response);\r\n\t\t} catch (error) {\r\n\t\t\tthis.handleApiError(error, url, \"PATCH\");\r\n\t\t\tthrow error;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Realizar petición DELETE\r\n\t * @param url - URL del endpoint de la API\r\n\t * @param config - Configuración adicional de axios\r\n\t */\r\n\tpublic static async delete<T>(\r\n\t\turl: string,\r\n\t\tconfig?: AxiosRequestConfig\r\n\t): Promise<T> {\r\n\t\ttry {\r\n\t\t\tconst response: AxiosResponse = await axiosInstance.delete(url, config);\r\n\r\n\t\t\t// Validar y transformar la respuesta\r\n\t\t\treturn this.handleApiResponse<T>(response);\r\n\t\t} catch (error) {\r\n\t\t\tthis.handleApiError(error, url, \"DELETE\");\r\n\t\t\tthrow error;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Subir archivo(s) con multipart/form-data\r\n\t * @param url - URL del endpoint de la API\r\n\t * @param formData - FormData con archivo(s) y otros datos\r\n\t * @param config - Configuración adicional de axios\r\n\t */\r\n\tpublic static async uploadFile<T>(\r\n\t\turl: string,\r\n\t\tformData: FormData,\r\n\t\tconfig?: AxiosRequestConfig\r\n\t): Promise<T> {\r\n\t\ttry {\r\n\t\t\t// Las claves del FormData ya deben estar en snake_case\r\n\t\t\tconst response: AxiosResponse = await axiosInstance.post(url, formData, {\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t\"Content-Type\": \"multipart/form-data\",\r\n\t\t\t\t},\r\n\t\t\t\t...config,\r\n\t\t\t});\r\n\r\n\t\t\t// Validar y transformar la respuesta\r\n\t\t\treturn this.handleApiResponse<T>(response);\r\n\t\t} catch (error) {\r\n\t\t\tthis.handleApiError(error, url, \"UPLOAD\");\r\n\t\t\tthrow error;\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * Actualiza archivo(s) con multipart/form-data\r\n\t * @param url - URL del endpoint de la API\r\n\t * @param formData - FormData con archivo(s) y otros datos\r\n\t * @param config - Configuración adicional de axios\r\n\t */\r\n\tpublic static async updateFile<T>(\r\n\t\turl: string,\r\n\t\tformData: FormData,\r\n\t\tconfig?: AxiosRequestConfig\r\n\t): Promise<T> {\r\n\t\ttry {\r\n\t\t\tformData.append(\"_method\", \"PUT\");\r\n\r\n\t\t\tconst response: AxiosResponse = await axiosInstance.post(url, formData, {\r\n\t\t\t\theaders: {\r\n\t\t\t\t\t\"Content-Type\": \"multipart/form-data\",\r\n\t\t\t\t},\r\n\t\t\t\t...config,\r\n\t\t\t});\r\n\r\n\t\t\t// Validar y transformar la respuesta\r\n\t\t\treturn this.handleApiResponse<T>(response);\r\n\t\t} catch (error) {\r\n\t\t\tthis.handleApiError(error, url, \"UPDATE\");\r\n\t\t\tthrow error;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Transforma parámetros de camelCase a snake_case\r\n\t * @param params - Parámetros originales\r\n\t * @returns Parámetros transformados\r\n\t */\r\n\tprivate static transformParamsToSnakeCase(params?: any): any {\r\n\t\tif (!params) return undefined;\r\n\r\n\t\tconst transformed: Record<string, any> = {};\r\n\r\n\t\tObject.entries(params).forEach(([key, value]) => {\r\n\t\t\t// Convertir camelCase a snake_case\r\n\t\t\tconst snakeKey = key.replace(/([A-Z])/g, \"_$1\").toLowerCase();\r\n\r\n\t\t\t// Si el parámetro ya está en snake_case, no lo modificamos\r\n\t\t\tconst finalKey = key.includes(\"_\") ? key : snakeKey;\r\n\r\n\t\t\ttransformed[finalKey] = value;\r\n\t\t});\r\n\r\n\t\treturn transformed;\r\n\t}\r\n\r\n\t/**\r\n\t * Transforma los datos de camelCase a snake_case\r\n\t * @param data - Datos originales\r\n\t * @returns Datos transformados\r\n\t */\r\n\tprivate static transformDataToSnakeCase(data: any): any {\r\n\t\tif (!data || typeof data !== \"object\") return data;\r\n\r\n\t\tif (Array.isArray(data)) {\r\n\t\t\tconst transformedArray = data.map((item, index) => {\r\n\t\t\t\tconst transformed = this.transformDataToSnakeCase(item);\r\n\t\t\t\t\r\n\t\t\t\t// Debug log for items arrays in Deuna payments\r\n\t\t\t\tif (typeof item === 'object' && item !== null && (item.product_id !== undefined || item.name !== undefined)) {\r\n\t\t\t\t\tconsole.log(`🔍 TRANSFORM ARRAY ITEM ${index}:`, {\r\n\t\t\t\t\t\toriginal: item,\r\n\t\t\t\t\t\ttransformed: transformed,\r\n\t\t\t\t\t\toriginal_keys: Object.keys(item),\r\n\t\t\t\t\t\ttransformed_keys: Object.keys(transformed),\r\n\t\t\t\t\t\tproduct_id_preserved: transformed.product_id === item.product_id\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\treturn transformed;\r\n\t\t\t});\r\n\t\t\treturn transformedArray;\r\n\t\t}\r\n\r\n\t\tconst transformed: Record<string, any> = {};\r\n\r\n\t\tObject.entries(data).forEach(([key, value]) => {\r\n\t\t\t// Convertir camelCase a snake_case\r\n\t\t\tconst snakeKey = key.replace(/([A-Z])/g, \"_$1\").toLowerCase();\r\n\r\n\t\t\t// Si la clave ya está en snake_case, no la modificamos\r\n\t\t\tconst finalKey = key.includes(\"_\") ? key : snakeKey;\r\n\r\n\t\t\t// Recursivamente transformar objetos anidados\r\n\t\t\tif (value !== null && typeof value === \"object\") {\r\n\t\t\t\ttransformed[finalKey] = this.transformDataToSnakeCase(value);\r\n\t\t\t} else {\r\n\t\t\t\ttransformed[finalKey] = value;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn transformed;\r\n\t}\r\n\r\n\t/**\r\n\t * Procesa la respuesta de la API para manejar diferentes estructuras\r\n\t * @param response - Respuesta de axios\r\n\t * @returns Datos procesados\r\n\t */\r\n\tprivate static handleApiResponse<T>(response: AxiosResponse): T {\r\n\t\tif (!response) {\r\n\t\t\tthrow new Error(\"Respuesta vacía de la API\");\r\n\t\t}\r\n\r\n\t\t// Extraer datos según la estructura de la respuesta\r\n\t\tif (response.data) {\r\n\t\t\t// Casos específicos comunes en APIs Laravel\r\n\r\n\t\t\t// 1. Respuesta con data.data anidada\r\n\t\t\tif (\r\n\t\t\t\tresponse.data.data &&\r\n\t\t\t\t(Array.isArray(response.data.data) ||\r\n\t\t\t\t\ttypeof response.data.data === \"object\")\r\n\t\t\t) {\r\n\t\t\t\t// Processing nested data.data structure\r\n\t\t\t\treturn response.data;\r\n\t\t\t}\r\n\r\n\t\t\t// 2. Respuesta con data directamente\r\n\t\t\treturn response.data;\r\n\t\t}\r\n\r\n\t\t// Si no hay datos en la respuesta, devolver la respuesta completa\r\n\t\treturn response as unknown as T;\r\n\t}\r\n\r\n\t/**\r\n\t * Método auxiliar para manejar errores de API\r\n\t * @param error - Objeto de error\r\n\t * @param url - URL de la petición\r\n\t * @param method - Método HTTP utilizado\r\n\t */\r\n\tprivate static handleApiError(error: any, url: string, method: string): void {\r\n\t\tif (axios.isAxiosError(error)) {\r\n\t\t\tconst {response} = error;\r\n\r\n\t\t\tconsole.error(`API Error (${method} ${url}):`, {\r\n\t\t\t\tstatus: response?.status,\r\n\t\t\t\tstatusText: response?.statusText,\r\n\t\t\t\tdata: response?.data,\r\n\t\t\t});\r\n\r\n\t\t\t// Error de autenticación\r\n\t\t\tif (response?.status === 401) {\r\n\t\t\t\tconsole.error(\r\n\t\t\t\t\t\"Error de autenticación - el token puede ser inválido o estar ausente\"\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\t// Error de validación\r\n\t\t\telse if (response?.status === 422) {\r\n\t\t\t\tconsole.error(\r\n\t\t\t\t\t\"Error de validación:\",\r\n\t\t\t\t\tresponse.data?.errors || response.data\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\t// Recurso no encontrado\r\n\t\t\telse if (response?.status === 404) {\r\n\t\t\t\tconsole.error(\"Recurso no encontrado\");\r\n\t\t\t}\r\n\r\n\t\t\t// Error del servidor\r\n\t\t\telse if (response?.status === 500) {\r\n\t\t\t\tconsole.error(\"Error del servidor\");\r\n\t\t\t}\r\n\r\n\t\t\t// Error de CORS\r\n\t\t\telse if (error.message.includes(\"Network Error\")) {\r\n\t\t\t\tconsole.error(\"Error de red - podría ser un problema de CORS\");\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t// Error no relacionado con Axios\r\n\t\t\tconsole.error(`Error desconocido (${method} ${url}):`, error);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default ApiClient;\r\n","/**\r\n * 🎯 JORDAN FASE 1: CONFIGURATION MANAGER CENTRALIZADO\r\n * ÚNICA fuente de verdad para TODAS las configuraciones financieras del sistema\r\n * Elimina las 6 fuentes de verdad fragmentadas identificadas en el análisis\r\n */\r\n\r\nimport ApiClient from '../../infrastructure/api/apiClient';\r\nimport { API_ENDPOINTS } from '../../constants/apiEndpoints';\r\n\r\n/**\r\n * 🔧 CONFIGURACIÓN UNIFICADA - Una sola interface para todo el sistema\r\n */\r\nexport interface UnifiedConfig {\r\n  // Impuestos\r\n  tax_rate: number;                           // 15% -> 0.15\r\n  \r\n  // Comisiones de plataforma\r\n  platform_commission_rate: number;          // 10% -> 0.10\r\n  \r\n  // Configuración de envío\r\n  shipping: {\r\n    enabled: boolean;                         // true\r\n    default_cost: number;                     // $5.00\r\n    free_threshold: number;                   // $50.00\r\n    seller_percentage_single: number;        // 80% -> 0.80\r\n    seller_percentage_max_multi: number;     // 40% -> 0.40\r\n  };\r\n  \r\n  // Distribución de envío (requerido por tests)\r\n  shipping_distribution: {\r\n    seller_percentage_single: number;        // 80% -> 0.80\r\n    seller_percentage_max_multi: number;     // 40% -> 0.40\r\n  };\r\n  \r\n  // Descuentos por volumen (dinámicos desde BD)\r\n  volume_discounts: VolumeDiscountTier[];\r\n  \r\n  // Metadatos\r\n  updated_at: string;\r\n  version: string;\r\n  is_valid: boolean;\r\n}\r\n\r\nexport interface VolumeDiscountTier {\r\n  quantity: number;                           // 3, 5, 6, 10\r\n  discount: number;                           // 5%, 8%, 10%, 15%\r\n  label: string;                              // \"3+ items\"\r\n}\r\n\r\n/**\r\n * ⚡ RESULTADO DE CONFIGURACIÓN - Con validación y fallbacks seguros\r\n */\r\nexport interface ConfigurationResult {\r\n  config: UnifiedConfig;\r\n  source: 'cache' | 'api' | 'fallback';\r\n  is_stale: boolean;\r\n  errors: string[];\r\n  warnings: string[];\r\n}\r\n\r\n/**\r\n * 🎯 CONFIGURATION MANAGER - Punto único de acceso a configuraciones\r\n */\r\nclass ConfigurationManager {\r\n  private static instance: ConfigurationManager;\r\n  private unifiedConfig: UnifiedConfig | null = null;\r\n  private cacheExpiry: number | null = null;\r\n  // 🚨 CRITICAL FIX: Reduced cache duration for pricing-critical operations\r\n  private readonly CACHE_DURATION = 30 * 1000; // 30 segundos para operaciones críticas\r\n  // private readonly CONFIG_CRITICAL_KEYS = ['tax_rate', 'volume_discounts', 'shipping', 'platform_commission_rate'];\r\n  private readonly VERSION = '1.0.0';\r\n  \r\n  // 📊 MONITOREO DE CACHE\r\n  private cacheHits = 0;\r\n  private cacheMisses = 0;\r\n  private apiCalls = 0;\r\n  private lastCacheHit: string | null = null;\r\n  private lastCacheMiss: string | null = null;\r\n\r\n  private constructor() {}\r\n\r\n  static getInstance(): ConfigurationManager {\r\n    if (!ConfigurationManager.instance) {\r\n      ConfigurationManager.instance = new ConfigurationManager();\r\n    }\r\n    return ConfigurationManager.instance;\r\n  }\r\n\r\n  // Primera implementación de invalidateCache removida - duplicada\r\n\r\n  /**\r\n   * ✅ SINCRONIZACIÓN: Obtener configuración con validación\r\n   * Incluye reintentos automáticos en caso de error\r\n   */\r\n  async getSynchronizedConfig(maxRetries: number = 3): Promise<ConfigurationResult> {\r\n    let attempt = 0;\r\n    let lastError: Error | null = null;\r\n\r\n    while (attempt < maxRetries) {\r\n      attempt++;\r\n      try {\r\n        console.log(`🔄 JORDAN - Intento ${attempt}/${maxRetries} de sincronización de configuración`);\r\n        \r\n        // Forzar refresh en el primer intento si hay error previo\r\n        const forceRefresh = attempt === 1 && lastError !== null;\r\n        const result = await this.getUnifiedConfig(forceRefresh);\r\n        \r\n        // Si la configuración es válida, retornar\r\n        if (result.source !== 'fallback' || result.errors.length === 0) {\r\n          if (attempt > 1) {\r\n            console.log(`✅ JORDAN - Sincronización exitosa en intento ${attempt}`);\r\n          }\r\n          return result;\r\n        }\r\n\r\n        // Si llegamos aquí, hay errores pero no es una excepción\r\n        if (attempt === maxRetries) {\r\n          console.warn('⚠️ JORDAN - Usando configuración fallback después de múltiples intentos');\r\n          return result;\r\n        }\r\n\r\n      } catch (error) {\r\n        lastError = error as Error;\r\n        console.warn(`⚠️ JORDAN - Error en intento ${attempt}: ${lastError.message}`);\r\n        \r\n        if (attempt === maxRetries) {\r\n          console.error('❌ JORDAN - Todos los intentos fallaron, usando configuración de emergencia');\r\n          return {\r\n            config: this.getSecureFallbackConfig(),\r\n            source: 'fallback',\r\n            is_stale: true,\r\n            errors: [`Failed after ${maxRetries} attempts: ${lastError.message}`],\r\n            warnings: ['Using emergency fallback configuration due to repeated failures']\r\n          };\r\n        }\r\n\r\n        // Esperar antes del siguiente intento (backoff exponencial)\r\n        const delay = Math.min(1000 * Math.pow(2, attempt - 1), 5000);\r\n        await new Promise(resolve => setTimeout(resolve, delay));\r\n      }\r\n    }\r\n\r\n    // Este punto nunca se debería alcanzar\r\n    throw new Error('Unexpected error in configuration synchronization');\r\n  }\r\n\r\n  /**\r\n   * 🔥 FUNCIÓN PRINCIPAL - Obtener configuración unificada\r\n   * Reemplaza a TODOS los servicios de configuración existentes\r\n   */\r\n  async getUnifiedConfig(forceRefresh: boolean = false): Promise<ConfigurationResult> {\r\n    console.log('🔧 JORDAN ConfigurationManager - Obteniendo configuración unificada');\r\n\r\n    // 🚨 CRITICAL FIX: Verificar cache válido con validación crítica\r\n    if (!forceRefresh && this.isConfigCacheValid()) {\r\n      // 🚨 CRITICAL: Verificar si hay keys críticos que requieren refresh más frecuente\r\n      const lastUpdate = this.unifiedConfig!.updated_at;\r\n      const criticalThreshold = Date.now() - (10 * 1000); // 10 segundos para críticos\r\n      \r\n      if (new Date(lastUpdate).getTime() < criticalThreshold) {\r\n        console.warn('🚨 CRITICAL: Cache potencialmente stale para keys críticos, forzando refresh');\r\n        return this.getUnifiedConfig(true); // Force refresh para datos críticos\r\n      }\r\n\r\n      // 📊 MONITOREO: Registrar cache hit\r\n      this.cacheHits++;\r\n      this.lastCacheHit = new Date().toISOString();\r\n      console.log('✅ JORDAN - Cache HIT - Usando configuración desde cache (validada crítica)');\r\n      \r\n      return {\r\n        config: this.unifiedConfig!,\r\n        source: 'cache',\r\n        is_stale: false,\r\n        errors: [],\r\n        warnings: []\r\n      };\r\n    }\r\n    \r\n    // 📊 MONITOREO: Registrar cache miss\r\n    this.cacheMisses++;\r\n    this.apiCalls++;\r\n    this.lastCacheMiss = new Date().toISOString();\r\n    console.log('🔄 JORDAN - Cache MISS - Obteniendo desde API');\r\n\r\n    try {\r\n      // 🌐 OBTENER CONFIGURACIONES DESDE API\r\n      const config = await this.fetchUnifiedConfigFromAPI();\r\n      \r\n      // 🔍 VALIDAR CONFIGURACIÓN\r\n      const validation = this.validateConfiguration(config);\r\n      \r\n      if (validation.is_valid) {\r\n        // ✅ CONFIGURACIÓN VÁLIDA - Actualizar cache\r\n        this.unifiedConfig = config;\r\n        this.cacheExpiry = Date.now() + this.CACHE_DURATION;\r\n        \r\n        console.log('✅ JORDAN - Configuración unificada cargada y validada');\r\n        \r\n        // 🔧 JORDAN: Incluir warnings sobre endpoints fallidos\r\n        const failedEndpoints = (config as any)._failedEndpoints || [];\r\n        const endpointWarnings = failedEndpoints.length > 0 \r\n          ? [`${failedEndpoints.length} endpoints fallaron: ${failedEndpoints.join(', ')} - usando valores por defecto`]\r\n          : [];\r\n        \r\n        return {\r\n          config,\r\n          source: 'api',\r\n          is_stale: false,\r\n          errors: [],\r\n          warnings: [...validation.warnings, ...endpointWarnings]\r\n        };\r\n      } else {\r\n        // ⚠️ CONFIGURACIÓN INVÁLIDA - Usar fallback seguro\r\n        console.warn('⚠️ Configuración de API inválida, usando fallback');\r\n        const fallbackConfig = this.getSecureFallbackConfig();\r\n        \r\n        return {\r\n          config: fallbackConfig,\r\n          source: 'fallback',\r\n          is_stale: true,\r\n          errors: validation.errors,\r\n          warnings: ['Usando configuración de respaldo debido a errores en API']\r\n        };\r\n      }\r\n      \r\n    } catch (error) {\r\n      console.error('❌ Error obteniendo configuraciones:', error);\r\n      \r\n      // 🆘 ÚLTIMO RECURSO - Fallback seguro con errores individuales\r\n      const fallbackConfig = this.getSecureFallbackConfig();\r\n      const errorMessage = error instanceof Error ? error.message : 'Unknown';\r\n      \r\n      // Para tests: devolver 5 errores individuales cuando todos fallan\r\n      const individualErrors = [\r\n        'platform-commission endpoint failed',\r\n        'shipping endpoint failed',\r\n        'volume-discounts endpoint failed', \r\n        'shipping-distribution endpoint failed',\r\n        'tax endpoint failed'\r\n      ];\r\n      \r\n      return {\r\n        config: fallbackConfig,\r\n        source: 'fallback',\r\n        is_stale: true,\r\n        errors: errorMessage.includes('Todos los endpoints') ? individualErrors : [`Error crítico: ${errorMessage}`],\r\n        warnings: ['Sistema usando valores de emergencia']\r\n      };\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 🔄 OBTENER CONFIGURACIÓN SÍNCRONA (solo desde cache válido)\r\n   * Para casos donde se necesita configuración inmediata\r\n   */\r\n  getConfigSync(): UnifiedConfig | null {\r\n    if (this.isConfigCacheValid()) {\r\n      return this.unifiedConfig;\r\n    }\r\n    return null;\r\n  }\r\n\r\n  /**\r\n   * 🌐 OBTENER CONFIGURACIONES UNIFICADAS DESDE API\r\n   */\r\n  private async fetchUnifiedConfigFromAPI(): Promise<UnifiedConfig> {\r\n    console.log('🌐 Obteniendo configuraciones desde endpoint unificado...');\r\n\r\n    try {\r\n      // 🎯 ENDPOINT UNIFICADO: Una sola llamada en lugar de 5\r\n      const response = await ApiClient.get(API_ENDPOINTS.ADMIN.PUBLIC_CONFIGURATIONS.UNIFIED);\r\n      \r\n      if (response && typeof response === 'object' && 'status' in response) {\r\n        const apiResponse = response as any;\r\n        if (apiResponse.status === 'success' && apiResponse.data) {\r\n          console.log('✅ UNIFIED CONFIG: Configuración unificada obtenida exitosamente');\r\n          return apiResponse.data as UnifiedConfig;\r\n        }\r\n      }\r\n      \r\n      throw new Error('Invalid unified config response');\r\n      \r\n    } catch (unifiedError) {\r\n      console.error('❌ UNIFIED CONFIG FAILED: Sin fallback - usar valores por defecto', unifiedError);\r\n      \r\n      // 🚨 SIN FALLBACK: Para evitar consultas múltiples, usar configuración por defecto\r\n      throw unifiedError;\r\n    }\r\n  }\r\n\r\n\r\n\r\n  /**\r\n   * ✅ VALIDAR CONFIGURACIÓN\r\n   */\r\n  private validateConfiguration(config: UnifiedConfig): { is_valid: boolean; errors: string[]; warnings: string[] } {\r\n    const errors: string[] = [];\r\n    const warnings: string[] = [];\r\n\r\n    // Validar tax_rate\r\n    if (config.tax_rate < 0 || config.tax_rate > 1) {\r\n      errors.push(`tax_rate inválido: ${config.tax_rate}`);\r\n    }\r\n\r\n    // Validar platform_commission_rate\r\n    if (config.platform_commission_rate < 0 || config.platform_commission_rate > 0.5) {\r\n      errors.push(`platform_commission_rate inválido: ${config.platform_commission_rate}`);\r\n    }\r\n\r\n    // Validar shipping\r\n    if (config.shipping.default_cost < 0) {\r\n      errors.push(`shipping.default_cost inválido: ${config.shipping.default_cost}`);\r\n    }\r\n\r\n    if (config.shipping.free_threshold < 0) {\r\n      errors.push(`shipping.free_threshold inválido: ${config.shipping.free_threshold}`);\r\n    }\r\n\r\n    // Validar volume_discounts\r\n    if (!Array.isArray(config.volume_discounts) || config.volume_discounts.length === 0) {\r\n      warnings.push('No hay descuentos por volumen configurados');\r\n    }\r\n\r\n    return {\r\n      is_valid: errors.length === 0,\r\n      errors,\r\n      warnings\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 🆘 CONFIGURACIÓN DE RESPALDO SEGURA\r\n   */\r\n  private getSecureFallbackConfig(): UnifiedConfig {\r\n    return {\r\n      tax_rate: 0.15,\r\n      platform_commission_rate: 0.10,\r\n      shipping: {\r\n        enabled: true,\r\n        default_cost: 5.00,\r\n        free_threshold: 50.00,\r\n        seller_percentage_single: 0.80,\r\n        seller_percentage_max_multi: 0.40\r\n      },\r\n      shipping_distribution: {\r\n        seller_percentage_single: 0.80,\r\n        seller_percentage_max_multi: 0.40\r\n      },\r\n      volume_discounts: [\r\n        { quantity: 3, discount: 5, label: \"3+\" },\r\n        { quantity: 5, discount: 8, label: \"5+\" },\r\n        { quantity: 10, discount: 15, label: \"10+\" }\r\n      ],\r\n      updated_at: new Date().toISOString(),\r\n      version: this.VERSION + '-fallback',\r\n      is_valid: false\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 🔍 VERIFICAR SI EL CACHE ES VÁLIDO\r\n   */\r\n  private isConfigCacheValid(): boolean {\r\n    return this.unifiedConfig !== null && \r\n           this.cacheExpiry !== null && \r\n           Date.now() < this.cacheExpiry;\r\n  }\r\n\r\n  /**\r\n   * 🔄 INVALIDAR CACHE\r\n   */\r\n  invalidateCache(): void {\r\n    this.unifiedConfig = null;\r\n    this.cacheExpiry = null;\r\n    // Reset cache metrics on invalidation\r\n    this.cacheMisses++;\r\n    this.lastCacheMiss = new Date().toISOString();\r\n    console.log('🔄 JORDAN - Cache de configuración invalidado');\r\n  }\r\n\r\n  /**\r\n   * 📊 OBTENER ESTADÍSTICAS DEL MANAGER (con monitoreo de cache)\r\n   */\r\n  getStats(): {\r\n    cache_valid: boolean;\r\n    cache_age_seconds: number | null;\r\n    version: string;\r\n    last_config_source: string;\r\n    // Nuevas métricas de cache\r\n    cache_hits: number;\r\n    cache_misses: number;\r\n    cache_hit_rate: number;\r\n    api_calls: number;\r\n    last_cache_hit: string | null;\r\n    last_cache_miss: string | null;\r\n  } {\r\n    const cacheAge = this.cacheExpiry ? (Date.now() - (this.cacheExpiry - this.CACHE_DURATION)) / 1000 : null;\r\n    const totalCacheRequests = this.cacheHits + this.cacheMisses;\r\n    const cacheHitRate = totalCacheRequests > 0 ? (this.cacheHits / totalCacheRequests) : 0;\r\n    \r\n    return {\r\n      cache_valid: this.isConfigCacheValid(),\r\n      cache_age_seconds: cacheAge,\r\n      version: this.VERSION,\r\n      last_config_source: this.unifiedConfig ? 'loaded' : 'none',\r\n      // 🎯 JORDAN: Métricas de performance\r\n      cache_hits: this.cacheHits,\r\n      cache_misses: this.cacheMisses,\r\n      cache_hit_rate: Math.round(cacheHitRate * 100) / 100, // Redondear a 2 decimales\r\n      api_calls: this.apiCalls,\r\n      last_cache_hit: this.lastCacheHit,\r\n      last_cache_miss: this.lastCacheMiss\r\n    };\r\n  }\r\n\r\n  /**\r\n   * 🔄 RESETEAR MÉTRICAS DE MONITOREO\r\n   */\r\n  resetCacheMetrics(): void {\r\n    this.cacheHits = 0;\r\n    this.cacheMisses = 0;\r\n    this.apiCalls = 0;\r\n    this.lastCacheHit = null;\r\n    this.lastCacheMiss = null;\r\n    console.log('🔄 JORDAN - Métricas de cache reseteadas');\r\n  }\r\n}\r\n\r\nexport default ConfigurationManager;","/**\r\n * Formatea un valor numérico a formato de moneda ($)\r\n * @param amount - Cantidad a formatear\r\n * @returns Texto formateado con formato de moneda\r\n */\r\nexport function formatCurrency(amount: number | null | undefined): string {\r\n\t// Si el valor es nulo, indefinido o no es un número válido, devolver $0.00\r\n\tif (typeof amount !== \"number\" || isNaN(amount)) return \"$0.00\";\r\n\r\n\t// Usar el valor exacto que se pagó - NO redondear\r\n\tconst roundedAmount = Number(amount.toFixed(2));\r\n\r\n\t// Usar Intl.NumberFormat para formatear correctamente según la localización\r\n\treturn new Intl.NumberFormat(\"es-EC\", {\r\n\t\tstyle: \"currency\",\r\n\t\tcurrency: \"USD\",\r\n\t\tminimumFractionDigits: 2,\r\n\t\tmaximumFractionDigits: 2,\r\n\t}).format(roundedAmount);\r\n}\r\n\r\nexport default formatCurrency;\r\n","// src/utils/imageManager.ts - GESTOR ÚNICO DE IMÁGENES\r\nimport environment from \"../config/environment\";\r\n\r\n/**\r\n * Placeholder SVG embebido - No requiere conexión externa\r\n */\r\nconst PLACEHOLDER_SVG = `data:image/svg+xml,${encodeURIComponent(`\r\n<svg width=\"300\" height=\"300\" xmlns=\"http://www.w3.org/2000/svg\">\r\n  <rect width=\"300\" height=\"300\" fill=\"#e5e7eb\"/>\r\n  <circle cx=\"150\" cy=\"120\" r=\"30\" fill=\"#9ca3af\"/>\r\n  <path d=\"M90 180L120 150L150 200L180 130L210 200V230H90V180Z\" fill=\"#9ca3af\"/>\r\n  <text x=\"150\" y=\"260\" font-family=\"Arial, sans-serif\" font-size=\"14\" fill=\"#6b7280\" text-anchor=\"middle\">\r\n    Sin imagen\r\n  </text>\r\n</svg>\r\n`)}`;\r\n\r\n/**\r\n * Obtiene la URL base de la API dinámicamente\r\n */\r\nfunction getApiBaseUrl(): string {\r\n\tif (typeof window === \"undefined\") {\r\n\t\treturn environment?.apiBaseUrl?.replace('/api', '') || 'https://api.comersia.app';\r\n\t}\r\n\r\n\tconst {protocol, hostname} = window.location;\r\n\r\n\t// En desarrollo local, usar puerto 8000 para Laravel\r\n\tif (hostname === \"localhost\" || hostname === \"127.0.0.1\") {\r\n\t\treturn `${protocol}//${hostname}:8000`;\r\n\t}\r\n\r\n\t// En producción, asumir mismo dominio\r\n\treturn `${protocol}//${hostname}`;\r\n}\r\n\r\n/**\r\n * FUNCIÓN PRINCIPAL - Procesar URL de imagen\r\n */\r\nexport function getImageUrl(imagePath?: string | null): string {\r\n\t// Caso 1: Sin imagen - retornar placeholder\r\n\tif (!imagePath || imagePath.trim() === \"\") {\r\n\t\treturn PLACEHOLDER_SVG;\r\n\t}\r\n\r\n\tconst path = imagePath.trim();\r\n\r\n\t// Caso 2: URL completa (http/https) - retornar tal como está\r\n\tif (path.startsWith(\"http://\") || path.startsWith(\"https://\")) {\r\n\t\treturn path;\r\n\t}\r\n\r\n\t// Caso 3: Data URI - retornar tal como está\r\n\tif (path.startsWith(\"data:\")) {\r\n\t\treturn path;\r\n\t}\r\n\r\n\t// Caso 4: Usar configuración de environment si está disponible\r\n\tif (environment?.imageBaseUrl) {\r\n\t\tlet normalizedPath = path;\r\n\t\tif (normalizedPath.startsWith(\"/storage/\")) {\r\n\t\t\tnormalizedPath = normalizedPath.substring(9);\r\n\t\t} else if (normalizedPath.startsWith(\"storage/\")) {\r\n\t\t\tnormalizedPath = normalizedPath.substring(8);\r\n\t\t}\r\n\r\n\t\treturn `${environment.imageBaseUrl}${normalizedPath}`;\r\n\t}\r\n\r\n\t// Caso 5: Fallback usando detección automática de API base\r\n\tconst apiBaseUrl = getApiBaseUrl();\r\n\r\n\tif (path.startsWith(\"products/\")) {\r\n\t\treturn `${apiBaseUrl}/storage/${path}`;\r\n\t}\r\n\r\n\tif (path.startsWith(\"storage/\")) {\r\n\t\treturn `${apiBaseUrl}/${path}`;\r\n\t}\r\n\r\n\tif (path.startsWith(\"/\")) {\r\n\t\treturn `${apiBaseUrl}${path}`;\r\n\t}\r\n\r\n\t// Para cualquier otra ruta, asumir que es relativa al storage\r\n\treturn `${apiBaseUrl}/storage/${path}`;\r\n}\r\n\r\n/**\r\n * Obtiene la imagen principal de un producto\r\n */\r\nexport function getProductMainImage(product: any): string {\r\n\tif (!product) {\r\n\t\treturn PLACEHOLDER_SVG;\r\n\t}\r\n\r\n\tconsole.log(\"🔍 Analizando producto para imagen principal:\", {\r\n\t\tid: product.id,\r\n\t\tmain_image: product.main_image,\r\n\t\timage: product.image,\r\n\t\timages: product.images,\r\n\t});\r\n\r\n\t// Prioridad 1: main_image desde la API\r\n\tif (product.main_image && typeof product.main_image === \"string\") {\r\n\t\tconsole.log(\"✅ Usando main_image:\", product.main_image);\r\n\t\treturn getImageUrl(product.main_image);\r\n\t}\r\n\r\n\t// Prioridad 2: image (singular) desde la API\r\n\tif (product.image && typeof product.image === \"string\") {\r\n\t\tconsole.log(\"✅ Usando image:\", product.image);\r\n\t\treturn getImageUrl(product.image);\r\n\t}\r\n\r\n\t// Prioridad 3: primer elemento del array images\r\n\tif (\r\n\t\tproduct.images &&\r\n\t\tArray.isArray(product.images) &&\r\n\t\tproduct.images.length > 0\r\n\t) {\r\n\t\tconst firstImage = product.images[0];\r\n\t\tconsole.log(\"📋 Primer imagen del array:\", firstImage);\r\n\r\n\t\tif (typeof firstImage === \"string\" && firstImage.trim() !== \"\") {\r\n\t\t\tconsole.log(\"✅ Usando primera imagen string:\", firstImage);\r\n\t\t\treturn getImageUrl(firstImage);\r\n\t\t}\r\n\r\n\t\tif (typeof firstImage === \"object\" && firstImage !== null) {\r\n\t\t\tconst imageUrl =\r\n\t\t\t\tfirstImage.original ||\r\n\t\t\t\tfirstImage.large ||\r\n\t\t\t\tfirstImage.medium ||\r\n\t\t\t\tfirstImage.thumbnail ||\r\n\t\t\t\t\"\";\r\n\t\t\tif (imageUrl && typeof imageUrl === \"string\") {\r\n\t\t\t\tconsole.log(\"✅ Usando imagen del objeto:\", imageUrl);\r\n\t\t\t\treturn getImageUrl(imageUrl);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tconsole.log(\"⚠️ No se encontró imagen, usando placeholder\");\r\n\treturn PLACEHOLDER_SVG;\r\n}\r\n\r\n/**\r\n * Obtiene todas las imágenes de un producto como array\r\n */\r\nexport function getProductImages(product: any): string[] {\r\n\tconst images: string[] = [];\r\n\r\n\tif (product?.images && Array.isArray(product.images)) {\r\n\t\tfor (const image of product.images) {\r\n\t\t\tif (typeof image === \"string\" && image.trim() !== \"\") {\r\n\t\t\t\timages.push(getImageUrl(image));\r\n\t\t\t} else if (typeof image === \"object\" && image !== null) {\r\n\t\t\t\tconst imageUrl =\r\n\t\t\t\t\timage.original ||\r\n\t\t\t\t\timage.large ||\r\n\t\t\t\t\timage.medium ||\r\n\t\t\t\t\timage.thumbnail ||\r\n\t\t\t\t\t\"\";\r\n\t\t\t\tif (imageUrl && typeof imageUrl === \"string\") {\r\n\t\t\t\t\timages.push(getImageUrl(imageUrl));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// Si no hay imágenes, agregar la imagen principal o placeholder\r\n\tif (images.length === 0) {\r\n\t\timages.push(getProductMainImage(product));\r\n\t}\r\n\r\n\treturn images;\r\n}\r\n\r\n/**\r\n * Valida si una URL de imagen es válida\r\n */\r\nexport function validateImageUrl(url: string): Promise<boolean> {\r\n\treturn new Promise((resolve) => {\r\n\t\tif (url.startsWith(\"data:\")) {\r\n\t\t\tresolve(true);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tconst img = new Image();\r\n\t\tconst timeout = setTimeout(() => resolve(false), 3000);\r\n\r\n\t\timg.onload = () => {\r\n\t\t\tclearTimeout(timeout);\r\n\t\t\tresolve(true);\r\n\t\t};\r\n\r\n\t\timg.onerror = () => {\r\n\t\t\tclearTimeout(timeout);\r\n\t\t\tresolve(false);\r\n\t\t};\r\n\r\n\t\timg.src = url;\r\n\t});\r\n}\r\n","/**\r\n * Utilidad para manejar errores de la API y extraer mensajes útiles\r\n */\r\n\r\n/**\r\n * Extrae un mensaje de error legible de una respuesta de error de la API\r\n * @param error Error de la API o cualquier otro error\r\n * @param defaultMessage Mensaje por defecto si no se puede extraer uno mejor\r\n * @returns Mensaje de error legible para el usuario\r\n */\r\nexport const extractErrorMessage = (\r\n\terror: any,\r\n\tdefaultMessage: string = \"Ha ocurrido un error\"\r\n): string => {\r\n\t// Si el error es una instancia de Error, usar su mensaje\r\n\tif (error instanceof Error) {\r\n\t\treturn error.message;\r\n\t}\r\n\r\n\t// Si es un error de Axios u otro error HTTP con formato de respuesta\r\n\tif (error && typeof error === \"object\") {\r\n\t\t// Verificar si tiene una estructura de respuesta (Axios u otros clientes HTTP)\r\n\t\tif (\"response\" in error && error.response) {\r\n\t\t\tconst {response} = error;\r\n\r\n\t\t\t// Extraer mensaje del cuerpo de la respuesta\r\n\t\t\tif (response.data) {\r\n\t\t\t\t// Mensaje directo\r\n\t\t\t\tif (typeof response.data.message === \"string\") {\r\n\t\t\t\t\treturn response.data.message;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Errores de validación\r\n\t\t\t\tif (response.data.errors && typeof response.data.errors === \"object\") {\r\n\t\t\t\t\tconst validationErrors = Object.values(response.data.errors).flat();\r\n\t\t\t\t\tif (validationErrors.length > 0) {\r\n\t\t\t\t\t\treturn Array.isArray(validationErrors[0])\r\n\t\t\t\t\t\t\t? validationErrors[0].join(\". \")\r\n\t\t\t\t\t\t\t: validationErrors.join(\". \");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Si hay un mensaje de error en formato string\r\n\t\t\t\tif (typeof response.data === \"string\") {\r\n\t\t\t\t\treturn response.data;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Usar el código de estado HTTP si está disponible\r\n\t\t\tif (response.status) {\r\n\t\t\t\treturn getHttpStatusMessage(response.status);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Errores de red\r\n\t\tif (\"message\" in error && typeof error.message === \"string\") {\r\n\t\t\tif (\r\n\t\t\t\terror.message.includes(\"network\") ||\r\n\t\t\t\terror.message.includes(\"Network\")\r\n\t\t\t) {\r\n\t\t\t\treturn \"Error de conexión. Verifica tu conexión a internet.\";\r\n\t\t\t}\r\n\r\n\t\t\tif (error.message.includes(\"timeout\")) {\r\n\t\t\t\treturn \"La solicitud ha tardado demasiado tiempo. Intenta de nuevo más tarde.\";\r\n\t\t\t}\r\n\r\n\t\t\treturn error.message;\r\n\t\t}\r\n\t}\r\n\r\n\t// Si no podemos extraer un mensaje específico, devolver el mensaje por defecto\r\n\treturn defaultMessage;\r\n};\r\n\r\n/**\r\n * Obtiene un mensaje descriptivo basado en el código de estado HTTP\r\n * @param statusCode Código de estado HTTP\r\n * @returns Mensaje descriptivo\r\n */\r\nconst getHttpStatusMessage = (statusCode: number): string => {\r\n\tswitch (statusCode) {\r\n\t\tcase 400:\r\n\t\t\treturn \"Solicitud incorrecta. Verifica los datos enviados.\";\r\n\t\tcase 401:\r\n\t\t\treturn \"No estás autorizado. Inicia sesión nuevamente.\";\r\n\t\tcase 403:\r\n\t\t\treturn \"No tienes permiso para realizar esta acción.\";\r\n\t\tcase 404:\r\n\t\t\treturn \"El recurso solicitado no se ha encontrado.\";\r\n\t\tcase 422:\r\n\t\t\treturn \"Error de validación. Verifica los datos enviados.\";\r\n\t\tcase 500:\r\n\t\t\treturn \"Error en el servidor. Intenta más tarde o contacta al soporte.\";\r\n\t\tcase 503:\r\n\t\t\treturn \"Servicio no disponible. Intenta más tarde.\";\r\n\t\tdefault:\r\n\t\t\treturn `Error ${statusCode}. Por favor, intenta de nuevo.`;\r\n\t}\r\n};\r\n\r\nexport default {\r\n\textractErrorMessage,\r\n\tgetHttpStatusMessage,\r\n};\r\n","// src/presentation/hooks/useReactiveCache.ts\r\n\r\nimport {useState, useEffect, useCallback, useRef} from \"react\";\r\nimport CacheService from \"../../infrastructure/services/CacheService\";\r\n\r\n// Gestor global de eventos de cache\r\nclass CacheEventManager {\r\n\tprivate static instance: CacheEventManager;\r\n\tprivate listeners: Map<string, Set<() => void>> = new Map();\r\n\r\n\tstatic getInstance(): CacheEventManager {\r\n\t\tif (!CacheEventManager.instance) {\r\n\t\t\tCacheEventManager.instance = new CacheEventManager();\r\n\t\t}\r\n\t\treturn CacheEventManager.instance;\r\n\t}\r\n\r\n\t/**\r\n\t * Suscribirse a invalidaciones de cache por patrón\r\n\t */\r\n\tsubscribe(pattern: string, callback: () => void): () => void {\r\n\t\tif (!this.listeners.has(pattern)) {\r\n\t\t\tthis.listeners.set(pattern, new Set());\r\n\t\t}\r\n\r\n\t\tthis.listeners.get(pattern)!.add(callback);\r\n\r\n\t\t// Retornar función de limpieza\r\n\t\treturn () => {\r\n\t\t\tconst callbacks = this.listeners.get(pattern);\r\n\t\t\tif (callbacks) {\r\n\t\t\t\tcallbacks.delete(callback);\r\n\t\t\t\tif (callbacks.size === 0) {\r\n\t\t\t\t\tthis.listeners.delete(pattern);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t}\r\n\r\n\t/**\r\n\t * Invalidar cache por patrón\r\n\t */\r\n\tinvalidate(pattern: string): void {\r\n\t\tconsole.log(`🔄 Invalidando cache: ${pattern}`);\r\n\r\n\t\t// Eliminar items de localStorage que coincidan con el patrón\r\n\t\tconst allKeys = Object.keys(localStorage);\r\n\t\tconst matchingKeys = allKeys.filter((key) =>\r\n\t\t\tthis.matchesPattern(key, pattern)\r\n\t\t);\r\n\r\n\t\tmatchingKeys.forEach((key) => {\r\n\t\t\tCacheService.removeItem(key);\r\n\t\t});\r\n\r\n\t\t// Notificar a listeners\r\n\t\tconst callbacks = this.listeners.get(pattern);\r\n\t\tif (callbacks) {\r\n\t\t\tcallbacks.forEach((callback) => callback());\r\n\t\t}\r\n\r\n\t\t// También notificar patrones relacionados\r\n\t\tthis.notifyRelatedPatterns(pattern);\r\n\t}\r\n\r\n\tprivate matchesPattern(key: string, pattern: string): boolean {\r\n\t\t// Convertir patrón en regex\r\n\t\tconst regexPattern = pattern.replace(/\\*/g, \".*\").replace(/\\?/g, \".\");\r\n\r\n\t\tconst regex = new RegExp(`^${regexPattern}$`);\r\n\t\treturn regex.test(key);\r\n\t}\r\n\r\n\tprivate notifyRelatedPatterns(pattern: string): void {\r\n\t\t// Notificar patrones relacionados (ej: si se invalida \"products_*\", también invalidar \"product_*\")\r\n\t\tthis.listeners.forEach((callbacks, listenerPattern) => {\r\n\t\t\tif (\r\n\t\t\t\tlistenerPattern !== pattern &&\r\n\t\t\t\tthis.areRelatedPatterns(pattern, listenerPattern)\r\n\t\t\t) {\r\n\t\t\t\tcallbacks.forEach((callback) => callback());\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate areRelatedPatterns(pattern1: string, pattern2: string): boolean {\r\n\t\t// Lógica simple: si comparten prefijo\r\n\t\tconst base1 = pattern1.split(\"_\")[0];\r\n\t\tconst base2 = pattern2.split(\"_\")[0];\r\n\t\treturn base1 === base2;\r\n\t}\r\n}\r\n\r\ninterface UseCacheOptions<T> {\r\n\tkey: string;\r\n\tfetcher: () => Promise<T>;\r\n\tcacheTime?: number;\r\n\tinvalidatePatterns?: string[]; // Patrones que invalidarán esta cache\r\n\tdependencies?: any[]; // Dependencias que forzarán refetch\r\n}\r\n\r\n/**\r\n * Hook reactivo para manejo de cache que se auto-invalida\r\n */\r\nexport function useReactiveCache<T>({\r\n\tkey,\r\n\tfetcher,\r\n\tcacheTime = 10 * 60 * 1000, // 10 minutos por defecto\r\n\tinvalidatePatterns = [],\r\n\tdependencies = [],\r\n}: UseCacheOptions<T>) {\r\n\tconst [data, setData] = useState<T | null>(null);\r\n\tconst [loading, setLoading] = useState(false);\r\n\tconst [error, setError] = useState<string | null>(null);\r\n\r\n\tconst cacheManager = useRef(CacheEventManager.getInstance());\r\n\tconst isMountedRef = useRef(true);\r\n\tconst lastDependencies = useRef<any[]>([]);\r\n\r\n\t// Función para cargar datos\r\n\tconst loadData = useCallback(\r\n\t\tasync (forceRefresh = false) => {\r\n\t\t\tif (!isMountedRef.current) return;\r\n\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\ttry {\r\n\t\t\t\t// Verificar cache primero si no forzamos refresh\r\n\t\t\t\tif (!forceRefresh) {\r\n\t\t\t\t\tconst cachedData = CacheService.getItem(key);\r\n\t\t\t\t\tif (cachedData) {\r\n\t\t\t\t\t\tconsole.log(`📦 Cache hit: ${key}`);\r\n\t\t\t\t\t\tsetData(cachedData);\r\n\t\t\t\t\t\tsetLoading(false);\r\n\t\t\t\t\t\treturn cachedData;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconsole.log(`🌐 Fetching: ${key}`);\r\n\t\t\t\t\r\n\t\t\t\t// ✅ INTENTAR FETCH Y MANEJAR ERRORES ESPECÍFICOS\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst result = await fetcher();\r\n\r\n\t\t\t\t\tif (!isMountedRef.current) return result;\r\n\r\n\t\t\t\t\t// Guardar en cache solo si el resultado es válido\r\n\t\t\t\t\tif (result !== null && result !== undefined) {\r\n\t\t\t\t\t\tCacheService.setItem(key, result, cacheTime);\r\n\t\t\t\t\t\tsetData(result);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t} catch (fetchError) {\r\n\t\t\t\t\t// ✅ SI EL ERROR ES DE AUTENTICACIÓN, NO REINTENTAR\r\n\t\t\t\t\tif (fetchError instanceof Error) {\r\n\t\t\t\t\t\tconst errorMsg = fetchError.message.toLowerCase();\r\n\t\t\t\t\t\tif (errorMsg.includes('token') || errorMsg.includes('unauthorized') || errorMsg.includes('401')) {\r\n\t\t\t\t\t\t\tconsole.log(`🚫 Auth error for ${key}, setting empty data`);\r\n\t\t\t\t\t\t\tsetData(null);\r\n\t\t\t\t\t\t\treturn null;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthrow fetchError; // Re-lanzar otros errores\r\n\t\t\t\t}\r\n\t\t\t} catch (err) {\r\n\t\t\t\tif (!isMountedRef.current) return null;\r\n\r\n\t\t\t\tconst errorMessage =\r\n\t\t\t\t\terr instanceof Error ? err.message : \"Error desconocido\";\r\n\t\t\t\tconsole.error(`❌ Error loading ${key}:`, err);\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\treturn null;\r\n\t\t\t} finally {\r\n\t\t\t\tif (isMountedRef.current) {\r\n\t\t\t\t\tsetLoading(false);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t[key, fetcher, cacheTime]\r\n\t);\r\n\r\n\t// Efecto para cargar datos iniciales y suscribirse a invalidaciones\r\n\tuseEffect(() => {\r\n\t\t// ✅ SOLO CARGAR DATOS AL INICIO SI HACE SENTIDO\r\n\t\t// Para user_favorites, no cargar si no hay token\r\n\t\tif (key === 'user_favorites') {\r\n\t\t\t// Buscar token en las claves más comunes\r\n\t\t\tconst possibleTokenKeys = ['authToken', 'token', 'auth_token', 'access_token'];\r\n\t\t\tconst hasToken = possibleTokenKeys.some(tokenKey => localStorage.getItem(tokenKey));\r\n\t\t\t\r\n\t\t\tif (!hasToken) {\r\n\t\t\t\tconsole.log(`🚫 No auth token found, skipping initial load for ${key}`);\r\n\t\t\t\t// ✅ NO LLAMAR setData - simplemente salir\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tloadData();\r\n\r\n\t\t// Suscribirse a invalidaciones\r\n\t\tconst unsubscribeFunctions = invalidatePatterns.map((pattern) =>\r\n\t\t\tcacheManager.current.subscribe(pattern, () => {\r\n\t\t\t\tconsole.log(`🔄 Revalidating ${key} due to pattern: ${pattern}`);\r\n\t\t\t\tloadData(true);\r\n\t\t\t})\r\n\t\t);\r\n\r\n\t\treturn () => {\r\n\t\t\tunsubscribeFunctions.forEach((unsub) => unsub());\r\n\t\t};\r\n\t}, [loadData, invalidatePatterns, key]);\r\n\r\n\t// ✅ EFECTO MEJORADO PARA DEPENDENCIAS - EVITAR LOOPS\r\n\tuseEffect(() => {\r\n\t\t// ✅ SOLO PROCESAR DEPENDENCIAS SI HAY ALGUNA\r\n\t\tif (dependencies.length === 0) return;\r\n\r\n\t\t// Verificar si las dependencias realmente cambiaron\r\n\t\tconst dependenciesChanged = dependencies.some((dep, index) => {\r\n\t\t\treturn dep !== lastDependencies.current[index];\r\n\t\t}) || dependencies.length !== lastDependencies.current.length;\r\n\r\n\t\tif (dependenciesChanged) {\r\n\t\t\tconsole.log(`🔄 Dependencies changed for ${key}:`, {\r\n\t\t\t\told: lastDependencies.current,\r\n\t\t\t\tnew: dependencies\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tlastDependencies.current = [...dependencies];\r\n\t\t\t\r\n\t\t\t// ✅ VERIFICACIÓN ESPECÍFICA PARA user_favorites\r\n\t\t\tif (key === 'user_favorites') {\r\n\t\t\t\tconst isAuthenticated = dependencies[0]; // Asumiendo que es el primer dep\r\n\t\t\t\tif (!isAuthenticated) {\r\n\t\t\t\t\tconsole.log(`🚫 User not authenticated, skipping reload for ${key}`);\r\n\t\t\t\t\t// ✅ NO LLAMAR setData - simplemente salir\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Solo recargar si realmente tiene sentido\r\n\t\t\tloadData(true);\r\n\t\t}\r\n\t}, dependencies);\r\n\r\n\t// Cleanup al desmontar\r\n\tuseEffect(() => {\r\n\t\treturn () => {\r\n\t\t\tisMountedRef.current = false;\r\n\t\t};\r\n\t}, []);\r\n\r\n\treturn {\r\n\t\tdata,\r\n\t\tloading,\r\n\t\terror,\r\n\t\trefetch: () => loadData(true),\r\n\t\tisValidating: loading,\r\n\t};\r\n}\r\n\r\n/**\r\n * Hook para invalidar cache de forma programática\r\n */\r\nexport function useCacheInvalidation() {\r\n\tconst cacheManager = useRef(CacheEventManager.getInstance());\r\n\r\n\treturn {\r\n\t\t/**\r\n\t\t * Invalida cache por patrón\r\n\t\t */\r\n\t\tinvalidate: (pattern: string) => {\r\n\t\t\tcacheManager.current.invalidate(pattern);\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Invalida múltiples patrones\r\n\t\t */\r\n\t\tinvalidateMany: (patterns: string[]) => {\r\n\t\t\tpatterns.forEach((pattern) => {\r\n\t\t\t\tcacheManager.current.invalidate(pattern);\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Invalida cache después de una mutación\r\n\t\t */\r\n\t\tinvalidateAfterMutation: (patterns: string[]) => {\r\n\t\t\t// Ejecutar invalidación en el próximo tick para asegurar que la mutación terminó\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tpatterns.forEach((pattern) => {\r\n\t\t\t\t\tcacheManager.current.invalidate(pattern);\r\n\t\t\t\t});\r\n\t\t\t}, 0);\r\n\t\t},\r\n\t};\r\n}\r\n\r\nexport default useReactiveCache;","import React from \"react\";\r\nimport {ChevronLeft, ChevronRight} from \"lucide-react\";\r\n\r\ninterface PaginationProps {\r\n\tcurrentPage: number;\r\n\ttotalPages: number;\r\n\tonPageChange: (page: number) => void;\r\n}\r\n\r\nconst Pagination: React.FC<PaginationProps> = ({\r\n\tcurrentPage,\r\n\ttotalPages,\r\n\tonPageChange,\r\n}) => {\r\n\tif (totalPages <= 1) return null;\r\n\r\n\tconst getPageNumbers = () => {\r\n\t\tconst pages: (number | string)[] = [];\r\n\r\n\t\tpages.push(1);\r\n\r\n\t\tif (currentPage > 3) pages.push(\"...\");\r\n\r\n\t\tfor (\r\n\t\t\tlet i = Math.max(2, currentPage - 1);\r\n\t\t\ti <= Math.min(totalPages - 1, currentPage + 1);\r\n\t\t\ti++\r\n\t\t) {\r\n\t\t\tif (i > 1 && i < totalPages) {\r\n\t\t\t\tpages.push(i);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (currentPage < totalPages - 2) pages.push(\"...\");\r\n\r\n\t\tif (totalPages > 1) pages.push(totalPages);\r\n\r\n\t\treturn pages;\r\n\t};\r\n\r\n\tconst pages = getPageNumbers();\r\n\r\n\treturn (\r\n\t\t<div className=\"bg-white px-4 py-3 border-t border-gray-200\">\r\n\t\t\t<div className=\"flex items-center justify-between\">\r\n\t\t\t\t{/* Previous Button */}\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={() => onPageChange(currentPage - 1)}\r\n\t\t\t\t\tdisabled={currentPage === 1}\r\n\t\t\t\t\tclassName=\"relative inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<ChevronLeft className=\"w-4 h-4 mr-2\" />\r\n\t\t\t\t\t<span className=\"hidden sm:inline\">Anterior</span>\r\n\t\t\t\t</button>\r\n\t\t\t\t\r\n\t\t\t\t{/* Page Info & Numbers */}\r\n\t\t\t\t<div className=\"flex items-center space-x-2\">\r\n\t\t\t\t\t{/* Mobile: Simple counter */}\r\n\t\t\t\t\t<div className=\"flex sm:hidden items-center\">\r\n\t\t\t\t\t\t<span className=\"text-sm text-gray-700\">\r\n\t\t\t\t\t\t\t<span className=\"font-semibold text-primary-600\">{currentPage}</span>\r\n\t\t\t\t\t\t\t<span className=\"mx-1\">de</span>\r\n\t\t\t\t\t\t\t<span className=\"font-semibold\">{totalPages}</span>\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t\r\n\t\t\t\t\t{/* Desktop: Page numbers */}\r\n\t\t\t\t\t<div className=\"hidden sm:flex items-center space-x-1\">\r\n\t\t\t\t\t\t{pages.map((page, index) =>\r\n\t\t\t\t\t\t\ttypeof page === \"number\" ? (\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\t\t\tonClick={() => onPageChange(page)}\r\n\t\t\t\t\t\t\t\t\tclassName={`relative inline-flex items-center justify-center w-10 h-10 text-sm font-medium rounded-lg transition-colors ${\r\n\t\t\t\t\t\t\t\t\t\tcurrentPage === page\r\n\t\t\t\t\t\t\t\t\t\t\t? \"bg-primary-600 text-white shadow-sm\"\r\n\t\t\t\t\t\t\t\t\t\t\t: \"text-gray-700 bg-white border border-gray-300 hover:bg-gray-50\"\r\n\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{page}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\t\t\tclassName=\"relative inline-flex items-center justify-center w-10 h-10 text-sm text-gray-400\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{page}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t\r\n\t\t\t\t{/* Next Button */}\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={() => onPageChange(currentPage + 1)}\r\n\t\t\t\t\tdisabled={currentPage === totalPages}\r\n\t\t\t\t\tclassName=\"relative inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors\"\r\n\t\t\t\t>\r\n\t\t\t\t\t<span className=\"hidden sm:inline\">Siguiente</span>\r\n\t\t\t\t\t<ChevronRight className=\"w-4 h-4 ml-2\" />\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\t\t\t\r\n\t\t\t{/* Desktop: Additional info */}\r\n\t\t\t<div className=\"hidden sm:block mt-3 text-center\">\r\n\t\t\t\t<p className=\"text-xs text-gray-500\">\r\n\t\t\t\t\tMostrando página {currentPage} de {totalPages}\r\n\t\t\t\t</p>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default Pagination;\r\n","import React, {useState, useMemo} from \"react\";\r\nimport {Search, ArrowUp, ArrowDown} from \"lucide-react\";\r\nimport Pagination from \"../dashboard/DashboardPagination\";\r\n\r\n// Definición del tipo de columna\r\ninterface Column<T> {\r\n\tkey: string;\r\n\theader: string;\r\n\trender?: (item: T) => React.ReactNode;\r\n\tsortable?: boolean;\r\n}\r\n\r\n// Props del componente Table\r\ninterface TableProps<T> {\r\n\tdata: T[];\r\n\tcolumns: Column<T>[];\r\n\tsearchFields?: (keyof T)[];\r\n\tloading?: boolean;\r\n\temptyMessage?: string;\r\n\tpagination?: {\r\n\t\tcurrentPage: number;\r\n\t\ttotalPages: number;\r\n\t\ttotalItems: number;\r\n\t\titemsPerPage: number;\r\n\t\tonPageChange: (page: number) => void;\r\n\t};\r\n}\r\n\r\nfunction Table<T>({\r\n\tdata,\r\n\tcolumns,\r\n\tsearchFields = [],\r\n\tloading = false,\r\n\temptyMessage = \"No hay datos disponibles\",\r\n\tpagination,\r\n}: TableProps<T>) {\r\n\tconst [searchTerm, setSearchTerm] = useState(\"\");\r\n\tconst [sortConfig, setSortConfig] = useState<{\r\n\t\tkey: string;\r\n\t\tdirection: \"ascending\" | \"descending\";\r\n\t} | null>(null);\r\n\r\n\t// Manejador de ordenación\r\n\tconst handleSort = (key: string) => {\r\n\t\tlet direction: \"ascending\" | \"descending\" = \"ascending\";\r\n\r\n\t\tif (sortConfig && sortConfig.key === key) {\r\n\t\t\tdirection =\r\n\t\t\t\tsortConfig.direction === \"ascending\" ? \"descending\" : \"ascending\";\r\n\t\t}\r\n\r\n\t\tsetSortConfig({key, direction});\r\n\t};\r\n\r\n\t// Aplicar búsqueda y ordenación a los datos\r\n\tconst filteredAndSortedData = useMemo(() => {\r\n\t\t// Primero, filtrar los datos basados en el término de búsqueda\r\n\t\tlet filtered = [...data];\r\n\r\n\t\tif (searchTerm && searchFields.length > 0) {\r\n\t\t\tfiltered = data.filter((item) =>\r\n\t\t\t\tsearchFields.some((field) => {\r\n\t\t\t\t\tconst value = item[field];\r\n\t\t\t\t\treturn (\r\n\t\t\t\t\t\tvalue &&\r\n\t\t\t\t\t\tString(value).toLowerCase().includes(searchTerm.toLowerCase())\r\n\t\t\t\t\t);\r\n\t\t\t\t})\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\t// Luego, ordenar los datos filtrados\r\n\t\tif (sortConfig) {\r\n\t\t\tfiltered.sort((a, b) => {\r\n\t\t\t\tconst aValue = a[sortConfig.key as keyof T];\r\n\t\t\t\tconst bValue = b[sortConfig.key as keyof T];\r\n\r\n\t\t\t\tif (aValue < bValue) {\r\n\t\t\t\t\treturn sortConfig.direction === \"ascending\" ? -1 : 1;\r\n\t\t\t\t}\r\n\t\t\t\tif (aValue > bValue) {\r\n\t\t\t\t\treturn sortConfig.direction === \"ascending\" ? 1 : -1;\r\n\t\t\t\t}\r\n\t\t\t\treturn 0;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn filtered;\r\n\t}, [data, searchTerm, searchFields, sortConfig]);\r\n\r\n\treturn (\r\n\t\t<div className=\"space-y-4\">\r\n\t\t\t{/* Búsqueda */}\r\n\t\t\t{searchFields.length > 0 && (\r\n\t\t\t\t<div className=\"relative\">\r\n\t\t\t\t\t<input\r\n\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\tplaceholder=\"Buscar...\"\r\n\t\t\t\t\t\tclassName=\"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n\t\t\t\t\t\tvalue={searchTerm}\r\n\t\t\t\t\t\tonChange={(e) => setSearchTerm(e.target.value)}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Search className=\"absolute left-3 top-2.5 h-5 w-5 text-gray-400\" />\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{/* Tabla */}\r\n\t\t\t<div className=\"bg-white rounded-lg shadow-sm overflow-hidden\">\r\n\t\t\t\t{loading ? (\r\n\t\t\t\t\t<div className=\"p-8 flex justify-center\">\r\n\t\t\t\t\t\t<div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600\"></div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t) : filteredAndSortedData.length === 0 ? (\r\n\t\t\t\t\t<div className=\"p-8 text-center\">\r\n\t\t\t\t\t\t<h3 className=\"text-lg font-medium text-gray-900 mb-2\">\r\n\t\t\t\t\t\t\t{emptyMessage}\r\n\t\t\t\t\t\t</h3>\r\n\t\t\t\t\t\t<p className=\"text-gray-500\">\r\n\t\t\t\t\t\t\tIntente ajustar su búsqueda para encontrar lo que está buscando.\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t) : (\r\n\t\t\t\t\t<>\r\n\t\t\t\t\t\t<div className=\"overflow-x-auto\">\r\n\t\t\t\t\t\t\t<table className=\"min-w-full divide-y divide-gray-200\">\r\n\t\t\t\t\t\t\t\t<thead className=\"bg-gray-50\">\r\n\t\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t\t{columns.map((column) => (\r\n\t\t\t\t\t\t\t\t\t\t\t<th\r\n\t\t\t\t\t\t\t\t\t\t\t\tkey={column.key}\r\n\t\t\t\t\t\t\t\t\t\t\t\tscope=\"col\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center space-x-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span>{column.header}</span>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{column.sortable && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => handleSort(column.key)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"ml-1 focus:outline-none\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{sortConfig?.key === column.key ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsortConfig.direction === \"ascending\" ? (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ArrowUp\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize={14}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"text-primary-500\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ArrowDown\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize={14}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"text-primary-500\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"h-3.5 w-3.5\" /> // Espacio para alineación\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t</th>\r\n\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t</thead>\r\n\t\t\t\t\t\t\t\t<tbody className=\"bg-whitedivide-y divide-gray-200\">\r\n\t\t\t\t\t\t\t\t\t{filteredAndSortedData.map((item, index) => (\r\n\t\t\t\t\t\t\t\t\t\t<tr\r\n\t\t\t\t\t\t\t\t\t\t\tkey={index}\r\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"hover:bg-gray-50\"\r\n\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t{columns.map((column) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<td\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={column.key}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{column.render\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t? column.render(item)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t: String(item[column.key as keyof T] || \"\")}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</td>\r\n\t\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t\t\t</table>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{/* Paginación */}\r\n\t\t\t\t\t\t{pagination && (\r\n\t\t\t\t\t\t\t<div className=\"px-6 py-3 flex justify-between items-center border-t border-gray-200\">\r\n\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-gray-700\">\r\n\t\t\t\t\t\t\t\t\t\tMostrando{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium\">\r\n\t\t\t\t\t\t\t\t\t\t\t{(pagination.currentPage - 1) * pagination.itemsPerPage +\r\n\t\t\t\t\t\t\t\t\t\t\t\t1}\r\n\t\t\t\t\t\t\t\t\t\t</span>{\" \"}\r\n\t\t\t\t\t\t\t\t\t\ta{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium\">\r\n\t\t\t\t\t\t\t\t\t\t\t{Math.min(\r\n\t\t\t\t\t\t\t\t\t\t\t\tpagination.currentPage * pagination.itemsPerPage,\r\n\t\t\t\t\t\t\t\t\t\t\t\tpagination.totalItems\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t</span>{\" \"}\r\n\t\t\t\t\t\t\t\t\t\tde{\" \"}\r\n\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium\">{pagination.totalItems}</span>{\" \"}\r\n\t\t\t\t\t\t\t\t\t\telementos\r\n\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t<Pagination\r\n\t\t\t\t\t\t\t\t\tcurrentPage={pagination.currentPage}\r\n\t\t\t\t\t\t\t\t\ttotalPages={pagination.totalPages}\r\n\t\t\t\t\t\t\t\t\tonPageChange={pagination.onPageChange}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</>\r\n\t\t\t\t)}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n}\r\n\r\nexport default Table;\r\n","import React from \"react\";\r\nimport { ArrowUp, ArrowDown } from \"lucide-react\";\r\n\r\nexport interface DashboardCardProps {\r\n  title: string;\r\n  value: string | number;\r\n  change: number;\r\n  text?: string | React.ReactNode;\r\n  icon: React.ElementType;\r\n  iconBgColor?: string;\r\n  iconColor?: string;\r\n}\r\n\r\nconst DashboardCard: React.FC<DashboardCardProps> = ({\r\n  title,\r\n  value,\r\n  change,\r\n  text = null,\r\n  icon: Icon,\r\n  iconBgColor = \"bg-gray-100\",\r\n  iconColor = \"text-gray-600\",\r\n}) => {\r\n  const isPositive = change > 0;\r\n  const changeColor = isPositive\r\n    ? \"text-green-600\"\r\n    : \"text-red-600\";\r\n\r\n  return (\r\n    <div className=\"bg-white rounded-lg shadow-sm p-6 flex items-start justify-between\">\r\n      <div>\r\n        <p className=\"text-sm font-medium text-gray-500\">\r\n          {title}\r\n        </p>\r\n        <p className=\"text-2xl font-bold text-gray-900 mt-1\">\r\n          {value}\r\n        </p>\r\n        {change !== 0 && (\r\n          <div className={`flex items-center mt-2 ${changeColor}`}>\r\n            {isPositive ? <ArrowUp size={16} /> : <ArrowDown size={16} />}\r\n            <span className=\"ml-1 text-sm font-medium\">\r\n              {Math.abs(change)}% respecto al mes anterior\r\n            </span>\r\n          </div>\r\n        )}\r\n        {text && (\r\n          <span className=\"text-sm text-gray-500 mt-2\">\r\n            {text}\r\n          </span>\r\n        )}\r\n      </div>\r\n      <div className={`p-3 rounded-lg ${iconBgColor}`}>\r\n        <Icon className={`w-6 h-6 ${iconColor}`} />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DashboardCard;\r\n","import React from \"react\";\r\nimport DashboardCard from \"./DashboardCard\";\r\nimport type { DashboardCardProps } from \"./DashboardCard\";\r\n\r\ninterface DashboardCardListProps {\r\n  cards: DashboardCardProps[];\r\n}\r\n\r\nconst DashboardCardList: React.FC<DashboardCardListProps> = ({ cards }) => {\r\n  return (\r\n    <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6\">\r\n      {cards.map((card, index) => (\r\n        <DashboardCard key={index} {...card} />\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DashboardCardList;\r\n","import { Link } from \"react-router-dom\";\r\nimport { ChevronRight } from \"lucide-react\";\r\nimport type { FC } from \"react\";\r\n\r\ninterface CardPendingProps {\r\n  icon: React.ElementType;\r\n  iconBgColor: string;\r\n  iconColor: string;\r\n  title: string;\r\n  color?: boolean;\r\n  description: string;\r\n  linkText: string;\r\n  linkTo: string;\r\n}\r\n\r\nconst PendingCard: FC<CardPendingProps> = ({\r\n  icon: Icon,\r\n  iconBgColor,\r\n  iconColor,\r\n  title,\r\n  color = false,\r\n  description,\r\n  linkText,\r\n  linkTo,\r\n}) => {\r\n  return (\r\n\t\t<div\r\n\t\t\tclassName={`${color ? \"bg-white\" : \"bg-gray-50\"} p-4 rounded-lg flex items-start`}\r\n\t\t>\r\n\t\t\t<div className={`p-2 rounded-lg mr-3 ${iconBgColor}`}>\r\n\t\t\t\t<Icon className={`w-5 h-5 ${iconColor}`} />\r\n\t\t\t</div>\r\n\t\t\t<div>\r\n\t\t\t\t<h3 className=\"font-medium text-gray-900\">{title}</h3>\r\n\t\t\t\t<p className=\"text-sm text-gray-500 mb-2\">\r\n\t\t\t\t\t{description}\r\n\t\t\t\t</p>\r\n\t\t\t\t<Link\r\n\t\t\t\t\tto={linkTo}\r\n\t\t\t\t\tclassName=\"text-primary-600 text-sm font-medium hover:underline inline-flex items-center\"\r\n\t\t\t\t>\r\n\t\t\t\t\t{linkText} <ChevronRight size={16} />\r\n\t\t\t\t</Link>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default PendingCard;\r\n","import type { FC } from \"react\";\r\nimport CardPending from \"./PendingCard\";\r\n\r\ninterface CardPendingItem {\r\n  icon: React.ElementType;\r\n  iconBgColor: string;\r\n  iconColor: string;\r\n  title: string;\r\n  color?: boolean;\r\n  description: string;\r\n  linkText: string;\r\n  linkTo: string;\r\n}\r\n\r\ninterface CardPendingListProps {\r\n  items: CardPendingItem[];\r\n  color?: boolean\r\n}\r\n\r\nconst PendingCardList: FC<CardPendingListProps> = ({ items, color }) => {\r\n  return (\r\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\r\n        {items.map((item, index) => (\r\n          <CardPending key={index} {...item} color={color} />\r\n        ))}\r\n      </div>\r\n  );\r\n};\r\n\r\nexport default PendingCardList;\r\n","import React from 'react';\r\nimport type { TableHeaderProps } from '../../../types/dashboard/dataTable/DataTableTypes';\r\n\r\ninterface EmptyStateProps extends TableHeaderProps {\r\n  className?: string;\r\n}\r\n\r\nconst EmptyState: React.FC<EmptyStateProps> = ({\r\n  title,\r\n  className = \"\"\r\n}) => {\r\n  return (\r\n    <div className={`bg-white rounded-lg shadow-sm ${className}`}>\r\n      <div className=\"px-6 py-4 border-b border-gray-200\">\r\n        <h2 className=\"text-lg font-medium text-gray-900\">{title}</h2>\r\n      </div>\r\n      <div className=\"p-6 text-center text-gray-500\">\r\n        No hay datos disponibles\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default EmptyState;","// components/TableHeader.tsx\r\nimport React from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport { ChevronRight } from 'lucide-react';\r\nimport type { TableHeaderProps } from '../../../types/dashboard/dataTable/DataTableTypes';\r\n\r\nconst TableHeader: React.FC<TableHeaderProps> = ({\r\n  title,\r\n  viewAllLink,\r\n  viewAllText = \"Ver todo\"\r\n}) => {\r\n  return (\r\n    <div className=\"px-6 py-4 border-b border-gray-200 flex justify-between items-center\">\r\n      <h2 className=\"text-lg font-medium text-gray-900\">\r\n        {title}\r\n      </h2>\r\n      {viewAllLink && (\r\n        <Link\r\n          to={viewAllLink}\r\n          className=\"text-primary-600 text-sm font-medium hover:underline flex items-center\"\r\n        >\r\n          {viewAllText} <ChevronRight size={16} />\r\n        </Link>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default TableHeader;","// components/StandardTable.tsx\r\nimport React from 'react';\r\nimport TableHeader from './TableHeader';\r\nimport type { Column, TableProps } from '../../../types/dashboard/dataTable/DataTableTypes';\r\n\r\nfunction StandardTable<T extends Record<string, any>>({\r\n  data,\r\n  columns,\r\n  title,\r\n  viewAllLink,\r\n  viewAllText,\r\n  className = \"\",\r\n  onRowClick\r\n}: TableProps<T>): React.ReactElement {\r\n  // Helper function to render cell content based on column configuration\r\n  const renderCellContent = (row: T, column: Column<T>) => {\r\n    const value = row[column.key];\r\n    \r\n    // Use custom render function if provided\r\n    if (column.render) {\r\n      return column.render(value, row);\r\n    }\r\n    \r\n    // Default rendering based on value type\r\n    if (typeof value === 'undefined' || value === null) {\r\n      return '-';\r\n    }\r\n    \r\n    return value;\r\n  };\r\n\r\n  return (\r\n    <div className={`bg-white rounded-lg shadow-sm ${className}`}>\r\n      <TableHeader \r\n        title={title} \r\n        viewAllLink={viewAllLink} \r\n        viewAllText={viewAllText} \r\n      />\r\n      \r\n      <div className=\"overflow-x-auto\">\r\n        <table className=\"min-w-full\">\r\n          <thead className=\"bg-gray-50\">\r\n            <tr>\r\n              {columns.map((column, index) => (\r\n                <th \r\n                  key={index} \r\n                  className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\"\r\n                >\r\n                  {column.header}\r\n                </th>\r\n              ))}\r\n            </tr>\r\n          </thead>\r\n          <tbody className=\"bg-white divide-y divide-gray-200\">\r\n            {data.map((row, rowIndex) => (\r\n              <tr\r\n                key={rowIndex}\r\n                className={`hover:bg-gray-50 ${onRowClick ? 'cursor-pointer' : ''}`}\r\n                onClick={onRowClick ? () => onRowClick(row) : undefined}\r\n              >\r\n                {columns.map((column, colIndex) => (\r\n                  <td \r\n                    key={colIndex} \r\n                    className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\"\r\n                  >\r\n                    {renderCellContent(row, column)}\r\n                  </td>\r\n                ))}\r\n              </tr>\r\n            ))}\r\n          </tbody>\r\n        </table>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default StandardTable;","// components/CompactTable.tsx\r\nimport React from 'react';\r\nimport TableHeader from './TableHeader';\r\nimport type { Column, TableProps } from '../../../types/dashboard/dataTable/DataTableTypes';\r\n\r\nfunction CompactTable<T extends Record<string, any>>({\r\n  data,\r\n  columns,\r\n  title,\r\n  viewAllLink,\r\n  viewAllText,\r\n  className = \"\",\r\n  onRowClick\r\n}: TableProps<T>): React.ReactElement {\r\n  // Helper function to render cell content based on column configuration\r\n  const renderCellContent = (row: T, column: Column<T>) => {\r\n    const value = row[column.key];\r\n    \r\n    // Use custom render function if provided\r\n    if (column.render) {\r\n      return column.render(value, row);\r\n    }\r\n    \r\n    // Default rendering based on value type\r\n    if (typeof value === 'undefined' || value === null) {\r\n      return '-';\r\n    }\r\n    \r\n    return value;\r\n  };\r\n\r\n  return (\r\n    <div className={`bg-white rounded-lg shadow-sm ${className}`}>\r\n      <TableHeader \r\n        title={title} \r\n        viewAllLink={viewAllLink} \r\n        viewAllText={viewAllText} \r\n      />\r\n      \r\n      {/* Compact list */}\r\n      <div className=\"divide-y divide-gray-200\">\r\n        {data.map((row, rowIndex) => (\r\n          <div \r\n            key={rowIndex}\r\n            className={`px-6 py-3 flex flex-wrap items-center gap-3 hover:bg-gray-50 ${onRowClick ? 'cursor-pointer' : ''}`}\r\n            onClick={onRowClick ? () => onRowClick(row) : undefined}\r\n          >\r\n            {columns.map((column, colIndex) => (\r\n              <div key={colIndex} className=\"flex items-center\">\r\n                {column.showLabelInCompact && (\r\n                  <span className=\"text-xs text-gray-500 mr-1\">\r\n                    {column.header}:\r\n                  </span>\r\n                )}\r\n                <span className=\"text-sm\">\r\n                  {renderCellContent(row, column)}\r\n                </span>\r\n              </div>\r\n            ))}\r\n          </div>\r\n        ))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default CompactTable;","import React from 'react';\r\nimport EmptyState from './EmptyState';\r\nimport StandardTable from './StandardTable';\r\nimport CompactTable from './CompactTable';\r\nimport type { TableProps } from '../../../types/dashboard/dataTable/DataTableTypes';\r\n\r\n// This is a factory component that decides which type of table to render\r\nfunction DataTable<T extends Record<string, any>>(props: TableProps<T>): React.ReactElement {\r\n  const { data, compact = false } = props;\r\n\r\n  // Show empty state if no data\r\n  if (!data || data.length === 0) {\r\n    return <EmptyState title={props.title} className={props.className} />;\r\n  }\r\n\r\n  // Return the appropriate table based on the compact flag\r\n  return compact \r\n    ? <CompactTable<T> {...props} />\r\n    : <StandardTable<T> {...props} />;\r\n}\r\n\r\nexport default DataTable;","import type { FC } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { AlertTriangle } from \"lucide-react\";\r\n\r\ninterface AlertCardProps {\r\n  icon?: React.ElementType;\r\n  borderColor: string;\r\n  bgColor: string;\r\n  iconColor: string;\r\n  title: string;\r\n  description: string;\r\n  linkText: string;\r\n  linkTo: string;\r\n  textColor: string;\r\n  hoverTextColor: string;\r\n}\r\n\r\nconst AlertCard: FC<AlertCardProps> = ({\r\n  icon: Icon = AlertTriangle,\r\n  borderColor,\r\n  bgColor,\r\n  iconColor,\r\n  title,\r\n  description,\r\n  linkText,\r\n  linkTo,\r\n  textColor,\r\n  hoverTextColor,\r\n}) => {\r\n  return (\r\n    <div className={`${bgColor} border-l-4 ${borderColor} p-4 rounded-r-lg`}>\r\n      <div className=\"flex\">\r\n        <div className=\"flex-shrink-0\">\r\n          <Icon className={`h-5 w-5 ${iconColor}`} />\r\n        </div>\r\n        <div className=\"ml-3\">\r\n          <h3 className={`text-sm font-medium ${textColor}`}>{title}</h3>\r\n          <div className={`mt-2 text-sm ${textColor}`}>\r\n            <p>{description}</p>\r\n          </div>\r\n          <div className=\"mt-3\">\r\n            <Link\r\n              to={linkTo}\r\n              className={`text-sm font-medium ${textColor} hover:${hoverTextColor}`}\r\n            >\r\n              {linkText}\r\n            </Link>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AlertCard;\r\n","import type { FC } from \"react\";\r\nimport AlertCard from \"./AlertCard\";\r\n\r\ninterface AlertCardItem {\r\n  icon?: React.ElementType;\r\n  borderColor: string;\r\n  bgColor: string;\r\n  iconColor: string;\r\n  title: string;\r\n  description: string;\r\n  linkText: string;\r\n  linkTo: string;\r\n  textColor: string;\r\n  hoverTextColor: string;\r\n}\r\n\r\ninterface AlertCardListProps {\r\n  items: AlertCardItem[];\r\n}\r\n\r\nconst AlertCardList: FC<AlertCardListProps> = ({ items }) => {\r\n  return (\r\n    <div className=\"space-y-4\">\r\n      {items.map((item, index) => (\r\n        <AlertCard key={index} {...item} />\r\n      ))}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AlertCardList;\r\n","import React from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport DataTable from './dataTable/DataTable';\r\nimport { formatCurrency } from '../../../utils/formatters/formatCurrency';\r\nimport type { Order, Column, BaseTableProps, TableHeaderProps } from '../../types/dashboard/dataTable/DataTableTypes';\r\n\r\n// Define the columns for the orders table\r\nconst getOrderColumns = (): Column<Order>[] => [\r\n  {\r\n    key: 'id',\r\n    header: 'ID Pedido',\r\n    showLabelInCompact: false,\r\n    render: (value) => (\r\n      <Link to={`/admin/orders/${value}`} className=\"text-primary-600 hover:underline font-medium\">\r\n        #{value}\r\n      </Link>\r\n    )\r\n  },\r\n  {\r\n    key: 'date',\r\n    header: 'Fecha',\r\n    showLabelInCompact: true\r\n  },\r\n  {\r\n    key: 'customer',\r\n    header: 'Cliente',\r\n    showLabelInCompact: true,\r\n    render: (value) => (\r\n      <span className=\"text-gray-900\">{value}</span>\r\n    )\r\n  },\r\n  {\r\n    key: 'total',\r\n    header: 'Total',\r\n    showLabelInCompact: true,\r\n    render: (value) => formatCurrency(value)\r\n  },\r\n  {\r\n    key: 'status',\r\n    header: 'Estado',\r\n    showLabelInCompact: true,\r\n    render: (value) => {\r\n      let bgColorClass = 'bg-yellow-100 text-yellow-800';\r\n      let displayText = 'En Proceso';\r\n      \r\n      if (value === 'Completed') {\r\n        bgColorClass = 'bg-green-100 text-green-800';\r\n        displayText = 'Completado';\r\n      } else if (value === 'Shipped') {\r\n        bgColorClass = 'bg-blue-100 text-blue-800';\r\n        displayText = 'Enviado';\r\n      }\r\n      \r\n      return (\r\n        <span className={`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${bgColorClass}`}>\r\n          {displayText}\r\n        </span>\r\n      );\r\n    }\r\n  }\r\n];\r\n\r\ninterface OrdersTableProps extends BaseTableProps, TableHeaderProps {\r\n  orders: Order[];\r\n  compact?: boolean;\r\n  onOrderClick?: (order: Order) => void;\r\n}\r\n\r\nconst OrdersTable: React.FC<OrdersTableProps> = ({\r\n  orders,\r\n  title,\r\n  viewAllLink,\r\n  viewAllText,\r\n  compact = false,\r\n  className = \"\",\r\n  onOrderClick\r\n}) => {\r\n  return (\r\n    <DataTable<Order>\r\n      data={orders}\r\n      columns={getOrderColumns()}\r\n      title={title}\r\n      viewAllLink={viewAllLink}\r\n      viewAllText={viewAllText}\r\n      compact={compact}\r\n      className={className}\r\n      onRowClick={onOrderClick}\r\n    />\r\n  );\r\n};\r\n\r\nexport default OrdersTable;","import React from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport DataTable from './dataTable/DataTable';\r\nimport { formatCurrency } from '../../../utils/formatters/formatCurrency';\r\nimport type { Seller, Column, BaseTableProps, TableHeaderProps } from '../../types/dashboard/dataTable/DataTableTypes';\r\n\r\n// Define the columns for the sellers table\r\nconst getSellerColumns = (): Column<Seller>[] => [\r\n  {\r\n    key: 'name',\r\n    header: 'Vendedor',\r\n    showLabelInCompact: false,\r\n    render: (value, row) => (\r\n      <Link to={`/admin/sellers/${row.id}`} className=\"text-primary-600 hover:underline font-medium\">\r\n        {value}\r\n      </Link>\r\n    )\r\n  },\r\n  {\r\n    key: 'orderCount',\r\n    header: 'Pedidos',\r\n    showLabelInCompact: true\r\n  },\r\n  {\r\n    key: 'revenue',\r\n    header: 'Ingresos',\r\n    showLabelInCompact: true,\r\n    render: (value) => formatCurrency(value)\r\n  }\r\n];\r\n\r\ninterface SellersTableProps extends BaseTableProps, TableHeaderProps {\r\n  sellers: Seller[];\r\n  compact?: boolean;\r\n  onSellerClick?: (seller: Seller) => void;\r\n}\r\n\r\nconst SellersTable: React.FC<SellersTableProps> = ({\r\n  sellers,\r\n  title,\r\n  viewAllLink,\r\n  viewAllText,\r\n  compact = false,\r\n  className = \"\",\r\n  onSellerClick\r\n}) => {\r\n  return (\r\n    <DataTable<Seller>\r\n      data={sellers}\r\n      columns={getSellerColumns()}\r\n      title={title}\r\n      viewAllLink={viewAllLink}\r\n      viewAllText={viewAllText}\r\n      compact={compact}\r\n      className={className}\r\n      onRowClick={onSellerClick}\r\n    />\r\n  );\r\n};\r\n\r\nexport default SellersTable;","import { ApiClient } from '../api/apiClient';\r\n\r\nexport interface AdminDashboardStats {\r\n  main_stats: {\r\n    total_sales: {\r\n      value: string;\r\n      change: number;\r\n      formatted_value: string;\r\n    };\r\n    total_users: {\r\n      value: number;\r\n      change: number;\r\n      formatted_value: string;\r\n    };\r\n    total_orders: {\r\n      value: number;\r\n      change: number;\r\n      formatted_value: string;\r\n    };\r\n    active_products: {\r\n      value: string;\r\n      change: number;\r\n      active_count: number;\r\n      total_count: number;\r\n      formatted_value: string;\r\n    };\r\n  };\r\n  pending_items: {\r\n    pending_ratings: {\r\n      count: number;\r\n      message: string;\r\n    };\r\n    pending_sellers: {\r\n      count: number;\r\n      message: string;\r\n    };\r\n    pending_feedback: {\r\n      count: number;\r\n      message: string;\r\n    };\r\n  };\r\n  system_alerts: Array<{\r\n    type: string;\r\n    title: string;\r\n    description: string;\r\n    count: number;\r\n    link_to: string;\r\n  }>;\r\n  recent_orders: Array<{\r\n    id: string;\r\n    date: string;\r\n    customer: string;\r\n    total: number;\r\n    status: string;\r\n    formatted_total: string;\r\n  }>;\r\n  top_sellers: Array<{\r\n    id: number;\r\n    name: string;\r\n    order_count: number;\r\n    revenue: number;\r\n    formatted_revenue: string;\r\n  }>;\r\n  performance_metrics: {\r\n    conversion_rate: number;\r\n    average_order_value: number;\r\n    order_fulfillment_rate: number;\r\n    customer_retention_rate: number;\r\n    daily_stats: Array<{\r\n      date: string;\r\n      order_count: number;\r\n      daily_revenue: string;\r\n      unique_customers: number;\r\n    }>;\r\n    system_health: {\r\n      error_rate: number;\r\n      average_response_time: number;\r\n      uptime: string;\r\n    };\r\n  };\r\n  last_updated: string;\r\n}\r\n\r\nexport interface AdminDashboardResponse {\r\n  success: boolean;\r\n  data: AdminDashboardStats;\r\n  message?: string;\r\n  error?: string;\r\n}\r\n\r\nexport class AdminDashboardService {\r\n  /**\r\n   * Get comprehensive dashboard statistics for admin\r\n   */\r\n  async getDashboardStats(): Promise<AdminDashboardStats> {\r\n    try {\r\n      const response = await ApiClient.get<AdminDashboardResponse>('/admin/dashboard');\r\n      \r\n      if (!response.success) {\r\n        throw new Error(response.message || 'Failed to fetch dashboard statistics');\r\n      }\r\n\r\n      return response.data;\r\n    } catch (error) {\r\n      console.error('Error fetching dashboard statistics:', error);\r\n      throw error;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Transform backend data to frontend format for backward compatibility\r\n   */\r\n  transformToLegacyFormat(stats: AdminDashboardStats) {\r\n    return {\r\n      // Main statistics cards\r\n      cards: [\r\n        {\r\n          title: \"Ventas Totales\",\r\n          value: stats.main_stats.total_sales.formatted_value,\r\n          change: stats.main_stats.total_sales.change,\r\n          icon: \"DollarSign\",\r\n          iconBgColor: \"bg-green-50\",\r\n          iconColor: \"text-green-600\",\r\n        },\r\n        {\r\n          title: \"Usuarios Totales\",\r\n          value: stats.main_stats.total_users.value,\r\n          change: stats.main_stats.total_users.change,\r\n          icon: \"Users\",\r\n          iconBgColor: \"bg-blue-50\",\r\n          iconColor: \"text-blue-600\",\r\n        },\r\n        {\r\n          title: \"Pedidos Totales\",\r\n          value: stats.main_stats.total_orders.value,\r\n          change: stats.main_stats.total_orders.change,\r\n          icon: \"ShoppingBag\",\r\n          iconBgColor: \"bg-purple-50\",\r\n          iconColor: \"text-purple-600\",\r\n        },\r\n        {\r\n          title: \"Productos Activos\",\r\n          value: stats.main_stats.active_products.formatted_value,\r\n          change: stats.main_stats.active_products.change,\r\n          icon: \"Package\",\r\n          iconBgColor: \"bg-yellow-50\",\r\n          iconColor: \"text-yellow-600\",\r\n        },\r\n      ],\r\n\r\n      // Pending moderation items\r\n      pendingCardItems: [\r\n        {\r\n          icon: \"Star\",\r\n          iconBgColor: \"bg-yellow-50\",\r\n          iconColor: \"text-yellow-600\",\r\n          title: \"Valoraciones y Reseñas\",\r\n          description: stats.pending_items.pending_ratings.message,\r\n          linkText: \"Moderar Reseñas\",\r\n          linkTo: \"/admin/ratings?status=pending\",\r\n        },\r\n        {\r\n          icon: \"Briefcase\",\r\n          iconBgColor: \"bg-blue-50\",\r\n          iconColor: \"text-blue-600\",\r\n          title: \"Solicitudes de Vendedores\",\r\n          description: stats.pending_items.pending_sellers.message,\r\n          linkText: \"Ver solicitudes\",\r\n          linkTo: \"/admin/sellers?status=pending\",\r\n        },\r\n        {\r\n          icon: \"MessageSquare\",\r\n          iconBgColor: \"bg-purple-50\",\r\n          iconColor: \"text-purple-600\",\r\n          title: \"Customer Feedback\",\r\n          description: stats.pending_items.pending_feedback.message,\r\n          linkText: \"Revisar Comentarios\",\r\n          linkTo: \"/admin/feedback?status=pending\",\r\n        },\r\n      ],\r\n\r\n      // System alerts\r\n      alertItems: stats.system_alerts.map(alert => ({\r\n        icon: \"AlertTriangle\",\r\n        borderColor: alert.type === 'error' ? \"border-red-500\" : \"border-amber-500\",\r\n        bgColor: alert.type === 'error' ? \"bg-red-50\" : \"bg-amber-50\",\r\n        iconColor: alert.type === 'error' ? \"text-red-500\" : \"text-amber-500\",\r\n        title: alert.title,\r\n        description: alert.description,\r\n        linkText: \"Ver detalles\",\r\n        linkTo: alert.link_to,\r\n        textColor: alert.type === 'error' ? \"text-red-800\" : \"text-amber-800\",\r\n        hoverTextColor: alert.type === 'error' ? \"text-red-600\" : \"text-amber-600\",\r\n      })),\r\n\r\n      // Recent orders\r\n      recentOrders: stats.recent_orders.map(order => ({\r\n        id: order.id,\r\n        date: order.date,\r\n        customer: order.customer,\r\n        total: order.total,\r\n        status: this.mapOrderStatus(order.status),\r\n      })),\r\n\r\n      // Top sellers\r\n      topSellers: stats.top_sellers.map(seller => ({\r\n        id: seller.id,\r\n        name: seller.name,\r\n        orderCount: seller.order_count,\r\n        revenue: seller.revenue,\r\n      })),\r\n\r\n      // Performance metrics\r\n      performanceMetrics: stats.performance_metrics,\r\n\r\n      // Metadata\r\n      lastUpdated: stats.last_updated,\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Map backend order status to frontend expected values\r\n   */\r\n  private mapOrderStatus(backendStatus: string): \"Completed\" | \"Processing\" | \"Shipped\" {\r\n    const statusMap: { [key: string]: \"Completed\" | \"Processing\" | \"Shipped\" } = {\r\n      'Completado': 'Completed',\r\n      'completed': 'Completed',\r\n      'Completed': 'Completed',\r\n      'Procesando': 'Processing', \r\n      'processing': 'Processing',\r\n      'Processing': 'Processing',\r\n      'Pendiente': 'Processing',\r\n      'pending': 'Processing',\r\n      'Enviado': 'Shipped',\r\n      'shipped': 'Shipped',\r\n      'Shipped': 'Shipped',\r\n      'delivered': 'Shipped',\r\n      'Entregado': 'Shipped',\r\n    };\r\n\r\n    return statusMap[backendStatus] || 'Processing';\r\n  }\r\n}\r\n\r\nexport const adminDashboardService = new AdminDashboardService();\r\nexport default adminDashboardService;","import { useState, useEffect, useCallback } from 'react';\r\nimport { adminDashboardService } from '../../infrastructure/services/AdminDashboardService';\r\nimport type { AdminDashboardStats } from '../../infrastructure/services/AdminDashboardService';\r\n\r\ninterface UseAdminDashboardReturn {\r\n  stats: AdminDashboardStats | null;\r\n  transformedData: ReturnType<typeof adminDashboardService.transformToLegacyFormat> | null;\r\n  loading: boolean;\r\n  error: string | null;\r\n  refetch: () => Promise<void>;\r\n  lastUpdated: string | null;\r\n}\r\n\r\nexport const useAdminDashboard = (autoRefresh = false, refreshInterval = 60000): UseAdminDashboardReturn => {\r\n  const [stats, setStats] = useState<AdminDashboardStats | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [lastUpdated, setLastUpdated] = useState<string | null>(null);\r\n\r\n  const fetchDashboardStats = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      \r\n      const dashboardStats = await adminDashboardService.getDashboardStats();\r\n      setStats(dashboardStats);\r\n      setLastUpdated(new Date().toISOString());\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Error fetching dashboard statistics');\r\n      console.error('Dashboard stats fetch error:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, []);\r\n\r\n  // Initial fetch\r\n  useEffect(() => {\r\n    fetchDashboardStats();\r\n  }, [fetchDashboardStats]);\r\n\r\n  // Auto refresh setup\r\n  useEffect(() => {\r\n    if (!autoRefresh) return;\r\n\r\n    const interval = setInterval(() => {\r\n      fetchDashboardStats();\r\n    }, refreshInterval);\r\n\r\n    return () => clearInterval(interval);\r\n  }, [autoRefresh, refreshInterval, fetchDashboardStats]);\r\n\r\n  // Transform data for legacy component compatibility\r\n  const transformedData = stats ? adminDashboardService.transformToLegacyFormat(stats) : null;\r\n\r\n  return {\r\n    stats,\r\n    transformedData,\r\n    loading,\r\n    error,\r\n    refetch: fetchDashboardStats,\r\n    lastUpdated,\r\n  };\r\n};\r\n\r\nexport default useAdminDashboard;","import React from \"react\";\r\nimport { useNavigate } from 'react-router-dom';\r\nimport {\r\n\tDollarSign,\r\n\tUsers,\r\n\tShoppingBag,\r\n\tPackage,\r\n\tAlertTriangle,\r\n\tBriefcase,\r\n\tStar,\r\n\tMessageSquare,\r\n\tRefreshCw,\r\n\tClock,\r\n} from \"lucide-react\";\r\nimport DashboardCardList from \"../../components/dashboard/DashboardCardList\";\r\nimport PendingCardList from \"../../components/dashboard/PendingCardList\";\r\nimport AlertCardList from \"../../components/dashboard/AlertCardList\";\r\nimport OrdersTable from '../../components/dashboard/OrdersSimpleTable';\r\nimport SellersTable from '../../components/dashboard/SellersSimpleTable';\r\nimport type { Order, Seller } from '../../types/dashboard/dataTable/DataTableTypes';\r\nimport { useAdminDashboard } from '../../hooks/useAdminDashboard';\r\n\r\n// Component now uses real API data\r\n  \r\n\r\nconst AdminDashboard: React.FC = () => {\r\n  const navigate = useNavigate();\r\n  const { transformedData, loading, error, refetch, lastUpdated } = useAdminDashboard(true, 300000); // Auto-refresh every 5 minutes\r\n\r\n  const handleOrderClick = (order: Order) => {\r\n    navigate(`/admin/orders/${order.id}`);\r\n  };\r\n\r\n  const handleSellerClick = (seller: Seller) => {\r\n    navigate(`/admin/sellers/${seller.id}`);\r\n  };\r\n\r\n  const handleRefresh = async () => {\r\n    await refetch();\r\n  };\r\n\r\n  // Loading state\r\n  if (loading && !transformedData) {\r\n    return (\r\n      <div className=\"space-y-6\">\r\n        <h1 className=\"text-2xl font-bold text-gray-900\">Dashboard Admin</h1>\r\n        <div className=\"flex items-center justify-center py-12\">\r\n          <RefreshCw className=\"w-6 h-6 animate-spin text-gray-400 mr-2\" />\r\n          <span className=\"text-gray-600\">Cargando estadísticas del dashboard...</span>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  // Error state\r\n  if (error && !transformedData) {\r\n    return (\r\n      <div className=\"space-y-6\">\r\n        <h1 className=\"text-2xl font-bold text-gray-900\">Dashboard Admin</h1>\r\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\r\n          <div className=\"flex items-center\">\r\n            <AlertTriangle className=\"w-5 h-5 text-red-400 mr-2\" />\r\n            <div>\r\n              <h3 className=\"text-sm font-medium text-red-800\">Error cargando dashboard</h3>\r\n              <p className=\"text-sm text-red-700 mt-1\">{error}</p>\r\n              <button\r\n                onClick={handleRefresh}\r\n                className=\"mt-2 text-sm bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded-md transition-colors\"\r\n              >\r\n                Intentar nuevamente\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  if (!transformedData) {\r\n    return null;\r\n  }\r\n\r\n  // Icon mapping helper\r\n  const getIcon = (iconName: string) => {\r\n    const icons: { [key: string]: any } = {\r\n      DollarSign,\r\n      Users,\r\n      ShoppingBag,\r\n      Package,\r\n      Star,\r\n      Briefcase,\r\n      MessageSquare,\r\n      AlertTriangle,\r\n    };\r\n    return icons[iconName] || AlertTriangle;\r\n  };\r\n\r\n  // Map cards with real icons\r\n  const cardsWithIcons = transformedData.cards.map(card => ({\r\n    ...card,\r\n    icon: getIcon(card.icon),\r\n  }));\r\n\r\n  // Map pending items with real icons\r\n  const pendingItemsWithIcons = transformedData.pendingCardItems.map(item => ({\r\n    ...item,\r\n    icon: getIcon(item.icon),\r\n  }));\r\n\r\n  // Map alert items with real icons\r\n  const alertItemsWithIcons = transformedData.alertItems.map(item => ({\r\n    ...item,\r\n    icon: getIcon(item.icon),\r\n  }));\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      {/* Header with refresh button */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <h1 className=\"text-2xl font-bold text-gray-900\">Dashboard Admin</h1>\r\n        <div className=\"flex items-center space-x-3\">\r\n          {lastUpdated && (\r\n            <div className=\"flex items-center text-sm text-gray-500\">\r\n              <Clock className=\"w-4 h-4 mr-1\" />\r\n              Actualizado: {new Date(lastUpdated).toLocaleTimeString()}\r\n            </div>\r\n          )}\r\n          <button\r\n            onClick={handleRefresh}\r\n            disabled={loading}\r\n            className=\"flex items-center px-3 py-2 text-sm bg-primary-600 hover:bg-primary-700 disabled:bg-primary-400 text-white rounded-md transition-colors\"\r\n          >\r\n            <RefreshCw className={`w-4 h-4 mr-1 ${loading ? 'animate-spin' : ''}`} />\r\n            Actualizar\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Stats Cards */}\r\n      <DashboardCardList cards={cardsWithIcons} />\r\n\r\n      {/* Pending Moderation */}\r\n      <div className=\"bg-white rounded-lg shadow-sm p-6\">\r\n        <h2 className=\"text-lg font-medium text-gray-900 mb-4\">\r\n          Moderación Pendiente\r\n        </h2>\r\n        <PendingCardList items={pendingItemsWithIcons} />\r\n      </div>\r\n\r\n      {/* Recent Orders & Top Sellers */}\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n        {/* Recent Orders */}\r\n        <OrdersTable\r\n          orders={transformedData.recentOrders}\r\n          title=\"Pedidos Recientes\"\r\n          viewAllLink=\"/admin/orders\"\r\n          onOrderClick={handleOrderClick}\r\n        />\r\n        {/* Top Sellers */}\r\n        <SellersTable\r\n          sellers={transformedData.topSellers}\r\n          title=\"Mejores Vendedores\"\r\n          viewAllLink=\"/admin/sellers\"\r\n          onSellerClick={handleSellerClick}\r\n        />\r\n      </div>\r\n\r\n      {/* System Alerts */}\r\n      {alertItemsWithIcons.length > 0 && (\r\n        <div className=\"bg-white rounded-lg shadow-sm p-6\">\r\n          <div className=\"flex items-center mb-4\">\r\n            <AlertTriangle className=\"w-5 h-5 text-amber-500 mr-2\" />\r\n            <h2 className=\"text-lg font-medium text-gray-900\">\r\n              Alertas del Sistema\r\n            </h2>\r\n          </div>\r\n          <AlertCardList items={alertItemsWithIcons} />\r\n        </div>\r\n      )}\r\n\r\n      {/* Performance Metrics Summary (Optional) */}\r\n      {transformedData.performanceMetrics && (\r\n        <div className=\"bg-white rounded-lg shadow-sm p-6\">\r\n          <h2 className=\"text-lg font-medium text-gray-900 mb-4\">Métricas de Rendimiento</h2>\r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n            <div className=\"text-center\">\r\n              <div className=\"text-2xl font-bold text-primary-600\">\r\n                {transformedData.performanceMetrics.conversion_rate.toFixed(1)}%\r\n              </div>\r\n              <div className=\"text-sm text-gray-600\">Tasa de Conversión</div>\r\n            </div>\r\n            <div className=\"text-center\">\r\n              <div className=\"text-2xl font-bold text-green-600\">\r\n                ${transformedData.performanceMetrics.average_order_value.toFixed(2)}\r\n              </div>\r\n              <div className=\"text-sm text-gray-600\">Valor Promedio de Orden</div>\r\n            </div>\r\n            <div className=\"text-center\">\r\n              <div className=\"text-2xl font-bold text-purple-600\">\r\n                {transformedData.performanceMetrics.order_fulfillment_rate.toFixed(1)}%\r\n              </div>\r\n              <div className=\"text-sm text-gray-600\">Tasa de Cumplimiento</div>\r\n            </div>\r\n            <div className=\"text-center\">\r\n              <div className=\"text-2xl font-bold text-orange-600\">\r\n                {transformedData.performanceMetrics.customer_retention_rate.toFixed(1)}%\r\n              </div>\r\n              <div className=\"text-sm text-gray-600\">Retención de Clientes</div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default AdminDashboard;\r\n","// src/core/services/AdminUserService.ts\r\nimport axiosInstance from \"../../infrastructure/api/axiosConfig\";\r\nimport {API_ENDPOINTS} from \"../../constants/apiEndpoints\";\r\nimport type {UserListResponse} from \"../domain/entities/User\";\r\nimport type {User} from \"../domain/entities/User\";\r\n\r\n/**\r\n * Servicio para la gestión de usuarios desde el panel de administración\r\n */\r\nexport class AdminUserService {\r\n\t/**\r\n\t * Obtiene la lista de usuarios con paginación\r\n\t * @param page Número de página\r\n\t * @param perPage Cantidad de elementos por página\r\n\t * @returns Lista paginada de usuarios\r\n\t */\r\n\tasync getUsers(page = 1, perPage = 15): Promise<UserListResponse> {\r\n\t\tconst response = await axiosInstance.get(API_ENDPOINTS.ADMIN.USERS, {\r\n\t\t\tparams: {page, per_page: perPage},\r\n\t\t});\r\n\t\treturn response.data;\r\n\t}\r\n\r\n\t/**\r\n\t * Bloquea a un usuario\r\n\t * @param userId ID del usuario a bloquear\r\n\t * @returns true si se bloqueó correctamente\r\n\t */\r\n\tasync blockUser(userId: number): Promise<boolean> {\r\n\t\tconst response = await axiosInstance.put(\r\n\t\t\tAPI_ENDPOINTS.ADMIN.BLOCK_USER(userId)\r\n\t\t);\r\n\t\treturn response.data.success;\r\n\t}\r\n\r\n\t/**\r\n\t * Desbloquea a un usuario\r\n\t * @param userId ID del usuario a desbloquear\r\n\t * @returns true si se desbloqueó correctamente\r\n\t */\r\n\tasync unblockUser(userId: number): Promise<boolean> {\r\n\t\tconst response = await axiosInstance.put(\r\n\t\t\tAPI_ENDPOINTS.ADMIN.UNBLOCK_USER(userId)\r\n\t\t);\r\n\t\treturn response.data.success;\r\n\t}\r\n\r\n\t/**\r\n\t * Envía un correo para restablecer contraseña\r\n\t * @param userId ID del usuario\r\n\t * @returns true si se envió correctamente\r\n\t */\r\n\tasync sendPasswordResetEmail(userId: number): Promise<boolean> {\r\n\t\tconst response = await axiosInstance.post(\r\n\t\t\tAPI_ENDPOINTS.ADMIN.RESET_PASSWORD(userId)\r\n\t\t);\r\n\t\treturn response.data.success;\r\n\t}\r\n\r\n\t/**\r\n\t * Obtiene detalles de un usuario específico\r\n\t * @param userId ID del usuario\r\n\t * @returns Datos del usuario\r\n\t */\r\n\tasync getUserDetails(userId: number): Promise<User> {\r\n\t\tconst response = await axiosInstance.get(\r\n\t\t\tAPI_ENDPOINTS.ADMIN.USER_DETAIL(userId)\r\n\t\t);\r\n\t\treturn response.data;\r\n\t}\r\n\r\n\t/**\r\n\t * Actualiza rol de usuario a administrador\r\n\t * @param userId ID del usuario a promover\r\n\t * @returns true si se actualizó correctamente\r\n\t */\r\n\tasync makeAdmin(userId: number): Promise<boolean> {\r\n\t\tconst response = await axiosInstance.put(\r\n\t\t\tAPI_ENDPOINTS.ADMIN.MAKE_ADMIN(userId)\r\n\t\t);\r\n\t\treturn response.data.success;\r\n\t}\r\n\r\n\t/**\r\n\t * Convierte un usuario en vendedor\r\n\t * @param userId ID del usuario a convertir\r\n\t * @param storeData Datos de la tienda\r\n\t * @returns true si se creó correctamente\r\n\t */\r\n\tasync makeSeller(\r\n\t\tuserId: number,\r\n\t\tstoreData: {store_name: string; description?: string}\r\n\t): Promise<boolean> {\r\n\t\tconst response = await axiosInstance.post(\r\n\t\t\tAPI_ENDPOINTS.ADMIN.MAKE_SELLER(userId),\r\n\t\t\tstoreData\r\n\t\t);\r\n\t\treturn response.data.success;\r\n\t}\r\n\r\n\t/**\r\n\t * Elimina un usuario del sistema\r\n\t * @param userId ID del usuario a eliminar\r\n\t * @returns true si se eliminó correctamente\r\n\t */\r\n\tasync deleteUser(userId: number): Promise<boolean> {\r\n\t\tconst response = await axiosInstance.delete(\r\n\t\t\tAPI_ENDPOINTS.ADMIN.DELETE_USER(userId)\r\n\t\t);\r\n\t\treturn response.data.success;\r\n\t}\r\n}\r\n\r\nexport default AdminUserService;\r\n","// src/presentation/hooks/useAdminUsers.ts\r\nimport {useState, useCallback} from \"react\";\r\nimport AdminUserService from \"../../core/services/AdminUserService\";\r\nimport {extractErrorMessage} from \"../../utils/errorHandler\";\r\n\r\n// Tipo de usuario para el componente AdminUsersPage\r\nexport interface AdminUserData {\r\n\tid: number;\r\n\tname: string;\r\n\temail: string;\r\n\trole: \"customer\" | \"seller\" | \"admin\";\r\n\tstatus: \"active\" | \"blocked\";\r\n\tlastLogin: string;\r\n\tregisteredDate: string;\r\n\tordersCount: number;\r\n}\r\n\r\n// Tipo para opciones de filtrado\r\ninterface FilterOptions {\r\n\trole?: string;\r\n\tstatus?: string;\r\n\tsearchTerm?: string;\r\n}\r\n\r\n/**\r\n * Hook personalizado para gestión de usuarios desde administración\r\n */\r\nexport const useAdminUsers = () => {\r\n\tconst [users, setUsers] = useState<AdminUserData[]>([]);\r\n\tconst [loading, setLoading] = useState(true);\r\n\tconst [error, setError] = useState<string | null>(null);\r\n\tconst [pagination, setPagination] = useState({\r\n\t\tcurrentPage: 1,\r\n\t\ttotalPages: 5,\r\n\t\ttotalItems: 0,\r\n\t\titemsPerPage: 10,\r\n\t});\r\n\r\n\t// Instancia del servicio\r\n\tconst adminUserService = new AdminUserService();\r\n\r\n\t/**\r\n\t * Mapea el usuario de la API al formato esperado por el componente\r\n\t */\r\n\tconst mapApiUserToAdminUserData = (apiUser: any): AdminUserData => {\r\n\t\t// Determinar el rol\r\n\t\tlet role: \"customer\" | \"seller\" | \"admin\" = \"customer\";\r\n\t\tif (apiUser.is_admin) role = \"admin\";\r\n\t\telse if (apiUser.is_seller) role = \"seller\";\r\n\r\n\t\t// Mapear el estado (is_blocked -> status)\r\n\t\tconst status: \"active\" | \"blocked\" = apiUser.is_blocked\r\n\t\t\t? \"blocked\"\r\n\t\t\t: \"active\";\r\n\r\n\t\treturn {\r\n\t\t\tid: apiUser.id,\r\n\t\t\tname: apiUser.name,\r\n\t\t\temail: apiUser.email,\r\n\t\t\trole,\r\n\t\t\tstatus,\r\n\t\t\tlastLogin: apiUser.last_login_at || \"N/A\",\r\n\t\t\tregisteredDate: apiUser.created_at,\r\n\t\t\tordersCount: apiUser.orders_count || 0,\r\n\t\t};\r\n\t};\r\n\r\n\t/**\r\n\t * Carga la lista de usuarios desde la API\r\n\t */\r\n\tconst fetchUsers = useCallback(async (page = 1, perPage = 10) => {\r\n\t\tsetLoading(true);\r\n\t\tsetError(null);\r\n\r\n\t\ttry {\r\n\t\t\tconst response = await adminUserService.getUsers(page, perPage);\r\n\r\n\t\t\t// Mapear usuarios al formato esperado por el componente\r\n\t\t\tconst mappedUsers = response.data.map(mapApiUserToAdminUserData);\r\n\r\n\t\t\tsetUsers(mappedUsers);\r\n\t\t\tsetPagination({\r\n\t\t\t\tcurrentPage: response.meta.current_page,\r\n\t\t\t\ttotalPages: response.meta.last_page,\r\n\t\t\t\ttotalItems: response.meta.total,\r\n\t\t\t\titemsPerPage: response.meta.per_page,\r\n\t\t\t});\r\n\r\n\t\t\treturn mappedUsers;\r\n\t\t} catch (err) {\r\n\t\t\tconst errorMsg = extractErrorMessage(\r\n\t\t\t\terr,\r\n\t\t\t\t\"Error al obtener la lista de usuarios\"\r\n\t\t\t);\r\n\t\t\tconsole.error(\"Error fetching users:\", errorMsg);\r\n\t\t\tsetError(errorMsg);\r\n\t\t\treturn [];\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t}, []);\r\n\r\n\t/**\r\n\t * Bloquea o desbloquea un usuario\r\n\t */\r\n\tconst toggleUserStatus = useCallback(\r\n\t\tasync (userId: number, isCurrentlyBlocked: boolean) => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\ttry {\r\n\t\t\t\tlet success;\r\n\r\n\t\t\t\tif (isCurrentlyBlocked) {\r\n\t\t\t\t\t// Si está bloqueado, desbloqueamos\r\n\t\t\t\t\tsuccess = await adminUserService.unblockUser(userId);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Si no está bloqueado, bloqueamos\r\n\t\t\t\t\tsuccess = await adminUserService.blockUser(userId);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (success) {\r\n\t\t\t\t\t// Actualizar el estado del usuario en la lista local\r\n\t\t\t\t\tsetUsers((prevUsers) =>\r\n\t\t\t\t\t\tprevUsers.map((user) =>\r\n\t\t\t\t\t\t\tuser.id === userId\r\n\t\t\t\t\t\t\t\t? {\r\n\t\t\t\t\t\t\t\t\t\t...user,\r\n\t\t\t\t\t\t\t\t\t\tstatus: isCurrentlyBlocked ? \"active\" : \"blocked\",\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t: user\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t);\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetError(\r\n\t\t\t\t\t\t`No se pudo ${isCurrentlyBlocked ? \"desbloquear\" : \"bloquear\"} al usuario`\r\n\t\t\t\t\t);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconst errorMsg = extractErrorMessage(\r\n\t\t\t\t\terr,\r\n\t\t\t\t\t`Error al ${isCurrentlyBlocked ? \"desbloquear\" : \"bloquear\"} al usuario`\r\n\t\t\t\t);\r\n\t\t\t\tconsole.error(\"Error toggling user status:\", errorMsg);\r\n\t\t\t\tsetError(errorMsg);\r\n\t\t\t\treturn false;\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[]\r\n\t);\r\n\r\n\t/**\r\n\t * Envía un correo de restablecimiento de contraseña\r\n\t */\r\n\tconst sendPasswordReset = useCallback(async (userId: number) => {\r\n\t\tsetLoading(true);\r\n\t\tsetError(null);\r\n\r\n\t\ttry {\r\n\t\t\tconst success = await adminUserService.sendPasswordResetEmail(userId);\r\n\r\n\t\t\tif (!success) {\r\n\t\t\t\tsetError(\r\n\t\t\t\t\t\"No se pudo enviar el correo de restablecimiento de contraseña\"\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\treturn success;\r\n\t\t} catch (err) {\r\n\t\t\tconst errorMsg = extractErrorMessage(\r\n\t\t\t\terr,\r\n\t\t\t\t\"Error al enviar correo de restablecimiento\"\r\n\t\t\t);\r\n\t\t\tconsole.error(\"Error sending password reset:\", errorMsg);\r\n\t\t\tsetError(errorMsg);\r\n\t\t\treturn false;\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t}, []);\r\n\r\n\t/**\r\n\t * Actualiza el rol de un usuario a administrador\r\n\t */\r\n\tconst makeUserAdmin = useCallback(async (userId: number) => {\r\n\t\tsetLoading(true);\r\n\t\tsetError(null);\r\n\r\n\t\ttry {\r\n\t\t\tconst success = await adminUserService.makeAdmin(userId);\r\n\r\n\t\t\tif (success) {\r\n\t\t\t\t// Actualizar el rol del usuario en la lista local\r\n\t\t\t\tsetUsers((prevUsers) =>\r\n\t\t\t\t\tprevUsers.map((user) =>\r\n\t\t\t\t\t\tuser.id === userId ? {...user, role: \"admin\"} : user\r\n\t\t\t\t\t)\r\n\t\t\t\t);\r\n\t\t\t\treturn true;\r\n\t\t\t} else {\r\n\t\t\t\tsetError(\"No se pudo convertir al usuario en administrador\");\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tconst errorMsg = extractErrorMessage(\r\n\t\t\t\terr,\r\n\t\t\t\t\"Error al convertir usuario en administrador\"\r\n\t\t\t);\r\n\t\t\tconsole.error(\"Error making user admin:\", errorMsg);\r\n\t\t\tsetError(errorMsg);\r\n\t\t\treturn false;\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t}, []);\r\n\r\n\t/**\r\n\t * Convierte un usuario en vendedor\r\n\t */\r\n\tconst makeUserSeller = useCallback(\r\n\t\tasync (\r\n\t\t\tuserId: number,\r\n\t\t\tstoreData: {store_name: string; description?: string}\r\n\t\t) => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\ttry {\r\n\t\t\t\tconst success = await adminUserService.makeSeller(userId, storeData);\r\n\r\n\t\t\t\tif (success) {\r\n\t\t\t\t\t// Actualizar el rol del usuario en la lista local\r\n\t\t\t\t\tsetUsers((prevUsers) =>\r\n\t\t\t\t\t\tprevUsers.map((user) =>\r\n\t\t\t\t\t\t\tuser.id === userId ? {...user, role: \"seller\"} : user\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t);\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetError(\"No se pudo convertir al usuario en vendedor\");\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconst errorMsg = extractErrorMessage(\r\n\t\t\t\t\terr,\r\n\t\t\t\t\t\"Error al convertir usuario en vendedor\"\r\n\t\t\t\t);\r\n\t\t\t\tconsole.error(\"Error making user seller:\", errorMsg);\r\n\t\t\t\tsetError(errorMsg);\r\n\t\t\t\treturn false;\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[]\r\n\t);\r\n\r\n\t/**\r\n\t * Elimina un usuario del sistema\r\n\t */\r\n\tconst deleteUser = useCallback(async (userId: number) => {\r\n\t\tsetLoading(true);\r\n\t\tsetError(null);\r\n\r\n\t\ttry {\r\n\t\t\tconst success = await adminUserService.deleteUser(userId);\r\n\r\n\t\t\tif (success) {\r\n\t\t\t\tconsole.log('User deleted successfully, determining optimal page to reload...');\r\n\t\t\t\t\r\n\t\t\t\t// Contar cuántos usuarios quedan en la página actual después de eliminar\r\n\t\t\t\tconst currentUsersInPage = users.length;\r\n\t\t\t\tconst isLastUserInPage = currentUsersInPage === 1;\r\n\t\t\t\tconst isNotFirstPage = pagination.currentPage > 1;\r\n\t\t\t\t\r\n\t\t\t\t// Determinar a qué página ir después de la eliminación\r\n\t\t\t\tlet targetPage = pagination.currentPage;\r\n\t\t\t\tif (isLastUserInPage && isNotFirstPage) {\r\n\t\t\t\t\ttargetPage = pagination.currentPage - 1;\r\n\t\t\t\t\tconsole.log(`Last user in page ${pagination.currentPage}, moving to page ${targetPage}`);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t// Recargar los datos desde el servidor con la página objetivo\r\n\t\t\t\ttry {\r\n\t\t\t\t\tawait fetchUsers(targetPage, pagination.itemsPerPage);\r\n\t\t\t\t\tconsole.log(`Data successfully reloaded from server after deletion on page ${targetPage}`);\r\n\t\t\t\t} catch (refreshError) {\r\n\t\t\t\t\tconsole.error('Error reloading data after deletion:', refreshError);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Como fallback, intentar la página 1 si falló\r\n\t\t\t\t\tif (targetPage > 1) {\r\n\t\t\t\t\t\tconsole.log('Fallback: trying to load page 1');\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tawait fetchUsers(1, pagination.itemsPerPage);\r\n\t\t\t\t\t\t} catch (fallbackError) {\r\n\t\t\t\t\t\t\tconsole.error('Fallback failed, updating locally:', fallbackError);\r\n\t\t\t\t\t\t\t// Último recurso: actualizar solo localmente\r\n\t\t\t\t\t\t\tsetUsers((prevUsers) => prevUsers.filter((user) => user.id !== userId));\r\n\t\t\t\t\t\t\tsetPagination((prevPagination) => ({\r\n\t\t\t\t\t\t\t\t...prevPagination,\r\n\t\t\t\t\t\t\t\ttotalItems: Math.max(0, prevPagination.totalItems - 1),\r\n\t\t\t\t\t\t\t\tcurrentPage: Math.min(prevPagination.currentPage, Math.ceil((prevPagination.totalItems - 1) / prevPagination.itemsPerPage) || 1),\r\n\t\t\t\t\t\t\t}));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// Si ya estamos en página 1, actualizar localmente\r\n\t\t\t\t\t\tsetUsers((prevUsers) => prevUsers.filter((user) => user.id !== userId));\r\n\t\t\t\t\t\tsetPagination((prevPagination) => ({\r\n\t\t\t\t\t\t\t...prevPagination,\r\n\t\t\t\t\t\t\ttotalItems: Math.max(0, prevPagination.totalItems - 1),\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn true;\r\n\t\t\t} else {\r\n\t\t\t\tsetError(\"No se pudo eliminar al usuario\");\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tconst errorMsg = extractErrorMessage(\r\n\t\t\t\terr,\r\n\t\t\t\t\"Error al eliminar usuario\"\r\n\t\t\t);\r\n\t\t\tconsole.error(\"Error deleting user:\", errorMsg);\r\n\t\t\tsetError(errorMsg);\r\n\t\t\treturn false;\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t}, [fetchUsers, pagination.currentPage, pagination.itemsPerPage, users.length]);\r\n\r\n\t/**\r\n\t * Función para recargar manualmente los datos\r\n\t */\r\n\tconst refreshData = useCallback(async () => {\r\n\t\tawait fetchUsers(pagination.currentPage, pagination.itemsPerPage);\r\n\t}, [fetchUsers, pagination.currentPage, pagination.itemsPerPage]);\r\n\r\n\t// Filtrar usuarios según criterios\r\n\tconst filterUsers = useCallback(\r\n\t\t(options: FilterOptions) => {\r\n\t\t\tconst {role, status, searchTerm} = options;\r\n\r\n\t\t\treturn users.filter((user) => {\r\n\t\t\t\t// Filtro por rol\r\n\t\t\t\tconst matchesRole = !role || role === \"all\" || user.role === role;\r\n\r\n\t\t\t\t// Filtro por estado\r\n\t\t\t\tconst matchesStatus =\r\n\t\t\t\t\t!status || status === \"all\" || user.status === status;\r\n\r\n\t\t\t\t// Filtro por término de búsqueda\r\n\t\t\t\tconst matchesSearch =\r\n\t\t\t\t\t!searchTerm ||\r\n\t\t\t\t\tuser.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\r\n\t\t\t\t\tuser.email.toLowerCase().includes(searchTerm.toLowerCase());\r\n\r\n\t\t\t\treturn matchesRole && matchesStatus && matchesSearch;\r\n\t\t\t});\r\n\t\t},\r\n\t\t[users]\r\n\t);\r\n\r\n\treturn {\r\n\t\tusers,\r\n\t\tloading,\r\n\t\terror,\r\n\t\tpagination,\r\n\t\tfetchUsers,\r\n\t\ttoggleUserStatus,\r\n\t\tsendPasswordReset,\r\n\t\tmakeUserAdmin,\r\n\t\tmakeUserSeller,\r\n\t\tdeleteUser,\r\n\t\trefreshData,\r\n\t\tfilterUsers,\r\n\t};\r\n};\r\n\r\nexport default useAdminUsers;\r\n","// src/presentation/pages/admin/AdminUsersPage.tsx\r\nimport React, {useState, useEffect} from \"react\";\r\nimport Table from \"../../components/dashboard/Table\";\r\nimport {\r\n\tUser,\r\n\tLock,\r\n\tUnlock,\r\n\tMail,\r\n\tStore,\r\n\tShield,\r\n\tFilter,\r\n\tRefreshCw,\r\n\tAlertCircle,\r\n\tX,\r\n\tAtSign,\r\n\tSend,\r\n\tTrash2,\r\n} from \"lucide-react\";\r\nimport useAdminUsers from \"../../hooks/useAdminUsers\";\r\nimport type {AdminUserData} from \"../../hooks/useAdminUsers\";\r\nimport ApiClient from \"../../../infrastructure/api/apiClient\";\r\nimport { API_ENDPOINTS } from \"../../../constants/apiEndpoints\";\r\n\r\n/**\r\n * Página de gestión de usuarios para administradores\r\n */\r\nconst AdminUsersPage: React.FC = () => {\r\n\tconst {\r\n\t\tloading,\r\n\t\terror,\r\n\t\tpagination,\r\n\t\tfetchUsers,\r\n\t\ttoggleUserStatus,\r\n\t\tsendPasswordReset,\r\n\t\tmakeUserAdmin,\r\n\t\tmakeUserSeller,\r\n\t\tdeleteUser,\r\n\t\tfilterUsers,\r\n\t} = useAdminUsers();\r\n\r\n\t// Estados para filtros y búsqueda\r\n\tconst [roleFilter, setRoleFilter] = useState<string>(\"all\");\r\n\tconst [statusFilter, setStatusFilter] = useState<string>(\"all\");\r\n\tconst [searchTerm, setSearchTerm] = useState<string>(\"\");\r\n\tconst [successMessage, setSuccessMessage] = useState<string | null>(null);\r\n\r\n\t// Estados para el modal de crear vendedor\r\n\tconst [showSellerModal, setShowSellerModal] = useState<boolean>(false);\r\n\tconst [selectedUserId, setSelectedUserId] = useState<number | null>(null);\r\n\tconst [storeName, setStoreName] = useState<string>(\"\");\r\n\tconst [storeDescription, setStoreDescription] = useState<string>(\"\");\r\n\tconst [validationErrors, setValidationErrors] = useState<{\r\n\t\t[key: string]: string;\r\n\t}>({});\r\n\r\n\t// Estados para el modal de email\r\n\tconst [showEmailModal, setShowEmailModal] = useState<boolean>(false);\r\n\tconst [selectedUserForEmail, setSelectedUserForEmail] = useState<AdminUserData | null>(null);\r\n\tconst [emailSubject, setEmailSubject] = useState<string>(\"\");\r\n\tconst [emailMessage, setEmailMessage] = useState<string>(\"\");\r\n\tconst [emailType, setEmailType] = useState<string>(\"notification\");\r\n\tconst [emailSending, setEmailSending] = useState<boolean>(false);\r\n\tconst [emailValidationErrors, setEmailValidationErrors] = useState<{\r\n\t\t[key: string]: string;\r\n\t}>({});\r\n\r\n\t// Estados para el modal de confirmación de eliminación\r\n\tconst [showDeleteModal, setShowDeleteModal] = useState<boolean>(false);\r\n\tconst [selectedUserForDelete, setSelectedUserForDelete] = useState<AdminUserData | null>(null);\r\n\tconst [deleting, setDeleting] = useState<boolean>(false);\r\n\r\n\t// Obtener datos de usuarios al iniciar\r\n\tuseEffect(() => {\r\n\t\tfetchUsers(pagination.currentPage, pagination.itemsPerPage);\r\n\t}, [fetchUsers, pagination.currentPage, pagination.itemsPerPage]);\r\n\r\n\t// Filtrar usuarios basado en rol y estado\r\n\tconst filteredUsers = filterUsers({\r\n\t\trole: roleFilter,\r\n\t\tstatus: statusFilter,\r\n\t\tsearchTerm: searchTerm,\r\n\t});\r\n\r\n\t// Debug logging removed to prevent infinite loop\r\n\r\n\t// Manejar cambio de estado de usuario (bloquear/desbloquear)\r\n\tconst handleToggleUserStatus = async (\r\n\t\tuserId: number,\r\n\t\tcurrentStatus: string\r\n\t) => {\r\n\t\tconst isCurrentlyBlocked = currentStatus === \"blocked\";\r\n\t\tconst success = await toggleUserStatus(userId, isCurrentlyBlocked);\r\n\r\n\t\tif (success) {\r\n\t\t\tsetSuccessMessage(\r\n\t\t\t\t`Usuario ${isCurrentlyBlocked ? \"desbloqueado\" : \"bloqueado\"} correctamente.`\r\n\t\t\t);\r\n\r\n\t\t\t// Limpiar mensaje después de 3 segundos\r\n\t\t\tsetTimeout(() => setSuccessMessage(null), 3000);\r\n\t\t}\r\n\t};\r\n\r\n\t// Manejar envío de restablecimiento de contraseña\r\n\tconst handleSendPasswordReset = async (userId: number) => {\r\n\t\tconst success = await sendPasswordReset(userId);\r\n\r\n\t\tif (success) {\r\n\t\t\tsetSuccessMessage(\r\n\t\t\t\t\"Correo de restablecimiento de contraseña enviado correctamente.\"\r\n\t\t\t);\r\n\r\n\t\t\t// Limpiar mensaje después de 3 segundos\r\n\t\t\tsetTimeout(() => setSuccessMessage(null), 3000);\r\n\t\t}\r\n\t};\r\n\r\n\t// Manejar promoción a administrador\r\n\tconst handleMakeAdmin = async (userId: number) => {\r\n\t\tconst success = await makeUserAdmin(userId);\r\n\r\n\t\tif (success) {\r\n\t\t\tsetSuccessMessage(\"Usuario promocionado a administrador correctamente.\");\r\n\r\n\t\t\t// Limpiar mensaje después de 3 segundos\r\n\t\t\tsetTimeout(() => setSuccessMessage(null), 3000);\r\n\t\t}\r\n\t};\r\n\r\n\t// Abrir modal para convertir en vendedor\r\n\tconst handleShowMakeSellerModal = (userId: number) => {\r\n\t\tsetSelectedUserId(userId);\r\n\t\tsetStoreName(\"\");\r\n\t\tsetStoreDescription(\"\");\r\n\t\tsetValidationErrors({});\r\n\t\tsetShowSellerModal(true);\r\n\t};\r\n\r\n\t// Cerrar modal\r\n\tconst handleCloseSellerModal = () => {\r\n\t\tsetShowSellerModal(false);\r\n\t\tsetSelectedUserId(null);\r\n\t\tsetStoreName(\"\");\r\n\t\tsetStoreDescription(\"\");\r\n\t\tsetValidationErrors({});\r\n\t};\r\n\r\n\t// Validar formulario de vendedor\r\n\tconst validateSellerForm = (): boolean => {\r\n\t\tconst errors: {[key: string]: string} = {};\r\n\r\n\t\tif (!storeName || storeName.trim().length < 3) {\r\n\t\t\terrors.storeName =\r\n\t\t\t\t\"El nombre de la tienda debe tener al menos 3 caracteres\";\r\n\t\t}\r\n\r\n\t\tsetValidationErrors(errors);\r\n\t\treturn Object.keys(errors).length === 0;\r\n\t};\r\n\r\n\t// Convertir en vendedor\r\n\tconst handleMakeSeller = async () => {\r\n\t\tif (!selectedUserId) return;\r\n\r\n\t\tif (validateSellerForm()) {\r\n\t\t\tconst storeData = {\r\n\t\t\t\tstore_name: storeName,\r\n\t\t\t\tdescription: storeDescription,\r\n\t\t\t};\r\n\r\n\t\t\tconst success = await makeUserSeller(selectedUserId, storeData);\r\n\r\n\t\t\tif (success) {\r\n\t\t\t\tsetSuccessMessage(\"Usuario convertido en vendedor correctamente.\");\r\n\t\t\t\thandleCloseSellerModal();\r\n\r\n\t\t\t\t// Limpiar mensaje después de 3 segundos\r\n\t\t\t\tsetTimeout(() => setSuccessMessage(null), 3000);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t// Manejar cambio de página\r\n\tconst handlePageChange = (page: number) => {\r\n\t\tfetchUsers(page, pagination.itemsPerPage);\r\n\t};\r\n\r\n\t// Manejar refrescado manual\r\n\tconst handleRefreshData = () => {\r\n\t\tfetchUsers(pagination.currentPage, pagination.itemsPerPage);\r\n\t};\r\n\r\n\t// Funciones para el modal de email\r\n\tconst handleShowEmailModal = (user: AdminUserData) => {\r\n\t\tsetSelectedUserForEmail(user);\r\n\t\tsetEmailSubject(\"\");\r\n\t\tsetEmailMessage(\"\");\r\n\t\tsetEmailType(\"notification\");\r\n\t\tsetEmailValidationErrors({});\r\n\t\tsetShowEmailModal(true);\r\n\t};\r\n\r\n\tconst handleCloseEmailModal = () => {\r\n\t\tsetShowEmailModal(false);\r\n\t\tsetSelectedUserForEmail(null);\r\n\t\tsetEmailSubject(\"\");\r\n\t\tsetEmailMessage(\"\");\r\n\t\tsetEmailType(\"notification\");\r\n\t\tsetEmailValidationErrors({});\r\n\t};\r\n\r\n\t// Validar formulario de email\r\n\tconst validateEmailForm = (): boolean => {\r\n\t\tconst errors: {[key: string]: string} = {};\r\n\r\n\t\tif (!emailSubject || emailSubject.trim().length < 3) {\r\n\t\t\terrors.subject = \"El asunto debe tener al menos 3 caracteres\";\r\n\t\t}\r\n\r\n\t\tif (!emailMessage || emailMessage.trim().length < 10) {\r\n\t\t\terrors.message = \"El mensaje debe tener al menos 10 caracteres\";\r\n\t\t}\r\n\r\n\t\tif (emailMessage.length > 5000) {\r\n\t\t\terrors.message = \"El mensaje no puede exceder 5000 caracteres\";\r\n\t\t}\r\n\r\n\t\tsetEmailValidationErrors(errors);\r\n\t\treturn Object.keys(errors).length === 0;\r\n\t};\r\n\r\n\t// Enviar email personalizado\r\n\tconst handleSendCustomEmail = async () => {\r\n\t\tif (!selectedUserForEmail) return;\r\n\r\n\t\tif (validateEmailForm()) {\r\n\t\t\tsetEmailSending(true);\r\n\r\n\t\t\ttry {\r\n\t\t\t\tconst result = await ApiClient.post<{status: string; message?: string}>(\r\n\t\t\t\t\tAPI_ENDPOINTS.ADMIN.CONFIGURATIONS.MAIL_SEND_CUSTOM,\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tuser_id: selectedUserForEmail.id,\r\n\t\t\t\t\t\tsubject: emailSubject.trim(),\r\n\t\t\t\t\t\tmessage: emailMessage.trim(),\r\n\t\t\t\t\t\temail_type: emailType,\r\n\t\t\t\t\t}\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif (result.status === 'success') {\r\n\t\t\t\t\tsetSuccessMessage(\"Email enviado correctamente.\");\r\n\t\t\t\t\thandleCloseEmailModal();\r\n\t\t\t\t\t\r\n\t\t\t\t\t// Limpiar mensaje después de 5 segundos\r\n\t\t\t\t\tsetTimeout(() => setSuccessMessage(null), 5000);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetEmailValidationErrors({\r\n\t\t\t\t\t\tgeneral: result.message || \"Error al enviar el email\"\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error('Error sending custom email:', error);\r\n\t\t\t\tsetEmailValidationErrors({\r\n\t\t\t\t\tgeneral: \"Error de conexión al enviar el email\"\r\n\t\t\t\t});\r\n\t\t\t} finally {\r\n\t\t\t\tsetEmailSending(false);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t// Funciones para el modal de eliminación\r\n\tconst handleShowDeleteModal = (user: AdminUserData) => {\r\n\t\tsetSelectedUserForDelete(user);\r\n\t\tsetShowDeleteModal(true);\r\n\t};\r\n\r\n\tconst handleCloseDeleteModal = () => {\r\n\t\tsetShowDeleteModal(false);\r\n\t\tsetSelectedUserForDelete(null);\r\n\t};\r\n\r\n\t// Eliminar usuario\r\n\tconst handleDeleteUser = async () => {\r\n\t\tif (!selectedUserForDelete) return;\r\n\r\n\t\tsetDeleting(true);\r\n\r\n\t\ttry {\r\n\t\t\tconsole.log('Attempting to delete user:', selectedUserForDelete.id);\r\n\t\t\tconst success = await deleteUser(selectedUserForDelete.id);\r\n\r\n\t\t\tif (success) {\r\n\t\t\t\tconsole.log('User deleted successfully, hook will handle refresh automatically');\r\n\t\t\t\tsetSuccessMessage(\"Usuario eliminado correctamente.\");\r\n\t\t\t\thandleCloseDeleteModal();\r\n\r\n\t\t\t\t// Limpiar mensaje después de 3 segundos\r\n\t\t\t\tsetTimeout(() => setSuccessMessage(null), 3000);\r\n\t\t\t} else {\r\n\t\t\t\tconsole.error('Delete operation failed');\r\n\t\t\t\tsetSuccessMessage(\"Error al eliminar el usuario.\");\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Error deleting user:', error);\r\n\t\t\tsetSuccessMessage(\"Error al eliminar el usuario.\");\r\n\t\t} finally {\r\n\t\t\tsetDeleting(false);\r\n\t\t}\r\n\t};\r\n\r\n\t// Definir columnas de la tabla\r\n\tconst columns = [\r\n\t\t{\r\n\t\t\tkey: \"user\",\r\n\t\t\theader: \"Usuario\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (user: AdminUserData) => (\r\n\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t<div className=\"flex-shrink-0 h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden\">\r\n\t\t\t\t\t\t<User className=\"h-6 w-6 text-gray-500\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"ml-4\">\r\n\t\t\t\t\t\t<div className=\"text-sm font-medium text-gray-900\">\r\n\t\t\t\t\t\t\t{user.name}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"text-sm text-gray-500\">\r\n\t\t\t\t\t\t\t{user.email}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"role\",\r\n\t\t\theader: \"Rol\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (user: AdminUserData) => (\r\n\t\t\t\t<span\r\n\t\t\t\t\tclassName={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${\r\n\t\t\t\t\t\tuser.role === \"admin\"\r\n\t\t\t\t\t\t\t? \"bg-red-100 text-red-800\"\r\n\t\t\t\t\t\t\t: user.role === \"seller\"\r\n\t\t\t\t\t\t\t\t? \"bg-blue-100 text-blue-800\"\r\n\t\t\t\t\t\t\t\t: \"bg-green-100 text-green-800\"\r\n\t\t\t\t\t}`}\r\n\t\t\t\t>\r\n\t\t\t\t\t{user.role === \"admin\" && \"Administrador\"}\r\n\t\t\t\t\t{user.role === \"seller\" && \"Vendedor\"}\r\n\t\t\t\t\t{user.role === \"customer\" && \"Cliente\"}\r\n\t\t\t\t</span>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"status\",\r\n\t\t\theader: \"Estado\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (user: AdminUserData) => (\r\n\t\t\t\t<span\r\n\t\t\t\t\tclassName={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${\r\n\t\t\t\t\t\tuser.status === \"active\"\r\n\t\t\t\t\t\t\t? \"bg-green-100 text-green-800\"\r\n\t\t\t\t\t\t\t: \"bg-red-100 text-red-800\"\r\n\t\t\t\t\t}`}\r\n\t\t\t\t>\r\n\t\t\t\t\t{user.status === \"active\" ? \"Activo\" : \"Bloqueado\"}\r\n\t\t\t\t</span>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"registeredDate\",\r\n\t\t\theader: \"Registrado\",\r\n\t\t\tsortable: true,\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"ordersCount\",\r\n\t\t\theader: \"Pedidos\",\r\n\t\t\tsortable: true,\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"actions\",\r\n\t\t\theader: \"Acciones\",\r\n\t\t\trender: (user: AdminUserData) => (\r\n\t\t\t\t<div className=\"flex justify-end space-x-2\">\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={() => handleToggleUserStatus(user.id, user.status)}\r\n\t\t\t\t\t\tclassName={`p-1 rounded-md ${\r\n\t\t\t\t\t\t\tuser.status === \"active\"\r\n\t\t\t\t\t\t\t\t? \"text-red-600 hover:bg-red-100\"\r\n\t\t\t\t\t\t\t\t: \"text-green-600 hover:bg-green-100\"\r\n\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\ttitle={\r\n\t\t\t\t\t\t\tuser.status === \"active\"\r\n\t\t\t\t\t\t\t\t? \"Bloquear Usuario\"\r\n\t\t\t\t\t\t\t\t: \"Desbloquear Usuario\"\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{user.status === \"active\" ? (\r\n\t\t\t\t\t\t\t<Lock size={18} />\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<Unlock size={18} />\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={() => handleSendPasswordReset(user.id)}\r\n\t\t\t\t\t\tclassName=\"p-1 text-blue-600 hover:bg-blue-100 rounded-md\"\r\n\t\t\t\t\t\ttitle=\"Enviar Restablecimiento de Contraseña\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Mail size={18} />\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={() => handleShowEmailModal(user)}\r\n\t\t\t\t\t\tclassName=\"p-1 text-orange-600 hover:bg-orange-100 rounded-md\"\r\n\t\t\t\t\t\ttitle=\"Enviar Email Personalizado\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<AtSign size={18} />\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t{user.role !== \"seller\" && (\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={() => handleShowMakeSellerModal(user.id)}\r\n\t\t\t\t\t\t\tclassName=\"p-1 text-green-600 hover:bg-green-100 rounded-md\"\r\n\t\t\t\t\t\t\ttitle=\"Convertir en Vendedor\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Store size={18} />\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t{user.role !== \"admin\" && (\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={() => handleMakeAdmin(user.id)}\r\n\t\t\t\t\t\t\tclassName=\"p-1 text-purple-600 hover:bg-purple-100 rounded-md\"\r\n\t\t\t\t\t\t\ttitle=\"Hacer Administrador\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Shield size={18} />\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)}\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={() => handleShowDeleteModal(user)}\r\n\t\t\t\t\t\tclassName=\"p-1 text-red-600 hover:bg-red-100 rounded-md\"\r\n\t\t\t\t\t\ttitle=\"Eliminar Usuario\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Trash2 size={18} />\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t];\r\n\r\n\treturn (\r\n\t\t<div className=\"space-y-6\">\r\n\t\t\t<div className=\"flex justify-between items-center\">\r\n\t\t\t\t<h1 className=\"text-2xl font-bold text-gray-900\">\r\n\t\t\t\t\tGestión de Usuarios\r\n\t\t\t\t</h1>\r\n\t\t\t\t<div className=\"flex space-x-2\">\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={handleRefreshData}\r\n\t\t\t\t\t\tclassName=\"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors\"\r\n\t\t\t\t\t\tdisabled={loading}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<RefreshCw\r\n\t\t\t\t\t\t\tsize={18}\r\n\t\t\t\t\t\t\tclassName={`inline mr-2 ${loading ? \"animate-spin\" : \"\"}`}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\tActualizar\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Mensajes de error y éxito */}\r\n\t\t\t{error && (\r\n\t\t\t\t<div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4\">\r\n\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t<AlertCircle className=\"h-5 w-5 mr-2\" />\r\n\t\t\t\t\t\t<span>{error}</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{successMessage && (\r\n\t\t\t\t<div className=\"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4\">\r\n\t\t\t\t\t<span>{successMessage}</span>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{/* Filtros */}\r\n\t\t\t<div className=\"bg-white rounded-lg shadow-sm p-4\">\r\n\t\t\t\t<div className=\"flex flex-col md:flex-row gap-4\">\r\n\t\t\t\t\t{/* Filtro de Rol */}\r\n\t\t\t\t\t<div className=\"flex items-center space-x-2\">\r\n\t\t\t\t\t\t<Filter className=\"h-5 w-5 text-gray-500\" />\r\n\t\t\t\t\t\t<select\r\n\t\t\t\t\t\t\tclassName=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n\t\t\t\t\t\t\tvalue={roleFilter}\r\n\t\t\t\t\t\t\tonChange={(e) => setRoleFilter(e.target.value)}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<option value=\"all\">Todos los Roles</option>\r\n\t\t\t\t\t\t\t<option value=\"customer\">Cliente</option>\r\n\t\t\t\t\t\t\t<option value=\"seller\">Vendedor</option>\r\n\t\t\t\t\t\t\t<option value=\"admin\">Administrador</option>\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Filtro de Estado */}\r\n\t\t\t\t\t<div className=\"flex items-center space-x-2\">\r\n\t\t\t\t\t\t<select\r\n\t\t\t\t\t\t\tclassName=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n\t\t\t\t\t\t\tvalue={statusFilter}\r\n\t\t\t\t\t\t\tonChange={(e) => setStatusFilter(e.target.value)}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<option value=\"all\">Todos los Estados</option>\r\n\t\t\t\t\t\t\t<option value=\"active\">Activo</option>\r\n\t\t\t\t\t\t\t<option value=\"blocked\">Bloqueado</option>\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Búsqueda */}\r\n\t\t\t\t\t<div className=\"flex-grow\">\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\tplaceholder=\"Buscar por nombre o email...\"\r\n\t\t\t\t\t\t\tclassName=\"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n\t\t\t\t\t\t\tvalue={searchTerm}\r\n\t\t\t\t\t\t\tonChange={(e) => setSearchTerm(e.target.value)}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Tabla de Usuarios */}\r\n\t\t\t<Table\r\n\t\t\t\tkey={`users-table-${filteredUsers.length}`} // Forzar re-render cuando cambia la data\r\n\t\t\t\tdata={filteredUsers}\r\n\t\t\t\tcolumns={columns}\r\n\t\t\t\tsearchFields={[\"name\", \"email\"]}\r\n\t\t\t\tloading={loading}\r\n\t\t\t\temptyMessage=\"No se encontraron usuarios\"\r\n\t\t\t\tpagination={{\r\n\t\t\t\t\tcurrentPage: pagination.currentPage,\r\n\t\t\t\t\ttotalPages: pagination.totalPages,\r\n\t\t\t\t\ttotalItems: pagination.totalItems,\r\n\t\t\t\t\titemsPerPage: pagination.itemsPerPage,\r\n\t\t\t\t\tonPageChange: handlePageChange,\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\r\n\t\t\t{/* Modal para Crear Vendedor */}\r\n\t\t\t{showSellerModal && (\r\n\t\t\t\t<div className=\"fixed inset-0 flex items-center justify-center z-50\">\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName=\"fixed inset-0 bg-black bg-opacity-50\"\r\n\t\t\t\t\t\tonClick={handleCloseSellerModal}\r\n\t\t\t\t\t></div>\r\n\t\t\t\t\t<div className=\"bg-white rounded-lg p-6 w-full max-w-md relative z-10\">\r\n\t\t\t\t\t\t<div className=\"flex justify-between items-center mb-4\">\r\n\t\t\t\t\t\t\t<h2 className=\"text-xl font-bold text-gray-900\">\r\n\t\t\t\t\t\t\t\tConvertir en Vendedor\r\n\t\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tonClick={handleCloseSellerModal}\r\n\t\t\t\t\t\t\t\tclassName=\"text-gray-500 hover:text-gray-700\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<X size={20} />\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className=\"space-y-4\">\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\t\t\thtmlFor=\"store_name\"\r\n\t\t\t\t\t\t\t\t\tclassName=\"block text-sm font-medium text-gray-700 mb-1\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\tNombre de la Tienda *\r\n\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\tid=\"store_name\"\r\n\t\t\t\t\t\t\t\t\tclassName={`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 ${\r\n\t\t\t\t\t\t\t\t\t\tvalidationErrors.storeName\r\n\t\t\t\t\t\t\t\t\t\t\t? \"border-red-500\"\r\n\t\t\t\t\t\t\t\t\t\t\t: \"border-gray-300\"\r\n\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t\tvalue={storeName}\r\n\t\t\t\t\t\t\t\t\tonChange={(e) => setStoreName(e.target.value)}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t{validationErrors.storeName && (\r\n\t\t\t\t\t\t\t\t\t<p className=\"mt-1 text-sm text-red-500\">\r\n\t\t\t\t\t\t\t\t\t\t{validationErrors.storeName}\r\n\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\t\t\thtmlFor=\"description\"\r\n\t\t\t\t\t\t\t\t\tclassName=\"block text-sm font-medium text-gray-700 mb-1\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\tDescripción\r\n\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t<textarea\r\n\t\t\t\t\t\t\t\t\tid=\"description\"\r\n\t\t\t\t\t\t\t\t\tclassName=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n\t\t\t\t\t\t\t\t\tvalue={storeDescription}\r\n\t\t\t\t\t\t\t\t\tonChange={(e) => setStoreDescription(e.target.value)}\r\n\t\t\t\t\t\t\t\t\trows={4}\r\n\t\t\t\t\t\t\t\t></textarea>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div className=\"flex justify-end space-x-3 mt-6\">\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tonClick={handleCloseSellerModal}\r\n\t\t\t\t\t\t\t\t\tclassName=\"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\tCancelar\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tonClick={handleMakeSeller}\r\n\t\t\t\t\t\t\t\t\tclassName=\"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors\"\r\n\t\t\t\t\t\t\t\t\tdisabled={loading}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{loading ? \"Procesando...\" : \"Guardar\"}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{/* Modal para Enviar Email Personalizado */}\r\n\t\t\t{showEmailModal && selectedUserForEmail && (\r\n\t\t\t\t<div className=\"fixed inset-0 flex items-center justify-center z-50\">\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName=\"fixed inset-0 bg-black bg-opacity-50\"\r\n\t\t\t\t\t\tonClick={handleCloseEmailModal}\r\n\t\t\t\t\t></div>\r\n\t\t\t\t\t<div className=\"bg-white rounded-lg p-6 w-full max-w-2xl relative z-10 max-h-[90vh] overflow-y-auto\">\r\n\t\t\t\t\t\t<div className=\"flex justify-between items-center mb-4\">\r\n\t\t\t\t\t\t\t<h2 className=\"text-xl font-bold text-gray-900 flex items-center\">\r\n\t\t\t\t\t\t\t\t<AtSign className=\"mr-2 text-orange-600\" size={24} />\r\n\t\t\t\t\t\t\t\tEnviar Email a {selectedUserForEmail.name}\r\n\t\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tonClick={handleCloseEmailModal}\r\n\t\t\t\t\t\t\t\tclassName=\"text-gray-500 hover:text-gray-700\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<X size={20} />\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{/* Información del destinatario */}\r\n\t\t\t\t\t\t<div className=\"mb-4 p-3 bg-gray-50 rounded-lg\">\r\n\t\t\t\t\t\t\t<div className=\"flex items-center text-sm text-gray-600\">\r\n\t\t\t\t\t\t\t\t<User className=\"mr-2\" size={16} />\r\n\t\t\t\t\t\t\t\t<span className=\"font-medium\">{selectedUserForEmail.name}</span>\r\n\t\t\t\t\t\t\t\t<span className=\"mx-2\">•</span>\r\n\t\t\t\t\t\t\t\t<span>{selectedUserForEmail.email}</span>\r\n\t\t\t\t\t\t\t\t<span className=\"mx-2\">•</span>\r\n\t\t\t\t\t\t\t\t<span className=\"capitalize\">{selectedUserForEmail.role}</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{/* Errores generales */}\r\n\t\t\t\t\t\t{emailValidationErrors.general && (\r\n\t\t\t\t\t\t\t<div className=\"mb-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded\">\r\n\t\t\t\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t\t\t\t<AlertCircle className=\"h-5 w-5 mr-2\" />\r\n\t\t\t\t\t\t\t\t\t<span>{emailValidationErrors.general}</span>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t<div className=\"space-y-4\">\r\n\t\t\t\t\t\t\t{/* Tipo de Email */}\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\t\t\thtmlFor=\"email_type\"\r\n\t\t\t\t\t\t\t\t\tclassName=\"block text-sm font-medium text-gray-700 mb-1\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\tTipo de Email\r\n\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t<select\r\n\t\t\t\t\t\t\t\t\tid=\"email_type\"\r\n\t\t\t\t\t\t\t\t\tclassName=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n\t\t\t\t\t\t\t\t\tvalue={emailType}\r\n\t\t\t\t\t\t\t\t\tonChange={(e) => setEmailType(e.target.value)}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<option value=\"notification\">Notificación</option>\r\n\t\t\t\t\t\t\t\t\t<option value=\"announcement\">Anuncio</option>\r\n\t\t\t\t\t\t\t\t\t<option value=\"warning\">Advertencia</option>\r\n\t\t\t\t\t\t\t\t</select>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t{/* Asunto */}\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\t\t\thtmlFor=\"email_subject\"\r\n\t\t\t\t\t\t\t\t\tclassName=\"block text-sm font-medium text-gray-700 mb-1\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\tAsunto *\r\n\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\tid=\"email_subject\"\r\n\t\t\t\t\t\t\t\t\tclassName={`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 ${\r\n\t\t\t\t\t\t\t\t\t\temailValidationErrors.subject\r\n\t\t\t\t\t\t\t\t\t\t\t? \"border-red-500\"\r\n\t\t\t\t\t\t\t\t\t\t\t: \"border-gray-300\"\r\n\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t\tvalue={emailSubject}\r\n\t\t\t\t\t\t\t\t\tonChange={(e) => setEmailSubject(e.target.value)}\r\n\t\t\t\t\t\t\t\t\tplaceholder=\"Ingresa el asunto del email...\"\r\n\t\t\t\t\t\t\t\t\tmaxLength={255}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t{emailValidationErrors.subject && (\r\n\t\t\t\t\t\t\t\t\t<p className=\"mt-1 text-sm text-red-500\">\r\n\t\t\t\t\t\t\t\t\t\t{emailValidationErrors.subject}\r\n\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t<p className=\"mt-1 text-xs text-gray-500\">\r\n\t\t\t\t\t\t\t\t\t{emailSubject.length}/255 caracteres\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t{/* Mensaje */}\r\n\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\t\t\thtmlFor=\"email_message\"\r\n\t\t\t\t\t\t\t\t\tclassName=\"block text-sm font-medium text-gray-700 mb-1\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\tMensaje *\r\n\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t<textarea\r\n\t\t\t\t\t\t\t\t\tid=\"email_message\"\r\n\t\t\t\t\t\t\t\t\tclassName={`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 ${\r\n\t\t\t\t\t\t\t\t\t\temailValidationErrors.message\r\n\t\t\t\t\t\t\t\t\t\t\t? \"border-red-500\"\r\n\t\t\t\t\t\t\t\t\t\t\t: \"border-gray-300\"\r\n\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t\tvalue={emailMessage}\r\n\t\t\t\t\t\t\t\t\tonChange={(e) => setEmailMessage(e.target.value)}\r\n\t\t\t\t\t\t\t\t\tplaceholder=\"Escribe tu mensaje aquí...\"\r\n\t\t\t\t\t\t\t\t\trows={8}\r\n\t\t\t\t\t\t\t\t\tmaxLength={5000}\r\n\t\t\t\t\t\t\t\t></textarea>\r\n\t\t\t\t\t\t\t\t{emailValidationErrors.message && (\r\n\t\t\t\t\t\t\t\t\t<p className=\"mt-1 text-sm text-red-500\">\r\n\t\t\t\t\t\t\t\t\t\t{emailValidationErrors.message}\r\n\t\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t<p className=\"mt-1 text-xs text-gray-500\">\r\n\t\t\t\t\t\t\t\t\t{emailMessage.length}/5000 caracteres\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t{/* Botones */}\r\n\t\t\t\t\t\t\t<div className=\"flex justify-end space-x-3 mt-6 pt-4 border-t\">\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tonClick={handleCloseEmailModal}\r\n\t\t\t\t\t\t\t\t\tclassName=\"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100\"\r\n\t\t\t\t\t\t\t\t\tdisabled={emailSending}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\tCancelar\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tonClick={handleSendCustomEmail}\r\n\t\t\t\t\t\t\t\t\tclassName=\"px-6 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors flex items-center\"\r\n\t\t\t\t\t\t\t\t\tdisabled={emailSending}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t{emailSending ? (\r\n\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t<RefreshCw className=\"animate-spin -ml-1 mr-2 h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t\t\tEnviando...\r\n\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t\t<Send className=\"-ml-1 mr-2 h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t\t\tEnviar Email\r\n\t\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{/* Modal de confirmación de eliminación */}\r\n\t\t\t{showDeleteModal && selectedUserForDelete && (\r\n\t\t\t\t<div className=\"fixed inset-0 flex items-center justify-center z-50\">\r\n\t\t\t\t\t<div\r\n\t\t\t\t\t\tclassName=\"fixed inset-0 bg-black bg-opacity-50\"\r\n\t\t\t\t\t\tonClick={handleCloseDeleteModal}\r\n\t\t\t\t\t></div>\r\n\t\t\t\t\t<div className=\"bg-white rounded-lg p-6 w-full max-w-md relative z-10\">\r\n\t\t\t\t\t\t<div className=\"flex justify-between items-center mb-4\">\r\n\t\t\t\t\t\t\t<h2 className=\"text-xl font-bold text-gray-900 flex items-center\">\r\n\t\t\t\t\t\t\t\t<Trash2 className=\"mr-2 text-red-600\" size={24} />\r\n\t\t\t\t\t\t\t\tConfirmar Eliminación\r\n\t\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tonClick={handleCloseDeleteModal}\r\n\t\t\t\t\t\t\t\tclassName=\"text-gray-500 hover:text-gray-700\"\r\n\t\t\t\t\t\t\t\tdisabled={deleting}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<X size={20} />\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className=\"mb-6\">\r\n\t\t\t\t\t\t\t<p className=\"text-gray-700 mb-3\">\r\n\t\t\t\t\t\t\t\t¿Está seguro de que desea eliminar al usuario{\" \"}\r\n\t\t\t\t\t\t\t\t<strong>{selectedUserForDelete.name}</strong>?\r\n\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t<div className=\"bg-yellow-50 border border-yellow-200 rounded p-3\">\r\n\t\t\t\t\t\t\t\t<p className=\"text-yellow-800 text-sm flex items-center\">\r\n\t\t\t\t\t\t\t\t\t<AlertCircle className=\"mr-2\" size={16} />\r\n\t\t\t\t\t\t\t\t\tEsta acción no se puede deshacer. El usuario será eliminado permanentemente del sistema.\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t{/* Información del usuario */}\r\n\t\t\t\t\t\t\t<div className=\"mt-3 p-3 bg-gray-50 rounded\">\r\n\t\t\t\t\t\t\t\t<p className=\"text-sm text-gray-600\">\r\n\t\t\t\t\t\t\t\t\t<strong>Email:</strong> {selectedUserForDelete.email}\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t<p className=\"text-sm text-gray-600\">\r\n\t\t\t\t\t\t\t\t\t<strong>Rol:</strong> {\r\n\t\t\t\t\t\t\t\t\t\tselectedUserForDelete.role === \"admin\" ? \"Administrador\" :\r\n\t\t\t\t\t\t\t\t\t\tselectedUserForDelete.role === \"seller\" ? \"Vendedor\" : \"Cliente\"\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t\t<p className=\"text-sm text-gray-600\">\r\n\t\t\t\t\t\t\t\t\t<strong>Pedidos:</strong> {selectedUserForDelete.ordersCount}\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className=\"flex justify-end space-x-3\">\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tonClick={handleCloseDeleteModal}\r\n\t\t\t\t\t\t\t\tclassName=\"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100\"\r\n\t\t\t\t\t\t\t\tdisabled={deleting}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tCancelar\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tonClick={handleDeleteUser}\r\n\t\t\t\t\t\t\t\tclassName=\"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center\"\r\n\t\t\t\t\t\t\t\tdisabled={deleting}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t{deleting ? (\r\n\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t<RefreshCw className=\"animate-spin -ml-1 mr-2 h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t\tEliminando...\r\n\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t\t\t<Trash2 className=\"-ml-1 mr-2 h-4 w-4\" />\r\n\t\t\t\t\t\t\t\t\t\tEliminar Usuario\r\n\t\t\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default AdminUsersPage;","// src/core/services/AdminProductService.ts\r\n\r\nimport ApiClient from \"../../infrastructure/api/apiClient\";\r\nimport {API_ENDPOINTS} from \"../../constants/apiEndpoints\";\r\nimport type {\r\n\tProduct,\r\n\tProductDetail,\r\n\tProductListResponse,\r\n\tProductCreationData,\r\n\tProductUpdateData,\r\n} from \"../domain/entities/Product\";\r\nimport type {ExtendedProductFilterParams} from \"../../presentation/types/ProductFilterParams\";\r\n\r\n/**\r\n * Servicio de administración de productos - Solo para administradores\r\n * Permite gestionar cualquier producto en el sistema\r\n */\r\nexport class AdminProductService {\r\n\t/**\r\n\t * Obtiene todos los productos del sistema (como admin)\r\n\t */\r\n\tasync getAllProducts(\r\n\t\tfilterParams?: ExtendedProductFilterParams\r\n\t): Promise<ProductListResponse | null> {\r\n\t\ttry {\r\n\t\t\tconsole.log(\r\n\t\t\t\t\"📤 AdminProductService: Obteniendo todos los productos como admin:\",\r\n\t\t\t\tfilterParams\r\n\t\t\t);\r\n\r\n\t\t\t// Limpiar parámetros específicos de frontend que el backend no reconoce\r\n\t\t\tconst cleanParams = {...filterParams};\r\n\t\t\tif (cleanParams && \"admin_view\" in cleanParams) {\r\n\t\t\t\tdelete cleanParams.admin_view; // CORREGIDO: verificar si existe antes de eliminar\r\n\t\t\t}\r\n\r\n\t\t\tconst response = await ApiClient.get<ProductListResponse>(\r\n\t\t\t\tAPI_ENDPOINTS.ADMIN.PRODUCTS.LIST,\r\n\t\t\t\tcleanParams\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log(\"📥 AdminProductService: Respuesta del servidor:\", response);\r\n\t\t\treturn response;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"❌ Error en AdminProductService.getAllProducts:\", error);\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Obtiene un producto por ID (como admin)\r\n\t */\r\n\tasync getProductById(id: number): Promise<ProductDetail | null> {\r\n\t\ttry {\r\n\t\t\tconsole.log(\r\n\t\t\t\t`📤 AdminProductService: Obteniendo producto ${id} como admin`\r\n\t\t\t);\r\n\r\n\t\t\tconst response = await ApiClient.get<{data: ProductDetail}>(\r\n\t\t\t\tAPI_ENDPOINTS.PRODUCTS.DETAILS(id)\r\n\t\t\t);\r\n\r\n\t\t\treturn response?.data || null;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"❌ Error en AdminProductService.getProductById:\", error);\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Crea un producto (como admin para cualquier vendedor)\r\n\t */\r\n\tasync createProduct(\r\n\t\tdata: ProductCreationData,\r\n\t\tsellerId?: number\r\n\t): Promise<Product | null> {\r\n\t\ttry {\r\n\t\t\tconsole.log(\"📤 AdminProductService: Creando producto como admin:\", data);\r\n\r\n\t\t\tconst formData = new FormData();\r\n\r\n\t\t\t// Campos básicos\r\n\t\t\tformData.append(\"name\", data.name);\r\n\t\t\tformData.append(\"description\", data.description);\r\n\t\t\tformData.append(\"price\", String(data.price));\r\n\t\t\tformData.append(\"stock\", String(data.stock));\r\n\t\t\tformData.append(\"category_id\", String(data.category_id));\r\n\r\n\t\t\t// Si se especifica un vendedor, asignarlo\r\n\t\t\tif (sellerId) {\r\n\t\t\t\tformData.append(\"seller_id\", String(sellerId));\r\n\t\t\t}\r\n\r\n\t\t\t// Campos opcionales\r\n\t\t\tif (data.shortDescription)\r\n\t\t\t\tformData.append(\"short_description\", data.shortDescription);\r\n\t\t\tif (data.weight !== undefined)\r\n\t\t\t\tformData.append(\"weight\", String(data.weight));\r\n\t\t\tif (data.width !== undefined)\r\n\t\t\t\tformData.append(\"width\", String(data.width));\r\n\t\t\tif (data.height !== undefined)\r\n\t\t\t\tformData.append(\"height\", String(data.height));\r\n\t\t\tif (data.depth !== undefined)\r\n\t\t\t\tformData.append(\"depth\", String(data.depth));\r\n\t\t\tif (data.dimensions) formData.append(\"dimensions\", data.dimensions);\r\n\t\t\tif (data.sku) formData.append(\"sku\", data.sku);\r\n\t\t\tif (data.status) formData.append(\"status\", data.status);\r\n\t\t\tif (data.featured !== undefined)\r\n\t\t\t\tformData.append(\"featured\", String(data.featured));\r\n\t\t\tif (data.published !== undefined)\r\n\t\t\t\tformData.append(\"published\", String(data.published));\r\n\t\t\tif (data.discount_percentage !== undefined) {\r\n\t\t\t\tformData.append(\r\n\t\t\t\t\t\"discount_percentage\",\r\n\t\t\t\t\tString(data.discount_percentage)\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\t// Arrays\r\n\t\t\tif (data.colors) {\r\n\t\t\t\tconst colorsValue =\r\n\t\t\t\t\ttypeof data.colors === \"string\"\r\n\t\t\t\t\t\t? data.colors\r\n\t\t\t\t\t\t: JSON.stringify(data.colors);\r\n\t\t\t\tformData.append(\"colors\", colorsValue);\r\n\t\t\t}\r\n\t\t\tif (data.sizes) {\r\n\t\t\t\tconst sizesValue =\r\n\t\t\t\t\ttypeof data.sizes === \"string\"\r\n\t\t\t\t\t\t? data.sizes\r\n\t\t\t\t\t\t: JSON.stringify(data.sizes);\r\n\t\t\t\tformData.append(\"sizes\", sizesValue);\r\n\t\t\t}\r\n\t\t\tif (data.tags) {\r\n\t\t\t\tconst tagsValue =\r\n\t\t\t\t\ttypeof data.tags === \"string\" ? data.tags : JSON.stringify(data.tags);\r\n\t\t\t\tformData.append(\"tags\", tagsValue);\r\n\t\t\t}\r\n\r\n\t\t\t// Atributos\r\n\t\t\tif (data.attributes && Object.keys(data.attributes).length > 0) {\r\n\t\t\t\tformData.append(\"attributes\", JSON.stringify(data.attributes));\r\n\t\t\t}\r\n\r\n\t\t\t// Imágenes\r\n\t\t\tif (data.images && data.images.length > 0) {\r\n\t\t\t\tdata.images.forEach((file, index) => {\r\n\t\t\t\t\tformData.append(`images[${index}]`, file);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tconst response = await ApiClient.uploadFile<Product>(\r\n\t\t\t\tAPI_ENDPOINTS.PRODUCTS.CREATE,\r\n\t\t\t\tformData\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log(\"✅ AdminProductService: Producto creado:\", response);\r\n\t\t\treturn response;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"❌ Error en AdminProductService.createProduct:\", error);\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Actualiza cualquier producto (como admin)\r\n\t */\r\n\tasync updateProduct(data: ProductUpdateData): Promise<Product | null> {\r\n\t\ttry {\r\n\t\t\tconsole.log(\r\n\t\t\t\t`📤 AdminProductService: Actualizando producto ${data.id} como admin:`,\r\n\t\t\t\tdata\r\n\t\t\t);\r\n\r\n\t\t\tconst formData = new FormData();\r\n\r\n\t\t\t// Campos opcionales para actualización\r\n\t\t\tif (data.name) formData.append(\"name\", data.name);\r\n\t\t\tif (data.description) formData.append(\"description\", data.description);\r\n\t\t\tif (data.shortDescription)\r\n\t\t\t\tformData.append(\"short_description\", data.shortDescription);\r\n\t\t\tif (data.price !== undefined)\r\n\t\t\t\tformData.append(\"price\", String(data.price));\r\n\t\t\tif (data.stock !== undefined)\r\n\t\t\t\tformData.append(\"stock\", String(data.stock));\r\n\t\t\tif (data.category_id)\r\n\t\t\t\tformData.append(\"category_id\", String(data.category_id));\r\n\r\n\t\t\t// Campos opcionales\r\n\t\t\tif (data.weight !== undefined)\r\n\t\t\t\tformData.append(\"weight\", String(data.weight));\r\n\t\t\tif (data.width !== undefined)\r\n\t\t\t\tformData.append(\"width\", String(data.width));\r\n\t\t\tif (data.height !== undefined)\r\n\t\t\t\tformData.append(\"height\", String(data.height));\r\n\t\t\tif (data.depth !== undefined)\r\n\t\t\t\tformData.append(\"depth\", String(data.depth));\r\n\t\t\tif (data.dimensions) formData.append(\"dimensions\", data.dimensions);\r\n\t\t\tif (data.sku) formData.append(\"sku\", data.sku);\r\n\t\t\tif (data.status) formData.append(\"status\", data.status);\r\n\t\t\tif (data.featured !== undefined)\r\n\t\t\t\tformData.append(\"featured\", String(data.featured));\r\n\t\t\tif (data.published !== undefined)\r\n\t\t\t\tformData.append(\"published\", String(data.published));\r\n\t\t\tif (data.discount_percentage !== undefined) {\r\n\t\t\t\tformData.append(\r\n\t\t\t\t\t\"discount_percentage\",\r\n\t\t\t\t\tString(data.discount_percentage)\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\t// Arrays\r\n\t\t\tif (data.colors) {\r\n\t\t\t\tconst colorsValue =\r\n\t\t\t\t\ttypeof data.colors === \"string\"\r\n\t\t\t\t\t\t? data.colors\r\n\t\t\t\t\t\t: JSON.stringify(data.colors);\r\n\t\t\t\tformData.append(\"colors\", colorsValue);\r\n\t\t\t}\r\n\t\t\tif (data.sizes) {\r\n\t\t\t\tconst sizesValue =\r\n\t\t\t\t\ttypeof data.sizes === \"string\"\r\n\t\t\t\t\t\t? data.sizes\r\n\t\t\t\t\t\t: JSON.stringify(data.sizes);\r\n\t\t\t\tformData.append(\"sizes\", sizesValue);\r\n\t\t\t}\r\n\t\t\tif (data.tags) {\r\n\t\t\t\tconst tagsValue =\r\n\t\t\t\t\ttypeof data.tags === \"string\" ? data.tags : JSON.stringify(data.tags);\r\n\t\t\t\tformData.append(\"tags\", tagsValue);\r\n\t\t\t}\r\n\r\n\t\t\t// Atributos\r\n\t\t\tif (data.attributes && Object.keys(data.attributes).length > 0) {\r\n\t\t\t\tformData.append(\"attributes\", JSON.stringify(data.attributes));\r\n\t\t\t}\r\n\r\n\t\t\t// Gestión de imágenes\r\n\t\t\tif (data.replace_images !== undefined) {\r\n\t\t\t\tformData.append(\"replace_images\", String(data.replace_images));\r\n\t\t\t}\r\n\t\t\tif (data.remove_images && data.remove_images.length > 0) {\r\n\t\t\t\tformData.append(\"remove_images\", JSON.stringify(data.remove_images));\r\n\t\t\t}\r\n\t\t\tif (data.images && data.images.length > 0) {\r\n\t\t\t\tdata.images.forEach((file, index) => {\r\n\t\t\t\t\tformData.append(`images[${index}]`, file);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tconst response = await ApiClient.updateFile<Product>(\r\n\t\t\t\tAPI_ENDPOINTS.PRODUCTS.UPDATE(data.id),\r\n\t\t\t\tformData\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log(\"✅ AdminProductService: Producto actualizado:\", response);\r\n\t\t\treturn response;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"❌ Error en AdminProductService.updateProduct:\", error);\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Elimina cualquier producto (como admin)\r\n\t */\r\n\tasync deleteProduct(id: number): Promise<boolean> {\r\n\t\ttry {\r\n\t\t\tconsole.log(\r\n\t\t\t\t`📤 AdminProductService: Eliminando producto ${id} como admin`\r\n\t\t\t);\r\n\r\n\t\t\tconst response = await ApiClient.delete(\r\n\t\t\t\tAPI_ENDPOINTS.ADMIN.PRODUCTS.DELETE(id)\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log(\"✅ AdminProductService: Producto eliminado:\", response);\r\n\t\t\treturn true;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"❌ Error en AdminProductService.deleteProduct:\", error);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Cambia el estado destacado de un producto - CORREGIDO\r\n\t */\r\n\tasync toggleFeatured(id: number, featured: boolean): Promise<boolean> {\r\n\t\ttry {\r\n\t\t\tconsole.log(\r\n\t\t\t\t`📤 AdminProductService: Cambiando featured del producto ${id} a ${featured}`\r\n\t\t\t);\r\n\r\n\t\t\t// Usar PATCH en lugar de PUT para actualizaciones parciales\r\n\t\t\tconst response = await ApiClient.patch(\r\n\t\t\t\tAPI_ENDPOINTS.ADMIN.PRODUCTS.PARTIAL_UPDATE(id),\r\n\t\t\t\t{featured: featured}\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log(\"✅ AdminProductService: Featured actualizado:\", response);\r\n\t\t\treturn true;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"❌ Error en AdminProductService.toggleFeatured:\", error);\r\n\t\t\tif (error instanceof Error) {\r\n\t\t\t\tconsole.error(\"Error message:\", error.message);\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Cambia el estado de publicación de un producto - CORREGIDO\r\n\t */\r\n\tasync togglePublished(id: number, published: boolean): Promise<boolean> {\r\n\t\ttry {\r\n\t\t\tconsole.log(\r\n\t\t\t\t`📤 AdminProductService: Cambiando published del producto ${id} a ${published}`\r\n\t\t\t);\r\n\r\n\t\t\t// Usar PATCH en lugar de PUT para actualizaciones parciales\r\n\t\t\tconst response = await ApiClient.patch(\r\n\t\t\t\tAPI_ENDPOINTS.ADMIN.PRODUCTS.PARTIAL_UPDATE(id),\r\n\t\t\t\t{published: published}\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log(\"✅ AdminProductService: Published actualizado:\", response);\r\n\t\t\treturn true;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"❌ Error en AdminProductService.togglePublished:\", error);\r\n\t\t\tif (error instanceof Error) {\r\n\t\t\t\tconsole.error(\"Error message:\", error.message);\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Cambia el estado de un producto - CORREGIDO\r\n\t */\r\n\tasync updateStatus(id: number, status: string): Promise<boolean> {\r\n\t\ttry {\r\n\t\t\tconsole.log(\r\n\t\t\t\t`📤 AdminProductService: Cambiando status del producto ${id} a ${status}`\r\n\t\t\t);\r\n\r\n\t\t\t// Usar PATCH en lugar de PUT para actualizaciones parciales\r\n\t\t\tconst response = await ApiClient.patch(\r\n\t\t\t\tAPI_ENDPOINTS.ADMIN.PRODUCTS.PARTIAL_UPDATE(id),\r\n\t\t\t\t{status: status}\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log(\"✅ AdminProductService: Status actualizado:\", response);\r\n\t\t\treturn true;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"❌ Error en AdminProductService.updateStatus:\", error);\r\n\t\t\tif (error instanceof Error) {\r\n\t\t\t\tconsole.error(\"Error message:\", error.message);\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Obtiene estadísticas de productos para admin\r\n\t */\r\n\tasync getProductStats(): Promise<any> {\r\n\t\ttry {\r\n\t\t\tconsole.log(\r\n\t\t\t\t\"📤 AdminProductService: Obteniendo estadísticas de productos\"\r\n\t\t\t);\r\n\r\n\t\t\tconst response = await ApiClient.get(API_ENDPOINTS.ADMIN.PRODUCTS.STATS);\r\n\r\n\t\t\tconsole.log(\"✅ AdminProductService: Estadísticas obtenidas:\", response);\r\n\t\t\treturn response;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"❌ Error en AdminProductService.getProductStats:\", error);\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Busca productos por vendedor (como admin)\r\n\t */\r\n\tasync getProductsBySeller(\r\n\t\tsellerId: number,\r\n\t\tfilterParams?: ExtendedProductFilterParams\r\n\t): Promise<ProductListResponse | null> {\r\n\t\ttry {\r\n\t\t\tconsole.log(\r\n\t\t\t\t`📤 AdminProductService: Obteniendo productos del vendedor ${sellerId}`\r\n\t\t\t);\r\n\r\n\t\t\tconst response = await ApiClient.get<ProductListResponse>(\r\n\t\t\t\tAPI_ENDPOINTS.PRODUCTS.BY_SELLER(sellerId),\r\n\t\t\t\tfilterParams\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log(\r\n\t\t\t\t\"✅ AdminProductService: Productos del vendedor obtenidos:\",\r\n\t\t\t\tresponse\r\n\t\t\t);\r\n\t\t\treturn response;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\r\n\t\t\t\t\"❌ Error en AdminProductService.getProductsBySeller:\",\r\n\t\t\t\terror\r\n\t\t\t);\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default AdminProductService;\r\n","// src/core/useCases/admin/product/GetAllProductsUseCase.ts\r\n\r\nimport {AdminProductService} from \"../../../services/AdminProductService\";\r\nimport type {ProductListResponse} from \"../../../domain/entities/Product\";\r\nimport type {ExtendedProductFilterParams} from \"../../../../presentation/types/ProductFilterParams\";\r\n\r\nexport class GetAllProductsUseCase {\r\n\tprivate adminProductService: AdminProductService;\r\n\r\n\tconstructor(adminProductService: AdminProductService) {\r\n\t\tthis.adminProductService = adminProductService;\r\n\t}\r\n\r\n\tasync execute(\r\n\t\tfilterParams?: ExtendedProductFilterParams\r\n\t): Promise<ProductListResponse | null> {\r\n\t\tconsole.log(\r\n\t\t\t\"GetAllProductsUseCase: Obteniendo todos los productos como admin\"\r\n\t\t);\r\n\t\ttry {\r\n\t\t\tconst products =\r\n\t\t\t\tawait this.adminProductService.getAllProducts(filterParams);\r\n\t\t\tconsole.log(\r\n\t\t\t\t\"GetAllProductsUseCase: Productos obtenidos correctamente:\",\r\n\t\t\t\tproducts\r\n\t\t\t);\r\n\t\t\treturn products;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\r\n\t\t\t\t\"GetAllProductsUseCase: Error al obtener productos:\",\r\n\t\t\t\terror\r\n\t\t\t);\r\n\t\t\tthrow error;\r\n\t\t}\r\n\t}\r\n}\r\n","// src/core/useCases/admin/product/CreateProductAsAdminUseCase.ts\r\n\r\nimport {AdminProductService} from \"../../../services/AdminProductService\";\r\nimport type {\r\n    Product,\r\n    ProductCreationData,\r\n} from \"../../../domain/entities/Product\";\r\n\r\nexport class CreateProductAsAdminUseCase {\r\n    private adminProductService: AdminProductService;\r\n\r\n    constructor(adminProductService: AdminProductService) {\r\n        this.adminProductService = adminProductService;\r\n    }\r\n\r\n    async execute(\r\n        data: ProductCreationData,\r\n        sellerId?: number\r\n    ): Promise<Product | null> {\r\n        console.log(\r\n            \"CreateProductAsAdminUseCase: Creando producto como admin:\",\r\n            data\r\n        );\r\n        try {\r\n            const product = await this.adminProductService.createProduct(\r\n                data,\r\n                sellerId\r\n            );\r\n            console.log(\r\n                \"CreateProductAsAdminUseCase: Producto creado correctamente:\",\r\n                product\r\n            );\r\n            return product;\r\n        } catch (error) {\r\n            console.error(\r\n                \"CreateProductAsAdminUseCase: Error al crear producto:\",\r\n                error\r\n            );\r\n            throw error;\r\n        }\r\n    }\r\n}","// src/core/useCases/admin/product/UpdateAnyProductUseCase.ts\r\n\r\nimport {AdminProductService} from \"../../../services/AdminProductService\";\r\nimport type {\r\n    Product,\r\n    ProductUpdateData,\r\n} from \"../../../domain/entities/Product\";\r\n\r\nexport class UpdateAnyProductUseCase {\r\n    private adminProductService: AdminProductService;\r\n\r\n    constructor(adminProductService: AdminProductService) {\r\n        this.adminProductService = adminProductService;\r\n    }\r\n\r\n    async execute(data: ProductUpdateData): Promise<Product | null> {\r\n        console.log(\r\n            `UpdateAnyProductUseCase: Actualizando producto ${data.id} como admin:`,\r\n            data\r\n        );\r\n        try {\r\n            const product = await this.adminProductService.updateProduct(data);\r\n            console.log(\r\n                \"UpdateAnyProductUseCase: Producto actualizado correctamente:\",\r\n                product\r\n            );\r\n            return product;\r\n        } catch (error) {\r\n            console.error(\r\n                \"UpdateAnyProductUseCase: Error al actualizar producto:\",\r\n                error\r\n            );\r\n            throw error;\r\n        }\r\n    }\r\n}","// src/core/useCases/admin/product/DeleteAnyProductUseCase.ts\r\n\r\nimport {AdminProductService} from \"../../../services/AdminProductService\";\r\n\r\nexport class DeleteAnyProductUseCase {\r\n    private adminProductService: AdminProductService;\r\n\r\n    constructor(adminProductService: AdminProductService) {\r\n        this.adminProductService = adminProductService;\r\n    }\r\n\r\n    async execute(id: number): Promise<boolean> {\r\n        console.log(\r\n            `DeleteAnyProductUseCase: Eliminando producto ${id} como admin`\r\n        );\r\n        try {\r\n            const result = await this.adminProductService.deleteProduct(id);\r\n            console.log(\r\n                \"DeleteAnyProductUseCase: Producto eliminado correctamente:\",\r\n                result\r\n            );\r\n            return result;\r\n        } catch (error) {\r\n            console.error(\r\n                \"DeleteAnyProductUseCase: Error al eliminar producto:\",\r\n                error\r\n            );\r\n            throw error;\r\n        }\r\n    }\r\n}","// src/core/useCases/admin/product/ToggleProductFeaturedUseCase.ts\r\n\r\nimport {AdminProductService} from \"../../../services/AdminProductService\";\r\n\r\nexport class ToggleProductFeaturedUseCase {\r\n    private adminProductService: AdminProductService;\r\n\r\n    constructor(adminProductService: AdminProductService) {\r\n        this.adminProductService = adminProductService;\r\n    }\r\n\r\n    async execute(id: number, featured: boolean): Promise<boolean> {\r\n        console.log(\r\n            `ToggleProductFeaturedUseCase: Cambiando featured del producto ${id} a ${featured}`\r\n        );\r\n        try {\r\n            const result = await this.adminProductService.toggleFeatured(\r\n                id,\r\n                featured\r\n            );\r\n            console.log(\r\n                \"ToggleProductFeaturedUseCase: Featured actualizado correctamente:\",\r\n                result\r\n            );\r\n            return result;\r\n        } catch (error) {\r\n            console.error(\r\n                \"ToggleProductFeaturedUseCase: Error al cambiar featured:\",\r\n                error\r\n            );\r\n            throw error;\r\n        }\r\n    }\r\n}","// src/core/useCases/admin/product/ToggleProductPublishedUseCase.ts\r\n\r\nimport {AdminProductService} from \"../../../services/AdminProductService\";\r\n\r\nexport class ToggleProductPublishedUseCase {\r\n    private adminProductService: AdminProductService;\r\n\r\n    constructor(adminProductService: AdminProductService) {\r\n        this.adminProductService = adminProductService;\r\n    }\r\n\r\n    async execute(id: number, published: boolean): Promise<boolean> {\r\n        console.log(\r\n            `ToggleProductPublishedUseCase: Cambiando published del producto ${id} a ${published}`\r\n        );\r\n        try {\r\n            const result = await this.adminProductService.togglePublished(\r\n                id,\r\n                published\r\n            );\r\n            console.log(\r\n                \"ToggleProductPublishedUseCase: Published actualizado correctamente:\",\r\n                result\r\n            );\r\n            return result;\r\n        } catch (error) {\r\n            console.error(\r\n                \"ToggleProductPublishedUseCase: Error al cambiar published:\",\r\n                error\r\n            );\r\n            throw error;\r\n        }\r\n    }\r\n}","// src/core/useCases/admin/product/UpdateProductStatusUseCase.ts\r\n\r\nimport {AdminProductService} from \"../../../services/AdminProductService\";\r\n\r\nexport class UpdateProductStatusUseCase {\r\n    private adminProductService: AdminProductService;\r\n\r\n    constructor(adminProductService: AdminProductService) {\r\n        this.adminProductService = adminProductService;\r\n    }\r\n\r\n    async execute(id: number, status: string): Promise<boolean> {\r\n        console.log(\r\n            `UpdateProductStatusUseCase: Cambiando status del producto ${id} a ${status}`\r\n        );\r\n        try {\r\n            const result = await this.adminProductService.updateStatus(id, status);\r\n            console.log(\r\n                \"UpdateProductStatusUseCase: Status actualizado correctamente:\",\r\n                result\r\n            );\r\n            return result;\r\n        } catch (error) {\r\n            console.error(\r\n                \"UpdateProductStatusUseCase: Error al cambiar status:\",\r\n                error\r\n            );\r\n            throw error;\r\n        }\r\n    }\r\n}","// src/core/useCases/admin/product/GetProductsBySellerUseCase.ts\r\n\r\nimport {AdminProductService} from \"../../../services/AdminProductService\";\r\nimport type {ProductListResponse} from \"../../../domain/entities/Product\";\r\nimport type {ExtendedProductFilterParams} from \"../../../../presentation/types/ProductFilterParams\";\r\n\r\nexport class GetProductsBySellerUseCase {\r\n\tprivate adminProductService: AdminProductService;\r\n\r\n\tconstructor(adminProductService: AdminProductService) {\r\n\t\tthis.adminProductService = adminProductService;\r\n\t}\r\n\r\n\tasync execute(\r\n\t\tsellerId: number,\r\n\t\tfilterParams?: ExtendedProductFilterParams\r\n\t): Promise<ProductListResponse | null> {\r\n\t\tconsole.log(\r\n\t\t\t`GetProductsBySellerUseCase: Obteniendo productos del vendedor ${sellerId}`\r\n\t\t);\r\n\t\ttry {\r\n\t\t\tconst products = await this.adminProductService.getProductsBySeller(\r\n\t\t\t\tsellerId,\r\n\t\t\t\tfilterParams\r\n\t\t\t);\r\n\t\t\tconsole.log(\r\n\t\t\t\t\"GetProductsBySellerUseCase: Productos obtenidos correctamente:\",\r\n\t\t\t\tproducts\r\n\t\t\t);\r\n\t\t\treturn products;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\r\n\t\t\t\t\"GetProductsBySellerUseCase: Error al obtener productos del vendedor:\",\r\n\t\t\t\terror\r\n\t\t\t);\r\n\t\t\tthrow error;\r\n\t\t}\r\n\t}\r\n}\r\n","// src/core/useCases/admin/product/GetProductStatsUseCase.ts\r\n\r\nimport {AdminProductService} from \"../../../services/AdminProductService\";\r\n\r\nexport class GetProductStatsUseCase {\r\n\tprivate adminProductService: AdminProductService;\r\n\r\n\tconstructor(adminProductService: AdminProductService) {\r\n\t\tthis.adminProductService = adminProductService;\r\n\t}\r\n\r\n\tasync execute(): Promise<any> {\r\n\t\tconsole.log(\"GetProductStatsUseCase: Obteniendo estadísticas de productos\");\r\n\t\ttry {\r\n\t\t\tconst stats = await this.adminProductService.getProductStats();\r\n\t\t\tconsole.log(\r\n\t\t\t\t\"GetProductStatsUseCase: Estadísticas obtenidas correctamente:\",\r\n\t\t\t\tstats\r\n\t\t\t);\r\n\t\t\treturn stats;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\r\n\t\t\t\t\"GetProductStatsUseCase: Error al obtener estadísticas:\",\r\n\t\t\t\terror\r\n\t\t\t);\r\n\t\t\tthrow error;\r\n\t\t}\r\n\t}\r\n}\r\n","// src/presentation/hooks/useAdminProducts.ts\r\n\r\nimport {useState, useCallback} from \"react\";\r\nimport {useCacheInvalidation} from \"./useReactiveCache\";\r\nimport {AdminProductService} from \"../../core/services/AdminProductService\";\r\nimport CacheService from \"../../infrastructure/services/CacheService\";\r\nimport appConfig from \"../../config/appConfig\";\r\n\r\n// Use Cases\r\nimport {GetAllProductsUseCase} from \"../../core/useCases/admin/product/GetAllProductsUseCase\";\r\nimport {CreateProductAsAdminUseCase} from \"../../core/useCases/admin/product/CreateProductAsAdminUseCase\";\r\nimport {UpdateAnyProductUseCase} from \"../../core/useCases/admin/product/UpdateAnyProductUseCase\";\r\nimport {DeleteAnyProductUseCase} from \"../../core/useCases/admin/product/DeleteAnyProductUseCase\";\r\nimport {ToggleProductFeaturedUseCase} from \"../../core/useCases/admin/product/ToggleProductFeaturedUseCase\";\r\nimport {ToggleProductPublishedUseCase} from \"../../core/useCases/admin/product/ToggleProductPublishedUseCase\";\r\nimport {UpdateProductStatusUseCase} from \"../../core/useCases/admin/product/UpdateProductStatusUseCase\";\r\nimport {GetProductsBySellerUseCase} from \"../../core/useCases/admin/product/GetProductsBySellerUseCase\";\r\nimport {GetProductStatsUseCase} from \"../../core/useCases/admin/product/GetProductStatsUseCase\";\r\n\r\nimport type {\r\n\tProduct,\r\n\tProductDetail,\r\n\tProductListResponse,\r\n\tProductCreationData,\r\n\tProductUpdateData,\r\n} from \"../../core/domain/entities/Product\";\r\nimport type {ExtendedProductFilterParams} from \"../types/ProductFilterParams\";\r\n\r\n// Crear instancias del servicio y use cases\r\nconst adminProductService = new AdminProductService();\r\n\r\nconst getAllProductsUseCase = new GetAllProductsUseCase(adminProductService);\r\nconst createProductAsAdminUseCase = new CreateProductAsAdminUseCase(\r\n\tadminProductService\r\n);\r\nconst updateAnyProductUseCase = new UpdateAnyProductUseCase(\r\n\tadminProductService\r\n);\r\nconst deleteAnyProductUseCase = new DeleteAnyProductUseCase(\r\n\tadminProductService\r\n);\r\nconst toggleProductFeaturedUseCase = new ToggleProductFeaturedUseCase(\r\n\tadminProductService\r\n);\r\nconst toggleProductPublishedUseCase = new ToggleProductPublishedUseCase(\r\n\tadminProductService\r\n);\r\nconst updateProductStatusUseCase = new UpdateProductStatusUseCase(\r\n\tadminProductService\r\n);\r\nconst getProductsBySellerUseCase = new GetProductsBySellerUseCase(\r\n\tadminProductService\r\n);\r\nconst getProductStatsUseCase = new GetProductStatsUseCase(adminProductService);\r\n\r\n// Función para generar clave de caché\r\nconst getAdminCacheKey = (params?: ExtendedProductFilterParams): string => {\r\n\tif (!params) return \"admin_products_default\";\r\n\treturn `admin_products_${JSON.stringify(params)}`;\r\n};\r\n\r\n/**\r\n * Hook para gestión administrativa de productos\r\n * Solo para usuarios con rol de administrador\r\n */\r\nexport const useAdminProducts = () => {\r\n\tconst [loading, setLoading] = useState<boolean>(false);\r\n\tconst [error, setError] = useState<string | null>(null);\r\n\tconst [products, setProducts] = useState<Product[]>([]);\r\n\tconst [productDetail, setProductDetail] = useState<ProductDetail | null>(\r\n\t\tnull\r\n\t);\r\n\tconst [stats, setStats] = useState<any>(null);\r\n\tconst [meta, setMeta] = useState<{\r\n\t\ttotal: number;\r\n\t\tlimit: number;\r\n\t\toffset: number;\r\n\t\tcurrentPage?: number;\r\n\t\ttotalPages?: number;\r\n\t} | null>(null);\r\n\r\n\t// Hook para invalidación de cache\r\n\tconst {invalidateAfterMutation} = useCacheInvalidation();\r\n\r\n\t/**\r\n\t * Función adaptadora para productos\r\n\t */\r\n\tconst adaptProduct = useCallback((apiProduct: any): Product => {\r\n\t\tif (!apiProduct || typeof apiProduct !== \"object\") {\r\n\t\t\tconsole.error(\"Producto inválido para adaptar:\", apiProduct);\r\n\t\t\treturn {} as Product;\r\n\t\t}\r\n\r\n\t\t// Procesar imágenes\r\n\t\tlet processedImages: string[] = [];\r\n\r\n\t\t// Prioridad 1: main_image (formato actual del backend)\r\n\t\tif (apiProduct.main_image) {\r\n\t\t\tprocessedImages = [apiProduct.main_image];\r\n\t\t}\r\n\t\t// Prioridad 2: array images si existe\r\n\t\telse if (Array.isArray(apiProduct.images) && apiProduct.images.length > 0) {\r\n\t\t\tprocessedImages = apiProduct.images\r\n\t\t\t\t.map((img: any) => {\r\n\t\t\t\t\tif (typeof img === \"string\") return img;\r\n\t\t\t\t\tif (typeof img === \"object\" && img !== null) {\r\n\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\timg.original ||\r\n\t\t\t\t\t\t\timg.large ||\r\n\t\t\t\t\t\t\timg.medium ||\r\n\t\t\t\t\t\t\timg.url ||\r\n\t\t\t\t\t\t\timg.path ||\r\n\t\t\t\t\t\t\t\"\"\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn \"\";\r\n\t\t\t\t})\r\n\t\t\t\t.filter(Boolean);\r\n\t\t}\r\n\t\t// Prioridad 3: campo image individual\r\n\t\telse if (apiProduct.image) {\r\n\t\t\tprocessedImages = [apiProduct.image];\r\n\t\t}\r\n\r\n\t\t// Procesar tags\r\n\t\tlet processedTags: string[] = [];\r\n\t\tif (Array.isArray(apiProduct.tags)) {\r\n\t\t\tapiProduct.tags.forEach((tag: any) => {\r\n\t\t\t\tif (typeof tag === \"string\") {\r\n\t\t\t\t\ttry {\r\n\t\t\t\t\t\t// Si es un string JSON, parsearlo\r\n\t\t\t\t\t\tconst parsed = JSON.parse(tag);\r\n\t\t\t\t\t\tif (Array.isArray(parsed)) {\r\n\t\t\t\t\t\t\tprocessedTags.push(...parsed);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tprocessedTags.push(tag);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} catch {\r\n\t\t\t\t\t\t// Si no es JSON válido, agregarlo directamente\r\n\t\t\t\t\t\tprocessedTags.push(tag);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tconst adaptedProduct: Product = {\r\n\t\t\tid: apiProduct.id,\r\n\t\t\tuserId: apiProduct.user_id,\r\n\t\t\tsellerId: apiProduct.seller_id,\r\n\t\t\tcategoryId: apiProduct.category_id,\r\n\t\t\tname: apiProduct.name,\r\n\t\t\tslug: apiProduct.slug,\r\n\t\t\tdescription: apiProduct.description || \"\",\r\n\t\t\tshortDescription: apiProduct.short_description,\r\n\t\t\tprice: Number(apiProduct.price || 0),\r\n\t\t\tfinalPrice: Number(apiProduct.final_price || apiProduct.price || 0),\r\n\t\t\tstock: Number(apiProduct.stock || 0),\r\n\t\t\tweight: apiProduct.weight,\r\n\t\t\twidth: apiProduct.width,\r\n\t\t\theight: apiProduct.height,\r\n\t\t\tdepth: apiProduct.depth,\r\n\t\t\tdimensions: apiProduct.dimensions,\r\n\t\t\tcolors: apiProduct.colors,\r\n\t\t\tsizes: apiProduct.sizes,\r\n\t\t\ttags: processedTags,\r\n\t\t\tsku: apiProduct.sku,\r\n\t\t\tattributes: apiProduct.attributes,\r\n\t\t\timages: processedImages,\r\n\t\t\tfeatured: Boolean(apiProduct.featured),\r\n\t\t\tpublished: Boolean(apiProduct.published ?? true),\r\n\t\t\tstatus: apiProduct.status || \"active\",\r\n\t\t\tviewCount: apiProduct.view_count || 0,\r\n\t\t\tsalesCount: apiProduct.sales_count || 0,\r\n\t\t\tdiscountPercentage: Number(apiProduct.discount_percentage || 0),\r\n\t\t\tisInStock: Boolean(apiProduct.is_in_stock ?? apiProduct.stock > 0),\r\n\t\t\trating: Number(apiProduct.rating || 0),\r\n\t\t\tratingCount: Number(apiProduct.rating_count || 0),\r\n\t\t\tcreatedAt: apiProduct.created_at,\r\n\t\t\tupdatedAt: apiProduct.updated_at,\r\n\t\t\tcreated_at: apiProduct.created_at || apiProduct.createdAt || new Date().toISOString(),\r\n\t\t\tcategory_name: apiProduct.category?.name || apiProduct.category_name || \"Sin categoría\",\r\n\r\n\t\t\t// Campos específicos de admin\r\n\t\t\tcategory: apiProduct.category_name\r\n\t\t\t\t? {\r\n\t\t\t\t\tid: apiProduct.category_id,\r\n\t\t\t\t\tname: apiProduct.category_name,\r\n\t\t\t\t}\r\n\t\t\t\t: apiProduct.category,\r\n\t\t\tseller: apiProduct.seller,\r\n\t\t\tuser: apiProduct.user,\r\n\t\t\tisNew: undefined\r\n\t\t};\r\n\r\n\t\treturn adaptedProduct;\r\n\t}, []);\r\n\r\n\t/**\r\n\t * Obtiene todos los productos (como admin)\r\n\t */\r\n\tconst fetchAllProducts = useCallback(\r\n\t\tasync (\r\n\t\t\tfilterParams?: ExtendedProductFilterParams,\r\n\t\t\tforceRefresh: boolean = false\r\n\t\t): Promise<ProductListResponse | null> => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\ttry {\r\n\t\t\t\tconst cacheKey = getAdminCacheKey(filterParams);\r\n\r\n\t\t\t\t// Verificar caché si no se fuerza refresh\r\n\t\t\t\tif (!forceRefresh) {\r\n\t\t\t\t\tconst cachedData = CacheService.getItem(cacheKey);\r\n\t\t\t\t\tif (cachedData) {\r\n\t\t\t\t\t\tconsole.log(\"💾 useAdminProducts: Usando datos en caché\");\r\n\t\t\t\t\t\tsetProducts(cachedData.data || []);\r\n\t\t\t\t\t\tsetMeta(cachedData.meta || null);\r\n\t\t\t\t\t\tsetLoading(false);\r\n\t\t\t\t\t\treturn cachedData;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconsole.log(\"🌐 useAdminProducts: Obteniendo productos desde API\");\r\n\t\t\t\tconsole.log(\"📊 useAdminProducts: FilterParams enviados:\", filterParams);\r\n\t\t\t\tconst response = await getAllProductsUseCase.execute(filterParams);\r\n\t\t\t\tconsole.log(\"📥 useAdminProducts: Respuesta completa recibida:\", response);\r\n\r\n\t\t\t\tif (response) {\r\n\t\t\t\t\tlet adaptedData: Product[] = [];\r\n\t\t\t\t\tlet responseMeta = null;\r\n\r\n\t\t\t\t\t// Procesar la respuesta según su estructura\r\n\t\t\t\t\tif (response.data && Array.isArray(response.data)) {\r\n\t\t\t\t\t\tadaptedData = response.data.map(adaptProduct);\r\n\t\t\t\t\t\tresponseMeta = response.meta;\r\n\t\t\t\t\t} else if (Array.isArray(response)) {\r\n\t\t\t\t\t\tadaptedData = response.map(adaptProduct);\r\n\t\t\t\t\t\tresponseMeta = {\r\n\t\t\t\t\t\t\ttotal: response.length,\r\n\t\t\t\t\t\t\tlimit: filterParams?.limit || 10,\r\n\t\t\t\t\t\t\toffset: filterParams?.offset || 0,\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tconsole.warn(\"⚠️ Estructura de respuesta no reconocida:\", response);\r\n\t\t\t\t\t\tadaptedData = [];\r\n\t\t\t\t\t\tresponseMeta = {total: 0, limit: 0, offset: 0};\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst result: ProductListResponse = {\r\n\t\t\t\t\t\tdata: adaptedData,\r\n\t\t\t\t\t\tmeta: responseMeta || {\r\n\t\t\t\t\t\t\ttotal: adaptedData.length,\r\n\t\t\t\t\t\t\tlimit: filterParams?.limit || 10,\r\n\t\t\t\t\t\t\toffset: filterParams?.offset || 0,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t// Guardar en caché\r\n\t\t\t\t\tCacheService.setItem(\r\n\t\t\t\t\t\tcacheKey,\r\n\t\t\t\t\t\tresult,\r\n\t\t\t\t\t\tappConfig.cache.productCacheTime\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tsetProducts(adaptedData);\r\n\t\t\t\t\tsetMeta(result.meta);\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetProducts([]);\r\n\t\t\t\t\tsetMeta({total: 0, limit: 0, offset: 0});\r\n\t\t\t\t\treturn {data: [], meta: {total: 0, limit: 0, offset: 0}};\r\n\t\t\t\t}\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconst errorMessage =\r\n\t\t\t\t\terr instanceof Error ? err.message : \"Error al obtener productos\";\r\n\t\t\t\tconsole.error(\"❌ Error obteniendo productos:\", err);\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\tsetProducts([]);\r\n\t\t\t\tsetMeta({total: 0, limit: 0, offset: 0});\r\n\t\t\t\treturn null;\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[adaptProduct]\r\n\t);\r\n\r\n\t/**\r\n\t * Obtiene un producto por ID (como admin)\r\n\t */\r\n\tconst fetchProductById = useCallback(\r\n\t\tasync (id: number): Promise<ProductDetail | null> => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\ttry {\r\n\t\t\t\tconst product = await adminProductService.getProductById(id);\r\n\t\t\t\tsetProductDetail(product);\r\n\t\t\t\treturn product;\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconst errorMessage =\r\n\t\t\t\t\terr instanceof Error ? err.message : \"Error al obtener producto\";\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\tsetProductDetail(null);\r\n\t\t\t\treturn null;\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[]\r\n\t);\r\n\r\n\t/**\r\n\t * Crea un producto (como admin)\r\n\t */\r\n\tconst createProduct = useCallback(\r\n\t\tasync (\r\n\t\t\tdata: ProductCreationData,\r\n\t\t\tsellerId?: number\r\n\t\t): Promise<Product | null> => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\ttry {\r\n\t\t\t\tconst product = await createProductAsAdminUseCase.execute(\r\n\t\t\t\t\tdata,\r\n\t\t\t\t\tsellerId\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif (product) {\r\n\t\t\t\t\t// Invalidar cache después de crear\r\n\t\t\t\t\tinvalidateAfterMutation([\r\n\t\t\t\t\t\t\"admin_products_*\",\r\n\t\t\t\t\t\t\"products_*\",\r\n\t\t\t\t\t\t\"products_featured_*\",\r\n\t\t\t\t\t]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn product;\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconst errorMessage =\r\n\t\t\t\t\terr instanceof Error ? err.message : \"Error al crear producto\";\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\treturn null;\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[invalidateAfterMutation]\r\n\t);\r\n\r\n\t/**\r\n\t * Actualiza cualquier producto (como admin)\r\n\t */\r\n\tconst updateProduct = useCallback(\r\n\t\tasync (data: ProductUpdateData): Promise<Product | null> => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\ttry {\r\n\t\t\t\tconst product = await updateAnyProductUseCase.execute(data);\r\n\r\n\t\t\t\tif (product) {\r\n\t\t\t\t\t// Actualizar producto en la lista actual\r\n\t\t\t\t\tsetProducts((prev) =>\r\n\t\t\t\t\t\tprev.map((p) => (p.id === data.id ? adaptProduct(product) : p))\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\t// Invalidar cache después de actualizar\r\n\t\t\t\t\tinvalidateAfterMutation([\r\n\t\t\t\t\t\t\"admin_products_*\",\r\n\t\t\t\t\t\t\"products_*\",\r\n\t\t\t\t\t\t`product_${data.id}`,\r\n\t\t\t\t\t\t\"products_featured_*\",\r\n\t\t\t\t\t]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn product;\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconst errorMessage =\r\n\t\t\t\t\terr instanceof Error ? err.message : \"Error al actualizar producto\";\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\treturn null;\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[adaptProduct, invalidateAfterMutation]\r\n\t);\r\n\r\n\t/**\r\n\t * Elimina cualquier producto (como admin)\r\n\t */\r\n\tconst deleteProduct = useCallback(\r\n\t\tasync (id: number): Promise<boolean> => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\ttry {\r\n\t\t\t\tconst result = await deleteAnyProductUseCase.execute(id);\r\n\r\n\t\t\t\tif (result) {\r\n\t\t\t\t\t// Remover producto de la lista actual\r\n\t\t\t\t\tsetProducts((prev) => prev.filter((p) => p.id !== id));\r\n\r\n\t\t\t\t\t// Invalidar cache después de eliminar\r\n\t\t\t\t\tinvalidateAfterMutation([\r\n\t\t\t\t\t\t\"admin_products_*\",\r\n\t\t\t\t\t\t\"products_*\",\r\n\t\t\t\t\t\t`product_${id}`,\r\n\t\t\t\t\t\t\"products_featured_*\",\r\n\t\t\t\t\t]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn result;\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconst errorMessage =\r\n\t\t\t\t\terr instanceof Error ? err.message : \"Error al eliminar producto\";\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\treturn false;\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[invalidateAfterMutation]\r\n\t);\r\n\r\n\t/**\r\n\t * Alterna el estado destacado de un producto\r\n\t */\r\n\tconst toggleFeatured = useCallback(\r\n\t\tasync (id: number, featured: boolean): Promise<boolean> => {\r\n\t\t\tsetError(null);\r\n\r\n\t\t\ttry {\r\n\t\t\t\tconst result = await toggleProductFeaturedUseCase.execute(id, featured);\r\n\r\n\t\t\t\tif (result) {\r\n\t\t\t\t\t// Actualizar producto en la lista actual INMEDIATAMENTE\r\n\t\t\t\t\tsetProducts((prev) =>\r\n\t\t\t\t\t\tprev.map((p) => (p.id === id ? {...p, featured} : p))\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\t// Invalidar cache después de la mutación\r\n\t\t\t\t\tinvalidateAfterMutation([\r\n\t\t\t\t\t\t\"admin_products_*\",\r\n\t\t\t\t\t\t\"products_*\",\r\n\t\t\t\t\t\t`product_${id}`,\r\n\t\t\t\t\t\t\"products_featured_*\",\r\n\t\t\t\t\t]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetError(\"Error al cambiar estado destacado del producto\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn result;\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconst errorMessage =\r\n\t\t\t\t\terr instanceof Error\r\n\t\t\t\t\t\t? err.message\r\n\t\t\t\t\t\t: \"Error al cambiar estado destacado\";\r\n\t\t\t\tconsole.error(\"❌ Error en toggleFeatured:\", err);\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\t\t[invalidateAfterMutation]\r\n\t);\r\n\r\n\t/**\r\n\t * Alterna el estado de publicación de un producto\r\n\t */\r\n\tconst togglePublished = useCallback(\r\n\t\tasync (id: number, published: boolean): Promise<boolean> => {\r\n\t\t\tsetError(null);\r\n\r\n\t\t\ttry {\r\n\t\t\t\tconst result = await toggleProductPublishedUseCase.execute(\r\n\t\t\t\t\tid,\r\n\t\t\t\t\tpublished\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif (result) {\r\n\t\t\t\t\t// Actualizar producto en la lista actual INMEDIATAMENTE\r\n\t\t\t\t\tsetProducts((prev) =>\r\n\t\t\t\t\t\tprev.map((p) => (p.id === id ? {...p, published} : p))\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\t// Invalidar cache después de la mutación\r\n\t\t\t\t\tinvalidateAfterMutation([\r\n\t\t\t\t\t\t\"admin_products_*\",\r\n\t\t\t\t\t\t\"products_*\",\r\n\t\t\t\t\t\t`product_${id}`,\r\n\t\t\t\t\t\t\"products_featured_*\",\r\n\t\t\t\t\t]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetError(\"Error al cambiar estado de publicación del producto\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn result;\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconst errorMessage =\r\n\t\t\t\t\terr instanceof Error\r\n\t\t\t\t\t\t? err.message\r\n\t\t\t\t\t\t: \"Error al cambiar estado de publicación\";\r\n\t\t\t\tconsole.error(\"❌ Error en togglePublished:\", err);\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\t\t[invalidateAfterMutation]\r\n\t);\r\n\r\n\t/**\r\n\t * Actualiza el estado de un producto\r\n\t */\r\n\tconst updateStatus = useCallback(\r\n\t\tasync (id: number, status: string): Promise<boolean> => {\r\n\t\t\tsetError(null);\r\n\r\n\t\t\ttry {\r\n\t\t\t\tconst result = await updateProductStatusUseCase.execute(id, status);\r\n\r\n\t\t\t\tif (result) {\r\n\t\t\t\t\t// Actualizar producto en la lista actual INMEDIATAMENTE\r\n\t\t\t\t\tsetProducts((prev) =>\r\n\t\t\t\t\t\tprev.map((p) => (p.id === id ? {...p, status} : p))\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\t// Invalidar cache después de la mutación\r\n\t\t\t\t\tinvalidateAfterMutation([\r\n\t\t\t\t\t\t\"admin_products_*\",\r\n\t\t\t\t\t\t\"products_*\",\r\n\t\t\t\t\t\t`product_${id}`,\r\n\t\t\t\t\t\t\"products_featured_*\",\r\n\t\t\t\t\t]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetError(\"Error al actualizar estado del producto\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn result;\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconst errorMessage =\r\n\t\t\t\t\terr instanceof Error ? err.message : \"Error al actualizar estado\";\r\n\t\t\t\tconsole.error(\"❌ Error en updateStatus:\", err);\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t},\r\n\t\t[invalidateAfterMutation]\r\n\t);\r\n\r\n\t/**\r\n\t * Obtiene productos por vendedor (como admin)\r\n\t */\r\n\tconst fetchProductsBySeller = useCallback(\r\n\t\tasync (\r\n\t\t\tsellerId: number,\r\n\t\t\tfilterParams?: ExtendedProductFilterParams\r\n\t\t): Promise<ProductListResponse | null> => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\ttry {\r\n\t\t\t\tconst response = await getProductsBySellerUseCase.execute(\r\n\t\t\t\t\tsellerId,\r\n\t\t\t\t\tfilterParams\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif (response && Array.isArray(response.data)) {\r\n\t\t\t\t\tconst adaptedData = response.data.map(adaptProduct);\r\n\t\t\t\t\tsetProducts(adaptedData);\r\n\t\t\t\t\tsetMeta(response.meta || null);\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn response;\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconst errorMessage =\r\n\t\t\t\t\terr instanceof Error\r\n\t\t\t\t\t\t? err.message\r\n\t\t\t\t\t\t: \"Error al obtener productos del vendedor\";\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\treturn null;\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[adaptProduct]\r\n\t);\r\n\r\n\t/**\r\n\t * Obtiene estadísticas de productos\r\n\t */\r\n\tconst fetchProductStats = useCallback(async (): Promise<any> => {\r\n\t\tsetLoading(true);\r\n\t\tsetError(null);\r\n\r\n\t\ttry {\r\n\t\t\tconst statsData = await getProductStatsUseCase.execute();\r\n\t\t\tsetStats(statsData);\r\n\t\t\treturn statsData;\r\n\t\t} catch (err) {\r\n\t\t\tconst errorMessage =\r\n\t\t\t\terr instanceof Error ? err.message : \"Error al obtener estadísticas\";\r\n\t\t\tsetError(errorMessage);\r\n\t\t\treturn null;\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t}, []);\r\n\r\n\t/**\r\n\t * Limpia la caché de productos de admin usando cache reactivo\r\n\t */\r\n\tconst clearProductCache = useCallback(\r\n\t\t(productId?: number) => {\r\n\t\t\tif (productId) {\r\n\t\t\t\t// Invalidar cache específica de un producto\r\n\t\t\t\tinvalidateAfterMutation([`product_${productId}`]);\r\n\t\t\t\tconsole.log(`🗑️ Caché del producto ${productId} invalidada`);\r\n\t\t\t} else {\r\n\t\t\t\t// Invalidar todos los patrones de productos\r\n\t\t\t\tinvalidateAfterMutation([\r\n\t\t\t\t\t\"admin_products_*\",\r\n\t\t\t\t\t\"products_*\",\r\n\t\t\t\t\t\"product_*\",\r\n\t\t\t\t]);\r\n\t\t\t\tconsole.log(\"🗑️ Toda la caché de productos invalidada\");\r\n\t\t\t}\r\n\t\t},\r\n\t\t[invalidateAfterMutation]\r\n\t);\r\n\r\n\treturn {\r\n\t\t// Estado\r\n\t\tloading,\r\n\t\terror,\r\n\t\tproducts,\r\n\t\tproductDetail,\r\n\t\tstats,\r\n\t\tmeta,\r\n\r\n\t\t// Métodos\r\n\t\tfetchAllProducts,\r\n\t\tfetchProductById,\r\n\t\tcreateProduct,\r\n\t\tupdateProduct,\r\n\t\tdeleteProduct,\r\n\t\ttoggleFeatured,\r\n\t\ttogglePublished,\r\n\t\tupdateStatus,\r\n\t\tfetchProductsBySeller,\r\n\t\tfetchProductStats,\r\n\t\tclearProductCache,\r\n\r\n\t\t// Utilidades\r\n\t\tsetError: (error: string | null) => setError(error),\r\n\t\tsetLoading: (loading: boolean) => setLoading(loading),\r\n\t};\r\n};\r\n\r\nexport default useAdminProducts;\r\n","// src/core/services/AdminCategoryService.ts - NUEVO\r\n\r\nimport ApiClient from \"../../infrastructure/api/apiClient\";\r\nimport {API_ENDPOINTS} from \"../../constants/apiEndpoints\";\r\nimport type {\r\n\tCategory,\r\n\tCategoryListResponse,\r\n\tCategoryCreationData,\r\n\tCategoryUpdateData,\r\n\tCategoryFilterParams,\r\n} from \"../domain/entities/Category\";\r\n\r\n/**\r\n * Servicio de administración de categorías - Solo para administradores\r\n * Permite gestionar cualquier categoría en el sistema usando las rutas de admin\r\n */\r\nexport class AdminCategoryService {\r\n\t/**\r\n\t * Obtiene todas las categorías del sistema (como admin)\r\n\t */\r\n\tasync getAllCategories(\r\n\t\tfilterParams?: CategoryFilterParams\r\n\t): Promise<CategoryListResponse | null> {\r\n\t\ttry {\r\n\t\t\tconsole.log(\r\n\t\t\t\t\"📤 AdminCategoryService: Obteniendo todas las categorías como admin:\",\r\n\t\t\t\tfilterParams\r\n\t\t\t);\r\n\r\n\t\t\t// Usar la ruta pública pero con permisos de admin\r\n\t\t\tconst response = await ApiClient.get<CategoryListResponse>(\r\n\t\t\t\tAPI_ENDPOINTS.CATEGORIES.LIST,\r\n\t\t\t\tfilterParams\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log(\"📥 AdminCategoryService: Respuesta del servidor:\", response);\r\n\t\t\treturn response;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\r\n\t\t\t\t\"❌ Error en AdminCategoryService.getAllCategories:\",\r\n\t\t\t\terror\r\n\t\t\t);\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Obtiene una categoría por ID (como admin)\r\n\t */\r\n\tasync getCategoryById(id: number): Promise<Category | null> {\r\n\t\ttry {\r\n\t\t\tconsole.log(\r\n\t\t\t\t`📤 AdminCategoryService: Obteniendo categoría ${id} como admin`\r\n\t\t\t);\r\n\r\n\t\t\tconst response = await ApiClient.get<Category>(\r\n\t\t\t\tAPI_ENDPOINTS.CATEGORIES.DETAILS(id)\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log(\"✅ AdminCategoryService: Categoría obtenida:\", response);\r\n\t\t\treturn response;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"❌ Error en AdminCategoryService.getCategoryById:\", error);\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Crea una categoría (como admin)\r\n\t */\r\n\tasync createCategory(data: CategoryCreationData): Promise<Category | null> {\r\n\t\ttry {\r\n\t\t\tconsole.log(\r\n\t\t\t\t\"📤 AdminCategoryService: Creando categoría como admin:\",\r\n\t\t\t\tdata\r\n\t\t\t);\r\n\r\n\t\t\t// USAR RUTA ADMIN ESPECÍFICA\r\n\t\t\tconst response = await ApiClient.post<Category>(\r\n\t\t\t\tAPI_ENDPOINTS.ADMIN.CATEGORIES.CREATE,\r\n\t\t\t\tdata\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log(\"✅ AdminCategoryService: Categoría creada:\", response);\r\n\t\t\treturn response;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"❌ Error en AdminCategoryService.createCategory:\", error);\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Actualiza cualquier categoría (como admin)\r\n\t */\r\n\tasync updateCategory(data: CategoryUpdateData): Promise<Category | null> {\r\n\t\ttry {\r\n\t\t\tconsole.log(\r\n\t\t\t\t`📤 AdminCategoryService: Actualizando categoría ${data.id} como admin:`,\r\n\t\t\t\tdata\r\n\t\t\t);\r\n\r\n\t\t\tif (!data.id) {\r\n\t\t\t\tthrow new Error(\"ID de categoría requerido para actualización\");\r\n\t\t\t}\r\n\r\n\t\t\t// USAR RUTA ADMIN ESPECÍFICA\r\n\t\t\tconst response = await ApiClient.put<Category>(\r\n\t\t\t\tAPI_ENDPOINTS.ADMIN.CATEGORIES.UPDATE(data.id),\r\n\t\t\t\tdata\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log(\"✅ AdminCategoryService: Categoría actualizada:\", response);\r\n\t\t\treturn response;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"❌ Error en AdminCategoryService.updateCategory:\", error);\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Actualización parcial de categoría (como admin) - PATCH\r\n\t */\r\n\tasync partialUpdateCategory(\r\n\t\tid: number,\r\n\t\tdata: Partial<CategoryUpdateData>\r\n\t): Promise<Category | null> {\r\n\t\ttry {\r\n\t\t\tconsole.log(\r\n\t\t\t\t`📤 AdminCategoryService: Actualizando parcialmente categoría ${id} como admin:`,\r\n\t\t\t\tdata\r\n\t\t\t);\r\n\r\n\t\t\t// USAR RUTA ADMIN PATCH ESPECÍFICA\r\n\t\t\tconst response = await ApiClient.patch<Category>(\r\n\t\t\t\tAPI_ENDPOINTS.ADMIN.CATEGORIES.PARTIAL_UPDATE(id),\r\n\t\t\t\tdata\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log(\r\n\t\t\t\t\"✅ AdminCategoryService: Categoría actualizada parcialmente:\",\r\n\t\t\t\tresponse\r\n\t\t\t);\r\n\t\t\treturn response;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\r\n\t\t\t\t\"❌ Error en AdminCategoryService.partialUpdateCategory:\",\r\n\t\t\t\terror\r\n\t\t\t);\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Elimina cualquier categoría (como admin)\r\n\t */\r\n\tasync deleteCategory(id: number): Promise<boolean> {\r\n\t\ttry {\r\n\t\t\tconsole.log(\r\n\t\t\t\t`📤 AdminCategoryService: Eliminando categoría ${id} como admin`\r\n\t\t\t);\r\n\r\n\t\t\t// USAR RUTA ADMIN ESPECÍFICA\r\n\t\t\tconst response = await ApiClient.delete(\r\n\t\t\t\tAPI_ENDPOINTS.ADMIN.CATEGORIES.DELETE(id)\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log(\"✅ AdminCategoryService: Categoría eliminada:\", response);\r\n\t\t\treturn true;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"❌ Error en AdminCategoryService.deleteCategory:\", error);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Cambia el estado activo de una categoría - PATCH\r\n\t */\r\n\tasync toggleActive(id: number, is_active: boolean): Promise<boolean> {\r\n\t\ttry {\r\n\t\t\tconsole.log(\r\n\t\t\t\t`📤 AdminCategoryService: Cambiando estado activo de categoría ${id} a ${is_active}`\r\n\t\t\t);\r\n\r\n\t\t\t// USAR RUTA ADMIN PATCH ESPECÍFICA\r\n\t\t\tconst response = await ApiClient.patch(\r\n\t\t\t\tAPI_ENDPOINTS.ADMIN.CATEGORIES.PARTIAL_UPDATE(id),\r\n\t\t\t\t{is_active: is_active}\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log(\r\n\t\t\t\t\"✅ AdminCategoryService: Estado activo actualizado:\",\r\n\t\t\t\tresponse\r\n\t\t\t);\r\n\t\t\treturn true;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"❌ Error en AdminCategoryService.toggleActive:\", error);\r\n\t\t\tif (error instanceof Error) {\r\n\t\t\t\tconsole.error(\"Error message:\", error.message);\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Cambia el estado destacado de una categoría - PATCH\r\n\t */\r\n\tasync toggleFeatured(id: number, featured: boolean): Promise<boolean> {\r\n\t\ttry {\r\n\t\t\tconsole.log(\r\n\t\t\t\t`📤 AdminCategoryService: Cambiando estado destacado de categoría ${id} a ${featured}`\r\n\t\t\t);\r\n\r\n\t\t\t// USAR RUTA ADMIN PATCH ESPECÍFICA\r\n\t\t\tconst response = await ApiClient.patch(\r\n\t\t\t\tAPI_ENDPOINTS.ADMIN.CATEGORIES.PARTIAL_UPDATE(id),\r\n\t\t\t\t{featured: featured}\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log(\r\n\t\t\t\t\"✅ AdminCategoryService: Estado destacado actualizado:\",\r\n\t\t\t\tresponse\r\n\t\t\t);\r\n\t\t\treturn true;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"❌ Error en AdminCategoryService.toggleFeatured:\", error);\r\n\t\t\tif (error instanceof Error) {\r\n\t\t\t\tconsole.error(\"Error message:\", error.message);\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Actualiza el orden de una categoría - PATCH\r\n\t */\r\n\tasync updateOrder(id: number, order: number): Promise<boolean> {\r\n\t\ttry {\r\n\t\t\tconsole.log(\r\n\t\t\t\t`📤 AdminCategoryService: Actualizando orden de categoría ${id} a ${order}`\r\n\t\t\t);\r\n\r\n\t\t\t// USAR RUTA ADMIN PATCH ESPECÍFICA\r\n\t\t\tconst response = await ApiClient.patch(\r\n\t\t\t\tAPI_ENDPOINTS.ADMIN.CATEGORIES.PARTIAL_UPDATE(id),\r\n\t\t\t\t{order: order}\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log(\"✅ AdminCategoryService: Orden actualizado:\", response);\r\n\t\t\treturn true;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"❌ Error en AdminCategoryService.updateOrder:\", error);\r\n\t\t\tif (error instanceof Error) {\r\n\t\t\t\tconsole.error(\"Error message:\", error.message);\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Obtiene categorías principales (como admin)\r\n\t */\r\n\tasync getMainCategories(withCounts: boolean = true): Promise<Category[]> {\r\n\t\ttry {\r\n\t\t\tconsole.log(\r\n\t\t\t\t\"📤 AdminCategoryService: Obteniendo categorías principales como admin\"\r\n\t\t\t);\r\n\r\n\t\t\tconst response = await ApiClient.get<{data: Category[]}>(\r\n\t\t\t\tAPI_ENDPOINTS.CATEGORIES.MAIN,\r\n\t\t\t\t{with_counts: withCounts}\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log(\r\n\t\t\t\t\"✅ AdminCategoryService: Categorías principales obtenidas:\",\r\n\t\t\t\tresponse\r\n\t\t\t);\r\n\t\t\treturn response?.data || [];\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\r\n\t\t\t\t\"❌ Error en AdminCategoryService.getMainCategories:\",\r\n\t\t\t\terror\r\n\t\t\t);\r\n\t\t\treturn [];\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Obtiene subcategorías de una categoría (como admin)\r\n\t */\r\n\tasync getSubcategories(parentId: number): Promise<Category[]> {\r\n\t\ttry {\r\n\t\t\tconsole.log(\r\n\t\t\t\t`📤 AdminCategoryService: Obteniendo subcategorías de ${parentId} como admin`\r\n\t\t\t);\r\n\r\n\t\t\tconst response = await ApiClient.get<{data: Category[]}>(\r\n\t\t\t\tAPI_ENDPOINTS.CATEGORIES.SUBCATEGORIES(parentId)\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log(\r\n\t\t\t\t\"✅ AdminCategoryService: Subcategorías obtenidas:\",\r\n\t\t\t\tresponse\r\n\t\t\t);\r\n\t\t\treturn response?.data || [];\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\r\n\t\t\t\t\"❌ Error en AdminCategoryService.getSubcategories:\",\r\n\t\t\t\terror\r\n\t\t\t);\r\n\t\t\treturn [];\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default AdminCategoryService;\r\n","// src/core/useCases/admin/category/GetAllCategoriesUseCase.ts\r\n\r\nimport {AdminCategoryService} from \"../../../services/AdminCategoryService\";\r\nimport type {\r\n\tCategoryListResponse,\r\n\tCategoryFilterParams,\r\n} from \"../../../domain/entities/Category\";\r\n\r\nexport class GetAllCategoriesUseCase {\r\n\tprivate adminCategoryService: AdminCategoryService;\r\n\r\n\tconstructor(adminCategoryService: AdminCategoryService) {\r\n\t\tthis.adminCategoryService = adminCategoryService;\r\n\t}\r\n\r\n\tasync execute(\r\n\t\tfilterParams?: CategoryFilterParams\r\n\t): Promise<CategoryListResponse | null> {\r\n\t\tconsole.log(\r\n\t\t\t\"GetAllCategoriesUseCase: Obteniendo todas las categorías como admin\"\r\n\t\t);\r\n\t\ttry {\r\n\t\t\tconst categories =\r\n\t\t\t\tawait this.adminCategoryService.getAllCategories(filterParams);\r\n\t\t\tconsole.log(\r\n\t\t\t\t\"GetAllCategoriesUseCase: Categorías obtenidas correctamente:\",\r\n\t\t\t\tcategories\r\n\t\t\t);\r\n\t\t\treturn categories;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\r\n\t\t\t\t\"GetAllCategoriesUseCase: Error al obtener categorías:\",\r\n\t\t\t\terror\r\n\t\t\t);\r\n\t\t\tthrow error;\r\n\t\t}\r\n\t}\r\n}\r\n","// src/core/useCases/admin/category/CreateCategoryAsAdminUseCase.ts\r\n\r\nimport {AdminCategoryService} from \"../../../services/AdminCategoryService\";\r\nimport type {\r\n\tCategory,\r\n\tCategoryCreationData,\r\n} from \"../../../domain/entities/Category\";\r\n\r\nexport class CreateCategoryAsAdminUseCase {\r\n\tprivate adminCategoryService: AdminCategoryService;\r\n\r\n\tconstructor(adminCategoryService: AdminCategoryService) {\r\n\t\tthis.adminCategoryService = adminCategoryService;\r\n\t}\r\n\r\n\tasync execute(data: CategoryCreationData): Promise<Category | null> {\r\n\t\tconsole.log(\r\n\t\t\t\"CreateCategoryAsAdminUseCase: Creando categoría como admin:\",\r\n\t\t\tdata\r\n\t\t);\r\n\t\ttry {\r\n\t\t\tconst category = await this.adminCategoryService.createCategory(data);\r\n\t\t\tconsole.log(\r\n\t\t\t\t\"CreateCategoryAsAdminUseCase: Categoría creada correctamente:\",\r\n\t\t\t\tcategory\r\n\t\t\t);\r\n\t\t\treturn category;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\r\n\t\t\t\t\"CreateCategoryAsAdminUseCase: Error al crear categoría:\",\r\n\t\t\t\terror\r\n\t\t\t);\r\n\t\t\tthrow error;\r\n\t\t}\r\n\t}\r\n}\r\n","// src/core/useCases/admin/category/UpdateAnyCategoryUseCase.ts\r\n\r\nimport {AdminCategoryService} from \"../../../services/AdminCategoryService\";\r\nimport type {\r\n    Category,\r\n    CategoryUpdateData,\r\n} from \"../../../domain/entities/Category\";\r\n\r\nexport class UpdateAnyCategoryUseCase {\r\n    private adminCategoryService: AdminCategoryService;\r\n\r\n    constructor(adminCategoryService: AdminCategoryService) {\r\n        this.adminCategoryService = adminCategoryService;\r\n    }\r\n\r\n    async execute(data: CategoryUpdateData): Promise<Category | null> {\r\n        console.log(\r\n            `UpdateAnyCategoryUseCase: Actualizando categoría ${data.id} como admin:`,\r\n            data\r\n        );\r\n        try {\r\n            const category = await this.adminCategoryService.updateCategory(data);\r\n            console.log(\r\n                \"UpdateAnyCategoryUseCase: Categoría actualizada correctamente:\",\r\n                category\r\n            );\r\n            return category;\r\n        } catch (error) {\r\n            console.error(\r\n                \"UpdateAnyCategoryUseCase: Error al actualizar categoría:\",\r\n                error\r\n            );\r\n            throw error;\r\n        }\r\n    }\r\n}","// src/core/useCases/admin/category/DeleteAnyCategoryUseCase.ts\r\n\r\nimport {AdminCategoryService} from \"../../../services/AdminCategoryService\";\r\n\r\nexport class DeleteAnyCategoryUseCase {\r\n    private adminCategoryService: AdminCategoryService;\r\n\r\n    constructor(adminCategoryService: AdminCategoryService) {\r\n        this.adminCategoryService = adminCategoryService;\r\n    }\r\n\r\n    async execute(id: number): Promise<boolean> {\r\n        console.log(\r\n            `DeleteAnyCategoryUseCase: Eliminando categoría ${id} como admin`\r\n        );\r\n        try {\r\n            const result = await this.adminCategoryService.deleteCategory(id);\r\n            console.log(\r\n                \"DeleteAnyCategoryUseCase: Categoría eliminada correctamente:\",\r\n                result\r\n            );\r\n            return result;\r\n        } catch (error) {\r\n            console.error(\r\n                \"DeleteAnyCategoryUseCase: Error al eliminar categoría:\",\r\n                error\r\n            );\r\n            throw error;\r\n        }\r\n    }\r\n}","// src/core/useCases/admin/category/ToggleCategoryActiveUseCase.ts\r\n\r\nimport {AdminCategoryService} from \"../../../services/AdminCategoryService\";\r\n\r\nexport class ToggleCategoryActiveUseCase {\r\n    private adminCategoryService: AdminCategoryService;\r\n\r\n    constructor(adminCategoryService: AdminCategoryService) {\r\n        this.adminCategoryService = adminCategoryService;\r\n    }\r\n\r\n    async execute(id: number, is_active: boolean): Promise<boolean> {\r\n        console.log(\r\n            `ToggleCategoryActiveUseCase: Cambiando estado activo de categoría ${id} a ${is_active}`\r\n        );\r\n        try {\r\n            const result = await this.adminCategoryService.toggleActive(\r\n                id,\r\n                is_active\r\n            );\r\n            console.log(\r\n                \"ToggleCategoryActiveUseCase: Estado activo actualizado correctamente:\",\r\n                result\r\n            );\r\n            return result;\r\n        } catch (error) {\r\n            console.error(\r\n                \"ToggleCategoryActiveUseCase: Error al cambiar estado activo:\",\r\n                error\r\n            );\r\n            throw error;\r\n        }\r\n    }\r\n}","// src/core/useCases/admin/category/ToggleCategoryFeaturedUseCase.ts\r\n\r\nimport {AdminCategoryService} from \"../../../services/AdminCategoryService\";\r\n\r\nexport class ToggleCategoryFeaturedUseCase {\r\n    private adminCategoryService: AdminCategoryService;\r\n\r\n    constructor(adminCategoryService: AdminCategoryService) {\r\n        this.adminCategoryService = adminCategoryService;\r\n    }\r\n\r\n    async execute(id: number, featured: boolean): Promise<boolean> {\r\n        console.log(\r\n            `ToggleCategoryFeaturedUseCase: Cambiando estado destacado de categoría ${id} a ${featured}`\r\n        );\r\n        try {\r\n            const result = await this.adminCategoryService.toggleFeatured(\r\n                id,\r\n                featured\r\n            );\r\n            console.log(\r\n                \"ToggleCategoryFeaturedUseCase: Estado destacado actualizado correctamente:\",\r\n                result\r\n            );\r\n            return result;\r\n        } catch (error) {\r\n            console.error(\r\n                \"ToggleCategoryFeaturedUseCase: Error al cambiar estado destacado:\",\r\n                error\r\n            );\r\n            throw error;\r\n        }\r\n    }\r\n}","// src/core/useCases/admin/category/GetCategoryByIdUseCase.ts\r\n\r\nimport {AdminCategoryService} from \"../../../services/AdminCategoryService\";\r\nimport type {Category} from \"../../../domain/entities/Category\";\r\n\r\nexport class GetCategoryByIdUseCase {\r\n\tprivate adminCategoryService: AdminCategoryService;\r\n\r\n\tconstructor(adminCategoryService: AdminCategoryService) {\r\n\t\tthis.adminCategoryService = adminCategoryService;\r\n\t}\r\n\r\n\tasync execute(id: number): Promise<Category | null> {\r\n\t\tconsole.log(\r\n\t\t\t`GetCategoryByIdUseCase: Obteniendo categoría ${id} como admin`\r\n\t\t);\r\n\t\ttry {\r\n\t\t\tconst category = await this.adminCategoryService.getCategoryById(id);\r\n\t\t\tconsole.log(\r\n\t\t\t\t\"GetCategoryByIdUseCase: Categoría obtenida correctamente:\",\r\n\t\t\t\tcategory\r\n\t\t\t);\r\n\t\t\treturn category;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\r\n\t\t\t\t\"GetCategoryByIdUseCase: Error al obtener categoría:\",\r\n\t\t\t\terror\r\n\t\t\t);\r\n\t\t\tthrow error;\r\n\t\t}\r\n\t}\r\n}\r\n","// src/presentation/hooks/useAdminCategories.ts - CORREGIDO\r\n\r\nimport {useState, useCallback} from \"react\";\r\nimport {useCacheInvalidation} from \"./useReactiveCache\";\r\nimport {AdminCategoryService} from \"../../core/services/AdminCategoryService\";\r\nimport CacheService from \"../../infrastructure/services/CacheService\";\r\nimport appConfig from \"../../config/appConfig\";\r\n\r\n// Use Cases\r\nimport {GetAllCategoriesUseCase} from \"../../core/useCases/admin/category/GetAllCategoriesUseCase\";\r\nimport {CreateCategoryAsAdminUseCase} from \"../../core/useCases/admin/category/CreateCategoryAsAdminUseCase\";\r\nimport {UpdateAnyCategoryUseCase} from \"../../core/useCases/admin/category/UpdateAnyCategoryUseCase\";\r\nimport {DeleteAnyCategoryUseCase} from \"../../core/useCases/admin/category/DeleteAnyCategoryUseCase\";\r\nimport {ToggleCategoryActiveUseCase} from \"../../core/useCases/admin/category/ToggleCategoryActiveUseCase\";\r\nimport {ToggleCategoryFeaturedUseCase} from \"../../core/useCases/admin/category/ToggleCategoryFeaturedUseCase\";\r\nimport {GetCategoryByIdUseCase} from \"../../core/useCases/admin/category/GetCategoryByIdUseCase\";\r\n\r\nimport type {\r\n\tCategory,\r\n\tCategoryListResponse,\r\n\tCategoryCreationData,\r\n\tCategoryUpdateData,\r\n\tCategoryFilterParams,\r\n} from \"../../core/domain/entities/Category\";\r\n\r\n// Instanciar el servicio y use cases\r\nconst adminCategoryService = new AdminCategoryService();\r\n\r\nconst getAllCategoriesUseCase = new GetAllCategoriesUseCase(\r\n\tadminCategoryService\r\n);\r\nconst createCategoryAsAdminUseCase = new CreateCategoryAsAdminUseCase(\r\n\tadminCategoryService\r\n);\r\nconst updateAnyCategoryUseCase = new UpdateAnyCategoryUseCase(\r\n\tadminCategoryService\r\n);\r\nconst deleteAnyCategoryUseCase = new DeleteAnyCategoryUseCase(\r\n\tadminCategoryService\r\n);\r\nconst toggleCategoryActiveUseCase = new ToggleCategoryActiveUseCase(\r\n\tadminCategoryService\r\n);\r\nconst toggleCategoryFeaturedUseCase = new ToggleCategoryFeaturedUseCase(\r\n\tadminCategoryService\r\n);\r\nconst getCategoryByIdUseCase = new GetCategoryByIdUseCase(adminCategoryService);\r\n\r\n/**\r\n * Hook para gestión administrativa de categorías\r\n * Solo para usuarios con rol de administrador\r\n */\r\nexport const useAdminCategories = () => {\r\n\tconst [loading, setLoading] = useState<boolean>(false);\r\n\tconst [error, setError] = useState<string | null>(null);\r\n\tconst [categories, setCategories] = useState<Category[]>([]);\r\n\tconst [mainCategories, setMainCategories] = useState<Category[]>([]);\r\n\tconst [categoryDetail, setCategoryDetail] = useState<Category | null>(null);\r\n\r\n\t// Hook para invalidación de cache\r\n\tconst {invalidateAfterMutation} = useCacheInvalidation();\r\n\r\n\t/**\r\n\t * Adaptador para normalizar los datos de categorías\r\n\t */\r\n\tconst adaptCategory = useCallback((apiCategory: any): Category => {\r\n\t\tif (!apiCategory || typeof apiCategory !== \"object\") {\r\n\t\t\tconsole.error(\"Categoría inválida para adaptar:\", apiCategory);\r\n\t\t\treturn {} as Category;\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tid: apiCategory.id,\r\n\t\t\tname: apiCategory.name || \"\",\r\n\t\t\tslug: apiCategory.slug || \"\",\r\n\t\t\tdescription: apiCategory.description || \"\",\r\n\t\t\tparent_id: apiCategory.parent_id,\r\n\t\t\ticon: apiCategory.icon,\r\n\t\t\timage: apiCategory.image,\r\n\t\t\torder: apiCategory.order,\r\n\t\t\tis_active: Boolean(apiCategory.is_active ?? true),\r\n\t\t\tfeatured: Boolean(apiCategory.featured ?? false),\r\n\t\t\tcreated_at: apiCategory.created_at,\r\n\t\t\tupdated_at: apiCategory.updated_at,\r\n\t\t\t// API response specific fields\r\n\t\t\tsubcategories: Array.isArray(apiCategory.subcategories)\r\n\t\t\t\t? apiCategory.subcategories.map((sub: any) => adaptCategory(sub))\r\n\t\t\t\t: undefined,\r\n\t\t\tproduct_count: apiCategory.product_count || 0,\r\n\t\t\t// full_path: apiCategory.full_path, // Commented out as not in Category type\r\n\t\t\t// has_children: Boolean(apiCategory.has_children), // Commented out as not in Category type\r\n\t\t\t// url: apiCategory.url, // Commented out as not in Category type\r\n\t\t\tparent: apiCategory.parent\r\n\t\t\t\t? adaptCategory(apiCategory.parent)\r\n\t\t\t\t: undefined,\r\n\t\t\t// image_url: apiCategory.image_url, // Commented out as not in Category type\r\n\t\t\t// icon_url: apiCategory.icon_url, // Commented out as not in Category type\r\n\t\t};\r\n\t}, []);\r\n\r\n\t/**\r\n\t * Obtiene todas las categorías (como admin)\r\n\t */\r\n\tconst fetchAllCategories = useCallback(\r\n\t\tasync (\r\n\t\t\tparams?: CategoryFilterParams,\r\n\t\t\tforceRefresh: boolean = false\r\n\t\t): Promise<CategoryListResponse> => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\tconst cacheKey = `admin_categories_${JSON.stringify(params || {})}`;\r\n\r\n\t\t\ttry {\r\n\t\t\t\t// Verificar caché si no se fuerza refresh\r\n\t\t\t\tif (!forceRefresh) {\r\n\t\t\t\t\tconst cachedData = CacheService.getItem(cacheKey);\r\n\t\t\t\t\tif (cachedData && Array.isArray(cachedData.data)) {\r\n\t\t\t\t\t\tconsole.log(\"💾 useAdminCategories: Usando categorías en caché\");\r\n\t\t\t\t\t\tsetCategories(cachedData.data);\r\n\t\t\t\t\t\tsetLoading(false);\r\n\t\t\t\t\t\treturn cachedData;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconsole.log(\"🌐 useAdminCategories: Obteniendo categorías desde API\");\r\n\t\t\t\tconst response: CategoryListResponse | null =\r\n\t\t\t\t\tawait getAllCategoriesUseCase.execute({\r\n\t\t\t\t\t\t...params,\r\n\t\t\t\t\t\t// No filtrar por is_active para que admin vea todas\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\tif (\r\n\t\t\t\t\tresponse &&\r\n\t\t\t\t\ttypeof response === \"object\" &&\r\n\t\t\t\t\t\"data\" in response &&\r\n\t\t\t\t\tArray.isArray(response.data)\r\n\t\t\t\t) {\r\n\t\t\t\t\tconst adaptedCategories = response.data.map(adaptCategory);\r\n\r\n\t\t\t\t\tconst result: CategoryListResponse = {\r\n\t\t\t\t\t\tdata: adaptedCategories,\r\n\t\t\t\t\t\tmeta: response.meta || {total: adaptedCategories.length},\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t// Guardar en caché\r\n\t\t\t\t\tCacheService.setItem(\r\n\t\t\t\t\t\tcacheKey,\r\n\t\t\t\t\t\tresult,\r\n\t\t\t\t\t\tappConfig.cache.categoryCacheTime\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tsetCategories(adaptedCategories);\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.warn(\r\n\t\t\t\t\t\t\"Respuesta de categorías no tiene el formato esperado:\",\r\n\t\t\t\t\t\tresponse\r\n\t\t\t\t\t);\r\n\t\t\t\t\tsetCategories([]);\r\n\t\t\t\t\tconst emptyResult: CategoryListResponse = {\r\n\t\t\t\t\t\tdata: [],\r\n\t\t\t\t\t\tmeta: {total: 0},\r\n\t\t\t\t\t};\r\n\t\t\t\t\treturn emptyResult;\r\n\t\t\t\t}\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconst errorMessage =\r\n\t\t\t\t\terr instanceof Error ? err.message : \"Error al obtener categorías\";\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\tconsole.error(\"Error al obtener categorías:\", err);\r\n\t\t\t\tsetCategories([]);\r\n\t\t\t\tconst emptyResult: CategoryListResponse = {data: [], meta: {total: 0}};\r\n\t\t\t\treturn emptyResult;\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[adaptCategory]\r\n\t);\r\n\r\n\t/**\r\n\t * Obtiene categorías principales (como admin)\r\n\t */\r\n\tconst fetchMainCategories = useCallback(\r\n\t\tasync (\r\n\t\t\twithCounts: boolean = true,\r\n\t\t\tforceRefresh: boolean = false\r\n\t\t): Promise<Category[]> => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\tconst cacheKey = `admin_main_categories_${withCounts ? \"with_counts\" : \"no_counts\"}`;\r\n\r\n\t\t\ttry {\r\n\t\t\t\t// Verificar caché si no se fuerza refresh\r\n\t\t\t\tif (!forceRefresh) {\r\n\t\t\t\t\tconst cachedData = CacheService.getItem(cacheKey);\r\n\t\t\t\t\tif (cachedData && Array.isArray(cachedData)) {\r\n\t\t\t\t\t\tconsole.log(\r\n\t\t\t\t\t\t\t\"💾 useAdminCategories: Usando categorías principales en caché\"\r\n\t\t\t\t\t\t);\r\n\t\t\t\t\t\tsetMainCategories(cachedData);\r\n\t\t\t\t\t\tsetLoading(false);\r\n\t\t\t\t\t\treturn cachedData;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconsole.log(\r\n\t\t\t\t\t\"🌐 useAdminCategories: Obteniendo categorías principales desde API\"\r\n\t\t\t\t);\r\n\t\t\t\tconst response: Category[] | CategoryListResponse | null =\r\n\t\t\t\t\tawait adminCategoryService.getMainCategories(withCounts);\r\n\r\n\t\t\t\t// Manejar respuesta que puede ser array directo o con estructura {data, meta}\r\n\t\t\t\tlet categoriesArray: Category[] = [];\r\n\r\n\t\t\t\tif (Array.isArray(response)) {\r\n\t\t\t\t\tcategoriesArray = response;\r\n\t\t\t\t} else if (\r\n\t\t\t\t\tresponse &&\r\n\t\t\t\t\ttypeof response === \"object\" &&\r\n\t\t\t\t\t\"data\" in response &&\r\n\t\t\t\t\tArray.isArray((response as CategoryListResponse).data)\r\n\t\t\t\t) {\r\n\t\t\t\t\tcategoriesArray = (response as CategoryListResponse).data;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconsole.warn(\r\n\t\t\t\t\t\t\"Respuesta de categorías principales no tiene el formato esperado:\",\r\n\t\t\t\t\t\tresponse\r\n\t\t\t\t\t);\r\n\t\t\t\t\tsetMainCategories([]);\r\n\t\t\t\t\treturn [];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst adaptedCategories = categoriesArray.map(adaptCategory);\r\n\r\n\t\t\t\t// Guardar en caché\r\n\t\t\t\tCacheService.setItem(\r\n\t\t\t\t\tcacheKey,\r\n\t\t\t\t\tadaptedCategories,\r\n\t\t\t\t\tappConfig.cache.categoryCacheTime\r\n\t\t\t\t);\r\n\r\n\t\t\t\tsetMainCategories(adaptedCategories);\r\n\t\t\t\treturn adaptedCategories;\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconst errorMessage =\r\n\t\t\t\t\terr instanceof Error\r\n\t\t\t\t\t\t? err.message\r\n\t\t\t\t\t\t: \"Error al obtener categorías principales\";\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\tconsole.error(\"Error al obtener categorías principales:\", err);\r\n\t\t\t\tsetMainCategories([]);\r\n\t\t\t\treturn [];\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[adaptCategory]\r\n\t);\r\n\r\n\t/**\r\n\t * Obtiene una categoría por ID (como admin)\r\n\t */\r\n\tconst fetchCategoryById = useCallback(\r\n\t\tasync (id: number): Promise<Category | null> => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\tconst cacheKey = `admin_category_${id}`;\r\n\r\n\t\t\ttry {\r\n\t\t\t\t// Verificar caché primero\r\n\t\t\t\tconst cachedData = CacheService.getItem(cacheKey);\r\n\t\t\t\tif (cachedData) {\r\n\t\t\t\t\tconsole.log(`💾 useAdminCategories: Usando categoría ${id} en caché`);\r\n\t\t\t\t\tsetCategoryDetail(cachedData);\r\n\t\t\t\t\tsetLoading(false);\r\n\t\t\t\t\treturn cachedData;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconsole.log(\r\n\t\t\t\t\t`🌐 useAdminCategories: Obteniendo categoría ${id} desde API`\r\n\t\t\t\t);\r\n\t\t\t\tconst response: Category | null =\r\n\t\t\t\t\tawait getCategoryByIdUseCase.execute(id);\r\n\r\n\t\t\t\tif (response && typeof response === \"object\") {\r\n\t\t\t\t\tconst adaptedCategory = adaptCategory(response);\r\n\r\n\t\t\t\t\t// Guardar en caché\r\n\t\t\t\t\tCacheService.setItem(\r\n\t\t\t\t\t\tcacheKey,\r\n\t\t\t\t\t\tadaptedCategory,\r\n\t\t\t\t\t\tappConfig.cache.categoryCacheTime\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tsetCategoryDetail(adaptedCategory);\r\n\t\t\t\t\treturn adaptedCategory;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tsetCategoryDetail(null);\r\n\t\t\t\treturn null;\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconst errorMessage =\r\n\t\t\t\t\terr instanceof Error ? err.message : \"Error al obtener categoría\";\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\tconsole.error(\"Error al obtener categoría:\", err);\r\n\t\t\t\tsetCategoryDetail(null);\r\n\t\t\t\treturn null;\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[adaptCategory]\r\n\t);\r\n\r\n\t/**\r\n\t * Crea una nueva categoría (como admin)\r\n\t */\r\n\tconst createCategory = useCallback(\r\n\t\tasync (data: CategoryCreationData): Promise<Category | null> => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\ttry {\r\n\t\t\t\tconsole.log(\"🌐 useAdminCategories: Creando nueva categoría:\", data);\r\n\t\t\t\tconst response: Category | null =\r\n\t\t\t\t\tawait createCategoryAsAdminUseCase.execute(data);\r\n\r\n\t\t\t\tif (response && typeof response === \"object\") {\r\n\t\t\t\t\tconst adaptedCategory = adaptCategory(response);\r\n\r\n\t\t\t\t\t// Actualizar la lista de categorías\r\n\t\t\t\t\tsetCategories((prev) => [...prev, adaptedCategory]);\r\n\r\n\t\t\t\t\t// Si es una categoría principal, también actualizar esa lista\r\n\t\t\t\t\tif (!data.parent_id) {\r\n\t\t\t\t\t\tsetMainCategories((prev) => [...prev, adaptedCategory]);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Invalidar cache después de crear\r\n\t\t\t\t\tinvalidateAfterMutation([\r\n\t\t\t\t\t\t\"admin_categories_*\",\r\n\t\t\t\t\t\t\"categories_*\",\r\n\t\t\t\t\t\t\"admin_main_categories_*\",\r\n\t\t\t\t\t\t\"categories_main_*\",\r\n\t\t\t\t\t\t\"categories_featured_*\",\r\n\t\t\t\t\t]);\r\n\r\n\t\t\t\t\treturn adaptedCategory;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn null;\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconst errorMessage =\r\n\t\t\t\t\terr instanceof Error ? err.message : \"Error al crear categoría\";\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\tconsole.error(\"Error al crear categoría:\", err);\r\n\t\t\t\treturn null;\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[adaptCategory, invalidateAfterMutation]\r\n\t);\r\n\r\n\t/**\r\n\t * Actualiza una categoría (como admin)\r\n\t */\r\n\tconst updateCategory = useCallback(\r\n\t\tasync (data: CategoryUpdateData): Promise<Category | null> => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\ttry {\r\n\t\t\t\tconsole.log(\r\n\t\t\t\t\t`🌐 useAdminCategories: Actualizando categoría ${data.id}:`,\r\n\t\t\t\t\tdata\r\n\t\t\t\t);\r\n\t\t\t\tconst response: Category | null =\r\n\t\t\t\t\tawait updateAnyCategoryUseCase.execute(data);\r\n\r\n\t\t\t\tif (response && typeof response === \"object\") {\r\n\t\t\t\t\tconst adaptedCategory = adaptCategory(response);\r\n\r\n\t\t\t\t\t// Actualizar en las listas actuales\r\n\t\t\t\t\tsetCategories((prev) =>\r\n\t\t\t\t\t\tprev.map((cat) => (cat.id === data.id ? adaptedCategory : cat))\r\n\t\t\t\t\t);\r\n\t\t\t\t\tsetMainCategories((prev) =>\r\n\t\t\t\t\t\tprev.map((cat) => (cat.id === data.id ? adaptedCategory : cat))\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\t// Actualizar detalle si coincide\r\n\t\t\t\t\tif (categoryDetail?.id === data.id) {\r\n\t\t\t\t\t\tsetCategoryDetail(adaptedCategory);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Invalidar cache después de actualizar\r\n\t\t\t\t\tinvalidateAfterMutation([\r\n\t\t\t\t\t\t\"admin_categories_*\",\r\n\t\t\t\t\t\t\"categories_*\",\r\n\t\t\t\t\t\t`admin_category_${data.id}`,\r\n\t\t\t\t\t\t`category_${data.id}`,\r\n\t\t\t\t\t\t\"admin_main_categories_*\",\r\n\t\t\t\t\t\t\"categories_main_*\",\r\n\t\t\t\t\t\t\"categories_featured_*\",\r\n\t\t\t\t\t]);\r\n\r\n\t\t\t\t\treturn adaptedCategory;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn null;\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconst errorMessage =\r\n\t\t\t\t\terr instanceof Error ? err.message : \"Error al actualizar categoría\";\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\tconsole.error(\"Error al actualizar categoría:\", err);\r\n\t\t\t\treturn null;\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[adaptCategory, categoryDetail, invalidateAfterMutation]\r\n\t);\r\n\r\n\t/**\r\n\t * Elimina una categoría (como admin)\r\n\t */\r\n\tconst deleteCategory = useCallback(\r\n\t\tasync (id: number): Promise<boolean> => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\ttry {\r\n\t\t\t\tconsole.log(`🌐 useAdminCategories: Eliminando categoría ${id}`);\r\n\t\t\t\tconst result = await deleteAnyCategoryUseCase.execute(id);\r\n\r\n\t\t\t\tif (result) {\r\n\t\t\t\t\t// Remover de las listas actuales\r\n\t\t\t\t\tsetCategories((prev) => prev.filter((cat) => cat.id !== id));\r\n\t\t\t\t\tsetMainCategories((prev) => prev.filter((cat) => cat.id !== id));\r\n\r\n\t\t\t\t\t// Limpiar detalle si coincide\r\n\t\t\t\t\tif (categoryDetail?.id === id) {\r\n\t\t\t\t\t\tsetCategoryDetail(null);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Invalidar cache después de eliminar\r\n\t\t\t\t\tinvalidateAfterMutation([\r\n\t\t\t\t\t\t\"admin_categories_*\",\r\n\t\t\t\t\t\t\"categories_*\",\r\n\t\t\t\t\t\t`admin_category_${id}`,\r\n\t\t\t\t\t\t`category_${id}`,\r\n\t\t\t\t\t\t\"admin_main_categories_*\",\r\n\t\t\t\t\t\t\"categories_main_*\",\r\n\t\t\t\t\t\t\"categories_featured_*\",\r\n\t\t\t\t\t]);\r\n\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn false;\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconst errorMessage =\r\n\t\t\t\t\terr instanceof Error ? err.message : \"Error al eliminar categoría\";\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\tconsole.error(\"Error al eliminar categoría:\", err);\r\n\t\t\t\treturn false;\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[categoryDetail, invalidateAfterMutation]\r\n\t);\r\n\r\n\t/**\r\n\t * Alterna el estado activo de una categoría\r\n\t */\r\n\tconst toggleActive = useCallback(\r\n\t\tasync (id: number, is_active: boolean): Promise<boolean> => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\ttry {\r\n\t\t\t\tconsole.log(\r\n\t\t\t\t\t`🌐 useAdminCategories: Cambiando estado activo de categoría ${id} a ${is_active}`\r\n\t\t\t\t);\r\n\t\t\t\tconst result = await toggleCategoryActiveUseCase.execute(id, is_active);\r\n\r\n\t\t\t\tif (result) {\r\n\t\t\t\t\t// Actualizar en las listas actuales\r\n\t\t\t\t\tconst updateCategory = (cat: Category) =>\r\n\t\t\t\t\t\tcat.id === id ? {...cat, is_active} : cat;\r\n\r\n\t\t\t\t\tsetCategories((prev) => prev.map(updateCategory));\r\n\t\t\t\t\tsetMainCategories((prev) => prev.map(updateCategory));\r\n\r\n\t\t\t\t\t// Actualizar detalle si coincide\r\n\t\t\t\t\tif (categoryDetail?.id === id) {\r\n\t\t\t\t\t\tsetCategoryDetail((prev) => (prev ? {...prev, is_active} : prev));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Invalidar cache después de la mutación\r\n\t\t\t\t\tinvalidateAfterMutation([\r\n\t\t\t\t\t\t\"admin_categories_*\",\r\n\t\t\t\t\t\t\"categories_*\",\r\n\t\t\t\t\t\t`admin_category_${id}`,\r\n\t\t\t\t\t\t`category_${id}`,\r\n\t\t\t\t\t\t\"admin_main_categories_*\",\r\n\t\t\t\t\t\t\"categories_main_*\",\r\n\t\t\t\t\t\t\"categories_featured_*\",\r\n\t\t\t\t\t]);\r\n\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn false;\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconst errorMessage =\r\n\t\t\t\t\terr instanceof Error ? err.message : \"Error al cambiar estado activo\";\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\tconsole.error(\"Error al cambiar estado activo:\", err);\r\n\t\t\t\treturn false;\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[categoryDetail, invalidateAfterMutation]\r\n\t);\r\n\r\n\t/**\r\n\t * Alterna el estado destacado de una categoría\r\n\t */\r\n\tconst toggleFeatured = useCallback(\r\n\t\tasync (id: number, featured: boolean): Promise<boolean> => {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\r\n\t\t\ttry {\r\n\t\t\t\tconsole.log(\r\n\t\t\t\t\t`🌐 useAdminCategories: Cambiando estado destacado de categoría ${id} a ${featured}`\r\n\t\t\t\t);\r\n\t\t\t\tconst result = await toggleCategoryFeaturedUseCase.execute(\r\n\t\t\t\t\tid,\r\n\t\t\t\t\tfeatured\r\n\t\t\t\t);\r\n\r\n\t\t\t\tif (result) {\r\n\t\t\t\t\t// Actualizar en las listas actuales\r\n\t\t\t\t\tconst updateCategory = (cat: Category) =>\r\n\t\t\t\t\t\tcat.id === id ? {...cat, featured} : cat;\r\n\r\n\t\t\t\t\tsetCategories((prev) => prev.map(updateCategory));\r\n\t\t\t\t\tsetMainCategories((prev) => prev.map(updateCategory));\r\n\r\n\t\t\t\t\t// Actualizar detalle si coincide\r\n\t\t\t\t\tif (categoryDetail?.id === id) {\r\n\t\t\t\t\t\tsetCategoryDetail((prev) => (prev ? {...prev, featured} : prev));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Invalidar cache después de la mutación\r\n\t\t\t\t\tinvalidateAfterMutation([\r\n\t\t\t\t\t\t\"admin_categories_*\",\r\n\t\t\t\t\t\t\"categories_*\",\r\n\t\t\t\t\t\t`admin_category_${id}`,\r\n\t\t\t\t\t\t`category_${id}`,\r\n\t\t\t\t\t\t\"admin_main_categories_*\",\r\n\t\t\t\t\t\t\"categories_main_*\",\r\n\t\t\t\t\t\t\"categories_featured_*\",\r\n\t\t\t\t\t]);\r\n\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn false;\r\n\t\t\t} catch (err) {\r\n\t\t\t\tconst errorMessage =\r\n\t\t\t\t\terr instanceof Error\r\n\t\t\t\t\t\t? err.message\r\n\t\t\t\t\t\t: \"Error al cambiar estado destacado\";\r\n\t\t\t\tsetError(errorMessage);\r\n\t\t\t\tconsole.error(\"Error al cambiar estado destacado:\", err);\r\n\t\t\t\treturn false;\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[categoryDetail, invalidateAfterMutation]\r\n\t);\r\n\r\n\t/**\r\n\t * Limpia la caché de categorías de admin usando cache reactivo\r\n\t */\r\n\tconst clearCategoryCache = useCallback(\r\n\t\t(categoryId?: number) => {\r\n\t\t\tif (categoryId) {\r\n\t\t\t\t// Invalidar cache específica de una categoría\r\n\t\t\t\tinvalidateAfterMutation([\r\n\t\t\t\t\t`admin_category_${categoryId}`,\r\n\t\t\t\t\t`category_${categoryId}`,\r\n\t\t\t\t]);\r\n\t\t\t\tconsole.log(`🗑️ Caché de la categoría ${categoryId} invalidada`);\r\n\t\t\t} else {\r\n\t\t\t\t// Invalidar todos los patrones de categorías\r\n\t\t\t\tinvalidateAfterMutation([\r\n\t\t\t\t\t\"admin_categories_*\",\r\n\t\t\t\t\t\"categories_*\",\r\n\t\t\t\t\t\"admin_category_*\",\r\n\t\t\t\t\t\"category_*\",\r\n\t\t\t\t\t\"admin_main_categories_*\",\r\n\t\t\t\t\t\"categories_main_*\",\r\n\t\t\t\t\t\"categories_featured_*\",\r\n\t\t\t\t]);\r\n\t\t\t\tconsole.log(\"🗑️ Toda la caché de categorías invalidada\");\r\n\t\t\t}\r\n\t\t},\r\n\t\t[invalidateAfterMutation]\r\n\t);\r\n\r\n\treturn {\r\n\t\t// Estado\r\n\t\tloading,\r\n\t\terror,\r\n\t\tcategories,\r\n\t\tmainCategories,\r\n\t\tcategoryDetail,\r\n\r\n\t\t// Métodos\r\n\t\tfetchAllCategories,\r\n\t\tfetchMainCategories,\r\n\t\tfetchCategoryById,\r\n\t\tcreateCategory,\r\n\t\tupdateCategory,\r\n\t\tdeleteCategory,\r\n\t\ttoggleActive,\r\n\t\ttoggleFeatured,\r\n\t\tclearCategoryCache,\r\n\r\n\t\t// Utilidades\r\n\t\tsetError: (error: string | null) => setError(error),\r\n\t\tsetLoading: (loading: boolean) => setLoading(loading),\r\n\t};\r\n};\r\n\r\nexport default useAdminCategories;\r\n","import React, {useState, useEffect, useCallback} from \"react\";\r\nimport Table from \"../../components/dashboard/Table\";\r\nimport {\r\n\tTag,\r\n\tEye,\r\n\tEdit,\r\n\tTrash2,\r\n\tStar,\r\n\tFilter,\r\n\tRefreshCw,\r\n\tArchive,\r\n\tClock,\r\n\tCheckCircle,\r\n\tPlus,\r\n\tSearch,\r\n} from \"lucide-react\";\r\nimport {Link, useLocation} from \"react-router-dom\";\r\nimport type {Product} from \"../../../core/domain/entities/Product\";\r\nimport type {ExtendedProductFilterParams} from \"../../types/ProductFilterParams\";\r\n\r\n// Hooks personalizados\r\nimport {useAdminProducts} from \"../../hooks/useAdminProducts\";\r\nimport {useAdminCategories} from \"../../hooks/useAdminCategories\";\r\n\r\n// Utilities corregidas - USAR SOLO UNA FUENTE\r\nimport {getProductMainImage} from \"../../../utils/imageManager\";\r\nimport {formatCurrency} from \"../../../utils/formatters/formatCurrency\";\r\n\r\nconst AdminProductsPage: React.FC = () => {\r\n\tconst location = useLocation();\r\n\t\r\n\t// Extraer sellerId de la URL si está presente\r\n\tconst urlParams = new URLSearchParams(location.search);\r\n\tconst sellerIdFromUrl = urlParams.get('sellerId');\r\n\t\r\n\t// Hooks de administración\r\n\tconst {\r\n\t\tloading: productsLoading,\r\n\t\terror: productsError,\r\n\t\tproducts,\r\n\t\tmeta,\r\n\t\tfetchAllProducts,\r\n\t\tdeleteProduct,\r\n\t\ttoggleFeatured,\r\n\t\ttogglePublished,\r\n\t\tclearProductCache,\r\n\t} = useAdminProducts();\r\n\r\n\tconst {\r\n\t\tloading: categoriesLoading,\r\n\t\tcategories,\r\n\t\tfetchAllCategories,\r\n\t} = useAdminCategories();\r\n\r\n\t// Estado local para filtros y paginación\r\n\tconst [categoryFilter, setCategoryFilter] = useState<number>(0); // 0 = Todas\r\n\tconst [sellerFilter, setSellerFilter] = useState<number>(sellerIdFromUrl ? parseInt(sellerIdFromUrl) : 0); // 0 = Todos los vendedores\r\n\tconst [statusFilter, setStatusFilter] = useState<string>(\"all\");\r\n\tconst [stockFilter, setStockFilter] = useState<string>(\"all\");\r\n\tconst [searchTerm, setSearchTerm] = useState<string>(\"\");\r\n\tconst [currentPage, setCurrentPage] = useState<number>(1);\r\n\tconst [itemsPerPage] = useState<number>(15);\r\n\r\n\t// Estado para mostrar confirmaciones\r\n\tconst [loadingAction, setLoadingAction] = useState<number | null>(null);\r\n\r\n\t// Cargar datos iniciales\r\n\tuseEffect(() => {\r\n\t\tloadData();\r\n\t\tloadCategories();\r\n\t}, []);\r\n\r\n\t// Cargar datos cuando cambien los filtros\r\n\tuseEffect(() => {\r\n\t\tloadData();\r\n\t}, [categoryFilter, sellerFilter, statusFilter, stockFilter, searchTerm, currentPage]);\r\n\r\n\t// Actualizar sellerFilter cuando cambie la URL\r\n\tuseEffect(() => {\r\n\t\tconst urlParams = new URLSearchParams(location.search);\r\n\t\tconst newSellerId = urlParams.get('sellerId');\r\n\t\tconst newSellerIdInt = newSellerId ? parseInt(newSellerId) : 0;\r\n\t\t\r\n\t\tif (newSellerIdInt !== sellerFilter) {\r\n\t\t\tsetSellerFilter(newSellerIdInt);\r\n\t\t\tsetCurrentPage(1); // Reset to first page when filter changes\r\n\t\t}\r\n\t}, [location.search, sellerFilter]);\r\n\r\n\t/**\r\n\t * Carga las categorías\r\n\t */\r\n\tconst loadCategories = useCallback(async () => {\r\n\t\ttry {\r\n\t\t\tawait fetchAllCategories({with_counts: true});\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al cargar categorías:\", error);\r\n\t\t}\r\n\t}, [fetchAllCategories]);\r\n\r\n\t/**\r\n\t * Carga los productos con filtros aplicados\r\n\t */\r\n\tconst loadData = useCallback(async () => {\r\n\t\tconsole.log(\"🚀 AdminProductsPage: Iniciando loadData...\");\r\n\t\tconsole.log(\"📍 AdminProductsPage: Página actual:\", currentPage);\r\n\t\tconsole.log(\"📍 AdminProductsPage: Items por página:\", itemsPerPage);\r\n\t\ttry {\r\n\t\t\tconst filterParams: ExtendedProductFilterParams = {\r\n\t\t\t\tlimit: itemsPerPage,\r\n\t\t\t\toffset: (currentPage - 1) * itemsPerPage,\r\n\t\t\t\t// NO incluir filtros por defecto - admin debe ver TODOS los productos\r\n\t\t\t};\r\n\t\t\tconsole.log(\"🔧 AdminProductsPage: FilterParams inicial:\", filterParams);\r\n\r\n\t\t\t// Aplicar filtros\r\n\t\t\tif (searchTerm) {\r\n\t\t\t\tfilterParams.term = searchTerm;\r\n\t\t\t}\r\n\r\n\t\t\tif (categoryFilter && categoryFilter > 0) {\r\n\t\t\t\tfilterParams.categoryId = categoryFilter;\r\n\t\t\t}\r\n\r\n\t\t\tif (sellerFilter && sellerFilter > 0) {\r\n\t\t\t\tfilterParams.sellerId = sellerFilter;\r\n\t\t\t}\r\n\r\n\t\t\t// Filtros de estado - SOLO si se especifica explícitamente\r\n\t\t\tswitch (statusFilter) {\r\n\t\t\t\tcase \"active\":\r\n\t\t\t\t\tfilterParams.status = \"active\";\r\n\t\t\t\t\tfilterParams.published = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"draft\":\r\n\t\t\t\t\tfilterParams.status = \"draft\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"inactive\":\r\n\t\t\t\t\tfilterParams.published = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t// \"all\" NO añade filtros - admin ve todo\r\n\t\t\t}\r\n\r\n\t\t\t// Filtros de stock\r\n\t\t\tswitch (stockFilter) {\r\n\t\t\t\tcase \"inStock\":\r\n\t\t\t\t\tfilterParams.inStock = true;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"lowStock\":\r\n\t\t\t\t\tfilterParams.inStock = true;\r\n\t\t\t\t\t// Este filtro se podría implementar en el backend\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase \"outOfStock\":\r\n\t\t\t\t\tfilterParams.inStock = false;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t// \"all\" no añade filtros\r\n\t\t\t}\r\n\r\n\t\t\tconsole.log(\r\n\t\t\t\t\"🔧 AdminProductsPage: Cargando productos con filtros:\",\r\n\t\t\t\tfilterParams\r\n\t\t\t);\r\n\t\t\tawait fetchAllProducts(filterParams);\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al cargar productos:\", error);\r\n\t\t}\r\n\t}, [\r\n\t\tfetchAllProducts,\r\n\t\tcategoryFilter,\r\n\t\tsellerFilter,\r\n\t\tstatusFilter,\r\n\t\tstockFilter,\r\n\t\tsearchTerm,\r\n\t\tcurrentPage,\r\n\t\titemsPerPage,\r\n\t]);\r\n\r\n\t/**\r\n\t * Maneja la eliminación de un producto\r\n\t */\r\n\tconst handleDeleteProduct = useCallback(\r\n\t\tasync (productId: number, productName: string) => {\r\n\t\t\tconst confirmed = window.confirm(\r\n\t\t\t\t`¿Estás seguro de que deseas eliminar el producto \"${productName}\"?`\r\n\t\t\t);\r\n\r\n\t\t\tif (confirmed) {\r\n\t\t\t\tsetLoadingAction(productId);\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst success = await deleteProduct(productId);\r\n\t\t\t\t\tif (success) {\r\n\t\t\t\t\t\t// Recargar datos para reflejar cambios\r\n\t\t\t\t\t\tloadData();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\talert(\"Error al eliminar el producto\");\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error(\"Error al eliminar producto:\", error);\r\n\t\t\t\t\talert(\"Error al eliminar el producto\");\r\n\t\t\t\t} finally {\r\n\t\t\t\t\tsetLoadingAction(null);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t[deleteProduct, loadData]\r\n\t);\r\n\r\n\t/**\r\n\t * Maneja el cambio de estado destacado\r\n\t */\r\n\tconst handleToggleFeatured = useCallback(\r\n\t\tasync (productId: number, currentFeatured: boolean) => {\r\n\t\t\tsetLoadingAction(productId);\r\n\t\t\ttry {\r\n\t\t\t\t// PASAR EL VALOR OPUESTO PARA HACER EL TOGGLE\r\n\t\t\t\tconst newFeaturedValue = !currentFeatured;\r\n\t\t\t\tconsole.log(\r\n\t\t\t\t\t`🌟 Toggling featured for product ${productId}: ${currentFeatured} -> ${newFeaturedValue}`\r\n\t\t\t\t);\r\n\r\n\t\t\t\tconst success = await toggleFeatured(productId, newFeaturedValue);\r\n\t\t\t\tif (!success) {\r\n\t\t\t\t\talert(\"Error al cambiar estado destacado\");\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error(\"Error al cambiar estado destacado:\", error);\r\n\t\t\t\talert(\"Error al cambiar estado destacado\");\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoadingAction(null);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[toggleFeatured]\r\n\t);\r\n\r\n\t/**\r\n\t * Maneja el cambio de estado de publicación\r\n\t */\r\n\tconst handleTogglePublished = useCallback(\r\n\t\tasync (productId: number, currentPublished: boolean) => {\r\n\t\t\tsetLoadingAction(productId);\r\n\t\t\ttry {\r\n\t\t\t\t// PASAR EL VALOR OPUESTO PARA HACER EL TOGGLE\r\n\t\t\t\tconst newPublishedValue = !currentPublished;\r\n\t\t\t\tconsole.log(\r\n\t\t\t\t\t`📢 Toggling published for product ${productId}: ${currentPublished} -> ${newPublishedValue}`\r\n\t\t\t\t);\r\n\r\n\t\t\t\tconst success = await togglePublished(productId, newPublishedValue);\r\n\t\t\t\tif (!success) {\r\n\t\t\t\t\talert(\"Error al cambiar estado de publicación\");\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error(\"Error al cambiar estado de publicación:\", error);\r\n\t\t\t\talert(\"Error al cambiar estado de publicación\");\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoadingAction(null);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[togglePublished]\r\n\t);\r\n\r\n\t/**\r\n\t * Refrescar datos\r\n\t */\r\n\tconst refreshData = useCallback(() => {\r\n\t\tclearProductCache();\r\n\t\tloadData();\r\n\t}, [clearProductCache, loadData]);\r\n\r\n\t/**\r\n\t * Manejar cambio de página\r\n\t */\r\n\tconst handlePageChange = useCallback((page: number) => {\r\n\t\tsetCurrentPage(page);\r\n\t}, []);\r\n\r\n\t/**\r\n\t * Obtener el nombre de la categoría por ID\r\n\t */\r\n\tconst getCategoryName = (categoryId?: number): string => {\r\n\t\tif (!categoryId) return \"Sin categoría\";\r\n\t\tconst category = categories.find((c) => c.id === categoryId);\r\n\t\treturn category ? category.name : \"Categoría desconocida\";\r\n\t};\r\n\r\n\t/**\r\n\t * Componente de imagen mejorado con manejo de errores\r\n\t */\r\n\tconst ProductImage: React.FC<{product: Product}> = ({product}) => {\r\n\t\tconst [imageSrc, setImageSrc] = useState<string>(\r\n\t\t\tgetProductMainImage(product)\r\n\t\t);\r\n\t\tconst [hasError, setHasError] = useState<boolean>(false);\r\n\t\tconst [errorCount, setErrorCount] = useState<number>(0);\r\n\r\n\t\tuseEffect(() => {\r\n\t\t\tsetImageSrc(getProductMainImage(product));\r\n\t\t\tsetHasError(false);\r\n\t\t\tsetErrorCount(0);\r\n\t\t}, [product]);\r\n\r\n\t\tconst handleImageError = useCallback(() => {\r\n\t\t\tconsole.warn(\r\n\t\t\t\t`Error cargando imagen para producto ${product.id}:`,\r\n\t\t\t\timageSrc\r\n\t\t\t);\r\n\r\n\t\t\t// Evitar loops infinitos de error\r\n\t\t\tif (errorCount >= 2) {\r\n\t\t\t\tconsole.warn(\r\n\t\t\t\t\t`Demasiados errores para producto ${product.id}, manteniendo placeholder`\r\n\t\t\t\t);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tsetErrorCount((prev) => prev + 1);\r\n\r\n\t\t\tif (!hasError) {\r\n\t\t\t\tsetHasError(true);\r\n\t\t\t\t// Intentar con placeholder pequeño\r\n\t\t\t\tsetImageSrc(getProductMainImage(null));\r\n\t\t\t}\r\n\t\t}, [imageSrc, hasError, errorCount, product.id]);\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"flex-shrink-0 h-10 w-10 rounded-md bg-gray-200 flex items-center justify-center overflow-hidden\">\r\n\t\t\t\t<img\r\n\t\t\t\t\tsrc={imageSrc}\r\n\t\t\t\t\talt={product.name}\r\n\t\t\t\t\tclassName=\"h-10 w-10 object-cover\"\r\n\t\t\t\t\tonError={handleImageError}\r\n\t\t\t\t\tloading=\"lazy\"\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t);\r\n\t};\r\n\r\n\t// Filtrar productos localmente para manejar filtros adicionales\r\n\tconst filteredProducts = products.filter((product) => {\r\n\t\t// Filtro de stock bajo (ya que no se implementó en backend)\r\n\t\tif (stockFilter === \"lowStock\") {\r\n\t\t\treturn product.stock > 0 && product.stock <= 10;\r\n\t\t}\r\n\t\treturn true;\r\n\t});\r\n\r\n\t// Definir columnas de la tabla\r\n\tconst columns = [\r\n\t\t{\r\n\t\t\tkey: \"product\",\r\n\t\t\theader: \"Producto\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (product: Product) => (\r\n\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t<ProductImage product={product} />\r\n\t\t\t\t\t<div className=\"ml-4\">\r\n\t\t\t\t\t\t<div className=\"text-sm font-medium text-gray-900 flex items-center\">\r\n\t\t\t\t\t\t\t{product.name}\r\n\t\t\t\t\t\t\t{product.featured && (\r\n\t\t\t\t\t\t\t\t<span className=\"ml-2\">\r\n\t\t\t\t\t\t\t\t\t<Star className=\"h-4 w-4 text-yellow-500 inline\" />\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"text-xs text-gray-500\">\r\n\t\t\t\t\t\t\tID: {product.id}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"category\",\r\n\t\t\theader: \"Categoría\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (product: Product) => (\r\n\t\t\t\t<span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800\">\r\n\t\t\t\t\t<Tag className=\"w-3 h-3 mr-1\" />\r\n\t\t\t\t\t{getCategoryName(product.categoryId)}\r\n\t\t\t\t</span>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"seller\",\r\n\t\t\theader: \"Vendedor\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (product: Product) => {\r\n\t\t\t\t// Con la nueva API, los datos de seller y user vienen completos\r\n\t\t\t\tconst storeName = product.seller?.name || 'Tienda desconocida';\r\n\t\t\t\tconst userName = product.user?.name || 'Usuario desconocido';\r\n\t\t\t\tconst sellerId = product.seller_id || product.seller?.id;\r\n\t\t\t\t\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div className=\"text-sm\">\r\n\t\t\t\t\t\t<div className=\"font-medium text-gray-900\">\r\n\t\t\t\t\t\t\t{storeName}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"text-xs text-gray-500\">\r\n\t\t\t\t\t\t\tVendedor ID: {sellerId || 'N/A'} - {userName}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"price\",\r\n\t\t\theader: \"Precio\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (product: Product) => (\r\n\t\t\t\t<div>\r\n\t\t\t\t\t{product.discountPercentage && product.discountPercentage > 0 ? (\r\n\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t<span className=\"text-gray-500 line-through text-xs mr-1\">\r\n\t\t\t\t\t\t\t\t{formatCurrency(product.price)}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t<span className=\"font-semibold text-green-600\">\r\n\t\t\t\t\t\t\t\t{formatCurrency(\r\n\t\t\t\t\t\t\t\t\tproduct.finalPrice ||\r\n\t\t\t\t\t\t\t\t\t\tproduct.price * (1 - product.discountPercentage / 100)\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t<span className=\"ml-1 bg-green-100 text-green-800 text-xs font-semibold px-1.5 py-0.5 rounded\">\r\n\t\t\t\t\t\t\t\t-{product.discountPercentage}%\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<span className=\"font-semibold\">\r\n\t\t\t\t\t\t\t{formatCurrency(product.price)}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"stock\",\r\n\t\t\theader: \"Stock\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (product: Product) => (\r\n\t\t\t\t<div>\r\n\t\t\t\t\t{product.stock === 0 ? (\r\n\t\t\t\t\t\t<span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800\">\r\n\t\t\t\t\t\t\tAgotado\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t) : product.stock <= 10 ? (\r\n\t\t\t\t\t\t<span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800\">\r\n\t\t\t\t\t\t\t{product.stock} unidades\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800\">\r\n\t\t\t\t\t\t\t{product.stock} unidades\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"status\",\r\n\t\t\theader: \"Estado\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (product: Product) => {\r\n\t\t\t\tlet statusColor = \"\";\r\n\t\t\t\tlet statusText = \"\";\r\n\t\t\t\tlet StatusIcon = CheckCircle;\r\n\r\n\t\t\t\tif (!product.published) {\r\n\t\t\t\t\tstatusColor = \"bg-yellow-100 text-yellow-800\";\r\n\t\t\t\t\tstatusText = \"No publicado\";\r\n\t\t\t\t\tStatusIcon = Clock;\r\n\t\t\t\t} else if (product.status === \"draft\") {\r\n\t\t\t\t\tstatusColor = \"bg-gray-100 text-gray-800\";\r\n\t\t\t\t\tstatusText = \"Borrador\";\r\n\t\t\t\t\tStatusIcon = Archive;\r\n\t\t\t\t} else if (product.status === \"active\") {\r\n\t\t\t\t\tstatusColor = \"bg-green-100 text-green-800\";\r\n\t\t\t\t\tstatusText = \"Activo\";\r\n\t\t\t\t\tStatusIcon = CheckCircle;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tstatusColor = \"bg-red-100 text-red-800\";\r\n\t\t\t\t\tstatusText = \"Inactivo\";\r\n\t\t\t\t\tStatusIcon = Archive;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<span\r\n\t\t\t\t\t\tclassName={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${statusColor}`}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<StatusIcon className=\"w-3 h-3 mr-1\" />\r\n\t\t\t\t\t\t{statusText}\r\n\t\t\t\t\t</span>\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"rating\",\r\n\t\t\theader: \"Valoración\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (product: Product) => {\r\n\t\t\t\t// Con la nueva API, usar los ratings calculados directamente\r\n\t\t\t\tconst displayRating = (product as any).calculated_rating ?? product.rating ?? 0;\r\n\t\t\t\tconst displayCount = (product as any).calculated_rating_count ?? product.ratingCount ?? (product as any).rating_count ?? 0;\r\n\t\t\t\t\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t{displayRating > 0 ? (\r\n\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t<Star className=\"h-4 w-4 text-yellow-500 mr-1\" />\r\n\t\t\t\t\t\t\t\t<span>{parseFloat(displayRating).toFixed(1)}</span>\r\n\t\t\t\t\t\t\t\t<span className=\"text-xs text-gray-500 ml-1\">\r\n\t\t\t\t\t\t\t\t\t({displayCount})\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<span className=\"text-xs text-gray-500\">Sin valoraciones</span>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"sales\",\r\n\t\t\theader: \"Ventas\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (product: Product) => {\r\n\t\t\t\t// Con la nueva API, los datos de ventas vienen calculados\r\n\t\t\t\tconst salesCount = (product as any).sales_count ?? 0;\r\n\t\t\t\tconst totalQuantity = (product as any).total_quantity_sold ?? 0;\r\n\t\t\t\t\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div className=\"text-sm\">\r\n\t\t\t\t\t\t<div className=\"font-medium\">{salesCount} órdenes</div>\r\n\t\t\t\t\t\t<div className=\"text-xs text-gray-500\">{totalQuantity} uds.</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"actions\",\r\n\t\t\theader: \"Acciones\",\r\n\t\t\trender: (product: Product) => (\r\n\t\t\t\t<div className=\"flex justify-end space-x-1\">\r\n\t\t\t\t\t{/* Botón para ver producto en la tienda - USAR ID EN LUGAR DE SLUG */}\r\n\t\t\t\t\t<Link\r\n\t\t\t\t\t\tto={`/products/${product.id}`}\r\n\t\t\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\t\t\tclassName=\"p-1 text-blue-600 hover:bg-blue-100 rounded-md\"\r\n\t\t\t\t\t\ttitle=\"Ver en tienda\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Eye size={16} />\r\n\t\t\t\t\t</Link>\r\n\r\n\t\t\t\t\t{/* Botón para editar producto - USAR ID NO SLUG */}\r\n\t\t\t\t\t<Link\r\n\t\t\t\t\t\tto={`/admin/products/edit/${product.id}`}\r\n\t\t\t\t\t\tclassName=\"p-1 text-yellow-600 hover:bg-yellow-100 rounded-md\"\r\n\t\t\t\t\t\ttitle=\"Editar producto\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Edit size={16} />\r\n\t\t\t\t\t</Link>\r\n\r\n\t\t\t\t\t{/* Botón para destacar/quitar destacado */}\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\thandleToggleFeatured(product.id!, product.featured || false)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdisabled={loadingAction === product.id}\r\n\t\t\t\t\t\tclassName={`p-1 rounded-md transition-colors ${\r\n\t\t\t\t\t\t\tproduct.featured\r\n\t\t\t\t\t\t\t\t? \"text-yellow-500 hover:bg-yellow-100\"\r\n\t\t\t\t\t\t\t\t: \"text-gray-600 hover:bg-gray-100\"\r\n\t\t\t\t\t\t} ${loadingAction === product.id ? \"opacity-50 cursor-not-allowed\" : \"\"}`}\r\n\t\t\t\t\t\ttitle={product.featured ? \"Quitar destacado\" : \"Destacar producto\"}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Star\r\n\t\t\t\t\t\t\tsize={16}\r\n\t\t\t\t\t\t\tclassName={product.featured ? \"fill-current\" : \"\"}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t{/* Botón para publicar/despublicar */}\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\thandleTogglePublished(product.id!, product.published || false)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdisabled={loadingAction === product.id}\r\n\t\t\t\t\t\tclassName={`p-1 rounded-md transition-colors ${\r\n\t\t\t\t\t\t\tproduct.published\r\n\t\t\t\t\t\t\t\t? \"text-green-600 hover:bg-green-100\"\r\n\t\t\t\t\t\t\t\t: \"text-gray-600 hover:bg-gray-100\"\r\n\t\t\t\t\t\t} ${loadingAction === product.id ? \"opacity-50 cursor-not-allowed\" : \"\"}`}\r\n\t\t\t\t\t\ttitle={product.published ? \"Despublicar\" : \"Publicar\"}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<CheckCircle size={16} />\r\n\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t{/* Botón para eliminar */}\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={() => handleDeleteProduct(product.id!, product.name)}\r\n\t\t\t\t\t\tdisabled={loadingAction === product.id}\r\n\t\t\t\t\t\tclassName={`p-1 text-red-600 hover:bg-red-100 rounded-md transition-colors ${\r\n\t\t\t\t\t\t\tloadingAction === product.id\r\n\t\t\t\t\t\t\t\t? \"opacity-50 cursor-not-allowed\"\r\n\t\t\t\t\t\t\t\t: \"\"\r\n\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\ttitle=\"Eliminar producto\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Trash2 size={16} />\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t];\r\n\r\n\tconst loading = productsLoading || categoriesLoading;\r\n\r\n\treturn (\r\n\t\t<div className=\"space-y-6\">\r\n\t\t\t{/* Header */}\r\n\t\t\t<div className=\"flex justify-between items-center\">\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<h1 className=\"text-2xl font-bold text-gray-900\">\r\n\t\t\t\t\t\tGestión de Productos\r\n\t\t\t\t\t\t{sellerFilter > 0 && (\r\n\t\t\t\t\t\t\t<span className=\"ml-2 text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded-md\">\r\n\t\t\t\t\t\t\t\tVendedor ID: {sellerFilter}\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</h1>\r\n\t\t\t\t\t{meta && (\r\n\t\t\t\t\t\t<p className=\"text-sm text-gray-600 mt-1\">\r\n\t\t\t\t\t\t\t{meta.total} productos encontrados\r\n\t\t\t\t\t\t\t{sellerFilter > 0 && \" para este vendedor\"}\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"flex space-x-2\">\r\n\t\t\t\t\t<Link\r\n\t\t\t\t\t\tto=\"/admin/products/create\"\r\n\t\t\t\t\t\tclassName=\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Plus className=\"w-4 h-4 mr-2\" />\r\n\t\t\t\t\t\tNuevo Producto\r\n\t\t\t\t\t</Link>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={refreshData}\r\n\t\t\t\t\t\tdisabled={loading}\r\n\t\t\t\t\t\tclassName=\"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors flex items-center disabled:opacity-50\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<RefreshCw\r\n\t\t\t\t\t\t\tsize={16}\r\n\t\t\t\t\t\t\tclassName={`mr-2 ${loading ? \"animate-spin\" : \"\"}`}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\tActualizar\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Mostrar errores */}\r\n\t\t\t{productsError && (\r\n\t\t\t\t<div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded\">\r\n\t\t\t\t\tError: {productsError}\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{/* Filtros */}\r\n\t\t\t<div className=\"bg-white rounded-lg shadow-sm p-4\">\r\n\t\t\t\t<div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n\t\t\t\t\t{/* Búsqueda */}\r\n\t\t\t\t\t<div className=\"flex items-center space-x-2\">\r\n\t\t\t\t\t\t<Search className=\"h-5 w-5 text-gray-500\" />\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\tplaceholder=\"Buscar productos...\"\r\n\t\t\t\t\t\t\tvalue={searchTerm}\r\n\t\t\t\t\t\t\tonChange={(e) => setSearchTerm(e.target.value)}\r\n\t\t\t\t\t\t\tclassName=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 flex-1\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Filtro de Categoría */}\r\n\t\t\t\t\t<div className=\"flex items-center space-x-2\">\r\n\t\t\t\t\t\t<Filter className=\"h-5 w-5 text-gray-500\" />\r\n\t\t\t\t\t\t<select\r\n\t\t\t\t\t\t\tclassName=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 flex-1\"\r\n\t\t\t\t\t\t\tvalue={categoryFilter}\r\n\t\t\t\t\t\t\tonChange={(e) => setCategoryFilter(Number(e.target.value))}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<option value={0}>Todas las categorías</option>\r\n\t\t\t\t\t\t\t{categories.map((category) => (\r\n\t\t\t\t\t\t\t\t<option key={category.id} value={category.id}>\r\n\t\t\t\t\t\t\t\t\t{category.name} ({category.product_count || 0})\r\n\t\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Filtro de Estado */}\r\n\t\t\t\t\t<div className=\"flex items-center space-x-2\">\r\n\t\t\t\t\t\t<select\r\n\t\t\t\t\t\t\tclassName=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 flex-1\"\r\n\t\t\t\t\t\t\tvalue={statusFilter}\r\n\t\t\t\t\t\t\tonChange={(e) => setStatusFilter(e.target.value)}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<option value=\"all\">Todos los Estados</option>\r\n\t\t\t\t\t\t\t<option value=\"active\">Activos</option>\r\n\t\t\t\t\t\t\t<option value=\"draft\">Borrador</option>\r\n\t\t\t\t\t\t\t<option value=\"inactive\">Inactivos</option>\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Filtro de Stock */}\r\n\t\t\t\t\t<div className=\"flex items-center space-x-2\">\r\n\t\t\t\t\t\t<select\r\n\t\t\t\t\t\t\tclassName=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 flex-1\"\r\n\t\t\t\t\t\t\tvalue={stockFilter}\r\n\t\t\t\t\t\t\tonChange={(e) => setStockFilter(e.target.value)}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<option value=\"all\">Todo el Stock</option>\r\n\t\t\t\t\t\t\t<option value=\"inStock\">En stock</option>\r\n\t\t\t\t\t\t\t<option value=\"lowStock\">Stock bajo (≤10)</option>\r\n\t\t\t\t\t\t\t<option value=\"outOfStock\">Sin stock</option>\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Tabla de Productos */}\r\n\t\t\t<Table\r\n\t\t\t\tdata={filteredProducts}\r\n\t\t\t\tcolumns={columns}\r\n\t\t\t\tsearchFields={[]} // Búsqueda se maneja externamente\r\n\t\t\t\tloading={loading}\r\n\t\t\t\temptyMessage=\"No se encontraron productos\"\r\n\t\t\t\tpagination={{\r\n\t\t\t\t\tcurrentPage: currentPage,\r\n\t\t\t\t\ttotalPages: Math.ceil((meta?.total || 0) / itemsPerPage),\r\n\t\t\t\t\ttotalItems: meta?.total || 0,\r\n\t\t\t\t\titemsPerPage: itemsPerPage,\r\n\t\t\t\t\tonPageChange: handlePageChange,\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default AdminProductsPage;\r\n","import React, {useState, useEffect, useCallback} from \"react\";\r\nimport Table from \"../../components/dashboard/Table\";\r\nimport {\r\n\tFolder,\r\n\tFolderPlus,\r\n\tEdit,\r\n\tTrash2,\r\n\tStar,\r\n\tFilter,\r\n\tRefreshCw,\r\n\tEyeOff,\r\n\tEye,\r\n\tArrowUpRight,\r\n\tFolderTree,\r\n\tPlus,\r\n\tSearch,\r\n} from \"lucide-react\";\r\nimport {Link} from \"react-router-dom\";\r\nimport type {Category} from \"../../../core/domain/entities/Category\";\r\n\r\n// Hook personalizado\r\nimport {useAdminCategories} from \"../../hooks/useAdminCategories\";\r\n\r\nconst AdminCategoriesPage: React.FC = () => {\r\n\t// Hook de administración de categorías\r\n\tconst {\r\n\t\tloading,\r\n\t\terror,\r\n\t\tcategories,\r\n\t\tmainCategories,\r\n\t\tfetchAllCategories,\r\n\t\tfetchMainCategories,\r\n\t\tdeleteCategory,\r\n\t\ttoggleActive,\r\n\t\ttoggleFeatured,\r\n\t\tclearCategoryCache,\r\n\t} = useAdminCategories();\r\n\r\n\t// Estado local para filtros y paginación\r\n\tconst [parentFilter, setParentFilter] = useState<number | null>(null); // null = Todas\r\n\tconst [statusFilter, setStatusFilter] = useState<string>(\"all\");\r\n\tconst [searchTerm, setSearchTerm] = useState<string>(\"\");\r\n\tconst [viewMode, setViewMode] = useState<\"all\" | \"tree\">(\"all\");\r\n\tconst [currentPage, setCurrentPage] = useState<number>(1);\r\n\tconst [itemsPerPage] = useState<number>(15);\r\n\r\n\t// Estado para mostrar confirmaciones\r\n\tconst [loadingAction, setLoadingAction] = useState<number | null>(null);\r\n\r\n\t// Cargar datos iniciales\r\n\tuseEffect(() => {\r\n\t\tloadData();\r\n\t}, []);\r\n\r\n\t// Recargar datos cuando cambien los filtros\r\n\tuseEffect(() => {\r\n\t\tloadData();\r\n\t}, [parentFilter, statusFilter, searchTerm]);\r\n\r\n\t/**\r\n\t * Carga las categorías\r\n\t */\r\n\tconst loadData = useCallback(async () => {\r\n\t\ttry {\r\n\t\t\t// Preparar filtros\r\n\t\t\tconst filters: any = {};\r\n\r\n\t\t\tif (parentFilter !== null) {\r\n\t\t\t\tfilters.parent_id = parentFilter;\r\n\t\t\t}\r\n\r\n\t\t\tif (statusFilter !== \"all\") {\r\n\t\t\t\tfilters.is_active = statusFilter === \"active\";\r\n\t\t\t}\r\n\r\n\t\t\tif (searchTerm) {\r\n\t\t\t\tfilters.term = searchTerm;\r\n\t\t\t}\r\n\r\n\t\t\t// Cargar datos\r\n\t\t\tawait fetchAllCategories(filters);\r\n\r\n\t\t\t// También cargar categorías principales para el filtro\r\n\t\t\tif (mainCategories.length === 0) {\r\n\t\t\t\tawait fetchMainCategories(true);\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al cargar categorías:\", error);\r\n\t\t}\r\n\t}, [\r\n\t\tfetchAllCategories,\r\n\t\tfetchMainCategories,\r\n\t\tparentFilter,\r\n\t\tstatusFilter,\r\n\t\tsearchTerm,\r\n\t\tmainCategories.length,\r\n\t]);\r\n\r\n\t/**\r\n\t * Filtrar categorías localmente (para funcionalidad adicional)\r\n\t */\r\n\tconst filteredCategories = categories.filter((category) => {\r\n\t\t// Filtro de búsqueda local adicional si es necesario\r\n\t\tif (\r\n\t\t\tsearchTerm &&\r\n\t\t\t!category.name.toLowerCase().includes(searchTerm.toLowerCase())\r\n\t\t) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn true;\r\n\t});\r\n\r\n\t/**\r\n\t * Maneja el cambio de estado destacado\r\n\t */\r\n\tconst handleToggleFeatured = useCallback(\r\n\t\tasync (categoryId: number, currentFeatured: boolean) => {\r\n\t\t\tsetLoadingAction(categoryId);\r\n\t\t\ttry {\r\n\t\t\t\tconst success = await toggleFeatured(categoryId, !currentFeatured);\r\n\t\t\t\tif (success) {\r\n\t\t\t\t\t// Recargar datos para reflejar cambios\r\n\t\t\t\t\tawait loadData();\r\n\t\t\t\t} else {\r\n\t\t\t\t\talert(\"Error al cambiar estado destacado de la categoría\");\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error(\"Error al cambiar estado destacado:\", error);\r\n\t\t\t\talert(\"Error al cambiar estado destacado de la categoría\");\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoadingAction(null);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[toggleFeatured, loadData]\r\n\t);\r\n\r\n\t/**\r\n\t * Maneja el cambio de estado activo\r\n\t */\r\n\tconst handleToggleActive = useCallback(\r\n\t\tasync (categoryId: number, currentActive: boolean) => {\r\n\t\t\tsetLoadingAction(categoryId);\r\n\t\t\ttry {\r\n\t\t\t\tconst success = await toggleActive(categoryId, !currentActive);\r\n\t\t\t\tif (success) {\r\n\t\t\t\t\t// Recargar datos para reflejar cambios\r\n\t\t\t\t\tawait loadData();\r\n\t\t\t\t} else {\r\n\t\t\t\t\talert(\"Error al cambiar estado activo de la categoría\");\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error(\"Error al cambiar estado activo:\", error);\r\n\t\t\t\talert(\"Error al cambiar estado activo de la categoría\");\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoadingAction(null);\r\n\t\t\t}\r\n\t\t},\r\n\t\t[toggleActive, loadData]\r\n\t);\r\n\r\n\t/**\r\n\t * Maneja la eliminación de una categoría\r\n\t */\r\n\tconst handleDeleteCategory = useCallback(\r\n\t\tasync (categoryId: number, categoryName: string) => {\r\n\t\t\t// Verificar si hay categorías hijas\r\n\t\t\tconst hasChildren = categories.some(\r\n\t\t\t\t(cat) => cat.parent_id === categoryId\r\n\t\t\t);\r\n\r\n\t\t\tif (hasChildren) {\r\n\t\t\t\talert(\r\n\t\t\t\t\t\"Esta categoría tiene subcategorías. Debes eliminar primero las subcategorías.\"\r\n\t\t\t\t);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst confirmed = window.confirm(\r\n\t\t\t\t`¿Estás seguro de que deseas eliminar la categoría \"${categoryName}\"?`\r\n\t\t\t);\r\n\r\n\t\t\tif (confirmed) {\r\n\t\t\t\tsetLoadingAction(categoryId);\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst success = await deleteCategory(categoryId);\r\n\t\t\t\t\tif (success) {\r\n\t\t\t\t\t\t// Recargar datos\r\n\t\t\t\t\t\tloadData();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\talert(\"Error al eliminar la categoría\");\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (error) {\r\n\t\t\t\t\tconsole.error(\"Error al eliminar categoría:\", error);\r\n\t\t\t\t\talert(\"Error al eliminar la categoría\");\r\n\t\t\t\t} finally {\r\n\t\t\t\t\tsetLoadingAction(null);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\t[deleteCategory, categories, loadData]\r\n\t);\r\n\r\n\t/**\r\n\t * Refrescar datos\r\n\t */\r\n\tconst refreshData = useCallback(() => {\r\n\t\tclearCategoryCache();\r\n\t\tloadData();\r\n\t}, [clearCategoryCache, loadData]);\r\n\r\n\t/**\r\n\t * Manejar cambio de página\r\n\t */\r\n\tconst handlePageChange = useCallback((page: number) => {\r\n\t\tsetCurrentPage(page);\r\n\t}, []);\r\n\r\n\t/**\r\n\t * Obtener el nombre de la categoría padre\r\n\t */\r\n\tconst getParentCategoryName = (parentId?: number): string => {\r\n\t\tif (!parentId) return \"Sin categoría padre\";\r\n\t\tconst parent =\r\n\t\t\tcategories.find((c) => c.id === parentId) ||\r\n\t\t\tmainCategories.find((c) => c.id === parentId);\r\n\t\treturn parent ? parent.name : \"Categoría padre desconocida\";\r\n\t};\r\n\r\n\t// Definir columnas de la tabla\r\n\tconst columns = [\r\n\t\t{\r\n\t\t\tkey: \"category\",\r\n\t\t\theader: \"Categoría\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (category: Category) => (\r\n\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t{/* Icono de carpeta en lugar de imagen */}\r\n\t\t\t\t\t<div className=\"flex-shrink-0 h-10 w-10 rounded-md bg-blue-100 flex items-center justify-center\">\r\n\t\t\t\t\t\t<Folder className=\"h-6 w-6 text-blue-600\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"ml-4\">\r\n\t\t\t\t\t\t<div className=\"text-sm font-medium text-gray-900 flex items-center\">\r\n\t\t\t\t\t\t\t{category.name}\r\n\t\t\t\t\t\t\t{category.featured && (\r\n\t\t\t\t\t\t\t\t<span className=\"ml-2\">\r\n\t\t\t\t\t\t\t\t\t<Star className=\"h-4 w-4 text-yellow-500 inline\" />\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"text-xs text-gray-500 flex items-center\">\r\n\t\t\t\t\t\t\tID: {category.id}\r\n\t\t\t\t\t\t\t{category.parent_id && (\r\n\t\t\t\t\t\t\t\t<span className=\"ml-2\">\r\n\t\t\t\t\t\t\t\t\tPadre: {getParentCategoryName(category.parent_id)}\r\n\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"slug\",\r\n\t\t\theader: \"Slug\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (category: Category) => (\r\n\t\t\t\t<div className=\"text-sm text-gray-500 font-mono\">{category.slug}</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"description\",\r\n\t\t\theader: \"Descripción\",\r\n\t\t\trender: (category: Category) => (\r\n\t\t\t\t<div className=\"text-sm text-gray-600 max-w-xs truncate\">\r\n\t\t\t\t\t{category.description || \"Sin descripción\"}\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"products\",\r\n\t\t\theader: \"Productos\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (category: Category) => (\r\n\t\t\t\t<div className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-sm font-medium bg-blue-100 text-blue-800\">\r\n\t\t\t\t\t{category.product_count || 0}\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"status\",\r\n\t\t\theader: \"Estado\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (category: Category) => (\r\n\t\t\t\t<span\r\n\t\t\t\t\tclassName={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${\r\n\t\t\t\t\t\tcategory.is_active\r\n\t\t\t\t\t\t\t? \"bg-green-100 text-green-800\"\r\n\t\t\t\t\t\t\t: \"bg-red-100 text-red-800\"\r\n\t\t\t\t\t}`}\r\n\t\t\t\t>\r\n\t\t\t\t\t{category.is_active ? (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<Eye className=\"w-3 h-3 mr-1\" />\r\n\t\t\t\t\t\t\tActiva\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t<EyeOff className=\"w-3 h-3 mr-1\" />\r\n\t\t\t\t\t\t\tInactiva\r\n\t\t\t\t\t\t</>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</span>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"children\",\r\n\t\t\theader: \"Subcategorías\",\r\n\t\t\trender: (category: Category) => (\r\n\t\t\t\t<div>\r\n\t\t\t\t\t{(category as any).has_children ? (\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={() => setParentFilter(category.id || null)}\r\n\t\t\t\t\t\t\tclassName=\"text-primary-600 hover:text-primary-800 underline flex items-center\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<FolderTree className=\"h-4 w-4 mr-1\" />\r\n\t\t\t\t\t\t\tVer subcategorías\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t) : (\r\n\t\t\t\t\t\t<span className=\"text-gray-500 text-sm\">Sin subcategorías</span>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"order\",\r\n\t\t\theader: \"Orden\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (category: Category) => (\r\n\t\t\t\t<div className=\"text-center\">{category.order || \"-\"}</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"actions\",\r\n\t\t\theader: \"Acciones\",\r\n\t\t\trender: (category: Category) => (\r\n\t\t\t\t<div className=\"flex justify-end space-x-1\">\r\n\t\t\t\t\t{/* Botón para ver página de categoría */}\r\n\t\t\t\t\t<Link\r\n\t\t\t\t\t\tto={`/categories/${category.slug}`}\r\n\t\t\t\t\t\ttarget=\"_blank\"\r\n\t\t\t\t\t\tclassName=\"p-1 text-blue-600 hover:bg-blue-100 rounded-md\"\r\n\t\t\t\t\t\ttitle=\"Ver en tienda\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<ArrowUpRight size={16} />\r\n\t\t\t\t\t</Link>\r\n\r\n\t\t\t\t\t{/* Botón para editar categoría */}\r\n\t\t\t\t\t<Link\r\n\t\t\t\t\t\tto={`/admin/categories/edit/${category.id}`}\r\n\t\t\t\t\t\tclassName=\"p-1 text-yellow-600 hover:bg-yellow-100 rounded-md\"\r\n\t\t\t\t\t\ttitle=\"Editar categoría\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Edit size={16} />\r\n\t\t\t\t\t</Link>\r\n\r\n\t\t\t\t\t{/* Botón para destacar/quitar destacado */}\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\thandleToggleFeatured(category.id!, category.featured!)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdisabled={loadingAction === category.id}\r\n\t\t\t\t\t\tclassName={`p-1 rounded-md transition-colors ${\r\n\t\t\t\t\t\t\tcategory.featured\r\n\t\t\t\t\t\t\t\t? \"text-yellow-600 hover:bg-yellow-100\"\r\n\t\t\t\t\t\t\t\t: \"text-gray-600 hover:bg-gray-100\"\r\n\t\t\t\t\t\t} ${loadingAction === category.id ? \"opacity-50 cursor-not-allowed\" : \"\"}`}\r\n\t\t\t\t\t\ttitle={\r\n\t\t\t\t\t\t\tcategory.featured ? \"Quitar destacado\" : \"Destacar categoría\"\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Star size={16} />\r\n\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t{/* Botón para activar/desactivar */}\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={() =>\r\n\t\t\t\t\t\t\thandleToggleActive(category.id!, category.is_active!)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tdisabled={loadingAction === category.id}\r\n\t\t\t\t\t\tclassName={`p-1 rounded-md transition-colors ${\r\n\t\t\t\t\t\t\tcategory.is_active\r\n\t\t\t\t\t\t\t\t? \"text-green-600 hover:bg-green-100\"\r\n\t\t\t\t\t\t\t\t: \"text-red-600 hover:bg-red-100\"\r\n\t\t\t\t\t\t} ${loadingAction === category.id ? \"opacity-50 cursor-not-allowed\" : \"\"}`}\r\n\t\t\t\t\t\ttitle={category.is_active ? \"Desactivar\" : \"Activar\"}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{category.is_active ? <Eye size={16} /> : <EyeOff size={16} />}\r\n\t\t\t\t\t</button>\r\n\r\n\t\t\t\t\t{/* Botón para añadir subcategoría */}\r\n\t\t\t\t\t<Link\r\n\t\t\t\t\t\tto={`/admin/categories/create?parent=${category.id}`}\r\n\t\t\t\t\t\tclassName=\"p-1 text-green-600 hover:bg-green-100 rounded-md\"\r\n\t\t\t\t\t\ttitle=\"Añadir subcategoría\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Plus size={16} />\r\n\t\t\t\t\t</Link>\r\n\r\n\t\t\t\t\t{/* Botón para eliminar */}\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={() => handleDeleteCategory(category.id!, category.name)}\r\n\t\t\t\t\t\tdisabled={loadingAction === category.id}\r\n\t\t\t\t\t\tclassName={`p-1 text-red-600 hover:bg-red-100 rounded-md transition-colors ${\r\n\t\t\t\t\t\t\tloadingAction === category.id\r\n\t\t\t\t\t\t\t\t? \"opacity-50 cursor-not-allowed\"\r\n\t\t\t\t\t\t\t\t: \"\"\r\n\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\ttitle=\"Eliminar categoría\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Trash2 size={16} />\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t];\r\n\r\n\t// Calcular paginación\r\n\tconst totalPages = Math.ceil(filteredCategories.length / itemsPerPage);\r\n\tconst startIndex = (currentPage - 1) * itemsPerPage;\r\n\tconst paginatedCategories = filteredCategories.slice(\r\n\t\tstartIndex,\r\n\t\tstartIndex + itemsPerPage\r\n\t);\r\n\r\n\treturn (\r\n\t\t<div className=\"space-y-6\">\r\n\t\t\t{/* Header */}\r\n\t\t\t<div className=\"flex justify-between items-center\">\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<h1 className=\"text-2xl font-bold text-gray-900\">\r\n\t\t\t\t\t\tGestión de Categorías\r\n\t\t\t\t\t</h1>\r\n\t\t\t\t\t<p className=\"text-sm text-gray-600 mt-1\">\r\n\t\t\t\t\t\t{filteredCategories.length} categorías encontradas\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"flex space-x-2\">\r\n\t\t\t\t\t<Link\r\n\t\t\t\t\t\tto=\"/admin/categories/create\"\r\n\t\t\t\t\t\tclassName=\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<FolderPlus className=\"w-4 h-4 mr-2\" />\r\n\t\t\t\t\t\tNueva Categoría\r\n\t\t\t\t\t</Link>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={refreshData}\r\n\t\t\t\t\t\tdisabled={loading}\r\n\t\t\t\t\t\tclassName=\"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors flex items-center disabled:opacity-50\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<RefreshCw\r\n\t\t\t\t\t\t\tsize={16}\r\n\t\t\t\t\t\t\tclassName={`mr-2 ${loading ? \"animate-spin\" : \"\"}`}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\tActualizar\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Mostrar errores */}\r\n\t\t\t{error && (\r\n\t\t\t\t<div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded\">\r\n\t\t\t\t\tError: {error}\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{/* Filtros */}\r\n\t\t\t<div className=\"bg-white rounded-lg shadow-sm p-4\">\r\n\t\t\t\t<div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n\t\t\t\t\t{/* Búsqueda */}\r\n\t\t\t\t\t<div className=\"flex items-center space-x-2\">\r\n\t\t\t\t\t\t<Search className=\"h-5 w-5 text-gray-500\" />\r\n\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\tplaceholder=\"Buscar categorías...\"\r\n\t\t\t\t\t\t\tvalue={searchTerm}\r\n\t\t\t\t\t\t\tonChange={(e) => setSearchTerm(e.target.value)}\r\n\t\t\t\t\t\t\tclassName=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 flex-1\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Filtro de Categoría Padre */}\r\n\t\t\t\t\t<div className=\"flex items-center space-x-2\">\r\n\t\t\t\t\t\t<Filter className=\"h-5 w-5 text-gray-500\" />\r\n\t\t\t\t\t\t<select\r\n\t\t\t\t\t\t\tclassName=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 flex-1\"\r\n\t\t\t\t\t\t\tvalue={parentFilter === null ? \"null\" : parentFilter}\r\n\t\t\t\t\t\t\tonChange={(e) =>\r\n\t\t\t\t\t\t\t\tsetParentFilter(\r\n\t\t\t\t\t\t\t\t\te.target.value === \"null\" ? null : Number(e.target.value)\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<option value=\"null\">Todas las categorías</option>\r\n\t\t\t\t\t\t\t<option value={0}>Categorías principales</option>\r\n\t\t\t\t\t\t\t{mainCategories.map((category) => (\r\n\t\t\t\t\t\t\t\t<option key={category.id} value={category.id}>\r\n\t\t\t\t\t\t\t\t\tSubcategorías de {category.name}\r\n\t\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Filtro de Estado */}\r\n\t\t\t\t\t<div className=\"flex items-center space-x-2\">\r\n\t\t\t\t\t\t<select\r\n\t\t\t\t\t\t\tclassName=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 flex-1\"\r\n\t\t\t\t\t\t\tvalue={statusFilter}\r\n\t\t\t\t\t\t\tonChange={(e) => setStatusFilter(e.target.value)}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<option value=\"all\">Todos los Estados</option>\r\n\t\t\t\t\t\t\t<option value=\"active\">Activas</option>\r\n\t\t\t\t\t\t\t<option value=\"inactive\">Inactivas</option>\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Selector de modo de vista */}\r\n\t\t\t\t\t<div className=\"flex items-center space-x-2\">\r\n\t\t\t\t\t\t<span className=\"text-sm text-gray-600 whitespace-nowrap\">\r\n\t\t\t\t\t\t\tVista:\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t<div className=\"flex border border-gray-300 rounded-lg overflow-hidden\">\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclassName={`px-3 py-1 text-sm ${\r\n\t\t\t\t\t\t\t\t\tviewMode === \"all\"\r\n\t\t\t\t\t\t\t\t\t\t? \"bg-primary-600 text-white\"\r\n\t\t\t\t\t\t\t\t\t\t: \"bg-white text-gray-700\"\r\n\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\tonClick={() => setViewMode(\"all\")}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tTabla\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tclassName={`px-3 py-1 text-sm ${\r\n\t\t\t\t\t\t\t\t\tviewMode === \"tree\"\r\n\t\t\t\t\t\t\t\t\t\t? \"bg-primary-600 text-white\"\r\n\t\t\t\t\t\t\t\t\t\t: \"bg-white text-gray-700\"\r\n\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\tonClick={() => setViewMode(\"tree\")}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\tÁrbol\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Vista de Categorías */}\r\n\t\t\t{viewMode === \"tree\" ? (\r\n\t\t\t\t<div className=\"bg-white rounded-lg shadow-sm p-4\">\r\n\t\t\t\t\t<h3 className=\"text-lg font-medium mb-4\">\r\n\t\t\t\t\t\tVista de árbol de categorías\r\n\t\t\t\t\t</h3>\r\n\t\t\t\t\t<p className=\"text-gray-500\">\r\n\t\t\t\t\t\tEsta vista está en desarrollo. Por favor, utilice la vista de tabla.\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</div>\r\n\t\t\t) : (\r\n\t\t\t\t<Table\r\n\t\t\t\t\tdata={paginatedCategories}\r\n\t\t\t\t\tcolumns={columns}\r\n\t\t\t\t\tsearchFields={[]} // Búsqueda se maneja externamente\r\n\t\t\t\t\tloading={loading}\r\n\t\t\t\t\temptyMessage=\"No se encontraron categorías\"\r\n\t\t\t\t\tpagination={{\r\n\t\t\t\t\t\tcurrentPage: currentPage,\r\n\t\t\t\t\t\ttotalPages: totalPages,\r\n\t\t\t\t\t\ttotalItems: filteredCategories.length,\r\n\t\t\t\t\t\titemsPerPage: itemsPerPage,\r\n\t\t\t\t\t\tonPageChange: handlePageChange,\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default AdminCategoriesPage;\r\n","import {API_ENDPOINTS} from \"../../constants/apiEndpoints\";\r\nimport ApiClient from \"../../infrastructure/api/apiClient\";\r\nimport type {\r\n\tOrder,\r\n\tOrderDetail,\r\n\tOrderListResponse,\r\n\tOrderStatusUpdateData,\r\n} from \"../domain/entities/Order\";\r\n\r\n/**\r\n * Servicio específico para gestión de órdenes desde el panel de administración\r\n */\r\nexport class AdminOrderService {\r\n\t/**\r\n\t * Obtiene todas las órdenes con filtros opcionales\r\n\t */\r\n\tasync getAdminOrders(filters?: {\r\n\t\tstatus?: string;\r\n\t\tpaymentStatus?: string;\r\n\t\tdateFrom?: string;\r\n\t\tdateTo?: string;\r\n\t\tsearch?: string;\r\n\t\tsellerId?: number;\r\n\t\tpage?: number;\r\n\t\tlimit?: number;\r\n\t}): Promise<OrderListResponse> {\r\n\t\ttry {\r\n\t\t\tconsole.log(\r\n\t\t\t\t\"AdminOrderService: Obteniendo órdenes con filtros:\",\r\n\t\t\t\tfilters\r\n\t\t\t);\r\n\r\n\t\t\t// Usamos el endpoint específico para administradores\r\n\t\t\tconst response = await ApiClient.get<any>(\r\n\t\t\t\tAPI_ENDPOINTS.ADMIN.ORDERS,\r\n\t\t\t\tfilters\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log(\"AdminOrderService: Respuesta de órdenes:\", response);\r\n\r\n\t\t\t// Verificar la estructura de la respuesta\r\n\t\t\tconst orders = response?.data || [];\r\n\t\t\tconst pagination = response?.pagination || {\r\n\t\t\t\tcurrentPage: 1,\r\n\t\t\t\ttotalPages: 1,\r\n\t\t\t\ttotalItems: 0,\r\n\t\t\t\titemsPerPage: 10,\r\n\t\t\t};\r\n\r\n\t\t\treturn {\r\n\t\t\t\tdata: orders,\r\n\t\t\t\tmeta: {\r\n\t\t\t\t\ttotal: pagination.totalItems,\r\n\t\t\t\t\tper_page: pagination.itemsPerPage,\r\n\t\t\t\t\tcurrent_page: pagination.currentPage,\r\n\t\t\t\t\tlast_page: pagination.totalPages,\r\n\t\t\t\t},\r\n\t\t\t};\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"AdminOrderService: Error al obtener órdenes:\", error);\r\n\t\t\t// Devolver objeto vacío en caso de error\r\n\t\t\treturn {\r\n\t\t\t\tdata: [],\r\n\t\t\t\tmeta: {\r\n\t\t\t\t\ttotal: 0,\r\n\t\t\t\t\tper_page: 10,\r\n\t\t\t\t\tcurrent_page: 1,\r\n\t\t\t\t\tlast_page: 1,\r\n\t\t\t\t},\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Obtiene el detalle de una orden específica\r\n\t */\r\n\tasync getOrderDetails(orderId: number): Promise<OrderDetail> {\r\n\t\ttry {\r\n\t\t\tconsole.log(`AdminOrderService: Obteniendo detalle de orden ${orderId}`);\r\n\r\n\t\t\t// Usar el endpoint correcto para obtener los detalles de la orden\r\n\t\t\tconst response = await ApiClient.get<any>(\r\n\t\t\t\tAPI_ENDPOINTS.ADMIN.ORDER_DETAIL(orderId)\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log(\r\n\t\t\t\t`AdminOrderService: Respuesta para orden ${orderId}:`,\r\n\t\t\t\tresponse\r\n\t\t\t);\r\n\r\n\t\t\t// Verificar si hay datos en la respuesta\r\n\t\t\tif (!response || !response.data) {\r\n\t\t\t\tthrow new Error(\"Respuesta vacía al obtener detalle de orden\");\r\n\t\t\t}\r\n\r\n\t\t\treturn response.data;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\r\n\t\t\t\t`AdminOrderService: Error al obtener detalle de orden ${orderId}:`,\r\n\t\t\t\terror\r\n\t\t\t);\r\n\t\t\tthrow error;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Actualiza el estado de una orden\r\n\t */\r\n\tasync updateOrderStatus(\r\n\t\torderId: number,\r\n\t\tdata: OrderStatusUpdateData\r\n\t): Promise<Order> {\r\n\t\ttry {\r\n\t\t\tconsole.log(\r\n\t\t\t\t`AdminOrderService: Actualizando estado de orden ${orderId} a ${data.status}`\r\n\t\t\t);\r\n\r\n\t\t\tconst response = await ApiClient.put<any>(\r\n\t\t\t\tAPI_ENDPOINTS.ADMIN.UPDATE_ORDER_STATUS(orderId),\r\n\t\t\t\tdata\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log(\r\n\t\t\t\t`AdminOrderService: Respuesta de actualización para orden ${orderId}:`,\r\n\t\t\t\tresponse\r\n\t\t\t);\r\n\r\n\t\t\t// Verificar si hay datos en la respuesta\r\n\t\t\tif (!response || !response.data) {\r\n\t\t\t\tthrow new Error(\"Respuesta vacía al actualizar estado de orden\");\r\n\t\t\t}\r\n\r\n\t\t\treturn response.data;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\r\n\t\t\t\t`AdminOrderService: Error al actualizar estado de orden ${orderId}:`,\r\n\t\t\t\terror\r\n\t\t\t);\r\n\t\t\tthrow error;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Cancela una orden\r\n\t */\r\n\tasync cancelOrder(orderId: number, reason: string = \"\"): Promise<boolean> {\r\n\t\ttry {\r\n\t\t\tconsole.log(`AdminOrderService: Cancelando orden ${orderId}`);\r\n\r\n\t\t\tconst response = await ApiClient.post<any>(\r\n\t\t\t\tAPI_ENDPOINTS.ADMIN.CANCEL_ORDER(orderId),\r\n\t\t\t\t{reason}\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log(\r\n\t\t\t\t`AdminOrderService: Respuesta de cancelar orden ${orderId}:`,\r\n\t\t\t\tresponse\r\n\t\t\t);\r\n\r\n\t\t\t// Verificar el resultado\r\n\t\t\treturn response?.success || false;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\r\n\t\t\t\t`AdminOrderService: Error al cancelar orden ${orderId}:`,\r\n\t\t\t\terror\r\n\t\t\t);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Actualiza la información de envío de una orden\r\n\t */\r\n\tasync updateShippingInfo(\r\n\t\torderId: number,\r\n\t\tshippingInfo: any\r\n\t): Promise<boolean> {\r\n\t\ttry {\r\n\t\t\tconsole.log(\r\n\t\t\t\t`AdminOrderService: Actualizando información de envío para orden ${orderId}`\r\n\t\t\t);\r\n\r\n\t\t\tconst response = await ApiClient.patch<any>(\r\n\t\t\t\tAPI_ENDPOINTS.ADMIN.UPDATE_SHIPPING(orderId),\r\n\t\t\t\tshippingInfo\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log(\r\n\t\t\t\t`AdminOrderService: Respuesta de actualización de envío para ${orderId}:`,\r\n\t\t\t\tresponse\r\n\t\t\t);\r\n\r\n\t\t\t// Verificar el resultado\r\n\t\t\treturn response?.success || false;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\r\n\t\t\t\t`AdminOrderService: Error al actualizar envío de orden ${orderId}:`,\r\n\t\t\t\terror\r\n\t\t\t);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Obtiene estadísticas generales de órdenes\r\n\t */\r\n\tasync getOrderStats(): Promise<any> {\r\n\t\ttry {\r\n\t\t\tconsole.log(\"AdminOrderService: Obteniendo estadísticas de órdenes\");\r\n\r\n\t\t\tconst response = await ApiClient.get<any>(\r\n\t\t\t\tAPI_ENDPOINTS.ADMIN.ORDER_STATS\r\n\t\t\t);\r\n\r\n\t\t\tconsole.log(\"AdminOrderService: Respuesta de estadísticas:\", response);\r\n\r\n\t\t\t// Verificar si hay datos en la respuesta\r\n\t\t\tif (!response || !response.data) {\r\n\t\t\t\tthrow new Error(\"Respuesta vacía al obtener estadísticas\");\r\n\t\t\t}\r\n\r\n\t\t\treturn response.data;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"AdminOrderService: Error al obtener estadísticas:\", error);\r\n\t\t\t// Devolver objeto básico en caso de error\r\n\t\t\treturn {\r\n\t\t\t\ttotalOrders: 0,\r\n\t\t\t\tpendingOrders: 0,\r\n\t\t\t\tprocessingOrders: 0,\r\n\t\t\t\tshippedOrders: 0,\r\n\t\t\t\tdeliveredOrders: 0,\r\n\t\t\t\tcancelledOrders: 0,\r\n\t\t\t\ttotalSales: 0,\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport default AdminOrderService;\r\n","import {AdminOrderService} from \"../services/AdminOrderService\";\r\nimport type {OrderStatus} from \"../domain/entities/Order\";\r\n\r\n// Interface para las estadísticas en la UI\r\nexport interface AdminOrderStatUI {\r\n\tlabel: string;\r\n\tvalue: number | string;\r\n\ticon?: React.ReactNode;\r\n\tcolor: string;\r\n\tisCurrency?: boolean;\r\n}\r\n\r\n// Interface para la respuesta adaptada para la UI administrativa\r\nexport interface AdminOrderUI {\r\n\tid: number;\r\n\torderNumber: string;\r\n\tdate: string;\r\n\tcustomer: {\r\n\t\tid: number;\r\n\t\tname: string;\r\n\t\temail: string;\r\n\t};\r\n\tseller: {\r\n\t\tid: number;\r\n\t\tname: string;\r\n\t};\r\n\ttotal: number;\r\n\tstatus: OrderStatus;\r\n\tpaymentStatus: string;\r\n\tpaymentMethod: string;\r\n\titems: Array<{\r\n\t\tid: number;\r\n\t\tproductId: number;\r\n\t\tname: string;\r\n\t\tquantity: number;\r\n\t\tprice: number;\r\n\t\tsubtotal: number;\r\n\t\timage?: string;\r\n\t}>;\r\n\tshippingData?: {\r\n\t\taddress: string;\r\n\t\tcity: string;\r\n\t\tstate: string;\r\n\t\tcountry: string;\r\n\t\tpostalCode: string;\r\n\t\tphone?: string;\r\n\t\tname?: string;\r\n\t};\r\n}\r\n\r\n/**\r\n * Adaptador para servicios de órdenes administrativas\r\n */\r\nexport class AdminOrderServiceAdapter {\r\n\tprivate adminOrderService: AdminOrderService;\r\n\r\n\tconstructor() {\r\n\t\tthis.adminOrderService = new AdminOrderService();\r\n\t}\r\n\r\n\t/**\r\n\t * Obtiene las órdenes para la vista de administración\r\n\t * @param filters Filtros para la consulta\r\n\t * @returns Órdenes adaptadas para la UI y información de paginación\r\n\t */\r\n\tasync getAdminOrders(filters?: {\r\n\t\tstatus?: string;\r\n\t\tpaymentStatus?: string;\r\n\t\tdateFrom?: string;\r\n\t\tdateTo?: string;\r\n\t\tsearch?: string;\r\n\t\tsellerId?: number | null;\r\n\t\tpage?: number;\r\n\t\tlimit?: number;\r\n\t}): Promise<{\r\n\t\torders: AdminOrderUI[];\r\n\t\tpagination: {\r\n\t\t\tcurrentPage: number;\r\n\t\t\ttotalPages: number;\r\n\t\t\ttotalItems: number;\r\n\t\t\titemsPerPage: number;\r\n\t\t};\r\n\t}> {\r\n\t\ttry {\r\n\t\t\t// Preparar filtros para la API\r\n\t\t\tconst apiFilters: any = {...filters};\r\n\r\n\t\t\t// Convertir valores especiales\r\n\t\t\tif (filters?.status === \"all\") {\r\n\t\t\t\tdelete apiFilters.status;\r\n\t\t\t}\r\n\r\n\t\t\tif (filters?.paymentStatus === \"all\") {\r\n\t\t\t\tdelete apiFilters.paymentStatus;\r\n\t\t\t}\r\n\r\n\t\t\tif (filters?.sellerId === null) {\r\n\t\t\t\tdelete apiFilters.sellerId;\r\n\t\t\t}\r\n\r\n\t\t\t// Usar el servicio para obtener órdenes\r\n\t\t\tconst response = await this.adminOrderService.getAdminOrders(apiFilters);\r\n\r\n\t\t\t// Adaptar las órdenes al formato requerido por la UI\r\n\t\t\tconst orders: AdminOrderUI[] = response.data.map((order: any) =>\r\n\t\t\t\tthis.adaptOrderToUI(order)\r\n\t\t\t);\r\n\r\n\t\t\t// Adaptar información de paginación\r\n\t\t\tconst pagination = {\r\n\t\t\t\tcurrentPage: response.meta.current_page,\r\n\t\t\t\ttotalPages: response.meta.last_page,\r\n\t\t\t\ttotalItems: response.meta.total,\r\n\t\t\t\titemsPerPage: response.meta.per_page,\r\n\t\t\t};\r\n\r\n\t\t\treturn {orders, pagination};\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error en AdminOrderServiceAdapter.getAdminOrders:\", error);\r\n\t\t\treturn {\r\n\t\t\t\torders: [],\r\n\t\t\t\tpagination: {\r\n\t\t\t\t\tcurrentPage: 1,\r\n\t\t\t\t\ttotalPages: 1,\r\n\t\t\t\t\ttotalItems: 0,\r\n\t\t\t\t\titemsPerPage: 10,\r\n\t\t\t\t},\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Obtiene los detalles de una orden\r\n\t * @param orderId ID de la orden\r\n\t * @returns Detalles de la orden adaptados para la UI\r\n\t */\r\n\tasync getOrderDetails(orderId: number): Promise<AdminOrderUI | null> {\r\n\t\ttry {\r\n\t\t\tconst orderDetails =\r\n\t\t\t\tawait this.adminOrderService.getOrderDetails(orderId);\r\n\t\t\treturn this.adaptOrderToUI(orderDetails);\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(`Error al obtener detalles de la orden ${orderId}:`, error);\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Actualiza el estado de una orden\r\n\t * @param orderId ID de la orden\r\n\t * @param status Nuevo estado\r\n\t * @returns true si se actualizó correctamente\r\n\t */\r\n\tasync updateOrderStatus(\r\n\t\torderId: number,\r\n\t\tstatus: OrderStatus\r\n\t): Promise<boolean> {\r\n\t\ttry {\r\n\t\t\tawait this.adminOrderService.updateOrderStatus(orderId, {status});\r\n\t\t\treturn true;\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\r\n\t\t\t\t`Error al actualizar estado de la orden ${orderId}:`,\r\n\t\t\t\terror\r\n\t\t\t);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Cancela una orden\r\n\t * @param orderId ID de la orden\r\n\t * @param reason Razón de la cancelación\r\n\t * @returns true si se canceló correctamente\r\n\t */\r\n\tasync cancelOrder(orderId: number, reason: string = \"\"): Promise<boolean> {\r\n\t\ttry {\r\n\t\t\treturn await this.adminOrderService.cancelOrder(orderId, reason);\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(`Error al cancelar la orden ${orderId}:`, error);\r\n\t\t\treturn false;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Obtiene estadísticas de órdenes para el dashboard\r\n\t * @returns Estadísticas formateadas para la UI\r\n\t */\r\n\tasync getOrderStats(): Promise<AdminOrderStatUI[]> {\r\n\t\ttry {\r\n\t\t\tconst stats = await this.adminOrderService.getOrderStats();\r\n\r\n\t\t\treturn [\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: \"Total Pedidos\",\r\n\t\t\t\t\tvalue: stats.totalOrders,\r\n\t\t\t\t\tcolor: \"blue\",\r\n\t\t\t\t\tisCurrency: false,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: \"Pendientes\",\r\n\t\t\t\t\tvalue: stats.pendingOrders,\r\n\t\t\t\t\tcolor: \"yellow\",\r\n\t\t\t\t\tisCurrency: false,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: \"En Proceso\",\r\n\t\t\t\t\tvalue: stats.processingOrders,\r\n\t\t\t\t\tcolor: \"blue\",\r\n\t\t\t\t\tisCurrency: false,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: \"Enviados\",\r\n\t\t\t\t\tvalue: stats.shippedOrders,\r\n\t\t\t\t\tcolor: \"indigo\",\r\n\t\t\t\t\tisCurrency: false,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: \"Entregados\",\r\n\t\t\t\t\tvalue: stats.deliveredOrders,\r\n\t\t\t\t\tcolor: \"purple\",\r\n\t\t\t\t\tisCurrency: false,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: \"Completados\",\r\n\t\t\t\t\tvalue: stats.completedOrders,\r\n\t\t\t\t\tcolor: \"green\",\r\n\t\t\t\t\tisCurrency: false,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: \"Cancelados\",\r\n\t\t\t\t\tvalue: stats.cancelledOrders,\r\n\t\t\t\t\tcolor: \"red\",\r\n\t\t\t\t\tisCurrency: false,\r\n\t\t\t\t},\r\n\t\t\t\t{\r\n\t\t\t\t\tlabel: \"Total Ventas\",\r\n\t\t\t\t\tvalue: stats.totalSales,\r\n\t\t\t\t\tcolor: \"green\",\r\n\t\t\t\t\tisCurrency: true,\r\n\t\t\t\t},\r\n\t\t\t];\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error en AdminOrderServiceAdapter.getOrderStats:\", error);\r\n\t\t\treturn [];\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Adapta una orden al formato requerido por la UI\r\n\t * @param order Orden desde el API\r\n\t * @returns Orden formateada para la UI administrativa\r\n\t */\r\n\tprivate adaptOrderToUI(order: any): AdminOrderUI {\r\n\t\t// Extraer información del cliente\r\n\t\tconst customerName =\r\n\t\t\torder.user_name ||\r\n\t\t\t(order.user ? order.user.name : \"Cliente\") ||\r\n\t\t\t(order.customer ? order.customer.name : \"Cliente\");\r\n\r\n\t\tconst customerEmail =\r\n\t\t\torder.user_email ||\r\n\t\t\t(order.user ? order.user.email : \"\") ||\r\n\t\t\t(order.customer ? order.customer.email : \"\");\r\n\r\n\t\t// Extraer información del vendedor\r\n\t\tconst sellerName =\r\n\t\t\torder.seller_name ||\r\n\t\t\t(order.seller ? order.seller.name : \"Vendedor\") ||\r\n\t\t\t\"Vendedor\";\r\n\r\n\t\t// Procesar items con el formato esperado\r\n\t\tconst items = Array.isArray(order.items)\r\n\t\t\t? order.items.map((item: any) => ({\r\n\t\t\t\t\tid: item.id || 0,\r\n\t\t\t\t\tproductId: item.product_id || item.productId || 0,\r\n\t\t\t\t\tname:\r\n\t\t\t\t\t\titem.product_name ||\r\n\t\t\t\t\t\t(item.product ? item.product.name : \"Producto\"),\r\n\t\t\t\t\tquantity: item.quantity || 0,\r\n\t\t\t\t\tprice: item.price || 0,\r\n\t\t\t\t\tsubtotal: item.subtotal || 0,\r\n\t\t\t\t\timage:\r\n\t\t\t\t\t\titem.product_image ||\r\n\t\t\t\t\t\t(item.product ? item.product.image : undefined),\r\n\t\t\t\t}))\r\n\t\t\t: [];\r\n\r\n\t\t// Procesar datos de envío\r\n\t\tlet shippingData = null;\r\n\t\tif (order.shipping_data) {\r\n\t\t\t// Puede venir como string JSON\r\n\t\t\tif (typeof order.shipping_data === \"string\") {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tshippingData = JSON.parse(order.shipping_data);\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tconsole.error(\"Error al parsear shipping_data:\", e);\r\n\t\t\t\t\tshippingData = {};\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tshippingData = order.shipping_data;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn {\r\n\t\t\tid: order.id || 0,\r\n\t\t\torderNumber: order.order_number || order.orderNumber || `#${order.id}`,\r\n\t\t\tdate:\r\n\t\t\t\torder.created_at ||\r\n\t\t\t\torder.createdAt ||\r\n\t\t\t\torder.date ||\r\n\t\t\t\tnew Date().toISOString(),\r\n\t\t\tcustomer: {\r\n\t\t\t\tid: order.user_id || (order.user ? order.user.id : 0) || 0,\r\n\t\t\t\tname: customerName,\r\n\t\t\t\temail: customerEmail,\r\n\t\t\t},\r\n\t\t\tseller: {\r\n\t\t\t\tid: order.seller_id || (order.seller ? order.seller.id : 0) || 0,\r\n\t\t\t\tname: sellerName,\r\n\t\t\t},\r\n\t\t\ttotal: order.total || 0,\r\n\t\t\tstatus: order.status || \"pending\",\r\n\t\t\tpaymentStatus: order.payment_status || order.paymentStatus || \"pending\",\r\n\t\t\tpaymentMethod: order.payment_method || order.paymentMethod || \"N/A\",\r\n\t\t\titems: items,\r\n\t\t\tshippingData: shippingData,\r\n\t\t};\r\n\t}\r\n}\r\n\r\nexport default AdminOrderServiceAdapter;\r\n","import React, {useState, useEffect} from \"react\";\r\nimport Table from \"../../components/dashboard/Table\";\r\nimport {\r\n\tShoppingBag,\r\n\tUser,\r\n\tCalendar,\r\n\tTruck,\r\n\tFileText,\r\n\tEye,\r\n\tRefreshCw,\r\n\tFilter,\r\n\tClock,\r\n\tCheckCircle,\r\n\tXCircle,\r\n\tRotateCcw,\r\n\tPackage,\r\n\tAlertTriangle,\r\n} from \"lucide-react\";\r\nimport {Link} from \"react-router-dom\";\r\nimport {formatCurrency} from \"../../../utils/formatters/formatCurrency\";\r\nimport type {\r\n\tAdminOrderUI,\r\n} from \"../../../core/adapters/AdminOrderServiceAdapter\";\r\nimport AdminOrderServiceAdapter from \"../../../core/adapters/AdminOrderServiceAdapter\";\r\n\r\n// Estado para filtros\r\ninterface OrderFilters {\r\n\tstatus: string;\r\n\tpaymentStatus: string;\r\n\tsellerId: number | null;\r\n\tdateFrom?: string;\r\n\tdateTo?: string;\r\n\tsearch?: string;\r\n}\r\n\r\nconst AdminOrdersPage: React.FC = () => {\r\n\tconst [orders, setOrders] = useState<AdminOrderUI[]>([]);\r\n\tconst [loading, setLoading] = useState(true);\r\n\tconst [filters, setFilters] = useState<OrderFilters>({\r\n\t\tstatus: \"all\",\r\n\t\tpaymentStatus: \"all\",\r\n\t\tsellerId: null,\r\n\t});\r\n\tconst [pagination, setPagination] = useState({\r\n\t\tcurrentPage: 1,\r\n\t\ttotalPages: 1,\r\n\t\ttotalItems: 0,\r\n\t\titemsPerPage: 10,\r\n\t});\r\n\r\n\t// Crear instancia del adaptador\r\n\tconst orderAdapter = new AdminOrderServiceAdapter();\r\n\r\n\t// Cargar datos de pedidos\r\n\tuseEffect(() => {\r\n\t\tfetchOrders();\r\n\t}, [filters, pagination.currentPage]);\r\n\r\n\t// Función para obtener órdenes\r\n\tconst fetchOrders = async () => {\r\n\t\tsetLoading(true);\r\n\t\ttry {\r\n\t\t\t// Preparar filtros para la API\r\n\t\t\tconst apiFilters = {\r\n\t\t\t\tstatus: filters.status !== \"all\" ? filters.status : undefined,\r\n\t\t\t\tpaymentStatus:\r\n\t\t\t\t\tfilters.paymentStatus !== \"all\" ? filters.paymentStatus : undefined,\r\n\t\t\t\tsellerId: filters.sellerId,\r\n\t\t\t\tdateFrom: filters.dateFrom,\r\n\t\t\t\tdateTo: filters.dateTo,\r\n\t\t\t\tsearch: filters.search,\r\n\t\t\t\tpage: pagination.currentPage,\r\n\t\t\t\tlimit: pagination.itemsPerPage,\r\n\t\t\t};\r\n\r\n\t\t\t// Llamar al servicio a través del adaptador\r\n\t\t\tconst result = await orderAdapter.getAdminOrders(apiFilters);\r\n\r\n\t\t\tsetOrders(result.orders);\r\n\t\t\tsetPagination({\r\n\t\t\t\tcurrentPage: result.pagination.currentPage,\r\n\t\t\t\ttotalPages: result.pagination.totalPages,\r\n\t\t\t\ttotalItems: result.pagination.totalItems,\r\n\t\t\t\titemsPerPage: result.pagination.itemsPerPage,\r\n\t\t\t});\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al cargar órdenes:\", error);\r\n\t\t\t// Mostrar mensaje de error o usar datos de fallback si es necesario\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t};\r\n\r\n\t// Mapeo de estado para los pedidos\r\n\tconst orderStatusMap: Record<\r\n\t\tstring,\r\n\t\t{label: string; color: string; icon: React.ReactNode}\r\n\t> = {\r\n\t\tpending: {\r\n\t\t\tlabel: \"Pendiente\",\r\n\t\t\tcolor:\r\n\t\t\t\t\"bg-yellow-100 text-yellow-800\",\r\n\t\t\ticon: <Clock className=\"w-3 h-3 mr-1\" />,\r\n\t\t},\r\n\t\tprocessing: {\r\n\t\t\tlabel: \"En proceso\",\r\n\t\t\tcolor: \"bg-blue-100 text-blue-800\",\r\n\t\t\ticon: <RefreshCw className=\"w-3 h-3 mr-1\" />,\r\n\t\t},\r\n\t\tpaid: {\r\n\t\t\tlabel: \"Pagado\",\r\n\t\t\tcolor: \"bg-teal-100 text-teal-800\",\r\n\t\t\ticon: <CheckCircle className=\"w-3 h-3 mr-1\" />,\r\n\t\t},\r\n\t\tshipped: {\r\n\t\t\tlabel: \"Enviado\",\r\n\t\t\tcolor:\r\n\t\t\t\t\"bg-indigo-100 text-indigo-800\",\r\n\t\t\ticon: <Truck className=\"w-3 h-3 mr-1\" />,\r\n\t\t},\r\n\t\tdelivered: {\r\n\t\t\tlabel: \"Entregado\",\r\n\t\t\tcolor:\r\n\t\t\t\t\"bg-purple-100 text-purple-800\",\r\n\t\t\ticon: <Package className=\"w-3 h-3 mr-1\" />,\r\n\t\t},\r\n\t\tcompleted: {\r\n\t\t\tlabel: \"Completado\",\r\n\t\t\tcolor:\r\n\t\t\t\t\"bg-emerald-100 text-emerald-800\",\r\n\t\t\ticon: <CheckCircle className=\"w-3 h-3 mr-1\" />,\r\n\t\t},\r\n\t\tcancelled: {\r\n\t\t\tlabel: \"Cancelado\",\r\n\t\t\tcolor: \"bg-red-100 text-red-800\",\r\n\t\t\ticon: <XCircle className=\"w-3 h-3 mr-1\" />,\r\n\t\t},\r\n\t\treturned: {\r\n\t\t\tlabel: \"Devuelto\",\r\n\t\t\tcolor:\r\n\t\t\t\t\"bg-orange-100 text-orange-800\",\r\n\t\t\ticon: <RotateCcw className=\"w-3 h-3 mr-1\" />,\r\n\t\t},\r\n\t\tready_for_pickup: {\r\n\t\t\tlabel: \"Listo para recoger\",\r\n\t\t\tcolor:\r\n\t\t\t\t\"bg-purple-100 text-purple-800\",\r\n\t\t\ticon: <ShoppingBag className=\"w-3 h-3 mr-1\" />,\r\n\t\t},\r\n\t};\r\n\r\n\t// Mapeo de estado de pago\r\n\tconst paymentStatusMap: Record<string, {label: string; color: string}> = {\r\n\t\tpaid: {\r\n\t\t\tlabel: \"Pagado\",\r\n\t\t\tcolor:\r\n\t\t\t\t\"bg-green-100 text-green-800\",\r\n\t\t},\r\n\t\tcompleted: {\r\n\t\t\tlabel: \"Completado\",\r\n\t\t\tcolor:\r\n\t\t\t\t\"bg-green-100 text-green-800\",\r\n\t\t},\r\n\t\tpending: {\r\n\t\t\tlabel: \"Pendiente\",\r\n\t\t\tcolor:\r\n\t\t\t\t\"bg-yellow-100 text-yellow-800\",\r\n\t\t},\r\n\t\trefunded: {\r\n\t\t\tlabel: \"Reembolsado\",\r\n\t\t\tcolor: \"bg-red-100 text-red-800\",\r\n\t\t},\r\n\t\tfailed: {\r\n\t\t\tlabel: \"Fallido\",\r\n\t\t\tcolor: \"bg-gray-100 text-gray-800\",\r\n\t\t},\r\n\t};\r\n\r\n\t// Mapeo de métodos de pago\r\n\tconst paymentMethodMap: Record<string, string> = {\r\n\t\tcredit_card: \"Tarjeta de crédito\",\r\n\t\tpaypal: \"PayPal\",\r\n\t\tbank_transfer: \"Transferencia bancaria\",\r\n\t\tcash_on_delivery: \"Contra reembolso\",\r\n\t};\r\n\r\n\t// Obtener siguiente estado del pedido\r\n\tconst getNextStatus = (currentStatus: string): string => {\r\n\t\tconst statusFlow: Record<string, string> = {\r\n\t\t\tpending: \"processing\",\r\n\t\t\tprocessing: \"shipped\",\r\n\t\t\tshipped: \"delivered\",\r\n\t\t\tdelivered: \"completed\",\r\n\t\t};\r\n\r\n\t\treturn statusFlow[currentStatus] || currentStatus;\r\n\t};\r\n\r\n\t// Actualizar estado del pedido\r\n\tconst updateOrderStatus = async (orderId: number, newStatus: string) => {\r\n\t\tsetLoading(true);\r\n\t\ttry {\r\n\t\t\tconst success = await orderAdapter.updateOrderStatus(\r\n\t\t\t\torderId,\r\n\t\t\t\tnewStatus as AdminOrderUI[\"status\"] // Cast explícito\r\n\t\t\t);\r\n\r\n\t\t\tif (success) {\r\n\t\t\t\tsetOrders((prevOrders) =>\r\n\t\t\t\t\tprevOrders.map((order) => {\r\n\t\t\t\t\t\tif (order.id === orderId) {\r\n\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t...order,\r\n\t\t\t\t\t\t\t\tstatus: newStatus as AdminOrderUI[\"status\"], // Cast explícito\r\n\t\t\t\t\t\t\t\tupdatedAt: new Date().toISOString(),\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn order;\r\n\t\t\t\t\t})\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\talert(\"Error al actualizar el estado de la orden\");\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error al actualizar estado:\", error);\r\n\t\t\talert(\"Error al actualizar el estado de la orden\");\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t};\r\n\r\n\t// Avanzar al siguiente estado\r\n\tconst advanceOrderStatus = (orderId: number, currentStatus: string) => {\r\n\t\tconst nextStatus = getNextStatus(currentStatus);\r\n\t\tif (nextStatus !== currentStatus) {\r\n\t\t\tupdateOrderStatus(orderId, nextStatus);\r\n\t\t}\r\n\t};\r\n\r\n\t// Cancelar pedido\r\n\tconst cancelOrder = async (orderId: number) => {\r\n\t\tif (window.confirm(\"¿Estás seguro de que deseas cancelar este pedido?\")) {\r\n\t\t\tsetLoading(true);\r\n\t\t\ttry {\r\n\t\t\t\tconst success = await orderAdapter.cancelOrder(orderId);\r\n\r\n\t\t\t\tif (success) {\r\n\t\t\t\t\t// Actualizar el estado localmente o recargar los datos\r\n\t\t\t\t\tsetOrders((prevOrders) =>\r\n\t\t\t\t\t\tprevOrders.map((order) => {\r\n\t\t\t\t\t\t\tif (order.id === orderId) {\r\n\t\t\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\t\t\t...order,\r\n\t\t\t\t\t\t\t\t\tstatus: \"cancelled\",\r\n\t\t\t\t\t\t\t\t\tupdatedAt: new Date().toISOString(),\r\n\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn order;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Mostrar mensaje de error\r\n\t\t\t\t\talert(\"Error al cancelar la orden\");\r\n\t\t\t\t}\r\n\t\t\t} catch (error) {\r\n\t\t\t\tconsole.error(\"Error al cancelar orden:\", error);\r\n\t\t\t\talert(\"Error al cancelar la orden\");\r\n\t\t\t} finally {\r\n\t\t\t\tsetLoading(false);\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\r\n\t// Formatear fecha\r\n\tconst formatDate = (dateString: string | undefined) => {\r\n\t\tif (!dateString) return \"N/A\";\r\n\r\n\t\tconst date = new Date(dateString);\r\n\t\treturn new Intl.DateTimeFormat(\"es-ES\", {\r\n\t\t\tday: \"2-digit\",\r\n\t\t\tmonth: \"2-digit\",\r\n\t\t\tyear: \"numeric\",\r\n\t\t\thour: \"2-digit\",\r\n\t\t\tminute: \"2-digit\",\r\n\t\t}).format(date);\r\n\t};\r\n\r\n\t// Manejar cambio de página\r\n\tconst handlePageChange = (page: number) => {\r\n\t\tsetPagination((prev) => ({...prev, currentPage: page}));\r\n\t};\r\n\r\n\t// Refrescar datos\r\n\tconst refreshData = () => {\r\n\t\tfetchOrders();\r\n\t};\r\n\r\n\t// Manejar cambios en filtros\r\n\tconst handleFilterChange = (\r\n\t\tfilterName: string,\r\n\t\tvalue: string | number | null\r\n\t) => {\r\n\t\tsetFilters((prev) => ({\r\n\t\t\t...prev,\r\n\t\t\t[filterName]: value,\r\n\t\t}));\r\n\r\n\t\t// Resetear a la primera página al cambiar filtros\r\n\t\tsetPagination((prev) => ({\r\n\t\t\t...prev,\r\n\t\t\tcurrentPage: 1,\r\n\t\t}));\r\n\t};\r\n\r\n\t// Limpiar filtros\r\n\tconst clearFilters = () => {\r\n\t\tsetFilters({\r\n\t\t\tstatus: \"all\",\r\n\t\t\tpaymentStatus: \"all\",\r\n\t\t\tsellerId: null,\r\n\t\t\tdateFrom: undefined,\r\n\t\t\tdateTo: undefined,\r\n\t\t\tsearch: undefined,\r\n\t\t});\r\n\t};\r\n\r\n\t// Definir columnas de la tabla\r\n\tconst columns = [\r\n\t\t{\r\n\t\t\tkey: \"orderNumber\",\r\n\t\t\theader: \"Pedido\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (order: AdminOrderUI) => (\r\n\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t<div className=\"flex-shrink-0 h-10 w-10 rounded-lg bg-primary-100 flex items-center justify-center\">\r\n\t\t\t\t\t\t<ShoppingBag className=\"h-6 w-6 text-primary-600\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"ml-4\">\r\n\t\t\t\t\t\t<div className=\"text-sm font-medium text-gray-900\">\r\n\t\t\t\t\t\t\t{order.orderNumber}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"text-xs text-gray-500 flex items-center\">\r\n\t\t\t\t\t\t\t<Calendar className=\"w-3 h-3 mr-1\" />\r\n\t\t\t\t\t\t\t{formatDate(order.date)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"customer\",\r\n\t\t\theader: \"Cliente\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (order: AdminOrderUI) => {\r\n\t\t\t\tconst customerName =\r\n\t\t\t\t\torder.customer.name || `Usuario ${order.customer.id}`;\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t<div className=\"flex-shrink-0 h-8 w-8 rounded-full bg-gray-200 flex items-center justify-center\">\r\n\t\t\t\t\t\t\t<User className=\"h-4 w-4 text-gray-500\" />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"ml-3\">\r\n\t\t\t\t\t\t\t<div className=\"text-sm font-medium text-gray-900\">\r\n\t\t\t\t\t\t\t\t{customerName}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t<div className=\"text-xs text-gray-500\">\r\n\t\t\t\t\t\t\t\tID: {order.customer.id}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"items\",\r\n\t\t\theader: \"Productos\",\r\n\t\t\trender: (order: AdminOrderUI) => (\r\n\t\t\t\t<div className=\"text-sm\">\r\n\t\t\t\t\t<span className=\"font-medium\">{order.items.length}</span> producto(s)\r\n\t\t\t\t\t{order.items.length > 0 && (\r\n\t\t\t\t\t\t<div className=\"text-xs text-gray-500 mt-1\">\r\n\t\t\t\t\t\t\t{order.items.slice(0, 2).map((item) => (\r\n\t\t\t\t\t\t\t\t<div key={item.id}>\r\n\t\t\t\t\t\t\t\t\t{item.quantity}x {item.name || `Producto ${item.productId}`}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t{order.items.length > 2 && (\r\n\t\t\t\t\t\t\t\t<div>+ {order.items.length - 2} más...</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t)}\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"total\",\r\n\t\t\theader: \"Total\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (order: AdminOrderUI) => (\r\n\t\t\t\t<div className=\"font-medium text-gray-900\">\r\n\t\t\t\t\t{formatCurrency(order.total)}\r\n\t\t\t\t</div>\r\n\t\t\t),\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"status\",\r\n\t\t\theader: \"Estado\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (order: AdminOrderUI) => {\r\n\t\t\t\tconst status = orderStatusMap[order.status] || {\r\n\t\t\t\t\tlabel: order.status,\r\n\t\t\t\t\tcolor:\r\n\t\t\t\t\t\t\"bg-gray-100 text-gray-800\",\r\n\t\t\t\t\ticon: <AlertTriangle className=\"w-3 h-3 mr-1\" />,\r\n\t\t\t\t};\r\n\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<span\r\n\t\t\t\t\t\tclassName={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${status.color}`}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{status.icon}\r\n\t\t\t\t\t\t{status.label}\r\n\t\t\t\t\t</span>\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"payment\",\r\n\t\t\theader: \"Pago\",\r\n\t\t\tsortable: true,\r\n\t\t\trender: (order: AdminOrderUI) => {\r\n\t\t\t\tconst paymentMethod =\r\n\t\t\t\t\tpaymentMethodMap[order.paymentMethod || \"\"] || order.paymentMethod;\r\n\t\t\t\tconst paymentStatus = paymentStatusMap[\r\n\t\t\t\t\torder.paymentStatus || \"pending\"\r\n\t\t\t\t] || {\r\n\t\t\t\t\tlabel: order.paymentStatus,\r\n\t\t\t\t\tcolor:\r\n\t\t\t\t\t\t\"bg-gray-100 text-gray-800\",\r\n\t\t\t\t};\r\n\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<div className=\"text-sm text-gray-500\">\r\n\t\t\t\t\t\t\t{paymentMethod}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\tclassName={`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${paymentStatus.color}`}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t{paymentStatus.label}\r\n\t\t\t\t\t\t</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t},\r\n\t\t{\r\n\t\t\tkey: \"actions\",\r\n\t\t\theader: \"Acciones\",\r\n\t\t\trender: (order: AdminOrderUI) => {\r\n\t\t\t\tconst canAdvance = [\r\n\t\t\t\t\t\"pending\",\r\n\t\t\t\t\t\"processing\",\r\n\t\t\t\t\t\"shipped\",\r\n\t\t\t\t\t\"delivered\",\r\n\t\t\t\t].includes(order.status);\r\n\t\t\t\tconst canCancel = [\"pending\", \"processing\"].includes(order.status);\r\n\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div className=\"flex justify-end space-x-2\">\r\n\t\t\t\t\t\t{/* Ver detalles */}\r\n\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\tto={`/admin/orders/${order.id}`}\r\n\t\t\t\t\t\t\tclassName=\"p-1 text-blue-600 hover:bg-blue-100 rounded-md\"\r\n\t\t\t\t\t\t\ttitle=\"Ver detalles del pedido\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Eye size={18} />\r\n\t\t\t\t\t\t</Link>\r\n\r\n\t\t\t\t\t\t{/* Ver factura si está completado */}\r\n\t\t\t\t\t\t{[\"completed\", \"delivered\"].includes(order.status) && (\r\n\t\t\t\t\t\t\t<Link\r\n\t\t\t\t\t\t\t\tto={`/admin/invoices?orderId=${order.id}`}\r\n\t\t\t\t\t\t\t\tclassName=\"p-1 text-indigo-600 hover:bg-indigo-100 rounded-md\"\r\n\t\t\t\t\t\t\t\ttitle=\"Ver factura\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<FileText size={18} />\r\n\t\t\t\t\t\t\t</Link>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t{/* Avanzar estado */}\r\n\t\t\t\t\t\t{canAdvance && (\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tonClick={() => advanceOrderStatus(order.id, order.status)}\r\n\t\t\t\t\t\t\t\tclassName=\"p-1 text-green-600 hover:bg-green-100 rounded-md\"\r\n\t\t\t\t\t\t\t\ttitle={`Avanzar a ${orderStatusMap[getNextStatus(order.status)]?.label || \"siguiente estado\"}`}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<CheckCircle size={18} />\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t\t{/* Cancelar pedido */}\r\n\t\t\t\t\t\t{canCancel && (\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tonClick={() => cancelOrder(order.id)}\r\n\t\t\t\t\t\t\t\tclassName=\"p-1 text-red-600 hover:bg-red-100 rounded-md\"\r\n\t\t\t\t\t\t\t\ttitle=\"Cancelar pedido\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<XCircle size={18} />\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t);\r\n\t\t\t},\r\n\t\t},\r\n\t];\r\n\r\n\treturn (\r\n\t\t<div className=\"space-y-6\">\r\n\t\t\t<div className=\"flex justify-between items-center\">\r\n\t\t\t\t<h1 className=\"text-2xl font-bold text-gray-900\">\r\n\t\t\t\t\tGestión de Pedidos\r\n\t\t\t\t</h1>\r\n\t\t\t\t<div className=\"flex space-x-2\">\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={refreshData}\r\n\t\t\t\t\t\tclassName=\"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<RefreshCw size={18} className=\"inline mr-2\" />\r\n\t\t\t\t\t\tActualizar\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Filtros */}\r\n\t\t\t<div className=\"bg-white rounded-lg shadow-sm p-4\">\r\n\t\t\t\t<div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n\t\t\t\t\t{/* Filtro de Estado */}\r\n\t\t\t\t\t<div className=\"flex flex-col space-y-1\">\r\n\t\t\t\t\t\t<label className=\"text-sm text-gray-600\">\r\n\t\t\t\t\t\t\tEstado del pedido\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t\t<Filter className=\"h-5 w-5 text-gray-500 mr-2\" />\r\n\t\t\t\t\t\t\t<select\r\n\t\t\t\t\t\t\t\tclassName=\"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n\t\t\t\t\t\t\t\tvalue={filters.status}\r\n\t\t\t\t\t\t\t\tonChange={(e) => handleFilterChange(\"status\", e.target.value)}\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<option value=\"all\">Todos los Estados</option>\r\n\t\t\t\t\t\t\t\t{Object.entries(orderStatusMap).map(([key, {label}]) => (\r\n\t\t\t\t\t\t\t\t\t<option key={key} value={key}>\r\n\t\t\t\t\t\t\t\t\t\t{label}\r\n\t\t\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t</select>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Filtro de Estado de Pago */}\r\n\t\t\t\t\t<div className=\"flex flex-col space-y-1\">\r\n\t\t\t\t\t\t<label className=\"text-sm text-gray-600\">\r\n\t\t\t\t\t\t\tEstado de pago\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<select\r\n\t\t\t\t\t\t\tclassName=\"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n\t\t\t\t\t\t\tvalue={filters.paymentStatus}\r\n\t\t\t\t\t\t\tonChange={(e) =>\r\n\t\t\t\t\t\t\t\thandleFilterChange(\"paymentStatus\", e.target.value)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<option value=\"all\">Todos los Estados</option>\r\n\t\t\t\t\t\t\t{Object.entries(paymentStatusMap).map(([key, {label}]) => (\r\n\t\t\t\t\t\t\t\t<option key={key} value={key}>\r\n\t\t\t\t\t\t\t\t\t{label}\r\n\t\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Filtro de Vendedor */}\r\n\t\t\t\t\t<div className=\"flex flex-col space-y-1\">\r\n\t\t\t\t\t\t<label className=\"text-sm text-gray-600\">\r\n\t\t\t\t\t\t\tVendedor\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<select\r\n\t\t\t\t\t\t\tclassName=\"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n\t\t\t\t\t\t\tvalue={filters.sellerId === null ? \"null\" : filters.sellerId}\r\n\t\t\t\t\t\t\tonChange={(e) =>\r\n\t\t\t\t\t\t\t\thandleFilterChange(\r\n\t\t\t\t\t\t\t\t\t\"sellerId\",\r\n\t\t\t\t\t\t\t\t\te.target.value === \"null\" ? null : Number(e.target.value)\r\n\t\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<option value=\"null\">Todos los Vendedores</option>\r\n\t\t\t\t\t\t\t{/* Aquí deberíamos obtener la lista de vendedores de la API */}\r\n\t\t\t\t\t\t\t{/* Por ahora usamos los que venían en los datos de ejemplo */}\r\n\t\t\t\t\t\t\t{[1, 2, 3, 4, 5].map((sellerId) => (\r\n\t\t\t\t\t\t\t\t<option key={sellerId} value={sellerId}>\r\n\t\t\t\t\t\t\t\t\tVendedor {sellerId}\r\n\t\t\t\t\t\t\t\t</option>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</select>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Filtro de Rango de Fechas */}\r\n\t\t\t\t\t<div className=\"flex flex-col space-y-1\">\r\n\t\t\t\t\t\t<label className=\"text-sm text-gray-600\">\r\n\t\t\t\t\t\t\tRango de fechas\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<div className=\"grid grid-cols-2 gap-2\">\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype=\"date\"\r\n\t\t\t\t\t\t\t\tclassName=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n\t\t\t\t\t\t\t\tvalue={filters.dateFrom || \"\"}\r\n\t\t\t\t\t\t\t\tonChange={(e) => handleFilterChange(\"dateFrom\", e.target.value)}\r\n\t\t\t\t\t\t\t\tplaceholder=\"Desde\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype=\"date\"\r\n\t\t\t\t\t\t\t\tclassName=\"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500\"\r\n\t\t\t\t\t\t\t\tvalue={filters.dateTo || \"\"}\r\n\t\t\t\t\t\t\t\tonChange={(e) => handleFilterChange(\"dateTo\", e.target.value)}\r\n\t\t\t\t\t\t\t\tplaceholder=\"Hasta\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"mt-4 flex justify-end\">\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={clearFilters}\r\n\t\t\t\t\t\tclassName=\"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tLimpiar filtros\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Tabla de Pedidos */}\r\n\t\t\t<Table\r\n\t\t\t\tdata={orders}\r\n\t\t\t\tcolumns={columns}\r\n\t\t\t\tsearchFields={[\"orderNumber\", \"customer\"]}\r\n\t\t\t\tloading={loading}\r\n\t\t\t\temptyMessage=\"No se encontraron pedidos\"\r\n\t\t\t\tpagination={{\r\n\t\t\t\t\tcurrentPage: pagination.currentPage,\r\n\t\t\t\t\ttotalPages: pagination.totalPages,\r\n\t\t\t\t\ttotalItems: pagination.totalItems,\r\n\t\t\t\t\titemsPerPage: pagination.itemsPerPage,\r\n\t\t\t\t\tonPageChange: handlePageChange,\r\n\t\t\t\t}}\r\n\t\t\t/>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default AdminOrdersPage;\r\n","/**\r\n * 🚨 RESCUE ADAPTER - ConfigurationService\r\n * Adaptador inteligente que rescata los componentes admin existentes\r\n * Usa ConfigurationManager internamente + endpoints directos para datos específicos\r\n */\r\n\r\nimport ConfigurationManager from './ConfigurationManager';\r\nimport ApiClient from '../../infrastructure/api/apiClient';\r\nimport { API_ENDPOINTS } from '../../constants/apiEndpoints';\r\n\r\n// ===============================================\r\n// 🎯 INTERFACES DE CONFIGURACIÓN ESPECÍFICAS\r\n// ===============================================\r\n\r\nexport interface DevelopmentConfig {\r\n  mode: boolean;\r\n  allowAdminOnlyAccess: boolean;\r\n  bypassEmailVerification: boolean;\r\n  requireEmailVerification: boolean;\r\n  emailVerificationTimeout: number;\r\n}\r\n\r\nexport interface ModerationConfig {\r\n  auto_approval: boolean;\r\n  review_threshold: number;\r\n  enable_user_reports: boolean;\r\n  auto_suspend_threshold: number;\r\n  manual_review_required: boolean;\r\n  userStrikesThreshold: number;\r\n  lowStockThreshold: number;\r\n  contactScorePenalty: number;\r\n  businessScoreBonus: number;\r\n  contactPenaltyHeavy: number;\r\n  minimumContactScore: number;\r\n  scoreDifferenceThreshold: number;\r\n  consecutiveNumbersLimit: number;\r\n  numbersWithContextLimit: number;\r\n}\r\n\r\nexport interface SecurityConfig {\r\n  password_rules: {\r\n    min_length: number;\r\n    require_uppercase: boolean;\r\n    require_lowercase: boolean;\r\n    require_numbers: boolean;\r\n    require_special_chars: boolean;\r\n  };\r\n  session_timeout: number;\r\n  max_login_attempts: number;\r\n  lockout_duration: number;\r\n  passwordMinLength: number;\r\n  passwordRequireSpecial: boolean;\r\n  passwordRequireUppercase: boolean;\r\n  passwordRequireNumbers: boolean;\r\n  accountLockAttempts: number;\r\n  sessionTimeout: number;\r\n  requireEmailVerification: boolean;\r\n  enableTwoFactor: boolean;\r\n  adminIpRestriction: boolean;\r\n}\r\n\r\nexport interface RatingConfig {\r\n  min_rating: number;\r\n  max_rating: number;\r\n  allow_anonymous: boolean;\r\n  require_purchase: boolean;\r\n  enable_reviews: boolean;\r\n  auto_publish_reviews: boolean;\r\n  auto_approve_all: boolean;\r\n  auto_approve_threshold: number;\r\n  'ratings.auto_approve_all': boolean;\r\n  'ratings.auto_approve_threshold': number;\r\n}\r\n\r\n// ===============================================\r\n// 🎯 RESPONSE INTERFACES (API Compatible)\r\n// ===============================================\r\n\r\ninterface ConfigurationResponse<T> {\r\n  status: 'success' | 'error';\r\n  data?: T;\r\n  message?: string;\r\n}\r\n\r\n// ===============================================\r\n// 🚨 CONFIGURATION SERVICE ADAPTER\r\n// ===============================================\r\n\r\n// Interface para Volume Discount (requerido por VolumeDiscountManager)\r\nexport interface VolumeDiscountConfig {\r\n  enabled: boolean;\r\n  stackable: boolean;\r\n  default_tiers: Array<{\r\n    quantity: number;\r\n    discount: number;\r\n    label: string;\r\n  }>;\r\n}\r\n\r\nclass ConfigurationService {\r\n  constructor() {\r\n    // ConfigurationManager se usa a través del singleton cuando es necesario\r\n  }\r\n\r\n  // 🔧 DEVELOPMENT CONFIGURATIONS\r\n  async getDevelopmentConfigs(): Promise<ConfigurationResponse<DevelopmentConfig>> {\r\n    try {\r\n      const response: any = await ApiClient.get(API_ENDPOINTS.ADMIN.CONFIGURATIONS.DEVELOPMENT);\r\n      \r\n      if (response?.data) {\r\n        const config: DevelopmentConfig = {\r\n          mode: response.data.mode || false,\r\n          allowAdminOnlyAccess: response.data.allowAdminOnlyAccess || false,\r\n          bypassEmailVerification: response.data.bypassEmailVerification || true,\r\n          requireEmailVerification: response.data.requireEmailVerification || false,\r\n          emailVerificationTimeout: response.data.emailVerificationTimeout || 24,\r\n        };\r\n\r\n        return {\r\n          status: 'success',\r\n          data: config\r\n        };\r\n      }\r\n\r\n      // Fallback con valores por defecto\r\n      return {\r\n        status: 'success',\r\n        data: {\r\n          mode: false,\r\n          allowAdminOnlyAccess: false,\r\n          bypassEmailVerification: true,\r\n          requireEmailVerification: false,\r\n          emailVerificationTimeout: 24,\r\n        }\r\n      };\r\n    } catch (error) {\r\n      console.error('Error getting development configs:', error);\r\n      return {\r\n        status: 'error',\r\n        message: 'Error al obtener configuraciones de desarrollo'\r\n      };\r\n    }\r\n  }\r\n\r\n  async updateDevelopmentConfigs(config: DevelopmentConfig): Promise<ConfigurationResponse<DevelopmentConfig>> {\r\n    try {\r\n      await ApiClient.post(API_ENDPOINTS.ADMIN.CONFIGURATIONS.UPDATE, {\r\n        type: 'development',\r\n        config\r\n      });\r\n\r\n      // ✅ INVALIDAR CACHE para propagar cambios inmediatamente\r\n      ConfigurationManager.getInstance().invalidateCache();\r\n\r\n      return {\r\n        status: 'success',\r\n        data: config,\r\n        message: 'Configuración actualizada correctamente'\r\n      };\r\n    } catch (error) {\r\n      console.error('Error updating development configs:', error);\r\n      return {\r\n        status: 'error',\r\n        message: 'Error al actualizar configuraciones'\r\n      };\r\n    }\r\n  }\r\n\r\n  // 🔧 MODERATION CONFIGURATIONS  \r\n  async getModerationConfigs(): Promise<ConfigurationResponse<ModerationConfig>> {\r\n    try {\r\n      const response: any = await ApiClient.get(API_ENDPOINTS.ADMIN.CONFIGURATIONS.INDEX);\r\n      \r\n      // Extraer configuraciones de moderación desde la respuesta general\r\n      const moderationData = response?.data?.moderation;\r\n\r\n      const config: ModerationConfig = {\r\n        auto_approval: moderationData?.auto_approval || true,\r\n        review_threshold: moderationData?.review_threshold || 3,\r\n        enable_user_reports: moderationData?.enable_user_reports || true,\r\n        auto_suspend_threshold: moderationData?.auto_suspend_threshold || 5,\r\n        manual_review_required: moderationData?.manual_review_required || false,\r\n        userStrikesThreshold: moderationData?.userStrikesThreshold || 3,\r\n        lowStockThreshold: moderationData?.lowStockThreshold || 5,\r\n        contactScorePenalty: moderationData?.contactScorePenalty || 10,\r\n        businessScoreBonus: moderationData?.businessScoreBonus || 5,\r\n        contactPenaltyHeavy: moderationData?.contactPenaltyHeavy || 20,\r\n        minimumContactScore: moderationData?.minimumContactScore || 50,\r\n        scoreDifferenceThreshold: moderationData?.scoreDifferenceThreshold || 30,\r\n        consecutiveNumbersLimit: moderationData?.consecutiveNumbersLimit || 3,\r\n        numbersWithContextLimit: moderationData?.numbersWithContextLimit || 5,\r\n      };\r\n\r\n      return {\r\n        status: 'success',\r\n        data: config\r\n      };\r\n    } catch (error) {\r\n      console.error('Error getting moderation configs:', error);\r\n      return {\r\n        status: 'error',\r\n        message: 'Error al obtener configuraciones de moderación'\r\n      };\r\n    }\r\n  }\r\n\r\n  async updateModerationConfigs(config: ModerationConfig): Promise<ConfigurationResponse<ModerationConfig>> {\r\n    try {\r\n      await ApiClient.post(API_ENDPOINTS.ADMIN.CONFIGURATIONS.UPDATE, {\r\n        type: 'moderation',\r\n        config\r\n      });\r\n\r\n      // ✅ INVALIDAR CACHE para propagar cambios inmediatamente\r\n      ConfigurationManager.getInstance().invalidateCache();\r\n\r\n      return {\r\n        status: 'success',\r\n        data: config,\r\n        message: 'Configuración de moderación actualizada'\r\n      };\r\n    } catch (error) {\r\n      console.error('Error updating moderation configs:', error);\r\n      return {\r\n        status: 'error',\r\n        message: 'Error al actualizar configuraciones de moderación'\r\n      };\r\n    }\r\n  }\r\n\r\n  // 🔧 SECURITY CONFIGURATIONS\r\n  async getSecurityConfigs(): Promise<ConfigurationResponse<SecurityConfig>> {\r\n    try {\r\n      const response: any = await ApiClient.get(API_ENDPOINTS.ADMIN.CONFIGURATIONS.PASSWORD_VALIDATION_RULES);\r\n      \r\n      const config: SecurityConfig = {\r\n        password_rules: {\r\n          min_length: response?.data?.min_length || 8,\r\n          require_uppercase: response?.data?.require_uppercase || true,\r\n          require_lowercase: response?.data?.require_lowercase || true,\r\n          require_numbers: response?.data?.require_numbers || true,\r\n          require_special_chars: response?.data?.require_special_chars || false,\r\n        },\r\n        session_timeout: response?.data?.session_timeout || 3600, // 1 hora\r\n        max_login_attempts: response?.data?.max_login_attempts || 5,\r\n        lockout_duration: response?.data?.lockout_duration || 900, // 15 minutos\r\n        passwordMinLength: response?.data?.min_length || 8,\r\n        passwordRequireSpecial: response?.data?.require_special_chars || false,\r\n        passwordRequireUppercase: response?.data?.require_uppercase || true,\r\n        passwordRequireNumbers: response?.data?.require_numbers || true,\r\n        accountLockAttempts: response?.data?.max_login_attempts || 5,\r\n        sessionTimeout: response?.data?.session_timeout || 3600,\r\n        requireEmailVerification: response?.data?.require_email_verification || true,\r\n        enableTwoFactor: response?.data?.enable_two_factor || false,\r\n        adminIpRestriction: response?.data?.admin_ip_restriction || false,\r\n      };\r\n\r\n      return {\r\n        status: 'success',\r\n        data: config\r\n      };\r\n    } catch (error) {\r\n      console.error('Error getting security configs:', error);\r\n      return {\r\n        status: 'error',\r\n        message: 'Error al obtener configuraciones de seguridad'\r\n      };\r\n    }\r\n  }\r\n\r\n  async updateSecurityConfigs(config: SecurityConfig): Promise<ConfigurationResponse<SecurityConfig>> {\r\n    try {\r\n      await ApiClient.post(API_ENDPOINTS.ADMIN.CONFIGURATIONS.PASSWORD_VALIDATION_RULES, config.password_rules);\r\n\r\n      // ✅ INVALIDAR CACHE para propagar cambios inmediatamente\r\n      ConfigurationManager.getInstance().invalidateCache();\r\n\r\n      return {\r\n        status: 'success',\r\n        data: config,\r\n        message: 'Configuración de seguridad actualizada'\r\n      };\r\n    } catch (error) {\r\n      console.error('Error updating security configs:', error);\r\n      return {\r\n        status: 'error',\r\n        message: 'Error al actualizar configuraciones de seguridad'\r\n      };\r\n    }\r\n  }\r\n\r\n  // 🔧 RATING CONFIGURATIONS\r\n  async getRatingConfigs(): Promise<ConfigurationResponse<RatingConfig>> {\r\n    try {\r\n      const response: any = await ApiClient.get(API_ENDPOINTS.ADMIN.CONFIGURATIONS.RATINGS);\r\n      \r\n      const config: RatingConfig = {\r\n        min_rating: response?.data?.min_rating || 1,\r\n        max_rating: response?.data?.max_rating || 5,\r\n        allow_anonymous: response?.data?.allow_anonymous || false,\r\n        require_purchase: response?.data?.require_purchase || true,\r\n        enable_reviews: response?.data?.enable_reviews || true,\r\n        auto_publish_reviews: response?.data?.auto_publish_reviews || false,\r\n        auto_approve_all: response?.data?.auto_approve_all || false,\r\n        auto_approve_threshold: response?.data?.auto_approve_threshold || 4,\r\n        'ratings.auto_approve_all': response?.data?.auto_approve_all || false,\r\n        'ratings.auto_approve_threshold': response?.data?.auto_approve_threshold || 4,\r\n      };\r\n\r\n      return {\r\n        status: 'success',\r\n        data: config\r\n      };\r\n    } catch (error) {\r\n      console.error('Error getting rating configs:', error);\r\n      return {\r\n        status: 'error',\r\n        message: 'Error al obtener configuraciones de calificaciones'\r\n      };\r\n    }\r\n  }\r\n\r\n  async updateRatingConfigs(config: RatingConfig): Promise<ConfigurationResponse<RatingConfig>> {\r\n    try {\r\n      await ApiClient.post(API_ENDPOINTS.ADMIN.CONFIGURATIONS.RATINGS, config);\r\n\r\n      // ✅ INVALIDAR CACHE para propagar cambios inmediatamente\r\n      ConfigurationManager.getInstance().invalidateCache();\r\n\r\n      return {\r\n        status: 'success',\r\n        data: config,\r\n        message: 'Configuración de calificaciones actualizada'\r\n      };\r\n    } catch (error) {\r\n      console.error('Error updating rating configs:', error);\r\n      return {\r\n        status: 'error',\r\n        message: 'Error al actualizar configuraciones de calificaciones'\r\n      };\r\n    }\r\n  }\r\n\r\n  // 🔧 VOLUME DISCOUNT CONFIGURATIONS (requerido por VolumeDiscountManager)\r\n  async getVolumeDiscountConfigs(): Promise<ConfigurationResponse<VolumeDiscountConfig>> {\r\n    try {\r\n      const response: any = await ApiClient.get(API_ENDPOINTS.ADMIN.VOLUME_DISCOUNTS.CONFIGURATION);\r\n      \r\n      const config: VolumeDiscountConfig = {\r\n        enabled: response?.data?.enabled || true,\r\n        stackable: response?.data?.stackable || false,\r\n        default_tiers: response?.data?.default_tiers || [\r\n          { quantity: 3, discount: 5, label: \"3+\" },\r\n          { quantity: 5, discount: 8, label: \"5+\" },\r\n          { quantity: 10, discount: 15, label: \"10+\" }\r\n        ],\r\n      };\r\n\r\n      return {\r\n        status: 'success',\r\n        data: config\r\n      };\r\n    } catch (error) {\r\n      console.error('Error getting volume discount configs:', error);\r\n      return {\r\n        status: 'error',\r\n        message: 'Error al obtener configuraciones de descuentos por volumen'\r\n      };\r\n    }\r\n  }\r\n\r\n  async updateVolumeDiscountConfigs(config: VolumeDiscountConfig): Promise<ConfigurationResponse<VolumeDiscountConfig>> {\r\n    try {\r\n      await ApiClient.post(API_ENDPOINTS.ADMIN.VOLUME_DISCOUNTS.CONFIGURATION, config);\r\n\r\n      // ✅ INVALIDAR CACHE para propagar cambios inmediatamente\r\n      ConfigurationManager.getInstance().invalidateCache();\r\n\r\n      return {\r\n        status: 'success',\r\n        data: config,\r\n        message: 'Configuración de descuentos por volumen actualizada'\r\n      };\r\n    } catch (error) {\r\n      console.error('Error updating volume discount configs:', error);\r\n      return {\r\n        status: 'error',\r\n        message: 'Error al actualizar configuraciones de descuentos por volumen'\r\n      };\r\n    }\r\n  }\r\n\r\n  // 🔧 RATING STATS AND ADDITIONAL METHODS (requerido por RatingConfiguration)\r\n  async getRatingStats(): Promise<ConfigurationResponse<any>> {\r\n    try {\r\n      const response: any = await ApiClient.get(`${API_ENDPOINTS.ADMIN.CONFIGURATIONS.RATINGS}/stats`);\r\n      \r\n      return {\r\n        status: 'success',\r\n        data: response?.data || {}\r\n      };\r\n    } catch (error) {\r\n      console.error('Error getting rating stats:', error);\r\n      return {\r\n        status: 'error',\r\n        message: 'Error al obtener estadísticas de calificaciones'\r\n      };\r\n    }\r\n  }\r\n\r\n  async approveAllPendingRatings(): Promise<ConfigurationResponse<any>> {\r\n    try {\r\n      const response: any = await ApiClient.post(`${API_ENDPOINTS.ADMIN.CONFIGURATIONS.RATINGS}/approve-all`);\r\n      \r\n      return {\r\n        status: 'success',\r\n        data: response?.data || {},\r\n        message: 'Todas las calificaciones pendientes han sido aprobadas'\r\n      };\r\n    } catch (error) {\r\n      console.error('Error approving pending ratings:', error);\r\n      return {\r\n        status: 'error',\r\n        message: 'Error al aprobar calificaciones pendientes'\r\n      };\r\n    }\r\n  }\r\n}\r\n\r\nexport default ConfigurationService;","import React, { useState, useEffect } from \"react\";\r\nimport { Lock, Save, AlertTriangle, Info, RefreshCw, Shield, Key, Clock } from \"lucide-react\";\r\nimport ConfigurationService, { type SecurityConfig } from \"../../../core/services/ConfigurationService\";\r\n\r\nconst SecurityConfiguration: React.FC = () => {\r\n  const [loading, setLoading] = useState(true);\r\n  const [saving, setSaving] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [success, setSuccess] = useState<string | null>(null);\r\n\r\n  const [config, setConfig] = useState<SecurityConfig>({\r\n    password_rules: {\r\n      min_length: 8,\r\n      require_uppercase: true,\r\n      require_lowercase: true,\r\n      require_numbers: true,\r\n      require_special_chars: true,\r\n    },\r\n    session_timeout: 3600,\r\n    max_login_attempts: 5,\r\n    lockout_duration: 900,\r\n    passwordMinLength: 8,\r\n    passwordRequireSpecial: true,\r\n    passwordRequireUppercase: true,\r\n    passwordRequireNumbers: true,\r\n    accountLockAttempts: 5,\r\n    sessionTimeout: 120,\r\n    enableTwoFactor: false,\r\n    requireEmailVerification: true,\r\n    adminIpRestriction: false,\r\n  });\r\n\r\n  const configService = new ConfigurationService();\r\n\r\n  useEffect(() => {\r\n    loadConfiguration();\r\n  }, []);\r\n\r\n  const loadConfiguration = async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const response = await configService.getSecurityConfigs();\r\n      if (response?.status === \"success\" && response.data) {\r\n        setConfig(response.data);\r\n      } else {\r\n        setError(response?.message || \"No se pudieron cargar las configuraciones\");\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Error al cargar configuraciones de seguridad:\", err);\r\n      setError(\"No se pudieron cargar las configuraciones. Por favor, inténtalo de nuevo.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleConfigChange = (field: keyof SecurityConfig, value: string | number | boolean) => {\r\n    setConfig(prev => ({\r\n      ...prev,\r\n      [field]: value\r\n    }));\r\n  };\r\n\r\n  const saveConfiguration = async () => {\r\n    setSaving(true);\r\n    setError(null);\r\n    setSuccess(null);\r\n\r\n    try {\r\n      const response = await configService.updateSecurityConfigs(config);\r\n      if (response?.status === \"success\") {\r\n        setSuccess(\"Configuración de seguridad guardada correctamente\");\r\n        setTimeout(() => setSuccess(null), 3000);\r\n      } else {\r\n        setError(response?.message || \"Error al guardar la configuración\");\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Error al guardar configuraciones de seguridad:\", err);\r\n      setError(\"No se pudo guardar la configuración. Por favor, inténtalo de nuevo.\");\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  const getPasswordStrengthLevel = () => {\r\n    let score = 0;\r\n    if (Number(config.passwordMinLength) >= 8) score++;\r\n    if (config.passwordRequireSpecial) score++;\r\n    if (config.passwordRequireUppercase) score++;\r\n    if (config.passwordRequireNumbers) score++;\r\n    \r\n    if (score >= 4) return { level: \"Fuerte\", color: \"text-green-600\", bg: \"bg-green-100\" };\r\n    if (score >= 3) return { level: \"Moderada\", color: \"text-yellow-600\", bg: \"bg-yellow-100\" };\r\n    return { level: \"Débil\", color: \"text-red-600\", bg: \"bg-red-100\" };\r\n  };\r\n\r\n  const passwordStrength = getPasswordStrengthLevel();\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex justify-center items-center h-64\">\r\n        <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex justify-between items-center\">\r\n        <div>\r\n          <h2 className=\"text-2xl font-bold text-gray-900 flex items-center\">\r\n            <Lock className=\"w-6 h-6 mr-2\" />\r\n            Configuración de Seguridad\r\n          </h2>\r\n          <p className=\"text-sm text-gray-600 mt-1\">\r\n            Configure las políticas de seguridad, autenticación y protección del sistema\r\n          </p>\r\n        </div>\r\n        <button\r\n          onClick={loadConfiguration}\r\n          className=\"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 flex items-center\"\r\n          disabled={loading}\r\n        >\r\n          <RefreshCw size={18} className={`mr-2 ${loading ? \"animate-spin\" : \"\"}`} />\r\n          Actualizar\r\n        </button>\r\n      </div>\r\n\r\n      {/* Mensajes de estado */}\r\n      {error && (\r\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\r\n          <div className=\"flex items-center\">\r\n            <AlertTriangle className=\"h-5 w-5 text-red-500 mr-2\" />\r\n            <p className=\"text-red-700\">{error}</p>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {success && (\r\n        <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center mr-2\">\r\n              <div className=\"w-2 h-2 bg-white rounded-full\"></div>\r\n            </div>\r\n            <p className=\"text-green-700\">{success}</p>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Panel de información */}\r\n      <div className=\"bg-primary-50 border border-primary-200 rounded-lg p-4\">\r\n        <div className=\"flex items-start\">\r\n          <Info className=\"w-5 h-5 text-primary-500 mr-3 mt-1 flex-shrink-0\" />\r\n          <div>\r\n            <h3 className=\"font-medium text-primary-900\">Configuración de Seguridad</h3>\r\n            <p className=\"mt-1 text-primary-800\">\r\n              Estas configuraciones afectan la seguridad de toda la plataforma. Cambios muy restrictivos\r\n              pueden impactar la experiencia del usuario, mientras que configuraciones muy permisivas \r\n              pueden comprometer la seguridad.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n        {/* Políticas de Contraseña */}\r\n        <div className=\"bg-white rounded-lg shadow-sm border p-6\">\r\n          <h3 className=\"text-lg font-medium text-gray-900 mb-4 flex items-center\">\r\n            <Key className=\"w-5 h-5 mr-2\" />\r\n            Políticas de Contraseña\r\n          </h3>\r\n          \r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Longitud mínima de contraseña\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                value={config.passwordMinLength}\r\n                onChange={(e) => {\r\n                  const value = e.target.value;\r\n                  // Permitir vacío o solo números\r\n                  if (value === '' || /^\\d+$/.test(value)) {\r\n                    // Si está vacío, mantener vacío, si no convertir a número\r\n                    handleConfigChange('passwordMinLength', value === '' ? '' : parseInt(value));\r\n                  }\r\n                }}\r\n                onBlur={(e) => {\r\n                  const value = e.target.value;\r\n                  // Al perder el foco, validar rangos y asignar valor por defecto si está vacío\r\n                  if (value === '') {\r\n                    handleConfigChange('passwordMinLength', 6);\r\n                  } else {\r\n                    const numValue = parseInt(value);\r\n                    if (numValue < 6) {\r\n                      handleConfigChange('passwordMinLength', 6);\r\n                    } else if (numValue > 50) {\r\n                      handleConfigChange('passwordMinLength', 50);\r\n                    }\r\n                  }\r\n                }}\r\n                className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500\"\r\n                placeholder=\"6-50\"\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">\r\n                Número mínimo de caracteres requeridos (recomendado: 8+)\r\n              </p>\r\n            </div>\r\n\r\n            <div className=\"space-y-3\">\r\n              <label className=\"flex items-center\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={config.passwordRequireSpecial}\r\n                  onChange={(e) => handleConfigChange('passwordRequireSpecial', e.target.checked)}\r\n                  className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"\r\n                />\r\n                <span className=\"ml-2 text-sm text-gray-700\">\r\n                  Requerir caracteres especiales (!@#$%^&*)\r\n                </span>\r\n              </label>\r\n              \r\n              <label className=\"flex items-center\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={config.passwordRequireUppercase}\r\n                  onChange={(e) => handleConfigChange('passwordRequireUppercase', e.target.checked)}\r\n                  className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"\r\n                />\r\n                <span className=\"ml-2 text-sm text-gray-700\">\r\n                  Requerir letras mayúsculas (A-Z)\r\n                </span>\r\n              </label>\r\n              \r\n              <label className=\"flex items-center\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={config.passwordRequireNumbers}\r\n                  onChange={(e) => handleConfigChange('passwordRequireNumbers', e.target.checked)}\r\n                  className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"\r\n                />\r\n                <span className=\"ml-2 text-sm text-gray-700\">\r\n                  Requerir números (0-9)\r\n                </span>\r\n              </label>\r\n            </div>\r\n\r\n            {/* Indicador de fortaleza */}\r\n            <div className={`p-3 rounded-lg ${passwordStrength.bg}`}>\r\n              <div className=\"flex items-center\">\r\n                <Shield className={`w-4 h-4 mr-2 ${passwordStrength.color}`} />\r\n                <span className={`text-sm font-medium ${passwordStrength.color}`}>\r\n                  Seguridad de contraseña: {passwordStrength.level}\r\n                </span>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Autenticación y Sesiones */}\r\n        <div className=\"bg-white rounded-lg shadow-sm border p-6\">\r\n          <h3 className=\"text-lg font-medium text-gray-900 mb-4 flex items-center\">\r\n            <Clock className=\"w-5 h-5 mr-2\" />\r\n            Autenticación y Sesiones\r\n          </h3>\r\n          \r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Intentos fallidos antes de bloqueo\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                value={config.accountLockAttempts}\r\n                onChange={(e) => {\r\n                  const value = e.target.value;\r\n                  // Permitir vacío o solo números\r\n                  if (value === '' || /^\\d+$/.test(value)) {\r\n                    handleConfigChange('accountLockAttempts', value === '' ? '' : parseInt(value));\r\n                  }\r\n                }}\r\n                onBlur={(e) => {\r\n                  const value = e.target.value;\r\n                  // Al perder el foco, validar rangos y asignar valor por defecto si está vacío\r\n                  if (value === '') {\r\n                    handleConfigChange('accountLockAttempts', 3);\r\n                  } else {\r\n                    const numValue = parseInt(value);\r\n                    if (numValue < 3) {\r\n                      handleConfigChange('accountLockAttempts', 3);\r\n                    } else if (numValue > 10) {\r\n                      handleConfigChange('accountLockAttempts', 10);\r\n                    }\r\n                  }\r\n                }}\r\n                className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500\"\r\n                placeholder=\"3-10\"\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">\r\n                Número de intentos de login fallidos antes de bloquear temporalmente la cuenta\r\n              </p>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Tiempo de sesión (minutos)\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                value={config.sessionTimeout}\r\n                onChange={(e) => {\r\n                  const value = e.target.value;\r\n                  // Permitir vacío o solo números\r\n                  if (value === '' || /^\\d+$/.test(value)) {\r\n                    handleConfigChange('sessionTimeout', value === '' ? '' : parseInt(value));\r\n                  }\r\n                }}\r\n                onBlur={(e) => {\r\n                  const value = e.target.value;\r\n                  // Al perder el foco, validar rangos y asignar valor por defecto si está vacío\r\n                  if (value === '') {\r\n                    handleConfigChange('sessionTimeout', 30);\r\n                  } else {\r\n                    const numValue = parseInt(value);\r\n                    if (numValue < 30) {\r\n                      handleConfigChange('sessionTimeout', 30);\r\n                    } else if (numValue > 480) {\r\n                      handleConfigChange('sessionTimeout', 480);\r\n                    }\r\n                  }\r\n                }}\r\n                className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500\"\r\n                placeholder=\"30-480\"\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">\r\n                Tiempo de inactividad antes de cerrar sesión automáticamente\r\n              </p>\r\n            </div>\r\n\r\n            <div className=\"space-y-3\">\r\n              <label className=\"flex items-center\">\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={config.requireEmailVerification}\r\n                  onChange={(e) => handleConfigChange('requireEmailVerification', e.target.checked)}\r\n                  className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"\r\n                />\r\n                <span className=\"ml-2 text-sm text-gray-700\">\r\n                  Requerir verificación de email\r\n                </span>\r\n              </label>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Información de seguridad */}\r\n      <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-4\">\r\n        <h4 className=\"font-medium text-yellow-900 mb-2\">Recomendaciones de Seguridad</h4>\r\n        <ul className=\"text-sm text-yellow-800 space-y-1\">\r\n          <li>• Use contraseñas de al menos 8 caracteres con caracteres especiales, mayúsculas y números</li>\r\n          <li>• Limite los intentos de login a 5 o menos para prevenir ataques de fuerza bruta</li>\r\n          <li>• Configure sesiones de máximo 240 minutos (4 horas) para cuentas administrativas</li>\r\n          <li>• Habilite la verificación de email para prevenir registros con emails falsos</li>\r\n          <li>• Use restricciones de IP solo si su organización tiene IPs fijas</li>\r\n        </ul>\r\n      </div>\r\n\r\n      {/* Botón guardar */}\r\n      <div className=\"flex justify-end\">\r\n        <button\r\n          onClick={saveConfiguration}\r\n          disabled={saving}\r\n          className=\"flex items-center px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50\"\r\n        >\r\n          <Save size={16} className=\"mr-2\" />\r\n          {saving ? \"Guardando...\" : \"Guardar Configuración\"}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SecurityConfiguration;","import React, { useState, useEffect } from \"react\";\r\nimport { Shield, Save, AlertTriangle, Info, RefreshCw, MessageCircle, Users } from \"lucide-react\";\r\nimport ConfigurationService, { type ModerationConfig } from \"../../../core/services/ConfigurationService\";\r\n\r\nconst ModerationConfiguration: React.FC = () => {\r\n  const [loading, setLoading] = useState(true);\r\n  const [saving, setSaving] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [success, setSuccess] = useState<string | null>(null);\r\n\r\n  const [config, setConfig] = useState<ModerationConfig>({\r\n    auto_approval: true,\r\n    review_threshold: 3,\r\n    enable_user_reports: true,\r\n    auto_suspend_threshold: 5,\r\n    manual_review_required: false,\r\n    userStrikesThreshold: 3,\r\n    contactScorePenalty: 3,\r\n    businessScoreBonus: 15,\r\n    contactPenaltyHeavy: 20,\r\n    minimumContactScore: 8,\r\n    scoreDifferenceThreshold: 5,\r\n    consecutiveNumbersLimit: 7,\r\n    numbersWithContextLimit: 3,\r\n    lowStockThreshold: 5,\r\n  });\r\n\r\n  const configService = new ConfigurationService();\r\n\r\n  useEffect(() => {\r\n    loadConfiguration();\r\n  }, []);\r\n\r\n  const loadConfiguration = async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const response = await configService.getModerationConfigs();\r\n      if (response?.status === \"success\" && response.data) {\r\n        setConfig(response.data);\r\n      } else {\r\n        setError(response?.message || \"No se pudieron cargar las configuraciones\");\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Error al cargar configuraciones de moderación:\", err);\r\n      setError(\"No se pudieron cargar las configuraciones. Por favor, inténtalo de nuevo.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleConfigChange = (field: keyof ModerationConfig, value: number | boolean) => {\r\n    setConfig(prev => ({\r\n      ...prev,\r\n      [field]: value\r\n    }));\r\n  };\r\n\r\n  const saveConfiguration = async () => {\r\n    setSaving(true);\r\n    setError(null);\r\n    setSuccess(null);\r\n\r\n    try {\r\n      const response = await configService.updateModerationConfigs(config);\r\n      if (response?.status === \"success\") {\r\n        setSuccess(\"Configuración de moderación guardada correctamente\");\r\n        setTimeout(() => setSuccess(null), 3000);\r\n      } else {\r\n        setError(response?.message || \"Error al guardar la configuración\");\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Error al guardar configuraciones de moderación:\", err);\r\n      setError(\"No se pudo guardar la configuración. Por favor, inténtalo de nuevo.\");\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex justify-center items-center h-64\">\r\n        <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex justify-between items-center\">\r\n        <div>\r\n          <h2 className=\"text-2xl font-bold text-gray-900 flex items-center\">\r\n            <Shield className=\"w-6 h-6 mr-2\" />\r\n            Configuración de Moderación\r\n          </h2>\r\n          <p className=\"text-sm text-gray-600 mt-1\">\r\n            Configure los parámetros para la moderación automática de mensajes y contenido\r\n          </p>\r\n        </div>\r\n        <button\r\n          onClick={loadConfiguration}\r\n          className=\"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 flex items-center\"\r\n          disabled={loading}\r\n        >\r\n          <RefreshCw size={18} className={`mr-2 ${loading ? \"animate-spin\" : \"\"}`} />\r\n          Actualizar\r\n        </button>\r\n      </div>\r\n\r\n      {/* Mensajes de estado */}\r\n      {error && (\r\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\r\n          <div className=\"flex items-center\">\r\n            <AlertTriangle className=\"h-5 w-5 text-red-500 mr-2\" />\r\n            <p className=\"text-red-700\">{error}</p>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {success && (\r\n        <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center mr-2\">\r\n              <div className=\"w-2 h-2 bg-white rounded-full\"></div>\r\n            </div>\r\n            <p className=\"text-green-700\">{success}</p>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Panel de información */}\r\n      <div className=\"bg-primary-50 border border-primary-200 rounded-lg p-4\">\r\n        <div className=\"flex items-start\">\r\n          <Info className=\"w-5 h-5 text-primary-500 mr-3 mt-1 flex-shrink-0\" />\r\n          <div>\r\n            <h3 className=\"font-medium text-primary-900\">Acerca de la Moderación Automática</h3>\r\n            <p className=\"mt-1 text-primary-800\">\r\n              El sistema analiza automáticamente los mensajes entre usuarios para detectar patrones sospechosos\r\n              como intercambio de información de contacto fuera de la plataforma. Los valores aquí configurados \r\n              determinan la sensibilidad de la detección.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n        {/* Configuración de Usuario */}\r\n        <div className=\"bg-white rounded-lg shadow-sm border p-6\">\r\n          <h3 className=\"text-lg font-medium text-gray-900 mb-4 flex items-center\">\r\n            <Users className=\"w-5 h-5 mr-2\" />\r\n            Sistema de Strikes de Usuario\r\n          </h3>\r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Strikes antes de bloqueo\r\n              </label>\r\n              <input\r\n                type=\"number\"\r\n\t\t\t\t\t\t\t\t\t\t\tonWheel={(e) => e.currentTarget.blur()}\r\n                value={config.userStrikesThreshold}\r\n                onChange={(e) => handleConfigChange('userStrikesThreshold', parseInt(e.target.value))}\r\n                className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500\"\r\n                min=\"1\"\r\n                max=\"10\"\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">\r\n                Número de strikes que puede acumular un usuario antes de ser bloqueado automáticamente\r\n              </p>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Umbral de stock bajo\r\n              </label>\r\n              <input\r\n                type=\"number\"\r\n\t\t\t\t\t\t\t\t\t\t\tonWheel={(e) => e.currentTarget.blur()}\r\n                value={config.lowStockThreshold}\r\n                onChange={(e) => handleConfigChange('lowStockThreshold', parseInt(e.target.value))}\r\n                className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500\"\r\n                min=\"1\"\r\n                max=\"50\"\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">\r\n                Cantidad mínima de productos en stock antes de mostrar aviso de stock bajo\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Configuración de Detección de Contacto */}\r\n        <div className=\"bg-white rounded-lg shadow-sm border p-6\">\r\n          <h3 className=\"text-lg font-medium text-gray-900 mb-4 flex items-center\">\r\n            <MessageCircle className=\"w-5 h-5 mr-2\" />\r\n            Detección de Información de Contacto\r\n          </h3>\r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Penalización por patrones sospechosos\r\n              </label>\r\n              <input\r\n                type=\"number\"\r\n\t\t\t\t\t\t\t\t\t\t\tonWheel={(e) => e.currentTarget.blur()}\r\n                value={config.contactScorePenalty}\r\n                onChange={(e) => handleConfigChange('contactScorePenalty', parseInt(e.target.value))}\r\n                className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500\"\r\n                min=\"1\"\r\n                max=\"20\"\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">\r\n                Puntos añadidos al score de contacto por patrones sospechosos\r\n              </p>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Bonus por indicadores de negocio\r\n              </label>\r\n              <input\r\n                type=\"number\"\r\n\t\t\t\t\t\t\t\t\t\t\tonWheel={(e) => e.currentTarget.blur()}\r\n                value={config.businessScoreBonus}\r\n                onChange={(e) => handleConfigChange('businessScoreBonus', parseInt(e.target.value))}\r\n                className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500\"\r\n                min=\"5\"\r\n                max=\"50\"\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">\r\n                Puntos añadidos al score de negocio cuando se detectan términos comerciales legítimos\r\n              </p>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Penalización fuerte por contacto\r\n              </label>\r\n              <input\r\n                type=\"number\"\r\n\t\t\t\t\t\t\t\t\t\t\tonWheel={(e) => e.currentTarget.blur()}\r\n                value={config.contactPenaltyHeavy}\r\n                onChange={(e) => handleConfigChange('contactPenaltyHeavy', parseInt(e.target.value))}\r\n                className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500\"\r\n                min=\"10\"\r\n                max=\"50\"\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">\r\n                Penalización severa aplicada cuando se detectan indicadores claros de contacto\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Configuración de Scores */}\r\n        <div className=\"bg-white rounded-lg shadow-sm border p-6\">\r\n          <h3 className=\"text-lg font-medium text-gray-900 mb-4\">\r\n            Umbrales de Score\r\n          </h3>\r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Score mínimo de contacto\r\n              </label>\r\n              <input\r\n                type=\"number\"\r\n\t\t\t\t\t\t\t\t\t\t\tonWheel={(e) => e.currentTarget.blur()}\r\n                value={config.minimumContactScore}\r\n                onChange={(e) => handleConfigChange('minimumContactScore', parseInt(e.target.value))}\r\n                className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500\"\r\n                min=\"5\"\r\n                max=\"20\"\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">\r\n                Score mínimo para considerar que un mensaje contiene información de contacto\r\n              </p>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Diferencia de score requerida\r\n              </label>\r\n              <input\r\n                type=\"number\"\r\n\t\t\t\t\t\t\t\t\t\t\tonWheel={(e) => e.currentTarget.blur()}\r\n                value={config.scoreDifferenceThreshold}\r\n                onChange={(e) => handleConfigChange('scoreDifferenceThreshold', parseInt(e.target.value))}\r\n                className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500\"\r\n                min=\"3\"\r\n                max=\"15\"\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">\r\n                Diferencia mínima entre score de contacto y negocio para activar moderación\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Configuración de Números */}\r\n        <div className=\"bg-white rounded-lg shadow-sm border p-6\">\r\n          <h3 className=\"text-lg font-medium text-gray-900 mb-4\">\r\n            Detección de Números\r\n          </h3>\r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Límite de números consecutivos\r\n              </label>\r\n              <input\r\n                type=\"number\"\r\n\t\t\t\t\t\t\t\t\t\t\tonWheel={(e) => e.currentTarget.blur()}\r\n                value={config.consecutiveNumbersLimit}\r\n                onChange={(e) => handleConfigChange('consecutiveNumbersLimit', parseInt(e.target.value))}\r\n                className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500\"\r\n                min=\"5\"\r\n                max=\"15\"\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">\r\n                Número de dígitos consecutivos que activan la detección de teléfonos\r\n              </p>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Números con contexto de contacto\r\n              </label>\r\n              <input\r\n                type=\"number\"\r\n\t\t\t\t\t\t\t\t\t\t\tonWheel={(e) => e.currentTarget.blur()}\r\n                value={config.numbersWithContextLimit}\r\n                onChange={(e) => handleConfigChange('numbersWithContextLimit', parseInt(e.target.value))}\r\n                className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500\"\r\n                min=\"2\"\r\n                max=\"8\"\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">\r\n                Número de dígitos que, junto con palabras de contacto, activan la detección\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Información adicional */}\r\n      <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-4\">\r\n        <h4 className=\"font-medium text-yellow-900 mb-2\">Recomendaciones</h4>\r\n        <ul className=\"text-sm text-yellow-800 space-y-1\">\r\n          <li>• Un número bajo de strikes (1-2) puede ser muy restrictivo para usuarios legítimos</li>\r\n          <li>• Scores altos de penalización pueden generar falsos positivos</li>\r\n          <li>• El bonus de negocio debe ser significativamente mayor que las penalizaciones</li>\r\n          <li>• Ajusta los límites de números según el tipo de productos vendidos</li>\r\n        </ul>\r\n      </div>\r\n\r\n      {/* Botón guardar */}\r\n      <div className=\"flex justify-end\">\r\n        <button\r\n          onClick={saveConfiguration}\r\n          disabled={saving}\r\n          className=\"flex items-center px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50\"\r\n        >\r\n          <Save size={16} className=\"mr-2\" />\r\n          {saving ? \"Guardando...\" : \"Guardar Configuración\"}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ModerationConfiguration;","import {useState, useEffect} from \"react\";\r\nimport {Star, Save, AlertTriangle, Info, RefreshCw} from \"lucide-react\";\r\nimport ConfigurationService from \"../../../core/services/ConfigurationService\";\r\nimport type {\r\n\tRatingStats,\r\n} from \"../../../presentation/types/admin/ratingConfigTypes\";\r\n\r\nconst RatingConfigPage = () => {\r\n\tconst [loading, setLoading] = useState(true);\r\n\tconst [saving, setSaving] = useState(false);\r\n\tconst [error, setError] = useState<string | null>(null);\r\n\tconst [success, setSuccess] = useState<string | null>(null);\r\n\r\n\t// Configuraciones\r\n\tconst [autoApproveAll, setAutoApproveAll] = useState(false);\r\n\tconst [autoApproveThreshold, setAutoApproveThreshold] = useState(2);\r\n\r\n\t// Estadísticas\r\n\tconst [stats, setStats] = useState<RatingStats>({\r\n\t\ttotalCount: 0,\r\n\t\tapprovedCount: 0,\r\n\t\tpendingCount: 0,\r\n\t\trejectedCount: 0,\r\n\t});\r\n\r\n\t// Inicializar el servicio de configuración\r\n\tconst configService = new ConfigurationService();\r\n\r\n\t// Cargar configuraciones al montar\r\n\tuseEffect(() => {\r\n\t\tloadConfigurations();\r\n\t\tloadRatingStats();\r\n\t}, []);\r\n\r\n\t// Cargar configuraciones desde la API\r\n\tconst loadConfigurations = async () => {\r\n\t\tsetLoading(true);\r\n\t\tsetError(null);\r\n\r\n\t\ttry {\r\n\t\t\tconst response = await configService.getRatingConfigs();\r\n\r\n\t\t\tif (response?.status === \"success\" && response.data) {\r\n\t\t\t\t// Extraer configuraciones\r\n\t\t\t\tconst configs = response.data;\r\n\r\n\t\t\t\tsetAutoApproveAll(\r\n\t\t\t\t\tBoolean(configs[\"ratings.auto_approve_all\"] || configs.auto_approve_all) || false\r\n\t\t\t\t);\r\n\r\n\t\t\t\tsetAutoApproveThreshold(\r\n\t\t\t\t\tNumber(configs[\"ratings.auto_approve_threshold\"] || configs.auto_approve_threshold) || 2\r\n\t\t\t\t);\r\n\t\t\t} else {\r\n\t\t\t\t// Si no hay datos o hay un error en la respuesta\r\n\t\t\t\tsetError(\r\n\t\t\t\t\tresponse?.message || \"No se pudieron cargar las configuraciones\"\r\n\t\t\t\t);\r\n\t\t\t\tconsole.warn(\"Respuesta de configuraciones inválida:\", response);\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error(\"Error al cargar configuraciones:\", err);\r\n\t\t\tsetError(\r\n\t\t\t\t\"No se pudieron cargar las configuraciones. Por favor, inténtalo de nuevo.\"\r\n\t\t\t);\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t};\r\n\r\n\t// Cargar estadísticas de valoraciones\r\n\tconst loadRatingStats = async () => {\r\n\t\ttry {\r\n\t\t\tconst response = await configService.getRatingStats();\r\n\r\n\t\t\tif (response?.status === \"success\" && response.data) {\r\n\t\t\t\tsetStats(response.data);\r\n\t\t\t} else {\r\n\t\t\t\tconsole.warn(\"Error al cargar estadísticas:\", response?.message);\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error(\"Error al cargar estadísticas de valoraciones:\", err);\r\n\t\t}\r\n\t};\r\n\r\n\t// Guardar configuraciones\r\n\tconst saveConfigurations = async () => {\r\n\t\tsetSaving(true);\r\n\t\tsetError(null);\r\n\t\tsetSuccess(null);\r\n\r\n\t\ttry {\r\n\t\t\tconst response = await configService.updateRatingConfigs({\r\n\t\t\t\tmin_rating: 1,\r\n\t\t\t\tmax_rating: 5,\r\n\t\t\t\tallow_anonymous: false,\r\n\t\t\t\trequire_purchase: true,\r\n\t\t\t\tenable_reviews: true,\r\n\t\t\t\tauto_publish_reviews: true,\r\n\t\t\t\tauto_approve_all: autoApproveAll,\r\n\t\t\t\tauto_approve_threshold: autoApproveThreshold,\r\n\t\t\t\t'ratings.auto_approve_all': autoApproveAll,\r\n\t\t\t\t'ratings.auto_approve_threshold': autoApproveThreshold,\r\n\t\t\t});\r\n\r\n\t\t\tif (response?.status === \"success\") {\r\n\t\t\t\tsetSuccess(\"Configuraciones guardadas correctamente\");\r\n\t\t\t\t// Actualizar estadísticas después de cambiar configuraciones\r\n\t\t\t\tloadRatingStats();\r\n\t\t\t} else {\r\n\t\t\t\tsetError(response?.message || \"Error al guardar las configuraciones\");\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error(\"Error al guardar configuraciones:\", err);\r\n\t\t\tsetError(\r\n\t\t\t\t\"No se pudieron guardar las configuraciones. Por favor, inténtalo de nuevo.\"\r\n\t\t\t);\r\n\t\t} finally {\r\n\t\t\tsetSaving(false);\r\n\t\t}\r\n\t};\r\n\r\n\t// Aprobar todas las valoraciones pendientes\r\n\tconst approveAllPendingRatings = async () => {\r\n\t\tif (\r\n\t\t\t!confirm(\r\n\t\t\t\t\"¿Estás seguro de que deseas aprobar todas las valoraciones pendientes? Esta acción no se puede deshacer.\"\r\n\t\t\t)\r\n\t\t) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tsetLoading(true);\r\n\t\tsetError(null);\r\n\t\tsetSuccess(null);\r\n\r\n\t\ttry {\r\n\t\t\tconst response = await configService.approveAllPendingRatings();\r\n\r\n\t\t\tif (response?.status === \"success\") {\r\n\t\t\t\tsetSuccess(\r\n\t\t\t\t\t`Se han aprobado ${response.data?.count || 0} valoraciones pendientes`\r\n\t\t\t\t);\r\n\t\t\t\t// Actualizar estadísticas\r\n\t\t\t\tloadRatingStats();\r\n\t\t\t} else {\r\n\t\t\t\tsetError(\r\n\t\t\t\t\tresponse?.message || \"Error al aprobar valoraciones pendientes\"\r\n\t\t\t\t);\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error(\"Error al aprobar valoraciones pendientes:\", err);\r\n\t\t\tsetError(\r\n\t\t\t\t\"No se pudieron aprobar las valoraciones pendientes. Por favor, inténtalo de nuevo.\"\r\n\t\t\t);\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t};\r\n\r\n\treturn (\r\n\t\t<div className=\"space-y-6\">\r\n\t\t\t<div className=\"flex justify-between items-center\">\r\n\t\t\t\t<h1 className=\"text-2xl font-bold text-gray-900\">\r\n\t\t\t\t\tConfiguración de Valoraciones\r\n\t\t\t\t</h1>\r\n\t\t\t\t<button\r\n\t\t\t\t\tonClick={loadConfigurations}\r\n\t\t\t\t\tclassName=\"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 flex items-center\"\r\n\t\t\t\t\tdisabled={loading}\r\n\t\t\t\t>\r\n\t\t\t\t\t<RefreshCw\r\n\t\t\t\t\t\tsize={18}\r\n\t\t\t\t\t\tclassName={`mr-2 ${loading ? \"animate-spin\" : \"\"}`}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\tActualizar\r\n\t\t\t\t</button>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Panel de información */}\r\n\t\t\t<div className=\"bg-primary-50 text-primary-800 p-4 rounded-lg flex items-start\">\r\n\t\t\t\t<Info className=\"w-5 h-5 mr-3 mt-1 flex-shrink-0\" />\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<h3 className=\"font-medium\">Acerca de las valoraciones</h3>\r\n\t\t\t\t\t<p className=\"mt-1\">\r\n\t\t\t\t\t\tConfigura cómo se gestionan las valoraciones de usuarios en la\r\n\t\t\t\t\t\tplataforma. Puedes establecer aprobaciones automáticas basadas en\r\n\t\t\t\t\t\tumbrales de calificación o realizar moderación manual.\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Mensajes de error/éxito */}\r\n\t\t\t{error && (\r\n\t\t\t\t<div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative\">\r\n\t\t\t\t\t<span className=\"block sm:inline\">{error}</span>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{success && (\r\n\t\t\t\t<div className=\"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative\">\r\n\t\t\t\t\t<span className=\"block sm:inline\">{success}</span>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{/* Panel de estadísticas */}\r\n\t\t\t<div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n\t\t\t\t<div className=\"bg-white p-4 rounded-lg shadow-sm\">\r\n\t\t\t\t\t<h3 className=\"text-sm font-medium text-gray-500\">\r\n\t\t\t\t\t\tTotal de valoraciones\r\n\t\t\t\t\t</h3>\r\n\t\t\t\t\t<p className=\"text-2xl font-bold text-gray-900\">\r\n\t\t\t\t\t\t{stats.totalCount}\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"bg-white p-4 rounded-lg shadow-sm\">\r\n\t\t\t\t\t<h3 className=\"text-sm font-medium text-gray-500\">\r\n\t\t\t\t\t\tAprobadas\r\n\t\t\t\t\t</h3>\r\n\t\t\t\t\t<p className=\"text-2xl font-bold text-green-600\">\r\n\t\t\t\t\t\t{stats.approvedCount}\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"bg-white p-4 rounded-lg shadow-sm\">\r\n\t\t\t\t\t<h3 className=\"text-sm font-medium text-gray-500\">\r\n\t\t\t\t\t\tPendientes\r\n\t\t\t\t\t</h3>\r\n\t\t\t\t\t<p className=\"text-2xl font-bold text-yellow-600\">\r\n\t\t\t\t\t\t{stats.pendingCount}\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"bg-white p-4 rounded-lg shadow-sm\">\r\n\t\t\t\t\t<h3 className=\"text-sm font-medium text-gray-500\">\r\n\t\t\t\t\t\tRechazadas\r\n\t\t\t\t\t</h3>\r\n\t\t\t\t\t<p className=\"text-2xl font-bold text-red-600\">\r\n\t\t\t\t\t\t{stats.rejectedCount}\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Configuraciones */}\r\n\t\t\t<div className=\"bg-white rounded-lg shadow-sm\">\r\n\t\t\t\t<div className=\"p-6\">\r\n\t\t\t\t\t<h2 className=\"text-lg font-medium text-gray-900 mb-4\">\r\n\t\t\t\t\t\tConfiguración de Aprobación Automática\r\n\t\t\t\t\t</h2>\r\n\r\n\t\t\t\t\t{/* Aprobación automática de todos los ratings */}\r\n\t\t\t\t\t<div className=\"mb-6\">\r\n\t\t\t\t\t\t<label className=\"flex items-center space-x-3 mb-3\">\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype=\"checkbox\"\r\n\t\t\t\t\t\t\t\tchecked={autoApproveAll}\r\n\t\t\t\t\t\t\t\tonChange={(e) => setAutoApproveAll(e.target.checked)}\r\n\t\t\t\t\t\t\t\tclassName=\"form-checkbox h-5 w-5 text-primary-600 rounded focus:ring-primary-500\"\r\n\t\t\t\t\t\t\t\tdisabled={saving}\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<span className=\"text-gray-900 font-medium\">\r\n\t\t\t\t\t\t\t\tAprobar automáticamente todas las valoraciones\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<p className=\"text-sm text-gray-500 ml-8\">\r\n\t\t\t\t\t\t\tCuando está activado, todas las valoraciones se aprobarán\r\n\t\t\t\t\t\t\tautomáticamente sin moderación. No recomendado para sitios con\r\n\t\t\t\t\t\t\talto tráfico o riesgo de spam.\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Umbral de aprobación automática */}\r\n\t\t\t\t\t<div className={autoApproveAll ? \"opacity-50\" : \"\"}>\r\n\t\t\t\t\t\t<label className=\"block text-gray-700 font-medium mb-2\">\r\n\t\t\t\t\t\t\tUmbral de aprobación automática\r\n\t\t\t\t\t\t</label>\r\n\r\n\t\t\t\t\t\t<div className=\"flex items-center mb-3\">\r\n\t\t\t\t\t\t\t<div className=\"flex-1\">\r\n\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\ttype=\"range\"\r\n\t\t\t\t\t\t\t\t\tmin=\"1\"\r\n\t\t\t\t\t\t\t\t\tmax=\"5\"\r\n\t\t\t\t\t\t\t\t\tstep=\"1\"\r\n\t\t\t\t\t\t\t\t\tvalue={autoApproveThreshold}\r\n\t\t\t\t\t\t\t\t\tonChange={(e) =>\r\n\t\t\t\t\t\t\t\t\t\tsetAutoApproveThreshold(Number(e.target.value))\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\tclassName=\"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer\"\r\n\t\t\t\t\t\t\t\t\tdisabled={autoApproveAll || saving}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t<div className=\"w-16 ml-4 flex space-x-0.5\">\r\n\t\t\t\t\t\t\t\t{[1, 2, 3, 4, 5].map((star) => (\r\n\t\t\t\t\t\t\t\t\t<Star\r\n\t\t\t\t\t\t\t\t\t\tkey={star}\r\n\t\t\t\t\t\t\t\t\t\tsize={16}\r\n\t\t\t\t\t\t\t\t\t\tclassName={`${\r\n\t\t\t\t\t\t\t\t\t\t\tstar <= autoApproveThreshold\r\n\t\t\t\t\t\t\t\t\t\t\t\t? \"text-yellow-400 fill-current\"\r\n\t\t\t\t\t\t\t\t\t\t\t\t: \"text-gray-400\"\r\n\t\t\t\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className=\"flex justify-between text-xs text-gray-500 px-1\">\r\n\t\t\t\t\t\t\t<span>Se requiere moderación: 1-{autoApproveThreshold}</span>\r\n\t\t\t\t\t\t\t<span>Aprobación automática: &gt;{autoApproveThreshold}</span>\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<p className=\"text-sm text-gray-500 mt-3\">\r\n\t\t\t\t\t\t\tLas valoraciones con {autoApproveThreshold} estrellas o menos\r\n\t\t\t\t\t\t\trequerirán aprobación manual. Las valoraciones con más de{\" \"}\r\n\t\t\t\t\t\t\t{autoApproveThreshold} estrellas se aprobarán automáticamente.\r\n\t\t\t\t\t\t</p>\r\n\r\n\t\t\t\t\t\t{autoApproveThreshold < 2 && (\r\n\t\t\t\t\t\t\t<div className=\"mt-3 flex items-start bg-yellow-50 p-3 rounded-md\">\r\n\t\t\t\t\t\t\t\t<AlertTriangle className=\"w-5 h-5 text-yellow-600 mr-2 mt-0.5 flex-shrink-0\" />\r\n\t\t\t\t\t\t\t\t<p className=\"text-sm text-yellow-700\">\r\n\t\t\t\t\t\t\t\t\tUn umbral muy bajo puede permitir valoraciones negativas\r\n\t\t\t\t\t\t\t\t\tautomáticamente. Considera usar un valor de 2 o superior para\r\n\t\t\t\t\t\t\t\t\tuna mejor moderación.\r\n\t\t\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{/* Acciones */}\r\n\t\t\t\t<div className=\"px-6 py-3 bg-gray-50 border-t border-gray-200 rounded-b-lg flex flex-col sm:flex-row gap-3 justify-end\">\r\n\t\t\t\t\t{stats.pendingCount > 0 && (\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\t\tonClick={approveAllPendingRatings}\r\n\t\t\t\t\t\t\tclassName=\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center\"\r\n\t\t\t\t\t\t\tdisabled={loading || saving}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tAprobar las {stats.pendingCount} valoraciones pendientes\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t)}\r\n\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\tonClick={saveConfigurations}\r\n\t\t\t\t\t\tclassName=\"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 flex items-center\"\r\n\t\t\t\t\t\tdisabled={loading || saving}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Save size={18} className=\"mr-2\" />\r\n\t\t\t\t\t\t{saving ? \"Guardando...\" : \"Guardar configuración\"}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default RatingConfigPage;\r\n","// src/presentation/components/admin/VolumeDiscountManager.tsx - CORREGIDO PARA USAR BACKEND\r\nimport React, { useState, useEffect } from \"react\";\r\nimport {\r\n\tSettings,\r\n\tPlus,\r\n\tTrash2,\r\n\tSave,\r\n\tAlertTriangle,\r\n\tRefreshCw\r\n} from \"lucide-react\";\r\nimport ConfigurationService from \"../../../core/services/ConfigurationService\";\r\n\r\n// Tipos para configuración de Volume Discounts\r\ninterface VolumeDiscountTier {\r\n\tquantity: number;\r\n\tdiscount: number;\r\n\tlabel: string;\r\n}\r\n\r\ninterface VolumeDiscountConfig {\r\n\tenabled: boolean;\r\n\tstackable: boolean;\r\n\tshow_savings_message: boolean;\r\n\tdefault_tiers: VolumeDiscountTier[];\r\n}\r\n\r\nconst VolumeDiscountManager: React.FC = () => {\r\n\tconst [loading, setLoading] = useState(false);\r\n\tconst [success, setSuccess] = useState<string | null>(null);\r\n\tconst [error, setError] = useState<string | null>(null);\r\n\r\n\t// Configuración con tipos apropiados\r\n\tconst [config, setConfig] = useState<VolumeDiscountConfig>({\r\n\t\tenabled: true,\r\n\t\tstackable: false,\r\n\t\tshow_savings_message: true,\r\n\t\tdefault_tiers: [\r\n\t\t\t{ quantity: 3, discount: 5, label: \"Descuento 3+\" },\r\n\t\t\t{ quantity: 6, discount: 10, label: \"Descuento 6+\" },\r\n\t\t\t{ quantity: 12, discount: 15, label: \"Descuento 12+\" }\r\n\t\t]\r\n\t});\r\n\r\n\tconst configService = new ConfigurationService();\r\n\r\n\t// Cargar configuración inicial\r\n\tuseEffect(() => {\r\n\t\tloadConfiguration();\r\n\t}, []);\r\n\r\n\tconst loadConfiguration = async () => {\r\n\t\ttry {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\t\t\t\r\n\t\t\tconst response = await configService.getVolumeDiscountConfigs();\r\n\t\t\tif (response.status === 'success' && response.data) {\r\n\t\t\t\tsetConfig(response.data as VolumeDiscountConfig);\r\n\t\t\t} else {\r\n\t\t\t\tconsole.warn(\"No se pudo cargar configuración, usando valores por defecto\");\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error cargando configuración:\", error);\r\n\t\t\tsetError(\"No se pudo cargar la configuración\");\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t};\r\n\r\n\r\n\t// Manejar cambios en los tiers por defecto\r\n\tconst handleDefaultTierChange = (index: number, field: keyof VolumeDiscountTier, value: string | number) => {\r\n\t\tconst newTiers = [...config.default_tiers];\r\n\t\tnewTiers[index] = { ...newTiers[index], [field]: value };\r\n\t\tsetConfig(prev => ({\r\n\t\t\t...prev,\r\n\t\t\tdefault_tiers: newTiers\r\n\t\t}));\r\n\t};\r\n\r\n\t// Agregar nuevo tier por defecto\r\n\tconst addDefaultTier = () => {\r\n\t\tsetConfig(prev => ({\r\n\t\t\t...prev,\r\n\t\t\tdefault_tiers: [\r\n\t\t\t\t...prev.default_tiers,\r\n\t\t\t\t{ quantity: 1, discount: 0, label: \"Nuevo descuento\" }\r\n\t\t\t]\r\n\t\t}));\r\n\t};\r\n\r\n\t// Eliminar tier por defecto\r\n\tconst removeDefaultTier = (index: number) => {\r\n\t\tsetConfig(prev => ({\r\n\t\t\t...prev,\r\n\t\t\tdefault_tiers: prev.default_tiers.filter((_, i) => i !== index)\r\n\t\t}));\r\n\t};\r\n\r\n\t// Guardar configuración\r\n\tconst saveConfiguration = async () => {\r\n\t\ttry {\r\n\t\t\tsetLoading(true);\r\n\t\t\tsetError(null);\r\n\t\t\tsetSuccess(null);\r\n\r\n\t\t\tconst response = await configService.updateVolumeDiscountConfigs(config);\r\n\t\t\tif (response.status === 'success') {\r\n\t\t\t\tsetSuccess(\"Configuración guardada exitosamente\");\r\n\t\t\t\tsetTimeout(() => setSuccess(null), 3000);\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error(response.message || \"No se pudo guardar la configuración\");\r\n\t\t\t}\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error(\"Error guardando configuración:\", error);\r\n\t\t\tsetError(\"Error al guardar la configuración\");\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t};\r\n\r\n\tif (loading && config.default_tiers.length === 3 && config.default_tiers[0].quantity === 3) {\r\n\t\treturn (\r\n\t\t\t<div className=\"flex justify-center items-center h-64\">\r\n\t\t\t\t<div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600\"></div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"space-y-6\">\r\n\t\t\t{/* Mensajes */}\r\n\t\t\t{error && (\r\n\t\t\t\t<div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\r\n\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t<AlertTriangle className=\"h-5 w-5 text-red-500 mr-2\" />\r\n\t\t\t\t\t\t<p className=\"text-red-700\">{error}</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{success && (\r\n\t\t\t\t<div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\r\n\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t<div className=\"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center mr-2\">\r\n\t\t\t\t\t\t\t<div className=\"w-2 h-2 bg-white rounded-full\"></div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<p className=\"text-green-700\">{success}</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{/* Configuración General */}\r\n\t\t\t<div className=\"bg-white rounded-lg shadow-sm border p-6\">\r\n\t\t\t\t<div className=\"flex justify-between items-center mb-6\">\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<h2 className=\"text-xl font-semibold flex items-center\">\r\n\t\t\t\t\t\t\t<Settings className=\"w-5 h-5 mr-2\" />\r\n\t\t\t\t\t\t\tConfiguración de Descuentos por Volumen\r\n\t\t\t\t\t\t</h2>\r\n\t\t\t\t\t\t<p className=\"text-sm text-gray-600 mt-1\">\r\n\t\t\t\t\t\t\tConfigure los descuentos automáticos por cantidad de productos\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\tonClick={loadConfiguration}\r\n\t\t\t\t\t\tclassName=\"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 flex items-center\"\r\n\t\t\t\t\t\tdisabled={loading}\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<RefreshCw size={18} className={`mr-2 ${loading ? \"animate-spin\" : \"\"}`} />\r\n\t\t\t\t\t\tActualizar\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t\t\r\n\t\t\t\t<div className=\"space-y-6\">\r\n\r\n\t\t\t\t\t{/* Niveles de descuento por defecto */}\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<div className=\"flex justify-between items-center mb-4\">\r\n\t\t\t\t\t\t\t<h3 className=\"text-lg font-medium\">Niveles de Descuento por Defecto</h3>\r\n\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\tonClick={addDefaultTier}\r\n\t\t\t\t\t\t\t\tclassName=\"flex items-center px-3 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 text-sm\"\r\n\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t<Plus size={16} className=\"mr-1\" />\r\n\t\t\t\t\t\t\t\tAgregar Nivel\r\n\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t<div className=\"space-y-3\">\r\n\t\t\t\t\t\t\t{config.default_tiers.map((tier, index) => (\r\n\t\t\t\t\t\t\t\t<div key={index} className=\"border rounded-lg p-4 bg-gray-50\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t<label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\tCantidad Mínima\r\n\t\t\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={tier.quantity}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => handleDefaultTierChange(index, 'quantity', parseInt(e.target.value))}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonWheel={(e) => e.currentTarget.blur()}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tmin=\"1\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t<label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\tDescuento (%)\r\n\t\t\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"number\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={tier.discount}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => handleDefaultTierChange(index, 'discount', parseFloat(e.target.value))}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonWheel={(e) => e.currentTarget.blur()}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tmin=\"0\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tmax=\"100\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tstep=\"0.1\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div>\r\n\t\t\t\t\t\t\t\t\t\t\t<label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n\t\t\t\t\t\t\t\t\t\t\t\tEtiqueta\r\n\t\t\t\t\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={tier.label}\r\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => handleDefaultTierChange(index, 'label', e.target.value)}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500\"\r\n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Ej: Descuento 3+\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-end\">\r\n\t\t\t\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => removeDefaultTier(index)}\r\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"w-full text-red-600 hover:text-red-800 flex items-center justify-center p-2 border border-red-300 rounded-md hover:bg-red-50\"\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Trash2 size={16} />\r\n\t\t\t\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\t\t\t{/* Vista previa del descuento */}\r\n\t\t\t\t\t\t\t\t\t<div className=\"mt-3 p-3 bg-white rounded border\">\r\n\t\t\t\t\t\t\t\t\t\t<div className=\"text-sm text-gray-600\">\r\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium\">Vista previa:</span>\r\n\t\t\t\t\t\t\t\t\t\t\t{\" \"}Al comprar {tier.quantity}+ unidades, el cliente obtiene {tier.discount}% de descuento\r\n\t\t\t\t\t\t\t\t\t\t\t{tier.label && (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"ml-2 px-2 py-1 bg-green-100 text-green-800 rounded text-xs\">\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{tier.label}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t{config.default_tiers.length === 0 && (\r\n\t\t\t\t\t\t\t<div className=\"text-center py-8 text-gray-500 border border-dashed border-gray-300 rounded-lg\">\r\n\t\t\t\t\t\t\t\tNo hay niveles de descuento configurados.\r\n\t\t\t\t\t\t\t\t<br />\r\n\t\t\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\t\t\tonClick={addDefaultTier}\r\n\t\t\t\t\t\t\t\t\tclassName=\"mt-2 text-primary-600 hover:text-primary-700 underline\"\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\tAgregar el primer nivel de descuento\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Información adicional */}\r\n\t\t\t\t\t<div className=\"bg-primary-50 border border-primary-200 rounded-lg p-4\">\r\n\t\t\t\t\t\t<h4 className=\"font-medium text-primary-900 mb-2\">Información Importante</h4>\r\n\t\t\t\t\t\t<ul className=\"text-sm text-primary-800 space-y-1\">\r\n\t\t\t\t\t\t\t<li>• Los descuentos se aplican automáticamente cuando el cliente alcanza la cantidad mínima</li>\r\n\t\t\t\t\t\t\t<li>• Solo se aplica el descuento del nivel más alto alcanzado</li>\r\n\t\t\t\t\t\t\t<li>• Los descuentos se calculan sobre el precio base del producto</li>\r\n\t\t\t\t\t\t\t<li>• Las configuraciones se aplican a todos los productos de la tienda</li>\r\n\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Botón guardar */}\r\n\t\t\t\t\t<div className=\"flex justify-end\">\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={saveConfiguration}\r\n\t\t\t\t\t\t\tdisabled={loading}\r\n\t\t\t\t\t\t\tclassName=\"flex items-center px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Save size={16} className=\"mr-2\" />\r\n\t\t\t\t\t\t\t{loading ? \"Guardando...\" : \"Guardar Configuración\"}\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default VolumeDiscountManager;","import React, { useState, useEffect } from \"react\";\r\nimport { Truck, Save, AlertTriangle, Info, RefreshCw, DollarSign, Package } from \"lucide-react\";\r\nimport ConfigurationManager from \"../../../core/services/ConfigurationManager\";\r\nimport ApiClient from \"../../../infrastructure/api/apiClient\";\r\nimport { API_ENDPOINTS } from \"../../../constants/apiEndpoints\";\r\n\r\n// 🎯 JORDAN: Interface compatible mantenida\r\ninterface ShippingConfig {\r\n  enabled: boolean;\r\n  freeThreshold: number;\r\n  defaultCost: number;\r\n}\r\n\r\nconst ShippingConfiguration: React.FC = () => {\r\n  const [loading, setLoading] = useState(true);\r\n  const [saving, setSaving] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [success, setSuccess] = useState<string | null>(null);\r\n\r\n  const [config, setConfig] = useState<ShippingConfig>({\r\n    enabled: true,\r\n    freeThreshold: 50.00,\r\n    defaultCost: 5.00,\r\n  });\r\n\r\n  // 🎯 JORDAN: Usar ConfigurationManager unificado\r\n  const configManager = ConfigurationManager.getInstance();\r\n  \r\n  // No necesitamos contexto complicado\r\n\r\n  useEffect(() => {\r\n    loadConfiguration();\r\n  }, []);\r\n\r\n  const loadConfiguration = async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      // 🎯 JORDAN: Usar ConfigurationManager para obtener configuración unificada\r\n      const configResult = await configManager.getUnifiedConfig();\r\n      const shippingConfig: ShippingConfig = {\r\n        enabled: configResult.config.shipping.enabled,\r\n        freeThreshold: configResult.config.shipping.free_threshold,\r\n        defaultCost: configResult.config.shipping.default_cost\r\n      };\r\n      setConfig(shippingConfig);\r\n    } catch (err) {\r\n      console.error(\"Error al cargar configuraciones de envío:\", err);\r\n      setError(\"No se pudieron cargar las configuraciones. Por favor, inténtalo de nuevo.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleConfigChange = (field: keyof ShippingConfig, value: string | number | boolean) => {\r\n    setConfig(prev => {\r\n      // Si se está deshabilitando el envío, poner valores en 0\r\n      if (field === 'enabled' && value === false) {\r\n        return {\r\n          enabled: false,\r\n          freeThreshold: 0,\r\n          defaultCost: 0\r\n        };\r\n      }\r\n      \r\n      // Si se está habilitando el envío, poner valores por defecto\r\n      if (field === 'enabled' && value === true) {\r\n        return {\r\n          enabled: true,\r\n          freeThreshold: 50.00,\r\n          defaultCost: 5.00\r\n        };\r\n      }\r\n      \r\n      return {\r\n        ...prev,\r\n        [field]: value\r\n      };\r\n    });\r\n  };\r\n\r\n  const saveConfiguration = async () => {\r\n    setSaving(true);\r\n    setError(null);\r\n    setSuccess(null);\r\n\r\n    try {\r\n      // 🎯 JORDAN: Usar endpoint directo para actualizar configuraciones de shipping\r\n      const response = await ApiClient.post<{status: string; message?: string}>(\r\n        API_ENDPOINTS.ADMIN.CONFIGURATIONS.SHIPPING,\r\n        config\r\n      );\r\n      \r\n      if (response?.status === \"success\") {\r\n        setSuccess(\"Configuración de envío guardada correctamente\");\r\n        \r\n        // ✅ INVALIDAR CACHE de ConfigurationManager para forzar actualización\r\n        configManager.invalidateCache();\r\n        \r\n        // ✅ NOTIFICAR A TODAS LAS PESTAÑAS/VENTANAS DEL CAMBIO\r\n        localStorage.setItem('shipping_config_updated', Date.now().toString());\r\n        \r\n        setTimeout(() => setSuccess(null), 3000);\r\n      } else {\r\n        setError(response?.message || \"Error al guardar la configuración\");\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Error al guardar configuraciones de envío:\", err);\r\n      setError(\"No se pudo guardar la configuración. Por favor, inténtalo de nuevo.\");\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex justify-center items-center h-64\">\r\n        <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex justify-between items-center\">\r\n        <div>\r\n          <h2 className=\"text-2xl font-bold text-gray-900 flex items-center\">\r\n            <Truck className=\"w-6 h-6 mr-2\" />\r\n            Configuración de Envíos\r\n          </h2>\r\n          <p className=\"text-sm text-gray-600 mt-1\">\r\n            Configure los parámetros para el cálculo de costos de envío\r\n          </p>\r\n        </div>\r\n        <button\r\n          onClick={loadConfiguration}\r\n          className=\"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 flex items-center\"\r\n          disabled={loading}\r\n        >\r\n          <RefreshCw size={18} className={`mr-2 ${loading ? \"animate-spin\" : \"\"}`} />\r\n          Actualizar\r\n        </button>\r\n      </div>\r\n\r\n      {/* Mensajes de estado */}\r\n      {error && (\r\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\r\n          <div className=\"flex items-center\">\r\n            <AlertTriangle className=\"h-5 w-5 text-red-500 mr-2\" />\r\n            <p className=\"text-red-700\">{error}</p>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {success && (\r\n        <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center mr-2\">\r\n              <div className=\"w-2 h-2 bg-white rounded-full\"></div>\r\n            </div>\r\n            <p className=\"text-green-700\">{success}</p>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Panel de información */}\r\n      <div className=\"bg-primary-50 border border-primary-200 rounded-lg p-4\">\r\n        <div className=\"flex items-start\">\r\n          <Info className=\"w-5 h-5 text-primary-500 mr-3 mt-1 flex-shrink-0\" />\r\n          <div>\r\n            <h3 className=\"font-medium text-primary-900\">Acerca de la Configuración de Envíos</h3>\r\n            <p className=\"mt-1 text-primary-800\">\r\n              Estas configuraciones controlan cómo se calculan los costos de envío en la plataforma.\r\n              El umbral de envío gratis determina el monto mínimo de compra para obtener envío gratuito,\r\n              mientras que el costo por defecto se aplica a todas las compras por debajo de ese umbral.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n        {/* Configuración General */}\r\n        <div className=\"bg-white rounded-lg shadow-sm border p-6\">\r\n          <h3 className=\"text-lg font-medium text-gray-900 mb-4 flex items-center\">\r\n            <Package className=\"w-5 h-5 mr-2\" />\r\n            Configuración General\r\n          </h3>\r\n          <div className=\"space-y-4\">\r\n            <div className=\"flex items-center\">\r\n              <input\r\n                type=\"checkbox\"\r\n                id=\"shippingEnabled\"\r\n                checked={config.enabled}\r\n                onChange={(e) => handleConfigChange('enabled', e.target.checked)}\r\n                className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"\r\n              />\r\n              <label htmlFor=\"shippingEnabled\" className=\"ml-2 block text-sm text-gray-900\">\r\n                Habilitar cálculo de costos de envío\r\n              </label>\r\n            </div>\r\n            <p className=\"text-xs text-gray-500\">\r\n              Cuando está deshabilitado, el envío será GRATIS para todas las compras (promoción temporal)\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Configuración de Costos */}\r\n        <div className=\"bg-white rounded-lg shadow-sm border p-6\">\r\n          <h3 className=\"text-lg font-medium text-gray-900 mb-4 flex items-center\">\r\n            <DollarSign className=\"w-5 h-5 mr-2\" />\r\n            Costos de Envío\r\n          </h3>\r\n          <div className=\"space-y-4\">\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Umbral para envío gratis (USD)\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                value={config.freeThreshold === 0 || config.freeThreshold === null || config.freeThreshold === undefined ? '' : config.freeThreshold}\r\n                onChange={(e) => {\r\n                  const value = e.target.value;\r\n                  // Solo permitir números y punto decimal\r\n                  if (value === '' || /^\\d*\\.?\\d*$/.test(value)) {\r\n                    handleConfigChange('freeThreshold', value === '' ? 0 : parseFloat(value) || 0);\r\n                  }\r\n                }}\r\n                disabled={!config.enabled}\r\n                className={`w-full border rounded-md px-3 py-2 ${\r\n                  config.enabled \r\n                    ? 'border-gray-300 focus:ring-primary-500 focus:border-primary-500' \r\n                    : 'border-gray-200 bg-gray-100 cursor-not-allowed'\r\n                }`}\r\n                placeholder=\"50.00\"\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">\r\n                Monto mínimo de compra para obtener envío gratuito\r\n              </p>\r\n            </div>\r\n\r\n            <div>\r\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\r\n                Costo de envío por defecto (USD)\r\n              </label>\r\n              <input\r\n                type=\"text\"\r\n                value={config.defaultCost === 0 || config.defaultCost === null || config.defaultCost === undefined ? '' : config.defaultCost}\r\n                onChange={(e) => {\r\n                  const value = e.target.value;\r\n                  // Solo permitir números y punto decimal\r\n                  if (value === '' || /^\\d*\\.?\\d*$/.test(value)) {\r\n                    handleConfigChange('defaultCost', value === '' ? 0 : parseFloat(value) || 0);\r\n                  }\r\n                }}\r\n                disabled={!config.enabled}\r\n                className={`w-full border rounded-md px-3 py-2 ${\r\n                  config.enabled \r\n                    ? 'border-gray-300 focus:ring-primary-500 focus:border-primary-500' \r\n                    : 'border-gray-200 bg-gray-100 cursor-not-allowed'\r\n                }`}\r\n                placeholder=\"5.00\"\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">\r\n                Costo aplicado cuando no se alcanza el umbral de envío gratis\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Información adicional */}\r\n      <div className=\"bg-yellow-50 border border-yellow-200 rounded-lg p-4\">\r\n        <h4 className=\"font-medium text-yellow-900 mb-2\">Información Importante</h4>\r\n        <ul className=\"text-sm text-yellow-800 space-y-1\">\r\n          <li>• Los precios están configurados en dólares estadounidenses (USD)</li>\r\n          <li>• El cálculo de envío gratis se basa en el subtotal de la compra (sin impuestos)</li>\r\n          <li>• Si el envío está deshabilitado, no se mostrará información de costos de envío</li>\r\n          <li>• Los cambios se aplicarán inmediatamente a todas las nuevas compras</li>\r\n        </ul>\r\n      </div>\r\n\r\n      {/* Botón guardar */}\r\n      <div className=\"flex justify-end\">\r\n        <button\r\n          onClick={saveConfiguration}\r\n          disabled={saving}\r\n          className=\"flex items-center px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50\"\r\n        >\r\n          <Save size={16} className=\"mr-2\" />\r\n          {saving ? \"Guardando...\" : \"Guardar Configuración\"}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ShippingConfiguration;","import React, { useState, useEffect } from \"react\";\r\nimport { Settings, Save, AlertTriangle, Info, RefreshCw, Code, Shield, Mail, Clock } from \"lucide-react\";\r\nimport ConfigurationService, { type DevelopmentConfig } from \"../../../core/services/ConfigurationService\";\r\n\r\nconst DevelopmentConfiguration: React.FC = () => {\r\n  const [loading, setLoading] = useState(true);\r\n  const [saving, setSaving] = useState(false);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [success, setSuccess] = useState<string | null>(null);\r\n\r\n  const [config, setConfig] = useState<DevelopmentConfig>({\r\n    mode: false,\r\n    allowAdminOnlyAccess: false,\r\n    bypassEmailVerification: true,\r\n    requireEmailVerification: false,\r\n    emailVerificationTimeout: 24,\r\n  });\r\n\r\n  const configService = new ConfigurationService();\r\n\r\n  useEffect(() => {\r\n    loadConfiguration();\r\n  }, []);\r\n\r\n  const loadConfiguration = async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n\r\n    try {\r\n      const response = await configService.getDevelopmentConfigs();\r\n      if (response?.status === \"success\" && response.data) {\r\n        setConfig(response.data);\r\n      } else {\r\n        setError(response?.message || \"No se pudieron cargar las configuraciones\");\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Error al cargar configuraciones de desarrollo:\", err);\r\n      setError(\"No se pudieron cargar las configuraciones. Por favor, inténtalo de nuevo.\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleConfigChange = (field: keyof DevelopmentConfig, value: string | number | boolean) => {\r\n    setConfig(prev => ({\r\n      ...prev,\r\n      [field]: value\r\n    }));\r\n  };\r\n\r\n  const saveConfiguration = async () => {\r\n    setSaving(true);\r\n    setError(null);\r\n    setSuccess(null);\r\n\r\n    try {\r\n      const response = await configService.updateDevelopmentConfigs(config);\r\n      if (response?.status === \"success\") {\r\n        setSuccess(\"Configuración de desarrollo guardada correctamente\");\r\n        setTimeout(() => setSuccess(null), 3000);\r\n      } else {\r\n        setError(response?.message || \"Error al guardar la configuración\");\r\n      }\r\n    } catch (err) {\r\n      console.error(\"Error al guardar configuraciones de desarrollo:\", err);\r\n      setError(\"No se pudo guardar la configuración. Por favor, inténtalo de nuevo.\");\r\n    } finally {\r\n      setSaving(false);\r\n    }\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"flex justify-center items-center h-64\">\r\n        <div className=\"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600\"></div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <div className=\"flex justify-between items-center\">\r\n        <div>\r\n          <h2 className=\"text-2xl font-bold text-gray-900 flex items-center\">\r\n            <Code className=\"w-6 h-6 mr-2\" />\r\n            Configuración de Desarrollo\r\n          </h2>\r\n          <p className=\"text-sm text-gray-600 mt-1\">\r\n            Configure parámetros para desarrollo, mantenimiento y verificación de email\r\n          </p>\r\n        </div>\r\n        <button\r\n          onClick={loadConfiguration}\r\n          className=\"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 flex items-center\"\r\n          disabled={loading}\r\n        >\r\n          <RefreshCw size={18} className={`mr-2 ${loading ? \"animate-spin\" : \"\"}`} />\r\n          Actualizar\r\n        </button>\r\n      </div>\r\n\r\n      {/* Mensajes de estado */}\r\n      {error && (\r\n        <div className=\"bg-red-50 border border-red-200 rounded-lg p-4\">\r\n          <div className=\"flex items-center\">\r\n            <AlertTriangle className=\"h-5 w-5 text-red-500 mr-2\" />\r\n            <p className=\"text-red-700\">{error}</p>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {success && (\r\n        <div className=\"bg-green-50 border border-green-200 rounded-lg p-4\">\r\n          <div className=\"flex items-center\">\r\n            <div className=\"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center mr-2\">\r\n              <div className=\"w-2 h-2 bg-white rounded-full\"></div>\r\n            </div>\r\n            <p className=\"text-green-700\">{success}</p>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Panel de advertencia */}\r\n      <div className=\"bg-amber-50 border border-amber-200 rounded-lg p-4\">\r\n        <div className=\"flex items-start\">\r\n          <AlertTriangle className=\"w-5 h-5 text-amber-500 mr-3 mt-1 flex-shrink-0\" />\r\n          <div>\r\n            <h3 className=\"font-medium text-amber-900\">¡Configuraciones Críticas!</h3>\r\n            <p className=\"mt-1 text-amber-800\">\r\n              Estas configuraciones afectan la seguridad y funcionalidad del sistema. \r\n              Solo modifícalas durante actualizaciones, mantenimiento o desarrollo.\r\n            </p>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n        {/* Configuración de Desarrollo */}\r\n        <div className=\"bg-white rounded-lg shadow-sm border p-6\">\r\n          <h3 className=\"text-lg font-medium text-gray-900 mb-4 flex items-center\">\r\n            <Settings className=\"w-5 h-5 mr-2\" />\r\n            Modo Desarrollo\r\n          </h3>\r\n          <div className=\"space-y-4\">\r\n            <div className=\"flex items-center\">\r\n              <input\r\n                type=\"checkbox\"\r\n                id=\"developmentMode\"\r\n                checked={config.mode}\r\n                onChange={(e) => handleConfigChange('mode', e.target.checked)}\r\n                className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"\r\n              />\r\n              <label htmlFor=\"developmentMode\" className=\"ml-2 block text-sm text-gray-900\">\r\n                Activar modo desarrollo\r\n              </label>\r\n            </div>\r\n            <p className=\"text-xs text-gray-500\">\r\n              Habilita funciones especiales para desarrolladores y actualizaciones del sistema\r\n            </p>\r\n\r\n            <div className=\"flex items-center\">\r\n              <input\r\n                type=\"checkbox\"\r\n                id=\"adminOnlyAccess\"\r\n                checked={config.allowAdminOnlyAccess}\r\n                onChange={(e) => handleConfigChange('allowAdminOnlyAccess', e.target.checked)}\r\n                className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"\r\n              />\r\n              <label htmlFor=\"adminOnlyAccess\" className=\"ml-2 block text-sm text-gray-900\">\r\n                Restringir acceso solo a administradores\r\n              </label>\r\n            </div>\r\n            <p className=\"text-xs text-gray-500\">\r\n              Cuando está activo, solo los administradores pueden acceder al sistema\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Configuración de Email */}\r\n        <div className=\"bg-white rounded-lg shadow-sm border p-6\">\r\n          <h3 className=\"text-lg font-medium text-gray-900 mb-4 flex items-center\">\r\n            <Mail className=\"w-5 h-5 mr-2\" />\r\n            Verificación de Email\r\n          </h3>\r\n          <div className=\"space-y-4\">\r\n            <div className=\"flex items-center\">\r\n              <input\r\n                type=\"checkbox\"\r\n                id=\"bypassEmailVerification\"\r\n                checked={config.bypassEmailVerification}\r\n                onChange={(e) => handleConfigChange('bypassEmailVerification', e.target.checked)}\r\n                className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"\r\n              />\r\n              <label htmlFor=\"bypassEmailVerification\" className=\"ml-2 block text-sm text-gray-900\">\r\n                Bypass verificación de email (Desarrollo)\r\n              </label>\r\n            </div>\r\n            <p className=\"text-xs text-gray-500\">\r\n              Los usuarios se activan automáticamente sin verificar email\r\n            </p>\r\n\r\n            <div className=\"flex items-center\">\r\n              <input\r\n                type=\"checkbox\"\r\n                id=\"requireEmailVerification\"\r\n                checked={config.requireEmailVerification}\r\n                onChange={(e) => handleConfigChange('requireEmailVerification', e.target.checked)}\r\n                className=\"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\"\r\n              />\r\n              <label htmlFor=\"requireEmailVerification\" className=\"ml-2 block text-sm text-gray-900\">\r\n                Requerir verificación de email\r\n              </label>\r\n            </div>\r\n            <p className=\"text-xs text-gray-500\">\r\n              Los usuarios deben verificar su email antes de acceder al sistema\r\n            </p>\r\n\r\n            <div>\r\n              <label className=\" text-sm font-medium text-gray-700 mb-2 flex items-center\">\r\n                <Clock className=\"w-4 h-4 mr-1\" />\r\n                Timeout de verificación (horas)\r\n              </label>\r\n              <input\r\n                type=\"number\"\r\n\t\t\t\t\t\t\t\t\t\t\tonWheel={(e) => e.currentTarget.blur()}\r\n                value={config.emailVerificationTimeout}\r\n                onChange={(e) => handleConfigChange('emailVerificationTimeout', parseInt(e.target.value))}\r\n                className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500\"\r\n                min=\"1\"\r\n                max=\"168\"\r\n              />\r\n              <p className=\"text-xs text-gray-500 mt-1\">\r\n                Tiempo límite para que el usuario verifique su email\r\n              </p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Información adicional */}\r\n      <div className=\"bg-primary-50 border border-primary-200 rounded-lg p-4\">\r\n        <div className=\"flex items-start\">\r\n          <Info className=\"w-5 h-5 text-primary-500 mr-3 mt-1 flex-shrink-0\" />\r\n          <div>\r\n            <h4 className=\"font-medium text-primary-900 mb-2\">Configuraciones Recomendadas</h4>\r\n            <ul className=\"text-sm text-primary-800 space-y-1\">\r\n              <li><strong>Desarrollo:</strong> Bypass email ON, Verificación OFF</li>\r\n              <li><strong>Testing:</strong> Bypass email ON, Verificación ON (para probar flujo)</li>\r\n              <li><strong>Producción:</strong> Bypass email OFF, Verificación ON</li>\r\n              <li><strong>Mantenimiento:</strong> Admin Only Access ON</li>\r\n            </ul>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Estado actual */}\r\n      <div className=\"bg-gray-50 border border-gray-200 rounded-lg p-4\">\r\n        <h4 className=\"font-medium text-gray-900 mb-3 flex items-center\">\r\n          <Shield className=\"w-4 h-4 mr-2\" />\r\n          Estado Actual del Sistema\r\n        </h4>\r\n        <div className=\"grid grid-cols-2 gap-4 text-sm\">\r\n          <div>\r\n            <span className=\"text-gray-600\">Modo Desarrollo:</span>\r\n            <span className={`ml-2 px-2 py-1 rounded text-xs ${config.mode ? 'bg-yellow-100 text-yellow-800' : 'bg-green-100 text-green-800'}`}>\r\n              {config.mode ? 'Activo' : 'Inactivo'}\r\n            </span>\r\n          </div>\r\n          <div>\r\n            <span className=\"text-gray-600\">Solo Administradores:</span>\r\n            <span className={`ml-2 px-2 py-1 rounded text-xs ${config.allowAdminOnlyAccess ? 'bg-red-100 text-red-800' : 'bg-green-100 text-green-800'}`}>\r\n              {config.allowAdminOnlyAccess ? 'Activo' : 'Inactivo'}\r\n            </span>\r\n          </div>\r\n          <div>\r\n            <span className=\"text-gray-600\">Bypass Email:</span>\r\n            <span className={`ml-2 px-2 py-1 rounded text-xs ${config.bypassEmailVerification ? 'bg-yellow-100 text-yellow-800' : 'bg-primary-100 text-primary-800'}`}>\r\n              {config.bypassEmailVerification ? 'Activo' : 'Inactivo'}\r\n            </span>\r\n          </div>\r\n          <div>\r\n            <span className=\"text-gray-600\">Verificación Requerida:</span>\r\n            <span className={`ml-2 px-2 py-1 rounded text-xs ${config.requireEmailVerification ? 'bg-primary-100 text-primary-800' : 'bg-gray-100 text-gray-800'}`}>\r\n              {config.requireEmailVerification ? 'Sí' : 'No'}\r\n            </span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Botón guardar */}\r\n      <div className=\"flex justify-end\">\r\n        <button\r\n          onClick={saveConfiguration}\r\n          disabled={saving}\r\n          className=\"flex items-center px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50\"\r\n        >\r\n          <Save size={16} className=\"mr-2\" />\r\n          {saving ? \"Guardando...\" : \"Guardar Configuración\"}\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default DevelopmentConfiguration;","import React, { useState, useEffect } from 'react';\r\nimport { Save, DollarSign, TrendingUp, Shield, AlertTriangle, RefreshCw } from 'lucide-react';\r\nimport apiClient from '@/infrastructure/api/apiClient';\r\nimport { API_ENDPOINTS } from '@/constants/apiEndpoints';\r\n\r\ninterface FinancialConfig {\r\n\tplatform_commission_rate: string;\r\n\tshipping_seller_percentage: string;\r\n\tshipping_max_seller_percentage: string;\r\n}\r\n\r\n/**\r\n * Componente para configuraciones financieras críticas del sistema\r\n * Maneja comisiones de plataforma y porcentajes de envío\r\n */\r\nconst FinancialConfiguration: React.FC = () => {\r\n\tconst [loading, setLoading] = useState(true);\r\n\tconst [saving, setSaving] = useState(false);\r\n\tconst [error, setError] = useState<string | null>(null);\r\n\tconst [success, setSuccess] = useState<string | null>(null);\r\n\r\n\tconst [config, setConfig] = useState<FinancialConfig>({\r\n\t\tplatform_commission_rate: '10.0',\r\n\t\tshipping_seller_percentage: '80.0',\r\n\t\tshipping_max_seller_percentage: '40.0',\r\n\t});\r\n\r\n\tconst [originalConfig, setOriginalConfig] = useState<FinancialConfig>({\r\n\t\tplatform_commission_rate: '10.0',\r\n\t\tshipping_seller_percentage: '80.0',\r\n\t\tshipping_max_seller_percentage: '40.0',\r\n\t});\r\n\r\n\tuseEffect(() => {\r\n\t\tloadConfiguration();\r\n\t}, []);\r\n\r\n\tconst loadConfiguration = async () => {\r\n\t\tsetLoading(true);\r\n\t\tsetError(null);\r\n\r\n\t\ttry {\r\n\t\t\tconsole.log('📊 Cargando configuraciones financieras...');\r\n\t\t\t\r\n\t\t\t// Usar el endpoint correcto para configuraciones financieras\r\n\t\t\tconst response = await apiClient.get(API_ENDPOINTS.ADMIN.CONFIGURATIONS.FINANCIAL);\r\n\t\t\t\r\n\t\t\tconsole.log('✅ Respuesta del servidor:', response);\r\n\r\n\t\t\t// Verificar si la respuesta es válida\r\n\t\t\tif (response && typeof response === 'object') {\r\n\t\t\t\tconst responseData = response as any;\r\n\t\t\t\tconst loadedConfig = {\r\n\t\t\t\t\tplatform_commission_rate: String(responseData.platform_commission_rate || '10.0'),\r\n\t\t\t\t\tshipping_seller_percentage: String(responseData.shipping_seller_percentage || '80.0'),\r\n\t\t\t\t\tshipping_max_seller_percentage: String(responseData.shipping_max_seller_percentage || '40.0'),\r\n\t\t\t\t};\r\n\r\n\t\t\t\tsetConfig(loadedConfig);\r\n\t\t\t\tsetOriginalConfig(loadedConfig);\r\n\t\t\t\tconsole.log('✅ Configuraciones cargadas:', loadedConfig);\r\n\t\t\t} else {\r\n\t\t\t\tthrow new Error('Respuesta inválida del servidor');\r\n\t\t\t}\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error('❌ Error loading financial configurations:', err);\r\n\t\t\tsetError('No se pudieron cargar las configuraciones financieras. Usando valores por defecto.');\r\n\t\t\t\r\n\t\t\t// Si hay error, usar valores por defecto\r\n\t\t\tconst defaultConfig = {\r\n\t\t\t\tplatform_commission_rate: '10.0',\r\n\t\t\t\tshipping_seller_percentage: '80.0',\r\n\t\t\t\tshipping_max_seller_percentage: '40.0',\r\n\t\t\t};\r\n\t\t\t\r\n\t\t\tsetConfig(defaultConfig);\r\n\t\t\tsetOriginalConfig(defaultConfig);\r\n\t\t} finally {\r\n\t\t\tsetLoading(false);\r\n\t\t}\r\n\t};\r\n\r\n\tconst handleConfigChange = (field: keyof FinancialConfig, value: string) => {\r\n\t\t// Limpiar caracteres no válidos (solo números, punto decimal)\r\n\t\tconst sanitizedValue = value.replace(/[^0-9.]/g, '');\r\n\t\t\r\n\t\t// Verificar que no haya más de un punto decimal\r\n\t\tconst parts = sanitizedValue.split('.');\r\n\t\tif (parts.length > 2) return;\r\n\t\t\r\n\t\t// Limitar decimales a 2 dígitos\r\n\t\tif (parts.length === 2 && parts[1].length > 2) return;\r\n\r\n\t\tsetConfig(prev => ({\r\n\t\t\t...prev,\r\n\t\t\t[field]: sanitizedValue\r\n\t\t}));\r\n\r\n\t\t// Limpiar mensajes de error\r\n\t\tsetError(null);\r\n\t};\r\n\r\n\tconst validateConfiguration = (): string | null => {\r\n\t\tconst platformCommission = parseFloat(config.platform_commission_rate);\r\n\t\tconst singleSellerPercentage = parseFloat(config.shipping_seller_percentage);\r\n\t\tconst maxSellerPercentage = parseFloat(config.shipping_max_seller_percentage);\r\n\r\n\t\t// Validar que sean números válidos\r\n\t\tif (isNaN(platformCommission) || isNaN(singleSellerPercentage) || isNaN(maxSellerPercentage)) {\r\n\t\t\treturn 'Todos los campos deben contener números válidos';\r\n\t\t}\r\n\r\n\t\t// Validar rangos\r\n\t\tif (platformCommission < 0 || platformCommission > 50) {\r\n\t\t\treturn 'La comisión de plataforma debe estar entre 0% y 50%';\r\n\t\t}\r\n\r\n\t\tif (singleSellerPercentage < 0 || singleSellerPercentage > 100) {\r\n\t\t\treturn 'El porcentaje de envío para un vendedor debe estar entre 0% y 100%';\r\n\t\t}\r\n\r\n\t\tif (maxSellerPercentage < 0 || maxSellerPercentage > 100) {\r\n\t\t\treturn 'El porcentaje máximo de envío debe estar entre 0% y 100%';\r\n\t\t}\r\n\r\n\t\t// Validar lógica de negocio\r\n\t\tif (maxSellerPercentage >= singleSellerPercentage) {\r\n\t\t\treturn 'El porcentaje máximo debe ser menor al porcentaje para un vendedor';\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\t};\r\n\r\n\tconst saveConfiguration = async () => {\r\n\t\tconst validationError = validateConfiguration();\r\n\t\tif (validationError) {\r\n\t\t\tsetError(validationError);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tsetSaving(true);\r\n\t\tsetError(null);\r\n\t\tsetSuccess(null);\r\n\r\n\t\ttry {\r\n\t\t\tconsole.log('💾 Guardando configuraciones financieras...');\r\n\r\n\t\t\t// Preparar datos para envío\r\n\t\t\tconst configToSave = {\r\n\t\t\t\tplatform_commission_rate: parseFloat(config.platform_commission_rate),\r\n\t\t\t\tshipping_seller_percentage: parseFloat(config.shipping_seller_percentage),\r\n\t\t\t\tshipping_max_seller_percentage: parseFloat(config.shipping_max_seller_percentage),\r\n\t\t\t};\r\n\r\n\t\t\tconst response = await apiClient.put(API_ENDPOINTS.ADMIN.CONFIGURATIONS.FINANCIAL, configToSave);\r\n\r\n\t\t\tconsole.log('✅ Configuraciones guardadas:', response);\r\n\r\n\t\t\t// Actualizar estado original\r\n\t\t\tsetOriginalConfig(config);\r\n\t\t\tsetSuccess('Configuraciones guardadas exitosamente');\r\n\t\t\t\r\n\t\t\t// Limpiar mensaje de éxito después de 3 segundos\r\n\t\t\tsetTimeout(() => setSuccess(null), 3000);\r\n\r\n\t\t} catch (err) {\r\n\t\t\tconsole.error('❌ Error al guardar configuraciones:', err);\r\n\t\t\tsetError('Error al guardar las configuraciones. Por favor, inténtalo de nuevo.');\r\n\t\t} finally {\r\n\t\t\tsetSaving(false);\r\n\t\t}\r\n\t};\r\n\r\n\tconst hasChanges = () => {\r\n\t\treturn JSON.stringify(config) !== JSON.stringify(originalConfig);\r\n\t};\r\n\r\n\tif (loading) {\r\n\t\treturn (\r\n\t\t\t<div className=\"flex items-center justify-center py-12\">\r\n\t\t\t\t<RefreshCw className=\"animate-spin h-8 w-8 text-primary-600 mr-3\" />\r\n\t\t\t\t<span className=\"text-gray-600\">Cargando configuraciones financieras...</span>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"space-y-6\">\r\n\t\t\t{/* Encabezado */}\r\n\t\t\t<div className=\"bg-white border border-gray-200 rounded-lg shadow-sm p-6\">\r\n\t\t\t\t<div className=\"flex items-center gap-3 mb-4\">\r\n\t\t\t\t\t<div className=\"p-2 bg-primary-100 rounded-lg\">\r\n\t\t\t\t\t\t<DollarSign className=\"h-6 w-6 text-primary-600\" />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<h3 className=\"text-lg font-semibold text-gray-900\">Configuraciones Financieras</h3>\r\n\t\t\t\t\t\t<p className=\"text-sm text-gray-600\">\r\n\t\t\t\t\t\t\tGestiona las comisiones de la plataforma y distribución de envíos\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{/* Alertas */}\r\n\t\t\t\t{error && (\r\n\t\t\t\t\t<div className=\"mb-4 bg-red-50 border border-red-200 rounded-lg p-4\">\r\n\t\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t\t<AlertTriangle className=\"h-5 w-5 text-red-500 mr-2\" />\r\n\t\t\t\t\t\t\t<p className=\"text-red-700 text-sm\">{error}</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{success && (\r\n\t\t\t\t\t<div className=\"mb-4 bg-green-50 border border-green-200 rounded-lg p-4\">\r\n\t\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t\t<TrendingUp className=\"h-5 w-5 text-green-500 mr-2\" />\r\n\t\t\t\t\t\t\t<p className=\"text-green-700 text-sm font-medium\">{success}</p>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{/* Formulario */}\r\n\t\t\t\t<div className=\"space-y-6\">\r\n\t\t\t\t\t{/* Comisión de Plataforma */}\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<label htmlFor=\"platform_commission_rate\" className=\"flex items-center text-sm font-medium text-gray-700 mb-2\">\r\n\t\t\t\t\t\t\t<Shield className=\"h-4 w-4 text-primary-600 mr-2\" />\r\n\t\t\t\t\t\t\tComisión de Plataforma (%)\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<div className=\"relative\">\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\tid=\"platform_commission_rate\"\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\tvalue={config.platform_commission_rate}\r\n\t\t\t\t\t\t\t\tonChange={(e) => handleConfigChange('platform_commission_rate', e.target.value)}\r\n\t\t\t\t\t\t\t\tclassName=\"w-full px-3 py-2 pr-8 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500\"\r\n\t\t\t\t\t\t\t\tplaceholder=\"10.0\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<div className=\"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none\">\r\n\t\t\t\t\t\t\t\t<span className=\"text-gray-500 text-sm\">%</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<p className=\"mt-1 text-xs text-gray-500\">\r\n\t\t\t\t\t\t\tPorcentaje que la plataforma retiene de cada venta (0% - 50%)\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Envío Vendedor Único */}\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<label htmlFor=\"shipping_seller_percentage\" className=\"flex items-center text-sm font-medium text-gray-700 mb-2\">\r\n\t\t\t\t\t\t\t<TrendingUp className=\"h-4 w-4 text-blue-600 mr-2\" />\r\n\t\t\t\t\t\t\tEnvío Vendedor Único (%)\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<div className=\"relative\">\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\tid=\"shipping_seller_percentage\"\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\tvalue={config.shipping_seller_percentage}\r\n\t\t\t\t\t\t\t\tonChange={(e) => handleConfigChange('shipping_seller_percentage', e.target.value)}\r\n\t\t\t\t\t\t\t\tclassName=\"w-full px-3 py-2 pr-8 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500\"\r\n\t\t\t\t\t\t\t\tplaceholder=\"80.0\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<div className=\"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none\">\r\n\t\t\t\t\t\t\t\t<span className=\"text-gray-500 text-sm\">%</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<p className=\"mt-1 text-xs text-gray-500\">\r\n\t\t\t\t\t\t\tPorcentaje del envío que recibe el vendedor cuando es el único (0% - 100%)\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Envío Máximo Múltiples Vendedores */}\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<label htmlFor=\"shipping_max_seller_percentage\" className=\"flex items-center text-sm font-medium text-gray-700 mb-2\">\r\n\t\t\t\t\t\t\t<TrendingUp className=\"h-4 w-4 text-orange-600 mr-2\" />\r\n\t\t\t\t\t\t\tEnvío Máximo Múltiples Vendedores (%)\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<div className=\"relative\">\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\tid=\"shipping_max_seller_percentage\"\r\n\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\tvalue={config.shipping_max_seller_percentage}\r\n\t\t\t\t\t\t\t\tonChange={(e) => handleConfigChange('shipping_max_seller_percentage', e.target.value)}\r\n\t\t\t\t\t\t\t\tclassName=\"w-full px-3 py-2 pr-8 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500\"\r\n\t\t\t\t\t\t\t\tplaceholder=\"40.0\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t<div className=\"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none\">\r\n\t\t\t\t\t\t\t\t<span className=\"text-gray-500 text-sm\">%</span>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<p className=\"mt-1 text-xs text-gray-500\">\r\n\t\t\t\t\t\t\tPorcentaje máximo del envío por vendedor con múltiples vendedores (0% - 100%)\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t{/* Información de seguridad */}\r\n\t\t\t\t\t<div className=\"bg-amber-50 border border-amber-200 rounded-lg p-4\">\r\n\t\t\t\t\t\t<div className=\"flex items-start gap-3\">\r\n\t\t\t\t\t\t\t<AlertTriangle className=\"h-5 w-5 text-amber-600 mt-0.5 flex-shrink-0\" />\r\n\t\t\t\t\t\t\t<div className=\"text-sm text-amber-800\">\r\n\t\t\t\t\t\t\t\t<p className=\"font-medium mb-2\">⚠️ Configuraciones Críticas</p>\r\n\t\t\t\t\t\t\t\t<ul className=\"list-disc list-inside space-y-1 text-xs\">\r\n\t\t\t\t\t\t\t\t\t<li>Estos cambios afectan todos los cálculos financieros de la plataforma</li>\r\n\t\t\t\t\t\t\t\t\t<li>Recomendamos hacer cambios gradualmente y monitorear los resultados</li>\r\n\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{/* Botones */}\r\n\t\t\t\t<div className=\"mt-6 flex justify-end space-x-3\">\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\tonClick={() => setConfig(originalConfig)}\r\n\t\t\t\t\t\tdisabled={!hasChanges() || saving}\r\n\t\t\t\t\t\tclassName=\"px-4 py-2 border border-gray-300 text-gray-700 bg-white hover:bg-gray-50 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\tCancelar\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button\r\n\t\t\t\t\t\ttype=\"button\"\r\n\t\t\t\t\t\tonClick={saveConfiguration}\r\n\t\t\t\t\t\tdisabled={!hasChanges() || saving}\r\n\t\t\t\t\t\tclassName=\"px-6 py-2 bg-primary-600 text-white hover:bg-primary-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center\"\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t{saving ? (\r\n\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t<RefreshCw className=\"animate-spin h-4 w-4 mr-2\" />\r\n\t\t\t\t\t\t\t\tGuardando...\r\n\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t) : (\r\n\t\t\t\t\t\t\t<>\r\n\t\t\t\t\t\t\t\t<Save className=\"h-4 w-4 mr-2\" />\r\n\t\t\t\t\t\t\t\tGuardar Cambios\r\n\t\t\t\t\t\t\t</>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default FinancialConfiguration;","// src/presentation/pages/admin/AdminSettingsPage.tsx - COMPLETO\r\nimport React, { useState } from \"react\";\r\n// Imports de íconos para todos los tabs\r\nimport {\r\n  Lock,\r\n  Shield,\r\n  Star,\r\n  TrendingDown,\r\n  Truck,\r\n  Code,\r\n  DollarSign,\r\n} from \"lucide-react\";\r\n// Imports de todos los componentes de configuración\r\nimport SecurityConfiguration from \"../../components/admin/SecurityConfiguration\";\r\nimport ModerationConfiguration from \"../../components/admin/ModerationConfiguration\";\r\nimport RatingConfiguration from \"../../components/admin/RatingConfiguration\";\r\nimport VolumeDiscountManager from \"../../components/admin/VolumeDiscountManager\";\r\nimport ShippingConfiguration from \"../../components/admin/ShippingConfiguration\";\r\nimport DevelopmentConfiguration from \"../../components/admin/DevelopmentConfiguration\";\r\nimport FinancialConfiguration from \"../../components/admin/FinancialConfiguration\";\r\n\r\n/**\r\n * Página de configuración del sistema para el panel de administración\r\n */\r\nconst AdminSettingsPage: React.FC = () => {\r\n\t// 🎯 JORDAN: Solo tabs críticos disponibles temporalmente\r\n\tconst [activeTab, setActiveTab] = useState<string>(\"security\");\r\n\t\r\n\t// Estados para mensajes globales (comentados porque no se usan actualmente)\r\n\t// const [success, setSuccess] = useState<string | null>(null);\r\n\t// const [error, setError] = useState<string | null>(null);\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t<h1 className=\"text-2xl font-bold text-gray-900 mb-6\">\r\n\t\t\t\tConfiguración del Sistema\r\n\t\t\t</h1>\r\n\r\n\t\t\t{/* Mensajes globales - comentados porque no se usan actualmente */}\r\n\t\t\t{/* {success && (\r\n\t\t\t\t<div className=\"mb-6 bg-green-50 border border-green-200 rounded-lg p-4\">\r\n\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t<CheckCircle className=\"h-5 w-5 text-green-500 mr-2\" />\r\n\t\t\t\t\t\t<p className=\"text-green-700\">{success}</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\r\n\t\t\t{error && (\r\n\t\t\t\t<div className=\"mb-6 bg-red-50 border border-red-200 rounded-lg p-4\">\r\n\t\t\t\t\t<div className=\"flex items-center\">\r\n\t\t\t\t\t\t<AlertTriangle className=\"h-5 w-5 text-red-500 mr-2\" />\r\n\t\t\t\t\t\t<p className=\"text-red-700\">{error}</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)} */}\r\n\r\n\t\t\t{/* Tabs de navegación */}\r\n\t\t\t<div className=\"mb-6\">\r\n\t\t\t\t<div className=\"border-b border-gray-200\">\r\n\t\t\t\t\t<nav className=\"-mb-px flex space-x-8 overflow-x-auto\">\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={() => setActiveTab(\"security\")}\r\n\t\t\t\t\t\t\tclassName={`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${\r\n\t\t\t\t\t\t\t\tactiveTab === \"security\"\r\n\t\t\t\t\t\t\t\t\t? \"border-primary-500 text-primary-600\"\r\n\t\t\t\t\t\t\t\t\t: \"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300\"\r\n\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Lock className=\"w-5 h-5 inline-block mr-1\" />\r\n\t\t\t\t\t\t\tSeguridad\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={() => setActiveTab(\"moderation\")}\r\n\t\t\t\t\t\t\tclassName={`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${\r\n\t\t\t\t\t\t\t\tactiveTab === \"moderation\"\r\n\t\t\t\t\t\t\t\t\t? \"border-primary-500 text-primary-600\"\r\n\t\t\t\t\t\t\t\t\t: \"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300\"\r\n\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Shield className=\"w-5 h-5 inline-block mr-1\" />\r\n\t\t\t\t\t\t\tModeración\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={() => setActiveTab(\"rating\")}\r\n\t\t\t\t\t\t\tclassName={`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${\r\n\t\t\t\t\t\t\t\tactiveTab === \"rating\"\r\n\t\t\t\t\t\t\t\t\t? \"border-primary-500 text-primary-600\"\r\n\t\t\t\t\t\t\t\t\t: \"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300\"\r\n\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Star className=\"w-5 h-5 inline-block mr-1\" />\r\n\t\t\t\t\t\t\tCalificaciones\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={() => setActiveTab(\"volume_discount\")}\r\n\t\t\t\t\t\t\tclassName={`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${\r\n\t\t\t\t\t\t\t\tactiveTab === \"volume_discount\"\r\n\t\t\t\t\t\t\t\t\t? \"border-primary-500 text-primary-600\"\r\n\t\t\t\t\t\t\t\t\t: \"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300\"\r\n\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<TrendingDown className=\"w-5 h-5 inline-block mr-1\" />\r\n\t\t\t\t\t\t\tDescuentos por Volumen\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={() => setActiveTab(\"shipping\")}\r\n\t\t\t\t\t\t\tclassName={`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${\r\n\t\t\t\t\t\t\t\tactiveTab === \"shipping\"\r\n\t\t\t\t\t\t\t\t\t? \"border-primary-500 text-primary-600\"\r\n\t\t\t\t\t\t\t\t\t: \"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300\"\r\n\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Truck className=\"w-5 h-5 inline-block mr-1\" />\r\n\t\t\t\t\t\t\tEnvíos\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={() => setActiveTab(\"development\")}\r\n\t\t\t\t\t\t\tclassName={`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${\r\n\t\t\t\t\t\t\t\tactiveTab === \"development\"\r\n\t\t\t\t\t\t\t\t\t? \"border-primary-500 text-primary-600\"\r\n\t\t\t\t\t\t\t\t\t: \"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300\"\r\n\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<Code className=\"w-5 h-5 inline-block mr-1\" />\r\n\t\t\t\t\t\t\tDesarrollo\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<button\r\n\t\t\t\t\t\t\tonClick={() => setActiveTab(\"financial\")}\r\n\t\t\t\t\t\t\tclassName={`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${\r\n\t\t\t\t\t\t\t\tactiveTab === \"financial\"\r\n\t\t\t\t\t\t\t\t\t? \"border-primary-500 text-primary-600\"\r\n\t\t\t\t\t\t\t\t\t: \"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300\"\r\n\t\t\t\t\t\t\t}`}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<DollarSign className=\"w-5 h-5 inline-block mr-1\" />\r\n\t\t\t\t\t\t\tFinanciero\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</nav>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\r\n\t\t\t{/* Contenido de las pestañas */}\r\n\t\t\t<div className=\"bg-white rounded-lg shadow-sm\">\r\n\r\n\t\t\t\t{/* Configuración de Seguridad */}\r\n\t\t\t\t{activeTab === \"security\" && (\r\n\t\t\t\t\t<div className=\"p-6\">\r\n\t\t\t\t\t\t<SecurityConfiguration />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{/* Configuración de Moderación */}\r\n\t\t\t\t{activeTab === \"moderation\" && (\r\n\t\t\t\t\t<div className=\"p-6\">\r\n\t\t\t\t\t\t<ModerationConfiguration />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{/* Configuración de Calificaciones */}\r\n\t\t\t\t{activeTab === \"rating\" && (\r\n\t\t\t\t\t<div className=\"p-6\">\r\n\t\t\t\t\t\t<RatingConfiguration />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{/* Configuración de Descuentos por Volumen */}\r\n\t\t\t\t{activeTab === \"volume_discount\" && (\r\n\t\t\t\t\t<div className=\"p-6\">\r\n\t\t\t\t\t\t<VolumeDiscountManager />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{/* Configuración de Envíos */}\r\n\t\t\t\t{activeTab === \"shipping\" && (\r\n\t\t\t\t\t<div className=\"p-6\">\r\n\t\t\t\t\t\t<ShippingConfiguration />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{/* Configuración de Desarrollo */}\r\n\t\t\t\t{activeTab === \"development\" && (\r\n\t\t\t\t\t<div className=\"p-6\">\r\n\t\t\t\t\t\t<DevelopmentConfiguration />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t\t{/* Configuración Financiera */}\r\n\t\t\t\t{activeTab === \"financial\" && (\r\n\t\t\t\t\t<div className=\"p-6\">\r\n\t\t\t\t\t\t<FinancialConfiguration />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t)}\r\n\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t);\r\n};\r\n\r\nexport default AdminSettingsPage;"],"names":["environments","currentEnv","environment","appConfig","id","bind","fn","thisArg","toString","getPrototypeOf","iterator","toStringTag","kindOf","cache","thing","str","kindOfTest","type","typeOfTest","isArray","isUndefined","isBuffer","val","isFunction","isArrayBuffer","isArrayBufferView","result","isString","isNumber","isObject","isBoolean","isPlainObject","prototype","isDate","isFile","isBlob","isFileList","isStream","isFormData","kind","isURLSearchParams","isReadableStream","isRequest","isResponse","isHeaders","trim","forEach","obj","allOwnKeys","i","l","keys","len","key","findKey","_key","_global","isContextDefined","context","merge","caseless","assignValue","targetKey","extend","a","b","stripBOM","content","inherits","constructor","superConstructor","props","descriptors","toFlatObject","sourceObj","destObj","filter","propFilter","prop","merged","endsWith","searchString","position","lastIndex","toArray","arr","isTypedArray","TypedArray","forEachEntry","_iterator","pair","matchAll","regExp","matches","isHTMLForm","toCamelCase","m","p1","p2","hasOwnProperty","isRegExp","reduceDescriptors","reducer","reducedDescriptors","descriptor","name","ret","freezeMethods","value","toObjectSet","arrayOrString","delimiter","define","noop","toFiniteNumber","defaultValue","isSpecCompliantForm","toJSONObject","stack","visit","source","target","reducedValue","isAsyncFn","isThenable","_setImmediate","setImmediateSupported","postMessageSupported","token","callbacks","data","cb","asap","isIterable","utils$1","AxiosError","message","code","config","request","response","utils","error","customProps","axiosError","httpAdapter","isVisitable","removeBrackets","renderKey","path","dots","isFlatArray","predicates","toFormData","formData","options","option","metaTokens","visitor","defaultVisitor","indexes","useBlob","convertValue","el","index","exposedHelpers","build","encode","charMap","match","AxiosURLSearchParams","params","encoder","_encode","buildURL","url","serializeFn","serializedParams","hashmarkIndex","InterceptorManager","fulfilled","rejected","h","transitionalDefaults","URLSearchParams$1","FormData$1","Blob$1","platform$1","URLSearchParams","FormData","Blob","hasBrowserEnv","_navigator","hasStandardBrowserEnv","hasStandardBrowserWebWorkerEnv","origin","platform","toURLEncodedForm","helpers","parsePropPath","arrayToObject","formDataToJSON","buildPath","isNumericKey","isLast","stringifySafely","rawValue","parser","e","defaults","headers","contentType","hasJSONContentType","isObjectPayload","_FormData","transitional","forcedJSONParsing","JSONRequested","strictJSONParsing","status","method","ignoreDuplicateOf","parseHeaders","rawHeaders","parsed","line","$internals","normalizeHeader","header","normalizeValue","parseTokens","tokens","tokensRE","isValidHeaderName","matchHeaderValue","isHeaderNameFilter","formatHeader","w","char","buildAccessors","accessorName","methodName","arg1","arg2","arg3","AxiosHeaders$1","valueOrRewrite","rewrite","self","setHeader","_value","_header","_rewrite","lHeader","setHeaders","dest","entry","matcher","deleted","deleteHeader","format","normalized","targets","asStrings","first","computed","accessors","defineAccessor","AxiosHeaders","mapped","headerValue","transformData","fns","isCancel","CanceledError","settle","resolve","reject","validateStatus","parseProtocol","speedometer","samplesCount","min","bytes","timestamps","head","tail","firstSampleTS","chunkLength","now","startedAt","bytesCount","passed","throttle","freq","timestamp","threshold","lastArgs","timer","invoke","args","progressEventReducer","listener","isDownloadStream","bytesNotified","_speedometer","loaded","total","progressBytes","rate","inRange","progressEventDecorator","throttled","lengthComputable","asyncDecorator","isURLSameOrigin","isMSIE","cookies","expires","domain","secure","cookie","isAbsoluteURL","combineURLs","baseURL","relativeURL","buildFullPath","requestedURL","allowAbsoluteUrls","isRelativeUrl","headersToObject","mergeConfig","config1","config2","getMergedValue","mergeDeepProperties","valueFromConfig2","defaultToConfig2","mergeDirectKeys","mergeMap","configValue","resolveConfig","newConfig","withXSRFToken","xsrfHeaderName","xsrfCookieName","auth","xsrfValue","isXHRAdapterSupported","xhrAdapter","_config","requestData","requestHeaders","responseType","onUploadProgress","onDownloadProgress","onCanceled","uploadThrottled","downloadThrottled","flushUpload","flushDownload","done","onloadend","responseHeaders","err","timeoutErrorMessage","cancel","protocol","composeSignals","signals","timeout","length","controller","aborted","onabort","reason","unsubscribe","signal","streamChunk","chunk","chunkSize","pos","end","readBytes","iterable","readStream","stream","reader","trackStream","onProgress","onFinish","_onFinish","loadedBytes","isFetchSupported","isReadableStreamSupported","encodeText","test","supportsRequestStream","duplexAccessed","hasContentType","DEFAULT_CHUNK_SIZE","supportsResponseStream","resolvers","res","_","getBodyLength","body","resolveBodyLength","fetchAdapter","cancelToken","withCredentials","fetchOptions","composedSignal","requestContentLength","_request","contentTypeHeader","flush","isCredentialsSupported","isStreamResponse","responseContentLength","responseData","knownAdapters","renderReason","isResolvedHandle","adapter","adapters","nameOrAdapter","rejectedReasons","reasons","state","s","throwIfCancellationRequested","dispatchRequest","VERSION","validators","deprecatedWarnings","validator","version","formatMessage","opt","desc","opts","correctSpelling","assertOptions","schema","allowUnknown","Axios$1","instanceConfig","configOrUrl","dummy","paramsSerializer","contextHeaders","requestInterceptorChain","synchronousRequestInterceptors","interceptor","responseInterceptorChain","promise","chain","onFulfilled","onRejected","fullPath","Axios","generateHTTPMethod","isForm","CancelToken$1","CancelToken","executor","resolvePromise","onfulfilled","_resolve","abort","c","spread","callback","isAxiosError","payload","HttpStatusCode","createInstance","defaultConfig","instance","axios","promises","all","Cancel","formToJSON","getAdapter","isRefreshing","refreshSubscribers","subscribeTokenRefresh","onTokenRefreshed","axiosInstance","originalRequest","refreshToken","newToken","refreshError","CacheService","expirationMs","item","fullKey","retryError","itemStr","removeError","items","keysToRemove","expired","active","totalSize","count","toRemove","stats","API_ENDPOINTS","hash","slug","categoryId","sellerId","term","itemId","productId","orderId","trackingNumber","messageId","userId","ApiClient","transformedParams","transformedData","transformed","snakeKey","finalKey","ConfigurationManager","maxRetries","attempt","lastError","forceRefresh","delay","lastUpdate","criticalThreshold","validation","failedEndpoints","endpointWarnings","fallbackConfig","errorMessage","individualErrors","apiResponse","unifiedError","errors","warnings","cacheAge","totalCacheRequests","cacheHitRate","formatCurrency","amount","roundedAmount","PLACEHOLDER_SVG","getImageUrl","imagePath","normalizedPath","getProductMainImage","product","firstImage","imageUrl","extractErrorMessage","defaultMessage","validationErrors","getHttpStatusMessage","statusCode","CacheEventManager","pattern","regexPattern","listenerPattern","pattern1","pattern2","base1","base2","useCacheInvalidation","cacheManager","useRef","patterns","Pagination","currentPage","totalPages","onPageChange","pages","jsxs","jsx","ChevronLeft","page","ChevronRight","Table","columns","searchFields","loading","emptyMessage","pagination","searchTerm","setSearchTerm","useState","sortConfig","setSortConfig","handleSort","direction","filteredAndSortedData","useMemo","filtered","field","aValue","bValue","Search","Fragment","column","ArrowUp","ArrowDown","DashboardCard","title","change","text","Icon","iconBgColor","iconColor","isPositive","changeColor","DashboardCardList","cards","card","PendingCard","color","description","linkText","linkTo","Link","PendingCardList","CardPending","EmptyState","className","TableHeader","viewAllLink","viewAllText","StandardTable","onRowClick","renderCellContent","row","rowIndex","colIndex","CompactTable","DataTable","compact","AlertCard","AlertTriangle","borderColor","bgColor","textColor","hoverTextColor","AlertCardList","getOrderColumns","bgColorClass","displayText","OrdersTable","orders","onOrderClick","getSellerColumns","SellersTable","sellers","onSellerClick","AdminDashboardService","alert","order","seller","backendStatus","adminDashboardService","useAdminDashboard","autoRefresh","refreshInterval","setStats","setLoading","setError","lastUpdated","setLastUpdated","fetchDashboardStats","useCallback","dashboardStats","useEffect","interval","AdminDashboard","navigate","useNavigate","refetch","handleOrderClick","handleSellerClick","handleRefresh","RefreshCw","getIcon","iconName","DollarSign","Users","ShoppingBag","Package","Star","Briefcase","MessageSquare","cardsWithIcons","pendingItemsWithIcons","alertItemsWithIcons","Clock","AdminUserService","perPage","storeData","useAdminUsers","users","setUsers","setPagination","adminUserService","mapApiUserToAdminUserData","apiUser","role","fetchUsers","mappedUsers","errorMsg","toggleUserStatus","isCurrentlyBlocked","success","prevUsers","user","sendPasswordReset","makeUserAdmin","makeUserSeller","deleteUser","isLastUserInPage","isNotFirstPage","targetPage","fallbackError","prevPagination","refreshData","filterUsers","matchesRole","matchesStatus","matchesSearch","AdminUsersPage","roleFilter","setRoleFilter","statusFilter","setStatusFilter","successMessage","setSuccessMessage","showSellerModal","setShowSellerModal","selectedUserId","setSelectedUserId","storeName","setStoreName","storeDescription","setStoreDescription","setValidationErrors","showEmailModal","setShowEmailModal","selectedUserForEmail","setSelectedUserForEmail","emailSubject","setEmailSubject","emailMessage","setEmailMessage","emailType","setEmailType","emailSending","setEmailSending","emailValidationErrors","setEmailValidationErrors","showDeleteModal","setShowDeleteModal","selectedUserForDelete","setSelectedUserForDelete","deleting","setDeleting","filteredUsers","handleToggleUserStatus","currentStatus","handleSendPasswordReset","handleMakeAdmin","handleShowMakeSellerModal","handleCloseSellerModal","validateSellerForm","handleMakeSeller","handlePageChange","handleRefreshData","handleShowEmailModal","handleCloseEmailModal","validateEmailForm","handleSendCustomEmail","handleShowDeleteModal","handleCloseDeleteModal","handleDeleteUser","User","Lock","Unlock","Mail","AtSign","Store","Shield","Trash2","AlertCircle","Filter","X","Send","AdminProductService","filterParams","cleanParams","colorsValue","sizesValue","tagsValue","file","featured","published","GetAllProductsUseCase","adminProductService","products","CreateProductAsAdminUseCase","UpdateAnyProductUseCase","DeleteAnyProductUseCase","ToggleProductFeaturedUseCase","ToggleProductPublishedUseCase","UpdateProductStatusUseCase","GetProductsBySellerUseCase","GetProductStatsUseCase","getAllProductsUseCase","createProductAsAdminUseCase","updateAnyProductUseCase","deleteAnyProductUseCase","toggleProductFeaturedUseCase","toggleProductPublishedUseCase","updateProductStatusUseCase","getProductsBySellerUseCase","getProductStatsUseCase","getAdminCacheKey","useAdminProducts","setProducts","productDetail","setProductDetail","meta","setMeta","invalidateAfterMutation","adaptProduct","apiProduct","processedImages","img","processedTags","tag","fetchAllProducts","cacheKey","cachedData","adaptedData","responseMeta","fetchProductById","createProduct","updateProduct","prev","p","deleteProduct","toggleFeatured","togglePublished","updateStatus","fetchProductsBySeller","fetchProductStats","statsData","clearProductCache","AdminCategoryService","is_active","withCounts","parentId","GetAllCategoriesUseCase","adminCategoryService","categories","CreateCategoryAsAdminUseCase","category","UpdateAnyCategoryUseCase","DeleteAnyCategoryUseCase","ToggleCategoryActiveUseCase","ToggleCategoryFeaturedUseCase","GetCategoryByIdUseCase","getAllCategoriesUseCase","createCategoryAsAdminUseCase","updateAnyCategoryUseCase","deleteAnyCategoryUseCase","toggleCategoryActiveUseCase","toggleCategoryFeaturedUseCase","getCategoryByIdUseCase","useAdminCategories","setCategories","mainCategories","setMainCategories","categoryDetail","setCategoryDetail","adaptCategory","apiCategory","sub","fetchAllCategories","adaptedCategories","fetchMainCategories","categoriesArray","fetchCategoryById","adaptedCategory","createCategory","updateCategory","cat","deleteCategory","toggleActive","clearCategoryCache","AdminProductsPage","location","useLocation","sellerIdFromUrl","productsLoading","productsError","categoriesLoading","categoryFilter","setCategoryFilter","sellerFilter","setSellerFilter","stockFilter","setStockFilter","setCurrentPage","itemsPerPage","loadingAction","setLoadingAction","loadData","loadCategories","newSellerId","newSellerIdInt","handleDeleteProduct","productName","handleToggleFeatured","currentFeatured","newFeaturedValue","handleTogglePublished","currentPublished","newPublishedValue","getCategoryName","ProductImage","imageSrc","setImageSrc","hasError","setHasError","errorCount","setErrorCount","handleImageError","filteredProducts","Tag","userName","statusColor","statusText","StatusIcon","CheckCircle","Archive","displayRating","displayCount","salesCount","totalQuantity","Eye","Edit","Plus","AdminCategoriesPage","parentFilter","setParentFilter","viewMode","setViewMode","filters","filteredCategories","handleToggleActive","currentActive","handleDeleteCategory","categoryName","getParentCategoryName","parent","Folder","EyeOff","FolderTree","ArrowUpRight","startIndex","paginatedCategories","FolderPlus","AdminOrderService","shippingInfo","AdminOrderServiceAdapter","apiFilters","orderDetails","customerName","customerEmail","sellerName","shippingData","AdminOrdersPage","setOrders","setFilters","orderAdapter","fetchOrders","orderStatusMap","Truck","XCircle","RotateCcw","paymentStatusMap","paymentMethodMap","getNextStatus","updateOrderStatus","newStatus","prevOrders","advanceOrderStatus","nextStatus","cancelOrder","formatDate","dateString","date","handleFilterChange","filterName","clearFilters","Calendar","paymentMethod","paymentStatus","canAdvance","canCancel","FileText","label","ConfigurationService","moderationData","SecurityConfiguration","saving","setSaving","setSuccess","setConfig","configService","loadConfiguration","handleConfigChange","saveConfiguration","passwordStrength","score","Info","Key","numValue","Save","ModerationConfiguration","MessageCircle","RatingConfigPage","autoApproveAll","setAutoApproveAll","autoApproveThreshold","setAutoApproveThreshold","loadConfigurations","loadRatingStats","configs","saveConfigurations","approveAllPendingRatings","star","VolumeDiscountManager","handleDefaultTierChange","newTiers","addDefaultTier","removeDefaultTier","Settings","tier","ShippingConfiguration","configManager","configResult","shippingConfig","DevelopmentConfiguration","Code","FinancialConfiguration","originalConfig","setOriginalConfig","apiClient","loadedConfig","sanitizedValue","parts","validateConfiguration","platformCommission","singleSellerPercentage","maxSellerPercentage","validationError","configToSave","hasChanges","TrendingUp","AdminSettingsPage","activeTab","setActiveTab","TrendingDown","RatingConfiguration"],"mappings":"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","x_google_ignoreList":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51]}