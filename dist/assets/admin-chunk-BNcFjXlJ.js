import{j as r,C as Ks,a as Cr,S as wr,A as Qr,b as es,T as J,R as G,c as Ie,M as Ws,B as Js,d as me,P as Ar,e as pr,U as rs,D as Je,f as ir,F as Xe,X as lr,g as kr,h as hr,i as Xs,k as je,L as _r,l as Ys,m as ss,n as Zs,o as Ce,p as Tr,q as Qs,r as Se,E as He,s as ts,t as Ur,u as et,v as rt,w as $r,x as st,y as tt,z as at,G as Lr,H as Pr,I as nt,J as ot,K as Oe,N as it,O as ye,Q as lt,V as as,W as ns,Y as cr,Z as ct}from"./ui-vendor-BUNMIuFe.js";import{r as g,L as Y,u as dt,a as ut}from"./react-vendor-Cy458wKG.js";const mt={development:{apiBaseUrl:"http://127.0.0.1:8000/api",imageBaseUrl:"http://127.0.0.1:8000/storage/",debug:!0},staging:{apiBaseUrl:"https://api.comersia.app/api",imageBaseUrl:"https://api.comersia.app/storage/",debug:!0},production:{apiBaseUrl:"https://api.comersia.app/api",imageBaseUrl:"https://api.comersia.app/storage/",debug:!1}},gt="production",fr=mt[gt],X={appName:"Comersia",api:{baseUrl:fr.apiBaseUrl,timeout:15e3,retryAttempts:1},imageBaseUrl:fr.imageBaseUrl,pagination:{defaultPageSize:12,pageSizes:[12,24,48,96]},cache:{productCacheTime:1e3*60*15,categoryCacheTime:1e3*60*60},storage:{authTokenKey:"auth_token",refreshTokenKey:"refresh_token",cartKey:"shopping_cart",userKey:"user_data",themeKey:"user_theme",languageKey:"app_language"},routes:{home:"/",login:"/login",register:"/register",products:"/products",productDetails:s=>`/products/${s}`,cart:"/cart",checkout:"/checkout",dashboard:"/dashboard",notFound:"/404",categories:"/categories",contact:"/contact",faq:"/faq",favorites:"/favorites"},fileUpload:{maxImageSize:2097152,allowedImageTypes:["image/jpeg","image/png","image/webp"],maxProductImages:5},validation:{minPasswordLength:8,maxProductNameLength:100,maxDescriptionLength:5e3}};function os(s,e){return function(){return s.apply(e,arguments)}}const{toString:pt}=Object.prototype,{getPrototypeOf:Rr}=Object,{iterator:Ye,toStringTag:is}=Symbol,Ze=(s=>e=>{const t=pt.call(e);return s[t]||(s[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),se=s=>(s=s.toLowerCase(),e=>Ze(e)===s),Qe=s=>e=>typeof e===s,{isArray:we}=Array,Re=Qe("undefined");function ht(s){return s!==null&&!Re(s)&&s.constructor!==null&&!Re(s.constructor)&&Z(s.constructor.isBuffer)&&s.constructor.isBuffer(s)}const ls=se("ArrayBuffer");function ft(s){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(s):e=s&&s.buffer&&ls(s.buffer),e}const xt=Qe("string"),Z=Qe("function"),cs=Qe("number"),er=s=>s!==null&&typeof s=="object",yt=s=>s===!0||s===!1,Be=s=>{if(Ze(s)!=="object")return!1;const e=Rr(s);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(is in s)&&!(Ye in s)},bt=se("Date"),vt=se("File"),Nt=se("Blob"),jt=se("FileList"),St=s=>er(s)&&Z(s.pipe),Et=s=>{let e;return s&&(typeof FormData=="function"&&s instanceof FormData||Z(s.append)&&((e=Ze(s))==="formdata"||e==="object"&&Z(s.toString)&&s.toString()==="[object FormData]"))},Ct=se("URLSearchParams"),[wt,At,_t,Tt]=["ReadableStream","Request","Response","Headers"].map(se),Pt=s=>s.trim?s.trim():s.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function De(s,e,{allOwnKeys:t=!1}={}){if(s===null||typeof s>"u")return;let a,n;if(typeof s!="object"&&(s=[s]),we(s))for(a=0,n=s.length;a<n;a++)e.call(null,s[a],a,s);else{const o=t?Object.getOwnPropertyNames(s):Object.keys(s),i=o.length;let d;for(a=0;a<i;a++)d=o[a],e.call(null,s[d],d,s)}}function ds(s,e){e=e.toLowerCase();const t=Object.keys(s);let a=t.length,n;for(;a-- >0;)if(n=t[a],e===n.toLowerCase())return n;return null}const he=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,us=s=>!Re(s)&&s!==he;function xr(){const{caseless:s}=us(this)&&this||{},e={},t=(a,n)=>{const o=s&&ds(e,n)||n;Be(e[o])&&Be(a)?e[o]=xr(e[o],a):Be(a)?e[o]=xr({},a):we(a)?e[o]=a.slice():e[o]=a};for(let a=0,n=arguments.length;a<n;a++)arguments[a]&&De(arguments[a],t);return e}const Rt=(s,e,t,{allOwnKeys:a}={})=>(De(e,(n,o)=>{t&&Z(n)?s[o]=os(n,t):s[o]=n},{allOwnKeys:a}),s),It=s=>(s.charCodeAt(0)===65279&&(s=s.slice(1)),s),Ot=(s,e,t,a)=>{s.prototype=Object.create(e.prototype,a),s.prototype.constructor=s,Object.defineProperty(s,"super",{value:e.prototype}),t&&Object.assign(s.prototype,t)},Dt=(s,e,t,a)=>{let n,o,i;const d={};if(e=e||{},s==null)return e;do{for(n=Object.getOwnPropertyNames(s),o=n.length;o-- >0;)i=n[o],(!a||a(i,s,e))&&!d[i]&&(e[i]=s[i],d[i]=!0);s=t!==!1&&Rr(s)}while(s&&(!t||t(s,e))&&s!==Object.prototype);return e},kt=(s,e,t)=>{s=String(s),(t===void 0||t>s.length)&&(t=s.length),t-=e.length;const a=s.indexOf(e,t);return a!==-1&&a===t},Ut=s=>{if(!s)return null;if(we(s))return s;let e=s.length;if(!cs(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=s[e];return t},$t=(s=>e=>s&&e instanceof s)(typeof Uint8Array<"u"&&Rr(Uint8Array)),Lt=(s,e)=>{const a=(s&&s[Ye]).call(s);let n;for(;(n=a.next())&&!n.done;){const o=n.value;e.call(s,o[0],o[1])}},Mt=(s,e)=>{let t;const a=[];for(;(t=s.exec(e))!==null;)a.push(t);return a},Ft=se("HTMLFormElement"),zt=s=>s.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,a,n){return a.toUpperCase()+n}),Mr=(({hasOwnProperty:s})=>(e,t)=>s.call(e,t))(Object.prototype),qt=se("RegExp"),ms=(s,e)=>{const t=Object.getOwnPropertyDescriptors(s),a={};De(t,(n,o)=>{let i;(i=e(n,o,s))!==!1&&(a[o]=i||n)}),Object.defineProperties(s,a)},Bt=s=>{ms(s,(e,t)=>{if(Z(s)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const a=s[t];if(Z(a)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},Vt=(s,e)=>{const t={},a=n=>{n.forEach(o=>{t[o]=!0})};return we(s)?a(s):a(String(s).split(e)),t},Gt=()=>{},Ht=(s,e)=>s!=null&&Number.isFinite(s=+s)?s:e;function Kt(s){return!!(s&&Z(s.append)&&s[is]==="FormData"&&s[Ye])}const Wt=s=>{const e=new Array(10),t=(a,n)=>{if(er(a)){if(e.indexOf(a)>=0)return;if(!("toJSON"in a)){e[n]=a;const o=we(a)?[]:{};return De(a,(i,d)=>{const c=t(i,n+1);!Re(c)&&(o[d]=c)}),e[n]=void 0,o}}return a};return t(s,0)},Jt=se("AsyncFunction"),Xt=s=>s&&(er(s)||Z(s))&&Z(s.then)&&Z(s.catch),gs=((s,e)=>s?setImmediate:e?((t,a)=>(he.addEventListener("message",({source:n,data:o})=>{n===he&&o===t&&a.length&&a.shift()()},!1),n=>{a.push(n),he.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Z(he.postMessage)),Yt=typeof queueMicrotask<"u"?queueMicrotask.bind(he):typeof process<"u"&&process.nextTick||gs,Zt=s=>s!=null&&Z(s[Ye]),b={isArray:we,isArrayBuffer:ls,isBuffer:ht,isFormData:Et,isArrayBufferView:ft,isString:xt,isNumber:cs,isBoolean:yt,isObject:er,isPlainObject:Be,isReadableStream:wt,isRequest:At,isResponse:_t,isHeaders:Tt,isUndefined:Re,isDate:bt,isFile:vt,isBlob:Nt,isRegExp:qt,isFunction:Z,isStream:St,isURLSearchParams:Ct,isTypedArray:$t,isFileList:jt,forEach:De,merge:xr,extend:Rt,trim:Pt,stripBOM:It,inherits:Ot,toFlatObject:Dt,kindOf:Ze,kindOfTest:se,endsWith:kt,toArray:Ut,forEachEntry:Lt,matchAll:Mt,isHTMLForm:Ft,hasOwnProperty:Mr,hasOwnProp:Mr,reduceDescriptors:ms,freezeMethods:Bt,toObjectSet:Vt,toCamelCase:zt,noop:Gt,toFiniteNumber:Ht,findKey:ds,global:he,isContextDefined:us,isSpecCompliantForm:Kt,toJSONObject:Wt,isAsyncFn:Jt,isThenable:Xt,setImmediate:gs,asap:Yt,isIterable:Zt};function L(s,e,t,a,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=s,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),a&&(this.request=a),n&&(this.response=n,this.status=n.status?n.status:null)}b.inherits(L,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:b.toJSONObject(this.config),code:this.code,status:this.status}}});const ps=L.prototype,hs={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(s=>{hs[s]={value:s}});Object.defineProperties(L,hs);Object.defineProperty(ps,"isAxiosError",{value:!0});L.from=(s,e,t,a,n,o)=>{const i=Object.create(ps);return b.toFlatObject(s,i,function(c){return c!==Error.prototype},d=>d!=="isAxiosError"),L.call(i,s.message,e,t,a,n),i.cause=s,i.name=s.name,o&&Object.assign(i,o),i};const Qt=null;function yr(s){return b.isPlainObject(s)||b.isArray(s)}function fs(s){return b.endsWith(s,"[]")?s.slice(0,-2):s}function Fr(s,e,t){return s?s.concat(e).map(function(n,o){return n=fs(n),!t&&o?"["+n+"]":n}).join(t?".":""):e}function ea(s){return b.isArray(s)&&!s.some(yr)}const ra=b.toFlatObject(b,{},null,function(e){return/^is[A-Z]/.test(e)});function rr(s,e,t){if(!b.isObject(s))throw new TypeError("target must be an object");e=e||new FormData,t=b.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(C,f){return!b.isUndefined(f[C])});const a=t.metaTokens,n=t.visitor||m,o=t.dots,i=t.indexes,c=(t.Blob||typeof Blob<"u"&&Blob)&&b.isSpecCompliantForm(e);if(!b.isFunction(n))throw new TypeError("visitor must be a function");function h(l){if(l===null)return"";if(b.isDate(l))return l.toISOString();if(!c&&b.isBlob(l))throw new L("Blob is not supported. Use a Buffer instead.");return b.isArrayBuffer(l)||b.isTypedArray(l)?c&&typeof Blob=="function"?new Blob([l]):Buffer.from(l):l}function m(l,C,f){let j=l;if(l&&!f&&typeof l=="object"){if(b.endsWith(C,"{}"))C=a?C:C.slice(0,-2),l=JSON.stringify(l);else if(b.isArray(l)&&ea(l)||(b.isFileList(l)||b.endsWith(C,"[]"))&&(j=b.toArray(l)))return C=fs(C),j.forEach(function(E,R){!(b.isUndefined(E)||E===null)&&e.append(i===!0?Fr([C],R,o):i===null?C:C+"[]",h(E))}),!1}return yr(l)?!0:(e.append(Fr(f,C,o),h(l)),!1)}const v=[],y=Object.assign(ra,{defaultVisitor:m,convertValue:h,isVisitable:yr});function _(l,C){if(!b.isUndefined(l)){if(v.indexOf(l)!==-1)throw Error("Circular reference detected in "+C.join("."));v.push(l),b.forEach(l,function(j,w){(!(b.isUndefined(j)||j===null)&&n.call(e,j,b.isString(w)?w.trim():w,C,y))===!0&&_(j,C?C.concat(w):[w])}),v.pop()}}if(!b.isObject(s))throw new TypeError("data must be an object");return _(s),e}function zr(s){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(s).replace(/[!'()~]|%20|%00/g,function(a){return e[a]})}function Ir(s,e){this._pairs=[],s&&rr(s,this,e)}const xs=Ir.prototype;xs.append=function(e,t){this._pairs.push([e,t])};xs.toString=function(e){const t=e?function(a){return e.call(this,a,zr)}:zr;return this._pairs.map(function(n){return t(n[0])+"="+t(n[1])},"").join("&")};function sa(s){return encodeURIComponent(s).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function ys(s,e,t){if(!e)return s;const a=t&&t.encode||sa;b.isFunction(t)&&(t={serialize:t});const n=t&&t.serialize;let o;if(n?o=n(e,t):o=b.isURLSearchParams(e)?e.toString():new Ir(e,t).toString(a),o){const i=s.indexOf("#");i!==-1&&(s=s.slice(0,i)),s+=(s.indexOf("?")===-1?"?":"&")+o}return s}class qr{constructor(){this.handlers=[]}use(e,t,a){return this.handlers.push({fulfilled:e,rejected:t,synchronous:a?a.synchronous:!1,runWhen:a?a.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){b.forEach(this.handlers,function(a){a!==null&&e(a)})}}const bs={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ta=typeof URLSearchParams<"u"?URLSearchParams:Ir,aa=typeof FormData<"u"?FormData:null,na=typeof Blob<"u"?Blob:null,oa={isBrowser:!0,classes:{URLSearchParams:ta,FormData:aa,Blob:na},protocols:["http","https","file","blob","url","data"]},Or=typeof window<"u"&&typeof document<"u",br=typeof navigator=="object"&&navigator||void 0,ia=Or&&(!br||["ReactNative","NativeScript","NS"].indexOf(br.product)<0),la=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",ca=Or&&window.location.href||"http://localhost",da=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Or,hasStandardBrowserEnv:ia,hasStandardBrowserWebWorkerEnv:la,navigator:br,origin:ca},Symbol.toStringTag,{value:"Module"})),K={...da,...oa};function ua(s,e){return rr(s,new K.classes.URLSearchParams,Object.assign({visitor:function(t,a,n,o){return K.isNode&&b.isBuffer(t)?(this.append(a,t.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},e))}function ma(s){return b.matchAll(/\w+|\[(\w*)]/g,s).map(e=>e[0]==="[]"?"":e[1]||e[0])}function ga(s){const e={},t=Object.keys(s);let a;const n=t.length;let o;for(a=0;a<n;a++)o=t[a],e[o]=s[o];return e}function vs(s){function e(t,a,n,o){let i=t[o++];if(i==="__proto__")return!0;const d=Number.isFinite(+i),c=o>=t.length;return i=!i&&b.isArray(n)?n.length:i,c?(b.hasOwnProp(n,i)?n[i]=[n[i],a]:n[i]=a,!d):((!n[i]||!b.isObject(n[i]))&&(n[i]=[]),e(t,a,n[i],o)&&b.isArray(n[i])&&(n[i]=ga(n[i])),!d)}if(b.isFormData(s)&&b.isFunction(s.entries)){const t={};return b.forEachEntry(s,(a,n)=>{e(ma(a),n,t,0)}),t}return null}function pa(s,e,t){if(b.isString(s))try{return(e||JSON.parse)(s),b.trim(s)}catch(a){if(a.name!=="SyntaxError")throw a}return(t||JSON.stringify)(s)}const ke={transitional:bs,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const a=t.getContentType()||"",n=a.indexOf("application/json")>-1,o=b.isObject(e);if(o&&b.isHTMLForm(e)&&(e=new FormData(e)),b.isFormData(e))return n?JSON.stringify(vs(e)):e;if(b.isArrayBuffer(e)||b.isBuffer(e)||b.isStream(e)||b.isFile(e)||b.isBlob(e)||b.isReadableStream(e))return e;if(b.isArrayBufferView(e))return e.buffer;if(b.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let d;if(o){if(a.indexOf("application/x-www-form-urlencoded")>-1)return ua(e,this.formSerializer).toString();if((d=b.isFileList(e))||a.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return rr(d?{"files[]":e}:e,c&&new c,this.formSerializer)}}return o||n?(t.setContentType("application/json",!1),pa(e)):e}],transformResponse:[function(e){const t=this.transitional||ke.transitional,a=t&&t.forcedJSONParsing,n=this.responseType==="json";if(b.isResponse(e)||b.isReadableStream(e))return e;if(e&&b.isString(e)&&(a&&!this.responseType||n)){const i=!(t&&t.silentJSONParsing)&&n;try{return JSON.parse(e)}catch(d){if(i)throw d.name==="SyntaxError"?L.from(d,L.ERR_BAD_RESPONSE,this,null,this.response):d}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:K.classes.FormData,Blob:K.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};b.forEach(["delete","get","head","post","put","patch"],s=>{ke.headers[s]={}});const ha=b.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),fa=s=>{const e={};let t,a,n;return s&&s.split(`
`).forEach(function(i){n=i.indexOf(":"),t=i.substring(0,n).trim().toLowerCase(),a=i.substring(n+1).trim(),!(!t||e[t]&&ha[t])&&(t==="set-cookie"?e[t]?e[t].push(a):e[t]=[a]:e[t]=e[t]?e[t]+", "+a:a)}),e},Br=Symbol("internals");function Pe(s){return s&&String(s).trim().toLowerCase()}function Ve(s){return s===!1||s==null?s:b.isArray(s)?s.map(Ve):String(s)}function xa(s){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=t.exec(s);)e[a[1]]=a[2];return e}const ya=s=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(s.trim());function dr(s,e,t,a,n){if(b.isFunction(a))return a.call(this,e,t);if(n&&(e=t),!!b.isString(e)){if(b.isString(a))return e.indexOf(a)!==-1;if(b.isRegExp(a))return a.test(e)}}function ba(s){return s.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,a)=>t.toUpperCase()+a)}function va(s,e){const t=b.toCamelCase(" "+e);["get","set","has"].forEach(a=>{Object.defineProperty(s,a+t,{value:function(n,o,i){return this[a].call(this,e,n,o,i)},configurable:!0})})}let Q=class{constructor(e){e&&this.set(e)}set(e,t,a){const n=this;function o(d,c,h){const m=Pe(c);if(!m)throw new Error("header name must be a non-empty string");const v=b.findKey(n,m);(!v||n[v]===void 0||h===!0||h===void 0&&n[v]!==!1)&&(n[v||c]=Ve(d))}const i=(d,c)=>b.forEach(d,(h,m)=>o(h,m,c));if(b.isPlainObject(e)||e instanceof this.constructor)i(e,t);else if(b.isString(e)&&(e=e.trim())&&!ya(e))i(fa(e),t);else if(b.isObject(e)&&b.isIterable(e)){let d={},c,h;for(const m of e){if(!b.isArray(m))throw TypeError("Object iterator must return a key-value pair");d[h=m[0]]=(c=d[h])?b.isArray(c)?[...c,m[1]]:[c,m[1]]:m[1]}i(d,t)}else e!=null&&o(t,e,a);return this}get(e,t){if(e=Pe(e),e){const a=b.findKey(this,e);if(a){const n=this[a];if(!t)return n;if(t===!0)return xa(n);if(b.isFunction(t))return t.call(this,n,a);if(b.isRegExp(t))return t.exec(n);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Pe(e),e){const a=b.findKey(this,e);return!!(a&&this[a]!==void 0&&(!t||dr(this,this[a],a,t)))}return!1}delete(e,t){const a=this;let n=!1;function o(i){if(i=Pe(i),i){const d=b.findKey(a,i);d&&(!t||dr(a,a[d],d,t))&&(delete a[d],n=!0)}}return b.isArray(e)?e.forEach(o):o(e),n}clear(e){const t=Object.keys(this);let a=t.length,n=!1;for(;a--;){const o=t[a];(!e||dr(this,this[o],o,e,!0))&&(delete this[o],n=!0)}return n}normalize(e){const t=this,a={};return b.forEach(this,(n,o)=>{const i=b.findKey(a,o);if(i){t[i]=Ve(n),delete t[o];return}const d=e?ba(o):String(o).trim();d!==o&&delete t[o],t[d]=Ve(n),a[d]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return b.forEach(this,(a,n)=>{a!=null&&a!==!1&&(t[n]=e&&b.isArray(a)?a.join(", "):a)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const a=new this(e);return t.forEach(n=>a.set(n)),a}static accessor(e){const a=(this[Br]=this[Br]={accessors:{}}).accessors,n=this.prototype;function o(i){const d=Pe(i);a[d]||(va(n,i),a[d]=!0)}return b.isArray(e)?e.forEach(o):o(e),this}};Q.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);b.reduceDescriptors(Q.prototype,({value:s},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>s,set(a){this[t]=a}}});b.freezeMethods(Q);function ur(s,e){const t=this||ke,a=e||t,n=Q.from(a.headers);let o=a.data;return b.forEach(s,function(d){o=d.call(t,o,n.normalize(),e?e.status:void 0)}),n.normalize(),o}function Ns(s){return!!(s&&s.__CANCEL__)}function Ae(s,e,t){L.call(this,s??"canceled",L.ERR_CANCELED,e,t),this.name="CanceledError"}b.inherits(Ae,L,{__CANCEL__:!0});function js(s,e,t){const a=t.config.validateStatus;!t.status||!a||a(t.status)?s(t):e(new L("Request failed with status code "+t.status,[L.ERR_BAD_REQUEST,L.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function Na(s){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(s);return e&&e[1]||""}function ja(s,e){s=s||10;const t=new Array(s),a=new Array(s);let n=0,o=0,i;return e=e!==void 0?e:1e3,function(c){const h=Date.now(),m=a[o];i||(i=h),t[n]=c,a[n]=h;let v=o,y=0;for(;v!==n;)y+=t[v++],v=v%s;if(n=(n+1)%s,n===o&&(o=(o+1)%s),h-i<e)return;const _=m&&h-m;return _?Math.round(y*1e3/_):void 0}}function Sa(s,e){let t=0,a=1e3/e,n,o;const i=(h,m=Date.now())=>{t=m,n=null,o&&(clearTimeout(o),o=null),s.apply(null,h)};return[(...h)=>{const m=Date.now(),v=m-t;v>=a?i(h,m):(n=h,o||(o=setTimeout(()=>{o=null,i(n)},a-v)))},()=>n&&i(n)]}const Ke=(s,e,t=3)=>{let a=0;const n=ja(50,250);return Sa(o=>{const i=o.loaded,d=o.lengthComputable?o.total:void 0,c=i-a,h=n(c),m=i<=d;a=i;const v={loaded:i,total:d,progress:d?i/d:void 0,bytes:c,rate:h||void 0,estimated:h&&d&&m?(d-i)/h:void 0,event:o,lengthComputable:d!=null,[e?"download":"upload"]:!0};s(v)},t)},Vr=(s,e)=>{const t=s!=null;return[a=>e[0]({lengthComputable:t,total:s,loaded:a}),e[1]]},Gr=s=>(...e)=>b.asap(()=>s(...e)),Ea=K.hasStandardBrowserEnv?((s,e)=>t=>(t=new URL(t,K.origin),s.protocol===t.protocol&&s.host===t.host&&(e||s.port===t.port)))(new URL(K.origin),K.navigator&&/(msie|trident)/i.test(K.navigator.userAgent)):()=>!0,Ca=K.hasStandardBrowserEnv?{write(s,e,t,a,n,o){const i=[s+"="+encodeURIComponent(e)];b.isNumber(t)&&i.push("expires="+new Date(t).toGMTString()),b.isString(a)&&i.push("path="+a),b.isString(n)&&i.push("domain="+n),o===!0&&i.push("secure"),document.cookie=i.join("; ")},read(s){const e=document.cookie.match(new RegExp("(^|;\\s*)("+s+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(s){this.write(s,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function wa(s){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(s)}function Aa(s,e){return e?s.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):s}function Ss(s,e,t){let a=!wa(e);return s&&(a||t==!1)?Aa(s,e):e}const Hr=s=>s instanceof Q?{...s}:s;function xe(s,e){e=e||{};const t={};function a(h,m,v,y){return b.isPlainObject(h)&&b.isPlainObject(m)?b.merge.call({caseless:y},h,m):b.isPlainObject(m)?b.merge({},m):b.isArray(m)?m.slice():m}function n(h,m,v,y){if(b.isUndefined(m)){if(!b.isUndefined(h))return a(void 0,h,v,y)}else return a(h,m,v,y)}function o(h,m){if(!b.isUndefined(m))return a(void 0,m)}function i(h,m){if(b.isUndefined(m)){if(!b.isUndefined(h))return a(void 0,h)}else return a(void 0,m)}function d(h,m,v){if(v in e)return a(h,m);if(v in s)return a(void 0,h)}const c={url:o,method:o,data:o,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:d,headers:(h,m,v)=>n(Hr(h),Hr(m),v,!0)};return b.forEach(Object.keys(Object.assign({},s,e)),function(m){const v=c[m]||n,y=v(s[m],e[m],m);b.isUndefined(y)&&v!==d||(t[m]=y)}),t}const Es=s=>{const e=xe({},s);let{data:t,withXSRFToken:a,xsrfHeaderName:n,xsrfCookieName:o,headers:i,auth:d}=e;e.headers=i=Q.from(i),e.url=ys(Ss(e.baseURL,e.url,e.allowAbsoluteUrls),s.params,s.paramsSerializer),d&&i.set("Authorization","Basic "+btoa((d.username||"")+":"+(d.password?unescape(encodeURIComponent(d.password)):"")));let c;if(b.isFormData(t)){if(K.hasStandardBrowserEnv||K.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((c=i.getContentType())!==!1){const[h,...m]=c?c.split(";").map(v=>v.trim()).filter(Boolean):[];i.setContentType([h||"multipart/form-data",...m].join("; "))}}if(K.hasStandardBrowserEnv&&(a&&b.isFunction(a)&&(a=a(e)),a||a!==!1&&Ea(e.url))){const h=n&&o&&Ca.read(o);h&&i.set(n,h)}return e},_a=typeof XMLHttpRequest<"u",Ta=_a&&function(s){return new Promise(function(t,a){const n=Es(s);let o=n.data;const i=Q.from(n.headers).normalize();let{responseType:d,onUploadProgress:c,onDownloadProgress:h}=n,m,v,y,_,l;function C(){_&&_(),l&&l(),n.cancelToken&&n.cancelToken.unsubscribe(m),n.signal&&n.signal.removeEventListener("abort",m)}let f=new XMLHttpRequest;f.open(n.method.toUpperCase(),n.url,!0),f.timeout=n.timeout;function j(){if(!f)return;const E=Q.from("getAllResponseHeaders"in f&&f.getAllResponseHeaders()),x={data:!d||d==="text"||d==="json"?f.responseText:f.response,status:f.status,statusText:f.statusText,headers:E,config:s,request:f};js(function(p){t(p),C()},function(p){a(p),C()},x),f=null}"onloadend"in f?f.onloadend=j:f.onreadystatechange=function(){!f||f.readyState!==4||f.status===0&&!(f.responseURL&&f.responseURL.indexOf("file:")===0)||setTimeout(j)},f.onabort=function(){f&&(a(new L("Request aborted",L.ECONNABORTED,s,f)),f=null)},f.onerror=function(){a(new L("Network Error",L.ERR_NETWORK,s,f)),f=null},f.ontimeout=function(){let R=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const x=n.transitional||bs;n.timeoutErrorMessage&&(R=n.timeoutErrorMessage),a(new L(R,x.clarifyTimeoutError?L.ETIMEDOUT:L.ECONNABORTED,s,f)),f=null},o===void 0&&i.setContentType(null),"setRequestHeader"in f&&b.forEach(i.toJSON(),function(R,x){f.setRequestHeader(x,R)}),b.isUndefined(n.withCredentials)||(f.withCredentials=!!n.withCredentials),d&&d!=="json"&&(f.responseType=n.responseType),h&&([y,l]=Ke(h,!0),f.addEventListener("progress",y)),c&&f.upload&&([v,_]=Ke(c),f.upload.addEventListener("progress",v),f.upload.addEventListener("loadend",_)),(n.cancelToken||n.signal)&&(m=E=>{f&&(a(!E||E.type?new Ae(null,s,f):E),f.abort(),f=null)},n.cancelToken&&n.cancelToken.subscribe(m),n.signal&&(n.signal.aborted?m():n.signal.addEventListener("abort",m)));const w=Na(n.url);if(w&&K.protocols.indexOf(w)===-1){a(new L("Unsupported protocol "+w+":",L.ERR_BAD_REQUEST,s));return}f.send(o||null)})},Pa=(s,e)=>{const{length:t}=s=s?s.filter(Boolean):[];if(e||t){let a=new AbortController,n;const o=function(h){if(!n){n=!0,d();const m=h instanceof Error?h:this.reason;a.abort(m instanceof L?m:new Ae(m instanceof Error?m.message:m))}};let i=e&&setTimeout(()=>{i=null,o(new L(`timeout ${e} of ms exceeded`,L.ETIMEDOUT))},e);const d=()=>{s&&(i&&clearTimeout(i),i=null,s.forEach(h=>{h.unsubscribe?h.unsubscribe(o):h.removeEventListener("abort",o)}),s=null)};s.forEach(h=>h.addEventListener("abort",o));const{signal:c}=a;return c.unsubscribe=()=>b.asap(d),c}},Ra=function*(s,e){let t=s.byteLength;if(t<e){yield s;return}let a=0,n;for(;a<t;)n=a+e,yield s.slice(a,n),a=n},Ia=async function*(s,e){for await(const t of Oa(s))yield*Ra(t,e)},Oa=async function*(s){if(s[Symbol.asyncIterator]){yield*s;return}const e=s.getReader();try{for(;;){const{done:t,value:a}=await e.read();if(t)break;yield a}}finally{await e.cancel()}},Kr=(s,e,t,a)=>{const n=Ia(s,e);let o=0,i,d=c=>{i||(i=!0,a&&a(c))};return new ReadableStream({async pull(c){try{const{done:h,value:m}=await n.next();if(h){d(),c.close();return}let v=m.byteLength;if(t){let y=o+=v;t(y)}c.enqueue(new Uint8Array(m))}catch(h){throw d(h),h}},cancel(c){return d(c),n.return()}},{highWaterMark:2})},sr=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Cs=sr&&typeof ReadableStream=="function",Da=sr&&(typeof TextEncoder=="function"?(s=>e=>s.encode(e))(new TextEncoder):async s=>new Uint8Array(await new Response(s).arrayBuffer())),ws=(s,...e)=>{try{return!!s(...e)}catch{return!1}},ka=Cs&&ws(()=>{let s=!1;const e=new Request(K.origin,{body:new ReadableStream,method:"POST",get duplex(){return s=!0,"half"}}).headers.has("Content-Type");return s&&!e}),Wr=64*1024,vr=Cs&&ws(()=>b.isReadableStream(new Response("").body)),We={stream:vr&&(s=>s.body)};sr&&(s=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!We[e]&&(We[e]=b.isFunction(s[e])?t=>t[e]():(t,a)=>{throw new L(`Response type '${e}' is not supported`,L.ERR_NOT_SUPPORT,a)})})})(new Response);const Ua=async s=>{if(s==null)return 0;if(b.isBlob(s))return s.size;if(b.isSpecCompliantForm(s))return(await new Request(K.origin,{method:"POST",body:s}).arrayBuffer()).byteLength;if(b.isArrayBufferView(s)||b.isArrayBuffer(s))return s.byteLength;if(b.isURLSearchParams(s)&&(s=s+""),b.isString(s))return(await Da(s)).byteLength},$a=async(s,e)=>{const t=b.toFiniteNumber(s.getContentLength());return t??Ua(e)},La=sr&&(async s=>{let{url:e,method:t,data:a,signal:n,cancelToken:o,timeout:i,onDownloadProgress:d,onUploadProgress:c,responseType:h,headers:m,withCredentials:v="same-origin",fetchOptions:y}=Es(s);h=h?(h+"").toLowerCase():"text";let _=Pa([n,o&&o.toAbortSignal()],i),l;const C=_&&_.unsubscribe&&(()=>{_.unsubscribe()});let f;try{if(c&&ka&&t!=="get"&&t!=="head"&&(f=await $a(m,a))!==0){let x=new Request(e,{method:"POST",body:a,duplex:"half"}),T;if(b.isFormData(a)&&(T=x.headers.get("content-type"))&&m.setContentType(T),x.body){const[p,S]=Vr(f,Ke(Gr(c)));a=Kr(x.body,Wr,p,S)}}b.isString(v)||(v=v?"include":"omit");const j="credentials"in Request.prototype;l=new Request(e,{...y,signal:_,method:t.toUpperCase(),headers:m.normalize().toJSON(),body:a,duplex:"half",credentials:j?v:void 0});let w=await fetch(l);const E=vr&&(h==="stream"||h==="response");if(vr&&(d||E&&C)){const x={};["status","statusText","headers"].forEach(u=>{x[u]=w[u]});const T=b.toFiniteNumber(w.headers.get("content-length")),[p,S]=d&&Vr(T,Ke(Gr(d),!0))||[];w=new Response(Kr(w.body,Wr,p,()=>{S&&S(),C&&C()}),x)}h=h||"text";let R=await We[b.findKey(We,h)||"text"](w,s);return!E&&C&&C(),await new Promise((x,T)=>{js(x,T,{data:R,headers:Q.from(w.headers),status:w.status,statusText:w.statusText,config:s,request:l})})}catch(j){throw C&&C(),j&&j.name==="TypeError"&&/Load failed|fetch/i.test(j.message)?Object.assign(new L("Network Error",L.ERR_NETWORK,s,l),{cause:j.cause||j}):L.from(j,j&&j.code,s,l)}}),Nr={http:Qt,xhr:Ta,fetch:La};b.forEach(Nr,(s,e)=>{if(s){try{Object.defineProperty(s,"name",{value:e})}catch{}Object.defineProperty(s,"adapterName",{value:e})}});const Jr=s=>`- ${s}`,Ma=s=>b.isFunction(s)||s===null||s===!1,As={getAdapter:s=>{s=b.isArray(s)?s:[s];const{length:e}=s;let t,a;const n={};for(let o=0;o<e;o++){t=s[o];let i;if(a=t,!Ma(t)&&(a=Nr[(i=String(t)).toLowerCase()],a===void 0))throw new L(`Unknown adapter '${i}'`);if(a)break;n[i||"#"+o]=a}if(!a){const o=Object.entries(n).map(([d,c])=>`adapter ${d} `+(c===!1?"is not supported by the environment":"is not available in the build"));let i=e?o.length>1?`since :
`+o.map(Jr).join(`
`):" "+Jr(o[0]):"as no adapter specified";throw new L("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return a},adapters:Nr};function mr(s){if(s.cancelToken&&s.cancelToken.throwIfRequested(),s.signal&&s.signal.aborted)throw new Ae(null,s)}function Xr(s){return mr(s),s.headers=Q.from(s.headers),s.data=ur.call(s,s.transformRequest),["post","put","patch"].indexOf(s.method)!==-1&&s.headers.setContentType("application/x-www-form-urlencoded",!1),As.getAdapter(s.adapter||ke.adapter)(s).then(function(a){return mr(s),a.data=ur.call(s,s.transformResponse,a),a.headers=Q.from(a.headers),a},function(a){return Ns(a)||(mr(s),a&&a.response&&(a.response.data=ur.call(s,s.transformResponse,a.response),a.response.headers=Q.from(a.response.headers))),Promise.reject(a)})}const _s="1.9.0",tr={};["object","boolean","number","function","string","symbol"].forEach((s,e)=>{tr[s]=function(a){return typeof a===s||"a"+(e<1?"n ":" ")+s}});const Yr={};tr.transitional=function(e,t,a){function n(o,i){return"[Axios v"+_s+"] Transitional option '"+o+"'"+i+(a?". "+a:"")}return(o,i,d)=>{if(e===!1)throw new L(n(i," has been removed"+(t?" in "+t:"")),L.ERR_DEPRECATED);return t&&!Yr[i]&&(Yr[i]=!0,console.warn(n(i," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(o,i,d):!0}};tr.spelling=function(e){return(t,a)=>(console.warn(`${a} is likely a misspelling of ${e}`),!0)};function Fa(s,e,t){if(typeof s!="object")throw new L("options must be an object",L.ERR_BAD_OPTION_VALUE);const a=Object.keys(s);let n=a.length;for(;n-- >0;){const o=a[n],i=e[o];if(i){const d=s[o],c=d===void 0||i(d,o,s);if(c!==!0)throw new L("option "+o+" must be "+c,L.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new L("Unknown option "+o,L.ERR_BAD_OPTION)}}const Ge={assertOptions:Fa,validators:tr},ne=Ge.validators;let fe=class{constructor(e){this.defaults=e||{},this.interceptors={request:new qr,response:new qr}}async request(e,t){try{return await this._request(e,t)}catch(a){if(a instanceof Error){let n={};Error.captureStackTrace?Error.captureStackTrace(n):n=new Error;const o=n.stack?n.stack.replace(/^.+\n/,""):"";try{a.stack?o&&!String(a.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(a.stack+=`
`+o):a.stack=o}catch{}}throw a}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=xe(this.defaults,t);const{transitional:a,paramsSerializer:n,headers:o}=t;a!==void 0&&Ge.assertOptions(a,{silentJSONParsing:ne.transitional(ne.boolean),forcedJSONParsing:ne.transitional(ne.boolean),clarifyTimeoutError:ne.transitional(ne.boolean)},!1),n!=null&&(b.isFunction(n)?t.paramsSerializer={serialize:n}:Ge.assertOptions(n,{encode:ne.function,serialize:ne.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Ge.assertOptions(t,{baseUrl:ne.spelling("baseURL"),withXsrfToken:ne.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let i=o&&b.merge(o.common,o[t.method]);o&&b.forEach(["delete","get","head","post","put","patch","common"],l=>{delete o[l]}),t.headers=Q.concat(i,o);const d=[];let c=!0;this.interceptors.request.forEach(function(C){typeof C.runWhen=="function"&&C.runWhen(t)===!1||(c=c&&C.synchronous,d.unshift(C.fulfilled,C.rejected))});const h=[];this.interceptors.response.forEach(function(C){h.push(C.fulfilled,C.rejected)});let m,v=0,y;if(!c){const l=[Xr.bind(this),void 0];for(l.unshift.apply(l,d),l.push.apply(l,h),y=l.length,m=Promise.resolve(t);v<y;)m=m.then(l[v++],l[v++]);return m}y=d.length;let _=t;for(v=0;v<y;){const l=d[v++],C=d[v++];try{_=l(_)}catch(f){C.call(this,f);break}}try{m=Xr.call(this,_)}catch(l){return Promise.reject(l)}for(v=0,y=h.length;v<y;)m=m.then(h[v++],h[v++]);return m}getUri(e){e=xe(this.defaults,e);const t=Ss(e.baseURL,e.url,e.allowAbsoluteUrls);return ys(t,e.params,e.paramsSerializer)}};b.forEach(["delete","get","head","options"],function(e){fe.prototype[e]=function(t,a){return this.request(xe(a||{},{method:e,url:t,data:(a||{}).data}))}});b.forEach(["post","put","patch"],function(e){function t(a){return function(o,i,d){return this.request(xe(d||{},{method:e,headers:a?{"Content-Type":"multipart/form-data"}:{},url:o,data:i}))}}fe.prototype[e]=t(),fe.prototype[e+"Form"]=t(!0)});let za=class Ts{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(o){t=o});const a=this;this.promise.then(n=>{if(!a._listeners)return;let o=a._listeners.length;for(;o-- >0;)a._listeners[o](n);a._listeners=null}),this.promise.then=n=>{let o;const i=new Promise(d=>{a.subscribe(d),o=d}).then(n);return i.cancel=function(){a.unsubscribe(o)},i},e(function(o,i,d){a.reason||(a.reason=new Ae(o,i,d),t(a.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=a=>{e.abort(a)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new Ts(function(n){e=n}),cancel:e}}};function qa(s){return function(t){return s.apply(null,t)}}function Ba(s){return b.isObject(s)&&s.isAxiosError===!0}const jr={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(jr).forEach(([s,e])=>{jr[e]=s});function Ps(s){const e=new fe(s),t=os(fe.prototype.request,e);return b.extend(t,fe.prototype,e,{allOwnKeys:!0}),b.extend(t,e,null,{allOwnKeys:!0}),t.create=function(n){return Ps(xe(s,n))},t}const z=Ps(ke);z.Axios=fe;z.CanceledError=Ae;z.CancelToken=za;z.isCancel=Ns;z.VERSION=_s;z.toFormData=rr;z.AxiosError=L;z.Cancel=z.CanceledError;z.all=function(e){return Promise.all(e)};z.spread=qa;z.isAxiosError=Ba;z.mergeConfig=xe;z.AxiosHeaders=Q;z.formToJSON=s=>vs(b.isHTMLForm(s)?new FormData(s):s);z.getAdapter=As.getAdapter;z.HttpStatusCode=jr;z.default=z;const{Axios:ho,AxiosError:fo,CanceledError:xo,isCancel:yo,CancelToken:bo,VERSION:vo,all:No,Cancel:jo,isAxiosError:So,spread:Eo,toFormData:Co,AxiosHeaders:wo,HttpStatusCode:Ao,formToJSON:_o,getAdapter:To,mergeConfig:Po}=z;let ze=!1,Sr=[];const Va=s=>{Sr.push(s)},Ga=s=>{Sr.forEach(e=>e(s)),Sr=[]},q=z.create({baseURL:X.api.baseUrl,timeout:X.api.timeout,headers:{"Content-Type":"application/json",Accept:"application/json"}});q.interceptors.request.use(s=>{if(s.url?.includes("/auth/refresh")||s.url?.includes("/auth/login"))return s;const e=localStorage.getItem(X.storage.authTokenKey);return e&&s.headers&&(s.headers.Authorization=`Bearer ${e}`),s},s=>Promise.reject(s));q.interceptors.response.use(s=>s,async s=>{const e=s.config;if(s.response?.status===401&&!e._retry){if(ze)return new Promise(t=>{Va(a=>{e.headers&&(e.headers.Authorization=`Bearer ${a}`),t(q(e))})});e._retry=!0,ze=!0;try{const t=localStorage.getItem(X.storage.refreshTokenKey);if(!t)throw new Error("No refresh token available");const a=await z.post(`${X.api.baseUrl}/auth/refresh`,{},{headers:{Authorization:`Bearer ${t}`}});if(a.data?.access_token){const n=a.data.access_token;return localStorage.setItem(X.storage.authTokenKey,n),q.defaults.headers.common.Authorization=`Bearer ${n}`,Ga(n),e.headers&&(e.headers.Authorization=`Bearer ${n}`),ze=!1,q(e)}else throw new Error("No access token in refresh response")}catch(t){return ze=!1,localStorage.removeItem(X.storage.authTokenKey),localStorage.removeItem(X.storage.refreshTokenKey),localStorage.removeItem(X.storage.userKey),window.location.replace(X.routes.login),Promise.reject(t)}}return Promise.reject(s)});class de{static PREFIX="cache_";static MAX_CACHE_SIZE=50;static setItem(e,t,a){try{const n={value:t,expiry:Date.now()+a,created:Date.now()},o=this.PREFIX+e;localStorage.setItem(o,JSON.stringify(n)),this.cleanupIfNeeded(),console.log(`💾 Cache guardado: ${e} (expira en ${Math.round(a/1e3)}s)`)}catch(n){console.error("Error al guardar en caché:",n),this.clearExpired();try{const o=this.PREFIX+e;localStorage.setItem(o,JSON.stringify({value:t,expiry:Date.now()+a,created:Date.now()}))}catch(o){console.error("Error al guardar en caché después de limpiar:",o)}}}static getItem(e){try{const t=this.PREFIX+e,a=localStorage.getItem(t);if(!a)return null;const n=JSON.parse(a);return Date.now()>n.expiry?(console.log(`🗑️ Cache expirado removido: ${e}`),localStorage.removeItem(t),null):(console.log(`✅ Cache hit: ${e}`),n.value)}catch(t){console.error("Error al recuperar de caché:",t);try{const a=this.PREFIX+e;localStorage.removeItem(a)}catch(a){console.error("Error al remover item corrupto:",a)}return null}}static removeItem(e){try{const t=this.PREFIX+e;localStorage.removeItem(t),console.log(`🗑️ Cache removido: ${e}`)}catch(t){console.error("Error al eliminar de caché:",t)}}static hasValidItem(e){return this.getItem(e)!==null}static getMultiple(e){const t={};return e.forEach(a=>{const n=this.getItem(a);n!==null&&(t[a]=n)}),t}static setMultiple(e,t){Object.entries(e).forEach(([a,n])=>{this.setItem(a,n,t)})}static clearExpired(){try{const e=Date.now(),t=[];for(let a=0;a<localStorage.length;a++){const n=localStorage.key(a);if(n&&n.startsWith(this.PREFIX))try{const o=localStorage.getItem(n);if(o){const i=JSON.parse(o);e>i.expiry&&t.push(n)}}catch{t.push(n)}}t.forEach(a=>{localStorage.removeItem(a)}),t.length>0&&console.log(`🗑️ Cache: ${t.length} elementos expirados eliminados`)}catch(e){console.error("Error al limpiar cache expirado:",e)}}static clearAll(){try{const e=[];for(let t=0;t<localStorage.length;t++){const a=localStorage.key(t);a&&a.startsWith(this.PREFIX)&&e.push(a)}e.forEach(t=>{localStorage.removeItem(t)}),console.log(`🗑️ Cache: ${e.length} elementos eliminados completamente`)}catch(e){console.error("Error al limpiar todo el cache:",e)}}static getStats(){try{const e=Date.now();let t=0,a=0,n=0,o=0;for(let i=0;i<localStorage.length;i++){const d=localStorage.key(i);if(d&&d.startsWith(this.PREFIX)){t++;const c=localStorage.getItem(d);if(c){o+=c.length;try{const h=JSON.parse(c);e>h.expiry?a++:n++}catch{a++}}}}return{total:t,expired:a,active:n,totalSize:o}}catch(e){return console.error("Error al obtener estadísticas del cache:",e),{total:0,expired:0,active:0,totalSize:0}}}static cleanupIfNeeded(){try{this.getStats().total>this.MAX_CACHE_SIZE&&(this.clearExpired(),this.getStats().active>this.MAX_CACHE_SIZE*.8&&this.clearOldest(Math.floor(this.MAX_CACHE_SIZE*.2)))}catch(e){console.error("Error en limpieza automática del cache:",e)}}static clearOldest(e){try{const t=[];for(let n=0;n<localStorage.length;n++){const o=localStorage.key(n);if(o&&o.startsWith(this.PREFIX))try{const i=localStorage.getItem(o);if(i){const d=JSON.parse(i);t.push({key:o,created:d.created||0})}}catch{t.push({key:o,created:0})}}t.sort((n,o)=>n.created-o.created);const a=t.slice(0,e);a.forEach(n=>{localStorage.removeItem(n.key)}),a.length>0&&console.log(`🗑️ Cache: ${a.length} elementos antiguos eliminados`)}catch(t){console.error("Error al eliminar elementos antiguos del cache:",t)}}static debug(){const e=this.getStats();console.group("📊 Cache Debug Info"),console.log("Estadísticas:",e);const t=[];for(let a=0;a<localStorage.length;a++){const n=localStorage.key(a);if(n&&n.startsWith(this.PREFIX))try{const o=localStorage.getItem(n);if(o){const i=JSON.parse(o);t.push({key:n.replace(this.PREFIX,""),expiry:i.expiry,size:o.length})}}catch{t.push({key:n.replace(this.PREFIX,""),expiry:0,size:0})}}console.table(t),console.groupEnd()}}const D={AUTH:{LOGIN:"/auth/login",LOGOUT:"/auth/logout",REFRESH:"/auth/refresh",REGISTER:"/auth/register",FORGOT_PASSWORD_EMAIL:"/auth/forgot-password-email",FORGOT_PASSWORD_TOKEN:"/auth/forgot-password-token",RESET_PASSWORD:"/auth/reset-password",VALIDATE_RESET_TOKEN:"/auth/reset-password/validate",ME:"/auth/me",UPDATE_PASSWORD:"/auth/password/update",VERIFY_EMAIL:(s,e)=>`/email/verify/${s}/${e}`,VERIFY_EMAIL_TOKEN:"/email-verification/verify",RESEND_VERIFICATION:"/email-verification/resend",VERIFICATION_STATUS:"/email-verification/status",CHECK_ROLE:"/user/check-role",PASSWORD_VALIDATION_RULES:"/auth/password-validation-rules"},PROFILE:{LIST:"/profile",UPDATE:"/profile",GET:"/profile",CHANGE_PASSWORD:"/profile/change-password",UPLOAD_AVATAR:"/profile/upload-avatar"},USER:{ORDERS:"/user/orders",ORDER_DETAILS:s=>`/user/orders/${s}`,ORDER_STATS:"/user/orders/stats",REORDER:s=>`/user/orders/${s}/reorder`,CONFIRM_RECEPTION:s=>`/user/orders/${s}/confirm-reception`},HEADER_COUNTERS:"/user/header-counters",PRODUCTS:{LIST:"/products",DETAILS:s=>`/products/${s}`,DETAILS_BY_SLUG:s=>`/products/slug/${s}`,FEATURED:"/products/featured",FEATURED_RANDOM:"/products/featured-random",TRENDING_OFFERS:"/products/trending-offers",PERSONALIZED:"/products/personalized",DISCOUNTED:"/products/discounted",NEWEST:"/products/newest",POPULAR:"/products/popular",BY_CATEGORY:s=>`/products/category/${s}`,BY_TAGS:"/products/tags",BY_SELLER:s=>`/products/seller/${s}`,SEARCH:s=>`/products/search/${s||""}`,CREATE:"/products",UPDATE:s=>`/products/${s}`,DELETE:s=>`/products/${s}`,INCREMENT_VIEW:s=>`/products/${s}/view`},CATEGORIES:{LIST:"/categories",MAIN:"/categories/main",FEATURED:"/categories/featured",SUBCATEGORIES:s=>`/categories/${s}/subcategories`,PRODUCTS:s=>`/categories/${s}/products`,SLUG:s=>`/categories/slug/${s}`,DETAILS:s=>`/categories/${s}`,CREATE:"/admin/categories",UPDATE:s=>`/admin/categories/${s}`,DELETE:s=>`/admin/categories/${s}`},CART:{GET:"/cart",ADD_ITEM:"/cart/items",UPDATE_ITEM:s=>`/cart/items/${s}`,REMOVE_ITEM:s=>`/cart/items/${s}`,EMPTY:"/cart/empty",VOLUME_DISCOUNT_INFO:s=>`/cart/volume-discount-info/${s}`,DISCOUNT:{VALIDATE:"/cart/discount/validate",APPLY:"/cart/discount/apply",REMOVE:"/cart/discount/remove"}},VOLUME_DISCOUNTS:{PRODUCT_INFO:s=>`/volume-discounts/product/${s}`,ADMIN:{CONFIGURATION:"/admin/volume-discounts/configuration",STATS:"/admin/volume-discounts/stats",PRODUCT_DISCOUNTS:s=>`/admin/volume-discounts/product/${s}`,APPLY_DEFAULTS:s=>`/admin/volume-discounts/product/${s}/apply-defaults`,REMOVE_PRODUCT:s=>`/admin/volume-discounts/product/${s}`,BULK_APPLY:"/admin/volume-discounts/bulk/apply-defaults"}},CHECKOUT:{PROCESS:"/checkout"},ORDERS:{LIST:"/orders",DETAILS:s=>`/orders/${s}`,CREATE:"/orders",UPDATE:s=>`/orders/${s}`,SELLER_ORDERS:"/seller/orders",SELLER_ORDER_DETAILS:s=>`/seller/orders/${s}`,SELLER_ORDER_ITEMS:s=>`/seller/orders/${s}/items`,STATS:"/seller/orders/stats",UPDATE_STATUS:s=>`/seller/orders/${s}/status`,UPDATE_SHIPPING:s=>`/seller/orders/${s}/shipping`,CANCEL:s=>`/seller/orders/${s}/cancel`,COMPLETE:s=>`/seller/orders/${s}/complete`,AWAITING_SHIPMENT:"/seller/orders/awaiting-shipment",CUSTOMERS:"/seller/orders/customers",WITH_PRODUCT:s=>`/seller/orders/product/${s}`},PAYMENTS:{CREDIT_CARD:"/payments/credit-card",PAYPAL:"/payments/paypal",QR:"/payments/qr"},INVOICES:{LIST:"/invoices",DETAILS:s=>`/invoices/${s}`,GENERATE:"/invoices/generate",CANCEL:s=>`/invoices/${s}/cancel`,DOWNLOAD:s=>`/invoices/${s}/download`},SELLER:{REGISTER:"/seller/register",INFO:"/seller/info",UPDATE_STORE_INFO:"/seller/store-info",DASHBOARD:"/seller/dashboard",TOP_RATING:"/sellers/top/rating",TOP_SALES:"/sellers/top/sales",FEATURED:"/sellers/featured"},RATINGS:{PRODUCT:s=>`/ratings/product/${s}`,SELLER:s=>`/ratings/seller/${s}`,RATE_PRODUCT:"/ratings/product",RATE_SELLER:"/ratings/seller",RATE_USER:"/ratings/user",MY_GIVEN:"/ratings/my/given",MY_RECEIVED:"/ratings/my/received",PENDING:"/ratings/pending",REPLY:"/ratings/reply",REPORT:"/ratings/report",REPORT_PROBLEM:"/ratings/report-problem",DETAILS:s=>`/ratings/${s}`,ORDER_RATINGS:s=>`/ratings/order/${s}`},SHIPPING:{TRACK:s=>`/shipping/track/${s}`,HISTORY:s=>`/shipping/${s}/history`,ROUTE:s=>`/shipping/${s}/route`,ESTIMATE:"/shipping/estimate",UPDATE_STATUS:"/shipping/update-status",EXTERNAL_UPDATE:"/shipping/external-status-update",SELLER:{LIST:"/seller/shipping",DETAIL:s=>`/seller/shipping/${s}`,UPDATE_STATUS:s=>`/seller/shipping/${s}/status`,HISTORY:s=>`/api/shipping/track/${s}/history`,ROUTE:s=>`/api/shipping/track/${s}/route`},SIMULATE_EVENTS:s=>`/shipping/${s}/simulate`,SIMULATE_API:"/shipping-api/status-update",SIMULATE_CYCLE:s=>`/shipping-api/${s}/simulate-cycle`},CHAT:{LIST:"/chats",DETAILS:s=>`/chats/${s}`,CREATE:"/chats",SEND_MESSAGE:s=>`/chats/${s}/messages`,UPDATE_STATUS:s=>`/chats/${s}`,DELETE:s=>`/chats/${s}`,GET_MESSAGES:s=>`/chats/${s}/messages`,MARK_ALL_READ:s=>`/chats/${s}/mark-read`,MARK_MESSAGE_READ:(s,e)=>`/chats/${s}/messages/${e}/read`,SELLER:{LIST:"/seller/chats",DETAILS:s=>`/seller/chats/${s}`,LIST_BY_SELLER:s=>`/seller/chats/by-seller/${s}`,SEND_MESSAGE:s=>`/seller/chats/${s}/messages`,UPDATE_STATUS:s=>`/seller/chats/${s}`,GET_MESSAGES:s=>`/seller/chats/${s}/messages`,MARK_ALL_READ:s=>`/seller/chats/${s}/mark-read`}},RECOMMENDATIONS:{GET:"/recommendations",TRACK_INTERACTION:"/recommendations/track-interaction",USER_PROFILE:"/recommendations/user-profile"},FAVORITES:{LIST:"/favorites",TOGGLE:"/favorites/toggle",CHECK:s=>`/favorites/product/${s}`,UPDATE_NOTIFICATIONS:s=>`/favorites/${s}/notifications`},FEEDBACK:{LIST:"/feedback",DETAILS:s=>`/feedback/${s}`,CREATE:"/feedback"},DISCOUNTS:{VALIDATE:"/discounts/validate",APPLY:"/discounts/apply",MY_CODES:"/discounts/my-codes"},NOTIFICATIONS:{LIST:"/notifications",UNREAD:"/notifications/unread",COUNT:"/notifications/count",MARK_AS_READ:s=>`/notifications/${s}/read`,MARK_ALL_AS_READ:"/notifications/read-all",DELETE:s=>`/notifications/${s}`},ACCOUNTING:{BALANCE_SHEET:"/accounting/balance-sheet",INCOME_STATEMENT:"/accounting/income-statement",ACCOUNTS:"/accounting/accounts",ACCOUNT_LEDGER:s=>`/accounting/accounts/${s}/ledger`},ADMIN:{USERS:"/admin/users",USER_DETAIL:s=>`/admin/users/${s}`,BLOCK_USER:s=>`/admin/users/${s}/block`,UNBLOCK_USER:s=>`/admin/users/${s}/unblock`,RESET_PASSWORD:s=>`/admin/users/${s}/reset-password`,MAKE_ADMIN:s=>`/admin/users/${s}/make-admin`,MAKE_SELLER:s=>`/admin/users/${s}/make-seller`,DELETE_USER:s=>`/admin/users/${s}`,DASHBOARD:"/admin/dashboard",SELLERS:"/admin/sellers",SELLER_STATUS:s=>`/admin/sellers/${s}/status`,CREATE_SELLER:"/admin/sellers",UPDATE_SELLER:s=>`/admin/sellers/${s}`,PENDING_RATINGS:"/admin/ratings/pending",MODERATE_RATING:s=>`/admin/ratings/${s}/moderate`,DELETE_RATING:s=>`/admin/ratings/${s}`,ORDERS:"/admin/orders",ORDER_DETAIL:s=>`/admin/orders/${s}`,ORDER_STATS:"/admin/orders/stats",UPDATE_ORDER_STATUS:s=>`/admin/orders/${s}/status`,CANCEL_ORDER:s=>`/admin/orders/${s}/cancel`,SHIPPING_LIST:"/admin/shippings",SHIPPING_DETAIL:s=>`/admin/shippings/${s}`,SHIPPING_HISTORY:s=>`/admin/shipping/${s}/history`,UPDATE_SHIPPING:s=>`/admin/orders/${s}/shipping`,UPDATE_SHIPPING_STATUS:s=>`/admin/shipping/${s}/status`,SIMULATE_SHIPPING:s=>`/admin/shipping/${s}/simulate`,SHIPPING_SEND_NOTIFICATION:s=>`/admin/shipping/${s}/notify`,ADMINS:"/admin/admins",MANAGE_ADMIN:"/admin/admins",REMOVE_ADMIN:s=>`/admin/admins/${s}`,PENDING_FEEDBACK:"/admin/feedback/pending",REVIEW_FEEDBACK:s=>`/admin/feedback/${s}/review`,RATINGS:{LIST:"/admin/ratings",STATS:"/admin/ratings/stats",PENDING:"/admin/ratings/pending",MODERATE:s=>`/admin/ratings/${s}/moderate`,APPROVE:s=>`/admin/ratings/${s}/approve`,REJECT:s=>`/admin/ratings/${s}/reject`,FLAG:s=>`/admin/ratings/${s}/flag`,APPROVE_ALL:"/admin/ratings/approve-all",DELETE:s=>`/admin/ratings/${s}`},CONFIGURATIONS:{BASE:"/admin/configurations",INDEX:"/admin/configurations",SHOW:s=>`/admin/configurations/${s}`,UPDATE:"/admin/configurations/update",RATINGS:"/admin/configurations/ratings",SHIPPING:"/admin/configurations/shipping",DEVELOPMENT:"/admin/configurations/development",MAIL:"/admin/configurations/mail",MAIL_TEST:"/admin/configurations/mail/test",MAIL_SEND_CUSTOM:"/admin/configurations/mail/send-custom",PASSWORD_VALIDATION_RULES:"/admin/configurations/password-validation-rules",FINANCIAL:"/admin/configurations/financial"},PUBLIC_CONFIGURATIONS:{PLATFORM_COMMISSION:"/configurations/platform-commission-public",SHIPPING:"/configurations/shipping-public",VOLUME_DISCOUNTS:"/configurations/volume-discounts-public",SHIPPING_DISTRIBUTION:"/configurations/shipping-distribution-public",TAX:"/configurations/tax-public",UNIFIED:"/configurations/unified"},CATEGORIES:{LIST:"/categories",DETAILS:s=>`/categories/${s}`,CREATE:"/admin/categories",UPDATE:s=>`/admin/categories/${s}`,PARTIAL_UPDATE:s=>`/admin/categories/${s}`,DELETE:s=>`/admin/categories/${s}`},PRODUCTS:{LIST:"/admin/products",DETAILS:s=>`/products/${s}`,CREATE:"/admin/products",UPDATE:s=>`/admin/products/${s}`,PARTIAL_UPDATE:s=>`/admin/products/${s}`,DELETE:s=>`/admin/products/${s}`,STATS:"/admin/products/stats"},VOLUME_DISCOUNTS:{CONFIGURATION:"/admin/volume-discounts/configuration",STATS:"/admin/volume-discounts/stats",PRODUCT_DISCOUNTS:s=>`/admin/volume-discounts/product/${s}`,UPDATE_PRODUCT:s=>`/admin/volume-discounts/product/${s}`,APPLY_DEFAULTS:s=>`/admin/volume-discounts/product/${s}/apply-defaults`,REMOVE_PRODUCT:s=>`/admin/volume-discounts/product/${s}`,BULK_APPLY:"/admin/volume-discounts/bulk/apply-defaults"},DISCOUNT_CODES:{LIST:"/admin/discount-codes",STATS:"/admin/discount-codes/stats",GENERATE_CODE:"/admin/discount-codes/generate-code",CREATE:"/admin/discount-codes",DETAILS:s=>`/admin/discount-codes/${s}`,UPDATE:s=>`/admin/discount-codes/${s}`,DELETE:s=>`/admin/discount-codes/${s}`,VALIDATE:"/admin/discount-codes/validate",APPLY:"/admin/discount-codes/apply"}},DEV:{SHIPPING_TRACK:s=>`/simulator/shipping/track/${s}`,SHIPPING_UPDATE:"/simulator/shipping/simulate-update",SHIPPING_CYCLE:s=>`/simulator/shipping/simulate-cycle/${s}`},SELLERS:{BY_USER_ID:s=>`/sellers/by-user/${s}`,ACTIVE:"/sellers/active"},DATAFAST:{CREATE_CHECKOUT:"/datafast/create-checkout",VERIFY_PAYMENT:"/datafast/verify-payment",WEBHOOK:"/datafast/webhook"}};class ${static async get(e,t,a){try{const n=this.transformParamsToSnakeCase(t),o=await q.get(e,{params:n,...a});return this.handleApiResponse(o)}catch(n){throw this.handleApiError(n,e,"GET"),n}}static async post(e,t,a){try{const n=t instanceof FormData?t:t?this.transformDataToSnakeCase(t):void 0;e.includes("/deuna/payments")&&console.log("🔍 API CLIENT - DATA TRANSFORMATION:",{original_data:t,transformed_data:n,original_items:t?.items,transformed_items:n?.items,original_first_item:t?.items?.[0],transformed_first_item:n?.items?.[0]});const o=await q.post(e,n,a);return this.handleApiResponse(o)}catch(n){throw this.handleApiError(n,e,"POST"),n}}static async put(e,t,a){try{const n=t?this.transformDataToSnakeCase(t):void 0,o=await q.put(e,n,a);return this.handleApiResponse(o)}catch(n){throw this.handleApiError(n,e,"PUT"),n}}static async patch(e,t,a){try{const n=t?this.transformDataToSnakeCase(t):void 0,o=await q.patch(e,n,a);return this.handleApiResponse(o)}catch(n){throw this.handleApiError(n,e,"PATCH"),n}}static async delete(e,t){try{const a=await q.delete(e,t);return this.handleApiResponse(a)}catch(a){throw this.handleApiError(a,e,"DELETE"),a}}static async uploadFile(e,t,a){try{const n=await q.post(e,t,{headers:{"Content-Type":"multipart/form-data"},...a});return this.handleApiResponse(n)}catch(n){throw this.handleApiError(n,e,"UPLOAD"),n}}static async updateFile(e,t,a){try{t.append("_method","PUT");const n=await q.post(e,t,{headers:{"Content-Type":"multipart/form-data"},...a});return this.handleApiResponse(n)}catch(n){throw this.handleApiError(n,e,"UPDATE"),n}}static transformParamsToSnakeCase(e){if(!e)return;const t={};return Object.entries(e).forEach(([a,n])=>{const o=a.replace(/([A-Z])/g,"_$1").toLowerCase(),i=a.includes("_")?a:o;t[i]=n}),t}static transformDataToSnakeCase(e){if(!e||typeof e!="object")return e;if(Array.isArray(e))return e.map((n,o)=>{const i=this.transformDataToSnakeCase(n);return typeof n=="object"&&n!==null&&(n.product_id!==void 0||n.name!==void 0)&&console.log(`🔍 TRANSFORM ARRAY ITEM ${o}:`,{original:n,transformed:i,original_keys:Object.keys(n),transformed_keys:Object.keys(i),product_id_preserved:i.product_id===n.product_id}),i});const t={};return Object.entries(e).forEach(([a,n])=>{const o=a.replace(/([A-Z])/g,"_$1").toLowerCase(),i=a.includes("_")?a:o;n!==null&&typeof n=="object"?t[i]=this.transformDataToSnakeCase(n):t[i]=n}),t}static handleApiResponse(e){if(!e)throw new Error("Respuesta vacía de la API");return e.data?(e.data.data&&(Array.isArray(e.data.data)||typeof e.data.data=="object"),e.data):e}static handleApiError(e,t,a){if(z.isAxiosError(e)){const{response:n}=e;console.error(`API Error (${a} ${t}):`,{status:n?.status,statusText:n?.statusText,data:n?.data}),n?.status===401?console.error("Error de autenticación - el token puede ser inválido o estar ausente"):n?.status===422?console.error("Error de validación:",n.data?.errors||n.data):n?.status===404?console.error("Recurso no encontrado"):n?.status===500?console.error("Error del servidor"):e.message.includes("Network Error")&&console.error("Error de red - podría ser un problema de CORS")}else console.error(`Error desconocido (${a} ${t}):`,e)}}class re{static instance;unifiedConfig=null;cacheExpiry=null;CACHE_DURATION=30*1e3;VERSION="1.0.0";cacheHits=0;cacheMisses=0;apiCalls=0;lastCacheHit=null;lastCacheMiss=null;constructor(){}static getInstance(){return re.instance||(re.instance=new re),re.instance}async getSynchronizedConfig(e=3){let t=0,a=null;for(;t<e;){t++;try{console.log(`🔄 JORDAN - Intento ${t}/${e} de sincronización de configuración`);const n=t===1&&a!==null,o=await this.getUnifiedConfig(n);if(o.source!=="fallback"||o.errors.length===0)return t>1&&console.log(`✅ JORDAN - Sincronización exitosa en intento ${t}`),o;if(t===e)return console.warn("⚠️ JORDAN - Usando configuración fallback después de múltiples intentos"),o}catch(n){if(a=n,console.warn(`⚠️ JORDAN - Error en intento ${t}: ${a.message}`),t===e)return console.error("❌ JORDAN - Todos los intentos fallaron, usando configuración de emergencia"),{config:this.getSecureFallbackConfig(),source:"fallback",is_stale:!0,errors:[`Failed after ${e} attempts: ${a.message}`],warnings:["Using emergency fallback configuration due to repeated failures"]};const o=Math.min(1e3*Math.pow(2,t-1),5e3);await new Promise(i=>setTimeout(i,o))}}throw new Error("Unexpected error in configuration synchronization")}async getUnifiedConfig(e=!1){if(console.log("🔧 JORDAN ConfigurationManager - Obteniendo configuración unificada"),!e&&this.isConfigCacheValid()){const t=this.unifiedConfig.updated_at,a=Date.now()-10*1e3;return new Date(t).getTime()<a?(console.warn("🚨 CRITICAL: Cache potencialmente stale para keys críticos, forzando refresh"),this.getUnifiedConfig(!0)):(this.cacheHits++,this.lastCacheHit=new Date().toISOString(),console.log("✅ JORDAN - Cache HIT - Usando configuración desde cache (validada crítica)"),{config:this.unifiedConfig,source:"cache",is_stale:!1,errors:[],warnings:[]})}this.cacheMisses++,this.apiCalls++,this.lastCacheMiss=new Date().toISOString(),console.log("🔄 JORDAN - Cache MISS - Obteniendo desde API");try{const t=await this.fetchUnifiedConfigFromAPI(),a=this.validateConfiguration(t);if(a.is_valid){this.unifiedConfig=t,this.cacheExpiry=Date.now()+this.CACHE_DURATION,console.log("✅ JORDAN - Configuración unificada cargada y validada");const n=t._failedEndpoints||[],o=n.length>0?[`${n.length} endpoints fallaron: ${n.join(", ")} - usando valores por defecto`]:[];return{config:t,source:"api",is_stale:!1,errors:[],warnings:[...a.warnings,...o]}}else return console.warn("⚠️ Configuración de API inválida, usando fallback"),{config:this.getSecureFallbackConfig(),source:"fallback",is_stale:!0,errors:a.errors,warnings:["Usando configuración de respaldo debido a errores en API"]}}catch(t){console.error("❌ Error obteniendo configuraciones:",t);const a=this.getSecureFallbackConfig(),n=t instanceof Error?t.message:"Unknown",o=["platform-commission endpoint failed","shipping endpoint failed","volume-discounts endpoint failed","shipping-distribution endpoint failed","tax endpoint failed"];return{config:a,source:"fallback",is_stale:!0,errors:n.includes("Todos los endpoints")?o:[`Error crítico: ${n}`],warnings:["Sistema usando valores de emergencia"]}}}getConfigSync(){return this.isConfigCacheValid()?this.unifiedConfig:null}async fetchUnifiedConfigFromAPI(){console.log("🌐 Obteniendo configuraciones desde endpoint unificado...");try{const e=await $.get(D.ADMIN.PUBLIC_CONFIGURATIONS.UNIFIED);if(e&&typeof e=="object"&&"status"in e){const t=e;if(t.status==="success"&&t.data)return console.log("✅ UNIFIED CONFIG: Configuración unificada obtenida exitosamente"),t.data}throw new Error("Invalid unified config response")}catch(e){throw console.error("❌ UNIFIED CONFIG FAILED: Sin fallback - usar valores por defecto",e),e}}validateConfiguration(e){const t=[],a=[];return(e.tax_rate<0||e.tax_rate>1)&&t.push(`tax_rate inválido: ${e.tax_rate}`),(e.platform_commission_rate<0||e.platform_commission_rate>.5)&&t.push(`platform_commission_rate inválido: ${e.platform_commission_rate}`),e.shipping.default_cost<0&&t.push(`shipping.default_cost inválido: ${e.shipping.default_cost}`),e.shipping.free_threshold<0&&t.push(`shipping.free_threshold inválido: ${e.shipping.free_threshold}`),(!Array.isArray(e.volume_discounts)||e.volume_discounts.length===0)&&a.push("No hay descuentos por volumen configurados"),{is_valid:t.length===0,errors:t,warnings:a}}getSecureFallbackConfig(){return{tax_rate:.15,platform_commission_rate:.1,shipping:{enabled:!0,default_cost:5,free_threshold:50,seller_percentage_single:.8,seller_percentage_max_multi:.4},shipping_distribution:{seller_percentage_single:.8,seller_percentage_max_multi:.4},volume_discounts:[{quantity:3,discount:5,label:"3+"},{quantity:5,discount:8,label:"5+"},{quantity:10,discount:15,label:"10+"}],updated_at:new Date().toISOString(),version:this.VERSION+"-fallback",is_valid:!1}}isConfigCacheValid(){return this.unifiedConfig!==null&&this.cacheExpiry!==null&&Date.now()<this.cacheExpiry}invalidateCache(){this.unifiedConfig=null,this.cacheExpiry=null,this.cacheMisses++,this.lastCacheMiss=new Date().toISOString(),console.log("🔄 JORDAN - Cache de configuración invalidado")}getStats(){const e=this.cacheExpiry?(Date.now()-(this.cacheExpiry-this.CACHE_DURATION))/1e3:null,t=this.cacheHits+this.cacheMisses,a=t>0?this.cacheHits/t:0;return{cache_valid:this.isConfigCacheValid(),cache_age_seconds:e,version:this.VERSION,last_config_source:this.unifiedConfig?"loaded":"none",cache_hits:this.cacheHits,cache_misses:this.cacheMisses,cache_hit_rate:Math.round(a*100)/100,api_calls:this.apiCalls,last_cache_hit:this.lastCacheHit,last_cache_miss:this.lastCacheMiss}}resetCacheMetrics(){this.cacheHits=0,this.cacheMisses=0,this.apiCalls=0,this.lastCacheHit=null,this.lastCacheMiss=null,console.log("🔄 JORDAN - Métricas de cache reseteadas")}}function Ee(s){if(typeof s!="number"||isNaN(s))return"$0.00";const e=Number(s.toFixed(2));return new Intl.NumberFormat("es-EC",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(e)}const Er=`data:image/svg+xml,${encodeURIComponent(`
<svg width="300" height="300" xmlns="http://www.w3.org/2000/svg">
  <rect width="300" height="300" fill="#e5e7eb"/>
  <circle cx="150" cy="120" r="30" fill="#9ca3af"/>
  <path d="M90 180L120 150L150 200L180 130L210 200V230H90V180Z" fill="#9ca3af"/>
  <text x="150" y="260" font-family="Arial, sans-serif" font-size="14" fill="#6b7280" text-anchor="middle">
    Sin imagen
  </text>
</svg>
`)}`;function qe(s){if(!s||s.trim()==="")return Er;const e=s.trim();if(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("data:"))return e;{let t=e;return t.startsWith("/storage/")?t=t.substring(9):t.startsWith("storage/")&&(t=t.substring(8)),`${fr.imageBaseUrl}${t}`}}function gr(s){if(!s)return Er;if(console.log("🔍 Analizando producto para imagen principal:",{id:s.id,main_image:s.main_image,image:s.image,images:s.images}),s.main_image&&typeof s.main_image=="string")return console.log("✅ Usando main_image:",s.main_image),qe(s.main_image);if(s.image&&typeof s.image=="string")return console.log("✅ Usando image:",s.image),qe(s.image);if(s.images&&Array.isArray(s.images)&&s.images.length>0){const e=s.images[0];if(console.log("📋 Primer imagen del array:",e),typeof e=="string"&&e.trim()!=="")return console.log("✅ Usando primera imagen string:",e),qe(e);if(typeof e=="object"&&e!==null){const t=e.original||e.large||e.medium||e.thumbnail||"";if(t&&typeof t=="string")return console.log("✅ Usando imagen del objeto:",t),qe(t)}}return console.log("⚠️ No se encontró imagen, usando placeholder"),Er}const ve=(s,e="Ha ocurrido un error")=>{if(s instanceof Error)return s.message;if(s&&typeof s=="object"){if("response"in s&&s.response){const{response:t}=s;if(t.data){if(typeof t.data.message=="string")return t.data.message;if(t.data.errors&&typeof t.data.errors=="object"){const a=Object.values(t.data.errors).flat();if(a.length>0)return Array.isArray(a[0])?a[0].join(". "):a.join(". ")}if(typeof t.data=="string")return t.data}if(t.status)return Ha(t.status)}if("message"in s&&typeof s.message=="string")return s.message.includes("network")||s.message.includes("Network")?"Error de conexión. Verifica tu conexión a internet.":s.message.includes("timeout")?"La solicitud ha tardado demasiado tiempo. Intenta de nuevo más tarde.":s.message}return e},Ha=s=>{switch(s){case 400:return"Solicitud incorrecta. Verifica los datos enviados.";case 401:return"No estás autorizado. Inicia sesión nuevamente.";case 403:return"No tienes permiso para realizar esta acción.";case 404:return"El recurso solicitado no se ha encontrado.";case 422:return"Error de validación. Verifica los datos enviados.";case 500:return"Error en el servidor. Intenta más tarde o contacta al soporte.";case 503:return"Servicio no disponible. Intenta más tarde.";default:return`Error ${s}. Por favor, intenta de nuevo.`}};class Ne{static instance;listeners=new Map;static getInstance(){return Ne.instance||(Ne.instance=new Ne),Ne.instance}subscribe(e,t){return this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t),()=>{const a=this.listeners.get(e);a&&(a.delete(t),a.size===0&&this.listeners.delete(e))}}invalidate(e){console.log(`🔄 Invalidando cache: ${e}`),Object.keys(localStorage).filter(o=>this.matchesPattern(o,e)).forEach(o=>{de.removeItem(o)});const n=this.listeners.get(e);n&&n.forEach(o=>o()),this.notifyRelatedPatterns(e)}matchesPattern(e,t){const a=t.replace(/\*/g,".*").replace(/\?/g,".");return new RegExp(`^${a}$`).test(e)}notifyRelatedPatterns(e){this.listeners.forEach((t,a)=>{a!==e&&this.areRelatedPatterns(e,a)&&t.forEach(n=>n())})}areRelatedPatterns(e,t){const a=e.split("_")[0],n=t.split("_")[0];return a===n}}function Rs(){const s=g.useRef(Ne.getInstance());return{invalidate:e=>{s.current.invalidate(e)},invalidateMany:e=>{e.forEach(t=>{s.current.invalidate(t)})},invalidateAfterMutation:e=>{setTimeout(()=>{e.forEach(t=>{s.current.invalidate(t)})},0)}}}const Ka=({currentPage:s,totalPages:e,onPageChange:t})=>{if(e<=1)return null;const n=(()=>{const o=[];o.push(1),s>3&&o.push("...");for(let i=Math.max(2,s-1);i<=Math.min(e-1,s+1);i++)i>1&&i<e&&o.push(i);return s<e-2&&o.push("..."),e>1&&o.push(e),o})();return r.jsxs("div",{className:"bg-white px-4 py-3 border-t border-gray-200",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("button",{onClick:()=>t(s-1),disabled:s===1,className:"relative inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[r.jsx(Ks,{className:"w-4 h-4 mr-2"}),r.jsx("span",{className:"hidden sm:inline",children:"Anterior"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("div",{className:"flex sm:hidden items-center",children:r.jsxs("span",{className:"text-sm text-gray-700",children:[r.jsx("span",{className:"font-semibold text-primary-600",children:s}),r.jsx("span",{className:"mx-1",children:"de"}),r.jsx("span",{className:"font-semibold",children:e})]})}),r.jsx("div",{className:"hidden sm:flex items-center space-x-1",children:n.map((o,i)=>typeof o=="number"?r.jsx("button",{onClick:()=>t(o),className:`relative inline-flex items-center justify-center w-10 h-10 text-sm font-medium rounded-lg transition-colors ${s===o?"bg-primary-600 text-white shadow-sm":"text-gray-700 bg-white border border-gray-300 hover:bg-gray-50"}`,children:o},i):r.jsx("span",{className:"relative inline-flex items-center justify-center w-10 h-10 text-sm text-gray-400",children:o},i))})]}),r.jsxs("button",{onClick:()=>t(s+1),disabled:s===e,className:"relative inline-flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[r.jsx("span",{className:"hidden sm:inline",children:"Siguiente"}),r.jsx(Cr,{className:"w-4 h-4 ml-2"})]})]}),r.jsx("div",{className:"hidden sm:block mt-3 text-center",children:r.jsxs("p",{className:"text-xs text-gray-500",children:["Mostrando página ",s," de ",e]})})]})};function ar({data:s,columns:e,searchFields:t=[],loading:a=!1,emptyMessage:n="No hay datos disponibles",pagination:o}){const[i,d]=g.useState(""),[c,h]=g.useState(null),m=y=>{let _="ascending";c&&c.key===y&&(_=c.direction==="ascending"?"descending":"ascending"),h({key:y,direction:_})},v=g.useMemo(()=>{let y=[...s];return i&&t.length>0&&(y=s.filter(_=>t.some(l=>{const C=_[l];return C&&String(C).toLowerCase().includes(i.toLowerCase())}))),c&&y.sort((_,l)=>{const C=_[c.key],f=l[c.key];return C<f?c.direction==="ascending"?-1:1:C>f?c.direction==="ascending"?1:-1:0}),y},[s,i,t,c]);return r.jsxs("div",{className:"space-y-4",children:[t.length>0&&r.jsxs("div",{className:"relative",children:[r.jsx("input",{type:"text",placeholder:"Buscar...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:i,onChange:y=>d(y.target.value)}),r.jsx(wr,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"})]}),r.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:a?r.jsx("div",{className:"p-8 flex justify-center",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})}):v.length===0?r.jsxs("div",{className:"p-8 text-center",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:n}),r.jsx("p",{className:"text-gray-500",children:"Intente ajustar su búsqueda para encontrar lo que está buscando."})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsx("tr",{children:e.map(y=>r.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:r.jsxs("div",{className:"flex items-center space-x-1",children:[r.jsx("span",{children:y.header}),y.sortable&&r.jsx("button",{onClick:()=>m(y.key),className:"ml-1 focus:outline-none",children:c?.key===y.key?c.direction==="ascending"?r.jsx(Qr,{size:14,className:"text-primary-500"}):r.jsx(es,{size:14,className:"text-primary-500"}):r.jsx("div",{className:"h-3.5 w-3.5"})})]})},y.key))})}),r.jsx("tbody",{className:"bg-whitedivide-y divide-gray-200",children:v.map((y,_)=>r.jsx("tr",{className:"hover:bg-gray-50",children:e.map(l=>r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:l.render?l.render(y):String(y[l.key]||"")},l.key))},_))})]})}),o&&r.jsxs("div",{className:"px-6 py-3 flex justify-between items-center border-t border-gray-200",children:[r.jsx("div",{children:r.jsxs("p",{className:"text-sm text-gray-700",children:["Mostrando"," ",r.jsx("span",{className:"font-medium",children:(o.currentPage-1)*o.itemsPerPage+1})," ","a"," ",r.jsx("span",{className:"font-medium",children:Math.min(o.currentPage*o.itemsPerPage,o.totalItems)})," ","de"," ",r.jsx("span",{className:"font-medium",children:o.totalItems})," ","elementos"]})}),r.jsx(Ka,{currentPage:o.currentPage,totalPages:o.totalPages,onPageChange:o.onPageChange})]})]})})]})}const Wa=({title:s,value:e,change:t,text:a=null,icon:n,iconBgColor:o="bg-gray-100",iconColor:i="text-gray-600"})=>{const d=t>0,c=d?"text-green-600":"text-red-600";return r.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 flex items-start justify-between",children:[r.jsxs("div",{children:[r.jsx("p",{className:"text-sm font-medium text-gray-500",children:s}),r.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:e}),t!==0&&r.jsxs("div",{className:`flex items-center mt-2 ${c}`,children:[d?r.jsx(Qr,{size:16}):r.jsx(es,{size:16}),r.jsxs("span",{className:"ml-1 text-sm font-medium",children:[Math.abs(t),"% respecto al mes anterior"]})]}),a&&r.jsx("span",{className:"text-sm text-gray-500 mt-2",children:a})]}),r.jsx("div",{className:`p-3 rounded-lg ${o}`,children:r.jsx(n,{className:`w-6 h-6 ${i}`})})]})},Ja=({cards:s})=>r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:s.map((e,t)=>r.jsx(Wa,{...e},t))}),Xa=({icon:s,iconBgColor:e,iconColor:t,title:a,color:n=!1,description:o,linkText:i,linkTo:d})=>r.jsxs("div",{className:`${n?"bg-white":"bg-gray-50"} p-4 rounded-lg flex items-start`,children:[r.jsx("div",{className:`p-2 rounded-lg mr-3 ${e}`,children:r.jsx(s,{className:`w-5 h-5 ${t}`})}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-medium text-gray-900",children:a}),r.jsx("p",{className:"text-sm text-gray-500 mb-2",children:o}),r.jsxs(Y,{to:d,className:"text-primary-600 text-sm font-medium hover:underline inline-flex items-center",children:[i," ",r.jsx(Cr,{size:16})]})]})]}),Ya=({items:s,color:e})=>r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:s.map((t,a)=>r.jsx(Xa,{...t,color:e},a))}),Za=({title:s,className:e=""})=>r.jsxs("div",{className:`bg-white rounded-lg shadow-sm ${e}`,children:[r.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:r.jsx("h2",{className:"text-lg font-medium text-gray-900",children:s})}),r.jsx("div",{className:"p-6 text-center text-gray-500",children:"No hay datos disponibles"})]}),Is=({title:s,viewAllLink:e,viewAllText:t="Ver todo"})=>r.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex justify-between items-center",children:[r.jsx("h2",{className:"text-lg font-medium text-gray-900",children:s}),e&&r.jsxs(Y,{to:e,className:"text-primary-600 text-sm font-medium hover:underline flex items-center",children:[t," ",r.jsx(Cr,{size:16})]})]});function Qa({data:s,columns:e,title:t,viewAllLink:a,viewAllText:n,className:o="",onRowClick:i}){const d=(c,h)=>{const m=c[h.key];return h.render?h.render(m,c):typeof m>"u"||m===null?"-":m};return r.jsxs("div",{className:`bg-white rounded-lg shadow-sm ${o}`,children:[r.jsx(Is,{title:t,viewAllLink:a,viewAllText:n}),r.jsx("div",{className:"overflow-x-auto",children:r.jsxs("table",{className:"min-w-full",children:[r.jsx("thead",{className:"bg-gray-50",children:r.jsx("tr",{children:e.map((c,h)=>r.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:c.header},h))})}),r.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map((c,h)=>r.jsx("tr",{className:`hover:bg-gray-50 ${i?"cursor-pointer":""}`,onClick:i?()=>i(c):void 0,children:e.map((m,v)=>r.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:d(c,m)},v))},h))})]})})]})}function en({data:s,columns:e,title:t,viewAllLink:a,viewAllText:n,className:o="",onRowClick:i}){const d=(c,h)=>{const m=c[h.key];return h.render?h.render(m,c):typeof m>"u"||m===null?"-":m};return r.jsxs("div",{className:`bg-white rounded-lg shadow-sm ${o}`,children:[r.jsx(Is,{title:t,viewAllLink:a,viewAllText:n}),r.jsx("div",{className:"divide-y divide-gray-200",children:s.map((c,h)=>r.jsx("div",{className:`px-6 py-3 flex flex-wrap items-center gap-3 hover:bg-gray-50 ${i?"cursor-pointer":""}`,onClick:i?()=>i(c):void 0,children:e.map((m,v)=>r.jsxs("div",{className:"flex items-center",children:[m.showLabelInCompact&&r.jsxs("span",{className:"text-xs text-gray-500 mr-1",children:[m.header,":"]}),r.jsx("span",{className:"text-sm",children:d(c,m)})]},v))},h))})]})}function Os(s){const{data:e,compact:t=!1}=s;return!e||e.length===0?r.jsx(Za,{title:s.title,className:s.className}):t?r.jsx(en,{...s}):r.jsx(Qa,{...s})}const rn=({icon:s=J,borderColor:e,bgColor:t,iconColor:a,title:n,description:o,linkText:i,linkTo:d,textColor:c,hoverTextColor:h})=>r.jsx("div",{className:`${t} border-l-4 ${e} p-4 rounded-r-lg`,children:r.jsxs("div",{className:"flex",children:[r.jsx("div",{className:"flex-shrink-0",children:r.jsx(s,{className:`h-5 w-5 ${a}`})}),r.jsxs("div",{className:"ml-3",children:[r.jsx("h3",{className:`text-sm font-medium ${c}`,children:n}),r.jsx("div",{className:`mt-2 text-sm ${c}`,children:r.jsx("p",{children:o})}),r.jsx("div",{className:"mt-3",children:r.jsx(Y,{to:d,className:`text-sm font-medium ${c} hover:${h}`,children:i})})]})]})}),sn=({items:s})=>r.jsx("div",{className:"space-y-4",children:s.map((e,t)=>r.jsx(rn,{...e},t))}),tn=()=>[{key:"id",header:"ID Pedido",showLabelInCompact:!1,render:s=>r.jsxs(Y,{to:`/admin/orders/${s}`,className:"text-primary-600 hover:underline font-medium",children:["#",s]})},{key:"date",header:"Fecha",showLabelInCompact:!0},{key:"customer",header:"Cliente",showLabelInCompact:!0,render:s=>r.jsx("span",{className:"text-gray-900",children:s})},{key:"total",header:"Total",showLabelInCompact:!0,render:s=>Ee(s)},{key:"status",header:"Estado",showLabelInCompact:!0,render:s=>{let e="bg-yellow-100 text-yellow-800",t="En Proceso";return s==="Completed"?(e="bg-green-100 text-green-800",t="Completado"):s==="Shipped"&&(e="bg-blue-100 text-blue-800",t="Enviado"),r.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${e}`,children:t})}}],an=({orders:s,title:e,viewAllLink:t,viewAllText:a,compact:n=!1,className:o="",onOrderClick:i})=>r.jsx(Os,{data:s,columns:tn(),title:e,viewAllLink:t,viewAllText:a,compact:n,className:o,onRowClick:i}),nn=()=>[{key:"name",header:"Vendedor",showLabelInCompact:!1,render:(s,e)=>r.jsx(Y,{to:`/admin/sellers/${e.id}`,className:"text-primary-600 hover:underline font-medium",children:s})},{key:"orderCount",header:"Pedidos",showLabelInCompact:!0},{key:"revenue",header:"Ingresos",showLabelInCompact:!0,render:s=>Ee(s)}],on=({sellers:s,title:e,viewAllLink:t,viewAllText:a,compact:n=!1,className:o="",onSellerClick:i})=>r.jsx(Os,{data:s,columns:nn(),title:e,viewAllLink:t,viewAllText:a,compact:n,className:o,onRowClick:i});class ln{async getDashboardStats(){try{const e=await $.get("/admin/dashboard");if(!e.success)throw new Error(e.message||"Failed to fetch dashboard statistics");return e.data}catch(e){throw console.error("Error fetching dashboard statistics:",e),e}}transformToLegacyFormat(e){return{cards:[{title:"Ventas Totales",value:e.main_stats.total_sales.formatted_value,change:e.main_stats.total_sales.change,icon:"DollarSign",iconBgColor:"bg-green-50",iconColor:"text-green-600"},{title:"Usuarios Totales",value:e.main_stats.total_users.value,change:e.main_stats.total_users.change,icon:"Users",iconBgColor:"bg-blue-50",iconColor:"text-blue-600"},{title:"Pedidos Totales",value:e.main_stats.total_orders.value,change:e.main_stats.total_orders.change,icon:"ShoppingBag",iconBgColor:"bg-purple-50",iconColor:"text-purple-600"},{title:"Productos Activos",value:e.main_stats.active_products.formatted_value,change:e.main_stats.active_products.change,icon:"Package",iconBgColor:"bg-yellow-50",iconColor:"text-yellow-600"}],pendingCardItems:[{icon:"Star",iconBgColor:"bg-yellow-50",iconColor:"text-yellow-600",title:"Valoraciones y Reseñas",description:e.pending_items.pending_ratings.message,linkText:"Moderar Reseñas",linkTo:"/admin/ratings?status=pending"},{icon:"Briefcase",iconBgColor:"bg-blue-50",iconColor:"text-blue-600",title:"Solicitudes de Vendedores",description:e.pending_items.pending_sellers.message,linkText:"Ver solicitudes",linkTo:"/admin/sellers?status=pending"},{icon:"MessageSquare",iconBgColor:"bg-purple-50",iconColor:"text-purple-600",title:"Customer Feedback",description:e.pending_items.pending_feedback.message,linkText:"Revisar Comentarios",linkTo:"/admin/feedback?status=pending"}],alertItems:e.system_alerts.map(t=>({icon:"AlertTriangle",borderColor:t.type==="error"?"border-red-500":"border-amber-500",bgColor:t.type==="error"?"bg-red-50":"bg-amber-50",iconColor:t.type==="error"?"text-red-500":"text-amber-500",title:t.title,description:t.description,linkText:"Ver detalles",linkTo:t.link_to,textColor:t.type==="error"?"text-red-800":"text-amber-800",hoverTextColor:t.type==="error"?"text-red-600":"text-amber-600"})),recentOrders:e.recent_orders.map(t=>({id:t.id,date:t.date,customer:t.customer,total:t.total,status:this.mapOrderStatus(t.status)})),topSellers:e.top_sellers.map(t=>({id:t.id,name:t.name,orderCount:t.order_count,revenue:t.revenue})),performanceMetrics:e.performance_metrics,lastUpdated:e.last_updated}}mapOrderStatus(e){return{Completado:"Completed",completed:"Completed",Completed:"Completed",Procesando:"Processing",processing:"Processing",Processing:"Processing",Pendiente:"Processing",pending:"Processing",Enviado:"Shipped",shipped:"Shipped",Shipped:"Shipped",delivered:"Shipped",Entregado:"Shipped"}[e]||"Processing"}}const Zr=new ln,cn=(s=!1,e=6e4)=>{const[t,a]=g.useState(null),[n,o]=g.useState(!0),[i,d]=g.useState(null),[c,h]=g.useState(null),m=g.useCallback(async()=>{try{o(!0),d(null);const y=await Zr.getDashboardStats();a(y),h(new Date().toISOString())}catch(y){d(y instanceof Error?y.message:"Error fetching dashboard statistics"),console.error("Dashboard stats fetch error:",y)}finally{o(!1)}},[]);g.useEffect(()=>{m()},[m]),g.useEffect(()=>{if(!s)return;const y=setInterval(()=>{m()},e);return()=>clearInterval(y)},[s,e,m]);const v=t?Zr.transformToLegacyFormat(t):null;return{stats:t,transformedData:v,loading:n,error:i,refetch:m,lastUpdated:c}},dn=()=>{const s=dt(),{transformedData:e,loading:t,error:a,refetch:n,lastUpdated:o}=cn(!0,3e5),i=_=>{s(`/admin/orders/${_.id}`)},d=_=>{s(`/admin/sellers/${_.id}`)},c=async()=>{await n()};if(t&&!e)return r.jsxs("div",{className:"space-y-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard Admin"}),r.jsxs("div",{className:"flex items-center justify-center py-12",children:[r.jsx(G,{className:"w-6 h-6 animate-spin text-gray-400 mr-2"}),r.jsx("span",{className:"text-gray-600",children:"Cargando estadísticas del dashboard..."})]})]});if(a&&!e)return r.jsxs("div",{className:"space-y-6",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard Admin"}),r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(J,{className:"w-5 h-5 text-red-400 mr-2"}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error cargando dashboard"}),r.jsx("p",{className:"text-sm text-red-700 mt-1",children:a}),r.jsx("button",{onClick:c,className:"mt-2 text-sm bg-red-600 hover:bg-red-700 text-white px-3 py-1 rounded-md transition-colors",children:"Intentar nuevamente"})]})]})})]});if(!e)return null;const h=_=>({DollarSign:Je,Users:rs,ShoppingBag:pr,Package:Ar,Star:me,Briefcase:Js,MessageSquare:Ws,AlertTriangle:J})[_]||J,m=e.cards.map(_=>({..._,icon:h(_.icon)})),v=e.pendingCardItems.map(_=>({..._,icon:h(_.icon)})),y=e.alertItems.map(_=>({..._,icon:h(_.icon)}));return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard Admin"}),r.jsxs("div",{className:"flex items-center space-x-3",children:[o&&r.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[r.jsx(Ie,{className:"w-4 h-4 mr-1"}),"Actualizado: ",new Date(o).toLocaleTimeString()]}),r.jsxs("button",{onClick:c,disabled:t,className:"flex items-center px-3 py-2 text-sm bg-primary-600 hover:bg-primary-700 disabled:bg-primary-400 text-white rounded-md transition-colors",children:[r.jsx(G,{className:`w-4 h-4 mr-1 ${t?"animate-spin":""}`}),"Actualizar"]})]})]}),r.jsx(Ja,{cards:m}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[r.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Moderación Pendiente"}),r.jsx(Ya,{items:v})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsx(an,{orders:e.recentOrders,title:"Pedidos Recientes",viewAllLink:"/admin/orders",onOrderClick:i}),r.jsx(on,{sellers:e.topSellers,title:"Mejores Vendedores",viewAllLink:"/admin/sellers",onSellerClick:d})]}),y.length>0&&r.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[r.jsxs("div",{className:"flex items-center mb-4",children:[r.jsx(J,{className:"w-5 h-5 text-amber-500 mr-2"}),r.jsx("h2",{className:"text-lg font-medium text-gray-900",children:"Alertas del Sistema"})]}),r.jsx(sn,{items:y})]}),e.performanceMetrics&&r.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[r.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Métricas de Rendimiento"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"text-center",children:[r.jsxs("div",{className:"text-2xl font-bold text-primary-600",children:[e.performanceMetrics.conversion_rate.toFixed(1),"%"]}),r.jsx("div",{className:"text-sm text-gray-600",children:"Tasa de Conversión"})]}),r.jsxs("div",{className:"text-center",children:[r.jsxs("div",{className:"text-2xl font-bold text-green-600",children:["$",e.performanceMetrics.average_order_value.toFixed(2)]}),r.jsx("div",{className:"text-sm text-gray-600",children:"Valor Promedio de Orden"})]}),r.jsxs("div",{className:"text-center",children:[r.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[e.performanceMetrics.order_fulfillment_rate.toFixed(1),"%"]}),r.jsx("div",{className:"text-sm text-gray-600",children:"Tasa de Cumplimiento"})]}),r.jsxs("div",{className:"text-center",children:[r.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[e.performanceMetrics.customer_retention_rate.toFixed(1),"%"]}),r.jsx("div",{className:"text-sm text-gray-600",children:"Retención de Clientes"})]})]})]})]})},Ro=Object.freeze(Object.defineProperty({__proto__:null,default:dn},Symbol.toStringTag,{value:"Module"}));class un{async getUsers(e=1,t=15){return(await q.get(D.ADMIN.USERS,{params:{page:e,per_page:t}})).data}async blockUser(e){return(await q.put(D.ADMIN.BLOCK_USER(e))).data.success}async unblockUser(e){return(await q.put(D.ADMIN.UNBLOCK_USER(e))).data.success}async sendPasswordResetEmail(e){return(await q.post(D.ADMIN.RESET_PASSWORD(e))).data.success}async getUserDetails(e){return(await q.get(D.ADMIN.USER_DETAIL(e))).data}async makeAdmin(e){return(await q.put(D.ADMIN.MAKE_ADMIN(e))).data.success}async makeSeller(e,t){return(await q.post(D.ADMIN.MAKE_SELLER(e),t)).data.success}async deleteUser(e){return(await q.delete(D.ADMIN.DELETE_USER(e))).data.success}}const mn=()=>{const[s,e]=g.useState([]),[t,a]=g.useState(!0),[n,o]=g.useState(null),[i,d]=g.useState({currentPage:1,totalPages:5,totalItems:0,itemsPerPage:10}),c=new un,h=w=>{let E="customer";w.is_admin?E="admin":w.is_seller&&(E="seller");const R=w.is_blocked?"blocked":"active";return{id:w.id,name:w.name,email:w.email,role:E,status:R,lastLogin:w.last_login_at||"N/A",registeredDate:w.created_at,ordersCount:w.orders_count||0}},m=g.useCallback(async(w=1,E=10)=>{a(!0),o(null);try{const R=await c.getUsers(w,E),x=R.data.map(h);return e(x),d({currentPage:R.meta.current_page,totalPages:R.meta.last_page,totalItems:R.meta.total,itemsPerPage:R.meta.per_page}),x}catch(R){const x=ve(R,"Error al obtener la lista de usuarios");return console.error("Error fetching users:",x),o(x),[]}finally{a(!1)}},[]),v=g.useCallback(async(w,E)=>{a(!0),o(null);try{let R;return E?R=await c.unblockUser(w):R=await c.blockUser(w),R?(e(x=>x.map(T=>T.id===w?{...T,status:E?"active":"blocked"}:T)),!0):(o(`No se pudo ${E?"desbloquear":"bloquear"} al usuario`),!1)}catch(R){const x=ve(R,`Error al ${E?"desbloquear":"bloquear"} al usuario`);return console.error("Error toggling user status:",x),o(x),!1}finally{a(!1)}},[]),y=g.useCallback(async w=>{a(!0),o(null);try{const E=await c.sendPasswordResetEmail(w);return E||o("No se pudo enviar el correo de restablecimiento de contraseña"),E}catch(E){const R=ve(E,"Error al enviar correo de restablecimiento");return console.error("Error sending password reset:",R),o(R),!1}finally{a(!1)}},[]),_=g.useCallback(async w=>{a(!0),o(null);try{return await c.makeAdmin(w)?(e(R=>R.map(x=>x.id===w?{...x,role:"admin"}:x)),!0):(o("No se pudo convertir al usuario en administrador"),!1)}catch(E){const R=ve(E,"Error al convertir usuario en administrador");return console.error("Error making user admin:",R),o(R),!1}finally{a(!1)}},[]),l=g.useCallback(async(w,E)=>{a(!0),o(null);try{return await c.makeSeller(w,E)?(e(x=>x.map(T=>T.id===w?{...T,role:"seller"}:T)),!0):(o("No se pudo convertir al usuario en vendedor"),!1)}catch(R){const x=ve(R,"Error al convertir usuario en vendedor");return console.error("Error making user seller:",x),o(x),!1}finally{a(!1)}},[]),C=g.useCallback(async w=>{a(!0),o(null);try{if(await c.deleteUser(w)){console.log("User deleted successfully, determining optimal page to reload...");const x=s.length===1,T=i.currentPage>1;let p=i.currentPage;x&&T&&(p=i.currentPage-1,console.log(`Last user in page ${i.currentPage}, moving to page ${p}`));try{await m(p,i.itemsPerPage),console.log(`Data successfully reloaded from server after deletion on page ${p}`)}catch(S){if(console.error("Error reloading data after deletion:",S),p>1){console.log("Fallback: trying to load page 1");try{await m(1,i.itemsPerPage)}catch(u){console.error("Fallback failed, updating locally:",u),e(I=>I.filter(P=>P.id!==w)),d(I=>({...I,totalItems:Math.max(0,I.totalItems-1),currentPage:Math.min(I.currentPage,Math.ceil((I.totalItems-1)/I.itemsPerPage)||1)}))}}else e(u=>u.filter(I=>I.id!==w)),d(u=>({...u,totalItems:Math.max(0,u.totalItems-1)}))}return!0}else return o("No se pudo eliminar al usuario"),!1}catch(E){const R=ve(E,"Error al eliminar usuario");return console.error("Error deleting user:",R),o(R),!1}finally{a(!1)}},[m,i.currentPage,i.itemsPerPage,s.length]),f=g.useCallback(async()=>{await m(i.currentPage,i.itemsPerPage)},[m,i.currentPage,i.itemsPerPage]),j=g.useCallback(w=>{const{role:E,status:R,searchTerm:x}=w;return s.filter(T=>{const p=!E||E==="all"||T.role===E,S=!R||R==="all"||T.status===R,u=!x||T.name.toLowerCase().includes(x.toLowerCase())||T.email.toLowerCase().includes(x.toLowerCase());return p&&S&&u})},[s]);return{users:s,loading:t,error:n,pagination:i,fetchUsers:m,toggleUserStatus:v,sendPasswordReset:y,makeUserAdmin:_,makeUserSeller:l,deleteUser:C,refreshData:f,filterUsers:j}},gn=()=>{const{loading:s,error:e,pagination:t,fetchUsers:a,toggleUserStatus:n,sendPasswordReset:o,makeUserAdmin:i,makeUserSeller:d,deleteUser:c,filterUsers:h}=mn(),[m,v]=g.useState("all"),[y,_]=g.useState("all"),[l,C]=g.useState(""),[f,j]=g.useState(null),[w,E]=g.useState(!1),[R,x]=g.useState(null),[T,p]=g.useState(""),[S,u]=g.useState(""),[I,P]=g.useState({}),[U,k]=g.useState(!1),[B,W]=g.useState(null),[ie,ue]=g.useState(""),[te,A]=g.useState(""),[ee,H]=g.useState("notification"),[be,le]=g.useState(!1),[ae,ce]=g.useState({}),[N,F]=g.useState(!1),[M,V]=g.useState(null),[pe,_e]=g.useState(!1);g.useEffect(()=>{a(t.currentPage,t.itemsPerPage)},[a,t.currentPage,t.itemsPerPage]);const Te=h({role:m,status:y,searchTerm:l}),nr=async(O,Fe)=>{const Dr=Fe==="blocked";await n(O,Dr)&&(j(`Usuario ${Dr?"desbloqueado":"bloqueado"} correctamente.`),setTimeout(()=>j(null),3e3))},or=async O=>{await o(O)&&(j("Correo de restablecimiento de contraseña enviado correctamente."),setTimeout(()=>j(null),3e3))},ks=async O=>{await i(O)&&(j("Usuario promocionado a administrador correctamente."),setTimeout(()=>j(null),3e3))},Us=O=>{x(O),p(""),u(""),P({}),E(!0)},$e=()=>{E(!1),x(null),p(""),u(""),P({})},$s=()=>{const O={};return(!T||T.trim().length<3)&&(O.storeName="El nombre de la tienda debe tener al menos 3 caracteres"),P(O),Object.keys(O).length===0},Ls=async()=>{R&&$s()&&await d(R,{store_name:T,description:S})&&(j("Usuario convertido en vendedor correctamente."),$e(),setTimeout(()=>j(null),3e3))},Ms=O=>{a(O,t.itemsPerPage)},Fs=()=>{a(t.currentPage,t.itemsPerPage)},zs=O=>{W(O),ue(""),A(""),H("notification"),ce({}),k(!0)},Le=()=>{k(!1),W(null),ue(""),A(""),H("notification"),ce({})},qs=()=>{const O={};return(!ie||ie.trim().length<3)&&(O.subject="El asunto debe tener al menos 3 caracteres"),(!te||te.trim().length<10)&&(O.message="El mensaje debe tener al menos 10 caracteres"),te.length>5e3&&(O.message="El mensaje no puede exceder 5000 caracteres"),ce(O),Object.keys(O).length===0},Bs=async()=>{if(B&&qs()){le(!0);try{const O=await $.post(D.ADMIN.CONFIGURATIONS.MAIL_SEND_CUSTOM,{user_id:B.id,subject:ie.trim(),message:te.trim(),email_type:ee});O.status==="success"?(j("Email enviado correctamente."),Le(),setTimeout(()=>j(null),5e3)):ce({general:O.message||"Error al enviar el email"})}catch(O){console.error("Error sending custom email:",O),ce({general:"Error de conexión al enviar el email"})}finally{le(!1)}}},Vs=O=>{V(O),F(!0)},Me=()=>{F(!1),V(null)},Gs=async()=>{if(M){_e(!0);try{console.log("Attempting to delete user:",M.id),await c(M.id)?(console.log("User deleted successfully, hook will handle refresh automatically"),j("Usuario eliminado correctamente."),Me(),setTimeout(()=>j(null),3e3)):(console.error("Delete operation failed"),j("Error al eliminar el usuario."))}catch(O){console.error("Error deleting user:",O),j("Error al eliminar el usuario.")}finally{_e(!1)}}},Hs=[{key:"user",header:"Usuario",sortable:!0,render:O=>r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-full bg-gray-200 flex items-center justify-center overflow-hidden",children:r.jsx(hr,{className:"h-6 w-6 text-gray-500"})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:O.name}),r.jsx("div",{className:"text-sm text-gray-500",children:O.email})]})]})},{key:"role",header:"Rol",sortable:!0,render:O=>r.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${O.role==="admin"?"bg-red-100 text-red-800":O.role==="seller"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:[O.role==="admin"&&"Administrador",O.role==="seller"&&"Vendedor",O.role==="customer"&&"Cliente"]})},{key:"status",header:"Estado",sortable:!0,render:O=>r.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${O.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:O.status==="active"?"Activo":"Bloqueado"})},{key:"registeredDate",header:"Registrado",sortable:!0},{key:"ordersCount",header:"Pedidos",sortable:!0},{key:"actions",header:"Acciones",render:O=>r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx("button",{onClick:()=>nr(O.id,O.status),className:`p-1 rounded-md ${O.status==="active"?"text-red-600 hover:bg-red-100":"text-green-600 hover:bg-green-100"}`,title:O.status==="active"?"Bloquear Usuario":"Desbloquear Usuario",children:O.status==="active"?r.jsx(_r,{size:18}):r.jsx(Ys,{size:18})}),r.jsx("button",{onClick:()=>or(O.id),className:"p-1 text-blue-600 hover:bg-blue-100 rounded-md",title:"Enviar Restablecimiento de Contraseña",children:r.jsx(ss,{size:18})}),r.jsx("button",{onClick:()=>zs(O),className:"p-1 text-orange-600 hover:bg-orange-100 rounded-md",title:"Enviar Email Personalizado",children:r.jsx(kr,{size:18})}),O.role!=="seller"&&r.jsx("button",{onClick:()=>Us(O.id),className:"p-1 text-green-600 hover:bg-green-100 rounded-md",title:"Convertir en Vendedor",children:r.jsx(Zs,{size:18})}),O.role!=="admin"&&r.jsx("button",{onClick:()=>ks(O.id),className:"p-1 text-purple-600 hover:bg-purple-100 rounded-md",title:"Hacer Administrador",children:r.jsx(Ce,{size:18})}),r.jsx("button",{onClick:()=>Vs(O),className:"p-1 text-red-600 hover:bg-red-100 rounded-md",title:"Eliminar Usuario",children:r.jsx(je,{size:18})})]})}];return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestión de Usuarios"}),r.jsx("div",{className:"flex space-x-2",children:r.jsxs("button",{onClick:Fs,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",disabled:s,children:[r.jsx(G,{size:18,className:`inline mr-2 ${s?"animate-spin":""}`}),"Actualizar"]})})]}),e&&r.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(ir,{className:"h-5 w-5 mr-2"}),r.jsx("span",{children:e})]})}),f&&r.jsx("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4",children:r.jsx("span",{children:f})}),r.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:r.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Xe,{className:"h-5 w-5 text-gray-500"}),r.jsxs("select",{className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",value:m,onChange:O=>v(O.target.value),children:[r.jsx("option",{value:"all",children:"Todos los Roles"}),r.jsx("option",{value:"customer",children:"Cliente"}),r.jsx("option",{value:"seller",children:"Vendedor"}),r.jsx("option",{value:"admin",children:"Administrador"})]})]}),r.jsx("div",{className:"flex items-center space-x-2",children:r.jsxs("select",{className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",value:y,onChange:O=>_(O.target.value),children:[r.jsx("option",{value:"all",children:"Todos los Estados"}),r.jsx("option",{value:"active",children:"Activo"}),r.jsx("option",{value:"blocked",children:"Bloqueado"})]})}),r.jsx("div",{className:"flex-grow",children:r.jsx("input",{type:"text",placeholder:"Buscar por nombre o email...",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",value:l,onChange:O=>C(O.target.value)})})]})}),r.jsx(ar,{data:Te,columns:Hs,searchFields:["name","email"],loading:s,emptyMessage:"No se encontraron usuarios",pagination:{currentPage:t.currentPage,totalPages:t.totalPages,totalItems:t.totalItems,itemsPerPage:t.itemsPerPage,onPageChange:Ms}},`users-table-${Te.length}`),w&&r.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:$e}),r.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md relative z-10",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Convertir en Vendedor"}),r.jsx("button",{onClick:$e,className:"text-gray-500 hover:text-gray-700",children:r.jsx(lr,{size:20})})]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"store_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre de la Tienda *"}),r.jsx("input",{type:"text",id:"store_name",className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 ${I.storeName?"border-red-500":"border-gray-300"}`,value:T,onChange:O=>p(O.target.value)}),I.storeName&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:I.storeName})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripción"}),r.jsx("textarea",{id:"description",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:S,onChange:O=>u(O.target.value),rows:4})]}),r.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[r.jsx("button",{onClick:$e,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100",children:"Cancelar"}),r.jsx("button",{onClick:Ls,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",disabled:s,children:s?"Procesando...":"Guardar"})]})]})]})]}),U&&B&&r.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:Le}),r.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl relative z-10 max-h-[90vh] overflow-y-auto",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center",children:[r.jsx(kr,{className:"mr-2 text-orange-600",size:24}),"Enviar Email a ",B.name]}),r.jsx("button",{onClick:Le,className:"text-gray-500 hover:text-gray-700",children:r.jsx(lr,{size:20})})]}),r.jsx("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:r.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[r.jsx(hr,{className:"mr-2",size:16}),r.jsx("span",{className:"font-medium",children:B.name}),r.jsx("span",{className:"mx-2",children:"•"}),r.jsx("span",{children:B.email}),r.jsx("span",{className:"mx-2",children:"•"}),r.jsx("span",{className:"capitalize",children:B.role})]})}),ae.general&&r.jsx("div",{className:"mb-4 bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(ir,{className:"h-5 w-5 mr-2"}),r.jsx("span",{children:ae.general})]})}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{htmlFor:"email_type",className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Email"}),r.jsxs("select",{id:"email_type",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",value:ee,onChange:O=>H(O.target.value),children:[r.jsx("option",{value:"notification",children:"Notificación"}),r.jsx("option",{value:"announcement",children:"Anuncio"}),r.jsx("option",{value:"warning",children:"Advertencia"})]})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"email_subject",className:"block text-sm font-medium text-gray-700 mb-1",children:"Asunto *"}),r.jsx("input",{type:"text",id:"email_subject",className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 ${ae.subject?"border-red-500":"border-gray-300"}`,value:ie,onChange:O=>ue(O.target.value),placeholder:"Ingresa el asunto del email...",maxLength:255}),ae.subject&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:ae.subject}),r.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:[ie.length,"/255 caracteres"]})]}),r.jsxs("div",{children:[r.jsx("label",{htmlFor:"email_message",className:"block text-sm font-medium text-gray-700 mb-1",children:"Mensaje *"}),r.jsx("textarea",{id:"email_message",className:`w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 ${ae.message?"border-red-500":"border-gray-300"}`,value:te,onChange:O=>A(O.target.value),placeholder:"Escribe tu mensaje aquí...",rows:8,maxLength:5e3}),ae.message&&r.jsx("p",{className:"mt-1 text-sm text-red-500",children:ae.message}),r.jsxs("p",{className:"mt-1 text-xs text-gray-500",children:[te.length,"/5000 caracteres"]})]}),r.jsxs("div",{className:"flex justify-end space-x-3 mt-6 pt-4 border-t",children:[r.jsx("button",{onClick:Le,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100",disabled:be,children:"Cancelar"}),r.jsx("button",{onClick:Bs,className:"px-6 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors flex items-center",disabled:be,children:be?r.jsxs(r.Fragment,{children:[r.jsx(G,{className:"animate-spin -ml-1 mr-2 h-4 w-4"}),"Enviando..."]}):r.jsxs(r.Fragment,{children:[r.jsx(Xs,{className:"-ml-1 mr-2 h-4 w-4"}),"Enviar Email"]})})]})]})]})]}),N&&M&&r.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[r.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:Me}),r.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md relative z-10",children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center",children:[r.jsx(je,{className:"mr-2 text-red-600",size:24}),"Confirmar Eliminación"]}),r.jsx("button",{onClick:Me,className:"text-gray-500 hover:text-gray-700",disabled:pe,children:r.jsx(lr,{size:20})})]}),r.jsxs("div",{className:"mb-6",children:[r.jsxs("p",{className:"text-gray-700 mb-3",children:["¿Está seguro de que desea eliminar al usuario"," ",r.jsx("strong",{children:M.name}),"?"]}),r.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded p-3",children:r.jsxs("p",{className:"text-yellow-800 text-sm flex items-center",children:[r.jsx(ir,{className:"mr-2",size:16}),"Esta acción no se puede deshacer. El usuario será eliminado permanentemente del sistema."]})}),r.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded",children:[r.jsxs("p",{className:"text-sm text-gray-600",children:[r.jsx("strong",{children:"Email:"})," ",M.email]}),r.jsxs("p",{className:"text-sm text-gray-600",children:[r.jsx("strong",{children:"Rol:"})," ",M.role==="admin"?"Administrador":M.role==="seller"?"Vendedor":"Cliente"]}),r.jsxs("p",{className:"text-sm text-gray-600",children:[r.jsx("strong",{children:"Pedidos:"})," ",M.ordersCount]})]})]}),r.jsxs("div",{className:"flex justify-end space-x-3",children:[r.jsx("button",{onClick:Me,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-100",disabled:pe,children:"Cancelar"}),r.jsx("button",{onClick:Gs,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center",disabled:pe,children:pe?r.jsxs(r.Fragment,{children:[r.jsx(G,{className:"animate-spin -ml-1 mr-2 h-4 w-4"}),"Eliminando..."]}):r.jsxs(r.Fragment,{children:[r.jsx(je,{className:"-ml-1 mr-2 h-4 w-4"}),"Eliminar Usuario"]})})]})]})]})]})},Io=Object.freeze(Object.defineProperty({__proto__:null,default:gn},Symbol.toStringTag,{value:"Module"}));class pn{async getAllProducts(e){try{console.log("📤 AdminProductService: Obteniendo todos los productos como admin:",e);const t={...e};t&&"admin_view"in t&&delete t.admin_view;const a=await $.get(D.ADMIN.PRODUCTS.LIST,t);return console.log("📥 AdminProductService: Respuesta del servidor:",a),a}catch(t){return console.error("❌ Error en AdminProductService.getAllProducts:",t),null}}async getProductById(e){try{return console.log(`📤 AdminProductService: Obteniendo producto ${e} como admin`),(await $.get(D.PRODUCTS.DETAILS(e)))?.data||null}catch(t){return console.error("❌ Error en AdminProductService.getProductById:",t),null}}async createProduct(e,t){try{console.log("📤 AdminProductService: Creando producto como admin:",e);const a=new FormData;if(a.append("name",e.name),a.append("description",e.description),a.append("price",String(e.price)),a.append("stock",String(e.stock)),a.append("category_id",String(e.category_id)),t&&a.append("seller_id",String(t)),e.shortDescription&&a.append("short_description",e.shortDescription),e.weight!==void 0&&a.append("weight",String(e.weight)),e.width!==void 0&&a.append("width",String(e.width)),e.height!==void 0&&a.append("height",String(e.height)),e.depth!==void 0&&a.append("depth",String(e.depth)),e.dimensions&&a.append("dimensions",e.dimensions),e.sku&&a.append("sku",e.sku),e.status&&a.append("status",e.status),e.featured!==void 0&&a.append("featured",String(e.featured)),e.published!==void 0&&a.append("published",String(e.published)),e.discount_percentage!==void 0&&a.append("discount_percentage",String(e.discount_percentage)),e.colors){const o=typeof e.colors=="string"?e.colors:JSON.stringify(e.colors);a.append("colors",o)}if(e.sizes){const o=typeof e.sizes=="string"?e.sizes:JSON.stringify(e.sizes);a.append("sizes",o)}if(e.tags){const o=typeof e.tags=="string"?e.tags:JSON.stringify(e.tags);a.append("tags",o)}e.attributes&&Object.keys(e.attributes).length>0&&a.append("attributes",JSON.stringify(e.attributes)),e.images&&e.images.length>0&&e.images.forEach((o,i)=>{a.append(`images[${i}]`,o)});const n=await $.uploadFile(D.PRODUCTS.CREATE,a);return console.log("✅ AdminProductService: Producto creado:",n),n}catch(a){return console.error("❌ Error en AdminProductService.createProduct:",a),null}}async updateProduct(e){try{console.log(`📤 AdminProductService: Actualizando producto ${e.id} como admin:`,e);const t=new FormData;if(e.name&&t.append("name",e.name),e.description&&t.append("description",e.description),e.shortDescription&&t.append("short_description",e.shortDescription),e.price!==void 0&&t.append("price",String(e.price)),e.stock!==void 0&&t.append("stock",String(e.stock)),e.category_id&&t.append("category_id",String(e.category_id)),e.weight!==void 0&&t.append("weight",String(e.weight)),e.width!==void 0&&t.append("width",String(e.width)),e.height!==void 0&&t.append("height",String(e.height)),e.depth!==void 0&&t.append("depth",String(e.depth)),e.dimensions&&t.append("dimensions",e.dimensions),e.sku&&t.append("sku",e.sku),e.status&&t.append("status",e.status),e.featured!==void 0&&t.append("featured",String(e.featured)),e.published!==void 0&&t.append("published",String(e.published)),e.discount_percentage!==void 0&&t.append("discount_percentage",String(e.discount_percentage)),e.colors){const n=typeof e.colors=="string"?e.colors:JSON.stringify(e.colors);t.append("colors",n)}if(e.sizes){const n=typeof e.sizes=="string"?e.sizes:JSON.stringify(e.sizes);t.append("sizes",n)}if(e.tags){const n=typeof e.tags=="string"?e.tags:JSON.stringify(e.tags);t.append("tags",n)}e.attributes&&Object.keys(e.attributes).length>0&&t.append("attributes",JSON.stringify(e.attributes)),e.replace_images!==void 0&&t.append("replace_images",String(e.replace_images)),e.remove_images&&e.remove_images.length>0&&t.append("remove_images",JSON.stringify(e.remove_images)),e.images&&e.images.length>0&&e.images.forEach((n,o)=>{t.append(`images[${o}]`,n)});const a=await $.updateFile(D.PRODUCTS.UPDATE(e.id),t);return console.log("✅ AdminProductService: Producto actualizado:",a),a}catch(t){return console.error("❌ Error en AdminProductService.updateProduct:",t),null}}async deleteProduct(e){try{console.log(`📤 AdminProductService: Eliminando producto ${e} como admin`);const t=await $.delete(D.ADMIN.PRODUCTS.DELETE(e));return console.log("✅ AdminProductService: Producto eliminado:",t),!0}catch(t){return console.error("❌ Error en AdminProductService.deleteProduct:",t),!1}}async toggleFeatured(e,t){try{console.log(`📤 AdminProductService: Cambiando featured del producto ${e} a ${t}`);const a=await $.patch(D.ADMIN.PRODUCTS.PARTIAL_UPDATE(e),{featured:t});return console.log("✅ AdminProductService: Featured actualizado:",a),!0}catch(a){return console.error("❌ Error en AdminProductService.toggleFeatured:",a),a instanceof Error&&console.error("Error message:",a.message),!1}}async togglePublished(e,t){try{console.log(`📤 AdminProductService: Cambiando published del producto ${e} a ${t}`);const a=await $.patch(D.ADMIN.PRODUCTS.PARTIAL_UPDATE(e),{published:t});return console.log("✅ AdminProductService: Published actualizado:",a),!0}catch(a){return console.error("❌ Error en AdminProductService.togglePublished:",a),a instanceof Error&&console.error("Error message:",a.message),!1}}async updateStatus(e,t){try{console.log(`📤 AdminProductService: Cambiando status del producto ${e} a ${t}`);const a=await $.patch(D.ADMIN.PRODUCTS.PARTIAL_UPDATE(e),{status:t});return console.log("✅ AdminProductService: Status actualizado:",a),!0}catch(a){return console.error("❌ Error en AdminProductService.updateStatus:",a),a instanceof Error&&console.error("Error message:",a.message),!1}}async getProductStats(){try{console.log("📤 AdminProductService: Obteniendo estadísticas de productos");const e=await $.get(D.ADMIN.PRODUCTS.STATS);return console.log("✅ AdminProductService: Estadísticas obtenidas:",e),e}catch(e){return console.error("❌ Error en AdminProductService.getProductStats:",e),null}}async getProductsBySeller(e,t){try{console.log(`📤 AdminProductService: Obteniendo productos del vendedor ${e}`);const a=await $.get(D.PRODUCTS.BY_SELLER(e),t);return console.log("✅ AdminProductService: Productos del vendedor obtenidos:",a),a}catch(a){return console.error("❌ Error en AdminProductService.getProductsBySeller:",a),null}}}class hn{adminProductService;constructor(e){this.adminProductService=e}async execute(e){console.log("GetAllProductsUseCase: Obteniendo todos los productos como admin");try{const t=await this.adminProductService.getAllProducts(e);return console.log("GetAllProductsUseCase: Productos obtenidos correctamente:",t),t}catch(t){throw console.error("GetAllProductsUseCase: Error al obtener productos:",t),t}}}class fn{adminProductService;constructor(e){this.adminProductService=e}async execute(e,t){console.log("CreateProductAsAdminUseCase: Creando producto como admin:",e);try{const a=await this.adminProductService.createProduct(e,t);return console.log("CreateProductAsAdminUseCase: Producto creado correctamente:",a),a}catch(a){throw console.error("CreateProductAsAdminUseCase: Error al crear producto:",a),a}}}class xn{adminProductService;constructor(e){this.adminProductService=e}async execute(e){console.log(`UpdateAnyProductUseCase: Actualizando producto ${e.id} como admin:`,e);try{const t=await this.adminProductService.updateProduct(e);return console.log("UpdateAnyProductUseCase: Producto actualizado correctamente:",t),t}catch(t){throw console.error("UpdateAnyProductUseCase: Error al actualizar producto:",t),t}}}class yn{adminProductService;constructor(e){this.adminProductService=e}async execute(e){console.log(`DeleteAnyProductUseCase: Eliminando producto ${e} como admin`);try{const t=await this.adminProductService.deleteProduct(e);return console.log("DeleteAnyProductUseCase: Producto eliminado correctamente:",t),t}catch(t){throw console.error("DeleteAnyProductUseCase: Error al eliminar producto:",t),t}}}class bn{adminProductService;constructor(e){this.adminProductService=e}async execute(e,t){console.log(`ToggleProductFeaturedUseCase: Cambiando featured del producto ${e} a ${t}`);try{const a=await this.adminProductService.toggleFeatured(e,t);return console.log("ToggleProductFeaturedUseCase: Featured actualizado correctamente:",a),a}catch(a){throw console.error("ToggleProductFeaturedUseCase: Error al cambiar featured:",a),a}}}class vn{adminProductService;constructor(e){this.adminProductService=e}async execute(e,t){console.log(`ToggleProductPublishedUseCase: Cambiando published del producto ${e} a ${t}`);try{const a=await this.adminProductService.togglePublished(e,t);return console.log("ToggleProductPublishedUseCase: Published actualizado correctamente:",a),a}catch(a){throw console.error("ToggleProductPublishedUseCase: Error al cambiar published:",a),a}}}class Nn{adminProductService;constructor(e){this.adminProductService=e}async execute(e,t){console.log(`UpdateProductStatusUseCase: Cambiando status del producto ${e} a ${t}`);try{const a=await this.adminProductService.updateStatus(e,t);return console.log("UpdateProductStatusUseCase: Status actualizado correctamente:",a),a}catch(a){throw console.error("UpdateProductStatusUseCase: Error al cambiar status:",a),a}}}class jn{adminProductService;constructor(e){this.adminProductService=e}async execute(e,t){console.log(`GetProductsBySellerUseCase: Obteniendo productos del vendedor ${e}`);try{const a=await this.adminProductService.getProductsBySeller(e,t);return console.log("GetProductsBySellerUseCase: Productos obtenidos correctamente:",a),a}catch(a){throw console.error("GetProductsBySellerUseCase: Error al obtener productos del vendedor:",a),a}}}class Sn{adminProductService;constructor(e){this.adminProductService=e}async execute(){console.log("GetProductStatsUseCase: Obteniendo estadísticas de productos");try{const e=await this.adminProductService.getProductStats();return console.log("GetProductStatsUseCase: Estadísticas obtenidas correctamente:",e),e}catch(e){throw console.error("GetProductStatsUseCase: Error al obtener estadísticas:",e),e}}}const oe=new pn,En=new hn(oe),Cn=new fn(oe),wn=new xn(oe),An=new yn(oe),_n=new bn(oe),Tn=new vn(oe),Pn=new Nn(oe),Rn=new jn(oe),In=new Sn(oe),On=s=>s?`admin_products_${JSON.stringify(s)}`:"admin_products_default",Dn=()=>{const[s,e]=g.useState(!1),[t,a]=g.useState(null),[n,o]=g.useState([]),[i,d]=g.useState(null),[c,h]=g.useState(null),[m,v]=g.useState(null),{invalidateAfterMutation:y}=Rs(),_=g.useCallback(u=>{if(!u||typeof u!="object")return console.error("Producto inválido para adaptar:",u),{};let I=[];u.main_image?I=[u.main_image]:Array.isArray(u.images)&&u.images.length>0?I=u.images.map(k=>typeof k=="string"?k:typeof k=="object"&&k!==null&&(k.original||k.large||k.medium||k.url||k.path)||"").filter(Boolean):u.image&&(I=[u.image]);let P=[];return Array.isArray(u.tags)&&u.tags.forEach(k=>{if(typeof k=="string")try{const B=JSON.parse(k);Array.isArray(B)?P.push(...B):P.push(k)}catch{P.push(k)}}),{id:u.id,userId:u.user_id,sellerId:u.seller_id,categoryId:u.category_id,name:u.name,slug:u.slug,description:u.description||"",shortDescription:u.short_description,price:Number(u.price||0),finalPrice:Number(u.final_price||u.price||0),stock:Number(u.stock||0),weight:u.weight,width:u.width,height:u.height,depth:u.depth,dimensions:u.dimensions,colors:u.colors,sizes:u.sizes,tags:P,sku:u.sku,attributes:u.attributes,images:I,featured:!!u.featured,published:!!(u.published??!0),status:u.status||"active",viewCount:u.view_count||0,salesCount:u.sales_count||0,discountPercentage:Number(u.discount_percentage||0),isInStock:!!(u.is_in_stock??u.stock>0),rating:Number(u.rating||0),ratingCount:Number(u.rating_count||0),createdAt:u.created_at,updatedAt:u.updated_at,created_at:u.created_at||u.createdAt||new Date().toISOString(),category_name:u.category?.name||u.category_name||"Sin categoría",category:u.category_name?{id:u.category_id,name:u.category_name}:u.category,seller:u.seller,user:u.user,isNew:void 0}},[]),l=g.useCallback(async(u,I=!1)=>{e(!0),a(null);try{const P=On(u);if(!I){const k=de.getItem(P);if(k)return console.log("💾 useAdminProducts: Usando datos en caché"),o(k.data||[]),v(k.meta||null),e(!1),k}console.log("🌐 useAdminProducts: Obteniendo productos desde API"),console.log("📊 useAdminProducts: FilterParams enviados:",u);const U=await En.execute(u);if(console.log("📥 useAdminProducts: Respuesta completa recibida:",U),U){let k=[],B=null;U.data&&Array.isArray(U.data)?(k=U.data.map(_),B=U.meta):Array.isArray(U)?(k=U.map(_),B={total:U.length,limit:u?.limit||10,offset:u?.offset||0}):(console.warn("⚠️ Estructura de respuesta no reconocida:",U),k=[],B={total:0,limit:0,offset:0});const W={data:k,meta:B||{total:k.length,limit:u?.limit||10,offset:u?.offset||0}};return de.setItem(P,W,X.cache.productCacheTime),o(k),v(W.meta),W}else return o([]),v({total:0,limit:0,offset:0}),{data:[],meta:{total:0,limit:0,offset:0}}}catch(P){const U=P instanceof Error?P.message:"Error al obtener productos";return console.error("❌ Error obteniendo productos:",P),a(U),o([]),v({total:0,limit:0,offset:0}),null}finally{e(!1)}},[_]),C=g.useCallback(async u=>{e(!0),a(null);try{const I=await oe.getProductById(u);return d(I),I}catch(I){const P=I instanceof Error?I.message:"Error al obtener producto";return a(P),d(null),null}finally{e(!1)}},[]),f=g.useCallback(async(u,I)=>{e(!0),a(null);try{const P=await Cn.execute(u,I);return P&&y(["admin_products_*","products_*","products_featured_*"]),P}catch(P){const U=P instanceof Error?P.message:"Error al crear producto";return a(U),null}finally{e(!1)}},[y]),j=g.useCallback(async u=>{e(!0),a(null);try{const I=await wn.execute(u);return I&&(o(P=>P.map(U=>U.id===u.id?_(I):U)),y(["admin_products_*","products_*",`product_${u.id}`,"products_featured_*"])),I}catch(I){const P=I instanceof Error?I.message:"Error al actualizar producto";return a(P),null}finally{e(!1)}},[_,y]),w=g.useCallback(async u=>{e(!0),a(null);try{const I=await An.execute(u);return I&&(o(P=>P.filter(U=>U.id!==u)),y(["admin_products_*","products_*",`product_${u}`,"products_featured_*"])),I}catch(I){const P=I instanceof Error?I.message:"Error al eliminar producto";return a(P),!1}finally{e(!1)}},[y]),E=g.useCallback(async(u,I)=>{a(null);try{const P=await _n.execute(u,I);return P?(o(U=>U.map(k=>k.id===u?{...k,featured:I}:k)),y(["admin_products_*","products_*",`product_${u}`,"products_featured_*"])):a("Error al cambiar estado destacado del producto"),P}catch(P){const U=P instanceof Error?P.message:"Error al cambiar estado destacado";return console.error("❌ Error en toggleFeatured:",P),a(U),!1}},[y]),R=g.useCallback(async(u,I)=>{a(null);try{const P=await Tn.execute(u,I);return P?(o(U=>U.map(k=>k.id===u?{...k,published:I}:k)),y(["admin_products_*","products_*",`product_${u}`,"products_featured_*"])):a("Error al cambiar estado de publicación del producto"),P}catch(P){const U=P instanceof Error?P.message:"Error al cambiar estado de publicación";return console.error("❌ Error en togglePublished:",P),a(U),!1}},[y]),x=g.useCallback(async(u,I)=>{a(null);try{const P=await Pn.execute(u,I);return P?(o(U=>U.map(k=>k.id===u?{...k,status:I}:k)),y(["admin_products_*","products_*",`product_${u}`,"products_featured_*"])):a("Error al actualizar estado del producto"),P}catch(P){const U=P instanceof Error?P.message:"Error al actualizar estado";return console.error("❌ Error en updateStatus:",P),a(U),!1}},[y]),T=g.useCallback(async(u,I)=>{e(!0),a(null);try{const P=await Rn.execute(u,I);if(P&&Array.isArray(P.data)){const U=P.data.map(_);o(U),v(P.meta||null)}return P}catch(P){const U=P instanceof Error?P.message:"Error al obtener productos del vendedor";return a(U),null}finally{e(!1)}},[_]),p=g.useCallback(async()=>{e(!0),a(null);try{const u=await In.execute();return h(u),u}catch(u){const I=u instanceof Error?u.message:"Error al obtener estadísticas";return a(I),null}finally{e(!1)}},[]),S=g.useCallback(u=>{u?(y([`product_${u}`]),console.log(`🗑️ Caché del producto ${u} invalidada`)):(y(["admin_products_*","products_*","product_*"]),console.log("🗑️ Toda la caché de productos invalidada"))},[y]);return{loading:s,error:t,products:n,productDetail:i,stats:c,meta:m,fetchAllProducts:l,fetchProductById:C,createProduct:f,updateProduct:j,deleteProduct:w,toggleFeatured:E,togglePublished:R,updateStatus:x,fetchProductsBySeller:T,fetchProductStats:p,clearProductCache:S,setError:u=>a(u),setLoading:u=>e(u)}};class kn{async getAllCategories(e){try{console.log("📤 AdminCategoryService: Obteniendo todas las categorías como admin:",e);const t=await $.get(D.CATEGORIES.LIST,e);return console.log("📥 AdminCategoryService: Respuesta del servidor:",t),t}catch(t){return console.error("❌ Error en AdminCategoryService.getAllCategories:",t),null}}async getCategoryById(e){try{console.log(`📤 AdminCategoryService: Obteniendo categoría ${e} como admin`);const t=await $.get(D.CATEGORIES.DETAILS(e));return console.log("✅ AdminCategoryService: Categoría obtenida:",t),t}catch(t){return console.error("❌ Error en AdminCategoryService.getCategoryById:",t),null}}async createCategory(e){try{console.log("📤 AdminCategoryService: Creando categoría como admin:",e);const t=await $.post(D.ADMIN.CATEGORIES.CREATE,e);return console.log("✅ AdminCategoryService: Categoría creada:",t),t}catch(t){return console.error("❌ Error en AdminCategoryService.createCategory:",t),null}}async updateCategory(e){try{if(console.log(`📤 AdminCategoryService: Actualizando categoría ${e.id} como admin:`,e),!e.id)throw new Error("ID de categoría requerido para actualización");const t=await $.put(D.ADMIN.CATEGORIES.UPDATE(e.id),e);return console.log("✅ AdminCategoryService: Categoría actualizada:",t),t}catch(t){return console.error("❌ Error en AdminCategoryService.updateCategory:",t),null}}async partialUpdateCategory(e,t){try{console.log(`📤 AdminCategoryService: Actualizando parcialmente categoría ${e} como admin:`,t);const a=await $.patch(D.ADMIN.CATEGORIES.PARTIAL_UPDATE(e),t);return console.log("✅ AdminCategoryService: Categoría actualizada parcialmente:",a),a}catch(a){return console.error("❌ Error en AdminCategoryService.partialUpdateCategory:",a),null}}async deleteCategory(e){try{console.log(`📤 AdminCategoryService: Eliminando categoría ${e} como admin`);const t=await $.delete(D.ADMIN.CATEGORIES.DELETE(e));return console.log("✅ AdminCategoryService: Categoría eliminada:",t),!0}catch(t){return console.error("❌ Error en AdminCategoryService.deleteCategory:",t),!1}}async toggleActive(e,t){try{console.log(`📤 AdminCategoryService: Cambiando estado activo de categoría ${e} a ${t}`);const a=await $.patch(D.ADMIN.CATEGORIES.PARTIAL_UPDATE(e),{is_active:t});return console.log("✅ AdminCategoryService: Estado activo actualizado:",a),!0}catch(a){return console.error("❌ Error en AdminCategoryService.toggleActive:",a),a instanceof Error&&console.error("Error message:",a.message),!1}}async toggleFeatured(e,t){try{console.log(`📤 AdminCategoryService: Cambiando estado destacado de categoría ${e} a ${t}`);const a=await $.patch(D.ADMIN.CATEGORIES.PARTIAL_UPDATE(e),{featured:t});return console.log("✅ AdminCategoryService: Estado destacado actualizado:",a),!0}catch(a){return console.error("❌ Error en AdminCategoryService.toggleFeatured:",a),a instanceof Error&&console.error("Error message:",a.message),!1}}async updateOrder(e,t){try{console.log(`📤 AdminCategoryService: Actualizando orden de categoría ${e} a ${t}`);const a=await $.patch(D.ADMIN.CATEGORIES.PARTIAL_UPDATE(e),{order:t});return console.log("✅ AdminCategoryService: Orden actualizado:",a),!0}catch(a){return console.error("❌ Error en AdminCategoryService.updateOrder:",a),a instanceof Error&&console.error("Error message:",a.message),!1}}async getMainCategories(e=!0){try{console.log("📤 AdminCategoryService: Obteniendo categorías principales como admin");const t=await $.get(D.CATEGORIES.MAIN,{with_counts:e});return console.log("✅ AdminCategoryService: Categorías principales obtenidas:",t),t?.data||[]}catch(t){return console.error("❌ Error en AdminCategoryService.getMainCategories:",t),[]}}async getSubcategories(e){try{console.log(`📤 AdminCategoryService: Obteniendo subcategorías de ${e} como admin`);const t=await $.get(D.CATEGORIES.SUBCATEGORIES(e));return console.log("✅ AdminCategoryService: Subcategorías obtenidas:",t),t?.data||[]}catch(t){return console.error("❌ Error en AdminCategoryService.getSubcategories:",t),[]}}}class Un{adminCategoryService;constructor(e){this.adminCategoryService=e}async execute(e){console.log("GetAllCategoriesUseCase: Obteniendo todas las categorías como admin");try{const t=await this.adminCategoryService.getAllCategories(e);return console.log("GetAllCategoriesUseCase: Categorías obtenidas correctamente:",t),t}catch(t){throw console.error("GetAllCategoriesUseCase: Error al obtener categorías:",t),t}}}class $n{adminCategoryService;constructor(e){this.adminCategoryService=e}async execute(e){console.log("CreateCategoryAsAdminUseCase: Creando categoría como admin:",e);try{const t=await this.adminCategoryService.createCategory(e);return console.log("CreateCategoryAsAdminUseCase: Categoría creada correctamente:",t),t}catch(t){throw console.error("CreateCategoryAsAdminUseCase: Error al crear categoría:",t),t}}}class Ln{adminCategoryService;constructor(e){this.adminCategoryService=e}async execute(e){console.log(`UpdateAnyCategoryUseCase: Actualizando categoría ${e.id} como admin:`,e);try{const t=await this.adminCategoryService.updateCategory(e);return console.log("UpdateAnyCategoryUseCase: Categoría actualizada correctamente:",t),t}catch(t){throw console.error("UpdateAnyCategoryUseCase: Error al actualizar categoría:",t),t}}}class Mn{adminCategoryService;constructor(e){this.adminCategoryService=e}async execute(e){console.log(`DeleteAnyCategoryUseCase: Eliminando categoría ${e} como admin`);try{const t=await this.adminCategoryService.deleteCategory(e);return console.log("DeleteAnyCategoryUseCase: Categoría eliminada correctamente:",t),t}catch(t){throw console.error("DeleteAnyCategoryUseCase: Error al eliminar categoría:",t),t}}}class Fn{adminCategoryService;constructor(e){this.adminCategoryService=e}async execute(e,t){console.log(`ToggleCategoryActiveUseCase: Cambiando estado activo de categoría ${e} a ${t}`);try{const a=await this.adminCategoryService.toggleActive(e,t);return console.log("ToggleCategoryActiveUseCase: Estado activo actualizado correctamente:",a),a}catch(a){throw console.error("ToggleCategoryActiveUseCase: Error al cambiar estado activo:",a),a}}}class zn{adminCategoryService;constructor(e){this.adminCategoryService=e}async execute(e,t){console.log(`ToggleCategoryFeaturedUseCase: Cambiando estado destacado de categoría ${e} a ${t}`);try{const a=await this.adminCategoryService.toggleFeatured(e,t);return console.log("ToggleCategoryFeaturedUseCase: Estado destacado actualizado correctamente:",a),a}catch(a){throw console.error("ToggleCategoryFeaturedUseCase: Error al cambiar estado destacado:",a),a}}}class qn{adminCategoryService;constructor(e){this.adminCategoryService=e}async execute(e){console.log(`GetCategoryByIdUseCase: Obteniendo categoría ${e} como admin`);try{const t=await this.adminCategoryService.getCategoryById(e);return console.log("GetCategoryByIdUseCase: Categoría obtenida correctamente:",t),t}catch(t){throw console.error("GetCategoryByIdUseCase: Error al obtener categoría:",t),t}}}const ge=new kn,Bn=new Un(ge),Vn=new $n(ge),Gn=new Ln(ge),Hn=new Mn(ge),Kn=new Fn(ge),Wn=new zn(ge),Jn=new qn(ge),Ds=()=>{const[s,e]=g.useState(!1),[t,a]=g.useState(null),[n,o]=g.useState([]),[i,d]=g.useState([]),[c,h]=g.useState(null),{invalidateAfterMutation:m}=Rs(),v=g.useCallback(x=>!x||typeof x!="object"?(console.error("Categoría inválida para adaptar:",x),{}):{id:x.id,name:x.name||"",slug:x.slug||"",description:x.description||"",parent_id:x.parent_id,icon:x.icon,image:x.image,order:x.order,is_active:!!(x.is_active??!0),featured:!!(x.featured??!1),created_at:x.created_at,updated_at:x.updated_at,subcategories:Array.isArray(x.subcategories)?x.subcategories.map(T=>v(T)):void 0,product_count:x.product_count||0,parent:x.parent?v(x.parent):void 0},[]),y=g.useCallback(async(x,T=!1)=>{e(!0),a(null);const p=`admin_categories_${JSON.stringify(x||{})}`;try{if(!T){const u=de.getItem(p);if(u&&Array.isArray(u.data))return console.log("💾 useAdminCategories: Usando categorías en caché"),o(u.data),e(!1),u}console.log("🌐 useAdminCategories: Obteniendo categorías desde API");const S=await Bn.execute({...x});if(S&&typeof S=="object"&&"data"in S&&Array.isArray(S.data)){const u=S.data.map(v),I={data:u,meta:S.meta||{total:u.length}};return de.setItem(p,I,X.cache.categoryCacheTime),o(u),I}else return console.warn("Respuesta de categorías no tiene el formato esperado:",S),o([]),{data:[],meta:{total:0}}}catch(S){const u=S instanceof Error?S.message:"Error al obtener categorías";return a(u),console.error("Error al obtener categorías:",S),o([]),{data:[],meta:{total:0}}}finally{e(!1)}},[v]),_=g.useCallback(async(x=!0,T=!1)=>{e(!0),a(null);const p=`admin_main_categories_${x?"with_counts":"no_counts"}`;try{if(!T){const P=de.getItem(p);if(P&&Array.isArray(P))return console.log("💾 useAdminCategories: Usando categorías principales en caché"),d(P),e(!1),P}console.log("🌐 useAdminCategories: Obteniendo categorías principales desde API");const S=await ge.getMainCategories(x);let u=[];if(Array.isArray(S))u=S;else if(S&&typeof S=="object"&&"data"in S&&Array.isArray(S.data))u=S.data;else return console.warn("Respuesta de categorías principales no tiene el formato esperado:",S),d([]),[];const I=u.map(v);return de.setItem(p,I,X.cache.categoryCacheTime),d(I),I}catch(S){const u=S instanceof Error?S.message:"Error al obtener categorías principales";return a(u),console.error("Error al obtener categorías principales:",S),d([]),[]}finally{e(!1)}},[v]),l=g.useCallback(async x=>{e(!0),a(null);const T=`admin_category_${x}`;try{const p=de.getItem(T);if(p)return console.log(`💾 useAdminCategories: Usando categoría ${x} en caché`),h(p),e(!1),p;console.log(`🌐 useAdminCategories: Obteniendo categoría ${x} desde API`);const S=await Jn.execute(x);if(S&&typeof S=="object"){const u=v(S);return de.setItem(T,u,X.cache.categoryCacheTime),h(u),u}return h(null),null}catch(p){const S=p instanceof Error?p.message:"Error al obtener categoría";return a(S),console.error("Error al obtener categoría:",p),h(null),null}finally{e(!1)}},[v]),C=g.useCallback(async x=>{e(!0),a(null);try{console.log("🌐 useAdminCategories: Creando nueva categoría:",x);const T=await Vn.execute(x);if(T&&typeof T=="object"){const p=v(T);return o(S=>[...S,p]),x.parent_id||d(S=>[...S,p]),m(["admin_categories_*","categories_*","admin_main_categories_*","categories_main_*","categories_featured_*"]),p}return null}catch(T){const p=T instanceof Error?T.message:"Error al crear categoría";return a(p),console.error("Error al crear categoría:",T),null}finally{e(!1)}},[v,m]),f=g.useCallback(async x=>{e(!0),a(null);try{console.log(`🌐 useAdminCategories: Actualizando categoría ${x.id}:`,x);const T=await Gn.execute(x);if(T&&typeof T=="object"){const p=v(T);return o(S=>S.map(u=>u.id===x.id?p:u)),d(S=>S.map(u=>u.id===x.id?p:u)),c?.id===x.id&&h(p),m(["admin_categories_*","categories_*",`admin_category_${x.id}`,`category_${x.id}`,"admin_main_categories_*","categories_main_*","categories_featured_*"]),p}return null}catch(T){const p=T instanceof Error?T.message:"Error al actualizar categoría";return a(p),console.error("Error al actualizar categoría:",T),null}finally{e(!1)}},[v,c,m]),j=g.useCallback(async x=>{e(!0),a(null);try{return console.log(`🌐 useAdminCategories: Eliminando categoría ${x}`),await Hn.execute(x)?(o(p=>p.filter(S=>S.id!==x)),d(p=>p.filter(S=>S.id!==x)),c?.id===x&&h(null),m(["admin_categories_*","categories_*",`admin_category_${x}`,`category_${x}`,"admin_main_categories_*","categories_main_*","categories_featured_*"]),!0):!1}catch(T){const p=T instanceof Error?T.message:"Error al eliminar categoría";return a(p),console.error("Error al eliminar categoría:",T),!1}finally{e(!1)}},[c,m]),w=g.useCallback(async(x,T)=>{e(!0),a(null);try{if(console.log(`🌐 useAdminCategories: Cambiando estado activo de categoría ${x} a ${T}`),await Kn.execute(x,T)){const S=u=>u.id===x?{...u,is_active:T}:u;return o(u=>u.map(S)),d(u=>u.map(S)),c?.id===x&&h(u=>u&&{...u,is_active:T}),m(["admin_categories_*","categories_*",`admin_category_${x}`,`category_${x}`,"admin_main_categories_*","categories_main_*","categories_featured_*"]),!0}return!1}catch(p){const S=p instanceof Error?p.message:"Error al cambiar estado activo";return a(S),console.error("Error al cambiar estado activo:",p),!1}finally{e(!1)}},[c,m]),E=g.useCallback(async(x,T)=>{e(!0),a(null);try{if(console.log(`🌐 useAdminCategories: Cambiando estado destacado de categoría ${x} a ${T}`),await Wn.execute(x,T)){const S=u=>u.id===x?{...u,featured:T}:u;return o(u=>u.map(S)),d(u=>u.map(S)),c?.id===x&&h(u=>u&&{...u,featured:T}),m(["admin_categories_*","categories_*",`admin_category_${x}`,`category_${x}`,"admin_main_categories_*","categories_main_*","categories_featured_*"]),!0}return!1}catch(p){const S=p instanceof Error?p.message:"Error al cambiar estado destacado";return a(S),console.error("Error al cambiar estado destacado:",p),!1}finally{e(!1)}},[c,m]),R=g.useCallback(x=>{x?(m([`admin_category_${x}`,`category_${x}`]),console.log(`🗑️ Caché de la categoría ${x} invalidada`)):(m(["admin_categories_*","categories_*","admin_category_*","category_*","admin_main_categories_*","categories_main_*","categories_featured_*"]),console.log("🗑️ Toda la caché de categorías invalidada"))},[m]);return{loading:s,error:t,categories:n,mainCategories:i,categoryDetail:c,fetchAllCategories:y,fetchMainCategories:_,fetchCategoryById:l,createCategory:C,updateCategory:f,deleteCategory:j,toggleActive:w,toggleFeatured:E,clearCategoryCache:R,setError:x=>a(x),setLoading:x=>e(x)}},Xn=()=>{const s=ut(),t=new URLSearchParams(s.search).get("sellerId"),{loading:a,error:n,products:o,meta:i,fetchAllProducts:d,deleteProduct:c,toggleFeatured:h,togglePublished:m,clearProductCache:v}=Dn(),{loading:y,categories:_,fetchAllCategories:l}=Ds(),[C,f]=g.useState(0),[j,w]=g.useState(t?parseInt(t):0),[E,R]=g.useState("all"),[x,T]=g.useState("all"),[p,S]=g.useState(""),[u,I]=g.useState(1),[P]=g.useState(15),[U,k]=g.useState(null);g.useEffect(()=>{W(),B()},[]),g.useEffect(()=>{W()},[C,j,E,x,p,u]),g.useEffect(()=>{const F=new URLSearchParams(s.search).get("sellerId"),M=F?parseInt(F):0;M!==j&&(w(M),I(1))},[s.search,j]);const B=g.useCallback(async()=>{try{await l({with_counts:!0})}catch(N){console.error("Error al cargar categorías:",N)}},[l]),W=g.useCallback(async()=>{console.log("🚀 AdminProductsPage: Iniciando loadData..."),console.log("📍 AdminProductsPage: Página actual:",u),console.log("📍 AdminProductsPage: Items por página:",P);try{const N={limit:P,offset:(u-1)*P};switch(console.log("🔧 AdminProductsPage: FilterParams inicial:",N),p&&(N.term=p),C&&C>0&&(N.categoryId=C),j&&j>0&&(N.sellerId=j),E){case"active":N.status="active",N.published=!0;break;case"draft":N.status="draft";break;case"inactive":N.published=!1;break}switch(x){case"inStock":N.inStock=!0;break;case"lowStock":N.inStock=!0;break;case"outOfStock":N.inStock=!1;break}console.log("🔧 AdminProductsPage: Cargando productos con filtros:",N),await d(N)}catch(N){console.error("Error al cargar productos:",N)}},[d,C,j,E,x,p,u,P]),ie=g.useCallback(async(N,F)=>{if(window.confirm(`¿Estás seguro de que deseas eliminar el producto "${F}"?`)){k(N);try{await c(N)?W():alert("Error al eliminar el producto")}catch(V){console.error("Error al eliminar producto:",V),alert("Error al eliminar el producto")}finally{k(null)}}},[c,W]),ue=g.useCallback(async(N,F)=>{k(N);try{const M=!F;console.log(`🌟 Toggling featured for product ${N}: ${F} -> ${M}`),await h(N,M)||alert("Error al cambiar estado destacado")}catch(M){console.error("Error al cambiar estado destacado:",M),alert("Error al cambiar estado destacado")}finally{k(null)}},[h]),te=g.useCallback(async(N,F)=>{k(N);try{const M=!F;console.log(`📢 Toggling published for product ${N}: ${F} -> ${M}`),await m(N,M)||alert("Error al cambiar estado de publicación")}catch(M){console.error("Error al cambiar estado de publicación:",M),alert("Error al cambiar estado de publicación")}finally{k(null)}},[m]),A=g.useCallback(()=>{v(),W()},[v,W]),ee=g.useCallback(N=>{I(N)},[]),H=N=>{if(!N)return"Sin categoría";const F=_.find(M=>M.id===N);return F?F.name:"Categoría desconocida"},be=({product:N})=>{const[F,M]=g.useState(gr(N)),[V,pe]=g.useState(!1),[_e,Te]=g.useState(0);g.useEffect(()=>{M(gr(N)),pe(!1),Te(0)},[N]);const nr=g.useCallback(()=>{if(console.warn(`Error cargando imagen para producto ${N.id}:`,F),_e>=2){console.warn(`Demasiados errores para producto ${N.id}, manteniendo placeholder`);return}Te(or=>or+1),V||(pe(!0),M(gr(null)))},[F,V,_e,N.id]);return r.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-md bg-gray-200 flex items-center justify-center overflow-hidden",children:r.jsx("img",{src:F,alt:N.name,className:"h-10 w-10 object-cover",onError:nr,loading:"lazy"})})},le=o.filter(N=>x==="lowStock"?N.stock>0&&N.stock<=10:!0),ae=[{key:"product",header:"Producto",sortable:!0,render:N=>r.jsxs("div",{className:"flex items-center",children:[r.jsx(be,{product:N}),r.jsxs("div",{className:"ml-4",children:[r.jsxs("div",{className:"text-sm font-medium text-gray-900 flex items-center",children:[N.name,N.featured&&r.jsx("span",{className:"ml-2",children:r.jsx(me,{className:"h-4 w-4 text-yellow-500 inline"})})]}),r.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",N.id]})]})]})},{key:"category",header:"Categoría",sortable:!0,render:N=>r.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[r.jsx(Qs,{className:"w-3 h-3 mr-1"}),H(N.categoryId)]})},{key:"seller",header:"Vendedor",sortable:!0,render:N=>{const F=N.seller?.name||"Tienda desconocida",M=N.user?.name||"Usuario desconocido",V=N.seller_id||N.seller?.id;return r.jsxs("div",{className:"text-sm",children:[r.jsx("div",{className:"font-medium text-gray-900",children:F}),r.jsxs("div",{className:"text-xs text-gray-500",children:["Vendedor ID: ",V||"N/A"," - ",M]})]})}},{key:"price",header:"Precio",sortable:!0,render:N=>r.jsx("div",{children:N.discountPercentage&&N.discountPercentage>0?r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-500 line-through text-xs mr-1",children:Ee(N.price)}),r.jsx("span",{className:"font-semibold text-green-600",children:Ee(N.finalPrice||N.price*(1-N.discountPercentage/100))}),r.jsxs("span",{className:"ml-1 bg-green-100 text-green-800 text-xs font-semibold px-1.5 py-0.5 rounded",children:["-",N.discountPercentage,"%"]})]}):r.jsx("span",{className:"font-semibold",children:Ee(N.price)})})},{key:"stock",header:"Stock",sortable:!0,render:N=>r.jsx("div",{children:N.stock===0?r.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Agotado"}):N.stock<=10?r.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[N.stock," unidades"]}):r.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[N.stock," unidades"]})})},{key:"status",header:"Estado",sortable:!0,render:N=>{let F="",M="",V=Se;return N.published?N.status==="draft"?(F="bg-gray-100 text-gray-800",M="Borrador",V=Ur):N.status==="active"?(F="bg-green-100 text-green-800",M="Activo",V=Se):(F="bg-red-100 text-red-800",M="Inactivo",V=Ur):(F="bg-yellow-100 text-yellow-800",M="No publicado",V=Ie),r.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${F}`,children:[r.jsx(V,{className:"w-3 h-3 mr-1"}),M]})}},{key:"rating",header:"Valoración",sortable:!0,render:N=>{const F=N.calculated_rating??N.rating??0,M=N.calculated_rating_count??N.ratingCount??N.rating_count??0;return r.jsx("div",{className:"flex items-center",children:F>0?r.jsxs(r.Fragment,{children:[r.jsx(me,{className:"h-4 w-4 text-yellow-500 mr-1"}),r.jsx("span",{children:parseFloat(F).toFixed(1)}),r.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["(",M,")"]})]}):r.jsx("span",{className:"text-xs text-gray-500",children:"Sin valoraciones"})})}},{key:"sales",header:"Ventas",sortable:!0,render:N=>{const F=N.sales_count??0,M=N.total_quantity_sold??0;return r.jsxs("div",{className:"text-sm",children:[r.jsxs("div",{className:"font-medium",children:[F," órdenes"]}),r.jsxs("div",{className:"text-xs text-gray-500",children:[M," uds."]})]})}},{key:"actions",header:"Acciones",render:N=>r.jsxs("div",{className:"flex justify-end space-x-1",children:[r.jsx(Y,{to:`/products/${N.id}`,target:"_blank",className:"p-1 text-blue-600 hover:bg-blue-100 rounded-md",title:"Ver en tienda",children:r.jsx(He,{size:16})}),r.jsx(Y,{to:`/admin/products/edit/${N.id}`,className:"p-1 text-yellow-600 hover:bg-yellow-100 rounded-md",title:"Editar producto",children:r.jsx(ts,{size:16})}),r.jsx("button",{onClick:()=>ue(N.id,N.featured||!1),disabled:U===N.id,className:`p-1 rounded-md transition-colors ${N.featured?"text-yellow-500 hover:bg-yellow-100":"text-gray-600 hover:bg-gray-100"} ${U===N.id?"opacity-50 cursor-not-allowed":""}`,title:N.featured?"Quitar destacado":"Destacar producto",children:r.jsx(me,{size:16,className:N.featured?"fill-current":""})}),r.jsx("button",{onClick:()=>te(N.id,N.published||!1),disabled:U===N.id,className:`p-1 rounded-md transition-colors ${N.published?"text-green-600 hover:bg-green-100":"text-gray-600 hover:bg-gray-100"} ${U===N.id?"opacity-50 cursor-not-allowed":""}`,title:N.published?"Despublicar":"Publicar",children:r.jsx(Se,{size:16})}),r.jsx("button",{onClick:()=>ie(N.id,N.name),disabled:U===N.id,className:`p-1 text-red-600 hover:bg-red-100 rounded-md transition-colors ${U===N.id?"opacity-50 cursor-not-allowed":""}`,title:"Eliminar producto",children:r.jsx(je,{size:16})})]})}],ce=a||y;return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Gestión de Productos",j>0&&r.jsxs("span",{className:"ml-2 text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded-md",children:["Vendedor ID: ",j]})]}),i&&r.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[i.total," productos encontrados",j>0&&" para este vendedor"]})]}),r.jsxs("div",{className:"flex space-x-2",children:[r.jsxs(Y,{to:"/admin/products/create",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center",children:[r.jsx(Tr,{className:"w-4 h-4 mr-2"}),"Nuevo Producto"]}),r.jsxs("button",{onClick:A,disabled:ce,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors flex items-center disabled:opacity-50",children:[r.jsx(G,{size:16,className:`mr-2 ${ce?"animate-spin":""}`}),"Actualizar"]})]})]}),n&&r.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:["Error: ",n]}),r.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(wr,{className:"h-5 w-5 text-gray-500"}),r.jsx("input",{type:"text",placeholder:"Buscar productos...",value:p,onChange:N=>S(N.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 flex-1"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Xe,{className:"h-5 w-5 text-gray-500"}),r.jsxs("select",{className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 flex-1",value:C,onChange:N=>f(Number(N.target.value)),children:[r.jsx("option",{value:0,children:"Todas las categorías"}),_.map(N=>r.jsxs("option",{value:N.id,children:[N.name," (",N.product_count||0,")"]},N.id))]})]}),r.jsx("div",{className:"flex items-center space-x-2",children:r.jsxs("select",{className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 flex-1",value:E,onChange:N=>R(N.target.value),children:[r.jsx("option",{value:"all",children:"Todos los Estados"}),r.jsx("option",{value:"active",children:"Activos"}),r.jsx("option",{value:"draft",children:"Borrador"}),r.jsx("option",{value:"inactive",children:"Inactivos"})]})}),r.jsx("div",{className:"flex items-center space-x-2",children:r.jsxs("select",{className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 flex-1",value:x,onChange:N=>T(N.target.value),children:[r.jsx("option",{value:"all",children:"Todo el Stock"}),r.jsx("option",{value:"inStock",children:"En stock"}),r.jsx("option",{value:"lowStock",children:"Stock bajo (≤10)"}),r.jsx("option",{value:"outOfStock",children:"Sin stock"})]})})]})}),r.jsx(ar,{data:le,columns:ae,searchFields:[],loading:ce,emptyMessage:"No se encontraron productos",pagination:{currentPage:u,totalPages:Math.ceil((i?.total||0)/P),totalItems:i?.total||0,itemsPerPage:P,onPageChange:ee}})]})},Oo=Object.freeze(Object.defineProperty({__proto__:null,default:Xn},Symbol.toStringTag,{value:"Module"})),Yn=()=>{const{loading:s,error:e,categories:t,mainCategories:a,fetchAllCategories:n,fetchMainCategories:o,deleteCategory:i,toggleActive:d,toggleFeatured:c,clearCategoryCache:h}=Ds(),[m,v]=g.useState(null),[y,_]=g.useState("all"),[l,C]=g.useState(""),[f,j]=g.useState("all"),[w,E]=g.useState(1),[R]=g.useState(15),[x,T]=g.useState(null);g.useEffect(()=>{p()},[]),g.useEffect(()=>{p()},[m,y,l]);const p=g.useCallback(async()=>{try{const A={};m!==null&&(A.parent_id=m),y!=="all"&&(A.is_active=y==="active"),l&&(A.term=l),await n(A),a.length===0&&await o(!0)}catch(A){console.error("Error al cargar categorías:",A)}},[n,o,m,y,l,a.length]),S=t.filter(A=>!(l&&!A.name.toLowerCase().includes(l.toLowerCase()))),u=g.useCallback(async(A,ee)=>{T(A);try{await c(A,!ee)?await p():alert("Error al cambiar estado destacado de la categoría")}catch(H){console.error("Error al cambiar estado destacado:",H),alert("Error al cambiar estado destacado de la categoría")}finally{T(null)}},[c,p]),I=g.useCallback(async(A,ee)=>{T(A);try{await d(A,!ee)?await p():alert("Error al cambiar estado activo de la categoría")}catch(H){console.error("Error al cambiar estado activo:",H),alert("Error al cambiar estado activo de la categoría")}finally{T(null)}},[d,p]),P=g.useCallback(async(A,ee)=>{if(t.some(le=>le.parent_id===A)){alert("Esta categoría tiene subcategorías. Debes eliminar primero las subcategorías.");return}if(window.confirm(`¿Estás seguro de que deseas eliminar la categoría "${ee}"?`)){T(A);try{await i(A)?p():alert("Error al eliminar la categoría")}catch(le){console.error("Error al eliminar categoría:",le),alert("Error al eliminar la categoría")}finally{T(null)}}},[i,t,p]),U=g.useCallback(()=>{h(),p()},[h,p]),k=g.useCallback(A=>{E(A)},[]),B=A=>{if(!A)return"Sin categoría padre";const ee=t.find(H=>H.id===A)||a.find(H=>H.id===A);return ee?ee.name:"Categoría padre desconocida"},W=[{key:"category",header:"Categoría",sortable:!0,render:A=>r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-md bg-blue-100 flex items-center justify-center",children:r.jsx(rt,{className:"h-6 w-6 text-blue-600"})}),r.jsxs("div",{className:"ml-4",children:[r.jsxs("div",{className:"text-sm font-medium text-gray-900 flex items-center",children:[A.name,A.featured&&r.jsx("span",{className:"ml-2",children:r.jsx(me,{className:"h-4 w-4 text-yellow-500 inline"})})]}),r.jsxs("div",{className:"text-xs text-gray-500 flex items-center",children:["ID: ",A.id,A.parent_id&&r.jsxs("span",{className:"ml-2",children:["Padre: ",B(A.parent_id)]})]})]})]})},{key:"slug",header:"Slug",sortable:!0,render:A=>r.jsx("div",{className:"text-sm text-gray-500 font-mono",children:A.slug})},{key:"description",header:"Descripción",render:A=>r.jsx("div",{className:"text-sm text-gray-600 max-w-xs truncate",children:A.description||"Sin descripción"})},{key:"products",header:"Productos",sortable:!0,render:A=>r.jsx("div",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:A.product_count||0})},{key:"status",header:"Estado",sortable:!0,render:A=>r.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${A.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:A.is_active?r.jsxs(r.Fragment,{children:[r.jsx(He,{className:"w-3 h-3 mr-1"}),"Activa"]}):r.jsxs(r.Fragment,{children:[r.jsx($r,{className:"w-3 h-3 mr-1"}),"Inactiva"]})})},{key:"children",header:"Subcategorías",render:A=>r.jsx("div",{children:A.has_children?r.jsxs("button",{onClick:()=>v(A.id||null),className:"text-primary-600 hover:text-primary-800 underline flex items-center",children:[r.jsx(st,{className:"h-4 w-4 mr-1"}),"Ver subcategorías"]}):r.jsx("span",{className:"text-gray-500 text-sm",children:"Sin subcategorías"})})},{key:"order",header:"Orden",sortable:!0,render:A=>r.jsx("div",{className:"text-center",children:A.order||"-"})},{key:"actions",header:"Acciones",render:A=>r.jsxs("div",{className:"flex justify-end space-x-1",children:[r.jsx(Y,{to:`/categories/${A.slug}`,target:"_blank",className:"p-1 text-blue-600 hover:bg-blue-100 rounded-md",title:"Ver en tienda",children:r.jsx(tt,{size:16})}),r.jsx(Y,{to:`/admin/categories/edit/${A.id}`,className:"p-1 text-yellow-600 hover:bg-yellow-100 rounded-md",title:"Editar categoría",children:r.jsx(ts,{size:16})}),r.jsx("button",{onClick:()=>u(A.id,A.featured),disabled:x===A.id,className:`p-1 rounded-md transition-colors ${A.featured?"text-yellow-600 hover:bg-yellow-100":"text-gray-600 hover:bg-gray-100"} ${x===A.id?"opacity-50 cursor-not-allowed":""}`,title:A.featured?"Quitar destacado":"Destacar categoría",children:r.jsx(me,{size:16})}),r.jsx("button",{onClick:()=>I(A.id,A.is_active),disabled:x===A.id,className:`p-1 rounded-md transition-colors ${A.is_active?"text-green-600 hover:bg-green-100":"text-red-600 hover:bg-red-100"} ${x===A.id?"opacity-50 cursor-not-allowed":""}`,title:A.is_active?"Desactivar":"Activar",children:A.is_active?r.jsx(He,{size:16}):r.jsx($r,{size:16})}),r.jsx(Y,{to:`/admin/categories/create?parent=${A.id}`,className:"p-1 text-green-600 hover:bg-green-100 rounded-md",title:"Añadir subcategoría",children:r.jsx(Tr,{size:16})}),r.jsx("button",{onClick:()=>P(A.id,A.name),disabled:x===A.id,className:`p-1 text-red-600 hover:bg-red-100 rounded-md transition-colors ${x===A.id?"opacity-50 cursor-not-allowed":""}`,title:"Eliminar categoría",children:r.jsx(je,{size:16})})]})}],ie=Math.ceil(S.length/R),ue=(w-1)*R,te=S.slice(ue,ue+R);return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestión de Categorías"}),r.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[S.length," categorías encontradas"]})]}),r.jsxs("div",{className:"flex space-x-2",children:[r.jsxs(Y,{to:"/admin/categories/create",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center",children:[r.jsx(et,{className:"w-4 h-4 mr-2"}),"Nueva Categoría"]}),r.jsxs("button",{onClick:U,disabled:s,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors flex items-center disabled:opacity-50",children:[r.jsx(G,{size:16,className:`mr-2 ${s?"animate-spin":""}`}),"Actualizar"]})]})]}),e&&r.jsxs("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:["Error: ",e]}),r.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(wr,{className:"h-5 w-5 text-gray-500"}),r.jsx("input",{type:"text",placeholder:"Buscar categorías...",value:l,onChange:A=>C(A.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 flex-1"})]}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx(Xe,{className:"h-5 w-5 text-gray-500"}),r.jsxs("select",{className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 flex-1",value:m===null?"null":m,onChange:A=>v(A.target.value==="null"?null:Number(A.target.value)),children:[r.jsx("option",{value:"null",children:"Todas las categorías"}),r.jsx("option",{value:0,children:"Categorías principales"}),a.map(A=>r.jsxs("option",{value:A.id,children:["Subcategorías de ",A.name]},A.id))]})]}),r.jsx("div",{className:"flex items-center space-x-2",children:r.jsxs("select",{className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500 flex-1",value:y,onChange:A=>_(A.target.value),children:[r.jsx("option",{value:"all",children:"Todos los Estados"}),r.jsx("option",{value:"active",children:"Activas"}),r.jsx("option",{value:"inactive",children:"Inactivas"})]})}),r.jsxs("div",{className:"flex items-center space-x-2",children:[r.jsx("span",{className:"text-sm text-gray-600 whitespace-nowrap",children:"Vista:"}),r.jsxs("div",{className:"flex border border-gray-300 rounded-lg overflow-hidden",children:[r.jsx("button",{className:`px-3 py-1 text-sm ${f==="all"?"bg-primary-600 text-white":"bg-white text-gray-700"}`,onClick:()=>j("all"),children:"Tabla"}),r.jsx("button",{className:`px-3 py-1 text-sm ${f==="tree"?"bg-primary-600 text-white":"bg-white text-gray-700"}`,onClick:()=>j("tree"),children:"Árbol"})]})]})]})}),f==="tree"?r.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[r.jsx("h3",{className:"text-lg font-medium mb-4",children:"Vista de árbol de categorías"}),r.jsx("p",{className:"text-gray-500",children:"Esta vista está en desarrollo. Por favor, utilice la vista de tabla."})]}):r.jsx(ar,{data:te,columns:W,searchFields:[],loading:s,emptyMessage:"No se encontraron categorías",pagination:{currentPage:w,totalPages:ie,totalItems:S.length,itemsPerPage:R,onPageChange:k}})]})},Do=Object.freeze(Object.defineProperty({__proto__:null,default:Yn},Symbol.toStringTag,{value:"Module"}));class Zn{async getAdminOrders(e){try{console.log("AdminOrderService: Obteniendo órdenes con filtros:",e);const t=await $.get(D.ADMIN.ORDERS,e);console.log("AdminOrderService: Respuesta de órdenes:",t);const a=t?.data||[],n=t?.pagination||{currentPage:1,totalPages:1,totalItems:0,itemsPerPage:10};return{data:a,meta:{total:n.totalItems,per_page:n.itemsPerPage,current_page:n.currentPage,last_page:n.totalPages}}}catch(t){return console.error("AdminOrderService: Error al obtener órdenes:",t),{data:[],meta:{total:0,per_page:10,current_page:1,last_page:1}}}}async getOrderDetails(e){try{console.log(`AdminOrderService: Obteniendo detalle de orden ${e}`);const t=await $.get(D.ADMIN.ORDER_DETAIL(e));if(console.log(`AdminOrderService: Respuesta para orden ${e}:`,t),!t||!t.data)throw new Error("Respuesta vacía al obtener detalle de orden");return t.data}catch(t){throw console.error(`AdminOrderService: Error al obtener detalle de orden ${e}:`,t),t}}async updateOrderStatus(e,t){try{console.log(`AdminOrderService: Actualizando estado de orden ${e} a ${t.status}`);const a=await $.put(D.ADMIN.UPDATE_ORDER_STATUS(e),t);if(console.log(`AdminOrderService: Respuesta de actualización para orden ${e}:`,a),!a||!a.data)throw new Error("Respuesta vacía al actualizar estado de orden");return a.data}catch(a){throw console.error(`AdminOrderService: Error al actualizar estado de orden ${e}:`,a),a}}async cancelOrder(e,t=""){try{console.log(`AdminOrderService: Cancelando orden ${e}`);const a=await $.post(D.ADMIN.CANCEL_ORDER(e),{reason:t});return console.log(`AdminOrderService: Respuesta de cancelar orden ${e}:`,a),a?.success||!1}catch(a){return console.error(`AdminOrderService: Error al cancelar orden ${e}:`,a),!1}}async updateShippingInfo(e,t){try{console.log(`AdminOrderService: Actualizando información de envío para orden ${e}`);const a=await $.patch(D.ADMIN.UPDATE_SHIPPING(e),t);return console.log(`AdminOrderService: Respuesta de actualización de envío para ${e}:`,a),a?.success||!1}catch(a){return console.error(`AdminOrderService: Error al actualizar envío de orden ${e}:`,a),!1}}async getOrderStats(){try{console.log("AdminOrderService: Obteniendo estadísticas de órdenes");const e=await $.get(D.ADMIN.ORDER_STATS);if(console.log("AdminOrderService: Respuesta de estadísticas:",e),!e||!e.data)throw new Error("Respuesta vacía al obtener estadísticas");return e.data}catch(e){return console.error("AdminOrderService: Error al obtener estadísticas:",e),{totalOrders:0,pendingOrders:0,processingOrders:0,shippedOrders:0,deliveredOrders:0,cancelledOrders:0,totalSales:0}}}}class Qn{adminOrderService;constructor(){this.adminOrderService=new Zn}async getAdminOrders(e){try{const t={...e};e?.status==="all"&&delete t.status,e?.paymentStatus==="all"&&delete t.paymentStatus,e?.sellerId===null&&delete t.sellerId;const a=await this.adminOrderService.getAdminOrders(t),n=a.data.map(i=>this.adaptOrderToUI(i)),o={currentPage:a.meta.current_page,totalPages:a.meta.last_page,totalItems:a.meta.total,itemsPerPage:a.meta.per_page};return{orders:n,pagination:o}}catch(t){return console.error("Error en AdminOrderServiceAdapter.getAdminOrders:",t),{orders:[],pagination:{currentPage:1,totalPages:1,totalItems:0,itemsPerPage:10}}}}async getOrderDetails(e){try{const t=await this.adminOrderService.getOrderDetails(e);return this.adaptOrderToUI(t)}catch(t){return console.error(`Error al obtener detalles de la orden ${e}:`,t),null}}async updateOrderStatus(e,t){try{return await this.adminOrderService.updateOrderStatus(e,{status:t}),!0}catch(a){return console.error(`Error al actualizar estado de la orden ${e}:`,a),!1}}async cancelOrder(e,t=""){try{return await this.adminOrderService.cancelOrder(e,t)}catch(a){return console.error(`Error al cancelar la orden ${e}:`,a),!1}}async getOrderStats(){try{const e=await this.adminOrderService.getOrderStats();return[{label:"Total Pedidos",value:e.totalOrders,color:"blue",isCurrency:!1},{label:"Pendientes",value:e.pendingOrders,color:"yellow",isCurrency:!1},{label:"En Proceso",value:e.processingOrders,color:"blue",isCurrency:!1},{label:"Enviados",value:e.shippedOrders,color:"indigo",isCurrency:!1},{label:"Entregados",value:e.deliveredOrders,color:"purple",isCurrency:!1},{label:"Completados",value:e.completedOrders,color:"green",isCurrency:!1},{label:"Cancelados",value:e.cancelledOrders,color:"red",isCurrency:!1},{label:"Total Ventas",value:e.totalSales,color:"green",isCurrency:!0}]}catch(e){return console.error("Error en AdminOrderServiceAdapter.getOrderStats:",e),[]}}adaptOrderToUI(e){const t=e.user_name||(e.user?e.user.name:"Cliente")||(e.customer?e.customer.name:"Cliente"),a=e.user_email||(e.user?e.user.email:"")||(e.customer?e.customer.email:""),n=e.seller_name||(e.seller?e.seller.name:"Vendedor")||"Vendedor",o=Array.isArray(e.items)?e.items.map(d=>({id:d.id||0,productId:d.product_id||d.productId||0,name:d.product_name||(d.product?d.product.name:"Producto"),quantity:d.quantity||0,price:d.price||0,subtotal:d.subtotal||0,image:d.product_image||(d.product?d.product.image:void 0)})):[];let i=null;if(e.shipping_data)if(typeof e.shipping_data=="string")try{i=JSON.parse(e.shipping_data)}catch(d){console.error("Error al parsear shipping_data:",d),i={}}else i=e.shipping_data;return{id:e.id||0,orderNumber:e.order_number||e.orderNumber||`#${e.id}`,date:e.created_at||e.createdAt||e.date||new Date().toISOString(),customer:{id:e.user_id||(e.user?e.user.id:0)||0,name:t,email:a},seller:{id:e.seller_id||(e.seller?e.seller.id:0)||0,name:n},total:e.total||0,status:e.status||"pending",paymentStatus:e.payment_status||e.paymentStatus||"pending",paymentMethod:e.payment_method||e.paymentMethod||"N/A",items:o,shippingData:i}}}const eo=()=>{const[s,e]=g.useState([]),[t,a]=g.useState(!0),[n,o]=g.useState({status:"all",paymentStatus:"all",sellerId:null}),[i,d]=g.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:10}),c=new Qn;g.useEffect(()=>{h()},[n,i.currentPage]);const h=async()=>{a(!0);try{const p={status:n.status!=="all"?n.status:void 0,paymentStatus:n.paymentStatus!=="all"?n.paymentStatus:void 0,sellerId:n.sellerId,dateFrom:n.dateFrom,dateTo:n.dateTo,search:n.search,page:i.currentPage,limit:i.itemsPerPage},S=await c.getAdminOrders(p);e(S.orders),d({currentPage:S.pagination.currentPage,totalPages:S.pagination.totalPages,totalItems:S.pagination.totalItems,itemsPerPage:S.pagination.itemsPerPage})}catch(p){console.error("Error al cargar órdenes:",p)}finally{a(!1)}},m={pending:{label:"Pendiente",color:"bg-yellow-100 text-yellow-800",icon:r.jsx(Ie,{className:"w-3 h-3 mr-1"})},processing:{label:"En proceso",color:"bg-blue-100 text-blue-800",icon:r.jsx(G,{className:"w-3 h-3 mr-1"})},paid:{label:"Pagado",color:"bg-teal-100 text-teal-800",icon:r.jsx(Se,{className:"w-3 h-3 mr-1"})},shipped:{label:"Enviado",color:"bg-indigo-100 text-indigo-800",icon:r.jsx(Pr,{className:"w-3 h-3 mr-1"})},delivered:{label:"Entregado",color:"bg-purple-100 text-purple-800",icon:r.jsx(Ar,{className:"w-3 h-3 mr-1"})},completed:{label:"Completado",color:"bg-emerald-100 text-emerald-800",icon:r.jsx(Se,{className:"w-3 h-3 mr-1"})},cancelled:{label:"Cancelado",color:"bg-red-100 text-red-800",icon:r.jsx(Lr,{className:"w-3 h-3 mr-1"})},returned:{label:"Devuelto",color:"bg-orange-100 text-orange-800",icon:r.jsx(at,{className:"w-3 h-3 mr-1"})},ready_for_pickup:{label:"Listo para recoger",color:"bg-purple-100 text-purple-800",icon:r.jsx(pr,{className:"w-3 h-3 mr-1"})}},v={paid:{label:"Pagado",color:"bg-green-100 text-green-800"},completed:{label:"Completado",color:"bg-green-100 text-green-800"},pending:{label:"Pendiente",color:"bg-yellow-100 text-yellow-800"},refunded:{label:"Reembolsado",color:"bg-red-100 text-red-800"},failed:{label:"Fallido",color:"bg-gray-100 text-gray-800"}},y={credit_card:"Tarjeta de crédito",paypal:"PayPal",bank_transfer:"Transferencia bancaria",cash_on_delivery:"Contra reembolso"},_=p=>({pending:"processing",processing:"shipped",shipped:"delivered",delivered:"completed"})[p]||p,l=async(p,S)=>{a(!0);try{await c.updateOrderStatus(p,S)?e(I=>I.map(P=>P.id===p?{...P,status:S,updatedAt:new Date().toISOString()}:P)):alert("Error al actualizar el estado de la orden")}catch(u){console.error("Error al actualizar estado:",u),alert("Error al actualizar el estado de la orden")}finally{a(!1)}},C=(p,S)=>{const u=_(S);u!==S&&l(p,u)},f=async p=>{if(window.confirm("¿Estás seguro de que deseas cancelar este pedido?")){a(!0);try{await c.cancelOrder(p)?e(u=>u.map(I=>I.id===p?{...I,status:"cancelled",updatedAt:new Date().toISOString()}:I)):alert("Error al cancelar la orden")}catch(S){console.error("Error al cancelar orden:",S),alert("Error al cancelar la orden")}finally{a(!1)}}},j=p=>{if(!p)return"N/A";const S=new Date(p);return new Intl.DateTimeFormat("es-ES",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(S)},w=p=>{d(S=>({...S,currentPage:p}))},E=()=>{h()},R=(p,S)=>{o(u=>({...u,[p]:S})),d(u=>({...u,currentPage:1}))},x=()=>{o({status:"all",paymentStatus:"all",sellerId:null,dateFrom:void 0,dateTo:void 0,search:void 0})},T=[{key:"orderNumber",header:"Pedido",sortable:!0,render:p=>r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-10 w-10 rounded-lg bg-primary-100 flex items-center justify-center",children:r.jsx(pr,{className:"h-6 w-6 text-primary-600"})}),r.jsxs("div",{className:"ml-4",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:p.orderNumber}),r.jsxs("div",{className:"text-xs text-gray-500 flex items-center",children:[r.jsx(nt,{className:"w-3 h-3 mr-1"}),j(p.date)]})]})]})},{key:"customer",header:"Cliente",sortable:!0,render:p=>{const S=p.customer.name||`Usuario ${p.customer.id}`;return r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-gray-200 flex items-center justify-center",children:r.jsx(hr,{className:"h-4 w-4 text-gray-500"})}),r.jsxs("div",{className:"ml-3",children:[r.jsx("div",{className:"text-sm font-medium text-gray-900",children:S}),r.jsxs("div",{className:"text-xs text-gray-500",children:["ID: ",p.customer.id]})]})]})}},{key:"items",header:"Productos",render:p=>r.jsxs("div",{className:"text-sm",children:[r.jsx("span",{className:"font-medium",children:p.items.length})," producto(s)",p.items.length>0&&r.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[p.items.slice(0,2).map(S=>r.jsxs("div",{children:[S.quantity,"x ",S.name||`Producto ${S.productId}`]},S.id)),p.items.length>2&&r.jsxs("div",{children:["+ ",p.items.length-2," más..."]})]})]})},{key:"total",header:"Total",sortable:!0,render:p=>r.jsx("div",{className:"font-medium text-gray-900",children:Ee(p.total)})},{key:"status",header:"Estado",sortable:!0,render:p=>{const S=m[p.status]||{label:p.status,color:"bg-gray-100 text-gray-800",icon:r.jsx(J,{className:"w-3 h-3 mr-1"})};return r.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${S.color}`,children:[S.icon,S.label]})}},{key:"payment",header:"Pago",sortable:!0,render:p=>{const S=y[p.paymentMethod||""]||p.paymentMethod,u=v[p.paymentStatus||"pending"]||{label:p.paymentStatus,color:"bg-gray-100 text-gray-800"};return r.jsxs("div",{children:[r.jsx("div",{className:"text-sm text-gray-500",children:S}),r.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${u.color}`,children:u.label})]})}},{key:"actions",header:"Acciones",render:p=>{const S=["pending","processing","shipped","delivered"].includes(p.status),u=["pending","processing"].includes(p.status);return r.jsxs("div",{className:"flex justify-end space-x-2",children:[r.jsx(Y,{to:`/admin/orders/${p.id}`,className:"p-1 text-blue-600 hover:bg-blue-100 rounded-md",title:"Ver detalles del pedido",children:r.jsx(He,{size:18})}),["completed","delivered"].includes(p.status)&&r.jsx(Y,{to:`/admin/invoices?orderId=${p.id}`,className:"p-1 text-indigo-600 hover:bg-indigo-100 rounded-md",title:"Ver factura",children:r.jsx(ot,{size:18})}),S&&r.jsx("button",{onClick:()=>C(p.id,p.status),className:"p-1 text-green-600 hover:bg-green-100 rounded-md",title:`Avanzar a ${m[_(p.status)]?.label||"siguiente estado"}`,children:r.jsx(Se,{size:18})}),u&&r.jsx("button",{onClick:()=>f(p.id),className:"p-1 text-red-600 hover:bg-red-100 rounded-md",title:"Cancelar pedido",children:r.jsx(Lr,{size:18})})]})}}];return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestión de Pedidos"}),r.jsx("div",{className:"flex space-x-2",children:r.jsxs("button",{onClick:E,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[r.jsx(G,{size:18,className:"inline mr-2"}),"Actualizar"]})})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"flex flex-col space-y-1",children:[r.jsx("label",{className:"text-sm text-gray-600",children:"Estado del pedido"}),r.jsxs("div",{className:"flex items-center",children:[r.jsx(Xe,{className:"h-5 w-5 text-gray-500 mr-2"}),r.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",value:n.status,onChange:p=>R("status",p.target.value),children:[r.jsx("option",{value:"all",children:"Todos los Estados"}),Object.entries(m).map(([p,{label:S}])=>r.jsx("option",{value:p,children:S},p))]})]})]}),r.jsxs("div",{className:"flex flex-col space-y-1",children:[r.jsx("label",{className:"text-sm text-gray-600",children:"Estado de pago"}),r.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",value:n.paymentStatus,onChange:p=>R("paymentStatus",p.target.value),children:[r.jsx("option",{value:"all",children:"Todos los Estados"}),Object.entries(v).map(([p,{label:S}])=>r.jsx("option",{value:p,children:S},p))]})]}),r.jsxs("div",{className:"flex flex-col space-y-1",children:[r.jsx("label",{className:"text-sm text-gray-600",children:"Vendedor"}),r.jsxs("select",{className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",value:n.sellerId===null?"null":n.sellerId,onChange:p=>R("sellerId",p.target.value==="null"?null:Number(p.target.value)),children:[r.jsx("option",{value:"null",children:"Todos los Vendedores"}),[1,2,3,4,5].map(p=>r.jsxs("option",{value:p,children:["Vendedor ",p]},p))]})]}),r.jsxs("div",{className:"flex flex-col space-y-1",children:[r.jsx("label",{className:"text-sm text-gray-600",children:"Rango de fechas"}),r.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[r.jsx("input",{type:"date",className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",value:n.dateFrom||"",onChange:p=>R("dateFrom",p.target.value),placeholder:"Desde"}),r.jsx("input",{type:"date",className:"border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500",value:n.dateTo||"",onChange:p=>R("dateTo",p.target.value),placeholder:"Hasta"})]})]})]}),r.jsx("div",{className:"mt-4 flex justify-end",children:r.jsx("button",{onClick:x,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300",children:"Limpiar filtros"})})]}),r.jsx(ar,{data:s,columns:T,searchFields:["orderNumber","customer"],loading:t,emptyMessage:"No se encontraron pedidos",pagination:{currentPage:i.currentPage,totalPages:i.totalPages,totalItems:i.totalItems,itemsPerPage:i.itemsPerPage,onPageChange:w}})]})},ko=Object.freeze(Object.defineProperty({__proto__:null,default:eo},Symbol.toStringTag,{value:"Module"}));class Ue{constructor(){}async getDevelopmentConfigs(){try{const e=await $.get(D.ADMIN.CONFIGURATIONS.DEVELOPMENT);return e?.data?{status:"success",data:{mode:e.data.mode||!1,allowAdminOnlyAccess:e.data.allowAdminOnlyAccess||!1,bypassEmailVerification:e.data.bypassEmailVerification||!0,requireEmailVerification:e.data.requireEmailVerification||!1,emailVerificationTimeout:e.data.emailVerificationTimeout||24}}:{status:"success",data:{mode:!1,allowAdminOnlyAccess:!1,bypassEmailVerification:!0,requireEmailVerification:!1,emailVerificationTimeout:24}}}catch(e){return console.error("Error getting development configs:",e),{status:"error",message:"Error al obtener configuraciones de desarrollo"}}}async updateDevelopmentConfigs(e){try{return await $.post(D.ADMIN.CONFIGURATIONS.UPDATE,{type:"development",config:e}),re.getInstance().invalidateCache(),{status:"success",data:e,message:"Configuración actualizada correctamente"}}catch(t){return console.error("Error updating development configs:",t),{status:"error",message:"Error al actualizar configuraciones"}}}async getModerationConfigs(){try{const t=(await $.get(D.ADMIN.CONFIGURATIONS.INDEX))?.data?.moderation;return{status:"success",data:{auto_approval:t?.auto_approval||!0,review_threshold:t?.review_threshold||3,enable_user_reports:t?.enable_user_reports||!0,auto_suspend_threshold:t?.auto_suspend_threshold||5,manual_review_required:t?.manual_review_required||!1,userStrikesThreshold:t?.userStrikesThreshold||3,lowStockThreshold:t?.lowStockThreshold||5,contactScorePenalty:t?.contactScorePenalty||10,businessScoreBonus:t?.businessScoreBonus||5,contactPenaltyHeavy:t?.contactPenaltyHeavy||20,minimumContactScore:t?.minimumContactScore||50,scoreDifferenceThreshold:t?.scoreDifferenceThreshold||30,consecutiveNumbersLimit:t?.consecutiveNumbersLimit||3,numbersWithContextLimit:t?.numbersWithContextLimit||5}}}catch(e){return console.error("Error getting moderation configs:",e),{status:"error",message:"Error al obtener configuraciones de moderación"}}}async updateModerationConfigs(e){try{return await $.post(D.ADMIN.CONFIGURATIONS.UPDATE,{type:"moderation",config:e}),re.getInstance().invalidateCache(),{status:"success",data:e,message:"Configuración de moderación actualizada"}}catch(t){return console.error("Error updating moderation configs:",t),{status:"error",message:"Error al actualizar configuraciones de moderación"}}}async getSecurityConfigs(){try{const e=await $.get(D.ADMIN.CONFIGURATIONS.PASSWORD_VALIDATION_RULES);return{status:"success",data:{password_rules:{min_length:e?.data?.min_length||8,require_uppercase:e?.data?.require_uppercase||!0,require_lowercase:e?.data?.require_lowercase||!0,require_numbers:e?.data?.require_numbers||!0,require_special_chars:e?.data?.require_special_chars||!1},session_timeout:e?.data?.session_timeout||3600,max_login_attempts:e?.data?.max_login_attempts||5,lockout_duration:e?.data?.lockout_duration||900,passwordMinLength:e?.data?.min_length||8,passwordRequireSpecial:e?.data?.require_special_chars||!1,passwordRequireUppercase:e?.data?.require_uppercase||!0,passwordRequireNumbers:e?.data?.require_numbers||!0,accountLockAttempts:e?.data?.max_login_attempts||5,sessionTimeout:e?.data?.session_timeout||3600,requireEmailVerification:e?.data?.require_email_verification||!0,enableTwoFactor:e?.data?.enable_two_factor||!1,adminIpRestriction:e?.data?.admin_ip_restriction||!1}}}catch(e){return console.error("Error getting security configs:",e),{status:"error",message:"Error al obtener configuraciones de seguridad"}}}async updateSecurityConfigs(e){try{return await $.post(D.ADMIN.CONFIGURATIONS.PASSWORD_VALIDATION_RULES,e.password_rules),re.getInstance().invalidateCache(),{status:"success",data:e,message:"Configuración de seguridad actualizada"}}catch(t){return console.error("Error updating security configs:",t),{status:"error",message:"Error al actualizar configuraciones de seguridad"}}}async getRatingConfigs(){try{const e=await $.get(D.ADMIN.CONFIGURATIONS.RATINGS);return{status:"success",data:{min_rating:e?.data?.min_rating||1,max_rating:e?.data?.max_rating||5,allow_anonymous:e?.data?.allow_anonymous||!1,require_purchase:e?.data?.require_purchase||!0,enable_reviews:e?.data?.enable_reviews||!0,auto_publish_reviews:e?.data?.auto_publish_reviews||!1,auto_approve_all:e?.data?.auto_approve_all||!1,auto_approve_threshold:e?.data?.auto_approve_threshold||4,"ratings.auto_approve_all":e?.data?.auto_approve_all||!1,"ratings.auto_approve_threshold":e?.data?.auto_approve_threshold||4}}}catch(e){return console.error("Error getting rating configs:",e),{status:"error",message:"Error al obtener configuraciones de calificaciones"}}}async updateRatingConfigs(e){try{return await $.post(D.ADMIN.CONFIGURATIONS.RATINGS,e),re.getInstance().invalidateCache(),{status:"success",data:e,message:"Configuración de calificaciones actualizada"}}catch(t){return console.error("Error updating rating configs:",t),{status:"error",message:"Error al actualizar configuraciones de calificaciones"}}}async getVolumeDiscountConfigs(){try{const e=await $.get(D.ADMIN.VOLUME_DISCOUNTS.CONFIGURATION);return{status:"success",data:{enabled:e?.data?.enabled||!0,stackable:e?.data?.stackable||!1,default_tiers:e?.data?.default_tiers||[{quantity:3,discount:5,label:"3+"},{quantity:5,discount:8,label:"5+"},{quantity:10,discount:15,label:"10+"}]}}}catch(e){return console.error("Error getting volume discount configs:",e),{status:"error",message:"Error al obtener configuraciones de descuentos por volumen"}}}async updateVolumeDiscountConfigs(e){try{return await $.post(D.ADMIN.VOLUME_DISCOUNTS.CONFIGURATION,e),re.getInstance().invalidateCache(),{status:"success",data:e,message:"Configuración de descuentos por volumen actualizada"}}catch(t){return console.error("Error updating volume discount configs:",t),{status:"error",message:"Error al actualizar configuraciones de descuentos por volumen"}}}async getRatingStats(){try{return{status:"success",data:(await $.get(`${D.ADMIN.CONFIGURATIONS.RATINGS}/stats`))?.data||{}}}catch(e){return console.error("Error getting rating stats:",e),{status:"error",message:"Error al obtener estadísticas de calificaciones"}}}async approveAllPendingRatings(){try{return{status:"success",data:(await $.post(`${D.ADMIN.CONFIGURATIONS.RATINGS}/approve-all`))?.data||{},message:"Todas las calificaciones pendientes han sido aprobadas"}}catch(e){return console.error("Error approving pending ratings:",e),{status:"error",message:"Error al aprobar calificaciones pendientes"}}}}const ro=()=>{const[s,e]=g.useState(!0),[t,a]=g.useState(!1),[n,o]=g.useState(null),[i,d]=g.useState(null),[c,h]=g.useState({password_rules:{min_length:8,require_uppercase:!0,require_lowercase:!0,require_numbers:!0,require_special_chars:!0},session_timeout:3600,max_login_attempts:5,lockout_duration:900,passwordMinLength:8,passwordRequireSpecial:!0,passwordRequireUppercase:!0,passwordRequireNumbers:!0,accountLockAttempts:5,sessionTimeout:120,enableTwoFactor:!1,requireEmailVerification:!0,adminIpRestriction:!1}),m=new Ue;g.useEffect(()=>{v()},[]);const v=async()=>{e(!0),o(null);try{const f=await m.getSecurityConfigs();f?.status==="success"&&f.data?h(f.data):o(f?.message||"No se pudieron cargar las configuraciones")}catch(f){console.error("Error al cargar configuraciones de seguridad:",f),o("No se pudieron cargar las configuraciones. Por favor, inténtalo de nuevo.")}finally{e(!1)}},y=(f,j)=>{h(w=>({...w,[f]:j}))},_=async()=>{a(!0),o(null),d(null);try{const f=await m.updateSecurityConfigs(c);f?.status==="success"?(d("Configuración de seguridad guardada correctamente"),setTimeout(()=>d(null),3e3)):o(f?.message||"Error al guardar la configuración")}catch(f){console.error("Error al guardar configuraciones de seguridad:",f),o("No se pudo guardar la configuración. Por favor, inténtalo de nuevo.")}finally{a(!1)}},C=(()=>{let f=0;return Number(c.passwordMinLength)>=8&&f++,c.passwordRequireSpecial&&f++,c.passwordRequireUppercase&&f++,c.passwordRequireNumbers&&f++,f>=4?{level:"Fuerte",color:"text-green-600",bg:"bg-green-100"}:f>=3?{level:"Moderada",color:"text-yellow-600",bg:"bg-yellow-100"}:{level:"Débil",color:"text-red-600",bg:"bg-red-100"}})();return s?r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})}):r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[r.jsx(_r,{className:"w-6 h-6 mr-2"}),"Configuración de Seguridad"]}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Configure las políticas de seguridad, autenticación y protección del sistema"})]}),r.jsxs("button",{onClick:v,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 flex items-center",disabled:s,children:[r.jsx(G,{size:18,className:`mr-2 ${s?"animate-spin":""}`}),"Actualizar"]})]}),n&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(J,{className:"h-5 w-5 text-red-500 mr-2"}),r.jsx("p",{className:"text-red-700",children:n})]})}),i&&r.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center mr-2",children:r.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),r.jsx("p",{className:"text-green-700",children:i})]})}),r.jsx("div",{className:"bg-primary-50 border border-primary-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-start",children:[r.jsx(Oe,{className:"w-5 h-5 text-primary-500 mr-3 mt-1 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-medium text-primary-900",children:"Configuración de Seguridad"}),r.jsx("p",{className:"mt-1 text-primary-800",children:"Estas configuraciones afectan la seguridad de toda la plataforma. Cambios muy restrictivos pueden impactar la experiencia del usuario, mientras que configuraciones muy permisivas pueden comprometer la seguridad."})]})]})}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[r.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[r.jsx(it,{className:"w-5 h-5 mr-2"}),"Políticas de Contraseña"]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Longitud mínima de contraseña"}),r.jsx("input",{type:"text",value:c.passwordMinLength,onChange:f=>{const j=f.target.value;(j===""||/^\d+$/.test(j))&&y("passwordMinLength",j===""?"":parseInt(j))},onBlur:f=>{const j=f.target.value;if(j==="")y("passwordMinLength",6);else{const w=parseInt(j);w<6?y("passwordMinLength",6):w>50&&y("passwordMinLength",50)}},className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"6-50"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Número mínimo de caracteres requeridos (recomendado: 8+)"})]}),r.jsxs("div",{className:"space-y-3",children:[r.jsxs("label",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",checked:c.passwordRequireSpecial,onChange:f=>y("passwordRequireSpecial",f.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),r.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Requerir caracteres especiales (!@#$%^&*)"})]}),r.jsxs("label",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",checked:c.passwordRequireUppercase,onChange:f=>y("passwordRequireUppercase",f.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),r.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Requerir letras mayúsculas (A-Z)"})]}),r.jsxs("label",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",checked:c.passwordRequireNumbers,onChange:f=>y("passwordRequireNumbers",f.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),r.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Requerir números (0-9)"})]})]}),r.jsx("div",{className:`p-3 rounded-lg ${C.bg}`,children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(Ce,{className:`w-4 h-4 mr-2 ${C.color}`}),r.jsxs("span",{className:`text-sm font-medium ${C.color}`,children:["Seguridad de contraseña: ",C.level]})]})})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[r.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[r.jsx(Ie,{className:"w-5 h-5 mr-2"}),"Autenticación y Sesiones"]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Intentos fallidos antes de bloqueo"}),r.jsx("input",{type:"text",value:c.accountLockAttempts,onChange:f=>{const j=f.target.value;(j===""||/^\d+$/.test(j))&&y("accountLockAttempts",j===""?"":parseInt(j))},onBlur:f=>{const j=f.target.value;if(j==="")y("accountLockAttempts",3);else{const w=parseInt(j);w<3?y("accountLockAttempts",3):w>10&&y("accountLockAttempts",10)}},className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"3-10"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Número de intentos de login fallidos antes de bloquear temporalmente la cuenta"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tiempo de sesión (minutos)"}),r.jsx("input",{type:"text",value:c.sessionTimeout,onChange:f=>{const j=f.target.value;(j===""||/^\d+$/.test(j))&&y("sessionTimeout",j===""?"":parseInt(j))},onBlur:f=>{const j=f.target.value;if(j==="")y("sessionTimeout",30);else{const w=parseInt(j);w<30?y("sessionTimeout",30):w>480&&y("sessionTimeout",480)}},className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"30-480"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Tiempo de inactividad antes de cerrar sesión automáticamente"})]}),r.jsx("div",{className:"space-y-3",children:r.jsxs("label",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",checked:c.requireEmailVerification,onChange:f=>y("requireEmailVerification",f.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),r.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Requerir verificación de email"})]})})]})]})]}),r.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[r.jsx("h4",{className:"font-medium text-yellow-900 mb-2",children:"Recomendaciones de Seguridad"}),r.jsxs("ul",{className:"text-sm text-yellow-800 space-y-1",children:[r.jsx("li",{children:"• Use contraseñas de al menos 8 caracteres con caracteres especiales, mayúsculas y números"}),r.jsx("li",{children:"• Limite los intentos de login a 5 o menos para prevenir ataques de fuerza bruta"}),r.jsx("li",{children:"• Configure sesiones de máximo 240 minutos (4 horas) para cuentas administrativas"}),r.jsx("li",{children:"• Habilite la verificación de email para prevenir registros con emails falsos"}),r.jsx("li",{children:"• Use restricciones de IP solo si su organización tiene IPs fijas"})]})]}),r.jsx("div",{className:"flex justify-end",children:r.jsxs("button",{onClick:_,disabled:t,className:"flex items-center px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:[r.jsx(ye,{size:16,className:"mr-2"}),t?"Guardando...":"Guardar Configuración"]})})]})},so=()=>{const[s,e]=g.useState(!0),[t,a]=g.useState(!1),[n,o]=g.useState(null),[i,d]=g.useState(null),[c,h]=g.useState({auto_approval:!0,review_threshold:3,enable_user_reports:!0,auto_suspend_threshold:5,manual_review_required:!1,userStrikesThreshold:3,contactScorePenalty:3,businessScoreBonus:15,contactPenaltyHeavy:20,minimumContactScore:8,scoreDifferenceThreshold:5,consecutiveNumbersLimit:7,numbersWithContextLimit:3,lowStockThreshold:5}),m=new Ue;g.useEffect(()=>{v()},[]);const v=async()=>{e(!0),o(null);try{const l=await m.getModerationConfigs();l?.status==="success"&&l.data?h(l.data):o(l?.message||"No se pudieron cargar las configuraciones")}catch(l){console.error("Error al cargar configuraciones de moderación:",l),o("No se pudieron cargar las configuraciones. Por favor, inténtalo de nuevo.")}finally{e(!1)}},y=(l,C)=>{h(f=>({...f,[l]:C}))},_=async()=>{a(!0),o(null),d(null);try{const l=await m.updateModerationConfigs(c);l?.status==="success"?(d("Configuración de moderación guardada correctamente"),setTimeout(()=>d(null),3e3)):o(l?.message||"Error al guardar la configuración")}catch(l){console.error("Error al guardar configuraciones de moderación:",l),o("No se pudo guardar la configuración. Por favor, inténtalo de nuevo.")}finally{a(!1)}};return s?r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})}):r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[r.jsx(Ce,{className:"w-6 h-6 mr-2"}),"Configuración de Moderación"]}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Configure los parámetros para la moderación automática de mensajes y contenido"})]}),r.jsxs("button",{onClick:v,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 flex items-center",disabled:s,children:[r.jsx(G,{size:18,className:`mr-2 ${s?"animate-spin":""}`}),"Actualizar"]})]}),n&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(J,{className:"h-5 w-5 text-red-500 mr-2"}),r.jsx("p",{className:"text-red-700",children:n})]})}),i&&r.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center mr-2",children:r.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),r.jsx("p",{className:"text-green-700",children:i})]})}),r.jsx("div",{className:"bg-primary-50 border border-primary-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-start",children:[r.jsx(Oe,{className:"w-5 h-5 text-primary-500 mr-3 mt-1 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-medium text-primary-900",children:"Acerca de la Moderación Automática"}),r.jsx("p",{className:"mt-1 text-primary-800",children:"El sistema analiza automáticamente los mensajes entre usuarios para detectar patrones sospechosos como intercambio de información de contacto fuera de la plataforma. Los valores aquí configurados determinan la sensibilidad de la detección."})]})]})}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[r.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[r.jsx(rs,{className:"w-5 h-5 mr-2"}),"Sistema de Strikes de Usuario"]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Strikes antes de bloqueo"}),r.jsx("input",{type:"number",onWheel:l=>l.currentTarget.blur(),value:c.userStrikesThreshold,onChange:l=>y("userStrikesThreshold",parseInt(l.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500",min:"1",max:"10"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Número de strikes que puede acumular un usuario antes de ser bloqueado automáticamente"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Umbral de stock bajo"}),r.jsx("input",{type:"number",onWheel:l=>l.currentTarget.blur(),value:c.lowStockThreshold,onChange:l=>y("lowStockThreshold",parseInt(l.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500",min:"1",max:"50"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Cantidad mínima de productos en stock antes de mostrar aviso de stock bajo"})]})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[r.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[r.jsx(lt,{className:"w-5 h-5 mr-2"}),"Detección de Información de Contacto"]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Penalización por patrones sospechosos"}),r.jsx("input",{type:"number",onWheel:l=>l.currentTarget.blur(),value:c.contactScorePenalty,onChange:l=>y("contactScorePenalty",parseInt(l.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500",min:"1",max:"20"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Puntos añadidos al score de contacto por patrones sospechosos"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bonus por indicadores de negocio"}),r.jsx("input",{type:"number",onWheel:l=>l.currentTarget.blur(),value:c.businessScoreBonus,onChange:l=>y("businessScoreBonus",parseInt(l.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500",min:"5",max:"50"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Puntos añadidos al score de negocio cuando se detectan términos comerciales legítimos"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Penalización fuerte por contacto"}),r.jsx("input",{type:"number",onWheel:l=>l.currentTarget.blur(),value:c.contactPenaltyHeavy,onChange:l=>y("contactPenaltyHeavy",parseInt(l.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500",min:"10",max:"50"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Penalización severa aplicada cuando se detectan indicadores claros de contacto"})]})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Umbrales de Score"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Score mínimo de contacto"}),r.jsx("input",{type:"number",onWheel:l=>l.currentTarget.blur(),value:c.minimumContactScore,onChange:l=>y("minimumContactScore",parseInt(l.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500",min:"5",max:"20"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Score mínimo para considerar que un mensaje contiene información de contacto"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Diferencia de score requerida"}),r.jsx("input",{type:"number",onWheel:l=>l.currentTarget.blur(),value:c.scoreDifferenceThreshold,onChange:l=>y("scoreDifferenceThreshold",parseInt(l.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500",min:"3",max:"15"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Diferencia mínima entre score de contacto y negocio para activar moderación"})]})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[r.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Detección de Números"}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Límite de números consecutivos"}),r.jsx("input",{type:"number",onWheel:l=>l.currentTarget.blur(),value:c.consecutiveNumbersLimit,onChange:l=>y("consecutiveNumbersLimit",parseInt(l.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500",min:"5",max:"15"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Número de dígitos consecutivos que activan la detección de teléfonos"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Números con contexto de contacto"}),r.jsx("input",{type:"number",onWheel:l=>l.currentTarget.blur(),value:c.numbersWithContextLimit,onChange:l=>y("numbersWithContextLimit",parseInt(l.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500",min:"2",max:"8"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Número de dígitos que, junto con palabras de contacto, activan la detección"})]})]})]})]}),r.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[r.jsx("h4",{className:"font-medium text-yellow-900 mb-2",children:"Recomendaciones"}),r.jsxs("ul",{className:"text-sm text-yellow-800 space-y-1",children:[r.jsx("li",{children:"• Un número bajo de strikes (1-2) puede ser muy restrictivo para usuarios legítimos"}),r.jsx("li",{children:"• Scores altos de penalización pueden generar falsos positivos"}),r.jsx("li",{children:"• El bonus de negocio debe ser significativamente mayor que las penalizaciones"}),r.jsx("li",{children:"• Ajusta los límites de números según el tipo de productos vendidos"})]})]}),r.jsx("div",{className:"flex justify-end",children:r.jsxs("button",{onClick:_,disabled:t,className:"flex items-center px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:[r.jsx(ye,{size:16,className:"mr-2"}),t?"Guardando...":"Guardar Configuración"]})})]})},to=()=>{const[s,e]=g.useState(!0),[t,a]=g.useState(!1),[n,o]=g.useState(null),[i,d]=g.useState(null),[c,h]=g.useState(!1),[m,v]=g.useState(2),[y,_]=g.useState({totalCount:0,approvedCount:0,pendingCount:0,rejectedCount:0}),l=new Ue;g.useEffect(()=>{C(),f()},[]);const C=async()=>{e(!0),o(null);try{const E=await l.getRatingConfigs();if(E?.status==="success"&&E.data){const R=E.data;h(!!(R["ratings.auto_approve_all"]||R.auto_approve_all)||!1),v(Number(R["ratings.auto_approve_threshold"]||R.auto_approve_threshold)||2)}else o(E?.message||"No se pudieron cargar las configuraciones"),console.warn("Respuesta de configuraciones inválida:",E)}catch(E){console.error("Error al cargar configuraciones:",E),o("No se pudieron cargar las configuraciones. Por favor, inténtalo de nuevo.")}finally{e(!1)}},f=async()=>{try{const E=await l.getRatingStats();E?.status==="success"&&E.data?_(E.data):console.warn("Error al cargar estadísticas:",E?.message)}catch(E){console.error("Error al cargar estadísticas de valoraciones:",E)}},j=async()=>{a(!0),o(null),d(null);try{const E=await l.updateRatingConfigs({min_rating:1,max_rating:5,allow_anonymous:!1,require_purchase:!0,enable_reviews:!0,auto_publish_reviews:!0,auto_approve_all:c,auto_approve_threshold:m,"ratings.auto_approve_all":c,"ratings.auto_approve_threshold":m});E?.status==="success"?(d("Configuraciones guardadas correctamente"),f()):o(E?.message||"Error al guardar las configuraciones")}catch(E){console.error("Error al guardar configuraciones:",E),o("No se pudieron guardar las configuraciones. Por favor, inténtalo de nuevo.")}finally{a(!1)}},w=async()=>{if(confirm("¿Estás seguro de que deseas aprobar todas las valoraciones pendientes? Esta acción no se puede deshacer.")){e(!0),o(null),d(null);try{const E=await l.approveAllPendingRatings();E?.status==="success"?(d(`Se han aprobado ${E.data?.count||0} valoraciones pendientes`),f()):o(E?.message||"Error al aprobar valoraciones pendientes")}catch(E){console.error("Error al aprobar valoraciones pendientes:",E),o("No se pudieron aprobar las valoraciones pendientes. Por favor, inténtalo de nuevo.")}finally{e(!1)}}};return r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Configuración de Valoraciones"}),r.jsxs("button",{onClick:C,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 flex items-center",disabled:s,children:[r.jsx(G,{size:18,className:`mr-2 ${s?"animate-spin":""}`}),"Actualizar"]})]}),r.jsxs("div",{className:"bg-primary-50 text-primary-800 p-4 rounded-lg flex items-start",children:[r.jsx(Oe,{className:"w-5 h-5 mr-3 mt-1 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-medium",children:"Acerca de las valoraciones"}),r.jsx("p",{className:"mt-1",children:"Configura cómo se gestionan las valoraciones de usuarios en la plataforma. Puedes establecer aprobaciones automáticas basadas en umbrales de calificación o realizar moderación manual."})]})]}),n&&r.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:r.jsx("span",{className:"block sm:inline",children:n})}),i&&r.jsx("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative",children:r.jsx("span",{className:"block sm:inline",children:i})}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Total de valoraciones"}),r.jsx("p",{className:"text-2xl font-bold text-gray-900",children:y.totalCount})]}),r.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Aprobadas"}),r.jsx("p",{className:"text-2xl font-bold text-green-600",children:y.approvedCount})]}),r.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Pendientes"}),r.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:y.pendingCount})]}),r.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm",children:[r.jsx("h3",{className:"text-sm font-medium text-gray-500",children:"Rechazadas"}),r.jsx("p",{className:"text-2xl font-bold text-red-600",children:y.rejectedCount})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[r.jsxs("div",{className:"p-6",children:[r.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Configuración de Aprobación Automática"}),r.jsxs("div",{className:"mb-6",children:[r.jsxs("label",{className:"flex items-center space-x-3 mb-3",children:[r.jsx("input",{type:"checkbox",checked:c,onChange:E=>h(E.target.checked),className:"form-checkbox h-5 w-5 text-primary-600 rounded focus:ring-primary-500",disabled:t}),r.jsx("span",{className:"text-gray-900 font-medium",children:"Aprobar automáticamente todas las valoraciones"})]}),r.jsx("p",{className:"text-sm text-gray-500 ml-8",children:"Cuando está activado, todas las valoraciones se aprobarán automáticamente sin moderación. No recomendado para sitios con alto tráfico o riesgo de spam."})]}),r.jsxs("div",{className:c?"opacity-50":"",children:[r.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Umbral de aprobación automática"}),r.jsxs("div",{className:"flex items-center mb-3",children:[r.jsx("div",{className:"flex-1",children:r.jsx("input",{type:"range",min:"1",max:"5",step:"1",value:m,onChange:E=>v(Number(E.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer",disabled:c||t})}),r.jsx("div",{className:"w-16 ml-4 flex space-x-0.5",children:[1,2,3,4,5].map(E=>r.jsx(me,{size:16,className:`${E<=m?"text-yellow-400 fill-current":"text-gray-400"}`},E))})]}),r.jsxs("div",{className:"flex justify-between text-xs text-gray-500 px-1",children:[r.jsxs("span",{children:["Se requiere moderación: 1-",m]}),r.jsxs("span",{children:["Aprobación automática: >",m]})]}),r.jsxs("p",{className:"text-sm text-gray-500 mt-3",children:["Las valoraciones con ",m," estrellas o menos requerirán aprobación manual. Las valoraciones con más de"," ",m," estrellas se aprobarán automáticamente."]}),m<2&&r.jsxs("div",{className:"mt-3 flex items-start bg-yellow-50 p-3 rounded-md",children:[r.jsx(J,{className:"w-5 h-5 text-yellow-600 mr-2 mt-0.5 flex-shrink-0"}),r.jsx("p",{className:"text-sm text-yellow-700",children:"Un umbral muy bajo puede permitir valoraciones negativas automáticamente. Considera usar un valor de 2 o superior para una mejor moderación."})]})]})]}),r.jsxs("div",{className:"px-6 py-3 bg-gray-50 border-t border-gray-200 rounded-b-lg flex flex-col sm:flex-row gap-3 justify-end",children:[y.pendingCount>0&&r.jsxs("button",{type:"button",onClick:w,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center",disabled:s||t,children:["Aprobar las ",y.pendingCount," valoraciones pendientes"]}),r.jsxs("button",{type:"button",onClick:j,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 flex items-center",disabled:s||t,children:[r.jsx(ye,{size:18,className:"mr-2"}),t?"Guardando...":"Guardar configuración"]})]})]})]})},ao=()=>{const[s,e]=g.useState(!1),[t,a]=g.useState(null),[n,o]=g.useState(null),[i,d]=g.useState({enabled:!0,stackable:!1,show_savings_message:!0,default_tiers:[{quantity:3,discount:5,label:"Descuento 3+"},{quantity:6,discount:10,label:"Descuento 6+"},{quantity:12,discount:15,label:"Descuento 12+"}]}),c=new Ue;g.useEffect(()=>{h()},[]);const h=async()=>{try{e(!0),o(null);const l=await c.getVolumeDiscountConfigs();l.status==="success"&&l.data?d(l.data):console.warn("No se pudo cargar configuración, usando valores por defecto")}catch(l){console.error("Error cargando configuración:",l),o("No se pudo cargar la configuración")}finally{e(!1)}},m=(l,C,f)=>{const j=[...i.default_tiers];j[l]={...j[l],[C]:f},d(w=>({...w,default_tiers:j}))},v=()=>{d(l=>({...l,default_tiers:[...l.default_tiers,{quantity:1,discount:0,label:"Nuevo descuento"}]}))},y=l=>{d(C=>({...C,default_tiers:C.default_tiers.filter((f,j)=>j!==l)}))},_=async()=>{try{e(!0),o(null),a(null);const l=await c.updateVolumeDiscountConfigs(i);if(l.status==="success")a("Configuración guardada exitosamente"),setTimeout(()=>a(null),3e3);else throw new Error(l.message||"No se pudo guardar la configuración")}catch(l){console.error("Error guardando configuración:",l),o("Error al guardar la configuración")}finally{e(!1)}};return s&&i.default_tiers.length===3&&i.default_tiers[0].quantity===3?r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})}):r.jsxs("div",{className:"space-y-6",children:[n&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(J,{className:"h-5 w-5 text-red-500 mr-2"}),r.jsx("p",{className:"text-red-700",children:n})]})}),t&&r.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center mr-2",children:r.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),r.jsx("p",{className:"text-green-700",children:t})]})}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[r.jsxs("div",{className:"flex justify-between items-center mb-6",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"text-xl font-semibold flex items-center",children:[r.jsx(as,{className:"w-5 h-5 mr-2"}),"Configuración de Descuentos por Volumen"]}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Configure los descuentos automáticos por cantidad de productos"})]}),r.jsxs("button",{onClick:h,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 flex items-center",disabled:s,children:[r.jsx(G,{size:18,className:`mr-2 ${s?"animate-spin":""}`}),"Actualizar"]})]}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-center mb-4",children:[r.jsx("h3",{className:"text-lg font-medium",children:"Niveles de Descuento por Defecto"}),r.jsxs("button",{onClick:v,className:"flex items-center px-3 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 text-sm",children:[r.jsx(Tr,{size:16,className:"mr-1"}),"Agregar Nivel"]})]}),r.jsx("div",{className:"space-y-3",children:i.default_tiers.map((l,C)=>r.jsxs("div",{className:"border rounded-lg p-4 bg-gray-50",children:[r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cantidad Mínima"}),r.jsx("input",{type:"number",value:l.quantity,onChange:f=>m(C,"quantity",parseInt(f.target.value)),onWheel:f=>f.currentTarget.blur(),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500",min:"1"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descuento (%)"}),r.jsx("input",{type:"number",value:l.discount,onChange:f=>m(C,"discount",parseFloat(f.target.value)),onWheel:f=>f.currentTarget.blur(),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500",min:"0",max:"100",step:"0.1"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Etiqueta"}),r.jsx("input",{type:"text",value:l.label,onChange:f=>m(C,"label",f.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Ej: Descuento 3+"})]}),r.jsx("div",{className:"flex items-end",children:r.jsx("button",{onClick:()=>y(C),className:"w-full text-red-600 hover:text-red-800 flex items-center justify-center p-2 border border-red-300 rounded-md hover:bg-red-50",children:r.jsx(je,{size:16})})})]}),r.jsx("div",{className:"mt-3 p-3 bg-white rounded border",children:r.jsxs("div",{className:"text-sm text-gray-600",children:[r.jsx("span",{className:"font-medium",children:"Vista previa:"})," ","Al comprar ",l.quantity,"+ unidades, el cliente obtiene ",l.discount,"% de descuento",l.label&&r.jsx("span",{className:"ml-2 px-2 py-1 bg-green-100 text-green-800 rounded text-xs",children:l.label})]})})]},C))}),i.default_tiers.length===0&&r.jsxs("div",{className:"text-center py-8 text-gray-500 border border-dashed border-gray-300 rounded-lg",children:["No hay niveles de descuento configurados.",r.jsx("br",{}),r.jsx("button",{onClick:v,className:"mt-2 text-primary-600 hover:text-primary-700 underline",children:"Agregar el primer nivel de descuento"})]})]}),r.jsxs("div",{className:"bg-primary-50 border border-primary-200 rounded-lg p-4",children:[r.jsx("h4",{className:"font-medium text-primary-900 mb-2",children:"Información Importante"}),r.jsxs("ul",{className:"text-sm text-primary-800 space-y-1",children:[r.jsx("li",{children:"• Los descuentos se aplican automáticamente cuando el cliente alcanza la cantidad mínima"}),r.jsx("li",{children:"• Solo se aplica el descuento del nivel más alto alcanzado"}),r.jsx("li",{children:"• Los descuentos se calculan sobre el precio base del producto"}),r.jsx("li",{children:"• Las configuraciones se aplican a todos los productos de la tienda"})]})]}),r.jsx("div",{className:"flex justify-end",children:r.jsxs("button",{onClick:_,disabled:s,className:"flex items-center px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:[r.jsx(ye,{size:16,className:"mr-2"}),s?"Guardando...":"Guardar Configuración"]})})]})]})]})},no=()=>{const[s,e]=g.useState(!0),[t,a]=g.useState(!1),[n,o]=g.useState(null),[i,d]=g.useState(null),[c,h]=g.useState({enabled:!0,freeThreshold:50,defaultCost:5}),m=re.getInstance();g.useEffect(()=>{v()},[]);const v=async()=>{e(!0),o(null);try{const l=await m.getUnifiedConfig(),C={enabled:l.config.shipping.enabled,freeThreshold:l.config.shipping.free_threshold,defaultCost:l.config.shipping.default_cost};h(C)}catch(l){console.error("Error al cargar configuraciones de envío:",l),o("No se pudieron cargar las configuraciones. Por favor, inténtalo de nuevo.")}finally{e(!1)}},y=(l,C)=>{h(f=>l==="enabled"&&C===!1?{enabled:!1,freeThreshold:0,defaultCost:0}:l==="enabled"&&C===!0?{enabled:!0,freeThreshold:50,defaultCost:5}:{...f,[l]:C})},_=async()=>{a(!0),o(null),d(null);try{const l=await $.post(D.ADMIN.CONFIGURATIONS.SHIPPING,c);l?.status==="success"?(d("Configuración de envío guardada correctamente"),m.invalidateCache(),localStorage.setItem("shipping_config_updated",Date.now().toString()),setTimeout(()=>d(null),3e3)):o(l?.message||"Error al guardar la configuración")}catch(l){console.error("Error al guardar configuraciones de envío:",l),o("No se pudo guardar la configuración. Por favor, inténtalo de nuevo.")}finally{a(!1)}};return s?r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})}):r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[r.jsx(Pr,{className:"w-6 h-6 mr-2"}),"Configuración de Envíos"]}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Configure los parámetros para el cálculo de costos de envío"})]}),r.jsxs("button",{onClick:v,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 flex items-center",disabled:s,children:[r.jsx(G,{size:18,className:`mr-2 ${s?"animate-spin":""}`}),"Actualizar"]})]}),n&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(J,{className:"h-5 w-5 text-red-500 mr-2"}),r.jsx("p",{className:"text-red-700",children:n})]})}),i&&r.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center mr-2",children:r.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),r.jsx("p",{className:"text-green-700",children:i})]})}),r.jsx("div",{className:"bg-primary-50 border border-primary-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-start",children:[r.jsx(Oe,{className:"w-5 h-5 text-primary-500 mr-3 mt-1 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-medium text-primary-900",children:"Acerca de la Configuración de Envíos"}),r.jsx("p",{className:"mt-1 text-primary-800",children:"Estas configuraciones controlan cómo se calculan los costos de envío en la plataforma. El umbral de envío gratis determina el monto mínimo de compra para obtener envío gratuito, mientras que el costo por defecto se aplica a todas las compras por debajo de ese umbral."})]})]})}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[r.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[r.jsx(Ar,{className:"w-5 h-5 mr-2"}),"Configuración General"]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",id:"shippingEnabled",checked:c.enabled,onChange:l=>y("enabled",l.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),r.jsx("label",{htmlFor:"shippingEnabled",className:"ml-2 block text-sm text-gray-900",children:"Habilitar cálculo de costos de envío"})]}),r.jsx("p",{className:"text-xs text-gray-500",children:"Cuando está deshabilitado, el envío será GRATIS para todas las compras (promoción temporal)"})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[r.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[r.jsx(Je,{className:"w-5 h-5 mr-2"}),"Costos de Envío"]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Umbral para envío gratis (USD)"}),r.jsx("input",{type:"text",value:c.freeThreshold===0||c.freeThreshold===null||c.freeThreshold===void 0?"":c.freeThreshold,onChange:l=>{const C=l.target.value;(C===""||/^\d*\.?\d*$/.test(C))&&y("freeThreshold",C===""?0:parseFloat(C)||0)},disabled:!c.enabled,className:`w-full border rounded-md px-3 py-2 ${c.enabled?"border-gray-300 focus:ring-primary-500 focus:border-primary-500":"border-gray-200 bg-gray-100 cursor-not-allowed"}`,placeholder:"50.00"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Monto mínimo de compra para obtener envío gratuito"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Costo de envío por defecto (USD)"}),r.jsx("input",{type:"text",value:c.defaultCost===0||c.defaultCost===null||c.defaultCost===void 0?"":c.defaultCost,onChange:l=>{const C=l.target.value;(C===""||/^\d*\.?\d*$/.test(C))&&y("defaultCost",C===""?0:parseFloat(C)||0)},disabled:!c.enabled,className:`w-full border rounded-md px-3 py-2 ${c.enabled?"border-gray-300 focus:ring-primary-500 focus:border-primary-500":"border-gray-200 bg-gray-100 cursor-not-allowed"}`,placeholder:"5.00"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Costo aplicado cuando no se alcanza el umbral de envío gratis"})]})]})]})]}),r.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[r.jsx("h4",{className:"font-medium text-yellow-900 mb-2",children:"Información Importante"}),r.jsxs("ul",{className:"text-sm text-yellow-800 space-y-1",children:[r.jsx("li",{children:"• Los precios están configurados en dólares estadounidenses (USD)"}),r.jsx("li",{children:"• El cálculo de envío gratis se basa en el subtotal de la compra (sin impuestos)"}),r.jsx("li",{children:"• Si el envío está deshabilitado, no se mostrará información de costos de envío"}),r.jsx("li",{children:"• Los cambios se aplicarán inmediatamente a todas las nuevas compras"})]})]}),r.jsx("div",{className:"flex justify-end",children:r.jsxs("button",{onClick:_,disabled:t,className:"flex items-center px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:[r.jsx(ye,{size:16,className:"mr-2"}),t?"Guardando...":"Guardar Configuración"]})})]})},oo=()=>{const[s,e]=g.useState(!0),[t,a]=g.useState(!1),[n,o]=g.useState(null),[i,d]=g.useState(null),[c,h]=g.useState({mode:!1,allowAdminOnlyAccess:!1,bypassEmailVerification:!0,requireEmailVerification:!1,emailVerificationTimeout:24}),m=new Ue;g.useEffect(()=>{v()},[]);const v=async()=>{e(!0),o(null);try{const l=await m.getDevelopmentConfigs();l?.status==="success"&&l.data?h(l.data):o(l?.message||"No se pudieron cargar las configuraciones")}catch(l){console.error("Error al cargar configuraciones de desarrollo:",l),o("No se pudieron cargar las configuraciones. Por favor, inténtalo de nuevo.")}finally{e(!1)}},y=(l,C)=>{h(f=>({...f,[l]:C}))},_=async()=>{a(!0),o(null),d(null);try{const l=await m.updateDevelopmentConfigs(c);l?.status==="success"?(d("Configuración de desarrollo guardada correctamente"),setTimeout(()=>d(null),3e3)):o(l?.message||"Error al guardar la configuración")}catch(l){console.error("Error al guardar configuraciones de desarrollo:",l),o("No se pudo guardar la configuración. Por favor, inténtalo de nuevo.")}finally{a(!1)}};return s?r.jsx("div",{className:"flex justify-center items-center h-64",children:r.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})}):r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{className:"flex justify-between items-center",children:[r.jsxs("div",{children:[r.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center",children:[r.jsx(ns,{className:"w-6 h-6 mr-2"}),"Configuración de Desarrollo"]}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Configure parámetros para desarrollo, mantenimiento y verificación de email"})]}),r.jsxs("button",{onClick:v,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 flex items-center",disabled:s,children:[r.jsx(G,{size:18,className:`mr-2 ${s?"animate-spin":""}`}),"Actualizar"]})]}),n&&r.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(J,{className:"h-5 w-5 text-red-500 mr-2"}),r.jsx("p",{className:"text-red-700",children:n})]})}),i&&r.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx("div",{className:"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center mr-2",children:r.jsx("div",{className:"w-2 h-2 bg-white rounded-full"})}),r.jsx("p",{className:"text-green-700",children:i})]})}),r.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-start",children:[r.jsx(J,{className:"w-5 h-5 text-amber-500 mr-3 mt-1 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-medium text-amber-900",children:"¡Configuraciones Críticas!"}),r.jsx("p",{className:"mt-1 text-amber-800",children:"Estas configuraciones afectan la seguridad y funcionalidad del sistema. Solo modifícalas durante actualizaciones, mantenimiento o desarrollo."})]})]})}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[r.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[r.jsx(as,{className:"w-5 h-5 mr-2"}),"Modo Desarrollo"]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",id:"developmentMode",checked:c.mode,onChange:l=>y("mode",l.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),r.jsx("label",{htmlFor:"developmentMode",className:"ml-2 block text-sm text-gray-900",children:"Activar modo desarrollo"})]}),r.jsx("p",{className:"text-xs text-gray-500",children:"Habilita funciones especiales para desarrolladores y actualizaciones del sistema"}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",id:"adminOnlyAccess",checked:c.allowAdminOnlyAccess,onChange:l=>y("allowAdminOnlyAccess",l.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),r.jsx("label",{htmlFor:"adminOnlyAccess",className:"ml-2 block text-sm text-gray-900",children:"Restringir acceso solo a administradores"})]}),r.jsx("p",{className:"text-xs text-gray-500",children:"Cuando está activo, solo los administradores pueden acceder al sistema"})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[r.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[r.jsx(ss,{className:"w-5 h-5 mr-2"}),"Verificación de Email"]}),r.jsxs("div",{className:"space-y-4",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",id:"bypassEmailVerification",checked:c.bypassEmailVerification,onChange:l=>y("bypassEmailVerification",l.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),r.jsx("label",{htmlFor:"bypassEmailVerification",className:"ml-2 block text-sm text-gray-900",children:"Bypass verificación de email (Desarrollo)"})]}),r.jsx("p",{className:"text-xs text-gray-500",children:"Los usuarios se activan automáticamente sin verificar email"}),r.jsxs("div",{className:"flex items-center",children:[r.jsx("input",{type:"checkbox",id:"requireEmailVerification",checked:c.requireEmailVerification,onChange:l=>y("requireEmailVerification",l.target.checked),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),r.jsx("label",{htmlFor:"requireEmailVerification",className:"ml-2 block text-sm text-gray-900",children:"Requerir verificación de email"})]}),r.jsx("p",{className:"text-xs text-gray-500",children:"Los usuarios deben verificar su email antes de acceder al sistema"}),r.jsxs("div",{children:[r.jsxs("label",{className:" text-sm font-medium text-gray-700 mb-2 flex items-center",children:[r.jsx(Ie,{className:"w-4 h-4 mr-1"}),"Timeout de verificación (horas)"]}),r.jsx("input",{type:"number",onWheel:l=>l.currentTarget.blur(),value:c.emailVerificationTimeout,onChange:l=>y("emailVerificationTimeout",parseInt(l.target.value)),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-primary-500 focus:border-primary-500",min:"1",max:"168"}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Tiempo límite para que el usuario verifique su email"})]})]})]})]}),r.jsx("div",{className:"bg-primary-50 border border-primary-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-start",children:[r.jsx(Oe,{className:"w-5 h-5 text-primary-500 mr-3 mt-1 flex-shrink-0"}),r.jsxs("div",{children:[r.jsx("h4",{className:"font-medium text-primary-900 mb-2",children:"Configuraciones Recomendadas"}),r.jsxs("ul",{className:"text-sm text-primary-800 space-y-1",children:[r.jsxs("li",{children:[r.jsx("strong",{children:"Desarrollo:"})," Bypass email ON, Verificación OFF"]}),r.jsxs("li",{children:[r.jsx("strong",{children:"Testing:"})," Bypass email ON, Verificación ON (para probar flujo)"]}),r.jsxs("li",{children:[r.jsx("strong",{children:"Producción:"})," Bypass email OFF, Verificación ON"]}),r.jsxs("li",{children:[r.jsx("strong",{children:"Mantenimiento:"})," Admin Only Access ON"]})]})]})]})}),r.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[r.jsxs("h4",{className:"font-medium text-gray-900 mb-3 flex items-center",children:[r.jsx(Ce,{className:"w-4 h-4 mr-2"}),"Estado Actual del Sistema"]}),r.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-600",children:"Modo Desarrollo:"}),r.jsx("span",{className:`ml-2 px-2 py-1 rounded text-xs ${c.mode?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:c.mode?"Activo":"Inactivo"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-600",children:"Solo Administradores:"}),r.jsx("span",{className:`ml-2 px-2 py-1 rounded text-xs ${c.allowAdminOnlyAccess?"bg-red-100 text-red-800":"bg-green-100 text-green-800"}`,children:c.allowAdminOnlyAccess?"Activo":"Inactivo"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-600",children:"Bypass Email:"}),r.jsx("span",{className:`ml-2 px-2 py-1 rounded text-xs ${c.bypassEmailVerification?"bg-yellow-100 text-yellow-800":"bg-primary-100 text-primary-800"}`,children:c.bypassEmailVerification?"Activo":"Inactivo"})]}),r.jsxs("div",{children:[r.jsx("span",{className:"text-gray-600",children:"Verificación Requerida:"}),r.jsx("span",{className:`ml-2 px-2 py-1 rounded text-xs ${c.requireEmailVerification?"bg-primary-100 text-primary-800":"bg-gray-100 text-gray-800"}`,children:c.requireEmailVerification?"Sí":"No"})]})]})]}),r.jsx("div",{className:"flex justify-end",children:r.jsxs("button",{onClick:_,disabled:t,className:"flex items-center px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:opacity-50",children:[r.jsx(ye,{size:16,className:"mr-2"}),t?"Guardando...":"Guardar Configuración"]})})]})},io=()=>{const[s,e]=g.useState(!0),[t,a]=g.useState(!1),[n,o]=g.useState(null),[i,d]=g.useState(null),[c,h]=g.useState({platform_commission_rate:"10.0",shipping_seller_percentage:"80.0",shipping_max_seller_percentage:"40.0"}),[m,v]=g.useState({platform_commission_rate:"10.0",shipping_seller_percentage:"80.0",shipping_max_seller_percentage:"40.0"});g.useEffect(()=>{y()},[]);const y=async()=>{e(!0),o(null);try{console.log("📊 Cargando configuraciones financieras...");const j=await $.get(D.ADMIN.CONFIGURATIONS.FINANCIAL);if(console.log("✅ Respuesta del servidor:",j),j&&typeof j=="object"){const w=j,E={platform_commission_rate:String(w.platform_commission_rate||"10.0"),shipping_seller_percentage:String(w.shipping_seller_percentage||"80.0"),shipping_max_seller_percentage:String(w.shipping_max_seller_percentage||"40.0")};h(E),v(E),console.log("✅ Configuraciones cargadas:",E)}else throw new Error("Respuesta inválida del servidor")}catch(j){console.error("❌ Error loading financial configurations:",j),o("No se pudieron cargar las configuraciones financieras. Usando valores por defecto.");const w={platform_commission_rate:"10.0",shipping_seller_percentage:"80.0",shipping_max_seller_percentage:"40.0"};h(w),v(w)}finally{e(!1)}},_=(j,w)=>{const E=w.replace(/[^0-9.]/g,""),R=E.split(".");R.length>2||R.length===2&&R[1].length>2||(h(x=>({...x,[j]:E})),o(null))},l=()=>{const j=parseFloat(c.platform_commission_rate),w=parseFloat(c.shipping_seller_percentage),E=parseFloat(c.shipping_max_seller_percentage);return isNaN(j)||isNaN(w)||isNaN(E)?"Todos los campos deben contener números válidos":j<0||j>50?"La comisión de plataforma debe estar entre 0% y 50%":w<0||w>100?"El porcentaje de envío para un vendedor debe estar entre 0% y 100%":E<0||E>100?"El porcentaje máximo de envío debe estar entre 0% y 100%":E>=w?"El porcentaje máximo debe ser menor al porcentaje para un vendedor":null},C=async()=>{const j=l();if(j){o(j);return}a(!0),o(null),d(null);try{console.log("💾 Guardando configuraciones financieras...");const w={platform_commission_rate:parseFloat(c.platform_commission_rate),shipping_seller_percentage:parseFloat(c.shipping_seller_percentage),shipping_max_seller_percentage:parseFloat(c.shipping_max_seller_percentage)},E=await $.put(D.ADMIN.CONFIGURATIONS.FINANCIAL,w);console.log("✅ Configuraciones guardadas:",E),v(c),d("Configuraciones guardadas exitosamente"),setTimeout(()=>d(null),3e3)}catch(w){console.error("❌ Error al guardar configuraciones:",w),o("Error al guardar las configuraciones. Por favor, inténtalo de nuevo.")}finally{a(!1)}},f=()=>JSON.stringify(c)!==JSON.stringify(m);return s?r.jsxs("div",{className:"flex items-center justify-center py-12",children:[r.jsx(G,{className:"animate-spin h-8 w-8 text-primary-600 mr-3"}),r.jsx("span",{className:"text-gray-600",children:"Cargando configuraciones financieras..."})]}):r.jsx("div",{className:"space-y-6",children:r.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-6",children:[r.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[r.jsx("div",{className:"p-2 bg-primary-100 rounded-lg",children:r.jsx(Je,{className:"h-6 w-6 text-primary-600"})}),r.jsxs("div",{children:[r.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Configuraciones Financieras"}),r.jsx("p",{className:"text-sm text-gray-600",children:"Gestiona las comisiones de la plataforma y distribución de envíos"})]})]}),n&&r.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(J,{className:"h-5 w-5 text-red-500 mr-2"}),r.jsx("p",{className:"text-red-700 text-sm",children:n})]})}),i&&r.jsx("div",{className:"mb-4 bg-green-50 border border-green-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-center",children:[r.jsx(cr,{className:"h-5 w-5 text-green-500 mr-2"}),r.jsx("p",{className:"text-green-700 text-sm font-medium",children:i})]})}),r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsxs("label",{htmlFor:"platform_commission_rate",className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[r.jsx(Ce,{className:"h-4 w-4 text-primary-600 mr-2"}),"Comisión de Plataforma (%)"]}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{id:"platform_commission_rate",type:"text",value:c.platform_commission_rate,onChange:j=>_("platform_commission_rate",j.target.value),className:"w-full px-3 py-2 pr-8 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"10.0"}),r.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:r.jsx("span",{className:"text-gray-500 text-sm",children:"%"})})]}),r.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Porcentaje que la plataforma retiene de cada venta (0% - 50%)"})]}),r.jsxs("div",{children:[r.jsxs("label",{htmlFor:"shipping_seller_percentage",className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[r.jsx(cr,{className:"h-4 w-4 text-blue-600 mr-2"}),"Envío Vendedor Único (%)"]}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{id:"shipping_seller_percentage",type:"text",value:c.shipping_seller_percentage,onChange:j=>_("shipping_seller_percentage",j.target.value),className:"w-full px-3 py-2 pr-8 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"80.0"}),r.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:r.jsx("span",{className:"text-gray-500 text-sm",children:"%"})})]}),r.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Porcentaje del envío que recibe el vendedor cuando es el único (0% - 100%)"})]}),r.jsxs("div",{children:[r.jsxs("label",{htmlFor:"shipping_max_seller_percentage",className:"flex items-center text-sm font-medium text-gray-700 mb-2",children:[r.jsx(cr,{className:"h-4 w-4 text-orange-600 mr-2"}),"Envío Máximo Múltiples Vendedores (%)"]}),r.jsxs("div",{className:"relative",children:[r.jsx("input",{id:"shipping_max_seller_percentage",type:"text",value:c.shipping_max_seller_percentage,onChange:j=>_("shipping_max_seller_percentage",j.target.value),className:"w-full px-3 py-2 pr-8 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"40.0"}),r.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:r.jsx("span",{className:"text-gray-500 text-sm",children:"%"})})]}),r.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Porcentaje máximo del envío por vendedor con múltiples vendedores (0% - 100%)"})]}),r.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:r.jsxs("div",{className:"flex items-start gap-3",children:[r.jsx(J,{className:"h-5 w-5 text-amber-600 mt-0.5 flex-shrink-0"}),r.jsxs("div",{className:"text-sm text-amber-800",children:[r.jsx("p",{className:"font-medium mb-2",children:"⚠️ Configuraciones Críticas"}),r.jsxs("ul",{className:"list-disc list-inside space-y-1 text-xs",children:[r.jsx("li",{children:"Estos cambios afectan todos los cálculos financieros de la plataforma"}),r.jsx("li",{children:"Recomendamos hacer cambios gradualmente y monitorear los resultados"})]})]})]})})]}),r.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[r.jsx("button",{type:"button",onClick:()=>h(m),disabled:!f()||t,className:"px-4 py-2 border border-gray-300 text-gray-700 bg-white hover:bg-gray-50 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancelar"}),r.jsx("button",{type:"button",onClick:C,disabled:!f()||t,className:"px-6 py-2 bg-primary-600 text-white hover:bg-primary-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center",children:t?r.jsxs(r.Fragment,{children:[r.jsx(G,{className:"animate-spin h-4 w-4 mr-2"}),"Guardando..."]}):r.jsxs(r.Fragment,{children:[r.jsx(ye,{className:"h-4 w-4 mr-2"}),"Guardar Cambios"]})})]})]})})},lo=()=>{const[s,e]=g.useState("security");return r.jsxs("div",{children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Configuración del Sistema"}),r.jsx("div",{className:"mb-6",children:r.jsx("div",{className:"border-b border-gray-200",children:r.jsxs("nav",{className:"-mb-px flex space-x-8 overflow-x-auto",children:[r.jsxs("button",{onClick:()=>e("security"),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${s==="security"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[r.jsx(_r,{className:"w-5 h-5 inline-block mr-1"}),"Seguridad"]}),r.jsxs("button",{onClick:()=>e("moderation"),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${s==="moderation"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[r.jsx(Ce,{className:"w-5 h-5 inline-block mr-1"}),"Moderación"]}),r.jsxs("button",{onClick:()=>e("rating"),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${s==="rating"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[r.jsx(me,{className:"w-5 h-5 inline-block mr-1"}),"Calificaciones"]}),r.jsxs("button",{onClick:()=>e("volume_discount"),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${s==="volume_discount"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[r.jsx(ct,{className:"w-5 h-5 inline-block mr-1"}),"Descuentos por Volumen"]}),r.jsxs("button",{onClick:()=>e("shipping"),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${s==="shipping"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[r.jsx(Pr,{className:"w-5 h-5 inline-block mr-1"}),"Envíos"]}),r.jsxs("button",{onClick:()=>e("development"),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${s==="development"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[r.jsx(ns,{className:"w-5 h-5 inline-block mr-1"}),"Desarrollo"]}),r.jsxs("button",{onClick:()=>e("financial"),className:`py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${s==="financial"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[r.jsx(Je,{className:"w-5 h-5 inline-block mr-1"}),"Financiero"]})]})})}),r.jsxs("div",{className:"bg-white rounded-lg shadow-sm",children:[s==="security"&&r.jsx("div",{className:"p-6",children:r.jsx(ro,{})}),s==="moderation"&&r.jsx("div",{className:"p-6",children:r.jsx(so,{})}),s==="rating"&&r.jsx("div",{className:"p-6",children:r.jsx(to,{})}),s==="volume_discount"&&r.jsx("div",{className:"p-6",children:r.jsx(ao,{})}),s==="shipping"&&r.jsx("div",{className:"p-6",children:r.jsx(no,{})}),s==="development"&&r.jsx("div",{className:"p-6",children:r.jsx(oo,{})}),s==="financial"&&r.jsx("div",{className:"p-6",children:r.jsx(io,{})})]})]})},Uo=Object.freeze(Object.defineProperty({__proto__:null,default:lo},Symbol.toStringTag,{value:"Module"}));export{D as A,de as C,Os as D,Ya as P,ar as T,q as a,X as b,$ as c,Ja as d,z as e,Ee as f,re as g,ve as h,qe as i,gr as j,Qn as k,Dn as l,Ds as m,Ro as n,Io as o,Oo as p,Do as q,ko as r,Uo as s,Rs as u};
//# sourceMappingURL=admin-chunk-BNcFjXlJ.js.map
