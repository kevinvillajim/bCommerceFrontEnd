import{j as s,$ as C,U as _,B as A,az as y,P as v,q as w,e as T,H as P,d as S,M as E,D as k,J as R,V as G,T as j,o as D}from"./ui-vendor-BUNMIuFe.js";import{a as F,r as l}from"./react-vendor-Cy458wKG.js";import{D as O,B as I}from"./BaseDashboardLayout-BXxFld6j.js";import{u as M}from"./chat-chunk-BRsdDZXf.js";import{a as V}from"./index-BStY3ojk.js";import"./seller-chunk-6swISJwY.js";import"./admin-chunk-BNcFjXlJ.js";import"./utils-vendor-DeGC_a19.js";import"./ThemeToggle-CqueQG8r.js";import"./checkout-chunk-C5n3Mg9L.js";const B=[{title:"Principal",links:[{path:"/admin/dashboard",label:"Dashboard",icon:s.jsx(C,{className:"w-5 h-5 mr-3"})}]},{title:"Gestión de Usuario",links:[{path:"/admin/users",label:"Usuarios",icon:s.jsx(_,{className:"w-5 h-5 mr-3"})},{path:"/admin/sellers",label:"Vendedores",icon:s.jsx(A,{className:"w-5 h-5 mr-3"}),isNotificated:!1,notificationCount:0},{path:"/admin/solicitudes",label:"Solicitudes",icon:s.jsx(y,{className:"w-5 h-5 mr-3"}),isNotificated:!1,notificationCount:0}]},{title:"Productos",links:[{path:"/admin/products",label:"Productos",icon:s.jsx(v,{className:"w-5 h-5 mr-3"})},{path:"/admin/categories",label:"Categorías",icon:s.jsx(w,{className:"w-5 h-5 mr-3"})}]},{title:"Pedidos",links:[{path:"/admin/orders",label:"Pedidos",icon:s.jsx(T,{className:"w-5 h-5 mr-3"})},{path:"/admin/shipping",label:"Envíos",icon:s.jsx(P,{className:"w-5 h-5 mr-3"})}]},{title:"Contenido",links:[{path:"/admin/ratings",label:"Valoraciones y Reseñas",icon:s.jsx(S,{className:"w-5 h-5 mr-3"}),isNotificated:!1,notificationCount:10},{path:"/admin/feedback",label:"Feedback y Comentarios",icon:s.jsx(E,{className:"w-5 h-5 mr-3"}),isNotificated:!0,notificationCount:5},{path:"/admin/discounts",label:"Descuentos",icon:s.jsx(k,{className:"w-5 h-5 mr-3"})}]},{title:"Finanzas",links:[{path:"/admin/invoices",label:"Facturas",icon:s.jsx(R,{className:"w-5 h-5 mr-3"})},{path:"/admin/accounting",label:"Contabilidad",icon:s.jsx(k,{className:"w-5 h-5 mr-3"})}]},{title:"Sistema",links:[{path:"/admin/settings",label:"Configuración",icon:s.jsx(G,{className:"w-5 h-5 mr-3"})},{path:"/admin/logs",label:"Registros de Errores",icon:s.jsx(j,{className:"w-5 h-5 mr-3"})}]}],U={users:"/admin/users",sellers:"/admin/sellers",solicitudes:"/admin/solicitudes",orders:"/admin/orders",shipping:"/admin/shipping",ratings:"/admin/ratings",feedback:"/admin/feedback",logs:"/admin/logs",invoices:"/admin/invoices"},N={user_registered:"users",user_blocked:"users",user_reported:"users",seller_application:"solicitudes",seller_approved:"sellers",seller_suspended:"sellers",seller_issue:"sellers",order_created:"orders",order_cancelled:"orders",order_refund:"orders",payment_issue:"orders",shipping_problem:"shipping",delivery_issue:"shipping",rating_reported:"ratings",rating_flagged:"ratings",content_violation:"ratings",feedback_submitted:"feedback",complaint_received:"feedback",feedback_flagged:"feedback",system_error:"logs",critical_error:"logs",security_alert:"logs",payment_failed:"invoices",invoice_overdue:"invoices"},$=()=>{const{isAuthenticated:e,roleInfo:t}=M(),p=F(),{notifications:m,loading:g,error:n,fetchNotifications:a,markAsRead:i}=V(),d=l.useMemo(()=>{if(!e||!t.isAdmin||!m.length)return{users:0,sellers:0,solicitudes:0,orders:0,shipping:0,ratings:0,feedback:0,logs:0,invoices:0};const r={users:0,sellers:0,solicitudes:0,orders:0,shipping:0,ratings:0,feedback:0,logs:0,invoices:0};return m.filter(o=>!o.read).forEach(o=>{const c=N[o.type];c&&r[c]++}),r},[m,e,t.isAdmin]),u=l.useCallback(async r=>{if(!(!e||!t.isAdmin))try{const o=m.filter(c=>!c.read&&N[c.type]===r);for(const c of o)await i(c.id)}catch(o){console.error(`Error marking ${r} notifications as read:`,o)}},[e,t.isAdmin,m,i]),f=l.useRef(d),h=l.useRef(u);f.current=d,h.current=u,l.useEffect(()=>{const r=p.pathname;for(const[o,c]of Object.entries(U))if(r.startsWith(c)){const x=o;f.current[x]>0&&h.current(x);break}},[p.pathname]),l.useEffect(()=>{e&&t.isAdmin&&a(1,!1)},[e,t.isAdmin,a]);const b=l.useCallback(async()=>{e&&t.isAdmin&&await a(1,!1)},[e,t.isAdmin,a]);return{counts:d,loading:g,error:n,refetch:b,markSectionAsRead:u}},Z=()=>{const{counts:e}=$(),t={"/admin/dashboard":"Dashboard","/admin/users":"Gestión de Usuarios","/admin/sellers":"Gestión de Vendedores","/admin/solicitudes":"Solicitudes de Vendedor","/admin/products":"Gestión de Productos","/admin/categories":"Gestión de Categorías","/admin/orders":"Gestión de Pedidos","/admin/ratings":"Moderación de Valoraciones y Reseñas","/admin/feedback":"Gestión de Comentarios","/admin/discounts":"Códigos de Descuento","/admin/invoices":"Facturas","/admin/accounting":"Contabilidad","/admin/settings":"Configuración del Sistema","/admin/logs":"Registro de Errores"},p={title:"Panel de Administración (Admin)",icon:s.jsx(D,{className:"w-7 h-7 text-primary-400"})},m=l.useMemo(()=>B.map(n=>({...n,links:n.links.map(a=>{let i=0;switch(a.path){case"/admin/users":i=e.users;break;case"/admin/sellers":i=e.sellers;break;case"/admin/solicitudes":i=e.solicitudes;break;case"/admin/orders":i=e.orders;break;case"/admin/shipping":i=e.shipping;break;case"/admin/ratings":i=e.ratings;break;case"/admin/feedback":i=e.feedback;break;case"/admin/logs":i=e.logs;break;case"/admin/invoices":i=e.invoices;break;default:i=a.notificationCount||0}return{...a,notificationCount:i,isNotificated:i>0}})})),[e]),g=()=>{const n=e.logs+e.feedback+e.solicitudes,a=e.ratings+e.orders+e.invoices,i=Object.values(e).reduce((b,r)=>b+r,0);if(i===0)return null;const d=n>0,u=d?"bg-red-50 border-b border-red-200":"bg-amber-50 border-b border-amber-200",f=d?"text-red-500":"text-amber-500",h=d?"text-red-800":"text-amber-800";return s.jsx("div",{className:u+" px-4 py-2",children:s.jsxs("div",{className:"flex items-center",children:[s.jsx(j,{className:`h-5 w-5 ${f} mr-2`}),s.jsx("span",{className:`text-sm ${h}`,children:d?s.jsxs(s.Fragment,{children:[s.jsx("strong",{children:"¡Atención!"})," Tienes ",n," notificación",n!==1?"es":""," crítica",n!==1?"s":"",a>0&&` y ${a} adicionales`," pendientes."]}):s.jsxs(s.Fragment,{children:["Tienes ",s.jsx("strong",{children:i})," notificación",i!==1?"es":"","pendiente",i!==1?"s":""," en el panel de administración."]})})]})})};return s.jsx(O,{initialType:"admin",initialPageTitles:t,children:s.jsx(I,{sidebarGroups:m,sidebarTitle:p,headerExtras:s.jsx(g,{})})})};export{Z as default};
//# sourceMappingURL=AdminLayout-vn0n87DI.js.map
