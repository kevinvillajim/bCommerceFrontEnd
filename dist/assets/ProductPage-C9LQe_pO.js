import{c as ce,r as g,m as A,i as pe,n as P,o as be,R as X,j as e,X as M,f as K}from"./index-DmNDOrWy.js";import{u as ye}from"./useCategories-B5xz5QTT.js";import{u as je}from"./useCart-DylEmA2w.js";import{u as ve}from"./useFavorites-T3Y-P3Fr.js";import{S as Ne}from"./search-CbEKe7UQ.js";import{P as z}from"./package-CIRlwNqy.js";import{C as Y}from"./chevron-left-Dl3DF2OO.js";import{L as D,H as O,M as W,T as B,S as T,P as Ce}from"./ProductCardCompact-WKBc3swN.js";import{C as J}from"./camera-DRGuh-td.js";import{S as we}from"./star-DFFyFcok.js";import{C as ke}from"./chevron-up-y8m3KQF_.js";import{C as de}from"./chevron-down-BvY6CQlk.js";import{R as Se}from"./RatingStars-BDWJGfWO.js";import{F as ne}from"./funnel-CAFb7hhq.js";import{g as Ie}from"./imageUtils-B2iUz1H0.js";import"./heart-DBtNcst0.js";import"./check-CHNPnXXq.js";import"./shopping-cart-Ck1So-LU.js";/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["circle",{cx:"12",cy:"14",r:"4",key:"1jruaj"}],["path",{d:"M12 14h.01",key:"1etili"}]],Z=ce("speaker",Ae);/**
 * @license lucide-react v0.484.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=[["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["polyline",{points:"12 10 12 12 13 13",key:"19dquz"}],["path",{d:"m16.13 7.66-.81-4.05a2 2 0 0 0-2-1.61h-2.68a2 2 0 0 0-2 1.61l-.78 4.05",key:"18k57s"}],["path",{d:"m7.88 16.36.8 4a2 2 0 0 0 2 1.61h2.72a2 2 0 0 0 2-1.61l.81-4.05",key:"16ny36"}]],H=ce("watch",Ee);class _e{static inspectResponse(t,o="Inspección de respuesta API"){console.group(o);try{if(t==null){console.warn("⚠️ La respuesta es nula o indefinida"),console.groupEnd();return}if(console.log("Tipo de respuesta:",typeof t),typeof t=="object")if(Array.isArray(t))console.log("📊 La respuesta es un array con",t.length,"elementos"),t.length>0&&(console.log("Muestra del primer elemento:"),console.dir(t[0],{depth:2}),this.analyzeNamingConvention(t[0]));else{console.log("🔍 La respuesta es un objeto");const a=this.analyzeObjectStructure(t);console.log("Estructura:",a),t.data&&(console.log('⚠️ La respuesta contiene una propiedad "data":'),Array.isArray(t.data)?(console.log("📊 response.data es un array con",t.data.length,"elementos"),t.data.length>0&&(console.log("Muestra del primer elemento de response.data:"),console.dir(t.data[0],{depth:2}),this.analyzeNamingConvention(t.data[0]))):typeof t.data=="object"&&t.data!==null&&(console.log("🔍 response.data es un objeto"),console.dir(t.data,{depth:2}),t.data.data&&(console.log("⚠️⚠️ Se detectó una estructura anidada data.data"),Array.isArray(t.data.data)&&(console.log("📊 response.data.data es un array con",t.data.data.length,"elementos"),t.data.data.length>0&&(console.log("Muestra del primer elemento de response.data.data:"),console.dir(t.data.data[0],{depth:2}),this.analyzeNamingConvention(t.data.data[0])))))),t.meta&&(console.log("📝 La respuesta contiene metadatos:"),console.dir(t.meta,{depth:2})),this.analyzeNamingConvention(t)}else console.log("⚠️ La respuesta no es un objeto ni un array:",t)}catch(a){console.error("Error durante la inspección:",a)}console.groupEnd()}static analyzeObjectStructure(t){if(!t||typeof t!="object")return"No es un objeto";const o=Object.keys(t);return o.length===0?"Objeto vacío {}":`Objeto con ${o.length} propiedades: [${o.join(", ")}]`}static analyzeNamingConvention(t){if(!t||typeof t!="object"||Array.isArray(t))return;const o=Object.keys(t);if(o.length===0)return;const a=o.filter(l=>l.includes("_")),m=o.filter(l=>/[a-z][A-Z]/.test(l));console.log("Análisis de convención de nombres:"),console.log(`- Propiedades en snake_case: ${a.length} (${a.slice(0,5).join(", ")}${a.length>5?"...":""})`),console.log(`- Propiedades en camelCase: ${m.length} (${m.slice(0,5).join(", ")}${m.length>5?"...":""})`),a.length>0&&m.length>0?console.warn("⚠️ El objeto mezcla convenciones snake_case y camelCase"):a.length>0?console.log("✅ El objeto usa consistentemente snake_case"):m.length>0&&console.log("✅ El objeto usa consistentemente camelCase")}}class le{static logFilterParams(t,o){console.group("🔍 DEBUG: Parámetros de filtro"),console.log("📋 Parámetros completos:",t),t.categoryIds&&t.categoryIds.length>0&&(console.group("📂 Categorías seleccionadas:"),console.log("IDs enviados:",t.categoryIds),t.categoryIds.forEach(a=>{const m=o.find(l=>l.id===a);m?console.log(`✅ ID ${a}: ${m.name}`):console.warn(`❌ ID ${a}: Categoría no encontrada`)}),console.log("Operador:",t.categoryOperator||"or"),console.groupEnd()),(t.minPrice!==void 0||t.maxPrice!==void 0)&&(console.group("💰 Filtros de precio:"),t.minPrice!==void 0&&console.log("Precio mínimo:",t.minPrice),t.maxPrice!==void 0&&console.log("Precio máximo:",t.maxPrice),console.groupEnd()),t.rating!==void 0&&console.log("⭐ Rating mínimo:",t.rating),t.minDiscount!==void 0&&console.log("🏷️ Descuento mínimo:",t.minDiscount+"%"),t.sortBy&&console.log("🔄 Ordenamiento:",`${t.sortBy} ${t.sortDir||"desc"}`),t.term&&console.log("🔍 Término de búsqueda:",t.term),console.groupEnd()}static buildDebugUrl(t,o="http://127.0.0.1:8000/api"){const a=new URLSearchParams;Object.entries(t).forEach(([l,n])=>{n!=null&&(Array.isArray(n)?a.set(l,n.join(",")):a.set(l,n.toString()))});const m=`${o}/products?${a.toString()}`;return console.log("🔗 URL de prueba:",m),m}static compareParams(t,o){console.group("🔍 Comparación de parámetros"),new Set([...Object.keys(t),...Object.keys(o)]).forEach(m=>{const l=t[m],n=o[m];JSON.stringify(l)!==JSON.stringify(n)&&console.log(`📝 ${m}:`,{anterior:l,actual:n})}),console.groupEnd()}static validateParams(t){const o=[];return t.categoryIds&&(Array.isArray(t.categoryIds)?t.categoryIds.some(a=>typeof a!="number"||a<=0)&&o.push("categoryIds debe contener solo números positivos"):o.push("categoryIds debe ser un array")),t.minPrice!==void 0&&(typeof t.minPrice!="number"||t.minPrice<0)&&o.push("minPrice debe ser un número no negativo"),t.maxPrice!==void 0&&(typeof t.maxPrice!="number"||t.maxPrice<0)&&o.push("maxPrice debe ser un número no negativo"),t.minPrice!==void 0&&t.maxPrice!==void 0&&t.minPrice>t.maxPrice&&o.push("minPrice no puede ser mayor que maxPrice"),t.rating!==void 0&&(typeof t.rating!="number"||t.rating<1||t.rating>5)&&o.push("rating debe ser un número entre 1 y 5"),t.minDiscount!==void 0&&(typeof t.minDiscount!="number"||t.minDiscount<0||t.minDiscount>100)&&o.push("minDiscount debe ser un número entre 0 y 100"),t.sortDir&&!["asc","desc"].includes(t.sortDir)&&o.push("sortDir debe ser 'asc' o 'desc'"),o.length>0&&console.warn("❌ Errores de validación:",o),{isValid:o.length===0,errors:o}}}const L=new pe,$e=s=>{if(!s)return"products_default";const t={...s};return t.categoryIds&&(t.categoryIds=[...t.categoryIds].sort((o,a)=>o-a)),`products_${JSON.stringify(t)}`},Fe=()=>{const[s,t]=g.useState(!1),[o,a]=g.useState(null),[m,l]=g.useState([]),[n,x]=g.useState(null),[u,j]=g.useState(null),[w,S]=g.useState(!1),N=g.useCallback(r=>{if(!r||typeof r!="object")return console.error("Producto inválido para adaptar:",r),{};console.group(`🖼️ DEBUGGING IMÁGENES - Producto ID: ${r.id}`),console.log("📦 Producto completo desde API:",r),console.log("🎨 Datos de imágenes originales:",{images:r.images,image:r.image,main_image:r.main_image,thumbnail:r.thumbnail,featured_image:r.featured_image});let p=[];Array.isArray(r.images)&&r.images.length>0&&(console.log("📋 Procesando array images:",r.images),p=r.images.map(d=>{if(typeof d=="string")return console.log("📄 Imagen como string:",d),d;if(typeof d=="object"&&d!==null){const v=d.original||d.large||d.medium||d.thumbnail||d.url||d.path||d.src||"";return console.log("🎯 Imagen extraída de objeto:",v,"desde:",d),v}return console.warn("⚠️ Formato de imagen no reconocido:",d),""}).filter(Boolean)),p.length===0&&r.image&&(console.log("📄 Usando campo image singular:",r.image),p=[r.image]),p.length===0&&r.main_image&&(console.log("🌟 Usando campo main_image:",r.main_image),p=[r.main_image]),p.length===0&&r.featured_image&&(console.log("⭐ Usando campo featured_image:",r.featured_image),p=[r.featured_image]),p.length===0&&r.thumbnail&&(console.log("🖼️ Usando campo thumbnail:",r.thumbnail),p=[r.thumbnail]),console.log("✅ Imágenes procesadas finales:",p),console.groupEnd();const h={id:r.id,userId:r.userId||r.user_id,categoryId:r.categoryId||r.category_id,name:r.name,slug:r.slug,description:r.description||"",price:Number(r.price||0),stock:Number(r.stock||0),weight:r.weight,width:r.width,height:r.height,depth:r.depth,dimensions:r.dimensions,colors:r.colors,sizes:r.sizes,tags:r.tags,sku:r.sku,attributes:r.attributes,images:p,featured:!!r.featured,published:!!r.published,status:r.status||"active",viewCount:r.viewCount||r.view_count||0,salesCount:r.salesCount||r.sales_count||0,discountPercentage:r.discountPercentage||r.discount_percentage||0,finalPrice:r.finalPrice||r.final_price,isInStock:r.isInStock||r.is_in_stock,rating:r.rating||r.rating_avg,ratingCount:r.rating_count||r.rating_avg_count,createdAt:r.createdAt||r.created_at,updatedAt:r.updatedAt||r.updated_at};return console.log("🔄 Producto adaptado:",{id:h.id,name:h.name,images:h.images,price:h.price}),h},[]);g.useEffect(()=>{if(!w){const r=A.getItem("products_featured");r&&(l(r.data||[]),j(r.meta||null)),S(!0)}},[w]);const k=g.useCallback(async r=>{t(!0),a(null);try{if(console.group("🔄 Iniciando fetchProducts"),r){const v=le.validateParams(r);if(!v.isValid)return console.error("❌ Parámetros inválidos:",v.errors),a(`Parámetros inválidos: ${v.errors.join(", ")}`),t(!1),null;console.log("📊 Parámetros recibidos:",r),le.buildDebugUrl(r)}const p=$e(r);console.log("🔑 Clave de caché:",p);const h=A.getItem(p);if(h)return console.log("💾 Usando datos en caché"),l(h.data||[]),j(h.meta||null),t(!1),h;console.log("🌐 Realizando petición a la API");const d=await L.getProducts(r);if(console.log("🔍 RESPUESTA RAW DE LA API:",d),d){console.log("✅ Respuesta recibida:",d),_e.inspectResponse(d,"Respuesta de productos");let v=[];Array.isArray(d.data)?(console.log("📦 Respuesta contiene un array en data"),v=d.data.map(N)):d.data&&typeof d.data=="object"?(console.log("📦 Respuesta contiene un objeto en data"),v=[N(d.data)]):Array.isArray(d)&&(console.log("📦 Respuesta es directamente un array"),v=d.map(N));const I={data:v,meta:d.meta||{total:v.length,limit:r?.limit||10,offset:r?.offset||0}};return console.log("💫 Datos adaptados:",{productCount:v.length,meta:I.meta,firstProduct:v[0]}),A.setItem(p,I,P.cache.productCacheTime),l(v),j(I.meta),console.groupEnd(),I}else return console.warn("⚠️ Respuesta vacía de la API"),l([]),j({total:0,limit:0,offset:0}),console.groupEnd(),{data:[],meta:{total:0,limit:0,offset:0}}}catch(p){console.error("❌ Error obteniendo productos:",p);const h=p instanceof Error?p.message:"Error al obtener productos";return a(h),l([]),j({total:0,limit:0,offset:0}),console.groupEnd(),null}finally{t(!1)}},[N]),i=g.useCallback(async r=>{t(!0),a(null);const p=`product_${r}`;try{const h=A.getItem(p);if(h)return console.log(`💾 Usando producto en caché con ID ${r}`),x(h),t(!1),h;console.log(`🌐 Obteniendo producto con ID ${r} desde API`);const d=await L.getProductById(r);return d?(console.log(`✅ Producto con ID ${r} recibido:`,d),A.setItem(p,d,P.cache.productCacheTime),x(d),d):(x(null),null)}catch(h){console.error("❌ Error obteniendo detalles de producto:",h);const d=h instanceof Error?h.message:"Error al obtener detalles del producto";return a(d),x(null),null}finally{t(!1)}},[]),f=g.useCallback(async r=>{t(!0),a(null);const p=`product_slug_${r}`;try{const h=A.getItem(p);if(h)return console.log(`💾 Usando producto en caché con slug ${r}`),x(h),t(!1),h;console.log(`🌐 Obteniendo producto con slug ${r} desde API`);const d=await L.getProductBySlug(r);return d?(console.log(`✅ Producto con slug ${r} recibido:`,d),A.setItem(p,d,P.cache.productCacheTime),x(d),d):(x(null),null)}catch(h){console.error("❌ Error obteniendo detalles de producto por slug:",h);const d=h instanceof Error?h.message:"Error al obtener detalles del producto";return a(d),x(null),null}finally{t(!1)}},[]),b=g.useCallback(async(r=8)=>{t(!0),a(null);const p=`products_featured_${r}`;try{const h=A.getItem(p);if(h)return console.log(`💾 Usando productos destacados en caché (límite: ${r})`),l(h),t(!1),h;console.log(`🌐 Obteniendo productos destacados desde API (límite: ${r})`);const d=await L.getFeaturedProducts(r);if(d&&d.length>0){console.log("✅ Productos destacados recibidos:",d);const v=d.map(N);return A.setItem(p,v,P.cache.productCacheTime),l(v),v}return l([]),[]}catch(h){console.error("❌ Error obteniendo productos destacados:",h);const d=h instanceof Error?h.message:"Error al obtener productos destacados";return a(d),l([]),[]}finally{t(!1)}},[N]),C=g.useCallback(async(r,p=4)=>{t(!0),a(null);const h=`products_related_${r}_${p}`;try{const d=A.getItem(h);if(d)return console.log(`💾 Usando productos relacionados en caché para producto ${r}`),t(!1),d;console.log(`🌐 Obteniendo productos relacionados desde API para producto ${r}`);const v=await L.getRelatedProducts(r,p);if(v&&v.length>0){console.log(`✅ Productos relacionados recibidos para producto ${r}:`,v);const I=v.map(N);return A.setItem(h,I,P.cache.productCacheTime),I}return[]}catch(d){console.error("❌ Error obteniendo productos relacionados:",d);const v=d instanceof Error?d.message:"Error al obtener productos relacionados";return a(v),[]}finally{t(!1)}},[N]),E=g.useCallback(async r=>{try{await L.trackProductView(r)}catch(p){console.error("❌ Error registrando visualización de producto:",p)}},[]),c=g.useCallback(r=>{if(r)A.removeItem(`product_${r}`),console.log(`🗑️ Caché del producto ${r} eliminada`);else{const h=Object.keys(localStorage).filter(d=>d.startsWith("product_")||d.startsWith("products_"));h.forEach(d=>{A.removeItem(d)}),console.log(`🗑️ ${h.length} claves de caché de productos eliminadas`)}},[]);return{loading:s,error:o,products:m,product:n,meta:u,fetchProducts:k,fetchProductById:i,fetchProductBySlug:f,fetchFeaturedProducts:b,fetchRelatedProducts:C,trackProductView:E,clearProductCache:c}},Re=(s,t=P.pagination.defaultPageSize)=>{const[o,a]=be(),m=g.useRef(!1),l=g.useRef(""),[n,x]=g.useState(()=>{const c=o.get("category"),r=o.get("minPrice"),p=o.get("maxPrice"),h=o.get("rating"),d=o.get("discount"),v=o.get("sort"),I=o.get("page"),F=o.get("search");return console.log("useProductFilters: Inicializando desde URL:",{categoryParam:c,minPriceParam:r,maxPriceParam:p,ratingParam:h,discountParam:d,sortParam:v,pageParam:I,searchParam:F}),{categories:c?c.split(",").map(_=>decodeURIComponent(_)):[],priceRange:r&&p?{min:parseInt(r),max:parseInt(p)}:null,rating:h?parseInt(h):null,discount:d==="true",sortBy:v||"featured",page:I?parseInt(I):1,searchTerm:F||""}});g.useEffect(()=>{if(!m.current)return;const c=new URLSearchParams;n.categories.length>0&&c.set("category",n.categories.map(p=>encodeURIComponent(p)).join(",")),n.priceRange&&(c.set("minPrice",n.priceRange.min.toString()),c.set("maxPrice",n.priceRange.max.toString())),n.rating&&c.set("rating",n.rating.toString()),n.discount&&c.set("discount","true"),n.sortBy!=="featured"&&c.set("sort",n.sortBy),n.page>1&&c.set("page",n.page.toString()),n.searchTerm&&c.set("search",n.searchTerm);const r=c.toString();console.log("useProductFilters: Actualizando URL:",r),a(c,{replace:!0}),setTimeout(()=>{m.current=!1},100)},[n,a]),g.useEffect(()=>{const c=o.toString();if(c===l.current)return;l.current=c,console.log("useProductFilters: URL cambió, actualizando estado:",c);const r=o.get("category"),p=o.get("minPrice"),h=o.get("maxPrice"),d=o.get("rating"),v=o.get("discount"),I=o.get("sort"),F=o.get("page"),_=o.get("search");x({categories:r?r.split(",").map($=>decodeURIComponent($)):[],priceRange:p&&h?{min:parseInt(p),max:parseInt(h)}:null,rating:d?parseInt(d):null,discount:v==="true",sortBy:I||"featured",page:F?parseInt(F):1,searchTerm:_||""})},[o]);const u=g.useCallback(c=>{m.current=!0,x(r=>({...r,...c,page:c.page!==void 0?c.page:1}))},[]),j=g.useCallback(c=>{console.log("useProductFilters: Actualizando categorías:",c),u({categories:c})},[u]),w=g.useCallback(c=>{console.log("useProductFilters: Actualizando rango de precio:",c),u({priceRange:c})},[u]),S=g.useCallback(c=>{console.log("useProductFilters: Actualizando rating:",c),u({rating:c})},[u]),N=g.useCallback(c=>{console.log("useProductFilters: Actualizando descuento:",c),u({discount:c})},[u]),k=g.useCallback(c=>{console.log("useProductFilters: Actualizando ordenamiento:",c),u({sortBy:c})},[u]),i=g.useCallback(c=>{console.log("useProductFilters: Actualizando página:",c),u({page:c})},[u]),f=g.useCallback(c=>{console.log("useProductFilters: Actualizando término de búsqueda:",c),u({searchTerm:c})},[u]),b=g.useCallback(()=>{console.log("useProductFilters: Limpiando todos los filtros"),u({categories:[],priceRange:null,rating:null,discount:!1,sortBy:"featured",page:1,searchTerm:""})},[u]),C=g.useCallback(c=>{console.log("useProductFilters: Alternando categoría:",c),x(r=>{const h=r.categories.includes(c)?r.categories.filter(d=>d!==c):[...r.categories,c];return m.current=!0,{...r,categories:h,page:1}})},[]),E=g.useCallback(()=>{console.log("useProductFilters: Construyendo parámetros desde estado:",n);const c={limit:t,offset:(n.page-1)*t,published:!0,status:"active"};if(n.searchTerm&&(c.term=n.searchTerm),n.categories.length>0){const r=[];n.categories.forEach(p=>{const h=s.find(d=>d.name.toLowerCase().trim()===p.toLowerCase().trim());h?.id?r.push(h.id):(console.warn(`useProductFilters: No se encontró categoría: "${p}"`),console.log("useProductFilters: Categorías disponibles:",s.map(d=>d.name)))}),console.log("useProductFilters: IDs de categorías encontrados:",r,"para nombres:",n.categories),r.length>0&&(c.categoryIds=r,c.categoryOperator="or")}switch(n.priceRange&&(c.minPrice=n.priceRange.min,c.maxPrice=n.priceRange.max),n.rating&&(c.rating=n.rating),n.discount&&(c.minDiscount=5),n.sortBy){case"price-asc":c.sortBy="price",c.sortDir="asc";break;case"price-desc":c.sortBy="price",c.sortDir="desc";break;case"name-asc":c.sortBy="name",c.sortDir="asc";break;case"name-desc":c.sortBy="name",c.sortDir="desc";break;case"newest":c.sortBy="created_at",c.sortDir="desc";break;case"rating":c.sortBy="rating",c.sortDir="desc";break;case"featured":default:c.sortBy="featured",c.sortDir="desc";break}return console.log("useProductFilters: Parámetros finales para API:",c),c},[n,s,t]);return{filters:n,buildFilterParams:E,setCategories:j,setPriceRange:w,setRating:S,setDiscount:N,setSortBy:k,setPage:i,setSearchTerm:f,clearFilters:b,toggleCategory:C}},ze=()=>{const[s,t]=g.useState(""),[o,a]=g.useState(!1),m=g.useCallback(u=>{const j=u.target.value;t(j)},[]),l=g.useCallback(u=>{t(u)},[]),n=g.useCallback(u=>j=>{j.preventDefault(),a(!0),u(s),setTimeout(()=>{a(!1)},300)},[s]),x=g.useCallback(u=>{t(""),u()},[]);return{searchTerm:s,isSearching:o,handleSearchChange:m,handleSearchSubmit:n,clearSearch:x,setSearchTermExternal:l}},De=({searchTerm:s,onSearchChange:t,onSearch:o,onClear:a,isLoading:m=!1})=>{const l=g.useRef(null),n=()=>{a&&(a(),setTimeout(()=>{l.current&&l.current.focus()},0))};return e.jsxs("div",{className:"mb-8",children:[e.jsxs("form",{onSubmit:o,className:"relative",children:[e.jsx("input",{ref:l,type:"text",placeholder:"Buscar productos...",className:"w-full py-3 px-4 pr-16 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-300 focus:border-transparent",value:s,onChange:t,disabled:m,autoComplete:"off"}),s&&e.jsx("button",{type:"button",onClick:n,className:"absolute right-12 top-3 text-gray-400 hover:text-gray-600 focus:outline-none","aria-label":"Limpiar búsqueda",disabled:m,children:e.jsx(M,{size:20})}),e.jsx("button",{type:"submit",className:"absolute right-3 top-3 text-gray-400 hover:text-primary-600 focus:outline-none flex items-center justify-center h-6 w-6","aria-label":"Buscar",disabled:m,children:m?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-primary-600"}):e.jsx(Ne,{size:20,className:"hover:text-primary-600"})})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500 text-right",children:"Presiona Enter o haz clic en la lupa para buscar"})]})},Pe=X.memo(De),ie={smartphone:T,smartphones:T,teléfono:T,telefono:T,móvil:T,movil:T,tv:B,tvs:B,televisor:B,televisión:B,television:B,laptop:D,laptops:D,portátil:D,portatil:D,ordenador:D,computadora:D,monitor:W,monitores:W,pantalla:W,auricular:O,auriculares:O,headphone:O,audio:O,cámara:J,camara:J,foto:J,reloj:H,relojes:H,watch:H,altavoz:Z,altavoces:Z,speaker:Z,electrónica:z,electronica:z,informática:D,informatica:D,tecnología:z,tecnologia:z,moda:z,ropa:z,accesorios:z},Me=({categories:s,isLoading:t=!1,onCategoryClick:o})=>{const[a,m]=g.useState(0),l=()=>{if(typeof window>"u")return 8;const i=window.innerWidth;return i<640?4:i<768?6:i<1024?8:12},[n,x]=g.useState(l);X.useEffect(()=>{const i=()=>{x(l());const f=Math.ceil(s.length/l());a>=f&&f>0&&m(f-1)};return window.addEventListener("resize",i),()=>window.removeEventListener("resize",i)},[s.length,a]);const u=Math.ceil(s.length/n),j=()=>{const i=a*n,f=i+n;return s.slice(i,f)},w=()=>{a>0&&m(a-1)},S=()=>{a<u-1&&m(a+1)},N=(i,f)=>{f.preventDefault(),o&&o(i)},k=i=>{if(i.icon&&i.icon.match(/\p{Emoji}/u))return e.jsx("span",{className:"text-xl",children:i.icon});const f=i.name.toLowerCase(),b=Object.keys(ie).find(C=>f.includes(C)||C.includes(f));if(b){const C=ie[b];return e.jsx(C,{size:20,className:"text-gray-600"})}return e.jsx(z,{size:20,className:"text-gray-600"})};return t?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary-600"})}):s.length===0?e.jsxs("div",{className:"p-6 bg-gray-50 text-gray-500 rounded-lg text-center",children:[e.jsx(z,{size:32,className:"mx-auto mb-2 text-gray-400"}),e.jsx("p",{children:"No hay categorías disponibles"})]}):e.jsxs("div",{className:"space-y-4",children:[u>1&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:[s.length," categorías"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:w,disabled:a===0,className:`p-2 rounded-full border transition-colors ${a>0?"cursor-pointer text-gray-700 border-gray-300 hover:bg-gray-100 hover:border-gray-400":"text-gray-400 border-gray-200 cursor-not-allowed"}`,"aria-label":"Página anterior",children:e.jsx(Y,{size:18})}),e.jsx("div",{className:"flex items-center space-x-1",children:Array.from({length:u}).map((i,f)=>e.jsx("button",{onClick:()=>m(f),className:`w-2 h-2 rounded-full transition-colors ${f===a?"bg-primary-600":"bg-gray-300 hover:bg-gray-400"}`,"aria-label":`Ir a página ${f+1}`},f))}),e.jsx("button",{onClick:S,disabled:a===u-1,className:`p-2 rounded-full border transition-colors ${a<u-1?"cursor-pointer text-gray-700 border-gray-300 hover:bg-gray-100 hover:border-gray-400":"text-gray-400 border-gray-200 cursor-not-allowed"}`,"aria-label":"Página siguiente",children:e.jsx(K,{size:18})})]})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-4 xl:grid-cols-6 gap-3",children:j().map(i=>e.jsx("div",{className:"group block no-underline text-gray-800 cursor-pointer",onClick:f=>N(i,f),children:e.jsxs("div",{className:"flex flex-col items-center gap-3 p-4 rounded-lg border border-gray-100 hover:border-primary-200 hover:bg-primary-50 transition-all duration-200 hover:shadow-sm",children:[e.jsx("div",{className:"flex items-center justify-center w-12 h-12 rounded-full bg-gray-100 group-hover:bg-white group-hover:shadow-sm transition-all duration-200",children:k(i)}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-sm font-medium text-gray-800 group-hover:text-primary-700 transition-colors duration-200 line-clamp-2",children:i.name}),i.product_count!==void 0&&i.product_count>0&&e.jsxs("span",{className:"text-xs text-gray-500 mt-1 block",children:[i.product_count," productos"]})]}),e.jsx(K,{className:"w-4 h-4 text-gray-400 group-hover:text-primary-600 transition-colors duration-200 opacity-0 group-hover:opacity-100"})]})},i.id))}),u>1&&e.jsxs("div",{className:"text-center text-sm text-gray-500",children:["Página ",a+1," de ",u]})]})},q=({title:s,isExpanded:t,onToggle:o,children:a})=>e.jsxs("div",{className:"border-b border-gray-200 pb-4",children:[e.jsxs("button",{className:"cursor-pointer flex justify-between items-center w-full py-2 text-left font-medium text-gray-700 hover:text-gray-900",onClick:o,children:[s,t?e.jsx(ke,{size:16}):e.jsx(de,{size:16})]}),t&&e.jsx("div",{className:"mt-2 space-y-2",children:a})]}),Te=({categories:s,selectedCategories:t,onCategoryChange:o,isExpanded:a,onToggle:m,productCountByCategory:l})=>{const n=x=>{t.includes(x)?o(t.filter(u=>u!==x)):o([...t,x])};return e.jsx(q,{title:"Categorías",isExpanded:a,onToggle:m,children:e.jsx("div",{className:"space-y-1 max-h-60 overflow-y-auto pr-2 scrollbar-thin",children:s.map(x=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:`category-${x}`,checked:t.includes(x),onChange:()=>n(x),className:"cursor-pointer h-4 w-4 text-primary-600 focus:ring-primary-500 rounded border-gray-300"}),e.jsxs("label",{htmlFor:`category-${x}`,className:"cursor-pointer ml-2 block text-sm text-gray-700",children:[x,e.jsxs("span",{className:"ml-1 text-gray-400 text-xs",children:["(",l[x]||0,")"]})]})]},x))})})},Le=({initialMin:s,initialMax:t,selectedRange:o,isExpanded:a,onToggle:m,onApply:l,onClear:n})=>{const[x,u]=g.useState(o?.min||s),[j,w]=g.useState(o?.max||t),S=i=>{const f=parseInt(i.target.value);u(isNaN(f)?s:f)},N=i=>{const f=parseInt(i.target.value);w(isNaN(f)?t:f)},k=()=>{const i=Math.min(x,j),f=Math.max(x,j);l(i,f)};return e.jsx(q,{title:"Precio",isExpanded:a,onToggle:m,children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"min-price",className:"block text-sm text-gray-500 mb-1",children:"Mínimo"}),e.jsx("input",{type:"number",id:"min-price",min:s,max:t,value:x,onChange:S,className:"w-full p-2 border border-gray-300 rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"max-price",className:"block text-sm text-gray-500 mb-1",children:"Máximo"}),e.jsx("input",{type:"number",id:"max-price",min:s,max:t,value:j,onChange:N,className:"w-full p-2 border border-gray-300 rounded"})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:k,className:"flex-1 bg-primary-600 text-white py-2 px-4 rounded hover:bg-primary-700 text-sm",children:"Aplicar"}),o&&e.jsx("button",{onClick:n,className:"bg-gray-200 text-gray-700 py-2 px-3 rounded hover:bg-gray-300 text-sm",children:e.jsx(M,{size:18})})]})]})})},Be=({selectedRating:s,onRatingChange:t,isExpanded:o,onToggle:a})=>{const m=[5,4,3,2,1];return e.jsx(q,{title:"Valoración",isExpanded:o,onToggle:a,children:e.jsx("div",{className:"space-y-2",children:m.map(l=>e.jsxs("button",{onClick:()=>t(s===l?null:l),className:`cursor-pointer flex items-center w-full p-2 rounded-md transition ${s===l?"bg-primary-50 text-primary-700":"hover:bg-gray-100 text-gray-700"}`,children:[e.jsx("div",{className:"flex",children:[...Array(5)].map((n,x)=>e.jsx(we,{size:16,fill:x<l?"currentColor":"none",className:x<l?"text-yellow-400":"text-gray-300"},x))}),e.jsxs("span",{className:"ml-2 text-sm",children:[l,"+ estrellas"]})]},l))})})},Ue=({selectedDiscount:s,onDiscountChange:t,isExpanded:o,onToggle:a})=>e.jsx(q,{title:"Ofertas",isExpanded:o,onToggle:a,children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"discount-filter",checked:s,onChange:()=>t(!s),className:"cursor-pointer h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"discount-filter",className:"cursor-pointer ml-2 block text-sm text-gray-700",children:"Productos con descuento"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"Mostrar solo productos con ofertas especiales y descuentos"})]})}),Oe=({categories:s,priceRange:t,onCategoryChange:o,onPriceRangeChange:a,onRatingChange:m,onDiscountChange:l,onClearFilters:n,selectedCategories:x,selectedPriceRange:u,selectedRating:j,selectedDiscount:w,productCountByCategory:S})=>{const[N,k]=g.useState({categories:!0,price:!0,rating:!1,discount:!1}),i=b=>{k(C=>({...C,[b]:!C[b]}))},f=x.length>0||u!==null||j!==null||w;return e.jsxs("div",{className:"bg-white rounded-lg shadow p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-800",children:"Filtros"}),f&&e.jsx("button",{onClick:n,className:"text-sm text-primary-600 hover:text-primary-700",children:"Limpiar filtros"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(Te,{categories:s,selectedCategories:x,onCategoryChange:o,isExpanded:N.categories,onToggle:()=>i("categories"),productCountByCategory:S}),e.jsx(Le,{initialMin:t.min,initialMax:t.max,selectedRange:u,isExpanded:N.price,onToggle:()=>i("price"),onApply:(b,C)=>a({min:b,max:C}),onClear:()=>a(null)}),e.jsx(Be,{selectedRating:j,onRatingChange:m,isExpanded:N.rating,onToggle:()=>i("rating")}),e.jsx(Ue,{selectedDiscount:w,onDiscountChange:l,isExpanded:N.discount,onToggle:()=>i("discount")})]})]})},Ke=s=>{if(!s||typeof s!="object")return console.error("Producto inválido para adaptar:",s),{};const t=s.ratingAvg||s.rating_avg||s.rating||s.rating_data?.average_rating||0,o=s.ratingAvg_count||s.rating_avg_count||s.rating_count||s.rating_data?.average_rating_count||0;let a=[];Array.isArray(s.images)?typeof s.images[0]=="object"?a=s.images.map(x=>x.original||x.url||x.medium||x.thumbnail||"").filter(Boolean):typeof s.images[0]=="string"&&(a=s.images):typeof s.image=="string"?a=[s.image]:(typeof s.imageUrl=="string"||typeof s.image_url=="string")&&(a=[s.imageUrl||s.image_url]);const m=s.discountPercentage||s.discount_percentage||0,l=parseFloat(s.price)||0,n=s.finalPrice||s.final_price||(m>0?l*(1-m/100):l);return{id:s.id,userId:s.userId||s.user_id,categoryId:s.categoryId||s.category_id,name:s.name||"Producto sin nombre",slug:s.slug||"",description:s.description||"",price:l,stock:parseInt(s.stock)||0,weight:s.weight,width:s.width,height:s.height,depth:s.depth,dimensions:s.dimensions,colors:s.colors,sizes:s.sizes,tags:s.tags,sku:s.sku,attributes:s.attributes,images:a,featured:!!s.featured,published:!!s.published,status:s.status||"active",viewCount:s.viewCount||s.view_count||0,salesCount:s.salesCount||s.sales_count||0,discountPercentage:m,finalPrice:n,isInStock:s.isInStock||s.is_in_stock||s.stock>0,rating:parseFloat(t)||0,ratingCount:parseFloat(o)||0,createdAt:s.createdAt||s.created_at,updatedAt:s.updatedAt||s.updated_at}},qe=({products:s,categories:t,isLoading:o,error:a,onRetry:m,onAddToCart:l,onAddToWishlist:n,getImageUrl:x,selectedCategories:u,totalItems:j,currentPage:w,itemsPerPage:S,onResetFilters:N})=>{if(o)return e.jsx("div",{className:"flex justify-center items-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})});if(a)return e.jsxs("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded",children:[e.jsxs("p",{className:"text-red-700",children:["Error al cargar productos: ",a]}),e.jsx("button",{onClick:m,className:"mt-3 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Reintentar"})]});if(s.length===0)return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-8 text-center",children:[e.jsx("h3",{className:"text-xl font-medium mb-2",children:"No se encontraron productos"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"No hay productos que coincidan con los filtros actuales."}),e.jsx("button",{onClick:N,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"Limpiar filtros"})]});const k=(w-1)*S+1,i=Math.min(w*S,j);return e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:u.length>0?u.join(", "):"Todos los productos"}),e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("p",{className:"text-gray-600",children:["Mostrando ",k,"-",i," de ",j," productos"]})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:s.map(f=>{const b=Ke(f);let C="";console.group(`🎨 ProductGrid - Producto ${f.id}`),console.log("📦 Producto completo:",f),console.log("🖼️ Imágenes disponibles:",f.images),Array.isArray(f.images)&&f.images.length>0?(C=typeof f.images[0]=="string"?f.images[0]:f.images[0]?.url||"",console.log("✅ Imagen seleccionada:",C)):console.warn("⚠️ No hay imágenes disponibles para el producto"),console.groupEnd();const E=x(C);return console.log(`🔗 URL final de imagen para producto ${f.id}:`,E),e.jsx(Ce,{id:b.id||0,name:b.name,price:b.price,discount:f.discountPercentage,rating:b.rating||0,reviews:f.ratingCount||0,image:E,category:t.find(c=>c.id===b.categoryId)?.name,isNew:new Date(b.createdAt||"").getTime()>Date.now()-30*24*60*60*1e3,onAddToCart:l,onAddToWishlist:n},b.id)})})]})},Ge=({options:s,selectedOption:t,onSortChange:o})=>{const[a,m]=g.useState(!1),l=g.useRef(null);g.useEffect(()=>{const u=j=>{l.current&&!l.current.contains(j.target)&&m(!1)};return document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[]);const n=()=>{const u=s.find(j=>j.id===t);return u?u.label:"Ordenar por"},x=u=>{o(u),m(!1)};return e.jsxs("div",{className:"relative",ref:l,children:[e.jsxs("button",{onClick:()=>m(!a),className:"cursor-pointer flex items-center px-4 py-2 bg-white rounded-lg shadow border border-gray-200 text-gray-700 hover:bg-gray-50",children:[e.jsx("span",{className:"mr-2",children:n()}),e.jsx(de,{size:16,className:`transition-transform ${a?"transform rotate-180":""}`})]}),a&&e.jsx("div",{className:"absolute right-0 mt-2 z-10 w-56 bg-white rounded-lg shadow-lg border border-gray-200 py-1",children:s.map(u=>e.jsx("button",{onClick:()=>x(u.id),className:`block w-full text-left px-4 py-2 text-sm ${t===u.id?"bg-primary-50 text-primary-700 font-medium":"text-gray-700 hover:bg-gray-50"}`,children:u.label},u.id))})]})},Ve=({isOpen:s,onClose:t,categories:o,selectedCategories:a,priceRanges:m,selectedRangeId:l,selectedRating:n,showingDiscounted:x,onCategoryChange:u,onPriceRangeChange:j,onRatingChange:w,onDiscountToggle:S,onClearFilters:N,productCountByCategory:k})=>{if(!s)return null;const i=b=>{const[C,E]=b.split("-").map(Number);j(C,E)},f=a.length>0||l!==null||n!==null||x;return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex md:hidden",children:e.jsxs("div",{className:"absolute inset-y-0 right-0 w-4/5 max-w-md bg-white overflow-y-auto flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-800",children:"Filtros"}),e.jsx("button",{onClick:t,className:"text-gray-500 hover:text-gray-700",children:e.jsx(M,{size:24})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-800 mb-3",children:"Categorías"}),e.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:o.map(b=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:`mobile-category-${b.id}`,checked:a.includes(b.name),onChange:()=>u(b.name,!a.includes(b.name)),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 rounded border-gray-300"}),e.jsxs("label",{htmlFor:`mobile-category-${b.id}`,className:"ml-2 block text-sm text-gray-700",children:[b.name,e.jsxs("span",{className:"ml-1 text-gray-400 text-xs",children:["(",k[b.name]||0,")"]})]})]},b.id))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-800 mb-3",children:"Precio"}),e.jsx("div",{className:"space-y-2",children:m.map(b=>e.jsx("button",{onClick:()=>i(b.id),className:`block w-full text-left px-3 py-2 rounded-md text-sm ${l===b.id?"bg-primary-50 text-primary-700 font-medium":"text-gray-700 hover:bg-gray-50"}`,children:b.label},b.id))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-800 mb-3",children:"Valoración"}),e.jsx("div",{className:"space-y-2",children:[5,4,3,2,1].map(b=>e.jsxs("button",{onClick:()=>w(n===b?null:b),className:`flex items-center w-full px-3 py-2 rounded-md text-sm ${n===b?"bg-primary-50 text-primary-700 font-medium":"text-gray-700 hover:bg-gray-50"}`,children:[e.jsx(Se,{rating:b}),e.jsxs("span",{className:"ml-2",children:[b,"+ estrellas"]})]},b))})]}),e.jsx("div",{children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"mobile-discount-filter",checked:x,onChange:S,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"mobile-discount-filter",className:"ml-2 block text-sm text-gray-700",children:"Productos con descuento"})]})})]}),e.jsxs("div",{className:"p-4 border-t border-gray-200 space-y-3",children:[f&&e.jsx("button",{onClick:N,className:"w-full py-2 px-4 border border-gray-300 rounded-md text-gray-700 bg-white hover:bg-gray-50 text-sm",children:"Limpiar filtros"}),e.jsx("button",{onClick:t,className:"w-full py-2 px-4 bg-primary-600 hover:bg-primary-700 text-white rounded-md text-sm",children:"Ver resultados"})]})]})})},We=({selectedCategories:s,selectedPriceRange:t,selectedRating:o,searchTerm:a,showingDiscounted:m,onRemoveCategory:l,onClearPriceRange:n,onClearRating:x,onClearSearch:u,onToggleDiscount:j,onClearAllFilters:w,onToggleFilters:S})=>{const N=s.length>0||t!==null||o!==null||m||a!=="";return N?e.jsxs("div",{className:"w-full md:w-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Filtros Activos"}),N&&e.jsx("button",{onClick:w,className:"text-xs text-primary-600 hover:text-primary-700",children:"Limpiar todos"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:S,className:"md:hidden flex items-center px-3 py-1 bg-primary-50 text-primary-700 rounded-full text-sm",children:[e.jsx(ne,{size:14,className:"mr-1"}),e.jsx("span",{children:"Filtrar"})]}),a&&e.jsxs("div",{className:"flex items-center px-3 py-1 bg-blue-50 text-blue-700 rounded-full text-sm",children:[e.jsxs("span",{className:"mr-1",children:["Búsqueda: ",a]}),e.jsx("button",{onClick:u,className:"ml-1 text-blue-500 hover:text-blue-700",children:e.jsx(M,{size:14})})]}),s.map((k,i)=>e.jsxs("div",{className:"flex items-center px-3 py-1 bg-primary-100 text-primary-700 rounded-full text-sm",children:[e.jsxs("span",{className:"mr-1",children:["Categoría: ",k]}),e.jsx("button",{onClick:()=>l(k),className:"ml-1 text-primary-500 hover:text-primary-700",children:e.jsx(M,{size:14})})]},`Active Filter - ${k} - ${i}`)),t&&e.jsxs("div",{className:"flex items-center px-3 py-1 bg-green-50 text-green-700 rounded-full text-sm",children:[e.jsxs("span",{className:"mr-1",children:["Precio: $",t.min," - $",t.max]}),e.jsx("button",{onClick:n,className:"ml-1 text-green-500 hover:text-green-700",children:e.jsx(M,{size:14})})]}),o!==null&&e.jsxs("div",{className:"flex items-center px-3 py-1 bg-yellow-50 text-yellow-700 rounded-full text-sm",children:[e.jsxs("span",{className:"mr-1",children:["Valoración: ",o,"+ estrellas"]}),e.jsx("button",{onClick:x,className:"ml-1 text-yellow-500 hover:text-yellow-700",children:e.jsx(M,{size:14})})]}),m&&e.jsxs("div",{className:"flex items-center px-3 py-1 bg-red-50 text-red-700 rounded-full text-sm",children:[e.jsx("span",{className:"mr-1",children:"Con descuento"}),e.jsx("button",{onClick:j,className:"ml-1 text-red-500 hover:text-red-700",children:e.jsx(M,{size:14})})]})]})]}):e.jsxs("button",{onClick:S,className:"md:hidden flex items-center px-4 py-2 bg-white rounded-lg shadow border border-gray-200 text-gray-700",children:[e.jsx(ne,{size:18,className:"mr-2"}),e.jsx("span",{children:"Filtros"})]})},Je=({currentPage:s,totalPages:t,onPageChange:o})=>{if(t<=1)return null;const m=(()=>{const l=[];l.push(1),s>3&&l.push("...");for(let n=Math.max(2,s-1);n<=Math.min(t-1,s+1);n++)n>1&&n<t&&l.push(n);return s<t-2&&l.push("..."),t>1&&l.push(t),l})();return e.jsx("div",{className:"hidden md:flex justify-center mt-6",children:e.jsxs("nav",{className:"inline-flex items-center rounded-md shadow-sm","aria-label":"Paginación",children:[e.jsxs("button",{onClick:()=>o(s-1),disabled:s===1,className:`relative inline-flex items-center rounded-l-md border border-gray-300 bg-white px-2 py-2 text-sm ${s===1?"text-gray-300 cursor-not-allowed":"text-gray-500 hover:bg-gray-50"}`,children:[e.jsx("span",{className:"sr-only",children:"Anterior"}),e.jsx(Y,{size:16})]}),m.map((l,n)=>e.jsx(X.Fragment,{children:typeof l=="number"?e.jsx("button",{onClick:()=>o(l),className:`relative inline-flex items-center border border-gray-300 px-4 py-2 text-sm font-medium ${s===l?"bg-primary-50 border-primary-500 text-primary-600 z-10":"bg-white text-gray-500 hover:bg-gray-50"}`,children:l}):e.jsx("span",{className:"relative inline-flex items-center border border-gray-300 bg-white px-4 py-2 text-sm text-gray-700",children:l})},n)),e.jsxs("button",{onClick:()=>o(s+1),disabled:s===t,className:`relative inline-flex items-center rounded-r-md border border-gray-300 bg-white px-2 py-2 text-sm ${s===t?"text-gray-300 cursor-not-allowed":"text-gray-500 hover:bg-gray-50"}`,children:[e.jsx("span",{className:"sr-only",children:"Siguiente"}),e.jsx(K,{size:16})]})]})})},Ze=({currentPage:s,totalPages:t,onPageChange:o})=>{if(t<=1)return null;const a=()=>{const m=[];if(t<=5)for(let l=1;l<=t;l++)m.push(l);else{let l;s<=3?l=1:s>=t-2?l=t-4:l=s-2;for(let n=0;n<5;n++)m.push(l+n)}return m};return e.jsxs("div",{className:"flex flex-col items-center mt-6 space-y-4",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Página ",e.jsx("span",{className:"font-medium text-gray-900",children:s})," ","de ",e.jsx("span",{className:"font-medium text-gray-900",children:t})]}),e.jsxs("div",{className:"flex justify-center items-center space-x-1",children:[e.jsx("button",{onClick:()=>o(s-1),disabled:s===1,className:`flex items-center justify-center w-10 h-10 rounded-lg border ${s>1?"border-gray-300 text-gray-700 hover:bg-gray-50":"border-gray-200 text-gray-400 cursor-not-allowed"}`,"aria-label":"Página anterior",children:e.jsx(Y,{size:20})}),a().map(m=>e.jsx("button",{onClick:()=>o(m),className:`flex items-center justify-center w-10 h-10 rounded-lg text-sm ${s===m?"bg-primary-600 text-white font-medium shadow-sm":"border border-gray-300 text-gray-700 hover:bg-gray-50"}`,"aria-label":`Página ${m}`,"aria-current":s===m?"page":void 0,children:m},m)),e.jsx("button",{onClick:()=>o(s+1),disabled:s===t,className:`flex items-center justify-center w-10 h-10 rounded-lg border ${s<t?"border-gray-300 text-gray-700 hover:bg-gray-50":"border-gray-200 text-gray-400 cursor-not-allowed"}`,"aria-label":"Página siguiente",children:e.jsx(K,{size:20})})]})]})},He=(s,t)=>{const o={};return s.forEach(a=>{o[a.name]=a.product_count||0}),t&&t.length>0&&t.forEach(a=>{const m=a.categoryId,l=s.find(n=>n.id===m);l&&(o[l.name]=(o[l.name]||0)+1)}),o},Xe=[{id:"0-100",label:"Menos de $100"},{id:"100-300",label:"$100 - $300"},{id:"300-500",label:"$300 - $500"},{id:"500-1000",label:"$500 - $1000"},{id:"1000-2000",label:"$1000 - $2000"},{id:"2000-999999",label:"Más de $2000"}],Ye=[{id:"featured",label:"Destacados"},{id:"price-asc",label:"Precio: Menor a Mayor"},{id:"price-desc",label:"Precio: Mayor a Menor"},{id:"name-asc",label:"Nombre: A-Z"},{id:"name-desc",label:"Nombre: Z-A"},{id:"newest",label:"Más recientes"},{id:"rating",label:"Mejor valorados"}],pt=()=>{const[s,t]=g.useState(!1),[o,a]=g.useState(!1),{loading:m,error:l,categories:n,fetchCategories:x}=ye(),{searchTerm:u,isSearching:j,handleSearchChange:w,handleSearchSubmit:S,clearSearch:N,setSearchTermExternal:k}=ze(),{filters:i,buildFilterParams:f,setCategories:b,setPriceRange:C,setRating:E,setDiscount:c,setSortBy:r,setPage:p,setSearchTerm:h,clearFilters:d,toggleCategory:v}=Re(n),{loading:I,error:F,products:_,meta:$,fetchProducts:G}=Fe(),{addToCart:Q}=je(),{toggleFavorite:ee}=ve();g.useEffect(()=>{k(i.searchTerm)},[i.searchTerm,k]);const te=g.useMemo(()=>He(n,_),[n,_]);g.useEffect(()=>{const y=()=>{a(window.innerWidth<768)};return y(),window.addEventListener("resize",y),()=>{window.removeEventListener("resize",y)}},[]),g.useEffect(()=>{console.log("Cargando categorías..."),x(!0,!1)},[x]),g.useEffect(()=>{if(n.length>0){console.log("Categorías cargadas, construyendo parámetros de filtro...");const y=f();console.log("Cargando productos con parámetros:",y),G(y)}},[G,f,n.length,i]);const se=g.useCallback(y=>{C(y)},[C]),me=g.useCallback(y=>{console.log("Manejando búsqueda:",y),h(y)},[h]),re=g.useCallback(()=>{console.log("Limpiando búsqueda"),h("")},[h]),ue=g.useCallback(y=>{console.log("Clic en categoría:",y.name),v(y.name)},[v]),ge=g.useCallback(async y=>{try{await Q({productId:y,quantity:1})}catch(R){console.error("Error al añadir al carrito:",R)}},[Q]),he=g.useCallback(async y=>{try{await ee(y)}catch(R){console.error("Error al añadir a favoritos:",R)}},[ee]),xe=g.useCallback(y=>Ie(y),[]),oe=$?Math.ceil($.total/($.limit||P.pagination.defaultPageSize)):0,V=i.categories.length>0||i.priceRange!==null||i.rating!==null||i.discount||i.sortBy!=="featured"||i.searchTerm!=="",U=I||m||j,ae=g.useMemo(()=>n.filter(y=>y.is_active).slice(0,24),[n]);return console.log("Estado actual:",{categoriesData:n.length,productsData:_.length,filters:i,isLoading:U,hasActiveFilters:V}),e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Productos"}),e.jsx(Pe,{searchTerm:u,onSearchChange:w,onSearch:S(me),onClear:()=>N(re),isLoading:j}),e.jsxs("section",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",children:"Categorías"}),m?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-primary-600"})}):l?e.jsxs("div",{className:"p-4 bg-red-50 text-red-700 rounded-lg",children:[e.jsxs("p",{children:["Error al cargar categorías: ",l]}),e.jsx("button",{onClick:()=>x(!0,!0),className:"mt-2 px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 text-sm",children:"Reintentar"})]}):ae.length>0?e.jsx(Me,{categories:ae,onCategoryClick:ue}):e.jsx("div",{className:"p-4 bg-gray-50 text-gray-500 rounded-lg text-center",children:"No hay categorías disponibles"})]}),e.jsxs("div",{className:"flex md:justify-end justify-between mb-6",children:[e.jsx(We,{selectedCategories:i.categories,selectedPriceRange:i.priceRange,selectedRating:i.rating,searchTerm:i.searchTerm,showingDiscounted:i.discount,onRemoveCategory:y=>{b(i.categories.filter(R=>R!==y))},onClearPriceRange:()=>C(null),onClearRating:()=>E(null),onClearSearch:re,onToggleDiscount:()=>c(!i.discount),onClearAllFilters:d,onToggleFilters:()=>t(!0)}),e.jsx(Ge,{options:Ye,selectedOption:i.sortBy,onSortChange:r})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[e.jsx("div",{className:"hidden md:block md:w-72 flex-shrink-0",children:e.jsx(Oe,{categories:n.map(y=>y.name),priceRange:{min:0,max:1e4},onCategoryChange:b,onPriceRangeChange:se,onRatingChange:E,onDiscountChange:y=>c(y),onClearFilters:d,selectedCategories:i.categories,selectedPriceRange:i.priceRange,selectedRating:i.rating,selectedDiscount:i.discount,productCountByCategory:te})}),e.jsx(Ve,{isOpen:s,onClose:()=>t(!1),categories:n,selectedCategories:i.categories,priceRanges:Xe,selectedRangeId:i.priceRange?`${i.priceRange.min}-${i.priceRange.max}`:null,selectedRating:i.rating,showingDiscounted:i.discount,onCategoryChange:(y,R)=>{b(R?[...i.categories,y]:i.categories.filter(fe=>fe!==y))},onPriceRangeChange:(y,R)=>{se({min:y,max:R})},onRatingChange:E,onDiscountToggle:()=>c(!i.discount),onClearFilters:d,productCountByCategory:te}),e.jsxs("div",{className:"flex-1",children:[e.jsx(qe,{products:_,categories:n,isLoading:U,error:F||null,onRetry:()=>{const y=f();G(y)},onAddToCart:ge,onAddToWishlist:he,getImageUrl:xe,selectedCategories:i.categories,totalItems:$?.total||0,currentPage:i.page,itemsPerPage:$?.limit||P.pagination.defaultPageSize,onResetFilters:d}),$&&$.total>$.limit&&e.jsxs(e.Fragment,{children:[o&&e.jsx(Ze,{currentPage:i.page,totalPages:oe,onPageChange:p}),!o&&e.jsx(Je,{currentPage:i.page,totalPages:oe,onPageChange:p})]}),!U&&!F&&_.length===0&&V&&e.jsxs("div",{className:"mt-8 p-6 bg-yellow-50 border border-yellow-200 text-yellow-800 rounded-lg text-center",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No se encontraron productos"}),e.jsx("p",{className:"mb-4",children:"No hay productos que coincidan con los filtros seleccionados."}),e.jsx("button",{onClick:d,className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors",children:"Limpiar todos los filtros"})]}),!U&&!F&&_.length===0&&!V&&e.jsxs("div",{className:"mt-8 p-6 bg-gray-50 border border-gray-200 text-gray-600 rounded-lg text-center",children:[e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No hay productos disponibles"}),e.jsx("p",{children:"Actualmente no hay productos en el catálogo. Por favor, inténtalo más tarde."})]})]})]})]})};export{pt as default};
//# sourceMappingURL=ProductPage-C9LQe_pO.js.map
